
#region Using

using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;

using Wisej.Web;
using Captain.Common.Model.Objects;
using Captain.Common.Views.Forms.Base;
using Captain.Common.Model.Data;
using System.Xml;
using System.IO;
using Captain.Common.Utilities;
using System.Text.RegularExpressions;
using System.Threading;

using iTextSharp;
using iTextSharp.text;
using iTextSharp.text.pdf;
using iTextSharp.text.html.simpleparser;
using XLSExportFile;
using CarlosAg.ExcelXmlWriter;
using Captain.Common.Views.Controls.Compatibility;
using static NPOI.HSSF.Util.HSSFColor;
using System.Security.Cryptography;
using ListItem = Captain.Common.Utilities.ListItem;
using DevExpress.XtraPrinting.Design;
using DevExpress.DataProcessing.InMemoryDataProcessor;

using Captain.Common.Interfaces;
using DevExpress.CodeParser;
using System.Globalization;
using DevExpress.Utils.Win.Hook;
using DevExpress.DashboardCommon;
using DevExpress.UIAutomation;
using log4net.Repository.Hierarchy;
using Captain.DatabaseLayer;

#endregion

namespace Captain.Common.Views.Forms
{
    public partial class RNGB0005Form : Form
    {
        #region private variables

        private ErrorProvider _errorProvider = null;
        CaptainModel _model = null;
        private List<HierarchyEntity> _selectedHierarchies = null;


        #endregion

        public RNGB0005Form(BaseForm baseForm, PrivilegeEntity privilegeEntity)
        {
            ListZipCode = new List<ZipCodeEntity>();
            ListRngGroupCode = new List<RCsb14GroupEntity>();
            ListcaseSiteEntity = new List<CaseSiteEntity>();
            ListcaseMsSiteEntity = new List<CaseSiteEntity>();
            Sel_Funding_List = new List<SPCommonEntity>();
            ListcommonEntity = new List<CommonEntity>();
            ListServicePlans = new List<CASESP1Entity>();

            ListcommonEntity_Results = new List<CommonEntity>();

            InitializeComponent();
            BaseForm = baseForm;
            PrivilegeEntity = privilegeEntity;
            this.Text = "Program Service and Outcomes Report";
            //this.Text = privilegeEntity.Program + " - " + privilegeEntity.PrivilegeName;
            _model = new CaptainModel();


            //RngCodelist = _model.SPAdminData.Browse_RNGGrp(null, null, null, null, null,BaseForm.UserID,BaseForm.BaseAgency);
            Set_Report_Hierarchy(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, BaseForm.BaseYear);
            ReportPath = _model.lookupDataAccess.GetReportPath();

            _errorProvider = new ErrorProvider(this);
            _errorProvider.BlinkRate = 1;
            _errorProvider.BlinkStyle = ErrorBlinkStyle.BlinkIfDifferentError;
            _errorProvider.Icon = null;
            Txt_Pov_High.Validator = TextBoxValidation.IntegerValidator;
            Txt_Pov_Low.Validator = TextBoxValidation.IntegerValidator;
            fillDropDowns();
            propReportPath = _model.lookupDataAccess.GetReportPath();

            Get_MasterTable_DateRanges();
            Fill_CAMS_Master_List();
            Fill_All_List_Arrays();
            //Fill_Program_Combo();
            fillRngCode();
            Fill_Fund_Mast_List();

            Size = new Size(Width, Height - (pnlQ1Dte.Height + pnlQ2Dte.Height + pnlQ3Dte.Height + pnlQ4Dte.Height));
            //Initialize_All_Controls();
        }

        void fillRngCode()
        {
            cmbRngCode.Items.Clear();
            RngCodelist = _model.SPAdminData.Browse_RNGGrp(null, null, null, null, null, BaseForm.UserID, string.Empty);
            List<RCsb14GroupEntity> rngonlycodelist = RngCodelist.FindAll(u => u.GrpCode.Trim() == string.Empty && u.TblCode.Trim() == string.Empty);

            List<RCsb14GroupEntity> rngonlyAgencylist = rngonlycodelist.FindAll(u => u.Agency.Equals(strAgency));
            if (rngonlyAgencylist.Count == 0)
            {
                rngonlyAgencylist = rngonlycodelist.FindAll(u => u.Agency.Equals("**"));
            }

            if (rngonlyAgencylist.Count > 0)
            {
                rngonlyAgencylist = rngonlyAgencylist.FindAll(u => u.PPR_SW == "Y");
                rngonlyAgencylist = rngonlyAgencylist.OrderByDescending(u => u.Code).ToList();
            }

            rngonlyAgencylist = rngonlyAgencylist.OrderByDescending(u => u.Code).ToList();
            foreach (RCsb14GroupEntity rngcodedata in rngonlyAgencylist)
            {
                cmbRngCode.Items.Add(new Captain.Common.Utilities.ListItem(rngcodedata.GrpDesc, rngcodedata.Code, rngcodedata.Agency, string.Empty, rngcodedata.OFdate, rngcodedata.OTdate));
            }
            cmbRngCode.Items.Insert(0, new Captain.Common.Utilities.ListItem("", "**"));
            cmbRngCode.SelectedIndex = 0;
        }

        void fillDropDowns()
        {
            Cmb_CaseType.Items.Clear();
            List<CommonEntity> CaseType = _model.lookupDataAccess.GetCaseType();
            CaseType = CaseType.OrderByDescending(u => u.Active.Trim()).ToList();
            Cmb_CaseType.ColorMember = "FavoriteColor";
            foreach (CommonEntity casetype in CaseType)
            {
                ListItem li = new ListItem(casetype.Desc, casetype.Code, casetype.Active, casetype.Active.Equals("Y") ? Color.Black : Color.Red);
                Cmb_CaseType.Items.Add(li);

                //Cmb_CaseType.Items.Add(new Captain.Common.Utilities.ListItem(casetype.Desc, casetype.Code));

                //if (casetype.Active != "Y")
                //    Cmb_CaseType.ForeColor = Color.Red;

            }
            Cmb_CaseType.Items.Insert(0, new Captain.Common.Utilities.ListItem("All", "**"));
            Cmb_CaseType.SelectedIndex = 0;

            /** Ref_From_Date.Value = new DateTime(DateTime.Now.Year, 1, 1);// Convert.ToDateTime("01/01/" + DateTime.Now.Year);
             Ref_To_Date.Value = new DateTime(DateTime.Now.Year, 12, 31);// Convert.ToDateTime("12/31/" + DateTime.Now.Year);
             if (Sys_DateRange_List.Count > 0)
             {
                 Ref_From_Date.Value = Convert.ToDateTime(Sys_DateRange_List[0].REF_FDATE);// Convert.ToDateTime("01/01/" + DateTime.Now.Year);
                 Ref_To_Date.Value = Convert.ToDateTime(Sys_DateRange_List[0].REF_TDATE);// Convert.ToDateTime("12/31/" + DateTime.Now.Year);
             }

             //Rep_From_Date.Value = new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1).AddMonths(-1);
             //Rep_To_Date.Value = new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1).AddDays(-1);
             Rep_From_Date.Value = new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1);
             Rep_To_Date.Value = new DateTime(DateTime.Today.Year, DateTime.Today.Month, DateTime.DaysInMonth(DateTime.Today.Month, DateTime.Today.Month));
             Rep_From_Date.Checked = Rep_To_Date.Checked = true;*/


        }


        #region properties

        public BaseForm BaseForm { get; set; }

        public PrivilegeEntity PrivilegeEntity { get; set; }

        public List<CaseSiteEntity> ListcaseSiteEntity { get; set; }

        public List<SPCommonEntity> Sel_Funding_List { get; set; }

        public List<ZipCodeEntity> ListZipCode { get; set; }

        public List<RCsb14GroupEntity> ListRngGroupCode { get; set; }

        public List<CASESP1Entity> ListServicePlans { get; set; }

        public List<CommonEntity> ListcommonEntity { get; set; }

        public List<CommonEntity> ListcommonEntity_Results
        {
            get; set;
        }

        public List<CaseSiteEntity> ListcaseMsSiteEntity { get; set; }

        public string strAgency { get; set; }

        public string strDept { get; set; }

        public string strProg { get; set; }

        public string ReportPath { get; set; }

        public string propReportPath { get; set; }

        /**public List<HierarchyEntity> SelectedHierarchies
        {
            get
            {
                //return _selectedHierarchies = (from c in HierarchyGrid.Rows.Cast<DataGridViewRow>().ToList()
                //                               where (((DataGridViewCheckBoxCell)c.Cells["Select"]).Value.ToString().Equals(Consts.YesNoVariants.True, StringComparison.CurrentCultureIgnoreCase))
                //                               select ((DataGridViewRow)c).Tag as HierarchyEntity).ToList();

                return _selectedHierarchies = (from c in HierarchyGrid.Rows.Cast<DataGridViewRow>().ToList()
                                               select ((DataGridViewRow)c).Tag as HierarchyEntity).ToList();
            }
        }*/

        #endregion

        List<ZipCodeEntity> zipcode_List = new List<ZipCodeEntity>();
        List<CommonEntity> County_List = new List<CommonEntity>();
        List<CaseSiteEntity> Site_List = new List<CaseSiteEntity>();
        List<CaseSiteEntity> MSSite_List = new List<CaseSiteEntity>();
        List<RCsb14GroupEntity> RngCodelist = new List<RCsb14GroupEntity>();

        List<CommonEntity> Results_List = new List<CommonEntity>();
        private void Fill_All_List_Arrays()
        {
            zipcode_List = _model.ZipCodeAndAgency.GetZipCodeSearch(string.Empty, string.Empty, string.Empty, string.Empty);
            County_List = _model.ZipCodeAndAgency.GetCounty();
            MSSite_List = Site_List = _model.CaseMstData.GetCaseSite(Current_Hierarchy.Substring(0, 2), Current_Hierarchy.Substring(2, 2), Current_Hierarchy.Substring(4, 2), "SiteHie");

            Results_List = CommonFunctions.AgyTabsFilterCode(BaseForm.BaseAgyTabsEntity, "03335", BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, "Add");
        }

        /**private void rdoSelectedSites_Click(object sender, EventArgs e)
        {
            if (Rb_Site_Sel.Checked == true)
            {
                SelectZipSiteCountyForm siteform = new SelectZipSiteCountyForm(BaseForm, ListcaseSiteEntity, strAgency, strDept, strProg, string.Empty);
                siteform.FormClosed += new FormClosedEventHandler(SelectZipSiteCountyFormClosed);
                siteform.StartPosition = FormStartPosition.CenterScreen;
                siteform.ShowDialog();
            }
        }*/


        private void rdoCountySelected_Click(object sender, EventArgs e)
        {
            if (Rb_County_Sel.Checked == true)// && Scr_Oper_Mode == "CASB0004") // 20160303
            {
                SelectZipSiteCountyForm countyform = new SelectZipSiteCountyForm(BaseForm, ListcommonEntity);
                countyform.FormClosed += new FormClosedEventHandler(SelectZipSiteCountyFormClosed);
                countyform.StartPosition = FormStartPosition.CenterScreen;
                countyform.ShowDialog();
            }
        }

        private void rdoZipcodeSelected_Click(object sender, EventArgs e)
        {
            if (Rb_SP_Sel.Checked == true)
            {
                //if (((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString() == "**")
                //{
                //    AlertBox.Show("Please Select Code", MessageBoxIcon.Warning);
                //}
                //else
                //{

                SelectZipSiteCountyForm zipcodeform1 = new SelectZipSiteCountyForm(BaseForm, ListServicePlans, Current_Hierarchy.Substring(0, 2), Current_Hierarchy.Substring(2, 2), Current_Hierarchy.Substring(4, 2));
                zipcodeform1.FormClosed += new FormClosedEventHandler(SelectZipSiteCountyFormClosed);
                zipcodeform1.StartPosition = FormStartPosition.CenterScreen;
                zipcodeform1.ShowDialog();
                //}

            }
        }

        private void SelectZipSiteCountyFormClosed(object sender, FormClosedEventArgs e)
        {

            SelectZipSiteCountyForm form = sender as SelectZipSiteCountyForm;
            if (form.DialogResult == DialogResult.OK)
            {
                if (form.FormType == "CASESITE")
                {
                    ListcaseSiteEntity = form.SelectedCaseSiteEntity;
                    /**if (Rb_Site_Sel.Checked == true && ListcaseSiteEntity.Count > 0)
                        Txt_Sel_Site.Text = ListcaseSiteEntity[0].SiteNUMBER.ToString();
                    else
                        Txt_Sel_Site.Clear();*/
                }
                else if (form.FormType == "COUNTY")
                {
                    ListcommonEntity = form.SelectedCountyEntity;
                }

                else if (form.FormType == "ZIPCODE")
                {
                    ListZipCode = form.SelectedZipcodeEntity;
                }
                else if (form.FormType == "MSCODE")
                {
                    ListRngGroupCode = form.SelectedRngGroupCodeEntity;
                }
                else if (form.FormType == "FUND")
                {
                    Sel_Funding_List = form.Get_Sel_Fund_List;
                }
                if (form.FormType == "CASESP")
                {
                    ListServicePlans = form.SelectedServicePlanEntity;

                }

                //ZipCodeEntity zipcodedetais = form.ListOfSelectedCaseSite;
                //if (zipcodedetais != null)
                //{
                //    string zipPlus = zipcodedetais.Zcrplus4;
                //    txtZipPlus.Text = "0000".Substring(0, 4 - zipPlus.Length) + zipPlus;
                //    txtZipCode.Text = "00000".Substring(0, 5 - zipcodedetais.Zcrzip.Length) + zipcodedetais.Zcrzip;
                //    txtState.Text = zipcodedetais.Zcrstate;
                //    txtCity.Text = zipcodedetais.Zcrcity;
                //    SetComboBoxValue(cmbCounty, zipcodedetais.Zcrcountry);
                //    SetComboBoxValue(cmbTownship, zipcodedetais.Zcrcitycode);

                //}
            }
        }

        /** private void SelectZipSiteCountyMSFormClosed(object sender, FormClosedEventArgs e)
         {

             SelectZipSiteCountyForm form = sender as SelectZipSiteCountyForm;
             if (form.DialogResult == DialogResult.OK)
             {
                 if (form.FormType == "CASESITE")
                 {
                     ListcaseMsSiteEntity = form.SelectedCaseSiteEntity;
                     if (rdoMsselectsite.Checked == true && ListcaseMsSiteEntity.Count > 0)
                         txt_Msselect_site.Text = ListcaseMsSiteEntity[0].SiteNUMBER.ToString();
                     else
                         txt_Msselect_site.Clear();
                 }
                 else if (form.FormType == "COUNTY")
                 {
                     ListcommonEntity = form.SelectedCountyEntity;
                 }

                 else if (form.FormType == "ZIPCODE")
                 {
                     ListZipCode = form.SelectedZipcodeEntity;
                 }
                 else if (form.FormType == "MSCODE")
                 {
                     ListRngGroupCode = form.SelectedRngGroupCodeEntity;
                 }
                 else if (form.FormType == "FUND")
                 {
                     Sel_Funding_List = form.Get_Sel_Fund_List;
                 }

                 //ZipCodeEntity zipcodedetais = form.ListOfSelectedCaseSite;
                 //if (zipcodedetais != null)
                 //{
                 //    string zipPlus = zipcodedetais.Zcrplus4;
                 //    txtZipPlus.Text = "0000".Substring(0, 4 - zipPlus.Length) + zipPlus;
                 //    txtZipCode.Text = "00000".Substring(0, 5 - zipcodedetais.Zcrzip.Length) + zipcodedetais.Zcrzip;
                 //    txtState.Text = zipcodedetais.Zcrstate;
                 //    txtCity.Text = zipcodedetais.Zcrcity;
                 //    SetComboBoxValue(cmbCounty, zipcodedetais.Zcrcountry);
                 //    SetComboBoxValue(cmbTownship, zipcodedetais.Zcrcitycode);

                 //}
             }
         }*/



        string Current_Hierarchy = "******", Current_Hierarchy_DB = "**-**-**";
        string DeptName = string.Empty; string ProgName = string.Empty;
        private void Set_Report_Hierarchy(string Agy, string Dept, string Prog, string Year)
        {
            txtHieDesc.Clear();
            Current_Hierarchy = Agy + Dept + Prog;
            Current_Hierarchy_DB = Agy + "-" + Dept + "-" + Prog;
            strAgency = Agy;
            strDept = Dept;
            strProg = Prog;

            if (Agy != "**")
            {
                DataSet ds_AGY = Captain.DatabaseLayer.AgyTab.GetHierarchyNames(Agy, "**", "**");
                if (ds_AGY.Tables.Count > 0)
                {
                    if (ds_AGY.Tables[0].Rows.Count > 0)
                        txtHieDesc.Text += "AGY : " + Agy + " - " + (ds_AGY.Tables[0].Rows[0]["HIE_NAME"].ToString()).Trim() + "      ";
                }
            }
            else
                txtHieDesc.Text += "AGY : ** - All Agencies      ";

            if (Dept != "**")
            {
                DataSet ds_DEPT = Captain.DatabaseLayer.AgyTab.GetHierarchyNames(Agy, Dept, "**");
                if (ds_DEPT.Tables.Count > 0)
                {
                    if (ds_DEPT.Tables[0].Rows.Count > 0)
                    {
                        txtHieDesc.Text += "DEPT : " + Dept + " - " + (ds_DEPT.Tables[0].Rows[0]["HIE_NAME"].ToString()).Trim() + "      ";
                        DeptName = ds_DEPT.Tables[0].Rows[0]["HIE_NAME"].ToString().Trim() + "/";
                    }
                }
            }
            else
            {
                txtHieDesc.Text += "DEPT : ** - All Departments      ";
                DeptName = "All Departments /";
            }

            if (Prog != "**")
            {
                DataSet ds_PROG = Captain.DatabaseLayer.AgyTab.GetHierarchyNames(Agy, Dept, Prog);
                if (ds_PROG.Tables.Count > 0)
                {
                    if (ds_PROG.Tables[0].Rows.Count > 0)
                    {
                        txtHieDesc.Text += "PROG : " + Prog + " - " + (ds_PROG.Tables[0].Rows[0]["HIE_NAME"].ToString()).Trim();
                        ProgName = ds_PROG.Tables[0].Rows[0]["HIE_NAME"].ToString().Trim();
                    }
                }
            }
            else
            {
                txtHieDesc.Text += "PROG : ** - All Programs ";
                ProgName = "All Programs ";
            }


            //if (Agy != "**")
            //    Get_NameFormat_For_Agencirs(Agy);
            //else
            //    Member_NameFormat = CAseWorkerr_NameFormat = "1";

            if (Agy != "**" && Dept != "**" && Prog != "**")
                FillYearCombo(Agy, Dept, Prog, Year);
            else
            {
                CmbYear.Visible = false;
                //this.txtHieDesc.Size = new System.Drawing.Size(580, 23);
                this.txtHieDesc.Size = new System.Drawing.Size(666/*810*/, 25);
            }

        }

        List<SPCommonEntity> Fund_Mast_List = new List<SPCommonEntity>();
        private void Fill_Fund_Mast_List()
        {
            Fund_Mast_List = _model.SPAdminData.Get_AgyRecs("Funding");
            //if (Entity_List != null && Entity_List.Count > 0)
            //{
            //    FundingList.ForEach(item => item.Active = (Entity_List.Exists(u => u.Code.Equals(item.Code))) ? "true" : "false");
            //}
        }


        string DepYear, Program_Year;
        bool DefHieExist = false;
        private void FillYearCombo(string Agy, string Dept, string Prog, string Year)
        {
            CmbYear.Visible = DefHieExist = false;
            Program_Year = "    ";
            if (!string.IsNullOrEmpty(Year.Trim()))
                DefHieExist = true;

            DataSet ds = Captain.DatabaseLayer.MainMenu.GetCaseDepForHierarchy(Agy, Dept, Prog);
            if (ds.Tables.Count > 0)
            {
                DataTable dt = ds.Tables[0];
                int YearIndex = 0;

                if (dt.Rows.Count > 0)
                {
                    Program_Year = DepYear = dt.Rows[0]["DEP_YEAR"].ToString();
                    if (!(String.IsNullOrEmpty(DepYear.Trim())) && DepYear != null && DepYear != "    ")
                    {
                        int TmpYear = int.Parse(DepYear);
                        int TempCompareYear = 0;
                        string TmpYearStr = null;
                        if (!(String.IsNullOrEmpty(Year)) && Year != null && Year != " " && DefHieExist)
                            TempCompareYear = int.Parse(Year);
                        List<Captain.Common.Utilities.ListItem> listItem = new List<Captain.Common.Utilities.ListItem>();
                        for (int i = 0; i < 10; i++)
                        {
                            TmpYearStr = (TmpYear - i).ToString();
                            //listItem.Add(new ListItem(TmpYearStr, i));
                            listItem.Add(new Captain.Common.Utilities.ListItem(TmpYearStr, TmpYearStr));
                            if (TempCompareYear == (TmpYear - i) && TmpYear != 0 && TempCompareYear != 0)
                                YearIndex = i;
                        }

                        CmbYear.Items.AddRange(listItem.ToArray());

                        CmbYear.Visible = true;

                        if (DefHieExist)
                            CmbYear.SelectedIndex = YearIndex;
                        else
                            CmbYear.SelectedIndex = 0;
                    }
                }
            }

            if (!string.IsNullOrEmpty(Program_Year.Trim()))
            {
                //Current_Hierarchy = Current_Hierarchy + Program_Year;
                this.txtHieDesc.Size = new System.Drawing.Size(601/*753*/, 25);
            }
            else
                this.txtHieDesc.Size = new System.Drawing.Size(666/*810*/, 25);
        }


        private void Pb_Search_Hie_Click(object sender, EventArgs e)
        {

            ////HierarchieSelectionForm hierarchieSelectionForm = new HierarchieSelectionForm(BaseForm, "Master", Current_Hierarchy_DB, string.Empty, "Reports");
            ////hierarchieSelectionForm.FormClosed += new Form.FormClosedEventHandler(OnHierarchieFormClosed);
            ////hierarchieSelectionForm.ShowDialog();

            //HierarchieSelectionFormNew hierarchieSelectionForm = new HierarchieSelectionFormNew(BaseForm, Current_Hierarchy_DB, "Master", "A", "*", "Reports");
            //hierarchieSelectionForm.FormClosed += new FormClosedEventHandler(OnHierarchieFormClosed);
            //hierarchieSelectionForm.StartPosition = FormStartPosition.CenterScreen;
            //hierarchieSelectionForm.ShowDialog();

            HierarchieSelection hierarchieSelectionForm = new HierarchieSelection(BaseForm, Current_Hierarchy_DB, "Master", "A", "*", "Reports", BaseForm.UserID);
            hierarchieSelectionForm.FormClosed += new FormClosedEventHandler(OnHierarchieFormClosed);
            hierarchieSelectionForm.StartPosition = FormStartPosition.CenterScreen;
            hierarchieSelectionForm.ShowDialog();

        }


        private void OnHierarchieFormClosed(object sender, FormClosedEventArgs e)
        {
            //HierarchieSelectionFormNew form = sender as HierarchieSelectionFormNew;
            HierarchieSelection form = sender as HierarchieSelection;

            if (form.DialogResult == DialogResult.OK)
            {
                List<HierarchyEntity> selectedHierarchies = form.SelectedHierarchies;
                string hierarchy = string.Empty;

                if (selectedHierarchies.Count > 0)
                {
                    foreach (HierarchyEntity row in selectedHierarchies)
                    {
                        hierarchy += (string.IsNullOrEmpty(row.Agency) ? "**" : row.Agency) + (string.IsNullOrEmpty(row.Dept) ? "**" : row.Dept) + (string.IsNullOrEmpty(row.Prog) ? "**" : row.Prog);
                    }
                    Current_Hierarchy = hierarchy.Substring(0, 2) + hierarchy.Substring(2, 2) + hierarchy.Substring(4, 2);

                    Set_Report_Hierarchy(hierarchy.Substring(0, 2), hierarchy.Substring(2, 2), hierarchy.Substring(4, 2), string.Empty);
                    //Initialize_All_Controls();
                    //Fill_Program_Combo();
                    //** rbAllPrograms.Checked = true;
                    fillRngCode();
                }
            }
        }


        private void btnRepMaintPreview_Click(object sender, EventArgs e)
        {
            //string myPath = Context.Server.MapPath("~\\Resources\\Excel\\Sample.xlsx"); //(@"C:\sample.xlsx");
            //if (File.Exists(myPath))
            //{
            //    //excelApp.Workbooks.Open(myPath);
            //    //excelApp.Visible = true;
            //    FrmViewer objfrm = new FrmViewer(myPath);
            //    objfrm.Size = new System.Drawing.Size(100,40);
            //    objfrm.FormBorderStyle = Wisej.Web.FormBorderStyle.FixedDialog;
            //    objfrm.ShowDialog();

            //}

            PdfListForm pdfListForm = new PdfListForm(BaseForm, PrivilegeEntity, true, propReportPath);
            pdfListForm.StartPosition = FormStartPosition.CenterScreen;
            pdfListForm.ShowDialog();

        }

        private void CASB0004Form_Load(object sender, EventArgs e)
        {
            Cmb_CaseType.Focus();
        }


        List<DG_ResTab_Entity> PM_Detail_Table_List = new List<DG_ResTab_Entity>();
        private void Get_PM_Detail_Table_Structure()
        {
            //Declare @Detail_Cum_Table Table(SortUnDup_Group VarChar(10), SortUnDup_Table VarChar(10), SortUnDup_Agy Char(2), SortUnDup_Dept Char(2), SortUnDup_Prog Char(2), 
            //                                SortUnDup_Year VarChar(4), SortUnDup_App VarChar(8), SortUnDup_Fam_ID VarChar(9), SortUnDup_Client_ID Decimal(9),
            //                                SortUnDup_OutcomeCode Varchar(10), SortUnDup_OutCome_Date Date, SortUnDup_Count_Indicator Char(1), SortUnDup_Result Varchar(4), SortUnDup_Name Varchar(90), 
            //                                R1 Int Default 0, R2 Int Default 0, R3 Int Default 0, R4 Int Default 0, R5 Int Default 0)


            PM_Detail_Table_List.Clear();
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("N", "SortUnDup_Group", "", "L", "1in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("N", "SortUnDup_Table", "", "L", "1in"));
            //PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "SortUnDup_Agy", "", "L", "1.5in"));
            //Commented by Sudheer on 02/04/2021
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "SortUnDup_Agy", "", "L", "5.5in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("N", "SortUnDup_Dept", "", "L", "3.2in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("N", "SortUnDup_Prog", "", "L", "3.2in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("N", "SortUnDup_Year", "", "L", "3.2in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "SortUnDup_App", "", "L", ".95in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("N", "SortUnDup_Fam_ID", "", "L", "3.2in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("N", "SortUnDup_Client_ID", "", "L", "3.2in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "SortUnDup_Name", "", "L", "2.5in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("N", "SortUnDup_Count_Indicator", "", "L", "3.2in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("N", "SortUnDup_Result", "", "L", "3.2in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "R1", "", "R", ".65in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "R2", "", "R", ".65in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "R3", "", "R", ".65in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "R4", "", "R", ".65in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "R5", "", "R", ".65in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "SortUnDup_UserId", "", "L", "2.5in"));
            /** if (rdoperiodBoth.Checked)
             {
                 PM_Detail_Table_List.Add(new DG_ResTab_Entity("N", "SortUnDup_OutCome_Date", "", "R", ".95in"));
                 PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "SortUnDup_RefCount", "", "R", "1.5in"));
                 PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "SortUnDup_RefDate", "", "R", "1in"));
                 PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "SortUnDup_RepCount", "", "R", "1in"));
                 PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "SortUnDup_RepDate", "", "R", "1in"));

             }
             else
             {
                 PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "SortUnDup_OutCome_Date", "", "R", ".95in"));
                 PM_Detail_Table_List.Add(new DG_ResTab_Entity("N", "SortUnDup_RefCount", "", "R", ".95in"));
                 PM_Detail_Table_List.Add(new DG_ResTab_Entity("N", "SortUnDup_RefDate", "", "R", ".95in"));
                 PM_Detail_Table_List.Add(new DG_ResTab_Entity("N", "SortUnDup_RepCount", "", "R", ".95in"));
                 PM_Detail_Table_List.Add(new DG_ResTab_Entity("N", "SortUnDup_RepDate", "", "R", ".95in"));

             }*/
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "SortUnDup_OutcomeCode", "", "L", "0.8in"));
            //PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "SortUnDup_RePcount", "", "L", "1in"));
            //PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "SortUnDup_Refcount", "", "L", "1in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("N", "SortUnDup_Group_Desc", "", "R", ".85in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "SortUnDup_Goal_Desc", "", "L", "3.5in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "SortUnDup_Isite", "", "L", "1.5in"));
            PM_Detail_Table_List.Add(new DG_ResTab_Entity("Y", "SortUnDup_Psite", "", "L", "1.5in"));

        }

        DataTable dt;


        #region PdfReportCode




        //*****************PerformanceMeasures_Details_Dynamic_RDLC***********************************************************************************




        PdfContentByte cb;
        int X_Pos, Y_Pos;
        string Random_Filename = null;
        BaseFont bfTimes = BaseFont.CreateFont(BaseFont.TIMES_ROMAN, BaseFont.CP1252, false);
        string strReasonCodes = string.Empty;
        string PdfName;
        /**ivate void On_SaveForm_Closed(DataTable dtResult, DataTable dtResultBoth)
         {

             strReasonCodes = string.Empty;

             PdfName = "RNGB0014_MainReport";

             PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;

             try
             {
                 if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                 { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
             }
             catch (Exception ex)
             {
                 AlertBox.Show("Error", MessageBoxIcon.Error);
             }

             try
             {
                 string Tmpstr = PdfName + ".pdf";
                 if (File.Exists(Tmpstr))
                     File.Delete(Tmpstr);
             }
             catch (Exception ex)
             {
                 int length = 8;
                 string newFileName = System.Guid.NewGuid().ToString();
                 newFileName = newFileName.Replace("-", string.Empty);

                 Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
             }

             if (!string.IsNullOrEmpty(Random_Filename))
                 PdfName = Random_Filename;
             else
                 PdfName += ".pdf";

             FileStream fs = new FileStream(PdfName, FileMode.Create);

             Document document = new Document(PageSize.A4, 15, 15, 30, 30);
             PdfWriter writer = PdfWriter.GetInstance(document, fs);
             document.Open();
             BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);

             BaseFont bf_Times = BaseFont.CreateFont(BaseFont.TIMES_BOLD, BaseFont.CP1250, false);
             cb = writer.DirectContent;

             BaseFont bfTimes = BaseFont.CreateFont(BaseFont.TIMES_ROMAN, BaseFont.CP1250, false);
             BaseFont bfTimesBold = BaseFont.CreateFont(BaseFont.TIMES_BOLD, BaseFont.CP1250, false);
             iTextSharp.text.Font fc = new iTextSharp.text.Font(bfTimes, 12, 2);
             iTextSharp.text.Font fc1 = new iTextSharp.text.Font(bfTimes, 8, 2, BaseColor.BLUE);
             iTextSharp.text.Font fcRed = new iTextSharp.text.Font(bfTimes, 10, 1, BaseColor.RED);

             iTextSharp.text.Font Times = new iTextSharp.text.Font(bfTimes, 7);
             iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bfTimes, 8);
             iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bfTimes, 8, 3);
             iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(1, 7, 1);
             iTextSharp.text.Font TblFontHeadBold = new iTextSharp.text.Font(1, 12, 1);
             iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bfTimes, 8, 2);
             iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bfTimes, 9, 4);

             HeaderPage(document, writer);
             try
             {
                 document.SetPageSize(iTextSharp.text.PageSize.LETTER.Rotate());

                 document.NewPage();

                 //PdfPTable table = new PdfPTable(6);


                 // table.FooterRows = 3;

                 List<CommonEntity> commonHeaderlist = new List<CommonEntity>();

                 //cb.BeginText();
                 ////cb.SetFontAndSize(FontFactory.GetFont(FontFactory.TIMES_ROMAN).BaseFont, 12);
                 //cb.SetFontAndSize(bfTimes, 12);

                 ////List<CSB4AsocEntity> CSb4Entity;
                 ////CSb4Entity = _model.SPAdminData.Browse_CSB4Assoc(string.Empty, string.Empty);
                 //DataSet dscategories = DatabaseLayer.SPAdminDB.Get_RNG4CATG();

                 //cb.SetFontAndSize(bfTimesBold, 10);
                 //cb.SetRGBColorFill(4, 4, 15);
                 //X_Pos = 300; Y_Pos = 785;
                 //cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, "Module 4, Section A: Individual and Family National Performance Indicators (NPIs) - Data Entry Form", X_Pos, Y_Pos, 0);
                 //Y_Pos -= 15;
                 //cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, "Goal 1: Individuals and Families with low incomes are stable and achieve economic security. ", X_Pos, Y_Pos, 0);
                 //Y_Pos -= 15;
                 //cb.EndText();

                 // CaptainModel _model = new CaptainModel();

                 List<RCsb14GroupEntity> RngGrouplist = new List<RCsb14GroupEntity>();
                 List<RCsb14GroupEntity> RngtblCodelist = new List<RCsb14GroupEntity>();
                 List<RCsb14GroupEntity> RngResultlist = new List<RCsb14GroupEntity>();

                 List<RCsb14GroupEntity> RngBothResultlist = new List<RCsb14GroupEntity>();

                 if (rdoperiodBoth.Checked) //&& Rb_SNP_Mem.Checked)
                 {
                     foreach (DataRow drResultBothitem in dtResultBoth.Rows)
                     {
                         RngBothResultlist.Add(new RCsb14GroupEntity(drResultBothitem, ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString(), string.Empty));
                     }
                 }

                 foreach (DataRow drResultitem in dtResult.Rows)
                 {
                     RngResultlist.Add(new RCsb14GroupEntity(drResultitem, ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString(), string.Empty));
                 }

                 List<RNGGAEntity> GoalDetailsEntity = _model.SPAdminData.Browse_RNGGA(((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString(), ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).ID.ToString(), string.Empty, string.Empty, string.Empty);
                 if (RngCodelist.Count > 0)
                 {
                     RngGrouplist = RngCodelist.FindAll(u => u.GrpCode.Trim() != string.Empty && u.TblCode.Trim() == string.Empty && u.Agency == ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).ID.ToString() && u.Code == ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString());
                     RngtblCodelist = RngCodelist.FindAll(u => u.GrpCode.Trim() != string.Empty && u.TblCode.Trim() != string.Empty && u.Agency == ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).ID.ToString() && u.Code == ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString());
                 }
                 if (rdoOutcomesselect.Checked)
                 {

                     List<RCsb14GroupEntity> rngindswithclist = RngtblCodelist.FindAll(u => u.IndSwitch == "Y");
                     foreach (RCsb14GroupEntity itemindswitch in rngindswithclist)
                     {
                         List<RCsb14GroupEntity> rngtblcodelist = RngResultlist.FindAll(u => u.TblCode == itemindswitch.TblCode);
                         if (rngtblcodelist.Count == 0)
                         {
                             List<RNGGAEntity> GoalDetailsIndswitchEntity = GoalDetailsEntity.FindAll(u => u.TblCode.Trim() == itemindswitch.TblCode.Trim() && u.GrpCode.Trim() == itemindswitch.GrpCode.Trim() && u.Code.Trim() == ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString().Trim());
                             foreach (RNGGAEntity itemGoalind in GoalDetailsIndswitchEntity)
                             {
                                 RngResultlist.Add(new RCsb14GroupEntity(((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString(), itemindswitch.GrpCode, itemindswitch.TblCode, itemGoalind.Desc, "0", "0", "0", "0", "0", itemindswitch.unit_cnt, itemindswitch.ExAchev, itemindswitch.per_Achived, itemindswitch.CalCost, itemindswitch.Count_type, "INDSWITCH"));
                             }

                         }
                         if (rdoperiodBoth.Checked) //&& Rb_SNP_Mem.Checked)
                         {
                             List<RCsb14GroupEntity> rngtblbothcodelist = RngBothResultlist.FindAll(u => u.TblCode == itemindswitch.TblCode);
                             if (rngtblcodelist.Count == 0)
                             {
                                 List<RNGGAEntity> GoalDetailsIndswitchEntity = GoalDetailsEntity.FindAll(u => u.TblCode.Trim() == itemindswitch.TblCode.Trim() && u.GrpCode.Trim() == itemindswitch.GrpCode.Trim() && u.Code.Trim() == ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString().Trim());
                                 foreach (RNGGAEntity itemGoalind in GoalDetailsIndswitchEntity)
                                 {
                                     RngBothResultlist.Add(new RCsb14GroupEntity(((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString(), itemindswitch.GrpCode, itemindswitch.TblCode, itemGoalind.Desc, "0", "0", "0", "0", "0", itemindswitch.unit_cnt, itemindswitch.ExAchev, itemindswitch.per_Achived, itemindswitch.CalCost, itemindswitch.Count_type, "INDSWITCH"));
                                 }
                             }
                         }
                     }
                 }



                 bool boolGroupFilter = true;
                 bool boolGoalAssoFilter = true;

                 foreach (RCsb14GroupEntity codeitem in RngGrouplist)
                 {

                     if (Rb_User_Def.Checked)
                     {
                         boolGoalAssoFilter = false;
                         if (GoalDetailsEntity.FindAll(u => u.GrpCode.Trim() == codeitem.GrpCode.Trim()).Count > 0)
                             boolGoalAssoFilter = true;
                     }
                     if (Rb_SP_Sel.Checked)
                     {
                         boolGroupFilter = false;
                         if (ListRngGroupCode.FindAll(u => u.GrpCode.Trim() == codeitem.GrpCode.Trim()).Count > 0)
                             boolGroupFilter = true;
                     }
                     string Agy = string.Empty;
                     if (Current_Hierarchy.Substring(0, 2).ToString() != "**")
                         Agy = Current_Hierarchy.Substring(0, 2);
                     string Agency = string.Empty;
                     DataSet dsAgency = new DataSet();
                     if (!string.IsNullOrEmpty(Agy.Trim()))
                     {
                         dsAgency = Captain.DatabaseLayer.ADMNB001DB.ADMNB001_Browse_AGCYCNTL(Agy, null, null, null, null, null, null);
                         if (dsAgency != null && dsAgency.Tables[0].Rows.Count > 0)
                             Agency = dsAgency.Tables[0].Rows[0]["ACR_NAME"].ToString().Trim();
                     }

                     if ((boolGroupFilter) && (boolGoalAssoFilter))
                     {
                         string strResultColumn = codeitem.ExAchev.ToString();
                         //PdfPCell pdfMainHeader = new PdfPCell(new Phrase("Module 4, Section A: Individual and Family National Performance Indicators (NPIs) - Data Entry Form", TblFontHeadBold));
                         //pdfMainHeader.HorizontalAlignment = Element.ALIGN_CENTER;
                         //pdfMainHeader.Border = iTextSharp.text.Rectangle.NO_BORDER;
                         //pdfMainHeader.Colspan = 6;
                         //table.AddCell(pdfMainHeader);

                         //PdfPCell pdfMainHeader2 = new PdfPCell(new Phrase("Goal 1: Individuals and Families with low incomes are stable and achieve economic security. ", TblFontHeadBold));
                         //pdfMainHeader2.HorizontalAlignment = Element.ALIGN_CENTER;
                         //pdfMainHeader2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                         //pdfMainHeader2.Colspan = 6;
                         //table.AddCell(pdfMainHeader2);

                         PdfPTable table = new PdfPTable(6);
                         table.WidthPercentage = 100;
                         table.LockedWidth = true;

                         table.TotalWidth = 750f;

                         float[] widths = new float[] { 250f, 60f, 60f, 60f, 60f, 60f };
                         table.SetWidths(widths);


                         table.HeaderRows = 2;
                         table.HorizontalAlignment = Element.ALIGN_CENTER;



                         PdfPCell pdfMainSubHeader = new PdfPCell(new Phrase(codeitem.GrpDesc, fcRed));//+ " Indicators"
                         pdfMainSubHeader.HorizontalAlignment = Element.ALIGN_CENTER;
                         pdfMainSubHeader.Border = iTextSharp.text.Rectangle.NO_BORDER;
                         pdfMainSubHeader.Colspan = 6;
                         table.AddCell(pdfMainSubHeader);


                         //PdfPCell pdfMainSubHeader1 = new PdfPCell(new Phrase("Name of CSBG Eligible Entity Reporting: __________________________________", TableFont));
                         //pdfMainSubHeader1.HorizontalAlignment = Element.ALIGN_RIGHT;
                         //pdfMainSubHeader1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                         //pdfMainSubHeader1.Colspan = 6;
                         //table.AddCell(pdfMainSubHeader1);

                         //Added by Sudheer on 06/30/2018
                         PdfPCell pdfMainSubHeader1 = new PdfPCell(new Phrase("Department/Program: " + DeptName + ProgName, TableFont));
                         pdfMainSubHeader1.HorizontalAlignment = Element.ALIGN_LEFT;
                         pdfMainSubHeader1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                         pdfMainSubHeader1.Colspan = 6;
                         table.AddCell(pdfMainSubHeader1);



                         int intcolumns = 6;
                         int intheadercount = 0;
                         if (codeitem.Incld1.ToString().ToUpper() == "TRUE")
                             intheadercount = intheadercount + 1;
                         if (codeitem.Incld2.ToString().ToUpper() == "TRUE")
                             intheadercount = intheadercount + 1;
                         if (codeitem.Incld3.ToString().ToUpper() == "TRUE")
                             intheadercount = intheadercount + 1;
                         if (codeitem.Incld4.ToString().ToUpper() == "TRUE")
                             intheadercount = intheadercount + 1;
                         if (codeitem.Incld5.ToString().ToUpper() == "TRUE")
                             intheadercount = intheadercount + 1;
                         if (strResultColumn == "0")
                             intheadercount = intheadercount + 1;
                         if (intheadercount > 1)
                             intcolumns = intcolumns + (intheadercount - 1);

                         PdfPTable subtable = new PdfPTable(intcolumns);

                         subtable.WidthPercentage = 100;
                         subtable.LockedWidth = true;

                         subtable.TotalWidth = 750f;

                         float[] subwidths = null;
                         if (intcolumns == 6)
                             subwidths = new float[] { 250f, 60f, 60f, 60f, 60f, 60f };
                         if (intcolumns == 7)
                             subwidths = new float[] { 250f, 60f, 60f, 60f, 60f, 60f, 60f };
                         if (intcolumns == 8)
                             subwidths = new float[] { 250f, 60f, 60f, 60f, 60f, 60f, 60f, 60f };
                         if (intcolumns == 9)
                             subwidths = new float[] { 250f, 60f, 60f, 60f, 60f, 60f, 60f, 60f, 60f };
                         if (intcolumns == 10)
                             subwidths = new float[] { 250f, 60f, 60f, 60f, 60f, 60f, 60f, 60f, 60f, 60f };
                         if (intcolumns == 11)
                             subwidths = new float[] { 250f, 60f, 60f, 60f, 60f, 60f, 60f, 60f, 60f, 60f, 60f };

                         subtable.SetWidths(subwidths);

                         PdfPCell pdfMainSubHeader2 = new PdfPCell(new Phrase("Name of CSBG Eligible Entity Reporting:  ", TblFontBold));
                         pdfMainSubHeader2.HorizontalAlignment = Element.ALIGN_LEFT;
                         pdfMainSubHeader2.Border = iTextSharp.text.Rectangle.BOX;
                         //pdfMainSubHeader2.Colspan = 6;
                         subtable.AddCell(pdfMainSubHeader2);

                         PdfPCell pdfMainSubHeader3 = new PdfPCell(new Phrase(Agency, TableFont));
                         pdfMainSubHeader3.HorizontalAlignment = Element.ALIGN_LEFT;
                         pdfMainSubHeader3.Border = iTextSharp.text.Rectangle.BOX;
                         pdfMainSubHeader3.Colspan = intcolumns - 1;
                         subtable.AddCell(pdfMainSubHeader3);

                         PdfPCell pdfMainSubHeader4 = new PdfPCell(new Phrase("State:  ", TblFontBold));
                         pdfMainSubHeader4.HorizontalAlignment = Element.ALIGN_LEFT;
                         pdfMainSubHeader4.Border = iTextSharp.text.Rectangle.BOX;
                         //pdfMainSubHeader2.Colspan = 6;
                         subtable.AddCell(pdfMainSubHeader4);

                         PdfPCell pdfMainSubHeader5 = new PdfPCell(new Phrase("DUNS: ", TblFontBold));
                         pdfMainSubHeader5.HorizontalAlignment = Element.ALIGN_LEFT;
                         pdfMainSubHeader5.Border = iTextSharp.text.Rectangle.BOX;
                         pdfMainSubHeader5.Colspan = intcolumns - 1;
                         subtable.AddCell(pdfMainSubHeader5);

                         PdfPCell pdfMainSubHeaderSpace = new PdfPCell(new Phrase("", TableFont));
                         pdfMainSubHeaderSpace.HorizontalAlignment = Element.ALIGN_RIGHT;
                         pdfMainSubHeaderSpace.Border = iTextSharp.text.Rectangle.NO_BORDER;
                         pdfMainSubHeaderSpace.Colspan = intcolumns;
                         subtable.AddCell(pdfMainSubHeaderSpace);

                         PdfPCell pdfMainTableHeader1 = new PdfPCell(new Phrase("", TblFontBold));
                         pdfMainTableHeader1.HorizontalAlignment = Element.ALIGN_RIGHT;
                         pdfMainTableHeader1.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                         pdfMainTableHeader1.Border = iTextSharp.text.Rectangle.TOP_BORDER + iTextSharp.text.Rectangle.LEFT_BORDER;
                         subtable.AddCell(pdfMainTableHeader1);

                         PdfPCell pdfMainTableHeader2 = new PdfPCell(new Phrase("I.) Number of Individuals Served ", TblFontBold));
                         pdfMainTableHeader2.HorizontalAlignment = Element.ALIGN_LEFT;
                         pdfMainTableHeader2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                         pdfMainTableHeader2.Border = iTextSharp.text.Rectangle.TOP_BORDER + iTextSharp.text.Rectangle.LEFT_BORDER;
                         subtable.AddCell(pdfMainTableHeader2);


                         PdfPCell pdfMainTableHeader3 = new PdfPCell(new Phrase("II.) Target (#)", TblFontBold));
                         pdfMainTableHeader3.HorizontalAlignment = Element.ALIGN_LEFT;
                         pdfMainTableHeader3.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                         pdfMainTableHeader3.Border = iTextSharp.text.Rectangle.TOP_BORDER + iTextSharp.text.Rectangle.LEFT_BORDER;
                         subtable.AddCell(pdfMainTableHeader3);

                         PdfPCell pdfMainTableHeader4 = new PdfPCell(new Phrase("III.) Actual Results (#) ", TblFontBold));
                         pdfMainTableHeader4.HorizontalAlignment = Element.ALIGN_LEFT;
                         pdfMainTableHeader4.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                         pdfMainTableHeader4.Border = iTextSharp.text.Rectangle.TOP_BORDER + iTextSharp.text.Rectangle.LEFT_BORDER;
                         subtable.AddCell(pdfMainTableHeader4);

                         int intcolumnscount = 3;
                         if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                         {
                             intcolumnscount = intcolumnscount + 1;
                             PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(HeadersValue(intcolumnscount) + codeitem.Hrd1, TblFontBold));
                             pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_LEFT;
                             pdfMainTableIncld2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                             pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.TOP_BORDER + iTextSharp.text.Rectangle.LEFT_BORDER;
                             subtable.AddCell(pdfMainTableIncld2);
                         }

                         if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                         {
                             intcolumnscount = intcolumnscount + 1;
                             PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(HeadersValue(intcolumnscount) + codeitem.Hrd2, TblFontBold));
                             pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_LEFT;
                             pdfMainTableIncld2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                             pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.TOP_BORDER + iTextSharp.text.Rectangle.LEFT_BORDER;
                             subtable.AddCell(pdfMainTableIncld2);
                         }
                         if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                         {
                             intcolumnscount = intcolumnscount + 1;
                             PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(HeadersValue(intcolumnscount) + codeitem.Hrd3, TblFontBold));
                             pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_LEFT;
                             pdfMainTableIncld2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                             pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.TOP_BORDER + iTextSharp.text.Rectangle.LEFT_BORDER;
                             subtable.AddCell(pdfMainTableIncld2);
                         }
                         if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                         {
                             intcolumnscount = intcolumnscount + 1;
                             PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(HeadersValue(intcolumnscount) + codeitem.Hrd4, TblFontBold));
                             pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_LEFT;
                             pdfMainTableIncld2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                             pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.TOP_BORDER + iTextSharp.text.Rectangle.LEFT_BORDER;
                             subtable.AddCell(pdfMainTableIncld2);
                         }
                         if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                         {
                             intcolumnscount = intcolumnscount + 1;
                             PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(HeadersValue(intcolumnscount) + codeitem.Hrd5, TblFontBold));
                             pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_LEFT;
                             pdfMainTableIncld2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                             pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.TOP_BORDER + iTextSharp.text.Rectangle.LEFT_BORDER;
                             subtable.AddCell(pdfMainTableIncld2);
                         }

                         intcolumnscount = intcolumnscount + 1;
                         PdfPCell pdfMainTableHeader5 = new PdfPCell(new Phrase(HeadersValue(intcolumnscount) + "Percentage Achieving Outcome ", TblFontBold));
                         pdfMainTableHeader5.HorizontalAlignment = Element.ALIGN_LEFT;
                         pdfMainTableHeader5.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                         pdfMainTableHeader5.Border = iTextSharp.text.Rectangle.TOP_BORDER + iTextSharp.text.Rectangle.LEFT_BORDER + iTextSharp.text.Rectangle.RIGHT_BORDER;
                         subtable.AddCell(pdfMainTableHeader5);

                         intcolumnscount = intcolumnscount + 1;
                         PdfPCell pdfMainTableHeader6 = new PdfPCell(new Phrase(HeadersValue(intcolumnscount) + "Performance Target Accuracy ", TblFontBold));
                         pdfMainTableHeader6.HorizontalAlignment = Element.ALIGN_LEFT;
                         pdfMainTableHeader6.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                         pdfMainTableHeader6.Border = iTextSharp.text.Rectangle.TOP_BORDER + iTextSharp.text.Rectangle.RIGHT_BORDER + iTextSharp.text.Rectangle.LEFT_BORDER;
                         subtable.AddCell(pdfMainTableHeader6);

                         PdfPCell pdfMainTableSubHeader1 = new PdfPCell(new Phrase(codeitem.GrpDesc, TblFontBold));
                         pdfMainTableSubHeader1.HorizontalAlignment = Element.ALIGN_CENTER;
                         pdfMainTableSubHeader1.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                         pdfMainTableSubHeader1.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                         subtable.AddCell(pdfMainTableSubHeader1);

                         PdfPCell pdfMainTableSubHeader2 = new PdfPCell(new Phrase("in program(s) (#)", TableFont));
                         pdfMainTableSubHeader2.HorizontalAlignment = Element.ALIGN_CENTER;
                         pdfMainTableSubHeader2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                         pdfMainTableSubHeader2.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                         subtable.AddCell(pdfMainTableSubHeader2);

                         PdfPCell pdfMainTableSubHeader3 = new PdfPCell(new Phrase("", TableFont));
                         pdfMainTableSubHeader3.HorizontalAlignment = Element.ALIGN_CENTER;
                         pdfMainTableSubHeader3.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                         pdfMainTableSubHeader3.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                         subtable.AddCell(pdfMainTableSubHeader3);

                         PdfPCell pdfMainTableSubHeader4 = new PdfPCell(new Phrase("", TableFont));
                         pdfMainTableSubHeader4.HorizontalAlignment = Element.ALIGN_CENTER;
                         pdfMainTableSubHeader4.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                         pdfMainTableSubHeader4.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                         subtable.AddCell(pdfMainTableSubHeader4);

                         if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                         {
                             PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("", TblFontBold));
                             pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_LEFT;
                             pdfMainTableIncld2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                             pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                             subtable.AddCell(pdfMainTableIncld2);
                         }
                         if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                         {
                             PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("", TblFontBold));
                             pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_LEFT;
                             pdfMainTableIncld2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                             pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                             subtable.AddCell(pdfMainTableIncld2);
                         }
                         if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                         {
                             PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("", TblFontBold));
                             pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_LEFT;
                             pdfMainTableIncld2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                             pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                             subtable.AddCell(pdfMainTableIncld2);
                         }
                         if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                         {
                             PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("", TblFontBold));
                             pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_LEFT;
                             pdfMainTableIncld2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                             pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                             subtable.AddCell(pdfMainTableIncld2);
                         }
                         if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                         {
                             PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("", TblFontBold));
                             pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_LEFT;
                             pdfMainTableIncld2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                             pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                             subtable.AddCell(pdfMainTableIncld2);
                         }


                         PdfPCell pdfMainTableSubHeader5 = new PdfPCell(new Phrase("[III/ I = " + HeadersValue1(intcolumnscount - 1) + " ] (% auto calculated) ", TableFont));
                         pdfMainTableSubHeader5.HorizontalAlignment = Element.ALIGN_CENTER;
                         pdfMainTableSubHeader5.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                         pdfMainTableSubHeader5.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                         subtable.AddCell(pdfMainTableSubHeader5);

                         PdfPCell pdfMainTableSubHeader6 = new PdfPCell(new Phrase("(III/II = " + HeadersValue1(intcolumnscount) + " ] (% auto calculated) ", TableFont));
                         pdfMainTableSubHeader6.HorizontalAlignment = Element.ALIGN_CENTER;
                         pdfMainTableSubHeader6.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                         pdfMainTableSubHeader6.Border = iTextSharp.text.Rectangle.LEFT_BORDER + iTextSharp.text.Rectangle.RIGHT_BORDER;
                         subtable.AddCell(pdfMainTableSubHeader6);



                         if (rdoperiodBoth.Checked)
                         {
                             PdfPCell pdfMainTablebothSubHeader1 = new PdfPCell(new Phrase("", TblFontBold));
                             pdfMainTablebothSubHeader1.HorizontalAlignment = Element.ALIGN_CENTER;
                             pdfMainTablebothSubHeader1.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                             pdfMainTablebothSubHeader1.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                             subtable.AddCell(pdfMainTablebothSubHeader1);

                             PdfPCell pdfMainTablebothSubHeader2 = new PdfPCell(new Phrase("Rept. | Ref.", TableFont));
                             pdfMainTablebothSubHeader2.HorizontalAlignment = Element.ALIGN_CENTER;
                             pdfMainTablebothSubHeader2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                             pdfMainTablebothSubHeader2.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                             subtable.AddCell(pdfMainTablebothSubHeader2);

                             PdfPCell pdfMainTablebothSubHeader3 = new PdfPCell(new Phrase("", TableFont));
                             pdfMainTablebothSubHeader3.HorizontalAlignment = Element.ALIGN_CENTER;
                             pdfMainTablebothSubHeader3.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                             pdfMainTablebothSubHeader3.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                             subtable.AddCell(pdfMainTablebothSubHeader3);

                             PdfPCell pdfMainTablebothSubHeader4 = new PdfPCell(new Phrase("Rept. | Ref.", TableFont));
                             pdfMainTablebothSubHeader4.HorizontalAlignment = Element.ALIGN_CENTER;
                             pdfMainTablebothSubHeader4.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                             pdfMainTablebothSubHeader4.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                             subtable.AddCell(pdfMainTablebothSubHeader4);

                             if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                             {
                                 PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("Rept. | Ref.", TblFontBold));
                                 pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                 pdfMainTableIncld2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                 pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                                 subtable.AddCell(pdfMainTableIncld2);
                             }
                             if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                             {
                                 PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("Rept. | Ref.", TblFontBold));
                                 pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                 pdfMainTableIncld2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                 pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                                 subtable.AddCell(pdfMainTableIncld2);
                             }
                             if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                             {
                                 PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("Rept. | Ref.", TblFontBold));
                                 pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                 pdfMainTableIncld2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                 pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                                 subtable.AddCell(pdfMainTableIncld2);
                             }
                             if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                             {
                                 PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("Rept. | Ref.", TblFontBold));
                                 pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                 pdfMainTableIncld2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                 pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                                 subtable.AddCell(pdfMainTableIncld2);
                             }
                             if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                             {
                                 PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("Rept. | Ref.", TblFontBold));
                                 pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                 pdfMainTableIncld2.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                 pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                                 subtable.AddCell(pdfMainTableIncld2);
                             }


                             PdfPCell pdfMainTablebothSubHeader5 = new PdfPCell(new Phrase("Rept. | Ref.", TableFont));
                             pdfMainTablebothSubHeader5.HorizontalAlignment = Element.ALIGN_CENTER;
                             pdfMainTablebothSubHeader5.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                             pdfMainTablebothSubHeader5.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                             subtable.AddCell(pdfMainTablebothSubHeader5);

                             PdfPCell pdfMainTablebothSubHeader6 = new PdfPCell(new Phrase("Rept. | Ref.", TableFont));
                             pdfMainTablebothSubHeader6.HorizontalAlignment = Element.ALIGN_CENTER;
                             pdfMainTablebothSubHeader6.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                             pdfMainTablebothSubHeader6.Border = iTextSharp.text.Rectangle.LEFT_BORDER + iTextSharp.text.Rectangle.RIGHT_BORDER;
                             subtable.AddCell(pdfMainTablebothSubHeader6);



                         }



                         RngtblCodelist = RngCodelist.FindAll(u => u.GrpCode.Trim() == codeitem.GrpCode.Trim() && u.Code.Trim() == codeitem.Code.Trim() && u.TblCode.Trim() != string.Empty && u.Agency == ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).ID.ToString());

                         bool boolOutComesDetails = true;


                         string intcount1, intcount2, intcout3, intcount4, intcount5;
                         string intcummulativecount1, intcummulativecount2, intcummulativecout3, intcummulativecount4, intcummulativecount5;
                         string strIndSwitch = string.Empty;
                         foreach (RCsb14GroupEntity tblEnt in RngtblCodelist)
                         {
                             strIndSwitch = tblEnt.IndSwitch.ToString();

                             if (rdoOutcomesselect.Checked)
                             {
                                 boolOutComesDetails = false;

                                 if (strIndSwitch == "Y")
                                 {
                                     boolOutComesDetails = true;

                                 }
                                 else
                                 {
                                     if (rdoperiodBoth.Checked)
                                     {
                                         RCsb14GroupEntity rngcountdata = RngBothResultlist.Find(u => u.GrpCode.Trim() == codeitem.GrpCode.Trim() && u.Code.Trim() == codeitem.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.unit_cnt.Trim() != "" && u.unit_cnt.Trim() != "0" && u.unit_cnt.Trim().ToUpper() != "UNIT COUNT");
                                         if (rngcountdata != null)
                                         {
                                             boolOutComesDetails = true;
                                         }
                                     }
                                     else
                                     {
                                         RCsb14GroupEntity rngcountdata = RngResultlist.Find(u => u.GrpCode.Trim() == codeitem.GrpCode.Trim() && u.Code.Trim() == codeitem.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.unit_cnt.Trim() != "" && u.unit_cnt.Trim() != "0" && u.unit_cnt.Trim().ToUpper() != "UNIT COUNT");
                                         if (rngcountdata != null)
                                         {
                                             boolOutComesDetails = true;
                                         }
                                     }
                                 }

                             }

                             if (boolOutComesDetails)
                             {

                                 if (Rb_User_Def.Checked)
                                 {
                                     boolGoalAssoFilter = false;
                                     if (strIndSwitch == "Y")
                                     {
                                         boolGoalAssoFilter = true;
                                     }
                                     else
                                     {
                                         if (GoalDetailsEntity.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim()).Count > 0)
                                             boolGoalAssoFilter = true;
                                     }
                                 }
                                 if (boolGoalAssoFilter)
                                 {



                                     intcount1 = intcount2 = intcout3 = "0";
                                     intcount4 = intcount5 = string.Empty;
                                     RCsb14GroupEntity rngcountdata = null;
                                     if (strIndSwitch == "Y" && rdoOutcomesselect.Checked)
                                     {
                                         if (Rb_SNP_Mem.Checked || rbo_ProgramWise.Checked)
                                         {
                                             rngcountdata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDesc" && u.Count_type.ToString().Trim() == string.Empty);
                                         }
                                         else
                                         {
                                             if (rdoperiodCumulative.Checked)
                                                 rngcountdata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "RefCnt");
                                             else
                                                 rngcountdata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrdCnt");
                                         }
                                         if (rngcountdata == null)
                                             rngcountdata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim());
                                     }
                                     else
                                     {
                                         if (Rb_SNP_Mem.Checked || rbo_ProgramWise.Checked)
                                         {
                                             rngcountdata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDesc" && u.Count_type.ToString().Trim() == string.Empty);
                                         }
                                         else
                                         {
                                             if (rdoperiodCumulative.Checked)
                                                 rngcountdata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "RefCnt");
                                             else
                                                 rngcountdata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrdCnt");
                                         }
                                     }
                                     if (rngcountdata != null)
                                     {
                                         PdfPCell pdfDetailsTable1 = new PdfPCell(new Phrase(tblEnt.TblCode.Trim() + "." + tblEnt.GrpDesc.ToString(), TblFontBold));
                                         pdfDetailsTable1.HorizontalAlignment = Element.ALIGN_LEFT;
                                         pdfDetailsTable1.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                         pdfDetailsTable1.Border = iTextSharp.text.Rectangle.BOX;
                                         subtable.AddCell(pdfDetailsTable1);

                                         if (strIndSwitch == "Y")
                                         {
                                             //DataTable dtappcount = Result_Table.Select("SORTUNDUP_APP <>''").CopyToDataTable();
                                             //// DataRow[] dr = dtappcount.Select("GROUP BY SortUnDup_Agy,SortUnDup_Dept,SortUnDup_Prog,SortUnDup_Year,SortUnDup_App,SortUnDup_Fam_ID,SortUnDup_Client_ID");

                                             //List<DataTable> dtAssess = dtappcount.AsEnumerable().GroupBy(row => new { SortUnDup_Agy = row.Field<string>("SortUnDup_Agy"), SortUnDup_Dept = row.Field<string>("SortUnDup_Dept"), SortUnDup_Prog = row.Field<string>("SortUnDup_Prog"), SortUnDup_Year = row.Field<string>("SortUnDup_Year"), SortUnDup_App = row.Field<string>("SortUnDup_App"), SortUnDup_Fam_ID = row.Field<string>("SortUnDup_Fam_ID"), SortUnDup_Client_ID = row.Field<decimal>("SortUnDup_Client_ID") }).Select(g => g.CopyToDataTable()).ToList();

                                             ////DataTable dtappcount1 =  dtappcount.AsEnumerable()
                                             ////    .GroupBy(r => new { SortUnDup_Agy = r["SortUnDup_Agy"], SortUnDup_Dept = r["SortUnDup_Dept"], SortUnDup_Prog = r["SortUnDup_Prog"], SortUnDup_Year = r["SortUnDup_Year"], SortUnDup_App = r["SortUnDup_App"], SortUnDup_Fam_ID = r["SortUnDup_Fam_ID"], SortUnDup_Client_ID = r["SortUnDup_Client_ID"] })
                                             ////    .Select(g =>
                                             ////    {
                                             ////        var row = dt.NewRow();

                                             ////        row["SortUnDup_Agy"] = g.Key.SortUnDup_Agy;
                                             ////        row["SortUnDup_Dept"] = g.Key.SortUnDup_Dept;
                                             ////        row["SortUnDup_Prog"] = g.Key.SortUnDup_Prog;
                                             ////        row["SortUnDup_Year"] = g.Key.SortUnDup_Year;
                                             ////        row["SortUnDup_App"] = g.Key.SortUnDup_App;
                                             ////        row["SortUnDup_Fam_ID"] = g.Key.SortUnDup_Fam_ID;
                                             ////        row["SortUnDup_Client_ID"] = g.Key.SortUnDup_Client_ID;

                                             ////        return row;

                                             ////    })
                                             ////    .CopyToDataTable();

                                             ////DataRow[] dr= dtappcount.AsEnumerable().GroupBy(r => new { Col1 = r["SortUnDup_Agy"], Col2 = r["SortUnDup_Dept"], Col3 = r["SortUnDup_Prog"], Col4 = r["SortUnDup_Year"], Col5 = r["SortUnDup_App"], Col6 = r["SortUnDup_Fam_ID"], Col7 = r["SortUnDup_Client_ID"] });
                                             ////DataView dvResult = ;
                                             ////dvResult.fi
                                             //if (rdoperiodBoth.Checked)
                                             //{
                                             //    intcount1 = IndSwitchReport_Table.Rows.Count.ToString();
                                             //}
                                             //else
                                             intcount1 = IndSwitch_Table.Rows.Count.ToString();

                                             intcount2 = rngcountdata.ExAchev.ToString();
                                             intcout3 = "0";

                                         }
                                         else
                                         {

                                             intcount1 = rngcountdata.unit_cnt.ToString();
                                             intcount2 = rngcountdata.ExAchev.ToString();
                                             switch (strResultColumn)
                                             {
                                                 case "0":
                                                     intcout3 = rngcountdata.unit_cnt.ToString();
                                                     break;
                                                 case "1":
                                                     intcout3 = rngcountdata.Hrd1.ToString();
                                                     break;
                                                 case "2":
                                                     intcout3 = rngcountdata.Hrd2.ToString();
                                                     break;
                                                 case "3":
                                                     intcout3 = rngcountdata.Hrd3.ToString();
                                                     break;
                                                 case "4":
                                                     intcout3 = rngcountdata.Hrd4.ToString();
                                                     break;
                                                 case "5":
                                                     intcout3 = rngcountdata.Hrd5.ToString();
                                                     break;
                                                 default:
                                                     intcout3 = rngcountdata.Hrd1.ToString();
                                                     break;
                                             }
                                         }
                                         if (intcout3.Trim() != string.Empty && intcout3 != "0")
                                         {
                                             if (intcount1.Trim() != string.Empty && intcount1 != "0")
                                             {
                                                 intcount4 = ((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount1)) * 100).ToString();
                                                 if (intcount4.Length > 4)
                                                     intcount4 = intcount4.Substring(0, 4);
                                             }
                                             if (intcount2.Trim() != string.Empty && intcount2 != "0")
                                             {
                                                 intcount5 = (((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount2))) * 100).ToString();
                                                 if (intcount5.Length > 4)
                                                     intcount5 = intcount5.Substring(0, 4);
                                             }

                                         }


                                         if (rdoperiodBoth.Checked)
                                         {
                                             //PdfPCell pdfDetailstotalTable1 = new PdfPCell(new Phrase("", TableFont));
                                             //pdfDetailstotalTable1.HorizontalAlignment = Element.ALIGN_LEFT;
                                             //pdfDetailstotalTable1.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                             //pdfDetailstotalTable1.Border = iTextSharp.text.Rectangle.BOX;
                                             //subtable.AddCell(pdfDetailstotalTable1);


                                             intcummulativecount1 = intcummulativecount2 = intcummulativecout3 = "0";
                                             intcummulativecount4 = intcummulativecount5 = string.Empty;
                                             RCsb14GroupEntity rngcummulativecounttotaldata = null;
                                             if (strIndSwitch == "Y" && rdoOutcomesselect.Checked)
                                             {
                                                 if (!Rb_SNP_Mem.Checked)
                                                     rngcummulativecounttotaldata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "RefCnt");
                                                 else
                                                 {
                                                     if (rdoperiodBoth.Checked)
                                                     {
                                                         rngcummulativecounttotaldata = RngBothResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDesc" && u.Count_type.ToString().Trim() == string.Empty);
                                                     }
                                                     else
                                                         rngcummulativecounttotaldata = rngcountdata;
                                                 }
                                                 if (rngcummulativecounttotaldata == null)
                                                     rngcummulativecounttotaldata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim());
                                             }
                                             else
                                             {
                                                 if (!Rb_SNP_Mem.Checked)
                                                 {
                                                     rngcummulativecounttotaldata = RngBothResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "RefCnt");
                                                     // rngcummulativecounttotaldata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "RefCnt");
                                                 }
                                                 else
                                                 {
                                                     if (rdoperiodBoth.Checked)
                                                     {
                                                         rngcummulativecounttotaldata = RngBothResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDesc" && u.Count_type.ToString().Trim() == string.Empty);
                                                     }
                                                     else
                                                         rngcummulativecounttotaldata = rngcountdata;
                                                 }
                                             }
                                             if (rngcummulativecounttotaldata != null)
                                             {
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     if (rdoperiodBoth.Checked)
                                                         intcummulativecount1 = IndSwitchReport_Table.Rows.Count.ToString();
                                                     else
                                                         intcummulativecount1 = IndSwitch_Table.Rows.Count.ToString();
                                                     intcummulativecount2 = rngcummulativecounttotaldata.ExAchev.ToString();
                                                     intcummulativecout3 = "0";
                                                 }
                                                 else
                                                 {
                                                     intcummulativecount1 = rngcummulativecounttotaldata.unit_cnt.ToString();
                                                     intcummulativecount2 = rngcummulativecounttotaldata.ExAchev.ToString();
                                                     switch (strResultColumn)
                                                     {
                                                         case "0":
                                                             intcummulativecout3 = rngcummulativecounttotaldata.unit_cnt.ToString();
                                                             break;
                                                         case "1":
                                                             intcummulativecout3 = rngcummulativecounttotaldata.Hrd1.ToString();
                                                             break;
                                                         case "2":
                                                             intcummulativecout3 = rngcummulativecounttotaldata.Hrd2.ToString();
                                                             break;
                                                         case "3":
                                                             intcummulativecout3 = rngcummulativecounttotaldata.Hrd3.ToString();
                                                             break;
                                                         case "4":
                                                             intcummulativecout3 = rngcummulativecounttotaldata.Hrd4.ToString();
                                                             break;
                                                         case "5":
                                                             intcummulativecout3 = rngcummulativecounttotaldata.Hrd5.ToString();
                                                             break;
                                                         default:
                                                             intcummulativecout3 = rngcummulativecounttotaldata.Hrd1.ToString();
                                                             break;
                                                     }
                                                 }
                                                 if (intcummulativecount2 == string.Empty)
                                                     intcummulativecount2 = intcount2;

                                                 if (intcummulativecout3.Trim() != string.Empty && intcummulativecout3 != "0")
                                                 {
                                                     if (intcummulativecount1.Trim() != string.Empty && intcummulativecount1 != "0")
                                                     {
                                                         intcummulativecount4 = ((Convert.ToDecimal(intcummulativecout3) / Convert.ToDecimal(intcummulativecount1)) * 100).ToString();
                                                         if (intcummulativecount4.Length > 4)
                                                             intcummulativecount4 = intcummulativecount4.Substring(0, 4);
                                                     }
                                                     if (intcummulativecount2.Trim() != string.Empty && intcummulativecount2 != "0")
                                                     {
                                                         intcummulativecount5 = (((Convert.ToDecimal(intcummulativecout3) / Convert.ToDecimal(intcummulativecount2))) * 100).ToString();
                                                         if (intcummulativecount5.Length > 4)
                                                             intcummulativecount5 = intcummulativecount5.Substring(0, 4);
                                                     }

                                                 }



                                                 PdfPCell pdfDetailstotalTable2 = new PdfPCell(new Phrase(intcount1 + "  |  " + intcummulativecount1, TblFontBold));
                                                 pdfDetailstotalTable2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfDetailstotalTable2.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfDetailstotalTable2);

                                                 PdfPCell pdfDetailstotalTable3 = new PdfPCell(new Phrase(intcount2, TblFontBold));
                                                 pdfDetailstotalTable3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfDetailstotalTable3.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfDetailstotalTable3);

                                                 PdfPCell pdfDetailstotalTable4 = new PdfPCell(new Phrase(intcout3 + "  |  " + intcummulativecout3, TblFontBold));
                                                 pdfDetailstotalTable4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfDetailstotalTable4.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfDetailstotalTable4);

                                                 if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0" + "  |  " + "0", TblFontBold));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(rngcountdata.Hrd1 + "  |  " + rngcummulativecounttotaldata.Hrd1, TblFontBold));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }

                                                 if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0" + "  |  " + "0", TblFontBold));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(rngcountdata.Hrd2 + "  |  " + rngcummulativecounttotaldata.Hrd2, TblFontBold));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }
                                                 if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0" + "  |  " + "0", TblFontBold));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(rngcountdata.Hrd3 + "  |  " + rngcummulativecounttotaldata.Hrd3, TblFontBold));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }
                                                 if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0" + "  |  " + "0", TblFontBold));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(rngcountdata.Hrd4 + "  |  " + rngcummulativecounttotaldata.Hrd4, TblFontBold));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }
                                                 if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0" + "  |  " + "0", TblFontBold));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(rngcountdata.Hrd5 + "  |  " + rngcummulativecounttotaldata.Hrd5, TblFontBold));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }

                                                 string[] strcountArray4 = intcount4.Split('.');
                                                 string strcount4 = intcount4.ToString();
                                                 if (strcountArray4.Length > 1)
                                                     strcount4 = strcountArray4[0];


                                                 //string[] strcountArray5 = intcount5.Split('.');
                                                 string strcount5 = string.Empty;
                                                 if (intcount5 != string.Empty)
                                                     strcount5 = (Math.Round(Convert.ToDouble(intcount5), MidpointRounding.AwayFromZero)).ToString();
                                                 //string strcount5 = intcount5.ToString();
                                                 //if (strcountArray5.Length > 1)
                                                 //{
                                                 //    if (strcountArray5[1].StartsWith("0"))
                                                 //    {
                                                 //        strcount5 = strcountArray5[0];
                                                 //    }
                                                 //}

                                                 string[] strcummulativecountArray4 = intcummulativecount4.Split('.');
                                                 string strcummulativecount4 = intcummulativecount4.ToString();
                                                 if (strcummulativecountArray4.Length > 1)
                                                     strcummulativecount4 = strcummulativecountArray4[0];

                                                 PdfPCell pdfDetailstotalTable5 = new PdfPCell(new Phrase((strcount4 == string.Empty ? "" : strcount4 + "%") + " | " + (strcummulativecount4 == string.Empty ? "" : strcummulativecount4 + "%"), TblFontBold));
                                                 pdfDetailstotalTable5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfDetailstotalTable5.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                                 pdfDetailstotalTable5.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfDetailstotalTable5);


                                                 // string[] strcummulativecountArray5 = intcummulativecount5.Split('.');
                                                 string strcummulativecount5 = string.Empty;
                                                 if (intcummulativecount5 != string.Empty)
                                                     strcummulativecount5 = (Math.Round(Convert.ToDouble(intcummulativecount5), MidpointRounding.AwayFromZero)).ToString();
                                                 //string strcummulativecount5 = intcummulativecount5.ToString();
                                                 //if (strcummulativecountArray5.Length > 1)
                                                 //{
                                                 //    if (strcummulativecountArray5[1].StartsWith("0"))
                                                 //    {
                                                 //        strcummulativecount5 = strcummulativecountArray5[0];
                                                 //    }
                                                 //}

                                                 PdfPCell pdfDetailstotalTable6 = new PdfPCell(new Phrase((strcount5 == string.Empty ? "" : strcount5 + "%") + " | " + (strcummulativecount5 == string.Empty ? "" : strcummulativecount5 + "%"), TblFontBold));
                                                 pdfDetailstotalTable6.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfDetailstotalTable6.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                                 pdfDetailstotalTable6.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfDetailstotalTable6);
                                             }
                                         }
                                         else
                                         {


                                             PdfPCell pdfDetailsTable2 = new PdfPCell(new Phrase(intcount1, TblFontBold));
                                             pdfDetailsTable2.HorizontalAlignment = Element.ALIGN_CENTER;
                                             pdfDetailsTable2.Border = iTextSharp.text.Rectangle.BOX;
                                             subtable.AddCell(pdfDetailsTable2);

                                             PdfPCell pdfDetailsTable3 = new PdfPCell(new Phrase(intcount2, TblFontBold));
                                             pdfDetailsTable3.HorizontalAlignment = Element.ALIGN_CENTER;
                                             pdfDetailsTable3.Border = iTextSharp.text.Rectangle.BOX;
                                             subtable.AddCell(pdfDetailsTable3);

                                             PdfPCell pdfDetailsTable4 = new PdfPCell(new Phrase(intcout3, TblFontBold));
                                             pdfDetailsTable4.HorizontalAlignment = Element.ALIGN_CENTER;
                                             pdfDetailsTable4.Border = iTextSharp.text.Rectangle.BOX;
                                             subtable.AddCell(pdfDetailsTable4);

                                             if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                                             {
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0", TblFontBold));
                                                     pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfMainTableIncld2);
                                                 }
                                                 else
                                                 {
                                                     PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(rngcountdata.Hrd1, TblFontBold));
                                                     pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfMainTableIncld2);
                                                 }
                                             }

                                             if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                                             {
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0", TblFontBold));
                                                     pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfMainTableIncld2);
                                                 }
                                                 else
                                                 {
                                                     PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(rngcountdata.Hrd2, TblFontBold));
                                                     pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfMainTableIncld2);
                                                 }
                                             }
                                             if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                                             {
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0", TblFontBold));
                                                     pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfMainTableIncld2);
                                                 }
                                                 else
                                                 {
                                                     PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(rngcountdata.Hrd3, TblFontBold));
                                                     pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfMainTableIncld2);
                                                 }
                                             }
                                             if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                                             {
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0", TblFontBold));
                                                     pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfMainTableIncld2);
                                                 }
                                                 else
                                                 {
                                                     PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(rngcountdata.Hrd4, TblFontBold));
                                                     pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfMainTableIncld2);
                                                 }
                                             }
                                             if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                                             {
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0", TblFontBold));
                                                     pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfMainTableIncld2);
                                                 }
                                                 else
                                                 {
                                                     PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(rngcountdata.Hrd5, TblFontBold));
                                                     pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfMainTableIncld2);
                                                 }
                                             }

                                             string[] strcountArray4 = intcount4.Split('.');
                                             string strcount4 = intcount4.ToString();
                                             if (strcountArray4.Length > 1)
                                                 strcount4 = strcountArray4[0];

                                             PdfPCell pdfDetailsTable5 = new PdfPCell(new Phrase(strcount4 == string.Empty ? "" : strcount4 + "%", TblFontBold));
                                             pdfDetailsTable5.HorizontalAlignment = Element.ALIGN_CENTER;
                                             pdfDetailsTable5.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                             pdfDetailsTable5.Border = iTextSharp.text.Rectangle.BOX;
                                             subtable.AddCell(pdfDetailsTable5);


                                             // string[] strcountArray5 = intcount5.Split('.');
                                             string strcount5 = string.Empty;
                                             if (intcount5 != string.Empty)
                                                 strcount5 = (Math.Round(Convert.ToDouble(intcount5), MidpointRounding.AwayFromZero)).ToString();
                                             //if (strcountArray5.Length > 1)
                                             //{
                                             //    if (strcountArray5[1].StartsWith("0"))
                                             //    {
                                             //        strcount5 = strcountArray5[0];
                                             //    }
                                             //}

                                             PdfPCell pdfDetailsTable6 = new PdfPCell(new Phrase(strcount5 == string.Empty ? "" : strcount5 + "%", TblFontBold));
                                             pdfDetailsTable6.HorizontalAlignment = Element.ALIGN_CENTER;
                                             pdfDetailsTable6.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                             pdfDetailsTable6.Border = iTextSharp.text.Rectangle.BOX;
                                             subtable.AddCell(pdfDetailsTable6);
                                         }
                                     }
                                     if (Rb_SNP_Mem.Checked || rbo_ProgramWise.Checked)
                                     {
                                         if (!rdoperiodBoth.Checked)
                                         {
                                             List<RCsb14GroupEntity> rngsubdetailsdata = new List<RCsb14GroupEntity>();
                                             if (strIndSwitch == "Y" && rdoOutcomesselect.Checked)
                                             {
                                                 rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrdCnt");
                                                 if (rngsubdetailsdata.Count == 0)
                                                     rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "INDSWITCH");
                                             }
                                             else
                                             {
                                                 rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrdCnt");
                                             }
                                             //List<RNGGAEntity> Goalsubdetails = GoalDetailsEntity.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim());
                                             foreach (RCsb14GroupEntity item in rngsubdetailsdata)
                                             {
                                                 intcount1 = intcount2 = intcout3 = "0";
                                                 intcount4 = intcount5 = string.Empty;
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     intcount1 = IndSwitch_Table.Rows.Count.ToString();
                                                     intcount2 = item.ExAchev.ToString();
                                                     intcout3 = "0";
                                                 }
                                                 else
                                                 {
                                                     intcount1 = item.unit_cnt.ToString();
                                                     intcount2 = item.ExAchev.ToString();

                                                     switch (strResultColumn)
                                                     {
                                                         case "0":
                                                             intcout3 = item.unit_cnt.ToString();
                                                             break;
                                                         case "1":
                                                             intcout3 = item.Hrd1.ToString();
                                                             break;
                                                         case "2":
                                                             intcout3 = item.Hrd2.ToString();
                                                             break;
                                                         case "3":
                                                             intcout3 = item.Hrd3.ToString();
                                                             break;
                                                         case "4":
                                                             intcout3 = item.Hrd4.ToString();
                                                             break;
                                                         case "5":
                                                             intcout3 = item.Hrd5.ToString();
                                                             break;
                                                         default:
                                                             intcout3 = item.Hrd1.ToString();
                                                             break;
                                                     }
                                                 }
                                                 if (intcout3.Trim() != string.Empty && intcout3 != "0")
                                                 {
                                                     if (intcount1.Trim() != string.Empty && intcount1 != "0")
                                                     {
                                                         intcount4 = ((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount1)) * 100).ToString();
                                                         if (intcount4.Length > 4)
                                                             intcount4 = intcount4.Substring(0, 4);
                                                     }
                                                     if (intcount2.Trim() != string.Empty && intcount2 != "0")
                                                     {
                                                         intcount5 = (((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount2))) * 100).ToString();
                                                         if (intcount5.Length > 4)
                                                             intcount5 = intcount5.Substring(0, 4);
                                                     }

                                                 }



                                                 PdfPCell pdfSubDetailsTable1 = new PdfPCell(new Phrase("     " + item.GrpDesc.ToString(), TableFont));
                                                 pdfSubDetailsTable1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                 pdfSubDetailsTable1.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                                 pdfSubDetailsTable1.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable1);
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     PdfPCell pdfSubDetailsTable2 = new PdfPCell(new Phrase(intcount1.ToString(), TableFont));
                                                     pdfSubDetailsTable2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfSubDetailsTable2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfSubDetailsTable2);
                                                 }
                                                 else
                                                 {
                                                     PdfPCell pdfSubDetailsTable2 = new PdfPCell(new Phrase(item.unit_cnt.ToString(), TableFont));
                                                     pdfSubDetailsTable2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfSubDetailsTable2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfSubDetailsTable2);
                                                 }
                                                 PdfPCell pdfSubDetailsTable3 = new PdfPCell(new Phrase(intcount2.ToString(), TableFont));
                                                 pdfSubDetailsTable3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable3.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable3);

                                                 PdfPCell pdfSubDetailsTable4 = new PdfPCell(new Phrase(intcout3, TableFont));
                                                 pdfSubDetailsTable4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable4.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable4);

                                                 if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd1, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }

                                                 if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd2, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }
                                                 if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd3, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }
                                                 if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd4, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }
                                                 if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd5, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }

                                                 string[] strcountArray4 = intcount4.Split('.');
                                                 string strcount4 = intcount4.ToString();
                                                 if (strcountArray4.Length > 1)
                                                     strcount4 = strcountArray4[0];


                                                 PdfPCell pdfSubDetailsTable5 = new PdfPCell(new Phrase(strcount4 == string.Empty ? "" : strcount4 + "%", TableFont));
                                                 pdfSubDetailsTable5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable5.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                                 pdfSubDetailsTable5.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable5);

                                                 // string[] strcountArray5 = intcount5.Split('.');
                                                 // string strcount5 = intcount5.ToString();
                                                 string strcount5 = string.Empty;
                                                 if (intcount5 != string.Empty)
                                                     strcount5 = (Math.Round(Convert.ToDouble(intcount5), MidpointRounding.AwayFromZero)).ToString();
                                                 //if (strcountArray5.Length > 1)
                                                 //{
                                                 //    if (strcountArray5[1].StartsWith("0"))
                                                 //    {
                                                 //        strcount5 = strcountArray5[0];
                                                 //    }
                                                 //}

                                                 PdfPCell pdfSubDetailsTable6 = new PdfPCell(new Phrase(strcount5 == string.Empty ? "" : strcount5 + "%", TableFont));
                                                 pdfSubDetailsTable6.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable6.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                                 pdfSubDetailsTable6.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable6);
                                             }
                                         }
                                         else
                                         {
                                             List<RCsb14GroupEntity> rngsubdetailsdata = new List<RCsb14GroupEntity>();
                                             List<RCsb14GroupEntity> rngsubBothdetailsdata = new List<RCsb14GroupEntity>();
                                             if (strIndSwitch == "Y" && rdoOutcomesselect.Checked)
                                             {
                                                 rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrdCnt");

                                                 if (rngsubdetailsdata.Count == 0)
                                                     rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "INDSWITCH");

                                                 rngsubBothdetailsdata = RngBothResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrdCnt");
                                                 if (rngsubBothdetailsdata.Count == 0)
                                                     rngsubBothdetailsdata = RngBothResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "INDSWITCH" && u.Row_Type.ToString() == "INDSWITCH");
                                             }
                                             else
                                             {
                                                 rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrdCnt");
                                                 rngsubBothdetailsdata = RngBothResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrdCnt");
                                             }
                                             //List<RNGGAEntity> Goalsubdetails = GoalDetailsEntity.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim());
                                             int intbothcount = 0;

                                             foreach (RCsb14GroupEntity item in rngsubdetailsdata)
                                             {
                                                 intcount1 = intcount2 = intcout3 = "0";
                                                 intcount4 = intcount5 = string.Empty;

                                                 intcummulativecount1 = intcummulativecount2 = intcummulativecout3 = "0";
                                                 intcummulativecount4 = intcummulativecount5 = string.Empty;

                                                 if (strIndSwitch == "Y")
                                                 {
                                                     intcummulativecount1 = IndSwitchReport_Table.Rows.Count.ToString();
                                                     intcount1 = IndSwitch_Table.Rows.Count.ToString();
                                                     intcummulativecount2 = intcount2 = item.ExAchev.ToString();
                                                     intcout3 = intcummulativecout3 = "0";
                                                 }
                                                 else
                                                 {

                                                     intcount1 = item.unit_cnt.ToString();
                                                     intcummulativecount2 = intcount2 = item.ExAchev.ToString();

                                                     intcummulativecount1 = rngsubBothdetailsdata[intbothcount].unit_cnt.ToString();

                                                     switch (strResultColumn)
                                                     {
                                                         case "0":
                                                             intcout3 = item.unit_cnt.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].unit_cnt.ToString();
                                                             break;
                                                         case "1":
                                                             intcout3 = item.Hrd1.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd1.ToString();
                                                             break;
                                                         case "2":
                                                             intcout3 = item.Hrd2.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd2.ToString();
                                                             break;
                                                         case "3":
                                                             intcout3 = item.Hrd3.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd3.ToString();
                                                             break;
                                                         case "4":
                                                             intcout3 = item.Hrd4.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd4.ToString();
                                                             break;
                                                         case "5":
                                                             intcout3 = item.Hrd5.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd5.ToString();
                                                             break;
                                                         default:
                                                             intcout3 = item.Hrd1.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd1.ToString();
                                                             break;
                                                     }
                                                 }
                                                 if (intcout3.Trim() != string.Empty && intcout3 != "0")
                                                 {
                                                     if (intcount1.Trim() != string.Empty && intcount1 != "0")
                                                     {
                                                         intcount4 = ((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount1)) * 100).ToString();
                                                         if (intcount4.Length > 4)
                                                             intcount4 = intcount4.Substring(0, 4);
                                                     }
                                                     if (intcount2.Trim() != string.Empty && intcount2 != "0")
                                                     {
                                                         intcount5 = (((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount2))) * 100).ToString();
                                                         if (intcount5.Length > 4)
                                                             intcount5 = intcount5.Substring(0, 4);
                                                     }

                                                 }

                                                 if (intcummulativecout3.Trim() != string.Empty && intcummulativecout3 != "0")
                                                 {
                                                     if (intcummulativecount1.Trim() != string.Empty && intcummulativecount1 != "0")
                                                     {
                                                         intcummulativecount4 = ((Convert.ToDecimal(intcummulativecout3) / Convert.ToDecimal(intcummulativecount1)) * 100).ToString();
                                                         if (intcummulativecount4.Length > 4)
                                                             intcummulativecount4 = intcummulativecount4.Substring(0, 4);
                                                     }
                                                     if (intcummulativecount2.Trim() != string.Empty && intcummulativecount2 != "0")
                                                     {
                                                         intcummulativecount5 = (((Convert.ToDecimal(intcummulativecout3) / Convert.ToDecimal(intcummulativecount2))) * 100).ToString();
                                                         if (intcummulativecount5.Length > 4)
                                                             intcummulativecount5 = intcummulativecount5.Substring(0, 4);
                                                     }

                                                 }

                                                 PdfPCell pdfSubDetailsTable1 = new PdfPCell(new Phrase("     " + item.GrpDesc.ToString(), TableFont));
                                                 pdfSubDetailsTable1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                 pdfSubDetailsTable1.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                                 pdfSubDetailsTable1.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable1);
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     PdfPCell pdfSubDetailsTable2 = new PdfPCell(new Phrase(intcount1.ToString() + " | " + intcummulativecount1, TableFont));
                                                     pdfSubDetailsTable2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfSubDetailsTable2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfSubDetailsTable2);
                                                 }
                                                 else
                                                 {
                                                     PdfPCell pdfSubDetailsTable2 = new PdfPCell(new Phrase(item.unit_cnt.ToString() + " | " + intcummulativecount1, TableFont));
                                                     pdfSubDetailsTable2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfSubDetailsTable2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfSubDetailsTable2);

                                                 }

                                                 PdfPCell pdfSubDetailsTable3 = new PdfPCell(new Phrase(intcount2.ToString(), TableFont));
                                                 pdfSubDetailsTable3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable3.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable3);

                                                 PdfPCell pdfSubDetailsTable4 = new PdfPCell(new Phrase(intcout3 + " | " + intcummulativecout3, TableFont));
                                                 pdfSubDetailsTable4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable4.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable4);

                                                 if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0" + " | " + "0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd1 + " | " + rngsubBothdetailsdata[intbothcount].Hrd1, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }

                                                 if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0" + " | " + "0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd2 + " | " + rngsubBothdetailsdata[intbothcount].Hrd2, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }
                                                 if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0" + " | " + "0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd3 + " | " + rngsubBothdetailsdata[intbothcount].Hrd3, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }
                                                 if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0" + " | " + "0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd4 + " | " + rngsubBothdetailsdata[intbothcount].Hrd4, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }
                                                 if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0" + " | " + "0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd5 + " | " + rngsubBothdetailsdata[intbothcount].Hrd5, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }

                                                 string[] strcountArray4 = intcount4.Split('.');
                                                 string strcount4 = intcount4.ToString();
                                                 if (strcountArray4.Length > 1)
                                                     strcount4 = strcountArray4[0];


                                                 string[] strcummulativecountArray4 = intcummulativecount4.Split('.');
                                                 string strcummulativecount4 = intcummulativecount4.ToString();
                                                 if (strcummulativecountArray4.Length > 1)
                                                     strcummulativecount4 = strcummulativecountArray4[0];


                                                 PdfPCell pdfSubDetailsTable5 = new PdfPCell(new Phrase((strcount4 == string.Empty ? "" : strcount4 + "%") + " | " + (strcummulativecount4 == string.Empty ? "" : strcummulativecount4 + "%"), TableFont));
                                                 pdfSubDetailsTable5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable5.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                                 pdfSubDetailsTable5.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable5);

                                                 string[] strcountArray5 = intcount5.Split('.');
                                                 string strcount5 = string.Empty;
                                                 if (intcount5 != string.Empty)
                                                     strcount5 = (Math.Round(Convert.ToDouble(intcount5), MidpointRounding.AwayFromZero)).ToString();
                                                 //string strcount5 = intcount5.ToString();
                                                 //if (strcountArray5.Length > 1)
                                                 //{
                                                 //    if (strcountArray5[1].StartsWith("0"))
                                                 //    {
                                                 //        strcount5 = strcountArray5[0];
                                                 //    }
                                                 //}

                                                 //string[] strcummulativecountArray5 = intcummulativecount5.Split('.');
                                                 string strcummulativecount5 = string.Empty;
                                                 if (intcummulativecount5 != string.Empty)
                                                     strcummulativecount5 = (Math.Round(Convert.ToDouble(intcummulativecount5), MidpointRounding.AwayFromZero)).ToString();
                                                 //string strcummulativecount5 = intcummulativecount5.ToString();
                                                 //if (strcummulativecountArray5.Length > 1)
                                                 //{
                                                 //    if (strcummulativecountArray5[1].StartsWith("0"))
                                                 //    {
                                                 //        strcummulativecount5 = strcummulativecountArray5[0];
                                                 //    }
                                                 //}

                                                 PdfPCell pdfSubDetailsTable6 = new PdfPCell(new Phrase((strcount5 == string.Empty ? "" : strcount5 + "%") + " | " + (strcummulativecount5 == string.Empty ? "" : strcummulativecount5 + "%"), TableFont));
                                                 pdfSubDetailsTable6.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable6.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                                 pdfSubDetailsTable6.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable6);
                                                 intbothcount = intbothcount + 1;
                                             }

                                         }

                                     }
                                     else
                                     {
                                         // if (rdoperiodBoth.Checked)
                                         //{
                                         //    PdfPCell pdfDetailstotalTable1 = new PdfPCell(new Phrase("", TableFont));
                                         //    pdfDetailstotalTable1.HorizontalAlignment = Element.ALIGN_LEFT;
                                         //    pdfDetailstotalTable1.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                         //    pdfDetailstotalTable1.Border = iTextSharp.text.Rectangle.BOX;
                                         //    subtable.AddCell(pdfDetailstotalTable1);

                                         //    string intcummulativecount1, intcummulativecount2, intcummulativecout3, intcummulativecount4, intcummulativecount5;
                                         //    intcummulativecount1 = intcummulativecount2 = intcummulativecout3 = "0";
                                         //    intcummulativecount4 = intcummulativecount5 = string.Empty;
                                         //    RCsb14GroupEntity rngcummulativecounttotaldata = null;

                                         //    rngcummulativecounttotaldata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "RefCnt");
                                         //    if (rngcummulativecounttotaldata != null)
                                         //    {
                                         //        intcummulativecount1 = rngcummulativecounttotaldata.unit_cnt.ToString();
                                         //        intcummulativecount2 = rngcummulativecounttotaldata.ExAchev.ToString();
                                         //        switch (strResultColumn)
                                         //        {
                                         //            case "0":
                                         //                intcout3 = rngcummulativecounttotaldata.unit_cnt.ToString();
                                         //                break;
                                         //            case "1":
                                         //                intcout3 = rngcummulativecounttotaldata.Hrd1.ToString();
                                         //                break;
                                         //            case "2":
                                         //                intcout3 = rngcummulativecounttotaldata.Hrd2.ToString();
                                         //                break;
                                         //            case "3":
                                         //                intcout3 = rngcummulativecounttotaldata.Hrd3.ToString();
                                         //                break;
                                         //            case "4":
                                         //                intcout3 = rngcummulativecounttotaldata.Hrd4.ToString();
                                         //                break;
                                         //            case "5":
                                         //                intcout3 = rngcummulativecounttotaldata.Hrd5.ToString();
                                         //                break;
                                         //            default:
                                         //                intcout3 = rngcummulativecounttotaldata.Hrd1.ToString();
                                         //                break;
                                         //        }

                                         //        if (intcummulativecout3.Trim() != string.Empty && intcummulativecout3 != "0")
                                         //        {
                                         //            if (intcummulativecount1.Trim() != string.Empty && intcummulativecount1 != "0")
                                         //            {
                                         //                intcummulativecount4 = ((Convert.ToDecimal(intcummulativecout3) / Convert.ToDecimal(intcummulativecount1)) * 100).ToString();
                                         //                if (intcummulativecount4.Length > 4)
                                         //                    intcummulativecount4 = intcummulativecount4.Substring(0, 4);
                                         //            }
                                         //            if (intcummulativecount2.Trim() != string.Empty && intcummulativecount2 != "0")
                                         //            {
                                         //                intcummulativecount5 = (((Convert.ToDecimal(intcummulativecout3) / Convert.ToDecimal(intcummulativecount2))) * 100).ToString();
                                         //                if (intcummulativecount5.Length > 4)
                                         //                    intcummulativecount5 = intcummulativecount5.Substring(0, 4);
                                         //            }

                                         //        }



                                         //        PdfPCell pdfDetailstotalTable2 = new PdfPCell(new Phrase(intcummulativecount1, TableFont));
                                         //        pdfDetailstotalTable2.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //        pdfDetailstotalTable2.Border = iTextSharp.text.Rectangle.BOX;
                                         //        subtable.AddCell(pdfDetailstotalTable2);

                                         //        PdfPCell pdfDetailstotalTable3 = new PdfPCell(new Phrase(intcummulativecount2, TableFont));
                                         //        pdfDetailstotalTable3.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //        pdfDetailstotalTable3.Border = iTextSharp.text.Rectangle.BOX;
                                         //        subtable.AddCell(pdfDetailstotalTable3);

                                         //        PdfPCell pdfDetailstotalTable4 = new PdfPCell(new Phrase(intcummulativecout3, TableFont));
                                         //        pdfDetailstotalTable4.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //        pdfDetailstotalTable4.Border = iTextSharp.text.Rectangle.BOX;
                                         //        subtable.AddCell(pdfDetailstotalTable4);

                                         //        if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                                         //        {
                                         //            PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(rngcummulativecounttotaldata.Hrd1, TableFont));
                                         //            pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //            pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                         //            subtable.AddCell(pdfMainTableIncld2);
                                         //        }

                                         //        if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                                         //        {
                                         //            PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(rngcummulativecounttotaldata.Hrd2, TableFont));
                                         //            pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //            pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                         //            subtable.AddCell(pdfMainTableIncld2);
                                         //        }
                                         //        if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                                         //        {
                                         //            PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(rngcummulativecounttotaldata.Hrd3, TableFont));
                                         //            pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //            pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                         //            subtable.AddCell(pdfMainTableIncld2);
                                         //        }
                                         //        if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                                         //        {
                                         //            PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(rngcummulativecounttotaldata.Hrd4, TableFont));
                                         //            pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //            pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                         //            subtable.AddCell(pdfMainTableIncld2);
                                         //        }
                                         //        if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                                         //        {
                                         //            PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(rngcummulativecounttotaldata.Hrd5, TableFont));
                                         //            pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //            pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                         //            subtable.AddCell(pdfMainTableIncld2);
                                         //        }

                                         //        string[] strcummulativecountArray4 = intcummulativecount4.Split('.');
                                         //        string strcummulativecount4 = intcummulativecount4.ToString();
                                         //        if (strcummulativecountArray4.Length > 1)
                                         //            strcummulativecount4 = strcummulativecountArray4[0];

                                         //        PdfPCell pdfDetailstotalTable5 = new PdfPCell(new Phrase(strcummulativecount4 == string.Empty ? "" : strcummulativecount4 + "%", TableFont));
                                         //        pdfDetailstotalTable5.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //        pdfDetailstotalTable5.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                         //        pdfDetailstotalTable5.Border = iTextSharp.text.Rectangle.BOX;
                                         //        subtable.AddCell(pdfDetailstotalTable5);


                                         //        string[] strcummulativecountArray5 = intcummulativecount5.Split('.');
                                         //        string strcummulativecount5 = intcummulativecount5.ToString();
                                         //        if (strcummulativecountArray5.Length > 1)
                                         //        {
                                         //            if (strcummulativecountArray5[1].StartsWith("0"))
                                         //            {
                                         //                strcummulativecount5 = strcummulativecountArray5[0];
                                         //            }
                                         //        }

                                         //        PdfPCell pdfDetailstotalTable6 = new PdfPCell(new Phrase(strcummulativecount5 == string.Empty ? "" : strcummulativecount5 + "%", TableFont));
                                         //        pdfDetailstotalTable6.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //        pdfDetailstotalTable6.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                         //        pdfDetailstotalTable6.Border = iTextSharp.text.Rectangle.BOX;
                                         //        subtable.AddCell(pdfDetailstotalTable6);
                                         //    }
                                         //}
                                     }

                                     if (rbo_ProgramWise.Checked)
                                     {
                                         if (!rdoperiodBoth.Checked)
                                         {
                                             List<RCsb14GroupEntity> rngsubdetailsdata = new List<RCsb14GroupEntity>();
                                             if (strIndSwitch == "Y" && rdoOutcomesselect.Checked)
                                             {
                                                 rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrgCnt");
                                                 if (rngsubdetailsdata.Count == 0)
                                                     rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "INDSWITCH");
                                             }
                                             else
                                             {
                                                 rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrgCnt");
                                             }
                                             //List<RNGGAEntity> Goalsubdetails = GoalDetailsEntity.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim());
                                             foreach (RCsb14GroupEntity item in rngsubdetailsdata)
                                             {
                                                 intcount1 = intcount2 = intcout3 = "0";
                                                 intcount4 = intcount5 = string.Empty;
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     intcount1 = IndSwitch_Table.Rows.Count.ToString();
                                                     intcount2 = item.ExAchev.ToString();
                                                     intcout3 = "0";
                                                 }
                                                 else
                                                 {
                                                     intcount1 = item.unit_cnt.ToString();
                                                     intcount2 = item.ExAchev.ToString();

                                                     switch (strResultColumn)
                                                     {
                                                         case "0":
                                                             intcout3 = item.unit_cnt.ToString();
                                                             break;
                                                         case "1":
                                                             intcout3 = item.Hrd1.ToString();
                                                             break;
                                                         case "2":
                                                             intcout3 = item.Hrd2.ToString();
                                                             break;
                                                         case "3":
                                                             intcout3 = item.Hrd3.ToString();
                                                             break;
                                                         case "4":
                                                             intcout3 = item.Hrd4.ToString();
                                                             break;
                                                         case "5":
                                                             intcout3 = item.Hrd5.ToString();
                                                             break;
                                                         default:
                                                             intcout3 = item.Hrd1.ToString();
                                                             break;
                                                     }
                                                 }
                                                 if (intcout3.Trim() != string.Empty && intcout3 != "0")
                                                 {
                                                     if (intcount1.Trim() != string.Empty && intcount1 != "0")
                                                     {
                                                         intcount4 = ((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount1)) * 100).ToString();
                                                         if (intcount4.Length > 4)
                                                             intcount4 = intcount4.Substring(0, 4);
                                                     }
                                                     if (intcount2.Trim() != string.Empty && intcount2 != "0")
                                                     {
                                                         intcount5 = (((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount2))) * 100).ToString();
                                                         if (intcount5.Length > 4)
                                                             intcount5 = intcount5.Substring(0, 4);
                                                     }

                                                 }



                                                 PdfPCell pdfSubDetailsTable1 = new PdfPCell(new Phrase("     " + item.GrpDesc.ToString(), TableFont));
                                                 pdfSubDetailsTable1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                 pdfSubDetailsTable1.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                                 pdfSubDetailsTable1.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable1);
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     PdfPCell pdfSubDetailsTable2 = new PdfPCell(new Phrase(intcount1.ToString(), TableFont));
                                                     pdfSubDetailsTable2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfSubDetailsTable2.VerticalAlignment = Element.ALIGN_CENTER;
                                                     pdfSubDetailsTable2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfSubDetailsTable2);
                                                 }
                                                 else
                                                 {
                                                     PdfPCell pdfSubDetailsTable2 = new PdfPCell(new Phrase(item.unit_cnt.ToString(), TableFont));
                                                     pdfSubDetailsTable2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfSubDetailsTable2.VerticalAlignment = Element.ALIGN_CENTER;
                                                     pdfSubDetailsTable2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfSubDetailsTable2);
                                                 }
                                                 PdfPCell pdfSubDetailsTable3 = new PdfPCell(new Phrase(intcount2.ToString(), TableFont));
                                                 pdfSubDetailsTable3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable3.VerticalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable3.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable3);

                                                 PdfPCell pdfSubDetailsTable4 = new PdfPCell(new Phrase(intcout3, TableFont));
                                                 pdfSubDetailsTable4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable4.VerticalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable4.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable4);

                                                 if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd1, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }

                                                 if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd2, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }
                                                 if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd3, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }
                                                 if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd4, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }
                                                 if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd5, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }

                                                 string[] strcountArray4 = intcount4.Split('.');
                                                 string strcount4 = intcount4.ToString();
                                                 if (strcountArray4.Length > 1)
                                                     strcount4 = strcountArray4[0];


                                                 PdfPCell pdfSubDetailsTable5 = new PdfPCell(new Phrase(strcount4 == string.Empty ? "" : strcount4 + "%", TableFont));
                                                 pdfSubDetailsTable5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable5.VerticalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable5.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                                 pdfSubDetailsTable5.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable5);

                                                 // string[] strcountArray5 = intcount5.Split('.');
                                                 // string strcount5 = intcount5.ToString();
                                                 string strcount5 = string.Empty;
                                                 if (intcount5 != string.Empty)
                                                     strcount5 = (Math.Round(Convert.ToDouble(intcount5), MidpointRounding.AwayFromZero)).ToString();
                                                 //if (strcountArray5.Length > 1)
                                                 //{
                                                 //    if (strcountArray5[1].StartsWith("0"))
                                                 //    {
                                                 //        strcount5 = strcountArray5[0];
                                                 //    }
                                                 //}

                                                 PdfPCell pdfSubDetailsTable6 = new PdfPCell(new Phrase(strcount5 == string.Empty ? "" : strcount5 + "%", TableFont));
                                                 pdfSubDetailsTable6.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable6.VerticalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable6.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                                 pdfSubDetailsTable6.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable6);
                                             }
                                         }
                                         else
                                         {
                                             List<RCsb14GroupEntity> rngsubdetailsdata = new List<RCsb14GroupEntity>();
                                             List<RCsb14GroupEntity> rngsubBothdetailsdata = new List<RCsb14GroupEntity>();
                                             if (strIndSwitch == "Y" && rdoOutcomesselect.Checked)
                                             {
                                                 rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrgCnt");

                                                 if (rngsubdetailsdata.Count == 0)
                                                     rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "INDSWITCH");

                                                 rngsubBothdetailsdata = RngBothResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrgCnt");
                                                 if (rngsubBothdetailsdata.Count == 0)
                                                     rngsubBothdetailsdata = RngBothResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "INDSWITCH" && u.Row_Type.ToString() == "INDSWITCH");
                                             }
                                             else
                                             {
                                                 rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrgCnt");
                                                 rngsubBothdetailsdata = RngBothResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrgCnt");
                                             }
                                             //List<RNGGAEntity> Goalsubdetails = GoalDetailsEntity.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim());
                                             int intbothcount = 0;

                                             foreach (RCsb14GroupEntity item in rngsubdetailsdata)
                                             {
                                                 intcount1 = intcount2 = intcout3 = "0";
                                                 intcount4 = intcount5 = string.Empty;

                                                 intcummulativecount1 = intcummulativecount2 = intcummulativecout3 = "0";
                                                 intcummulativecount4 = intcummulativecount5 = string.Empty;

                                                 if (strIndSwitch == "Y")
                                                 {
                                                     intcummulativecount1 = IndSwitchReport_Table.Rows.Count.ToString();
                                                     intcount1 = IndSwitch_Table.Rows.Count.ToString();
                                                     intcummulativecount2 = intcount2 = item.ExAchev.ToString();
                                                     intcout3 = intcummulativecout3 = "0";
                                                 }
                                                 else
                                                 {

                                                     intcount1 = item.unit_cnt.ToString();
                                                     intcummulativecount2 = intcount2 = item.ExAchev.ToString();

                                                     intcummulativecount1 = rngsubBothdetailsdata[intbothcount].unit_cnt.ToString();

                                                     switch (strResultColumn)
                                                     {
                                                         case "0":
                                                             intcout3 = item.unit_cnt.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].unit_cnt.ToString();
                                                             break;
                                                         case "1":
                                                             intcout3 = item.Hrd1.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd1.ToString();
                                                             break;
                                                         case "2":
                                                             intcout3 = item.Hrd2.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd2.ToString();
                                                             break;
                                                         case "3":
                                                             intcout3 = item.Hrd3.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd3.ToString();
                                                             break;
                                                         case "4":
                                                             intcout3 = item.Hrd4.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd4.ToString();
                                                             break;
                                                         case "5":
                                                             intcout3 = item.Hrd5.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd5.ToString();
                                                             break;
                                                         default:
                                                             intcout3 = item.Hrd1.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd1.ToString();
                                                             break;
                                                     }
                                                 }
                                                 if (intcout3.Trim() != string.Empty && intcout3 != "0")
                                                 {
                                                     if (intcount1.Trim() != string.Empty && intcount1 != "0")
                                                     {
                                                         intcount4 = ((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount1)) * 100).ToString();
                                                         if (intcount4.Length > 4)
                                                             intcount4 = intcount4.Substring(0, 4);
                                                     }
                                                     if (intcount2.Trim() != string.Empty && intcount2 != "0")
                                                     {
                                                         intcount5 = (((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount2))) * 100).ToString();
                                                         if (intcount5.Length > 4)
                                                             intcount5 = intcount5.Substring(0, 4);
                                                     }

                                                 }

                                                 if (intcummulativecout3.Trim() != string.Empty && intcummulativecout3 != "0")
                                                 {
                                                     if (intcummulativecount1.Trim() != string.Empty && intcummulativecount1 != "0")
                                                     {
                                                         intcummulativecount4 = ((Convert.ToDecimal(intcummulativecout3) / Convert.ToDecimal(intcummulativecount1)) * 100).ToString();
                                                         if (intcummulativecount4.Length > 4)
                                                             intcummulativecount4 = intcummulativecount4.Substring(0, 4);
                                                     }
                                                     if (intcummulativecount2.Trim() != string.Empty && intcummulativecount2 != "0")
                                                     {
                                                         intcummulativecount5 = (((Convert.ToDecimal(intcummulativecout3) / Convert.ToDecimal(intcummulativecount2))) * 100).ToString();
                                                         if (intcummulativecount5.Length > 4)
                                                             intcummulativecount5 = intcummulativecount5.Substring(0, 4);
                                                     }

                                                 }

                                                 PdfPCell pdfSubDetailsTable1 = new PdfPCell(new Phrase("     " + item.GrpDesc.ToString(), TableFont));
                                                 pdfSubDetailsTable1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                 pdfSubDetailsTable1.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                                 pdfSubDetailsTable1.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable1);
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     PdfPCell pdfSubDetailsTable2 = new PdfPCell(new Phrase(intcount1.ToString() + " | " + intcummulativecount1, TableFont));
                                                     pdfSubDetailsTable2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfSubDetailsTable2.VerticalAlignment = Element.ALIGN_CENTER;
                                                     pdfSubDetailsTable2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfSubDetailsTable2);
                                                 }
                                                 else
                                                 {
                                                     PdfPCell pdfSubDetailsTable2 = new PdfPCell(new Phrase(item.unit_cnt.ToString() + " | " + intcummulativecount1, TableFont));
                                                     pdfSubDetailsTable2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     pdfSubDetailsTable2.VerticalAlignment = Element.ALIGN_CENTER;
                                                     pdfSubDetailsTable2.Border = iTextSharp.text.Rectangle.BOX;
                                                     subtable.AddCell(pdfSubDetailsTable2);

                                                 }

                                                 PdfPCell pdfSubDetailsTable3 = new PdfPCell(new Phrase(intcount2.ToString(), TableFont));
                                                 pdfSubDetailsTable3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable3.VerticalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable3.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable3);

                                                 PdfPCell pdfSubDetailsTable4 = new PdfPCell(new Phrase(intcout3 + " | " + intcummulativecout3, TableFont));
                                                 pdfSubDetailsTable4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable4.VerticalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable4.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable4);

                                                 if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0" + " | " + "0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd1 + " | " + rngsubBothdetailsdata[intbothcount].Hrd1, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }

                                                 if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0" + " | " + "0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd2 + " | " + rngsubBothdetailsdata[intbothcount].Hrd2, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }
                                                 if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0" + " | " + "0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd3 + " | " + rngsubBothdetailsdata[intbothcount].Hrd3, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }
                                                 if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0" + " | " + "0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd4 + " | " + rngsubBothdetailsdata[intbothcount].Hrd4, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }
                                                 if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase("0" + " | " + "0", TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                     else
                                                     {
                                                         PdfPCell pdfMainTableIncld2 = new PdfPCell(new Phrase(item.Hrd5 + " | " + rngsubBothdetailsdata[intbothcount].Hrd5, TableFont));
                                                         pdfMainTableIncld2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.VerticalAlignment = Element.ALIGN_CENTER;
                                                         pdfMainTableIncld2.Border = iTextSharp.text.Rectangle.BOX;
                                                         subtable.AddCell(pdfMainTableIncld2);
                                                     }
                                                 }

                                                 string[] strcountArray4 = intcount4.Split('.');
                                                 string strcount4 = intcount4.ToString();
                                                 if (strcountArray4.Length > 1)
                                                     strcount4 = strcountArray4[0];


                                                 string[] strcummulativecountArray4 = intcummulativecount4.Split('.');
                                                 string strcummulativecount4 = intcummulativecount4.ToString();
                                                 if (strcummulativecountArray4.Length > 1)
                                                     strcummulativecount4 = strcummulativecountArray4[0];


                                                 PdfPCell pdfSubDetailsTable5 = new PdfPCell(new Phrase((strcount4 == string.Empty ? "" : strcount4 + "%") + " | " + (strcummulativecount4 == string.Empty ? "" : strcummulativecount4 + "%"), TableFont));
                                                 pdfSubDetailsTable5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable5.VerticalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable5.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                                 pdfSubDetailsTable5.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable5);

                                                 string[] strcountArray5 = intcount5.Split('.');
                                                 string strcount5 = string.Empty;
                                                 if (intcount5 != string.Empty)
                                                     strcount5 = (Math.Round(Convert.ToDouble(intcount5), MidpointRounding.AwayFromZero)).ToString();
                                                 //string strcount5 = intcount5.ToString();
                                                 //if (strcountArray5.Length > 1)
                                                 //{
                                                 //    if (strcountArray5[1].StartsWith("0"))
                                                 //    {
                                                 //        strcount5 = strcountArray5[0];
                                                 //    }
                                                 //}

                                                 //string[] strcummulativecountArray5 = intcummulativecount5.Split('.');
                                                 string strcummulativecount5 = string.Empty;
                                                 if (intcummulativecount5 != string.Empty)
                                                     strcummulativecount5 = (Math.Round(Convert.ToDouble(intcummulativecount5), MidpointRounding.AwayFromZero)).ToString();
                                                 //string strcummulativecount5 = intcummulativecount5.ToString();
                                                 //if (strcummulativecountArray5.Length > 1)
                                                 //{
                                                 //    if (strcummulativecountArray5[1].StartsWith("0"))
                                                 //    {
                                                 //        strcummulativecount5 = strcummulativecountArray5[0];
                                                 //    }
                                                 //}

                                                 PdfPCell pdfSubDetailsTable6 = new PdfPCell(new Phrase((strcount5 == string.Empty ? "" : strcount5 + "%") + " | " + (strcummulativecount5 == string.Empty ? "" : strcummulativecount5 + "%"), TableFont));
                                                 pdfSubDetailsTable6.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable6.VerticalAlignment = Element.ALIGN_CENTER;
                                                 pdfSubDetailsTable6.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                                 pdfSubDetailsTable6.Border = iTextSharp.text.Rectangle.BOX;
                                                 subtable.AddCell(pdfSubDetailsTable6);
                                                 intbothcount = intbothcount + 1;
                                             }

                                         }

                                     }

                                 }
                             }
                         }



                         //PdfPCell pdfBottomRow1 = new PdfPCell(new Phrase("FRN #2  CSBG Annual Report ", TableFont));
                         //pdfBottomRow1.HorizontalAlignment = Element.ALIGN_LEFT;
                         //pdfBottomRow1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                         //pdfBottomRow1.Colspan = 6;
                         ////Headercell6.BackgroundColor = BaseColor.LIGHT_GRAY;
                         //table.AddCell(pdfBottomRow1);

                         //PdfPCell pdfBottomRow2 = new PdfPCell(new Phrase(DateTime.Now.Month.ToString() + DateTime.Now.Year + "       Module 4, Section A: Individual and Family NPIs - Employment", TableFont));
                         //pdfBottomRow2.HorizontalAlignment = Element.ALIGN_LEFT;
                         //pdfBottomRow2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                         //pdfBottomRow2.Colspan = 6;
                         ////Headercell6.BackgroundColor = BaseColor.LIGHT_GRAY;
                         //table.AddCell(pdfBottomRow2);


                         //table.FooterRows = 2;


                         if (subtable.Rows.Count > 0)
                         {
                             PdfPCell R12 = new PdfPCell(subtable);
                             R12.Padding = 0f;
                             R12.Colspan = 6;
                             R12.Border = iTextSharp.text.Rectangle.NO_BORDER;
                             table.AddCell(R12);

                             if (table.Rows.Count > 0)
                             {
                                 document.Add(table);
                                 subtable.DeleteBodyRows();
                                 table.DeleteBodyRows();
                                 document.NewPage();
                             }
                         }

                     }

                 }
             }
             catch (Exception ex) { document.Add(new Paragraph("Aborted due to Exception............................................... ")); }
             //document.Add(table);                
             document.Close();
             fs.Close();
             fs.Dispose();

             //if (LookupDataAccess.FriendlyName().Contains("2012"))
             //{
             PdfViewerNewForm objfrm = new PdfViewerNewForm(PdfName, null, Result_Table, "RNGB0014_Detail_RdlC.rdlc", "Result Table", ReportPath, BaseForm.UserID, Rb_Details_Yes.Checked, "RNGB0014");
             objfrm.StartPosition = FormStartPosition.CenterScreen;
             objfrm.ShowDialog();
             //}
             //else
             //{
             //    FrmViewer objfrm = new FrmViewer(PdfName,, Result_Table, null, "RNGB0014_Detail_RdlC.rdlc", "Result Table", ReportPath, string.Empty,Rb_Details_Yes.Checked,"RNGB0014");               
             //    //objfrm.FormClosed += new Form.FormClosedEventHandler(On_Delete_PDF_File);
             //    objfrm.ShowDialog();
             //}

         }
         */
        /**ivate void On_SaveFormExcel_Closed(DataTable dtResult, DataTable dtResultBoth)
         {

             strReasonCodes = string.Empty;

             PdfName = "RNGB0014_ExcelMainReport";

             PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;

             try
             {
                 if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                 { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
             }
             catch (Exception ex)
             {
                 AlertBox.Show("Error", MessageBoxIcon.Error);
             }

             try
             {
                 string Tmpstr = PdfName + ".xls";
                 if (File.Exists(Tmpstr))
                     File.Delete(Tmpstr);
             }
             catch (Exception ex)
             {
                 int length = 8;
                 string newFileName = System.Guid.NewGuid().ToString();
                 newFileName = newFileName.Replace("-", string.Empty);

                 Random_Filename = PdfName + newFileName.Substring(0, length) + ".xls";
             }

             if (!string.IsNullOrEmpty(Random_Filename))
                 PdfName = Random_Filename;
             else
                 PdfName += ".xls";

             try
             {

                 WorksheetRow excelrow;
                 WorksheetCell cell;

                 Workbook book = new Workbook();

                 WorksheetStyle mainstyle = book.Styles.Add("MainHeaderStyles");
                 mainstyle.Font.FontName = "Tahoma";
                 mainstyle.Font.Size = 10;
                 mainstyle.Font.Bold = true;
                 mainstyle.Font.Color = "#FFFFFF";
                 mainstyle.Interior.Color = "#0070c0";
                 mainstyle.Interior.Pattern = StyleInteriorPattern.Solid;
                 mainstyle.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                 mainstyle.Alignment.Vertical = StyleVerticalAlignment.Center;


                 WorksheetStyle style1 = book.Styles.Add("Normal");
                 style1.Font.FontName = "Tahoma";
                 style1.Font.Size = 10;
                 style1.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                 style1.Alignment.Vertical = StyleVerticalAlignment.Center;

                 WorksheetStyle stylecenter = book.Styles.Add("Normalcenter");
                 stylecenter.Font.FontName = "Tahoma";
                 stylecenter.Font.Bold = true;
                 stylecenter.Font.Size = 10;
                 stylecenter.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                 stylecenter.Alignment.Vertical = StyleVerticalAlignment.Center;

                 WorksheetStyle style3 = book.Styles.Add("NormalLeft");
                 style3.Font.FontName = "Tahoma";
                 style3.Font.Size = 10;
                 style3.Interior.Color = "#f2f2f2";
                 style3.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                 style3.Alignment.Vertical = StyleVerticalAlignment.Center;

                 WorksheetStyle style31 = book.Styles.Add("NormalLeft1");
                 style31.Font.FontName = "Tahoma";
                 style31.Font.Size = 8;
                 style31.Interior.Color = "#f2f2f2";
                 style31.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                 style31.Alignment.Vertical = StyleVerticalAlignment.Center;


                 Worksheet sheet = book.Worksheets.Add("Data");
                 //sheet.Names.Add(new WorksheetNamedRange("_FilterDatabase", "=Data!R1C1:R"+(MatRepList.Count+1).ToString()+"C11", true));
                 sheet.Table.DefaultRowHeight = 14.25F;

                 sheet.Table.DefaultColumnWidth = 220.5F;
                 sheet.Table.Columns.Add(300);
                 sheet.Table.Columns.Add(90);
                 sheet.Table.Columns.Add(80);
                 sheet.Table.Columns.Add(80);
                 sheet.Table.Columns.Add(80);
                 sheet.Table.Columns.Add(80);
                 sheet.Table.Columns.Add(80);
                 sheet.Table.Columns.Add(80);
                 sheet.Table.Columns.Add(80);
                 sheet.Table.Columns.Add(80);
                 sheet.Table.Columns.Add(80);
                 sheet.Table.Columns.Add(80);

                 List<CommonEntity> commonHeaderlist = new List<CommonEntity>();



                 // CaptainModel _model = new CaptainModel();

                 excelrow = sheet.Table.Rows.Add();

                 List<RCsb14GroupEntity> RngGrouplist = new List<RCsb14GroupEntity>();
                 List<RCsb14GroupEntity> RngtblCodelist = new List<RCsb14GroupEntity>();
                 List<RCsb14GroupEntity> RngResultlist = new List<RCsb14GroupEntity>();

                 List<RCsb14GroupEntity> RngBothResultlist = new List<RCsb14GroupEntity>();

                 if (rdoperiodBoth.Checked) //&& Rb_SNP_Mem.Checked)
                 {
                     foreach (DataRow drResultBothitem in dtResultBoth.Rows)
                     {
                         RngBothResultlist.Add(new RCsb14GroupEntity(drResultBothitem, ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString(), string.Empty));
                     }
                 }

                 foreach (DataRow drResultitem in dtResult.Rows)
                 {
                     RngResultlist.Add(new RCsb14GroupEntity(drResultitem, ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString(), string.Empty));
                 }

                 List<RNGGAEntity> GoalDetailsEntity = _model.SPAdminData.Browse_RNGGA(((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString(), ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).ID.ToString(), string.Empty, string.Empty, string.Empty);
                 if (RngCodelist.Count > 0)
                 {
                     RngGrouplist = RngCodelist.FindAll(u => u.GrpCode.Trim() != string.Empty && u.TblCode.Trim() == string.Empty && u.Agency == ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).ID.ToString() && u.Code == ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString());
                     RngtblCodelist = RngCodelist.FindAll(u => u.GrpCode.Trim() != string.Empty && u.TblCode.Trim() != string.Empty && u.Agency == ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).ID.ToString() && u.Code == ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString());
                 }
                 if (rdoOutcomesselect.Checked)
                 {

                     List<RCsb14GroupEntity> rngindswithclist = RngtblCodelist.FindAll(u => u.IndSwitch == "Y");
                     foreach (RCsb14GroupEntity itemindswitch in rngindswithclist)
                     {
                         List<RCsb14GroupEntity> rngtblcodelist = RngResultlist.FindAll(u => u.TblCode == itemindswitch.TblCode);
                         if (rngtblcodelist.Count == 0)
                         {
                             List<RNGGAEntity> GoalDetailsIndswitchEntity = GoalDetailsEntity.FindAll(u => u.TblCode.Trim() == itemindswitch.TblCode.Trim() && u.GrpCode.Trim() == itemindswitch.GrpCode.Trim() && u.Code.Trim() == ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString().Trim());
                             foreach (RNGGAEntity itemGoalind in GoalDetailsIndswitchEntity)
                             {
                                 RngResultlist.Add(new RCsb14GroupEntity(((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString(), itemindswitch.GrpCode, itemindswitch.TblCode, itemGoalind.Desc, "0", "0", "0", "0", "0", itemindswitch.unit_cnt, itemindswitch.ExAchev, itemindswitch.per_Achived, itemindswitch.CalCost, itemindswitch.Count_type, "INDSWITCH"));
                             }

                         }
                         if (rdoperiodBoth.Checked) //&& Rb_SNP_Mem.Checked)
                         {
                             List<RCsb14GroupEntity> rngtblbothcodelist = RngBothResultlist.FindAll(u => u.TblCode == itemindswitch.TblCode);
                             if (rngtblcodelist.Count == 0)
                             {
                                 List<RNGGAEntity> GoalDetailsIndswitchEntity = GoalDetailsEntity.FindAll(u => u.TblCode.Trim() == itemindswitch.TblCode.Trim() && u.GrpCode.Trim() == itemindswitch.GrpCode.Trim() && u.Code.Trim() == ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString().Trim());
                                 foreach (RNGGAEntity itemGoalind in GoalDetailsIndswitchEntity)
                                 {
                                     RngBothResultlist.Add(new RCsb14GroupEntity(((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString(), itemindswitch.GrpCode, itemindswitch.TblCode, itemGoalind.Desc, "0", "0", "0", "0", "0", itemindswitch.unit_cnt, itemindswitch.ExAchev, itemindswitch.per_Achived, itemindswitch.CalCost, itemindswitch.Count_type, "INDSWITCH"));
                                 }
                             }
                         }
                     }
                 }



                 bool boolGroupFilter = true;
                 bool boolGoalAssoFilter = true;

                 string Agy = string.Empty;
                 if (Current_Hierarchy.Substring(0, 2).ToString() != "**")
                     Agy = Current_Hierarchy.Substring(0, 2);
                 string Agency = string.Empty;
                 DataSet dsAgency = new DataSet();
                 if (!string.IsNullOrEmpty(Agy.Trim()))
                 {
                     dsAgency = Captain.DatabaseLayer.ADMNB001DB.ADMNB001_Browse_AGCYCNTL(Agy, null, null, null, null, null, null);
                     if (dsAgency != null && dsAgency.Tables[0].Rows.Count > 0)
                         Agency = dsAgency.Tables[0].Rows[0]["ACR_NAME"].ToString().Trim();
                 }

                 foreach (RCsb14GroupEntity codeitem in RngGrouplist)
                 {


                     if (Rb_User_Def.Checked)
                     {
                         boolGoalAssoFilter = false;
                         if (GoalDetailsEntity.FindAll(u => u.GrpCode.Trim() == codeitem.GrpCode.Trim()).Count > 0)
                             boolGoalAssoFilter = true;
                     }
                     if (Rb_SP_Sel.Checked)
                     {
                         boolGroupFilter = false;
                         if (ListRngGroupCode.FindAll(u => u.GrpCode.Trim() == codeitem.GrpCode.Trim()).Count > 0)
                             boolGroupFilter = true;
                     }

                     if ((boolGroupFilter) && (boolGoalAssoFilter))
                     {
                         string strResultColumn = codeitem.ExAchev.ToString();


                         excelrow = sheet.Table.Rows.Add();
                         cell = excelrow.Cells.Add(codeitem.GrpDesc, DataType.String, "MainHeaderStyles");
                         cell.MergeAcross = 11;
                         excelrow.Height = 25;


                         excelrow = sheet.Table.Rows.Add();
                         cell = excelrow.Cells.Add("Department/Program: " + DeptName + ProgName, DataType.String, "NormalLeft1");
                         cell.MergeAcross = 11;

                         excelrow = sheet.Table.Rows.Add();
                         cell = excelrow.Cells.Add("Name of CSBG Eligible Entity Reporting: ", DataType.String, "NormalLeft1");
                         //cell.MergeAcross = 11;

                         excelrow = sheet.Table.Rows.Add();
                         cell = excelrow.Cells.Add(Agency, DataType.String, "NormalLeft1");
                         cell.MergeAcross = 10;

                         excelrow = sheet.Table.Rows.Add();
                         cell = excelrow.Cells.Add("State: ", DataType.String, "NormalLeft1");
                         //cell.MergeAcross = 11;

                         excelrow = sheet.Table.Rows.Add();
                         cell = excelrow.Cells.Add("DUNS: ", DataType.String, "NormalLeft1");
                         cell.MergeAcross = 10;

                         int intcolumns = 6;
                         int intheadercount = 0;
                         if (codeitem.Incld1.ToString().ToUpper() == "TRUE")
                             intheadercount = intheadercount + 1;
                         if (codeitem.Incld2.ToString().ToUpper() == "TRUE")
                             intheadercount = intheadercount + 1;
                         if (codeitem.Incld3.ToString().ToUpper() == "TRUE")
                             intheadercount = intheadercount + 1;
                         if (codeitem.Incld4.ToString().ToUpper() == "TRUE")
                             intheadercount = intheadercount + 1;
                         if (codeitem.Incld5.ToString().ToUpper() == "TRUE")
                             intheadercount = intheadercount + 1;
                         if (strResultColumn == "0")
                             intheadercount = intheadercount + 1;
                         if (intheadercount > 1)
                             intcolumns = intcolumns + (intheadercount - 1);

                         //PdfPTable subtable = new PdfPTable(intcolumns);



                         //float[] subwidths = null;
                         //if (intcolumns == 6)
                         //    subwidths = new float[] { 250f, 60f, 60f, 60f, 60f, 60f };
                         //if (intcolumns == 7)
                         //    subwidths = new float[] { 250f, 60f, 60f, 60f, 60f, 60f, 60f };
                         //if (intcolumns == 8)
                         //    subwidths = new float[] { 250f, 60f, 60f, 60f, 60f, 60f, 60f, 60f };
                         //if (intcolumns == 9)
                         //    subwidths = new float[] { 250f, 60f, 60f, 60f, 60f, 60f, 60f, 60f, 60f };
                         //if (intcolumns == 10)
                         //    subwidths = new float[] { 250f, 60f, 60f, 60f, 60f, 60f, 60f, 60f, 60f, 60f };
                         //if (intcolumns == 11)
                         //    subwidths = new float[] { 250f, 60f, 60f, 60f, 60f, 60f, 60f, 60f, 60f, 60f, 60f };

                         //subtable.SetWidths(subwidths);

                         excelrow = sheet.Table.Rows.Add();

                         cell = excelrow.Cells.Add("", DataType.String, "Normal");

                         cell = excelrow.Cells.Add("I.) Number of Individuals Served ", DataType.String, "Normal");

                         cell = excelrow.Cells.Add("II.) Target (#)", DataType.String, "Normal");

                         cell = excelrow.Cells.Add("III.) Actual Results (#) ", DataType.String, "Normal");

                         int intcolumnscount = 3;
                         if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                         {
                             intcolumnscount = intcolumnscount + 1;

                             cell = excelrow.Cells.Add(HeadersValue(intcolumnscount) + codeitem.Hrd1, DataType.String, "Normal");

                         }

                         if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                         {
                             intcolumnscount = intcolumnscount + 1;
                             cell = excelrow.Cells.Add(HeadersValue(intcolumnscount) + codeitem.Hrd2, DataType.String, "Normal");

                         }
                         if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                         {
                             intcolumnscount = intcolumnscount + 1;
                             cell = excelrow.Cells.Add(HeadersValue(intcolumnscount) + codeitem.Hrd3, DataType.String, "Normal");

                         }
                         if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                         {
                             intcolumnscount = intcolumnscount + 1;
                             cell = excelrow.Cells.Add(HeadersValue(intcolumnscount) + codeitem.Hrd4, DataType.String, "Normal");

                         }
                         if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                         {
                             intcolumnscount = intcolumnscount + 1;
                             cell = excelrow.Cells.Add(HeadersValue(intcolumnscount) + codeitem.Hrd5, DataType.String, "Normal");

                         }

                         intcolumnscount = intcolumnscount + 1;
                         cell = excelrow.Cells.Add(HeadersValue(intcolumnscount) + "Percentage Achieving Outcome ", DataType.String, "Normal");


                         intcolumnscount = intcolumnscount + 1;
                         cell = excelrow.Cells.Add(HeadersValue(intcolumnscount) + "Performance Target Accuracy ", DataType.String, "Normal");


                         excelrow = sheet.Table.Rows.Add();
                         cell = excelrow.Cells.Add(codeitem.GrpDesc, DataType.String, "Normal");


                         cell = excelrow.Cells.Add("in program(s) (#)", DataType.String, "Normal");


                         cell = excelrow.Cells.Add("", DataType.String, "Normal");

                         cell = excelrow.Cells.Add("", DataType.String, "Normal");


                         if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                         {
                             cell = excelrow.Cells.Add("", DataType.String, "Normal");
                         }
                         if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                         {
                             cell = excelrow.Cells.Add("", DataType.String, "Normal");
                         }
                         if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                         {
                             cell = excelrow.Cells.Add("", DataType.String, "Normal");
                         }
                         if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                         {
                             cell = excelrow.Cells.Add("", DataType.String, "Normal");
                         }
                         if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                         {
                             cell = excelrow.Cells.Add("", DataType.String, "Normal");
                         }

                         cell = excelrow.Cells.Add("[III/ I = " + HeadersValue1(intcolumnscount - 1) + " ] (% auto calculated) ", DataType.String, "Normal");



                         cell = excelrow.Cells.Add("(III/II = " + HeadersValue1(intcolumnscount) + " ] (% auto calculated) ", DataType.String, "Normal");



                         if (rdoperiodBoth.Checked)
                         {

                             excelrow = sheet.Table.Rows.Add();
                             cell = excelrow.Cells.Add("", DataType.String, "Normal");

                             cell = excelrow.Cells.Add("Rept. | Ref.", DataType.String, "Normal");

                             cell = excelrow.Cells.Add("", DataType.String, "Normal");

                             cell = excelrow.Cells.Add("Rept. | Ref.", DataType.String, "Normal");

                             if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                             {
                                 cell = excelrow.Cells.Add("Rept. | Ref.", DataType.String, "Normal");
                             }
                             if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                             {
                                 cell = excelrow.Cells.Add("Rept. | Ref.", DataType.String, "Normal");
                             }
                             if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                             {
                                 cell = excelrow.Cells.Add("Rept. | Ref.", DataType.String, "Normal");
                             }
                             if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                             {
                                 cell = excelrow.Cells.Add("Rept. | Ref.", DataType.String, "Normal");
                             }
                             if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                             {
                                 cell = excelrow.Cells.Add("Rept. | Ref.", DataType.String, "Normal");
                             }


                             cell = excelrow.Cells.Add("Rept. | Ref.", DataType.String, "Normal");

                             cell = excelrow.Cells.Add("Rept. | Ref.", DataType.String, "Normal");


                         }



                         RngtblCodelist = RngCodelist.FindAll(u => u.GrpCode.Trim() == codeitem.GrpCode.Trim() && u.Code.Trim() == codeitem.Code.Trim() && u.TblCode.Trim() != string.Empty && u.Agency == ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).ID.ToString());

                         bool boolOutComesDetails = true;


                         string intcount1, intcount2, intcout3, intcount4, intcount5;
                         string intcummulativecount1, intcummulativecount2, intcummulativecout3, intcummulativecount4, intcummulativecount5;
                         string strIndSwitch = string.Empty;
                         foreach (RCsb14GroupEntity tblEnt in RngtblCodelist)
                         {
                             strIndSwitch = tblEnt.IndSwitch.ToString();

                             excelrow = sheet.Table.Rows.Add();

                             if (rdoOutcomesselect.Checked)
                             {
                                 boolOutComesDetails = false;

                                 if (strIndSwitch == "Y")
                                 {
                                     boolOutComesDetails = true;

                                 }
                                 else
                                 {
                                     RCsb14GroupEntity rngcountdata = RngResultlist.Find(u => u.GrpCode.Trim() == codeitem.GrpCode.Trim() && u.Code.Trim() == codeitem.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.unit_cnt.Trim() != "" && u.unit_cnt.Trim() != "0" && u.unit_cnt.Trim().ToUpper() != "UNIT COUNT");
                                     if (rngcountdata != null)
                                     {
                                         boolOutComesDetails = true;
                                     }
                                 }

                             }

                             if (boolOutComesDetails)
                             {

                                 if (Rb_User_Def.Checked)
                                 {
                                     boolGoalAssoFilter = false;
                                     if (strIndSwitch == "Y")
                                     {
                                         boolGoalAssoFilter = true;
                                     }
                                     else
                                     {
                                         if (GoalDetailsEntity.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim()).Count > 0)
                                             boolGoalAssoFilter = true;
                                     }
                                 }
                                 if (boolGoalAssoFilter)
                                 {



                                     intcount1 = intcount2 = intcout3 = "0";
                                     intcount4 = intcount5 = string.Empty;
                                     RCsb14GroupEntity rngcountdata = null;
                                     if (strIndSwitch == "Y" && rdoOutcomesselect.Checked)
                                     {
                                         if (Rb_SNP_Mem.Checked || rbo_ProgramWise.Checked)
                                         {
                                             rngcountdata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDesc" && u.Count_type.ToString().Trim() == string.Empty);
                                         }
                                         else
                                         {
                                             if (rdoperiodCumulative.Checked)
                                                 rngcountdata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "RefCnt");
                                             else
                                                 rngcountdata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrdCnt");
                                         }
                                         if (rngcountdata == null)
                                             rngcountdata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim());
                                     }
                                     else
                                     {
                                         if (Rb_SNP_Mem.Checked || rbo_ProgramWise.Checked)
                                         {
                                             rngcountdata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDesc" && u.Count_type.ToString().Trim() == string.Empty);
                                         }
                                         else
                                         {
                                             if (rdoperiodCumulative.Checked)
                                                 rngcountdata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "RefCnt");
                                             else
                                                 rngcountdata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrdCnt");
                                         }
                                     }
                                     if (rngcountdata != null)
                                     {

                                         cell = excelrow.Cells.Add(tblEnt.TblCode.Trim() + "." + tblEnt.GrpDesc.ToString(), DataType.String, "NormalLeft");

                                         if (strIndSwitch == "Y")
                                         {

                                             intcount1 = IndSwitch_Table.Rows.Count.ToString();

                                             intcount2 = rngcountdata.ExAchev.ToString();
                                             intcout3 = "0";

                                         }
                                         else
                                         {

                                             intcount1 = rngcountdata.unit_cnt.ToString();
                                             intcount2 = rngcountdata.ExAchev.ToString();
                                             switch (strResultColumn)
                                             {
                                                 case "0":
                                                     intcout3 = rngcountdata.unit_cnt.ToString();
                                                     break;
                                                 case "1":
                                                     intcout3 = rngcountdata.Hrd1.ToString();
                                                     break;
                                                 case "2":
                                                     intcout3 = rngcountdata.Hrd2.ToString();
                                                     break;
                                                 case "3":
                                                     intcout3 = rngcountdata.Hrd3.ToString();
                                                     break;
                                                 case "4":
                                                     intcout3 = rngcountdata.Hrd4.ToString();
                                                     break;
                                                 case "5":
                                                     intcout3 = rngcountdata.Hrd5.ToString();
                                                     break;
                                                 default:
                                                     intcout3 = rngcountdata.Hrd1.ToString();
                                                     break;
                                             }
                                         }
                                         if (intcout3.Trim() != string.Empty && intcout3 != "0")
                                         {
                                             if (intcount1.Trim() != string.Empty && intcount1 != "0")
                                             {
                                                 intcount4 = ((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount1)) * 100).ToString();
                                                 if (intcount4.Length > 4)
                                                     intcount4 = intcount4.Substring(0, 4);
                                             }
                                             if (intcount2.Trim() != string.Empty && intcount2 != "0")
                                             {
                                                 intcount5 = (((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount2))) * 100).ToString();
                                                 if (intcount5.Length > 4)
                                                     intcount5 = intcount5.Substring(0, 4);
                                             }

                                         }


                                         if (rdoperiodBoth.Checked)
                                         {
                                             //PdfPCell pdfDetailstotalTable1 = new PdfPCell(new Phrase("", TableFont));
                                             //pdfDetailstotalTable1.HorizontalAlignment = Element.ALIGN_LEFT;
                                             //pdfDetailstotalTable1.BackgroundColor = new iTextSharp.text.BaseColor(242, 243, 244);
                                             //pdfDetailstotalTable1.Border = iTextSharp.text.Rectangle.BOX;
                                             //subtable.AddCell(pdfDetailstotalTable1);


                                             intcummulativecount1 = intcummulativecount2 = intcummulativecout3 = "0";
                                             intcummulativecount4 = intcummulativecount5 = string.Empty;
                                             RCsb14GroupEntity rngcummulativecounttotaldata = null;
                                             if (strIndSwitch == "Y" && rdoOutcomesselect.Checked)
                                             {
                                                 if (!Rb_SNP_Mem.Checked)
                                                     rngcummulativecounttotaldata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "RefCnt");
                                                 else
                                                 {
                                                     if (rdoperiodBoth.Checked)
                                                     {
                                                         rngcummulativecounttotaldata = RngBothResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDesc" && u.Count_type.ToString().Trim() == string.Empty);
                                                     }
                                                     else
                                                         rngcummulativecounttotaldata = rngcountdata;
                                                 }
                                                 if (rngcummulativecounttotaldata == null)
                                                     rngcummulativecounttotaldata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim());
                                             }
                                             else
                                             {
                                                 if (!Rb_SNP_Mem.Checked)
                                                 {
                                                     rngcummulativecounttotaldata = RngBothResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "RefCnt");
                                                     // rngcummulativecounttotaldata = RngResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "RefCnt");
                                                 }
                                                 else
                                                 {
                                                     if (rdoperiodBoth.Checked)
                                                     {
                                                         rngcummulativecounttotaldata = RngBothResultlist.Find(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDesc" && u.Count_type.ToString().Trim() == string.Empty);
                                                     }
                                                     else
                                                         rngcummulativecounttotaldata = rngcountdata;
                                                 }
                                             }
                                             if (rngcummulativecounttotaldata != null)
                                             {
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     if (rdoperiodBoth.Checked)
                                                         intcummulativecount1 = IndSwitchReport_Table.Rows.Count.ToString();
                                                     else
                                                         intcummulativecount1 = IndSwitch_Table.Rows.Count.ToString();
                                                     intcummulativecount2 = rngcummulativecounttotaldata.ExAchev.ToString();
                                                     intcummulativecout3 = "0";
                                                 }
                                                 else
                                                 {
                                                     intcummulativecount1 = rngcummulativecounttotaldata.unit_cnt.ToString();
                                                     intcummulativecount2 = rngcummulativecounttotaldata.ExAchev.ToString();
                                                     switch (strResultColumn)
                                                     {
                                                         case "0":
                                                             intcummulativecout3 = rngcummulativecounttotaldata.unit_cnt.ToString();
                                                             break;
                                                         case "1":
                                                             intcummulativecout3 = rngcummulativecounttotaldata.Hrd1.ToString();
                                                             break;
                                                         case "2":
                                                             intcummulativecout3 = rngcummulativecounttotaldata.Hrd2.ToString();
                                                             break;
                                                         case "3":
                                                             intcummulativecout3 = rngcummulativecounttotaldata.Hrd3.ToString();
                                                             break;
                                                         case "4":
                                                             intcummulativecout3 = rngcummulativecounttotaldata.Hrd4.ToString();
                                                             break;
                                                         case "5":
                                                             intcummulativecout3 = rngcummulativecounttotaldata.Hrd5.ToString();
                                                             break;
                                                         default:
                                                             intcummulativecout3 = rngcummulativecounttotaldata.Hrd1.ToString();
                                                             break;
                                                     }
                                                 }
                                                 if (intcummulativecount2 == string.Empty)
                                                     intcummulativecount2 = intcount2;

                                                 if (intcummulativecout3.Trim() != string.Empty && intcummulativecout3 != "0")
                                                 {
                                                     if (intcummulativecount1.Trim() != string.Empty && intcummulativecount1 != "0")
                                                     {
                                                         intcummulativecount4 = ((Convert.ToDecimal(intcummulativecout3) / Convert.ToDecimal(intcummulativecount1)) * 100).ToString();
                                                         if (intcummulativecount4.Length > 4)
                                                             intcummulativecount4 = intcummulativecount4.Substring(0, 4);
                                                     }
                                                     if (intcummulativecount2.Trim() != string.Empty && intcummulativecount2 != "0")
                                                     {
                                                         intcummulativecount5 = (((Convert.ToDecimal(intcummulativecout3) / Convert.ToDecimal(intcummulativecount2))) * 100).ToString();
                                                         if (intcummulativecount5.Length > 4)
                                                             intcummulativecount5 = intcummulativecount5.Substring(0, 4);
                                                     }

                                                 }


                                                 cell = excelrow.Cells.Add(intcount1 + "  |  " + intcummulativecount1, DataType.String, "Normal");



                                                 cell = excelrow.Cells.Add(intcount2, DataType.String, "Normal");


                                                 cell = excelrow.Cells.Add(intcout3 + "  |  " + intcummulativecout3, DataType.String, "Normal");

                                                 if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0" + "  |  " + "0", DataType.String, "Normal");

                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(rngcountdata.Hrd1 + "  |  " + rngcummulativecounttotaldata.Hrd1, DataType.String, "Normal");

                                                     }
                                                 }

                                                 if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0" + "  |  " + "0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(rngcountdata.Hrd2 + "  |  " + rngcummulativecounttotaldata.Hrd2, DataType.String, "Normal");

                                                     }
                                                 }
                                                 if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0" + "  |  " + "0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(rngcountdata.Hrd3 + "  |  " + rngcummulativecounttotaldata.Hrd3, DataType.String, "Normal");
                                                     }
                                                 }
                                                 if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0" + "  |  " + "0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(rngcountdata.Hrd4 + "  |  " + rngcummulativecounttotaldata.Hrd4, DataType.String, "Normal");
                                                     }
                                                 }
                                                 if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0" + "  |  " + "0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(rngcountdata.Hrd5 + "  |  " + rngcummulativecounttotaldata.Hrd5, DataType.String, "Normal");
                                                     }
                                                 }

                                                 string[] strcountArray4 = intcount4.Split('.');
                                                 string strcount4 = intcount4.ToString();
                                                 if (strcountArray4.Length > 1)
                                                     strcount4 = strcountArray4[0];


                                                 //string[] strcountArray5 = intcount5.Split('.');
                                                 string strcount5 = string.Empty;
                                                 if (intcount5 != string.Empty)
                                                     strcount5 = (Math.Round(Convert.ToDouble(intcount5), MidpointRounding.AwayFromZero)).ToString();
                                                 //string strcount5 = intcount5.ToString();
                                                 //if (strcountArray5.Length > 1)
                                                 //{
                                                 //    if (strcountArray5[1].StartsWith("0"))
                                                 //    {
                                                 //        strcount5 = strcountArray5[0];
                                                 //    }
                                                 //}

                                                 string[] strcummulativecountArray4 = intcummulativecount4.Split('.');
                                                 string strcummulativecount4 = intcummulativecount4.ToString();
                                                 if (strcummulativecountArray4.Length > 1)
                                                     strcummulativecount4 = strcummulativecountArray4[0];

                                                 cell = excelrow.Cells.Add((strcount4 == string.Empty ? "" : strcount4 + "%") + " | " + (strcummulativecount4 == string.Empty ? "" : strcummulativecount4 + "%"), DataType.String, "Normal");



                                                 // string[] strcummulativecountArray5 = intcummulativecount5.Split('.');
                                                 string strcummulativecount5 = string.Empty;
                                                 if (intcummulativecount5 != string.Empty)
                                                     strcummulativecount5 = (Math.Round(Convert.ToDouble(intcummulativecount5), MidpointRounding.AwayFromZero)).ToString();
                                                 //string strcummulativecount5 = intcummulativecount5.ToString();
                                                 //if (strcummulativecountArray5.Length > 1)
                                                 //{
                                                 //    if (strcummulativecountArray5[1].StartsWith("0"))
                                                 //    {
                                                 //        strcummulativecount5 = strcummulativecountArray5[0];
                                                 //    }
                                                 //}

                                                 cell = excelrow.Cells.Add((strcount5 == string.Empty ? "" : strcount5 + "%") + " | " + (strcummulativecount5 == string.Empty ? "" : strcummulativecount5 + "%"), DataType.String, "Normal");

                                             }
                                         }
                                         else
                                         {
                                             //excelrow = sheet.Table.Rows.Add();

                                             cell = excelrow.Cells.Add(intcount1, DataType.String, "Normal");

                                             cell = excelrow.Cells.Add(intcount2, DataType.String, "Normal");

                                             cell = excelrow.Cells.Add(intcout3, DataType.String, "Normal");

                                             if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                                             {
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     cell = excelrow.Cells.Add("0", DataType.String, "Normal");
                                                 }
                                                 else
                                                 {
                                                     cell = excelrow.Cells.Add(rngcountdata.Hrd1, DataType.String, "Normal");
                                                 }
                                             }

                                             if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                                             {
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     cell = excelrow.Cells.Add("0", DataType.String, "Normal");
                                                 }
                                                 else
                                                 {
                                                     cell = excelrow.Cells.Add(rngcountdata.Hrd2, DataType.String, "Normal");
                                                 }
                                             }
                                             if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                                             {
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     cell = excelrow.Cells.Add("0", DataType.String, "Normal");
                                                 }
                                                 else
                                                 {
                                                     cell = excelrow.Cells.Add(rngcountdata.Hrd3, DataType.String, "Normal");
                                                 }
                                             }
                                             if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                                             {
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     cell = excelrow.Cells.Add("0", DataType.String, "Normal");
                                                 }
                                                 else
                                                 {
                                                     cell = excelrow.Cells.Add(rngcountdata.Hrd4, DataType.String, "Normal");
                                                 }
                                             }
                                             if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                                             {
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     cell = excelrow.Cells.Add("0", DataType.String, "Normal");
                                                 }
                                                 else
                                                 {
                                                     cell = excelrow.Cells.Add(rngcountdata.Hrd5, DataType.String, "Normal");
                                                 }
                                             }

                                             string[] strcountArray4 = intcount4.Split('.');
                                             string strcount4 = intcount4.ToString();
                                             if (strcountArray4.Length > 1)
                                                 strcount4 = strcountArray4[0];

                                             cell = excelrow.Cells.Add(strcount4 == string.Empty ? "" : strcount4 + "%", DataType.String, "Normal");


                                             // string[] strcountArray5 = intcount5.Split('.');
                                             string strcount5 = string.Empty;
                                             if (intcount5 != string.Empty)
                                                 strcount5 = (Math.Round(Convert.ToDouble(intcount5), MidpointRounding.AwayFromZero)).ToString();
                                             //if (strcountArray5.Length > 1)
                                             //{
                                             //    if (strcountArray5[1].StartsWith("0"))
                                             //    {
                                             //        strcount5 = strcountArray5[0];
                                             //    }
                                             //}

                                             cell = excelrow.Cells.Add(strcount5 == string.Empty ? "" : strcount5 + "%", DataType.String, "Normal");

                                         }
                                     }
                                     if (Rb_SNP_Mem.Checked || rbo_ProgramWise.Checked)
                                     {
                                         if (!rdoperiodBoth.Checked)
                                         {


                                             List<RCsb14GroupEntity> rngsubdetailsdata = new List<RCsb14GroupEntity>();
                                             if (strIndSwitch == "Y" && rdoOutcomesselect.Checked)
                                             {
                                                 rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrdCnt");
                                                 if (rngsubdetailsdata.Count == 0)
                                                     rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "INDSWITCH");
                                             }
                                             else
                                             {
                                                 rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrdCnt");
                                             }
                                             //List<RNGGAEntity> Goalsubdetails = GoalDetailsEntity.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim());
                                             foreach (RCsb14GroupEntity item in rngsubdetailsdata)
                                             {
                                                 excelrow = sheet.Table.Rows.Add();
                                                 intcount1 = intcount2 = intcout3 = "0";
                                                 intcount4 = intcount5 = string.Empty;
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     intcount1 = IndSwitch_Table.Rows.Count.ToString();
                                                     intcount2 = item.ExAchev.ToString();
                                                     intcout3 = "0";
                                                 }
                                                 else
                                                 {
                                                     intcount1 = item.unit_cnt.ToString();
                                                     intcount2 = item.ExAchev.ToString();

                                                     switch (strResultColumn)
                                                     {
                                                         case "0":
                                                             intcout3 = item.unit_cnt.ToString();
                                                             break;
                                                         case "1":
                                                             intcout3 = item.Hrd1.ToString();
                                                             break;
                                                         case "2":
                                                             intcout3 = item.Hrd2.ToString();
                                                             break;
                                                         case "3":
                                                             intcout3 = item.Hrd3.ToString();
                                                             break;
                                                         case "4":
                                                             intcout3 = item.Hrd4.ToString();
                                                             break;
                                                         case "5":
                                                             intcout3 = item.Hrd5.ToString();
                                                             break;
                                                         default:
                                                             intcout3 = item.Hrd1.ToString();
                                                             break;
                                                     }
                                                 }
                                                 if (intcout3.Trim() != string.Empty && intcout3 != "0")
                                                 {
                                                     if (intcount1.Trim() != string.Empty && intcount1 != "0")
                                                     {
                                                         intcount4 = ((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount1)) * 100).ToString();
                                                         if (intcount4.Length > 4)
                                                             intcount4 = intcount4.Substring(0, 4);
                                                     }
                                                     if (intcount2.Trim() != string.Empty && intcount2 != "0")
                                                     {
                                                         intcount5 = (((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount2))) * 100).ToString();
                                                         if (intcount5.Length > 4)
                                                             intcount5 = intcount5.Substring(0, 4);
                                                     }

                                                 }


                                                 cell = excelrow.Cells.Add("     " + item.GrpDesc.ToString(), DataType.String, "Normal");


                                                 if (strIndSwitch == "Y")
                                                 {
                                                     cell = excelrow.Cells.Add(intcount1.ToString(), DataType.String, "Normal");
                                                 }
                                                 else
                                                 {
                                                     cell = excelrow.Cells.Add(item.unit_cnt.ToString(), DataType.String, "Normal");
                                                 }

                                                 cell = excelrow.Cells.Add(intcount2.ToString(), DataType.String, "Normal");


                                                 cell = excelrow.Cells.Add(intcout3.ToString(), DataType.String, "Normal");


                                                 if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0", DataType.String, "Normal");

                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd1, DataType.String, "Normal");
                                                     }
                                                 }

                                                 if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd2, DataType.String, "Normal");

                                                     }
                                                 }
                                                 if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd3, DataType.String, "Normal");
                                                     }
                                                 }
                                                 if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd4, DataType.String, "Normal");
                                                     }
                                                 }
                                                 if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd5, DataType.String, "Normal");
                                                     }
                                                 }

                                                 string[] strcountArray4 = intcount4.Split('.');
                                                 string strcount4 = intcount4.ToString();
                                                 if (strcountArray4.Length > 1)
                                                     strcount4 = strcountArray4[0];


                                                 cell = excelrow.Cells.Add(strcount4 == string.Empty ? "" : strcount4 + "%", DataType.String, "Normal");


                                                 // string[] strcountArray5 = intcount5.Split('.');
                                                 // string strcount5 = intcount5.ToString();
                                                 string strcount5 = string.Empty;
                                                 if (intcount5 != string.Empty)
                                                     strcount5 = (Math.Round(Convert.ToDouble(intcount5), MidpointRounding.AwayFromZero)).ToString();
                                                 //if (strcountArray5.Length > 1)
                                                 //{
                                                 //    if (strcountArray5[1].StartsWith("0"))
                                                 //    {
                                                 //        strcount5 = strcountArray5[0];
                                                 //    }
                                                 //}

                                                 cell = excelrow.Cells.Add(strcount5 == string.Empty ? "" : strcount5 + "%", DataType.String, "Normal");

                                             }
                                         }
                                         else
                                         {
                                             List<RCsb14GroupEntity> rngsubdetailsdata = new List<RCsb14GroupEntity>();
                                             List<RCsb14GroupEntity> rngsubBothdetailsdata = new List<RCsb14GroupEntity>();
                                             if (strIndSwitch == "Y" && rdoOutcomesselect.Checked)
                                             {
                                                 rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrdCnt");

                                                 if (rngsubdetailsdata.Count == 0)
                                                     rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "INDSWITCH");

                                                 rngsubBothdetailsdata = RngBothResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrdCnt");
                                                 if (rngsubBothdetailsdata.Count == 0)
                                                     rngsubBothdetailsdata = RngBothResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "INDSWITCH" && u.Row_Type.ToString() == "INDSWITCH");
                                             }
                                             else
                                             {
                                                 rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrdCnt");
                                                 rngsubBothdetailsdata = RngBothResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrdCnt");
                                             }
                                             //List<RNGGAEntity> Goalsubdetails = GoalDetailsEntity.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim());
                                             int intbothcount = 0;

                                             foreach (RCsb14GroupEntity item in rngsubdetailsdata)
                                             {
                                                 intcount1 = intcount2 = intcout3 = "0";
                                                 intcount4 = intcount5 = string.Empty;

                                                 intcummulativecount1 = intcummulativecount2 = intcummulativecout3 = "0";
                                                 intcummulativecount4 = intcummulativecount5 = string.Empty;

                                                 if (strIndSwitch == "Y")
                                                 {
                                                     intcummulativecount1 = IndSwitchReport_Table.Rows.Count.ToString();
                                                     intcount1 = IndSwitch_Table.Rows.Count.ToString();
                                                     intcummulativecount2 = intcount2 = item.ExAchev.ToString();
                                                     intcout3 = intcummulativecout3 = "0";
                                                 }
                                                 else
                                                 {

                                                     intcount1 = item.unit_cnt.ToString();
                                                     intcummulativecount2 = intcount2 = item.ExAchev.ToString();

                                                     intcummulativecount1 = rngsubBothdetailsdata[intbothcount].unit_cnt.ToString();

                                                     switch (strResultColumn)
                                                     {
                                                         case "0":
                                                             intcout3 = item.unit_cnt.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].unit_cnt.ToString();
                                                             break;
                                                         case "1":
                                                             intcout3 = item.Hrd1.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd1.ToString();
                                                             break;
                                                         case "2":
                                                             intcout3 = item.Hrd2.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd2.ToString();
                                                             break;
                                                         case "3":
                                                             intcout3 = item.Hrd3.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd3.ToString();
                                                             break;
                                                         case "4":
                                                             intcout3 = item.Hrd4.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd4.ToString();
                                                             break;
                                                         case "5":
                                                             intcout3 = item.Hrd5.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd5.ToString();
                                                             break;
                                                         default:
                                                             intcout3 = item.Hrd1.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd1.ToString();
                                                             break;
                                                     }
                                                 }
                                                 if (intcout3.Trim() != string.Empty && intcout3 != "0")
                                                 {
                                                     if (intcount1.Trim() != string.Empty && intcount1 != "0")
                                                     {
                                                         intcount4 = ((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount1)) * 100).ToString();
                                                         if (intcount4.Length > 4)
                                                             intcount4 = intcount4.Substring(0, 4);
                                                     }
                                                     if (intcount2.Trim() != string.Empty && intcount2 != "0")
                                                     {
                                                         intcount5 = (((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount2))) * 100).ToString();
                                                         if (intcount5.Length > 4)
                                                             intcount5 = intcount5.Substring(0, 4);
                                                     }

                                                 }

                                                 if (intcummulativecout3.Trim() != string.Empty && intcummulativecout3 != "0")
                                                 {
                                                     if (intcummulativecount1.Trim() != string.Empty && intcummulativecount1 != "0")
                                                     {
                                                         intcummulativecount4 = ((Convert.ToDecimal(intcummulativecout3) / Convert.ToDecimal(intcummulativecount1)) * 100).ToString();
                                                         if (intcummulativecount4.Length > 4)
                                                             intcummulativecount4 = intcummulativecount4.Substring(0, 4);
                                                     }
                                                     if (intcummulativecount2.Trim() != string.Empty && intcummulativecount2 != "0")
                                                     {
                                                         intcummulativecount5 = (((Convert.ToDecimal(intcummulativecout3) / Convert.ToDecimal(intcummulativecount2))) * 100).ToString();
                                                         if (intcummulativecount5.Length > 4)
                                                             intcummulativecount5 = intcummulativecount5.Substring(0, 4);
                                                     }

                                                 }


                                                 cell = excelrow.Cells.Add("     " + item.GrpDesc.ToString(), DataType.String, "Normal");

                                                 if (strIndSwitch == "Y")
                                                 {
                                                     cell = excelrow.Cells.Add(intcount1.ToString() + " | " + intcummulativecount1, DataType.String, "Normal");

                                                 }
                                                 else
                                                 {
                                                     cell = excelrow.Cells.Add(item.unit_cnt.ToString() + " | " + intcummulativecount1, DataType.String, "Normal");

                                                 }


                                                 cell = excelrow.Cells.Add(intcount2.ToString(), DataType.String, "Normal");



                                                 cell = excelrow.Cells.Add(intcout3 + " | " + intcummulativecout3, DataType.String, "Normal");



                                                 if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0" + " | " + "0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd1 + " | " + rngsubBothdetailsdata[intbothcount].Hrd1, DataType.String, "Normal");
                                                     }
                                                 }

                                                 if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0" + " | " + "0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd2 + " | " + rngsubBothdetailsdata[intbothcount].Hrd2, DataType.String, "Normal");
                                                     }
                                                 }
                                                 if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0" + " | " + "0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd3 + " | " + rngsubBothdetailsdata[intbothcount].Hrd3, DataType.String, "Normal");
                                                     }
                                                 }
                                                 if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0" + " | " + "0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd4 + " | " + rngsubBothdetailsdata[intbothcount].Hrd4, DataType.String, "Normal");
                                                     }
                                                 }
                                                 if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0" + " | " + "0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd5 + " | " + rngsubBothdetailsdata[intbothcount].Hrd5, DataType.String, "Normal");
                                                     }
                                                 }

                                                 string[] strcountArray4 = intcount4.Split('.');
                                                 string strcount4 = intcount4.ToString();
                                                 if (strcountArray4.Length > 1)
                                                     strcount4 = strcountArray4[0];


                                                 string[] strcummulativecountArray4 = intcummulativecount4.Split('.');
                                                 string strcummulativecount4 = intcummulativecount4.ToString();
                                                 if (strcummulativecountArray4.Length > 1)
                                                     strcummulativecount4 = strcummulativecountArray4[0];

                                                 cell = excelrow.Cells.Add((strcount4 == string.Empty ? "" : strcount4 + "%") + " | " + (strcummulativecount4 == string.Empty ? "" : strcummulativecount4 + "%"), DataType.String, "Normal");

                                                 string[] strcountArray5 = intcount5.Split('.');
                                                 string strcount5 = string.Empty;
                                                 if (intcount5 != string.Empty)
                                                     strcount5 = (Math.Round(Convert.ToDouble(intcount5), MidpointRounding.AwayFromZero)).ToString();


                                                 //string[] strcummulativecountArray5 = intcummulativecount5.Split('.');
                                                 string strcummulativecount5 = string.Empty;
                                                 if (intcummulativecount5 != string.Empty)
                                                     strcummulativecount5 = (Math.Round(Convert.ToDouble(intcummulativecount5), MidpointRounding.AwayFromZero)).ToString();

                                                 cell = excelrow.Cells.Add((strcount5 == string.Empty ? "" : strcount5 + "%") + " | " + (strcummulativecount5 == string.Empty ? "" : strcummulativecount5 + "%"), DataType.String, "Normal");
                                                 intbothcount = intbothcount + 1;
                                             }

                                         }

                                     }
                                     else
                                     {

                                     }

                                     //Added by Sudheer on 10/10/2022 for Program Wise Counts
                                     if (rbo_ProgramWise.Checked)
                                     {
                                         if (!rdoperiodBoth.Checked)
                                         {


                                             List<RCsb14GroupEntity> rngsubdetailsdata = new List<RCsb14GroupEntity>();
                                             if (strIndSwitch == "Y" && rdoOutcomesselect.Checked)
                                             {
                                                 rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrgCnt");
                                                 if (rngsubdetailsdata.Count == 0)
                                                     rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "INDSWITCH");
                                             }
                                             else
                                             {
                                                 rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrgCnt");
                                             }
                                             //List<RNGGAEntity> Goalsubdetails = GoalDetailsEntity.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim());
                                             foreach (RCsb14GroupEntity item in rngsubdetailsdata)
                                             {
                                                 excelrow = sheet.Table.Rows.Add();
                                                 intcount1 = intcount2 = intcout3 = "0";
                                                 intcount4 = intcount5 = string.Empty;
                                                 if (strIndSwitch == "Y")
                                                 {
                                                     intcount1 = IndSwitch_Table.Rows.Count.ToString();
                                                     intcount2 = item.ExAchev.ToString();
                                                     intcout3 = "0";
                                                 }
                                                 else
                                                 {
                                                     intcount1 = item.unit_cnt.ToString();
                                                     intcount2 = item.ExAchev.ToString();

                                                     switch (strResultColumn)
                                                     {
                                                         case "0":
                                                             intcout3 = item.unit_cnt.ToString();
                                                             break;
                                                         case "1":
                                                             intcout3 = item.Hrd1.ToString();
                                                             break;
                                                         case "2":
                                                             intcout3 = item.Hrd2.ToString();
                                                             break;
                                                         case "3":
                                                             intcout3 = item.Hrd3.ToString();
                                                             break;
                                                         case "4":
                                                             intcout3 = item.Hrd4.ToString();
                                                             break;
                                                         case "5":
                                                             intcout3 = item.Hrd5.ToString();
                                                             break;
                                                         default:
                                                             intcout3 = item.Hrd1.ToString();
                                                             break;
                                                     }
                                                 }
                                                 if (intcout3.Trim() != string.Empty && intcout3 != "0")
                                                 {
                                                     if (intcount1.Trim() != string.Empty && intcount1 != "0")
                                                     {
                                                         intcount4 = ((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount1)) * 100).ToString();
                                                         if (intcount4.Length > 4)
                                                             intcount4 = intcount4.Substring(0, 4);
                                                     }
                                                     if (intcount2.Trim() != string.Empty && intcount2 != "0")
                                                     {
                                                         intcount5 = (((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount2))) * 100).ToString();
                                                         if (intcount5.Length > 4)
                                                             intcount5 = intcount5.Substring(0, 4);
                                                     }

                                                 }


                                                 cell = excelrow.Cells.Add("     " + item.GrpDesc.ToString(), DataType.String, "Normal");


                                                 if (strIndSwitch == "Y")
                                                 {
                                                     cell = excelrow.Cells.Add(intcount1.ToString(), DataType.String, "Normal");
                                                 }
                                                 else
                                                 {
                                                     cell = excelrow.Cells.Add(item.unit_cnt.ToString(), DataType.String, "Normal");
                                                 }

                                                 cell = excelrow.Cells.Add(intcount2.ToString(), DataType.String, "Normal");


                                                 cell = excelrow.Cells.Add(intcout3.ToString(), DataType.String, "Normal");


                                                 if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0", DataType.String, "Normal");

                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd1, DataType.String, "Normal");
                                                     }
                                                 }

                                                 if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd2, DataType.String, "Normal");

                                                     }
                                                 }
                                                 if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd3, DataType.String, "Normal");
                                                     }
                                                 }
                                                 if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd4, DataType.String, "Normal");
                                                     }
                                                 }
                                                 if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd5, DataType.String, "Normal");
                                                     }
                                                 }

                                                 string[] strcountArray4 = intcount4.Split('.');
                                                 string strcount4 = intcount4.ToString();
                                                 if (strcountArray4.Length > 1)
                                                     strcount4 = strcountArray4[0];


                                                 cell = excelrow.Cells.Add(strcount4 == string.Empty ? "" : strcount4 + "%", DataType.String, "Normal");


                                                 // string[] strcountArray5 = intcount5.Split('.');
                                                 // string strcount5 = intcount5.ToString();
                                                 string strcount5 = string.Empty;
                                                 if (intcount5 != string.Empty)
                                                     strcount5 = (Math.Round(Convert.ToDouble(intcount5), MidpointRounding.AwayFromZero)).ToString();
                                                 //if (strcountArray5.Length > 1)
                                                 //{
                                                 //    if (strcountArray5[1].StartsWith("0"))
                                                 //    {
                                                 //        strcount5 = strcountArray5[0];
                                                 //    }
                                                 //}

                                                 cell = excelrow.Cells.Add(strcount5 == string.Empty ? "" : strcount5 + "%", DataType.String, "Normal");

                                             }
                                         }
                                         else
                                         {
                                             List<RCsb14GroupEntity> rngsubdetailsdata = new List<RCsb14GroupEntity>();
                                             List<RCsb14GroupEntity> rngsubBothdetailsdata = new List<RCsb14GroupEntity>();
                                             if (strIndSwitch == "Y" && rdoOutcomesselect.Checked)
                                             {
                                                 rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrgCnt");

                                                 if (rngsubdetailsdata.Count == 0)
                                                     rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "INDSWITCH");

                                                 rngsubBothdetailsdata = RngBothResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrgCnt");
                                                 if (rngsubBothdetailsdata.Count == 0)
                                                     rngsubBothdetailsdata = RngBothResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "INDSWITCH" && u.Row_Type.ToString() == "INDSWITCH");
                                             }
                                             else
                                             {
                                                 rngsubdetailsdata = RngResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrgCnt");
                                                 rngsubBothdetailsdata = RngBothResultlist.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim() && u.Row_Type.ToString() == "TblDetails" && u.Count_type.ToString().Trim() == "PrgCnt");
                                             }
                                             //List<RNGGAEntity> Goalsubdetails = GoalDetailsEntity.FindAll(u => u.GrpCode.Trim() == tblEnt.GrpCode.Trim() && u.Code.Trim() == tblEnt.Code.Trim() && u.TblCode.Trim() == tblEnt.TblCode.Trim());
                                             int intbothcount = 0;

                                             foreach (RCsb14GroupEntity item in rngsubdetailsdata)
                                             {
                                                 intcount1 = intcount2 = intcout3 = "0";
                                                 intcount4 = intcount5 = string.Empty;

                                                 intcummulativecount1 = intcummulativecount2 = intcummulativecout3 = "0";
                                                 intcummulativecount4 = intcummulativecount5 = string.Empty;

                                                 if (strIndSwitch == "Y")
                                                 {
                                                     intcummulativecount1 = IndSwitchReport_Table.Rows.Count.ToString();
                                                     intcount1 = IndSwitch_Table.Rows.Count.ToString();
                                                     intcummulativecount2 = intcount2 = item.ExAchev.ToString();
                                                     intcout3 = intcummulativecout3 = "0";
                                                 }
                                                 else
                                                 {

                                                     intcount1 = item.unit_cnt.ToString();
                                                     intcummulativecount2 = intcount2 = item.ExAchev.ToString();

                                                     intcummulativecount1 = rngsubBothdetailsdata[intbothcount].unit_cnt.ToString();

                                                     switch (strResultColumn)
                                                     {
                                                         case "0":
                                                             intcout3 = item.unit_cnt.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].unit_cnt.ToString();
                                                             break;
                                                         case "1":
                                                             intcout3 = item.Hrd1.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd1.ToString();
                                                             break;
                                                         case "2":
                                                             intcout3 = item.Hrd2.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd2.ToString();
                                                             break;
                                                         case "3":
                                                             intcout3 = item.Hrd3.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd3.ToString();
                                                             break;
                                                         case "4":
                                                             intcout3 = item.Hrd4.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd4.ToString();
                                                             break;
                                                         case "5":
                                                             intcout3 = item.Hrd5.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd5.ToString();
                                                             break;
                                                         default:
                                                             intcout3 = item.Hrd1.ToString();
                                                             intcummulativecout3 = rngsubBothdetailsdata[intbothcount].Hrd1.ToString();
                                                             break;
                                                     }
                                                 }
                                                 if (intcout3.Trim() != string.Empty && intcout3 != "0")
                                                 {
                                                     if (intcount1.Trim() != string.Empty && intcount1 != "0")
                                                     {
                                                         intcount4 = ((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount1)) * 100).ToString();
                                                         if (intcount4.Length > 4)
                                                             intcount4 = intcount4.Substring(0, 4);
                                                     }
                                                     if (intcount2.Trim() != string.Empty && intcount2 != "0")
                                                     {
                                                         intcount5 = (((Convert.ToDecimal(intcout3) / Convert.ToDecimal(intcount2))) * 100).ToString();
                                                         if (intcount5.Length > 4)
                                                             intcount5 = intcount5.Substring(0, 4);
                                                     }

                                                 }

                                                 if (intcummulativecout3.Trim() != string.Empty && intcummulativecout3 != "0")
                                                 {
                                                     if (intcummulativecount1.Trim() != string.Empty && intcummulativecount1 != "0")
                                                     {
                                                         intcummulativecount4 = ((Convert.ToDecimal(intcummulativecout3) / Convert.ToDecimal(intcummulativecount1)) * 100).ToString();
                                                         if (intcummulativecount4.Length > 4)
                                                             intcummulativecount4 = intcummulativecount4.Substring(0, 4);
                                                     }
                                                     if (intcummulativecount2.Trim() != string.Empty && intcummulativecount2 != "0")
                                                     {
                                                         intcummulativecount5 = (((Convert.ToDecimal(intcummulativecout3) / Convert.ToDecimal(intcummulativecount2))) * 100).ToString();
                                                         if (intcummulativecount5.Length > 4)
                                                             intcummulativecount5 = intcummulativecount5.Substring(0, 4);
                                                     }

                                                 }


                                                 cell = excelrow.Cells.Add("     " + item.GrpDesc.ToString(), DataType.String, "Normal");

                                                 if (strIndSwitch == "Y")
                                                 {
                                                     cell = excelrow.Cells.Add(intcount1.ToString() + " | " + intcummulativecount1, DataType.String, "Normal");

                                                 }
                                                 else
                                                 {
                                                     cell = excelrow.Cells.Add(item.unit_cnt.ToString() + " | " + intcummulativecount1, DataType.String, "Normal");

                                                 }


                                                 cell = excelrow.Cells.Add(intcount2.ToString(), DataType.String, "Normal");



                                                 cell = excelrow.Cells.Add(intcout3 + " | " + intcummulativecout3, DataType.String, "Normal");



                                                 if ((codeitem.Incld1.ToString().ToUpper() == "TRUE") && (strResultColumn != "1" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0" + " | " + "0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd1 + " | " + rngsubBothdetailsdata[intbothcount].Hrd1, DataType.String, "Normal");
                                                     }
                                                 }

                                                 if ((codeitem.Incld2.ToString().ToUpper() == "TRUE") && (strResultColumn != "2" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0" + " | " + "0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd2 + " | " + rngsubBothdetailsdata[intbothcount].Hrd2, DataType.String, "Normal");
                                                     }
                                                 }
                                                 if ((codeitem.Incld3.ToString().ToUpper() == "TRUE") && (strResultColumn != "3" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0" + " | " + "0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd3 + " | " + rngsubBothdetailsdata[intbothcount].Hrd3, DataType.String, "Normal");
                                                     }
                                                 }
                                                 if ((codeitem.Incld4.ToString().ToUpper() == "TRUE") && (strResultColumn != "4" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0" + " | " + "0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd4 + " | " + rngsubBothdetailsdata[intbothcount].Hrd4, DataType.String, "Normal");
                                                     }
                                                 }
                                                 if ((codeitem.Incld5.ToString().ToUpper() == "TRUE") && (strResultColumn != "5" || strResultColumn == "0"))
                                                 {
                                                     if (strIndSwitch == "Y")
                                                     {
                                                         cell = excelrow.Cells.Add("0" + " | " + "0", DataType.String, "Normal");
                                                     }
                                                     else
                                                     {
                                                         cell = excelrow.Cells.Add(item.Hrd5 + " | " + rngsubBothdetailsdata[intbothcount].Hrd5, DataType.String, "Normal");
                                                     }
                                                 }

                                                 string[] strcountArray4 = intcount4.Split('.');
                                                 string strcount4 = intcount4.ToString();
                                                 if (strcountArray4.Length > 1)
                                                     strcount4 = strcountArray4[0];


                                                 string[] strcummulativecountArray4 = intcummulativecount4.Split('.');
                                                 string strcummulativecount4 = intcummulativecount4.ToString();
                                                 if (strcummulativecountArray4.Length > 1)
                                                     strcummulativecount4 = strcummulativecountArray4[0];

                                                 cell = excelrow.Cells.Add((strcount4 == string.Empty ? "" : strcount4 + "%") + " | " + (strcummulativecount4 == string.Empty ? "" : strcummulativecount4 + "%"), DataType.String, "Normal");

                                                 string[] strcountArray5 = intcount5.Split('.');
                                                 string strcount5 = string.Empty;
                                                 if (intcount5 != string.Empty)
                                                     strcount5 = (Math.Round(Convert.ToDouble(intcount5), MidpointRounding.AwayFromZero)).ToString();


                                                 //string[] strcummulativecountArray5 = intcummulativecount5.Split('.');
                                                 string strcummulativecount5 = string.Empty;
                                                 if (intcummulativecount5 != string.Empty)
                                                     strcummulativecount5 = (Math.Round(Convert.ToDouble(intcummulativecount5), MidpointRounding.AwayFromZero)).ToString();

                                                 cell = excelrow.Cells.Add((strcount5 == string.Empty ? "" : strcount5 + "%") + " | " + (strcummulativecount5 == string.Empty ? "" : strcummulativecount5 + "%"), DataType.String, "Normal");
                                                 intbothcount = intbothcount + 1;
                                             }

                                         }

                                     }

                                 }
                             }
                         }

                         excelrow = sheet.Table.Rows.Add();
                         excelrow.Height = 100;
                         cell = excelrow.Cells.Add("", DataType.String, "Normal");
                         cell.MergeAcross = 11;

                     }

                 }

                 FileStream stream1 = new FileStream(PdfName, FileMode.Create);
                 book.Save(stream1);
                 stream1.Close();
             }
             catch (Exception ex) { }


         }*/


        #region properties

        public string Scr_Code { get; set; }

        public string Report_Name { get; set; }

        public string Report_To_Process { get; set; }

        public DataTable Result_Table { get; set; }
        public DataTable IndSwitch_Table { get; set; }
        public DataTable IndSwitchReport_Table { get; set; }

        public DataTable Summary_table { get; set; }

        public DataSet Result_DataSet { get; set; }

        public bool Detail_Rep_Required { get; set; }

        public string Main_Rep_Name { get; set; }


        #endregion

        private void GenerateWorksheetParameters(WorksheetCollection sheets)
        {

            Worksheet sheet = sheets.Add("Parameters");
            sheet.Table.DefaultRowHeight = 14.4F;

            WorksheetColumn columnHead = sheet.Table.Columns.Add();
            columnHead.Index = 2;
            columnHead.Width = 5;
            sheet.Table.Columns.Add(163);
            WorksheetColumn column2Head = sheet.Table.Columns.Add();
            column2Head.Width = 332;
            column2Head.StyleID = "s172H";
            sheet.Table.Columns.Add(59);
            // -----------------------------------------------
            WorksheetRow RowHead = sheet.Table.Rows.Add();
            WorksheetCell cell;
            cell = RowHead.Cells.Add();
            cell.StyleID = "s139";
            cell = RowHead.Cells.Add();
            cell.StyleID = "s139";
            cell = RowHead.Cells.Add();
            cell.StyleID = "s139";
            cell = RowHead.Cells.Add();
            cell.StyleID = "s170H";
            cell = RowHead.Cells.Add();
            cell.StyleID = "s139";
            // -----------------------------------------------
            WorksheetRow Row1Head = sheet.Table.Rows.Add();
            Row1Head.Height = 12;
            Row1Head.AutoFitHeight = false;
            cell = Row1Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row1Head.Cells.Add();
            cell.StyleID = "s140";
            cell = Row1Head.Cells.Add();
            cell.StyleID = "s141";
            cell = Row1Head.Cells.Add();
            cell.StyleID = "s171H";
            cell = Row1Head.Cells.Add();
            cell.StyleID = "s142";
            // -----------------------------------------------
            WorksheetRow Row2Head = sheet.Table.Rows.Add();
            Row2Head.Height = 12;
            Row2Head.AutoFitHeight = false;
            cell = Row2Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row2Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row2Head.Cells.Add();
            cell.StyleID = "m2611536909264";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;
            // -----------------------------------------------
            WorksheetRow Row3Head = sheet.Table.Rows.Add();
            Row3Head.Height = 12;
            Row3Head.AutoFitHeight = false;
            cell = Row3Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row3Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row3Head.Cells.Add();
            cell.StyleID = "m2611536909284";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Selected Report Parameters";
            cell.MergeAcross = 2;
            // -----------------------------------------------
            WorksheetRow Row4Head = sheet.Table.Rows.Add();
            Row4Head.Height = 12;
            Row4Head.AutoFitHeight = false;
            cell = Row4Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row4Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row4Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row4Head.Cells.Add();
            cell.StyleID = "s170H";
            cell = Row4Head.Cells.Add();
            cell.StyleID = "s145";
            // -----------------------------------------------
            WorksheetRow Row5Head = sheet.Table.Rows.Add();
            Row5Head.Height = 12;
            Row5Head.AutoFitHeight = false;
            cell = Row5Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row5Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row5Head.Cells.Add();
            cell.StyleID = "m2611536909304";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;
            // -----------------------------------------------
            WorksheetRow Row6Head = sheet.Table.Rows.Add();
            Row6Head.Height = 12;
            Row6Head.AutoFitHeight = false;
            cell = Row6Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row6Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row6Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row6Head.Cells.Add();
            cell.StyleID = "s170H";
            cell = Row6Head.Cells.Add();
            cell.StyleID = "s145";
            // -----------------------------------------------


            //**string Header_year = string.Empty;
            //if (CmbYear.Visible == true)
            //    Header_year = "Year : " + ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString();

            WorksheetRow Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + txtHieDesc.Text.Trim();//** + "     " + Header_year;
            cell.MergeAcross = 2;
            // -----------------------------------------------

            string caseType = string.Empty;
            caseType = ((Captain.Common.Utilities.ListItem)Cmb_CaseType.SelectedItem).Text.ToString().Trim();


            WorksheetRow Row8 = sheet.Table.Rows.Add();
            Row8.Height = 12;
            Row8.AutoFitHeight = false;
            cell = Row8.Cells.Add();
            cell.StyleID = "s139";
            cell = Row8.Cells.Add();
            cell.StyleID = "s143";
            cell = Row8.Cells.Add();
            cell.StyleID = "m2611536909344";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;

            Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + lblCaseType.Text.Trim() + ": " + caseType;
            cell.MergeAcross = 2;

            Row8 = sheet.Table.Rows.Add();
            Row8.Height = 12;
            Row8.AutoFitHeight = false;
            cell = Row8.Cells.Add();
            cell.StyleID = "s139";
            cell = Row8.Cells.Add();
            cell.StyleID = "s143";
            cell = Row8.Cells.Add();
            cell.StyleID = "m2611536909344";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;

            string strSelectedSP = Search_Entity.ZipCode;
            strSelectedSP = strSelectedSP.Replace("'", "");

            Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + lblServiceplan.Text + ": " + (Rb_SP_All.Checked ? "All" : strSelectedSP);
            cell.MergeAcross = 2;


            Row8 = sheet.Table.Rows.Add();
            Row8.Height = 12;
            Row8.AutoFitHeight = false;
            cell = Row8.Cells.Add();
            cell.StyleID = "s139";
            cell = Row8.Cells.Add();
            cell.StyleID = "s143";
            cell = Row8.Cells.Add();
            cell.StyleID = "m2611536909344";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;

            string caseStatus = Rb_Stat_Both.Text;

            if (Rb_Stat_Act.Checked == true)
                caseStatus = Rb_Stat_Act.Text;
            else if (Rb_Stat_InAct.Checked == true)
                caseStatus = Rb_Stat_InAct.Text;

            Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + lblCaseStatus.Text + ": " + caseStatus;
            cell.MergeAcross = 2;

            Row8 = sheet.Table.Rows.Add();
            Row8.Height = 12;
            Row8.AutoFitHeight = false;
            cell = Row8.Cells.Add();
            cell.StyleID = "s139";
            cell = Row8.Cells.Add();
            cell.StyleID = "s143";
            cell = Row8.Cells.Add();
            cell.StyleID = "m2611536909344";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;

            Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + lblDateSelection.Text.Trim() + ": " + (Rb_MS_Date.Checked == true ? Rb_MS_Date.Text : Rb_MS_AddDate.Text);
            cell.MergeAcross = 2;


            Row8 = sheet.Table.Rows.Add();
            Row8.Height = 12;
            Row8.AutoFitHeight = false;
            cell = Row8.Cells.Add();
            cell.StyleID = "s139";
            cell = Row8.Cells.Add();
            cell.StyleID = "s143";
            cell = Row8.Cells.Add();
            cell.StyleID = "m2611536909344";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;

            Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + lblRepDesc.Text.Trim() + ": " + ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Text.ToString().Trim();
            cell.MergeAcross = 2;

            Row8 = sheet.Table.Rows.Add();
            Row8.Height = 12;
            Row8.AutoFitHeight = false;
            cell = Row8.Cells.Add();
            cell.StyleID = "s139";
            cell = Row8.Cells.Add();
            cell.StyleID = "s143";
            cell = Row8.Cells.Add();
            cell.StyleID = "m2611536909344";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;

            Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + lblReportType.Text.Trim() + ": " + (rbQuaterly.Checked == true ? rbQuaterly.Text : rbMonthly.Text);
            cell.MergeAcross = 2;

            Row8 = sheet.Table.Rows.Add();
            Row8.Height = 12;
            Row8.AutoFitHeight = false;
            cell = Row8.Cells.Add();
            cell.StyleID = "s139";
            cell = Row8.Cells.Add();
            cell.StyleID = "s143";
            cell = Row8.Cells.Add();
            cell.StyleID = "m2611536909344";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;

            Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + "Report Period Control" + ": " + (chkbReportPeriod.Checked == true ? "Yes" : "No");
            cell.MergeAcross = 2;

            /*Row8 = sheet.Table.Rows.Add();
            Row8.Height = 12;
            Row8.AutoFitHeight = false;
            cell = Row8.Cells.Add();
            cell.StyleID = "s139";
            cell = Row8.Cells.Add();
            cell.StyleID = "s143";
            cell = Row8.Cells.Add();
            cell.StyleID = "m2611536909344";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;

            Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + lblQ2.Text.Trim() + ": " + dtpQ2S.Text + " - " + dtpQ2E.Text;
            cell.MergeAcross = 2;

            Row8 = sheet.Table.Rows.Add();
            Row8.Height = 12;
            Row8.AutoFitHeight = false;
            cell = Row8.Cells.Add();
            cell.StyleID = "s139";
            cell = Row8.Cells.Add();
            cell.StyleID = "s143";
            cell = Row8.Cells.Add();
            cell.StyleID = "m2611536909344";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;

            Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + lblQ3.Text.Trim() + ": " + dtpQ3S.Text + " - " + dtpQ3E.Text;
            cell.MergeAcross = 2;

            Row8 = sheet.Table.Rows.Add();
            Row8.Height = 12;
            Row8.AutoFitHeight = false;
            cell = Row8.Cells.Add();
            cell.StyleID = "s139";
            cell = Row8.Cells.Add();
            cell.StyleID = "s143";
            cell = Row8.Cells.Add();
            cell.StyleID = "m2611536909344";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;

            Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + lblQ4.Text.Trim() + ": " + dtpQ4S.Text + " - " + dtpQ4E.Text;
            cell.MergeAcross = 2;

            Row8 = sheet.Table.Rows.Add();
            Row8.Height = 12;
            Row8.AutoFitHeight = false;
            cell = Row8.Cells.Add();
            cell.StyleID = "s139";
            cell = Row8.Cells.Add();
            cell.StyleID = "s143";
            cell = Row8.Cells.Add();
            cell.StyleID = "m2611536909344";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;*/


            //Row7Head = sheet.Table.Rows.Add();
            //Row7Head.Height = 12;
            //Row7Head.AutoFitHeight = false;
            //cell = Row7Head.Cells.Add();
            //cell.StyleID = "s139";
            //cell = Row7Head.Cells.Add();
            //cell.StyleID = "s143";
            //cell = Row7Head.Cells.Add();
            //cell.StyleID = "m2611536909324";
            //cell.Data.Type = DataType.String;
            //cell.Data.Text = "            " + lblAttributes.Text.Trim() + ": " + (Rb_Agy_Def.Checked == true ? Rb_Agy_Def.Text : Rb_User_Def.Text);
            //cell.MergeAcross = 2;


            Row8 = sheet.Table.Rows.Add();
            Row8.Height = 12;
            Row8.AutoFitHeight = false;
            cell = Row8.Cells.Add();
            cell.StyleID = "s139";
            cell = Row8.Cells.Add();
            cell.StyleID = "s143";
            cell = Row8.Cells.Add();
            cell.StyleID = "m2611536909344";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;

            Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + lblProduceStatistical.Text.Trim() + ": " + (Rb_Details_No.Checked == true ? Rb_Details_No.Text : Rb_Details_Yes.Text);
            cell.MergeAcross = 2;

            Row8 = sheet.Table.Rows.Add();
            Row8.Height = 12;
            Row8.AutoFitHeight = false;
            cell = Row8.Cells.Add();
            cell.StyleID = "s139";
            cell = Row8.Cells.Add();
            cell.StyleID = "s143";
            cell = Row8.Cells.Add();
            cell.StyleID = "m2611536909344";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;

            Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + lblPovertyLevel.Text.Trim() + ": " + lblLow.Text + ": " + Txt_Pov_Low.Text + "      " + lblHigh.Text + ": " + Txt_Pov_High.Text;
            cell.MergeAcross = 2;

            Row8 = sheet.Table.Rows.Add();
            Row8.Height = 12;
            Row8.AutoFitHeight = false;
            cell = Row8.Cells.Add();
            cell.StyleID = "s139";
            cell = Row8.Cells.Add();
            cell.StyleID = "s143";
            cell = Row8.Cells.Add();
            cell.StyleID = "m2611536909344";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;

            /* if (chkincverswitch.Checked)
             { 
                 Row7Head = sheet.Table.Rows.Add();
                 Row7Head.Height = 12;
                 Row7Head.AutoFitHeight = false;
                 cell = Row7Head.Cells.Add();
                 cell.StyleID = "s139";
                 cell = Row7Head.Cells.Add();
                 cell.StyleID = "s143";
                 cell = Row7Head.Cells.Add();
                 cell.StyleID = "m2611536909324";
                 cell.Data.Type = DataType.String;
                 cell.Data.Text = "            " + chkincverswitch.Text;
                 cell.MergeAcross = 2;

                 Row8 = sheet.Table.Rows.Add();
                 Row8.Height = 12;
                 Row8.AutoFitHeight = false;
                 cell = Row8.Cells.Add();
                 cell.StyleID = "s139";
                 cell = Row8.Cells.Add();
                 cell.StyleID = "s143";
                 cell = Row8.Cells.Add();
                 cell.StyleID = "m2611536909344";
                 cell.Data.Type = DataType.String;
                 cell.MergeAcross = 2; 
             }*/

            string selectedCounty = Search_Entity.County;
            selectedCounty = selectedCounty.Replace("'", "");

            Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + lblCounty.Text.Trim() + " : " + (Rb_County_All.Checked ? "All" : selectedCounty);
            cell.MergeAcross = 2;

            Row8 = sheet.Table.Rows.Add();
            Row8.Height = 12;
            Row8.AutoFitHeight = false;
            cell = Row8.Cells.Add();
            cell.StyleID = "s139";
            cell = Row8.Cells.Add();
            cell.StyleID = "s143";
            cell = Row8.Cells.Add();
            cell.StyleID = "m2611536909344";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;

            /* if (chkbUndupTable.Checked)
             {
                 Row7Head = sheet.Table.Rows.Add();
                 Row7Head.Height = 12;
                 Row7Head.AutoFitHeight = false;
                 cell = Row7Head.Cells.Add();
                 cell.StyleID = "s139";
                 cell = Row7Head.Cells.Add();
                 cell.StyleID = "s143";
                 cell = Row7Head.Cells.Add();
                 cell.StyleID = "m2611536909324";
                 cell.Data.Type = DataType.String;
                 cell.Data.Text = "            " + chkbUndupTable.Text;
                 cell.MergeAcross = 2;

                 Row8 = sheet.Table.Rows.Add();
                 Row8.Height = 12;
                 Row8.AutoFitHeight = false;
                 cell = Row8.Cells.Add();
                 cell.StyleID = "s139";
                 cell = Row8.Cells.Add();
                 cell.StyleID = "s143";
                 cell = Row8.Cells.Add();
                 cell.StyleID = "m2611536909344";
                 cell.Data.Type = DataType.String;
                 cell.MergeAcross = 2;
             }*/

            string secretApp = Rb_Mst_NonSec.Text;

            if (Rb_Mst_Sec.Checked == true)
                secretApp = Rb_Mst_Sec.Text;
            else if (Rb_Mst_BothSec.Checked == true)
                secretApp = Rb_Mst_BothSec.Text;

            Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + lblSecretApplications.Text.Trim() + " : " + secretApp;
            cell.MergeAcross = 2;

            // -----------------------------------------------
            WorksheetRow Row24 = sheet.Table.Rows.Add();
            Row24.Height = 12;
            Row24.AutoFitHeight = false;
            cell = Row24.Cells.Add();
            cell.StyleID = "s139";
            cell = Row24.Cells.Add();
            cell.StyleID = "s143";
            cell = Row24.Cells.Add();
            cell.StyleID = "m2611540549632";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;
            // -----------------------------------------------

            Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + lblAmounts.Text.Trim() + " : " + (rbAmtNo.Checked ? "No" : "Yes");
            cell.MergeAcross = 2;

            // -----------------------------------------------
            WorksheetRow Row244 = sheet.Table.Rows.Add();
            Row244.Height = 12;
            Row244.AutoFitHeight = false;
            cell = Row244.Cells.Add();
            cell.StyleID = "s139";
            cell = Row244.Cells.Add();
            cell.StyleID = "s143";
            cell = Row244.Cells.Add();
            cell.StyleID = "m2611540549632";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;
            // -----------------------------------------------
            Row7Head = sheet.Table.Rows.Add();
            Row7Head.Height = 12;
            Row7Head.AutoFitHeight = false;
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row7Head.Cells.Add();
            cell.StyleID = "m2611536909324";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "            " + lblAgyWideRep.Text.Trim() + " : " + (rbAWRNo.Checked ? "No" : "Yes");
            cell.MergeAcross = 2;

            // -----------------------------------------------
            WorksheetRow Row255 = sheet.Table.Rows.Add();
            Row255.Height = 12;
            Row255.AutoFitHeight = false;
            cell = Row255.Cells.Add();
            cell.StyleID = "s139";
            cell = Row255.Cells.Add();
            cell.StyleID = "s143";
            cell = Row255.Cells.Add();
            cell.StyleID = "m2611540549632";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;
            // -----------------------------------------------

            WorksheetRow Row25 = sheet.Table.Rows.Add();
            Row25.Height = 12;
            Row25.AutoFitHeight = false;
            cell = Row25.Cells.Add();
            cell.StyleID = "s139";
            cell = Row25.Cells.Add();
            cell.StyleID = "s143";
            cell = Row25.Cells.Add();
            cell.StyleID = "m2611540549652";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;
            // -----------------------------------------------
            WorksheetRow Row26Head = sheet.Table.Rows.Add();
            Row26Head.Height = 12;
            Row26Head.AutoFitHeight = false;
            cell = Row26Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row26Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row26Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row26Head.Cells.Add();
            cell.StyleID = "s170H";
            cell = Row26Head.Cells.Add();
            cell.StyleID = "s145";
            // -----------------------------------------------
            WorksheetRow Row27Head = sheet.Table.Rows.Add();
            Row27Head.Height = 12;
            Row27Head.AutoFitHeight = false;
            cell = Row27Head.Cells.Add();
            cell.StyleID = "s139";
            cell = Row27Head.Cells.Add();
            cell.StyleID = "s143";
            cell = Row27Head.Cells.Add();
            cell.StyleID = "m2611540549672";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;
            // -----------------------------------------------
            WorksheetRow Row28 = sheet.Table.Rows.Add();
            Row28.Height = 12;
            Row28.AutoFitHeight = false;
            cell = Row28.Cells.Add();
            cell.StyleID = "s139";
            cell = Row28.Cells.Add();
            cell.StyleID = "s143";
            cell = Row28.Cells.Add();
            cell.StyleID = "s139";
            cell = Row28.Cells.Add();
            cell.StyleID = "s170H";
            cell = Row28.Cells.Add();
            cell.StyleID = "s145";
            // -----------------------------------------------
            WorksheetRow Row29 = sheet.Table.Rows.Add();
            Row29.Height = 12;
            Row29.AutoFitHeight = false;
            cell = Row29.Cells.Add();
            cell.StyleID = "s139";
            cell = Row29.Cells.Add();
            cell.StyleID = "s143";
            cell = Row29.Cells.Add();
            cell.StyleID = "m2611540549552";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;
            // -----------------------------------------------
            WorksheetRow Row30 = sheet.Table.Rows.Add();
            Row30.Height = 12;
            Row30.AutoFitHeight = false;
            cell = Row30.Cells.Add();
            cell.StyleID = "s139";
            cell = Row30.Cells.Add();
            cell.StyleID = "s143";
            cell = Row30.Cells.Add();
            cell.StyleID = "s139";
            cell = Row30.Cells.Add();
            cell.StyleID = "s170H";
            cell = Row30.Cells.Add();
            cell.StyleID = "s145";
            // -----------------------------------------------
            WorksheetRow Row31 = sheet.Table.Rows.Add();
            Row31.Height = 12;
            Row31.AutoFitHeight = false;
            cell = Row31.Cells.Add();
            cell.StyleID = "s139";
            cell = Row31.Cells.Add();
            cell.StyleID = "s146";
            cell = Row31.Cells.Add();
            cell.StyleID = "m2611540549572";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 2;
            // -----------------------------------------------
            //  Options
            // -----------------------------------------------
            sheet.Options.Selected = true;
            sheet.Options.ProtectObjects = false;
            sheet.Options.ProtectScenarios = false;
            sheet.Options.PageSetup.Header.Margin = 0.3F;
            sheet.Options.PageSetup.Footer.Margin = 0.3F;
            sheet.Options.PageSetup.PageMargins.Bottom = 0.75F;
            sheet.Options.PageSetup.PageMargins.Left = 0.7F;
            sheet.Options.PageSetup.PageMargins.Right = 0.7F;
            sheet.Options.PageSetup.PageMargins.Top = 0.75F;
        }


        #endregion




        List<Csb16DTREntity> DateRange_List = new List<Csb16DTREntity>();
        List<Csb16DTREntity> Sys_DateRange_List = new List<Csb16DTREntity>();
        private void Get_MasterTable_DateRanges()
        {
            Csb16DTREntity Search_Entity = new Csb16DTREntity(true);
            DateRange_List = _model.SPAdminData.Browse_CSB16DTR(Search_Entity, "Browse");

            Search_Entity.SYS_Date_Range = DateTime.Today.ToShortDateString();
            Sys_DateRange_List = _model.SPAdminData.Browse_CSB16DTR(Search_Entity, "Browse");
        }


        private bool Validate_Report()
        {
            bool Can_Generate = true;
            //if (((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString() != "**")
            //{
            //    if (dtpQ1S.Value > dtpQ1E.Value)
            //    {
            //        _errorProvider.SetError(dtpQ1S, string.Format("First Quarter 'From Date' should be prior or equal to its 'To Date'".Replace(Consts.Common.Colon, string.Empty)));
            //        Can_Generate = false;
            //    }
            //    else
            //    {
            //        _errorProvider.SetError(dtpQ1S, null);
            //    }

            //    DateTime FFdate = Convert.ToDateTime(rngcodedata.OFdate);
            //    DateTime FTdate = new DateTime(Convert.ToDateTime(rngcodedata.OFdate).Year, Convert.ToDateTime(rngcodedata.OFdate).Month + 2, DateTime.DaysInMonth(Convert.ToDateTime(rngcodedata.OFdate).Month + 2, Convert.ToDateTime(rngcodedata.OFdate).Month + 2));

            //    if (dtpQ1S.Value < FFdate)
            //    {
            //        _errorProvider.SetError(dtpQ1E, string.Format("First Quarter Date Range should be in between January and March months of selected year".Replace(Consts.Common.Colon, string.Empty)));
            //        Can_Generate = false;
            //    }
            //    else
            //        _errorProvider.SetError(dtpQ1E, null);

            //    if (dtpQ1E.Value > FTdate)
            //    {
            //        _errorProvider.SetError(dtpQ1E, string.Format("First Quarter Date Range should be in between January and March months of selected year".Replace(Consts.Common.Colon, string.Empty)));
            //        Can_Generate = false;
            //    }
            //    else
            //        _errorProvider.SetError(dtpQ1E, null);

            //    if (dtpQ2S.Value > dtpQ2E.Value)
            //    {
            //        _errorProvider.SetError(dtpQ2S, string.Format("Second Quarter 'From Date' should be prior or equal to its 'To Date'".Replace(Consts.Common.Colon, string.Empty)));
            //        Can_Generate = false;
            //    }
            //    else
            //    {
            //        _errorProvider.SetError(dtpQ2S, null);
            //    }

            //    int MonthValue = Convert.ToDateTime(rngcodedata.OFdate).Month + 3;
            //    int YearValue = Convert.ToDateTime(rngcodedata.OFdate).Year;
            //    if (MonthValue > 12) { MonthValue = MonthValue - 12; YearValue = YearValue + 1; }

            //    DateTime SFdate = new DateTime(YearValue, MonthValue, 1);//Convert.ToDateTime(rngcodedata.OFdate);
            //    DateTime STdate = new DateTime(Convert.ToDateTime(dtpQ2S.Value).Year, Convert.ToDateTime(dtpQ2S.Value).Month + 2, DateTime.DaysInMonth(Convert.ToDateTime(dtpQ2S.Value).Month + 2, Convert.ToDateTime(dtpQ2S.Value).Month + 2));

            //    if (dtpQ2S.Value > STdate || dtpQ2S.Value < SFdate)
            //    {
            //        _errorProvider.SetError(dtpQ2E, string.Format("Second Quarter Date Range should be in between April and June months of selected year".Replace(Consts.Common.Colon, string.Empty)));
            //        Can_Generate = false;
            //    }
            //    else
            //        _errorProvider.SetError(dtpQ2E, null);

            //    if (dtpQ2E.Value > STdate || dtpQ2E.Value < SFdate)
            //    {
            //        _errorProvider.SetError(dtpQ2E, string.Format("Second Quarter Date Range should be in between April and June months of selected year".Replace(Consts.Common.Colon, string.Empty)));
            //        Can_Generate = false;
            //    }
            //    else
            //        _errorProvider.SetError(dtpQ2E, null);

            //    if (dtpQ3S.Value > dtpQ3E.Value)
            //    {
            //        _errorProvider.SetError(dtpQ3S, string.Format("Third Quarter 'From Date' should be prior or equal to its 'To Date'".Replace(Consts.Common.Colon, string.Empty)));
            //        Can_Generate = false;
            //    }
            //    else
            //    {
            //        _errorProvider.SetError(dtpQ3S, null);
            //    }

            //    MonthValue = Convert.ToDateTime(rngcodedata.OFdate).Month + 6;
            //    if (MonthValue > 12) { MonthValue = MonthValue - 12; }
            //    DateTime TFdate = new DateTime(YearValue, MonthValue, 1);
            //    DateTime TTdate = new DateTime(Convert.ToDateTime(dtpQ3S.Value).Year, Convert.ToDateTime(dtpQ3S.Value).Month + 2, DateTime.DaysInMonth(Convert.ToDateTime(dtpQ3S.Value).Month + 2, Convert.ToDateTime(dtpQ3S.Value).Month + 2));

            //    if (dtpQ3S.Value > TTdate || dtpQ3S.Value < TFdate)
            //    {
            //        _errorProvider.SetError(dtpQ3E, string.Format("Third Quarter Date Range should be in between July and September months of selected year".Replace(Consts.Common.Colon, string.Empty)));
            //        Can_Generate = false;
            //    }
            //    else
            //        _errorProvider.SetError(dtpQ3E, null);

            //    if (dtpQ3E.Value > TTdate || dtpQ3E.Value < TFdate)
            //    {
            //        _errorProvider.SetError(dtpQ3E, string.Format("Third Quarter Date Range should be in between July and September months of selected year".Replace(Consts.Common.Colon, string.Empty)));
            //        Can_Generate = false;
            //    }
            //    else
            //        _errorProvider.SetError(dtpQ3E, null);

            //    if (dtpQ4S.Value > dtpQ4E.Value)
            //    {
            //        _errorProvider.SetError(dtpQ4S, string.Format("Fourth Quarter 'From Date' should be prior or equal to its 'To Date'".Replace(Consts.Common.Colon, string.Empty)));
            //        Can_Generate = false;
            //    }
            //    else
            //    {
            //        _errorProvider.SetError(dtpQ4S, null);
            //    }
            //    MonthValue = Convert.ToDateTime(rngcodedata.OFdate).Month + 9;
            //    if (MonthValue > 12) { MonthValue = MonthValue - 12; }
            //    DateTime FoFdate = new DateTime(YearValue, MonthValue, 1);
            //    DateTime FoTdate = new DateTime(Convert.ToDateTime(dtpQ4S.Value).Year, Convert.ToDateTime(dtpQ4S.Value).Month + 2, DateTime.DaysInMonth(Convert.ToDateTime(dtpQ4S.Value).Month + 2, Convert.ToDateTime(dtpQ4S.Value).Month + 2));

            //    if (dtpQ4S.Value < FoFdate)
            //    {
            //        _errorProvider.SetError(dtpQ4E, string.Format("Fourth Quarter Date Range should be in between October and December months of selected year".Replace(Consts.Common.Colon, string.Empty)));
            //        Can_Generate = false;
            //    }
            //    else
            //        _errorProvider.SetError(dtpQ4E, null);

            //    if (dtpQ4E.Value > FoTdate)
            //    {
            //        _errorProvider.SetError(dtpQ4E, string.Format("Fourth Quarter Date Range should be in between October and December months of selected year".Replace(Consts.Common.Colon, string.Empty)));
            //        Can_Generate = false;
            //    }
            //    else
            //        _errorProvider.SetError(dtpQ4E, null);

            //    _errorProvider.SetError(cmbRngCode, null);
            //}
            //else
            //{
            //    _errorProvider.SetError(cmbRngCode, "Please Select Code");
            //    Can_Generate = false;
            //}
            /**if (!Ref_From_Date.Checked)
            {
                _errorProvider.SetError(Ref_From_Date, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), "Reference Period 'From Date'".Replace(Consts.Common.Colon, string.Empty)));
                Can_Generate = false;
            }
            else
                _errorProvider.SetError(Ref_From_Date, null);

            if (!Ref_To_Date.Checked)
            {
                _errorProvider.SetError(Ref_To_Date, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), "Reference Period 'To Date'".Replace(Consts.Common.Colon, string.Empty)));
                Can_Generate = false;
            }
            else
            {
                if (Ref_From_Date.Checked)
                    _errorProvider.SetError(Ref_To_Date, null);
            }

            if (Ref_To_Date.Checked && Ref_From_Date.Checked)
            {
                if (Ref_From_Date.Value > Ref_To_Date.Value)
                {
                    _errorProvider.SetError(Ref_To_Date, string.Format("Reference Period 'From Date' should be prior or equal to 'To Date'".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
            }
            else
            {
                if (Ref_To_Date.Checked && Ref_From_Date.Checked)
                    _errorProvider.SetError(Ref_To_Date, null);
            }


            if (!Rep_From_Date.Checked)
            {
                _errorProvider.SetError(Rep_From_Date, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), "Report Period 'From' Date".Replace(Consts.Common.Colon, string.Empty)));
                Can_Generate = false;
            }
            else
                _errorProvider.SetError(Rep_From_Date, null);

            if (!Rep_To_Date.Checked)
            {
                _errorProvider.SetError(Rep_To_Date, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), "Report Period 'To' Date".Replace(Consts.Common.Colon, string.Empty)));
                Can_Generate = false;
            }
            else
            {
                if (Rep_From_Date.Checked)
                    _errorProvider.SetError(Rep_To_Date, null);
            }

            if (Rep_To_Date.Checked && Rep_From_Date.Checked)
            {
                if (Rep_From_Date.Value > Rep_To_Date.Value)
                {
                    _errorProvider.SetError(Rep_From_Date, string.Format("Report Period 'From Date' should be prior or equal to 'To Date'".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
            }
            else
            {
                if (Rep_To_Date.Checked && Rep_From_Date.Checked)
                    _errorProvider.SetError(Rep_From_Date, null);
            }

            if (rdoperiodBoth.Checked || rdoperiod.Checked)
            {
                if (Ref_To_Date.Checked && Ref_From_Date.Checked && Rep_To_Date.Checked && Rep_From_Date.Checked)
                {
                    if (Ref_From_Date.Value > Rep_From_Date.Value || Ref_To_Date.Value < Rep_To_Date.Value)
                    {
                        _errorProvider.SetError(Rep_To_Date, string.Format("Report Period Should be in 'Reference Period Date Range'".Replace(Consts.Common.Colon, string.Empty)));
                        Can_Generate = false;
                    }
                    else
                        _errorProvider.SetError(Rep_To_Date, null);
                }
            }
            else if (rdoperiodCumulative.Checked)
            {
                Rep_From_Date.Value = Ref_From_Date.Value;
                Rep_To_Date.Value = Ref_To_Date.Value;
            }

            //else
            //{
            //    if (Ref_To_Date.Checked && Ref_From_Date.Checked && Rep_To_Date.Checked && Rep_From_Date.Checked)
            //        _errorProvider.SetError(Rep_From_Date, null);
            //}

            if (Rb_Fund_Sel.Checked && Sel_Funding_List.Count <= 0)
            {
                _errorProvider.SetError(Rb_Fund_Sel, string.Format("Please Select at least One 'Fund'".Replace(Consts.Common.Colon, string.Empty)));
                Can_Generate = false;
            }
            else
                _errorProvider.SetError(Rb_Fund_Sel, null);*/


            if ((Rb_SP_Sel.Checked && ListServicePlans.Count <= 0 && Scr_Oper_Mode == "RNGB0005"))
            {
                _errorProvider.SetError(Rb_SP_Sel, string.Format("Please Select at least One " + (Scr_Oper_Mode == "RNGB0005" ? "'Service Plan'" : "'ZIP Code'").Replace(Consts.Common.Colon, string.Empty)));
                Can_Generate = false;
            }
            else
                _errorProvider.SetError(Rb_SP_Sel, null);

            if (Scr_Oper_Mode == "RNGB0005")
            {
                if (Rb_County_Sel.Checked && ListcommonEntity.Count <= 0)
                {
                    _errorProvider.SetError(Rb_County_Sel, string.Format("Please Select at least One 'County'".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                    _errorProvider.SetError(Rb_County_Sel, null);

                if (rdbOCC_Sel.Checked && ListcommonEntity_Results.Count <= 0)
                {
                    _errorProvider.SetError(rdbOCC_Sel, string.Format("Please Select at least One Outcome Counting Control".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                    _errorProvider.SetError(rdbOCC_Sel, null);
            }

            /** if (Rb_Site_Sel.Checked && string.IsNullOrEmpty(Txt_Sel_Site.Text.Trim()))
             {
                 _errorProvider.SetError(Rb_Site_Sel, string.Format("Please Select at least One 'Site'".Replace(Consts.Common.Colon, string.Empty)));
                 Can_Generate = false;
             }
             else
                 _errorProvider.SetError(Rb_Site_Sel, null);

             if (rdoMsselectsite.Checked && string.IsNullOrEmpty(txt_Msselect_site.Text.Trim()))
             {
                 _errorProvider.SetError(rdoMsselectsite, string.Format("Please Select at least One 'Outcome Posting Site'".Replace(Consts.Common.Colon, string.Empty)));
                 Can_Generate = false;
             }
             else
                 _errorProvider.SetError(rdoMsselectsite, null);*/

            if (string.IsNullOrEmpty(Txt_Pov_Low.Text.Trim()))
            {
                _errorProvider.SetError(Txt_Pov_Low, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), "Poverty Level 'Low'".Replace(Consts.Common.Colon, string.Empty)));
                Can_Generate = false;
            }
            else
                _errorProvider.SetError(Txt_Pov_Low, null);

            if (string.IsNullOrEmpty(Txt_Pov_High.Text.Trim()))
            {
                _errorProvider.SetError(Txt_Pov_High, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), "Poverty Level 'High'".Replace(Consts.Common.Colon, string.Empty)));
                Can_Generate = false;
            }
            else
                _errorProvider.SetError(Txt_Pov_High, null);

            if (!string.IsNullOrEmpty(Txt_Pov_Low.Text.Trim()) && !string.IsNullOrEmpty(Txt_Pov_High.Text.Trim()))
            {
                if (int.Parse(Txt_Pov_Low.Text) > int.Parse(Txt_Pov_High.Text))
                {
                    _errorProvider.SetError(Txt_Pov_High, string.Format("Poverty Level 'Low' should not Exceed 'High'".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                    _errorProvider.SetError(Txt_Pov_High, null);
            }
            if (((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString() == "**")
            {
                _errorProvider.SetError(cmbRngCode, "Please Select Code");
                Can_Generate = false;
            }
            else
            {
                _errorProvider.SetError(cmbRngCode, null);
            }
            return Can_Generate;
        }

        private bool Validate_Report1()
        {
            bool Can_Generate = true;
            if (((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString() != "**")
            {
                if (Convert.ToDateTime(Q1Sdate) > Convert.ToDateTime(Q1Edate))
                {
                    _errorProvider.SetError(dtpQ1S, string.Format("First Quarter 'From Date' should be prior or equal to its 'To Date'".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                {
                    _errorProvider.SetError(dtpQ1S, null);
                }

                DateTime FFdate = Convert.ToDateTime(rngcodedata.OFdate);
                DateTime FTdate = new DateTime(Convert.ToDateTime(rngcodedata.OFdate).Year, Convert.ToDateTime(rngcodedata.OFdate).Month + 2, DateTime.DaysInMonth(Convert.ToDateTime(rngcodedata.OFdate).Year, Convert.ToDateTime(rngcodedata.OFdate).Month + 2));

                if (Convert.ToDateTime(Q1Sdate) < FFdate)
                {
                    _errorProvider.SetError(dtpQ1E, string.Format("First Quarter Date Range should be in between January and March months of selected year".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                    _errorProvider.SetError(dtpQ1E, null);

                if (Convert.ToDateTime(Q1Edate) > FTdate)
                {
                    _errorProvider.SetError(dtpQ1E, string.Format("First Quarter Date Range should be in between January and March months of selected year".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                    _errorProvider.SetError(dtpQ1E, null);

                if (Convert.ToDateTime(Q2Sdate) > Convert.ToDateTime(Q2Edate))
                {
                    _errorProvider.SetError(dtpQ2S, string.Format("Second Quarter 'From Date' should be prior or equal to its 'To Date'".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                {
                    _errorProvider.SetError(dtpQ2S, null);
                }

                int MonthValue = Convert.ToDateTime(rngcodedata.OFdate).Month + 3;
                int YearValue = Convert.ToDateTime(rngcodedata.OFdate).Year;
                if (MonthValue > 12) { MonthValue = MonthValue - 12; YearValue = YearValue + 1; }

                DateTime SFdate = new DateTime(YearValue, MonthValue, 1);//Convert.ToDateTime(rngcodedata.OFdate);
                DateTime STdate = new DateTime(Convert.ToDateTime(dtpQ2S.Value).Year, Convert.ToDateTime(dtpQ2S.Value).Month + 2, DateTime.DaysInMonth(Convert.ToDateTime(dtpQ2S.Value).Month + 2, Convert.ToDateTime(dtpQ2S.Value).Month + 2));

                if (Convert.ToDateTime(Q2Sdate) > STdate || Convert.ToDateTime(Q2Sdate) < SFdate)
                {
                    _errorProvider.SetError(dtpQ2E, string.Format("Second Quarter Date Range should be in between April and June months of selected year".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                    _errorProvider.SetError(dtpQ2E, null);

                if (Convert.ToDateTime(Q2Edate) > STdate || Convert.ToDateTime(Q2Edate) < SFdate)
                {
                    _errorProvider.SetError(dtpQ2E, string.Format("Second Quarter Date Range should be in between April and June months of selected year".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                    _errorProvider.SetError(dtpQ2E, null);

                if (Convert.ToDateTime(Q3Sdate) > Convert.ToDateTime(Q3Edate))
                {
                    _errorProvider.SetError(dtpQ3S, string.Format("Third Quarter 'From Date' should be prior or equal to its 'To Date'".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                {
                    _errorProvider.SetError(dtpQ3S, null);
                }

                MonthValue = Convert.ToDateTime(rngcodedata.OFdate).Month + 6;
                if (MonthValue > 12) { MonthValue = MonthValue - 12; }
                DateTime TFdate = new DateTime(YearValue, MonthValue, 1);
                DateTime TTdate = new DateTime(Convert.ToDateTime(dtpQ3S.Value).Year, Convert.ToDateTime(dtpQ3S.Value).Month + 2, DateTime.DaysInMonth(Convert.ToDateTime(dtpQ3S.Value).Month + 2, Convert.ToDateTime(dtpQ3S.Value).Month + 2));

                if (Convert.ToDateTime(Q3Sdate) > TTdate || Convert.ToDateTime(Q3Sdate) < TFdate)
                {
                    _errorProvider.SetError(dtpQ3E, string.Format("Third Quarter Date Range should be in between July and September months of selected year".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                    _errorProvider.SetError(dtpQ3E, null);

                if (Convert.ToDateTime(Q3Edate) > TTdate || Convert.ToDateTime(Q3Edate) < TFdate)
                {
                    _errorProvider.SetError(dtpQ3E, string.Format("Third Quarter Date Range should be in between July and September months of selected year".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                    _errorProvider.SetError(dtpQ3E, null);

                if (Convert.ToDateTime(Q4Sdate) > Convert.ToDateTime(Q4Edate))
                {
                    _errorProvider.SetError(dtpQ4S, string.Format("Fourth Quarter 'From Date' should be prior or equal to its 'To Date'".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                {
                    _errorProvider.SetError(dtpQ4S, null);
                }
                MonthValue = Convert.ToDateTime(rngcodedata.OFdate).Month + 9;
                if (MonthValue > 12) { MonthValue = MonthValue - 12; }
                DateTime FoFdate = new DateTime(YearValue, MonthValue, 1);
                DateTime FoTdate = new DateTime(Convert.ToDateTime(dtpQ4S.Value).Year, Convert.ToDateTime(dtpQ4S.Value).Month + 2, DateTime.DaysInMonth(Convert.ToDateTime(dtpQ4S.Value).Month + 2, Convert.ToDateTime(dtpQ4S.Value).Month + 2));

                if (Convert.ToDateTime(Q4Sdate) < FoFdate)
                {
                    _errorProvider.SetError(dtpQ4E, string.Format("Fourth Quarter Date Range should be in between October and December months of selected year".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                    _errorProvider.SetError(dtpQ4E, null);

                if (Convert.ToDateTime(Q4Edate) > FoTdate)
                {
                    _errorProvider.SetError(dtpQ4E, string.Format("Fourth Quarter Date Range should be in between October and December months of selected year".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                    _errorProvider.SetError(dtpQ4E, null);

                _errorProvider.SetError(cmbRngCode, null);
            }
            else
            {
                _errorProvider.SetError(cmbRngCode, "Please Select Code");
                Can_Generate = false;
            }



            if ((Rb_SP_Sel.Checked && ListServicePlans.Count <= 0 && Scr_Oper_Mode == "RNGB0005"))
            {
                _errorProvider.SetError(Rb_SP_Sel, string.Format("Please Select at least One " + (Scr_Oper_Mode == "RNGB0005" ? "'Service Plan'" : "'ZIP Code'").Replace(Consts.Common.Colon, string.Empty)));
                Can_Generate = false;
            }
            else
                _errorProvider.SetError(Rb_SP_Sel, null);

            if (Scr_Oper_Mode == "RNGB0005")
            {
                if (Rb_County_Sel.Checked && ListcommonEntity.Count <= 0)
                {
                    _errorProvider.SetError(Rb_County_Sel, string.Format("Please Select at least One 'County'".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                    _errorProvider.SetError(Rb_County_Sel, null);
            }



            if (string.IsNullOrEmpty(Txt_Pov_Low.Text.Trim()))
            {
                _errorProvider.SetError(Txt_Pov_Low, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), "Poverty Level 'Low'".Replace(Consts.Common.Colon, string.Empty)));
                Can_Generate = false;
            }
            else
                _errorProvider.SetError(Txt_Pov_Low, null);

            if (string.IsNullOrEmpty(Txt_Pov_High.Text.Trim()))
            {
                _errorProvider.SetError(Txt_Pov_High, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), "Poverty Level 'High'".Replace(Consts.Common.Colon, string.Empty)));
                Can_Generate = false;
            }
            else
                _errorProvider.SetError(Txt_Pov_High, null);

            if (!string.IsNullOrEmpty(Txt_Pov_Low.Text.Trim()) && !string.IsNullOrEmpty(Txt_Pov_High.Text.Trim()))
            {
                if (int.Parse(Txt_Pov_Low.Text) > int.Parse(Txt_Pov_High.Text))
                {
                    _errorProvider.SetError(Txt_Pov_High, string.Format("Poverty Level 'Low' should not Exceed 'High'".Replace(Consts.Common.Colon, string.Empty)));
                    Can_Generate = false;
                }
                else
                    _errorProvider.SetError(Txt_Pov_High, null);
            }
            if (((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString() == "**")
            {
                _errorProvider.SetError(cmbRngCode, "Please Select Code");
                Can_Generate = false;
            }
            else
            {
                _errorProvider.SetError(cmbRngCode, null);
            }
            return Can_Generate;
        }




        string RemoveBetween(string s, char begin, char end)
        {
            Regex regex = new Regex(string.Format("\\{0}.*?\\{1}", begin, end));
            return regex.Replace(s, string.Empty);
        }

        SO_Browse_Entity Search_Entity = new SO_Browse_Entity(true);
        PM_Browse_Entity PM_Search_Entity = new PM_Browse_Entity(true);
        string[] Sel_params_To_Print = new string[20] { " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " " };
        private void Get_Selection_Criteria()
        {
            Sel_params_To_Print[4] = string.Empty;
            switch (Scr_Oper_Mode)
            {
                case "RNGB0005":
                    if (Rb_SP_All.Checked)
                        Search_Entity.ZipCode = "**";
                    else
                    {
                        string strGrpcode = Get_Sel_SPCodes();
                        //if (strGrpcode.Trim() == "'7'")
                        //    Search_Entity.ZipCode = "**";
                        //else
                        Search_Entity.ZipCode = strGrpcode;
                    }

                    Search_Entity.County = "**";
                    if (Rb_County_Sel.Checked)
                        Search_Entity.County = Get_Sel_County();

                    Search_Entity.Results = "A";
                    if (rdbOCC_Sel.Checked)
                        Search_Entity.Results = Get_Sel_Results();

                    break;
                    //case "RNGB0014":
                    //    //Search_Entity.Attribute = "All";
                    //    //if (Rb_User_Def.Checked)
                    //    //    Search_Entity.Attribute = "Goal";

                    //    if (Rb_SP_All.Checked)
                    //        Search_Entity.ZipCode = "**";
                    //    else
                    //    {
                    //        string strGrpcode = Get_Sel_GroupCodes();
                    //        if (strGrpcode.Trim() == "'7'")
                    //            Search_Entity.ZipCode = "**";
                    //        else
                    //            Search_Entity.ZipCode = strGrpcode;
                    //    }

                    //    /**Search_Entity.PM_Rep_Format = "PM";
                    //    if (Rb_SNP_Mem.Checked)
                    //        Search_Entity.PM_Rep_Format = "Both";
                    //    else if (rbo_ProgramWise.Checked)
                    //        Search_Entity.PM_Rep_Format = "Prog";*/

                    //    Search_Entity.DG_Count_Sw = Search_Entity.PM_Rep_Format;

                    //    break;
            }

            Search_Entity.RngMainCode = ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString();

            Search_Entity.Ms_DriveColumn_Sw = "CADATE";
            if (Rb_MS_AddDate.Checked)
                Search_Entity.Ms_DriveColumn_Sw = "CAADDDATE";

            Search_Entity.CA_MS_Sw = "MS";


            /** Search_Entity.Rep_From_Date = Convert.ToDateTime(Ref_From_Date.Value.ToString()).ToString("MM/dd/yyyy");//Ref_From_Date.Value.ToShortDateString();
             Search_Entity.Rep_To_Date = Convert.ToDateTime(Ref_To_Date.Value.ToString()).ToString("MM/dd/yyyy");//Ref_To_Date.Value.ToShortDateString();
             if (rdoperiod.Checked)
             {
                 Search_Entity.Rep_From_Date = Convert.ToDateTime(Rep_From_Date.Value.ToString()).ToString("MM/dd/yyyy"); //Rep_From_Date.Value.ToShortDateString();
                 Search_Entity.Rep_To_Date = Convert.ToDateTime(Rep_To_Date.Value.ToString()).ToString("MM/dd/yyyy"); //Rep_To_Date.Value.ToShortDateString();
             }
             Search_Entity.Rep_Period_FDate = Convert.ToDateTime(Rep_From_Date.Value.ToString()).ToString("MM/dd/yyyy"); //Rep_From_Date.Value.ToShortDateString();
             Search_Entity.Rep_Period_TDate = Convert.ToDateTime(Rep_To_Date.Value.ToString()).ToString("MM/dd/yyyy"); //Rep_To_Date.Value.ToShortDateString();*/

            /* if (rdoperiodCumulative.Checked)
             {
                 if (Rb_SNP_Mem.Checked || rbo_ProgramWise.Checked)
                 {
                     Search_Entity.Rep_Period_FDate = Convert.ToDateTime(Ref_From_Date.Value.ToString()).ToString("MM/dd/yyyy"); //Ref_From_Date.Value.ToShortDateString();
                     Search_Entity.Rep_Period_TDate = Convert.ToDateTime(Ref_To_Date.Value.ToString()).ToString("MM/dd/yyyy"); //Ref_To_Date.Value.ToShortDateString();
                 }
             }*/

            Search_Entity.Q1_START_DATE = (Q1Sdate == "" ? "" : Convert.ToDateTime(Q1Sdate.ToString()).ToString("MM/dd/yyyy"));   // Convert.ToDateTime(dtpQ1S.Value.ToString()).ToString("MM/dd/yyyy");
            Search_Entity.Q1_END_DATE = (Q1Edate == "" ? "" : Convert.ToDateTime(Q1Edate.ToString()).ToString("MM/dd/yyyy"));   // Convert.ToDateTime(dtpQ1E.Value.ToString()).ToString("MM/dd/yyyy");
            Search_Entity.Q2_START_DATE = (Q2Sdate == "" ? "" : Convert.ToDateTime(Q2Sdate.ToString()).ToString("MM/dd/yyyy"));   // Convert.ToDateTime(dtpQ2S.Value.ToString()).ToString("MM/dd/yyyy");
            Search_Entity.Q2_END_DATE = (Q2Edate == "" ? "" : Convert.ToDateTime(Q2Edate.ToString()).ToString("MM/dd/yyyy"));   // Convert.ToDateTime(dtpQ2E.Value.ToString()).ToString("MM/dd/yyyy");
            Search_Entity.Q3_START_DATE = (Q3Sdate == "" ? "" : Convert.ToDateTime(Q3Sdate.ToString()).ToString("MM/dd/yyyy"));   // Convert.ToDateTime(dtpQ3S.Value.ToString()).ToString("MM/dd/yyyy");
            Search_Entity.Q3_END_DATE = (Q3Edate == "" ? "" : Convert.ToDateTime(Q3Edate.ToString()).ToString("MM/dd/yyyy"));   // Convert.ToDateTime(dtpQ3E.Value.ToString()).ToString("MM/dd/yyyy");
            Search_Entity.Q4_START_DATE = (Q4Sdate == "" ? "" : Convert.ToDateTime(Q4Sdate.ToString()).ToString("MM/dd/yyyy"));   // Convert.ToDateTime(dtpQ4S.Value.ToString()).ToString("MM/dd/yyyy");
            Search_Entity.Q4_END_DATE = (Q4Edate == "" ? "" : Convert.ToDateTime(Q4Edate.ToString()).ToString("MM/dd/yyyy"));   //Convert.ToDateTime(dtpQ4E.Value.ToString()).ToString("MM/dd/yyyy");

            Search_Entity.Mst_CaseType_Sw = ((Captain.Common.Utilities.ListItem)Cmb_CaseType.SelectedItem).Value.ToString();  //"**"; 

            Search_Entity.Stat_Detail = "N";
            if (Rb_Details_Yes.Checked)
                Search_Entity.Stat_Detail = "Y";

            Search_Entity.Mst_Secret_Sw = "B";
            if (Rb_Mst_Sec.Checked)
                Search_Entity.Mst_Secret_Sw = "Y";
            else
                if (Rb_Mst_NonSec.Checked)
                Search_Entity.Mst_Secret_Sw = "N";

            Search_Entity.Mst_Acive_Sw = "Y";
            if (Rb_Stat_InAct.Checked)
                Search_Entity.Mst_Acive_Sw = "N";
            else
                if (Rb_Stat_Both.Checked)
                Search_Entity.Mst_Acive_Sw = "B";

            /** Search_Entity.Mst_Site = "**";
             if (Rb_Site_Sel.Checked)
                 Search_Entity.Mst_Site = Get_Sel_Sites();
             else if (Rb_Site_No.Checked)
                 Search_Entity.Mst_Site = "NO";


             Search_Entity.CaseMssite = "**";
             if (rdoMsselectsite.Checked)
                 Search_Entity.CaseMssite = Get_Sel_CasemsSites();
             else if (rdomsNosite.Checked)
                 Search_Entity.CaseMssite = "NO";

             Search_Entity.CA_Fund_Filter = "**";
             if (Rb_Fund_Sel.Checked)
                 Search_Entity.CA_Fund_Filter = Get_Sel_CA_Fund_List_To_Filter();*/


            Search_Entity.Mst_Poverty_Low = Txt_Pov_Low.Text;
            Search_Entity.Mst_Poverty_High = Txt_Pov_High.Text;

            Search_Entity.Hierarchy = Current_Hierarchy + (CmbYear.Visible ? ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Value.ToString() : string.Empty);
            Search_Entity.Activity_Prog = "A";
            Sel_Permesures_Programs = "";
            //if (Cmb_Program.SelectedItem != null)
            //{
            //    string Tmp_Hie_On_Porgram = ((Captain.Common.Utilities.ListItem)Cmb_Program.SelectedItem).Value.ToString();
            //    if (((Captain.Common.Utilities.ListItem)Cmb_Program.SelectedItem).Value.ToString() == "**")
            //    {

            //        Search_Entity.Activity_Prog = Tmp_Hie_On_Porgram = "******";
            //    }

            //    Sel_Permesures_Programs = Search_Entity.Activity_Prog = Tmp_Hie_On_Porgram;
            //}

            /**string Sel_Programs = string.Empty;
            if (rbSelProgram.Checked == true)
            {
                if (SelectedHierarchies.Count > 0)
                {
                    foreach (HierarchyEntity Entity in SelectedHierarchies)
                    {
                        Sel_Programs += Entity.Agency + Entity.Dept + Entity.Prog + ",";
                    }

                    if (Sel_Programs.Length > 0)
                        Sel_Programs = Sel_Programs.Substring(0, (Sel_Programs.Length - 1));

                    if (Sel_Programs.Length > 0)
                        Sel_Permesures_Programs = Search_Entity.Activity_Prog = Sel_Programs;
                }
            }*/

            Search_Entity.UserName = BaseForm.UserID;

            switch (Search_Entity.Mst_Secret_Sw)
            {
                case "Y": Sel_params_To_Print[0] = "Secret Only"; break;
                case "N": Sel_params_To_Print[0] = "Non Secret Only"; break;
                default: Sel_params_To_Print[0] = "Both Secret and Non Secret "; break;
            }
            switch (Search_Entity.Mst_Acive_Sw)
            {
                case "Y": Sel_params_To_Print[1] = "Active"; break;
                case "N": Sel_params_To_Print[1] = "Inactive"; break;
                default: Sel_params_To_Print[1] = "Both Active and Inactive"; break;
            }
            //switch (Search_Entity.Mst_Site)
            //{
            //    case "**": Sel_params_To_Print[2] = "All Sites"; break;
            //    case "NO": Sel_params_To_Print[2] = "No Sites"; break;
            //    default: Sel_params_To_Print[2] = "Selected Site"; break;
            //}
            //switch (Search_Entity.CaseMssite)
            //{
            //    case "**": Sel_params_To_Print[3] = "ALL MS Sites"; break;
            //    case "NO": Sel_params_To_Print[3] = "No MS Sites"; break;
            //    default: Sel_params_To_Print[3] = "Selected MS Site"; break;
            //}
            //** Search_Entity.OutComeSwitch = rdoOutcomesAll.Checked == true ? "A" : "S";
            Search_Entity.IncVerSwitch = chkincverswitch.Checked == true ? "Y" : "N";
        }


        private string Get_Sel_County()
        {
            string Sel_County_Codes = null;
            foreach (CommonEntity Entity in ListcommonEntity)
            {
                Sel_County_Codes += Entity.Code + ",";//"'" + Entity.Code + "' ,";
            }

            if (Sel_County_Codes.Length > 0)
                Sel_County_Codes = Sel_County_Codes.Substring(0, (Sel_County_Codes.Length - 1));

            return Sel_County_Codes;
        }
        private string Get_Sel_SPCodes()
        {
            string Sel_Groups_Codes = string.Empty;
            List<string> lstCodes = new List<string>();
            foreach (CASESP1Entity Entity in ListServicePlans)
            {
                if (lstCodes.Where(x => x.Contains(Entity.Code.Trim())).Count() == 0)
                {
                    Sel_Groups_Codes += "" + Entity.Code.Trim() + ",";
                    lstCodes.Add(Entity.Code.Trim());
                }
            }

            if (Sel_Groups_Codes.Length > 0)
                Sel_Groups_Codes = Sel_Groups_Codes.Substring(0, (Sel_Groups_Codes.Length - 1));

            return Sel_Groups_Codes;
        }

        List<CASESP1Entity> SP_Hierarchies = new List<CASESP1Entity>();
        private void Selected_SPs(string Sel_List)
        {
            string ACR_SERV_Hies = string.Empty;

            if (!string.IsNullOrEmpty(BaseForm.BaseAgencyControlDetails.ServicePlanHiecontrol.Trim()))
            {
                if (BaseForm.BaseAgencyControlDetails.ServicePlanHiecontrol.Trim() == "Y")
                    ACR_SERV_Hies = "S";
            }

            if (ACR_SERV_Hies == "Y" || ACR_SERV_Hies == "S")
            {
                if (BaseForm.BaseAgencyControlDetails.SerPlanAllow.Trim() == "D")
                    SP_Hierarchies = _model.SPAdminData.CASESP1_SerPlans(null, strAgency == "**" ? null : strAgency, strDept == "**" ? null : strDept, null, BaseForm.UserID);
                else
                    SP_Hierarchies = _model.SPAdminData.CASESP1_SerPlans(null, strAgency == "**" ? null : strAgency, null, null, BaseForm.UserID);
            }
            else
                SP_Hierarchies = _model.SPAdminData.CASESP1_SerPlans(null, strAgency == "**" ? null : strAgency, strDept == "**" ? null : strDept, strProg == "**" ? null : strProg, BaseForm.UserID);

            if (ListServicePlans != null && ListServicePlans.Count > 0)
            {
                SP_Hierarchies.ForEach(item => item.Sel_Type = (ListServicePlans.Exists(u => u.Code.Equals(item.Code))) ? "true" : "false");
            }

            SP_Hierarchies = SP_Hierarchies.OrderByDescending(U => U.Sp0_Active).ToList();

            if (!string.IsNullOrEmpty(Sel_List.Trim()))
            {
                //Sel_List = Sel_List + ",";
                string[] Sp_list = Sel_List.Split(',');
                ListServicePlans.Clear();
                //foreach (CASESP1Entity Entity in ListServicePlans)
                foreach (CASESP1Entity Entity in SP_Hierarchies)
                {
                    if (Sp_list.Length > 0)
                    {
                        var results = Array.FindAll(Sp_list, s => s.Equals(Entity.Code.Trim()));
                        if (results.Length > 0)
                            ListServicePlans.Add(Entity);
                    }
                    ////if (Sel_List.Contains(Entity.Code.Trim()))
                    //if (Sel_List.Contains(Entity.Code.Trim() + ","))
                    //    ListServicePlans.Add(Entity);
                }
            }
        }

        //List<RCsb14GroupEntity> OutCome_MasterList = new List<RCsb14GroupEntity>();
        //private void Prepare_Selected_Group(string Sel_ZipCodes)
        //{
        //    ListRngGroupCode.Clear();
        //    OutCome_MasterList = _model.SPAdminData.Browse_RNGGrp(((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString(), null, null, null, null, BaseForm.UserID, BaseForm.BaseAgency);
        //    foreach (RCsb14GroupEntity Entity in OutCome_MasterList)
        //    {
        //        if (Sel_ZipCodes.Contains(Entity.GrpCode.Trim()))
        //            ListRngGroupCode.Add(new RCsb14GroupEntity(Entity));
        //    }
        //}


        string Sel_AGY, Sel_DEPT, Sel_PROG = string.Empty;
        string Sel_Secret_App, Sel_Group_Sort, Sel_Use_CASEDIFF, Sel_Include_Members = string.Empty, Sel_Permesures_Programs = "";
        private void Get_Report_Selection_Parameters()
        {
            Sel_AGY = Current_Hierarchy.Substring(0, 2);
            Sel_DEPT = Current_Hierarchy.Substring(2, 2);
            Sel_PROG = Current_Hierarchy.Substring(4, 2);

            //switch (((ListItem)Cmb_Applications.SelectedItem).Value.ToString())
            //{
            //    case "1": Sel_Secret_App = "Non-Secret Only"; break;
            //    case "2": Sel_Secret_App = "Secret Only"; break;
            //    case "3": Sel_Secret_App = "Both Secret & Non-Secret"; break;
            //}

            //switch (((ListItem)Cmb_Group_Sort.SelectedItem).Value.ToString())
            //{
            //    case "ASC": Sel_Group_Sort = "Sort Fields : Ascending"; break;
            //    case "DESC": Sel_Group_Sort = "Sort Fields : Descending"; break;
            //}

            //Sel_Use_CASEDIFF = "Use CASEDIFF : No";
            //if (Cb_Use_DIFF.Checked)
            //    Sel_Use_CASEDIFF = "Use CASEDIFF : Yes";


            //Sel_Include_Members = "Include All Members : No";
            //if (Cb_Inc_Menbers.Checked)
            //    Sel_Include_Members = "Include All Members : Yes";
        }

        private void Btn_Save_Params_Click(object sender, EventArgs e)
        {
            if (Validate_Report())
            {
                ControlCard_Entity Save_Entity = new ControlCard_Entity(true);

                Get_Selection_Criteria();
                //Save_Entity.Scr_Code = PrivilegeEntity.Program;
                Save_Entity.Scr_Code = Scr_Oper_Mode;
                Save_Entity.UserID = BaseForm.UserID;
                Save_Entity.Card_1 = Get_XML_Format_for_Report_Controls();
                Save_Entity.Card_2 = Save_Entity.Card_3 = null;
                Save_Entity.Module = BaseForm.BusinessModuleID;

                Report_Get_SaveParams_Form Save_Form = new Report_Get_SaveParams_Form(Save_Entity, "Save", BaseForm, PrivilegeEntity);
                Save_Form.StartPosition = FormStartPosition.CenterScreen;
                Save_Form.ShowDialog();
            }

        }

        private string Get_XML_Format_for_Report_Controls()   // 12012012
        {

            /**string strrptfor = "R";
            if (rdoperiodCumulative.Checked)
                strrptfor = "C";
            if (rdoperiodBoth.Checked)
                strrptfor = "B";

            string strRepControl = "N";
            if (chkRepControl.Checked == true)
                strRepControl = "Y";*/

            /**** string SiteType = string.Empty;
             if (Rb_Site_Sel.Checked == true)
                 SiteType = Search_Entity.Mst_Site;
             else if (rdoMsselectsite.Checked == true)
                 SiteType = Search_Entity.Mst_Site;*/

            string ReportType = string.Empty;
            if (rbQuaterly.Checked)
                ReportType = "Q";
            else
                ReportType = "M";

            string Amounts = string.Empty;
            if (rbAmtYes.Checked)
                Amounts = "Y";
            else
                Amounts = "N";

            string AgyWideReport = string.Empty;
            if (rbAWRYes.Checked)
                AgyWideReport = "Y";
            else
                AgyWideReport = "N";

            string RepPeriodCntl = string.Empty;
            if (chkbReportPeriod.Checked)
                RepPeriodCntl = "Y";
            else
                RepPeriodCntl = "N";

            StringBuilder str = new StringBuilder();
            str.Append("<Rows>");

            str.Append("<Row AGENCY = \"" + Current_Hierarchy_DB.Substring(0, 2) + "\" DEPT = \"" + Current_Hierarchy_DB.Substring(3, 2) + "\" PROG = \"" + Current_Hierarchy_DB.Substring(6, 2) +
                                      "\" CASE_TYPE = \"" + Search_Entity.Mst_CaseType_Sw + "\" CASE_STATUS = \"" + Search_Entity.Mst_Acive_Sw + "\" DATE_SELECTION = \"" + Search_Entity.Ms_DriveColumn_Sw +
                                      "\" REFERENCE_FROM_DATE = \"" + Search_Entity.Rep_From_Date + "\" REFERENCE_TO_DATE = \"" + Search_Entity.Rep_To_Date + "\" REPORT_FROM_DATE = \"" + Search_Entity.Rep_Period_FDate +
                                      "\" REPORT_TO_DATE = \"" + Search_Entity.Rep_Period_TDate + "\" SITE = \"" + /*SiteType*/ Search_Entity.Mst_Site + "\" ATTRIBUTES = \"" + Search_Entity.Attribute + "\" STAT_DETAILS = \"" + Search_Entity.Stat_Detail +
                                      "\" POVERTY_LOW = \"" + Search_Entity.Mst_Poverty_Low + "\" POVERTY_HIGH = \"" + Search_Entity.Mst_Poverty_High + "\" ZIPCODE = \"" + Search_Entity.ZipCode +
                                      "\" COUNTY = \"" + Search_Entity.County + "\" DG_COUNT = \"" + Search_Entity.DG_Count_Sw + "\" SECRET_APP = \"" + Search_Entity.Mst_Secret_Sw + "\" ACTY_PROGRAM = \"" + Search_Entity.Activity_Prog +
                                      "\" CAMS_SW = \"" + Search_Entity.CA_MS_Sw + "\" CAMS_Filter_List = \"" + Search_Entity.CAMS_Filter + "\" FUND_Filter_List = \"" + Search_Entity.CA_Fund_Filter + "\" RNG_MAIN_CODE = \"" + Search_Entity.RngMainCode + "\" OUTCOME_SWITCH = \"" + "\" CASEMSSITE = \"" + Search_Entity.CaseMssite + "\" INCVERSWITCH = \"" + Search_Entity.IncVerSwitch + "\" REPORTFOR =\"" + "\" REPORTCONTROL =\"" + "\" REP_TYPE = \"" + ReportType
                                      + "\" AMOUNTS = \"" + Amounts + "\" AGYWIDEREP = \"" + AgyWideReport + "\" REPPERIODCNTL = \"" + RepPeriodCntl + "\" RESULTS = \"" + Search_Entity.Results + "\" />"); //
            /** //switch (Scr_Oper_Mode)
             //{
             //    case "CASB0004":
             //        str.Append("<Row AGENCY = \"" + Current_Hierarchy_DB.Substring(0, 2) + "\" DEPT = \"" + Current_Hierarchy_DB.Substring(3, 2) + "\" PROG = \"" + Current_Hierarchy_DB.Substring(6, 2) +
             //                                  "\" CASE_TYPE = \"" + Search_Entity.Mst_CaseType_Sw + "\" CASE_STATUS = \"" + Search_Entity.Mst_Acive_Sw + "\" DATE_SELECTION = \"" + Search_Entity.Ms_DriveColumn_Sw +
             //                                  "\" REFERENCE_FROM_DATE = \"" + Search_Entity.Rep_From_Date + "\" REFERENCE_TO_DATE = \"" + Search_Entity.Rep_To_Date + "\" REPORT_FROM_DATE = \"" + Search_Entity.Rep_Period_FDate +
             //                                  "\" REPORT_TO_DATE = \"" + Search_Entity.Rep_Period_TDate + "\" SITE = \"" + Search_Entity.Mst_Site + "\" ATTRIBUTES = \"" + Search_Entity.Attribute + "\" STAT_DETAILS = \"" + Search_Entity.Stat_Detail +
             //                                  "\" POVERTY_LOW = \"" + Search_Entity.Mst_Poverty_Low + "\" POVERTY_HIGH = \"" + Search_Entity.Mst_Poverty_High + "\" ZIPCODE = \"" + Search_Entity.ZipCode +
             //                                  "\" COUNTY = \"" + Search_Entity.County + "\" DG_COUNT = \"" + Search_Entity.DG_Count_Sw + "\" SECRET_APP = \"" + Search_Entity.Mst_Secret_Sw + "\" />");
             //        break;

             //    case "RNGB0014":
             //        str.Append("<Row AGENCY = \"" + Current_Hierarchy_DB.Substring(0, 2) + "\" DEPT = \"" + Current_Hierarchy_DB.Substring(3, 2) + "\" PROG = \"" + Current_Hierarchy_DB.Substring(6, 2) +
             //                                  "\" CASE_TYPE = \"" + Search_Entity.Mst_CaseType_Sw + "\" CASE_STATUS = \"" + Search_Entity.Mst_Acive_Sw + "\" DATE_SELECTION = \"" + Search_Entity.Ms_DriveColumn_Sw +
             //                                  "\" REFERENCE_FROM_DATE = \"" + Search_Entity.Rep_From_Date + "\" REFERENCE_TO_DATE = \"" + Search_Entity.Rep_To_Date + "\" REPORT_FROM_DATE = \"" + Search_Entity.Rep_Period_FDate +
             //                                  "\" REPORT_TO_DATE = \"" + Search_Entity.Rep_Period_TDate + "\" SITE = \"" + Search_Entity.Mst_Site + "\" ATTRIBUTES = \"" + Search_Entity.Attribute + "\" STAT_DETAILS = \"" + Search_Entity.Stat_Detail +
             //                                  "\" POVERTY_LOW = \"" + Search_Entity.Mst_Poverty_Low + "\" POVERTY_HIGH = \"" + Search_Entity.Mst_Poverty_High + "\" ZIPCODE = \"" + Search_Entity.ZipCode +
             //                                  "\" COUNTY = \"" + Search_Entity.County + "\" SECRET_APP = \"" + Search_Entity.Mst_Secret_Sw + "\" />");
             //        break;
             //}*/
            str.Append("</Rows>");

            return str.ToString();
        }

        private void Btn_Get_Params_Click(object sender, EventArgs e)
        {
            ControlCard_Entity Save_Entity = new ControlCard_Entity(true);
            //Save_Entity.Scr_Code = PrivilegeEntity.Program;
            Save_Entity.Scr_Code = Scr_Oper_Mode;
            Save_Entity.UserID = BaseForm.UserID;
            Save_Entity.Module = BaseForm.BusinessModuleID;
            Report_Get_SaveParams_Form Save_Form = new Report_Get_SaveParams_Form(Save_Entity, "Get");
            Save_Form.FormClosed += new FormClosedEventHandler(Get_Saved_Parameters);
            Save_Form.StartPosition = FormStartPosition.CenterScreen;
            Save_Form.ShowDialog();

        }

        private void Get_Saved_Parameters(object sender, FormClosedEventArgs e)
        {
            Report_Get_SaveParams_Form form = sender as Report_Get_SaveParams_Form;
            string[] Saved_Parameters = new string[2];
            Saved_Parameters[0] = Saved_Parameters[1] = string.Empty;

            if (form.DialogResult == DialogResult.OK)
            {
                Clear_Error_Providers();

                DataTable RepCntl_Table = new DataTable();
                Saved_Parameters = form.Get_Adhoc_Saved_Parameters();

                RepCntl_Table = CommonFunctions.Convert_XMLstring_To_Datatable(Saved_Parameters[0]);
                Set_Report_Controls(RepCntl_Table);
            }
        }


        private void Set_Report_Controls(DataTable Tmp_Table)
        {
            if (Tmp_Table != null && Tmp_Table.Rows.Count > 0)
            {
                DataRow dr = Tmp_Table.Rows[0];
                DataColumnCollection columns = Tmp_Table.Columns;

                Set_Report_Hierarchy(dr["AGENCY"].ToString(), dr["DEPT"].ToString(), dr["PROG"].ToString(), string.Empty);
                fillRngCode();
                SetComboBoxValue(Cmb_CaseType, dr["CASE_TYPE"].ToString());

                switch (dr["CASE_STATUS"].ToString())
                {
                    case "Y": Rb_Stat_Act.Checked = true; break;
                    case "N": Rb_Stat_InAct.Checked = true; break;
                    case "B": Rb_Stat_Both.Checked = true; break;
                    default: Rb_Stat_Act.Checked = true; break;
                }

                /** Txt_Sel_Site.Clear();
                 switch (dr["SITE"].ToString())
                 {
                     case "**": Rb_Site_All.Checked = true; break;
                     case "NO": Rb_Site_No.Checked = true; break;
                     default:
                         Rb_Site_Sel.Checked = true; Txt_Sel_Site.Text = dr["SITE"].ToString();
                         Site_List = _model.CaseMstData.GetCaseSite(Current_Hierarchy.Substring(0, 2), Current_Hierarchy.Substring(2, 2), Current_Hierarchy.Substring(4, 2), "SiteHie");
                         ListcaseSiteEntity.Clear();
                         foreach (CaseSiteEntity casesite in Site_List) //Site_List)//ListcaseSiteEntity)
                         {
                             if (Txt_Sel_Site.Text.Contains(casesite.SiteNUMBER))
                                 ListcaseSiteEntity.Add(casesite);
                             // Sel_Site_Codes += "'" + casesite.SiteNUMBER + "' ,";
                         }


                         break;
                 }*/

                if (columns.Contains("INCVERSWITCH"))
                {
                    chkincverswitch.Checked = dr["INCVERSWITCH"].ToString() == "Y" ? true : false;
                }
                /** if (columns.Contains("CASEMSSITE"))
                 {
                     txt_Msselect_site.Clear();
                     switch (dr["CASEMSSITE"].ToString())
                     {
                         case "**": rdoMssiteall.Checked = true; break;
                         case "NO": rdomsNosite.Checked = true; break;
                         default:
                             rdoMsselectsite.Checked = true; txt_Msselect_site.Text = dr["CASEMSSITE"].ToString();
                             // MSSite_List = _model.CaseMstData.GetCaseSite(Current_Hierarchy.Substring(0, 2), Current_Hierarchy.Substring(2, 2), Current_Hierarchy.Substring(4, 2), "SiteHie");
                             ListcaseMsSiteEntity.Clear();
                             foreach (CaseSiteEntity casesite in Site_List) //Site_List)//ListcaseSiteEntity)
                             {
                                 if (txt_Msselect_site.Text.Contains(casesite.SiteNUMBER))
                                     ListcaseMsSiteEntity.Add(casesite);
                                 // Sel_Site_Codes += "'" + casesite.SiteNUMBER + "' ,";
                             }


                             break;
                     }
                 }*/


                /** Ref_From_Date.Value = Convert.ToDateTime(dr["REFERENCE_FROM_DATE"].ToString());
                 Ref_To_Date.Value = Convert.ToDateTime(dr["REFERENCE_TO_DATE"].ToString());
                 Rep_From_Date.Value = Convert.ToDateTime(dr["REPORT_FROM_DATE"].ToString());
                 Rep_To_Date.Value = Convert.ToDateTime(dr["REPORT_TO_DATE"].ToString());*/

                /** if (columns.Contains("FUND_Filter_List"))
                 {
                     Sel_Funding_List.Clear();
                     if (dr["FUND_Filter_List"].ToString().Trim() == "**")
                         Rb_Fund_All.Checked = true;
                     else
                     {
                         GetParam_Fund_Filter_List(dr["FUND_Filter_List"].ToString());
                         this.Rb_Fund_Sel.Click -= new System.EventHandler(this.Rb_Fund_Sel_CheckedChanged);
                         Rb_Fund_Sel.Checked = true;
                         this.Rb_Fund_Sel.Click += new System.EventHandler(this.Rb_Fund_Sel_CheckedChanged);
                     }

                 }*/

                /** if (columns.Contains("REPORTFOR"))
                 {
                     rdoperiod.Checked = true;
                     //if (dr["REPORTCONTROL"].ToString() == "R")
                     //    rdoperiod.Checked = true;
                     if (dr["REPORTFOR"].ToString() == "C")
                         rdoperiodCumulative.Checked = true;
                     if (dr["REPORTFOR"].ToString() == "B")
                         rdoperiodBoth.Checked = true;
                     reportforselection();

                 }*/

                if (dr["DATE_SELECTION"].ToString() == "CADATE")
                    Rb_MS_Date.Checked = true;
                else
                    Rb_MS_AddDate.Checked = true;

                //if ((dr["ATTRIBUTES"].ToString() == "SYSTEM" && Scr_Oper_Mode == "RNGB0004") ||
                //    (dr["ATTRIBUTES"].ToString() == "All" && Scr_Oper_Mode == "RNGB0014"))
                //    Rb_Agy_Def.Checked = true;
                //else
                //    Rb_User_Def.Checked = true;

                if (dr["STAT_DETAILS"].ToString() == "Y")
                    Rb_Details_Yes.Checked = true;
                else
                    Rb_Details_No.Checked = true;

                Txt_Pov_Low.Text = dr["POVERTY_LOW"].ToString();
                Txt_Pov_High.Text = dr["POVERTY_HIGH"].ToString();


                if ((dr["COUNTY"].ToString() == "**" && Scr_Oper_Mode == "RNGB0004") || (dr["COUNTY"].ToString() == "**" && Scr_Oper_Mode == "RNGB0005") ||
                    (dr["COUNTY"].ToString() == "**" && Scr_Oper_Mode == "RNGB0014"))
                    Rb_County_All.Checked = true;
                else
                {
                    Rb_County_Sel.Checked = true;
                    Fill_County_Selected_List(dr["COUNTY"].ToString().Trim());
                }

                if ((dr["RESULTS"].ToString() == "A" && Scr_Oper_Mode == "RNGB0005"))
                    rdbOCC_All.Checked = true;
                else
                {
                    rdbOCC_Sel.Checked = true;
                    Fill_Results_Selected_List(dr["RESULTS"].ToString().Trim());
                }


                //if ((dr["COUNTY"].ToString() == "PM" && Scr_Oper_Mode == "RNGB0014"))
                //    Rb_OBO_Mem.Checked = true;
                //else if ((dr["COUNTY"].ToString() == "Both" && Scr_Oper_Mode == "RNGB0014"))
                //{
                //    Rb_SNP_Mem.Checked = true;
                //}
                //else if ((dr["COUNTY"].ToString() == "Prog" && Scr_Oper_Mode == "RNGB0014"))
                //{
                //    rbo_ProgramWise.Checked = true;
                //}


                /** if (dr["DG_COUNT"].ToString() == "PM")
                     Rb_OBO_Mem.Checked = true;
                 else if (dr["DG_COUNT"].ToString() == "Prog")
                     rbo_ProgramWise.Checked = true;
                 else
                     Rb_SNP_Mem.Checked = true;*/


                switch (dr["SECRET_APP"].ToString())
                {
                    case "Y": Rb_Mst_Sec.Checked = true; break;
                    case "N": Rb_Mst_NonSec.Checked = true; break;
                    default: Rb_Mst_BothSec.Checked = true; break;
                }


                //Fill_Program_Combo();
                //SetComboBoxValue(Cmb_Program, dr["ACTY_PROGRAM"].ToString().Trim() == "******" ? "**" : dr["ACTY_PROGRAM"].ToString());

                /**if (dr["ACTY_PROGRAM"].ToString() != "A")
                {

                    rbAllPrograms.Checked = true;
                    //Btn_MS_Selection.Visible = false;
                    GetSelectedHierarchies(dr["ACTY_PROGRAM"].ToString());
                    if (SelectedHierarchies.Count > 0)
                    {
                        rbSelProgram.Checked = true;
                        //All_CAMS_Selected = false;
                        //Btn_CA_Selection.Text = "Sel";
                    }
                }*/

                SetComboBoxValue(cmbRngCode, dr["RNG_MAIN_CODE"].ToString().Trim());

                /**Ref_From_Date.Value = Convert.ToDateTime(dr["REFERENCE_FROM_DATE"].ToString());
                Ref_To_Date.Value = Convert.ToDateTime(dr["REFERENCE_TO_DATE"].ToString());*/

                if (dr["ZIPCODE"].ToString() == "**")
                    Rb_SP_All.Checked = true;
                else
                {
                    Rb_SP_Sel.Checked = true;
                    if (Scr_Oper_Mode == "RNGB0005")
                        Selected_SPs(dr["ZIPCODE"].ToString());
                    //Prepare_Selected_Group(dr["ZIPCODE"].ToString());
                }

                if (columns.Contains("REP_TYPE"))
                {
                    if (dr["REP_TYPE"].ToString() == "Q")
                        rbQuaterly.Checked = true;
                    else if (dr["REP_TYPE"].ToString() == "M")
                        rbMonthly.Checked = true;
                }
                else
                    rbQuaterly.Checked = true;

                if (columns.Contains("AMOUNTS"))
                {
                    if (dr["AMOUNTS"].ToString() == "N")
                        rbAmtNo.Checked = true;
                    if (dr["AMOUNTS"].ToString() == "Y")
                        rbAmtYes.Checked = true;
                }
                else
                    rbAmtNo.Checked = true;

                if (columns.Contains("AGYWIDEREP"))
                {
                    if (dr["AGYWIDEREP"].ToString() == "N")
                        rbAWRNo.Checked = true;
                    if (dr["AGYWIDEREP"].ToString() == "Y")
                        rbAWRYes.Checked = true;
                }
                else
                    rbAWRNo.Checked = true;

                if (columns.Contains("REPPERIODCNTL"))
                {
                    if (dr["REPPERIODCNTL"].ToString() == "Y")
                        chkbReportPeriod.Checked = true;
                    else
                        chkbReportPeriod.Checked = false;
                }
                else
                    chkbReportPeriod.Checked = false;

                /** if (columns.Contains("OUTCOME_SWITCH"))
                 {
                     if (dr["OUTCOME_SWITCH"].ToString() == "S")
                         rdoOutcomesselect.Checked = true;
                     else
                         rdoOutcomesAll.Checked = true;
                 }*/


                /** if (columns.Contains("REPORTCONTROL"))
                 {
                     if (dr["REPORTCONTROL"].ToString() == "Y")
                         chkRepControl.Checked = true;
                     else
                         chkRepControl.Checked = false;
                 }*/

                Get_Selection_Criteria();
            }
        }

        private void Fill_County_Selected_List(string County_Str)
        {
            foreach (CommonEntity Ent in County_List)
            {
                if (County_Str.Contains("'" + Ent.Code + "'"))
                    ListcommonEntity.Add(new CommonEntity(Ent));
            }
        }



        private void SetComboBoxValue(ComboBox comboBox, string value)
        {
            if (string.IsNullOrEmpty(value) || value == " ")
                value = "0";
            if (comboBox != null && comboBox.Items.Count > 0)
            {
                foreach (Captain.Common.Utilities.ListItem li in comboBox.Items)
                {
                    if (li.Value.Equals(value) || li.Text.Equals(value))
                    { comboBox.SelectedItem = li; break; }
                }
            }
        }

        private void Txt_Pov_High_LostFocus(object sender, EventArgs e)
        {
            if (string.IsNullOrEmpty(Txt_Pov_High.Text.Trim()))
                Txt_Pov_High.Text = "000";
        }

        private void Txt_Pov_Low_LostFocus(object sender, EventArgs e)
        {
            if (string.IsNullOrEmpty(Txt_Pov_Low.Text.Trim()))
                Txt_Pov_Low.Text = "000";
        }



        string Scr_Oper_Mode = "RNGB0005";


        private void Initialize_All_Controls()
        {


            Scr_Oper_Mode = "RNGB0014";
            //20160303

            this.Text = "RNGB0014 - Performance Measures";

            lblDateSelection.Text = "Process Report By";
            //lblAttributes.Text = "Categories";
            //Rb_Agy_Def.Text = "All";
            //Rb_User_Def.Text = "Only Goal Associated";

            lblProduceStatistical.Text = "Produce Details";

            Rb_Details_No.Text = "No";
            Rb_Details_Yes.Text = "Yes";

            lblServiceplan.Text = "Group";
            Rb_SP_All.Text = "All Groups";
            Rb_SP_Sel.Text = "Selected Groups";

            //lblCounty.Text = "Report Format";
            //Rb_County_All.Text = "Performance Measures Only";
            //Rb_County_Sel.Text = "Performance Measures + Goal Details";

            Rb_MS_Date.Text = "Outcome Date";//"Milestone Date";
            Rb_MS_AddDate.Text = "Outcome Add Date";//"Milestone Add Date";

            /**  lblDemographicsCount.Text = "Report Format";
              Rb_OBO_Mem.Text = "Performance Measures Only";
              Rb_SNP_Mem.Text = "Performance Measures + Goal Details";
              rbo_ProgramWise.Text = "Program Level Counts";
              Rb_SNP_Mem.Location = new System.Drawing.Point(154, 2);*/


            /**Lbl_Program.Visible = true; //Cmb_Program.Visible = true;
            Lbl_Program.Location = new System.Drawing.Point(5, 36);*/
            //Cmb_Program.Location = new System.Drawing.Point(143, 36);
            //this.Cmb_Program.Size = new System.Drawing.Size(249, 21);

            this.Date_Panel.Location = new System.Drawing.Point(0, -1);
            this.Service_Panel.Size = new System.Drawing.Size(450, 21);

            //this.panel8.Location = new System.Drawing.Point(0, 48);


            this.pnlfewrdb.Location = new System.Drawing.Point(0, 48);
            //this.panel8.Size = new System.Drawing.Size(607, 224); //20160303
            this.pnlfewrdb.Size = new System.Drawing.Size(607, 247);

            //this.panel4.Location = new System.Drawing.Point(-1, 33);
            //**this.pnlMultiRdb.Location = new System.Drawing.Point(-1, 55);

            //**Rb_SNP_Mem.Size = new System.Drawing.Size(230, 21);

            //**this.pnlMultiRdb.Size = new System.Drawing.Size(607, 296);
            //this.panel3.Location = new System.Drawing.Point(4, 385); //20160303
            //this.panel2.Size = new System.Drawing.Size(607, 352); //20160303

            //this.Size = new System.Drawing.Size(613, 395);

            //this.Size = new System.Drawing.Size(615, 422);
            //Fill_Program_Combo();


            Cmb_CaseType.SelectedIndex = 0;
            Rb_MS_Date.Checked = Rb_Stat_Both.Checked //**= Rb_Site_All.Checked = rdoMssiteall.Checked
            = Rb_Details_No.Checked = Rb_SP_All.Checked = Rb_County_All.Checked =
            Rb_Mst_NonSec.Checked = true;

            All_CAMS_Selected = true;
            Sel_MS_List.Clear();
            Sel_CA_List.Clear();

            switch (Scr_Oper_Mode)
            {
                case "RNGB0004":
                    //Rb_User_Def.Checked = true;//** Rb_OBO_Mem.Checked = true;
                    /** Ref_From_Date.Value = new DateTime(DateTime.Now.Year, 1, 1);// Convert.ToDateTime("01/01/" + DateTime.Now.Year);
                     Ref_To_Date.Value = new DateTime(DateTime.Now.Year, 12, 31);// Convert.ToDateTime("12/31/" + DateTime.Now.Year);*/
                    break;
                case "RNGB0014":
                    //Rb_Agy_Def.Checked = true; //**rbAllPrograms.Checked = true; //Fill_Program_Combo();
                    //**HierarchyGrid.Rows.Clear(); 
                    //**SelectedHierarchies.Clear();
                    /** if (Sys_DateRange_List.Count > 0)
                     {
                         Ref_From_Date.Value = Convert.ToDateTime(Sys_DateRange_List[0].REF_FDATE);// Convert.ToDateTime("01/01/" + DateTime.Now.Year);
                         Ref_To_Date.Value = Convert.ToDateTime(Sys_DateRange_List[0].REF_TDATE);// Convert.ToDateTime("12/31/" + DateTime.Now.Year);
                     }
                     else
                     {
                         Ref_From_Date.Value = new DateTime(DateTime.Now.Year, 1, 1);// Convert.ToDateTime("01/01/" + DateTime.Now.Year);
                         Ref_To_Date.Value = new DateTime(DateTime.Now.Year, 12, 31);// Convert.ToDateTime("12/31/" + DateTime.Now.Year);
                     }*/
                    break;
            }

            /** Rep_From_Date.Value = new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1);
             Rep_To_Date.Value = new DateTime(DateTime.Today.Year, DateTime.Today.Month, DateTime.DaysInMonth(DateTime.Today.Month, DateTime.Today.Month));

             Ref_From_Date.Checked = Ref_To_Date.Checked = Rep_From_Date.Checked = Rep_To_Date.Checked = true;*/

            Txt_Pov_Low.Text = "0"; Txt_Pov_High.Text = "999";


            ListcaseSiteEntity.Clear();
            ListcaseMsSiteEntity.Clear();
            ListcommonEntity.Clear();
            ListZipCode.Clear();
            ListRngGroupCode.Clear();
            Clear_Error_Providers();
        }

        private void Clear_Error_Providers()
        {
            //**_errorProvider.SetError(Ref_To_Date, null);
            _errorProvider.SetError(Rb_SP_Sel, null);
            _errorProvider.SetError(Rb_County_Sel, null);
            //**_errorProvider.SetError(Txt_Sel_Site, null);
            //**_errorProvider.SetError(txt_Msselect_site, null);
            _errorProvider.SetError(Txt_Pov_Low, null);
            _errorProvider.SetError(Txt_Pov_High, null);
        }


        private void Rb_Zip_All_CheckedChanged(object sender, EventArgs e)
        {
            switch (Scr_Oper_Mode)
            {
                case "RNGB0004": ListZipCode.Clear(); break;
                case "RNGB0014": ListRngGroupCode.Clear(); break;
                case "RNGB0005": ListServicePlans.Clear(); break;
            }
        }

        private void Rb_County_All_CheckedChanged(object sender, EventArgs e)
        {
            ListcommonEntity.Clear();
        }



        bool All_CAMS_Selected = true;
        List<MSMASTEntity> Sel_MS_List = new List<MSMASTEntity>();
        List<CAMASTEntity> Sel_CA_List = new List<CAMASTEntity>();


        private void Rb_Site_Sel_CheckedChanged(object sender, EventArgs e)
        {

        }


        List<MSMASTEntity> MS_Mast_List = new List<MSMASTEntity>();

        //DataTable dt = new DataTable();

        DataTable dtAudit = new DataTable();
        DataTable dtdistinct = new DataTable();
        private void btnGenerateFile_Click(object sender, EventArgs e)
        {
            if (Validate_Report())
            {
                Get_Selection_Criteria();

                Search_Entity.Rep_Period_FDate = Convert.ToDateTime(((ListItem)cmbRngCode.SelectedItem).ScreenCode.ToString()).ToString("MM/dd/yyyy");
                Search_Entity.Rep_Period_TDate = Convert.ToDateTime(dtAnnualTodate.Value).ToString("MM/dd/yyyy");// Convert.ToDateTime(((ListItem)cmbRngCode.SelectedItem).ScreenType.ToString()).ToString("MM/dd/yyyy");
                string ReportType = "Q";
                if (rbQuaterly.Checked) ReportType = "Q"; else ReportType = "M";

                string RepPeriodCntl = "N";
                if (chkbReportPeriod.Checked)
                    RepPeriodCntl = "Y";

                DataSet ds = new DataSet();

                ds = _model.AdhocData.Get_RNGB0005_Counts(Search_Entity, Rb_Details_Yes.Checked ? "Y" : "Y", ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString(),
                    ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).ID.ToString(), string.Empty, string.Empty, string.Empty, string.Empty, string.Empty, ReportType, RepPeriodCntl);
                if (ds.Tables.Count > 0)
                {
                    dt = ds.Tables[0];
                    if (Rb_Details_Yes.Checked)
                    {
                        dtAudit = ds.Tables[1];
                        //dtdistinct = ds.Tables[2];
                    }
                    else
                        dtAudit.Clear();

                    if (dt.Rows.Count > 0)
                    {
                        PdfListForm pdfListForm = new PdfListForm(BaseForm, PrivilegeEntity, false, propReportPath, "XLSX");
                        pdfListForm.FormClosed += new FormClosedEventHandler(On_SaveExcelForm_Closed_KV_Formatted);
                        pdfListForm.StartPosition = FormStartPosition.CenterScreen;
                        pdfListForm.ShowDialog();
                    }
                    else
                        MessageBox.Show("No data for given parameters", "CAPTAIN");

                }
            }
        }

        List<CAMASTEntity> CA_Mast_List = new List<CAMASTEntity>();
        private void Fill_CAMS_Master_List()
        {
            MS_Mast_List = _model.SPAdminData.Browse_MSMAST("Code", null, null, null, null);
            CA_Mast_List = _model.SPAdminData.Browse_CAMAST("Code", null, null, null);
        }

        /** private void rdoMssiteall_Click(object sender, EventArgs e)
         {
             txt_Msselect_site.Clear();
             ListcaseMsSiteEntity.Clear();
         }*/

        private void rdoMsselectsite_CheckedChanged(object sender, EventArgs e)
        {

        }

        /**private void rdoMsselectsite_Click(object sender, EventArgs e)
        {
            if (rdoMsselectsite.Checked == true)
            {
                SelectZipSiteCountyForm siteform = new SelectZipSiteCountyForm(BaseForm, ListcaseMsSiteEntity, strAgency, strDept, strProg, string.Empty);
                siteform.FormClosed += new FormClosedEventHandler(SelectZipSiteCountyMSFormClosed);
                siteform.StartPosition = FormStartPosition.CenterScreen;
                siteform.ShowDialog();
            }
        }*/

        /**private void rdomsNosite_CheckedChanged(object sender, EventArgs e)
        {
            txt_Msselect_site.Clear();
            ListcaseMsSiteEntity.Clear();
        }*/

        /**private void Btn_MS_Selection_Click(object sender, EventArgs e)
        //{
        //    CASE0010_HSS_Form MS_Selection_Form = new CASE0010_HSS_Form(PrivilegeEntity.Program, "MS", All_CAMS_Selected, Sel_MS_List, Sel_CA_List);
        //    MS_Selection_Form.FormClosed += new FormClosedEventHandler(Get_Sel_MS_List);
        //    MS_Selection_Form.StartPosition = FormStartPosition.CenterScreen;
        //    MS_Selection_Form.ShowDialog();
        //}*/

        /**private void Rb_Fund_Sel_CheckedChanged(object sender, EventArgs e)
        {
            if (Rb_Fund_Sel.Checked == true)
            {
                SelectZipSiteCountyForm siteform = new SelectZipSiteCountyForm(BaseForm, Sel_Funding_List, "Reports", strAgency, strDept, strProg, null);
                siteform.FormClosed += new FormClosedEventHandler(SelectZipSiteCountyFormClosed);
                siteform.StartPosition = FormStartPosition.CenterScreen;
                siteform.ShowDialog();
            }
        }*/

        private void Get_Sel_MS_List(object sender, FormClosedEventArgs e)
        {
            CASE0010_HSS_Form form = sender as CASE0010_HSS_Form;
            if (form.DialogResult == DialogResult.OK)
            {
                List<MSMASTEntity> MS_List = new List<MSMASTEntity>();
                MS_List = form.Get_Sel_MS_List();
                Sel_MS_List.Clear();
                All_CAMS_Selected = true;
                if (MS_List.Count > 0)
                {
                    All_CAMS_Selected = false;
                    Sel_MS_List = MS_List;
                }
            }
        }

        private void RNGB0005Form_ToolClick(object sender, ToolClickEventArgs e)
        {
            Application.Navigate(CommonFunctions.CreateZenHelps(PrivilegeEntity.Program, 0, BaseForm.BusinessModuleID.ToString(), "", ""), target: "_blank");
        }

        /**private void rbSelProgram_Click(object sender, EventArgs e)
        {
            if (rbSelProgram.Checked == true)
            {
                HierarchieSelectionFormNew hierarchieSelectionForm = new HierarchieSelectionFormNew(BaseForm, SelectedHierarchies, "Service", "I", "A", "R", PrivilegeEntity, Current_Hierarchy.Substring(0, 2), Current_Hierarchy.Substring(2, 2));
                hierarchieSelectionForm.FormClosed += new FormClosedEventHandler(OnProgramClosed);
                hierarchieSelectionForm.StartPosition = FormStartPosition.CenterScreen;
                hierarchieSelectionForm.ShowDialog();

                //HierarchieSelection hierarchieSelectionForm = new HierarchieSelection(BaseForm, SelectedHierarchies, "Service", "I", "A", "R", PrivilegeEntity, Current_Hierarchy.Substring(0, 2), Current_Hierarchy.Substring(2, 2));
                //hierarchieSelectionForm.FormClosed += new FormClosedEventHandler(OnProgramClosed);
                //hierarchieSelectionForm.ShowDialog();
            }
        }*/

        /* private void OnProgramClosed(object sender, FormClosedEventArgs e)
         {
             // HierarchieSelectionForm form = sender as HierarchieSelectionForm;
             HierarchieSelectionFormNew form = sender as HierarchieSelectionFormNew;

             if (form.DialogResult == DialogResult.OK)
             {

                 List<HierarchyEntity> selectedHierarchies = form.SelectedHierarchies;

                 Fill_Programs_Grid(selectedHierarchies);


             }
         }*/

        /** private void Fill_Programs_Grid(List<HierarchyEntity> selectedHierarchies)
         {
             string hierarchy = string.Empty;
             int Rows_Cnt = 0;
             // HierarchyGrid.Rows.Clear();
             HierarchyGrid.Rows.Clear();
             if (selectedHierarchies.Count > 0)
             {
                 HierarchyGrid.Rows.Clear();
                 string Agy = "**", Dept = "**", Prog = "**";
                 foreach (HierarchyEntity row in selectedHierarchies)
                 {
                     Agy = Dept = Prog = "**";
                     if (!string.IsNullOrEmpty(row.Agency.Trim()))
                         Agy = row.Agency.Trim();

                     if (!string.IsNullOrEmpty(row.Prog.Trim()))
                         Prog = row.Prog.Trim();

                     if (!string.IsNullOrEmpty(row.Dept.Trim()))
                         Dept = row.Dept.Trim();

                     int rowIndex = HierarchyGrid.Rows.Add(row.Code + "  " + row.HirarchyName.ToString(), Agy + Dept + Prog);
                     HierarchyGrid.Rows[rowIndex].Tag = row;
                     Rows_Cnt++;

                     //hierarchy += row.Agency + row.Dept + row.Prog;
                     hierarchy += row.Code.Substring(0, 2) + row.Code.Substring(3, 2) + row.Code.Substring(6, 2) + ", ";
                 }

                 //if (Rows_Cnt > 0)
                 //    Txt_Program.Text = hierarchy.Substring(0, hierarchy.Length - 2);
             }
         }*/

        //Added by Sudheer on 07/22/2022
        /** private void GetSelectedHierarchies(string Sel_List)
         {
             List<HierarchyEntity> caseHierarchy = _model.lookupDataAccess.GetHierarchyByUserID(BaseForm.UserProfile.UserID, "I", "Reports");
             List<HierarchyEntity> ListofSelHiers = new List<HierarchyEntity>();
             if (caseHierarchy.Count > 0)
             {
                 //caseHierarchy= caseHierarchy.FindAll(u=>u.Agency)

                 if (!string.IsNullOrEmpty(Sel_List.Trim()))
                 {
                     Sel_List = Sel_List + ",";

                     HierarchyGrid.Rows.Clear();
                     foreach (HierarchyEntity Entity in caseHierarchy)
                     {
                         if (!Entity.Code.Contains('*'))
                         {
                             if (Sel_List.Contains(Entity.Agency + Entity.Dept + Entity.Prog.Trim()))
                             {
                                 int rowIndex = HierarchyGrid.Rows.Add(Entity.Code + "  " + Entity.HirarchyName.ToString(), Entity.Agency + Entity.Dept + Entity.Prog);
                                 HierarchyGrid.Rows[rowIndex].Tag = Entity;

                             }
                         }
                     }
                 }
             }
         }*/

        /**private void rbAllPrograms_Click(object sender, EventArgs e)
        {
            if (rbAllPrograms.Checked == true)
            {
                HierarchyGrid.Rows.Clear();
                SelectedHierarchies.Clear();
            }
        }*/

        private void Get_Sel_CA_List(object sender, FormClosedEventArgs e)
        {
            CASE0010_HSS_Form form = sender as CASE0010_HSS_Form;
            if (form.DialogResult == DialogResult.OK)
            {
                List<CAMASTEntity> CA_List = new List<CAMASTEntity>();
                CA_List = form.Get_Sel_CA_List();
                Sel_CA_List.Clear();
                All_CAMS_Selected = true;
                if (CA_List.Count > 0)
                {
                    All_CAMS_Selected = false;
                    Sel_CA_List = CA_List;
                }
            }
        }


        //private void Btn_CA_Selection_Click(object sender, EventArgs e)
        //{
        //    CASE0010_HSS_Form CA_Selection_Form = new CASE0010_HSS_Form(PrivilegeEntity.Program, "CA", All_CAMS_Selected, Sel_MS_List, Sel_CA_List);
        //    CA_Selection_Form.FormClosed += new FormClosedEventHandler(Get_Sel_CA_List);
        //    CA_Selection_Form.StartPosition = FormStartPosition.CenterScreen;
        //    CA_Selection_Form.ShowDialog();
        //}

        RCsb14GroupEntity rngcodedata;
        private void cmbRngCode_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (cmbRngCode.Items.Count > 0)
            {
                if (((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString() != "**")
                {

                    rngcodedata = RngCodelist.Find(u => u.GrpCode.Trim() == string.Empty && u.TblCode.Trim() == string.Empty && u.Code.Trim() == ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Value.ToString() && u.Agency == ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).ID.ToString());
                    if (rngcodedata != null)
                    {
                        ListRngGroupCode.Clear();
                        /**if (rngcodedata.OFdate != string.Empty)
                        {
                            Ref_From_Date.Value = Convert.ToDateTime(rngcodedata.OFdate);
                            Ref_From_Date.Checked = true;
                        }
                        if (rngcodedata.OTdate != string.Empty)
                        {
                            Ref_To_Date.Checked = true;
                            Ref_To_Date.Value = Convert.ToDateTime(rngcodedata.OTdate);
                        }*/

                        lblAnnualFDte.Text = Convert.ToDateTime(rngcodedata.OFdate).ToString("MM/dd/yyyy");   //Added by Vikash 03/20/2023
                        lblAnnualTDte.Text = Convert.ToDateTime(rngcodedata.OTdate).ToString("MM/dd/yyyy");
                        dtAnnualTodate.Value = Convert.ToDateTime(rngcodedata.OTdate);

                        //dtpQ1S.Value = Convert.ToDateTime(rngcodedata.OFdate);
                        //dtpQ1E.Value = new DateTime(Convert.ToDateTime(rngcodedata.OFdate).Year, Convert.ToDateTime(rngcodedata.OFdate).Month + 2, DateTime.DaysInMonth(Convert.ToDateTime(rngcodedata.OFdate).Month + 2, Convert.ToDateTime(rngcodedata.OFdate).Month + 2));
                        ////Convert.ToDateTime(rngcodedata.OFdate);

                        ////DateTime ct = Convert.ToDateTime(rngcodedata.OFdate);
                        ////string Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                        ////ct = ct.AddMonths(1);
                        ////string Mval2 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                        ////ct = ct.AddMonths(1);
                        ////Mval2 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                        ////ct = ct.AddMonths(1);
                        ////Mval2 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                        ////ct = ct.AddMonths(1);
                        ////Mval2 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();

                        ////new DateTime(DateTime.Today.Year, DateTime.Today.Month, DateTime.DaysInMonth(DateTime.Today.Month, DateTime.Today.Month));

                        //int YearValue = Convert.ToDateTime(rngcodedata.OFdate).Year;
                        //int MonthValue = Convert.ToDateTime(rngcodedata.OFdate).Month + 3;
                        //if (MonthValue > 12) { MonthValue = MonthValue - 12; YearValue = YearValue + 1; }

                        //dtpQ2S.Value = new DateTime(YearValue, MonthValue, 1);//Convert.ToDateTime(rngcodedata.OFdate);
                        //dtpQ2E.Value = new DateTime(Convert.ToDateTime(dtpQ2S.Value).Year, Convert.ToDateTime(dtpQ2S.Value).Month + 2, DateTime.DaysInMonth(Convert.ToDateTime(dtpQ2S.Value).Month + 2, Convert.ToDateTime(dtpQ2S.Value).Month + 2));

                        //MonthValue = Convert.ToDateTime(rngcodedata.OFdate).Month + 6;
                        //if (MonthValue > 12) MonthValue = MonthValue - 12;

                        //dtpQ3S.Value = new DateTime(YearValue, MonthValue, 1);
                        //dtpQ3E.Value = new DateTime(Convert.ToDateTime(dtpQ3S.Value).Year, Convert.ToDateTime(dtpQ3S.Value).Month + 2, DateTime.DaysInMonth(Convert.ToDateTime(dtpQ3S.Value).Month + 2, Convert.ToDateTime(dtpQ3S.Value).Month + 2));

                        //MonthValue = Convert.ToDateTime(rngcodedata.OFdate).Month + 9;
                        //if (MonthValue > 12) MonthValue = MonthValue - 12;
                        //dtpQ4S.Value = new DateTime(YearValue, MonthValue, 1);
                        //dtpQ4E.Value = new DateTime(Convert.ToDateTime(dtpQ4S.Value).Year, Convert.ToDateTime(dtpQ4S.Value).Month + 2, DateTime.DaysInMonth(Convert.ToDateTime(dtpQ4S.Value).Month + 2, Convert.ToDateTime(dtpQ4S.Value).Month + 2));
                    }
                    lblAnnualFDte.Visible = lblTo.Visible = dtAnnualTodate.Visible = lblannualfrmlable.Visible = true;   //lblAnnualTDte.Visible = false;
                }
                else
                {
                    lblAnnualFDte.Visible = lblTo.Visible = dtAnnualTodate.Visible = lblannualfrmlable.Visible = false; //lblAnnualTDte.Visible = false;

                    dtpQ1S.Value = Convert.ToDateTime(DateTime.Now);
                    dtpQ1E.Value = Convert.ToDateTime(DateTime.Now);
                    //Convert.ToDateTime(rngcodedata.OFdate);

                    //new DateTime(DateTime.Today.Year, DateTime.Today.Month, DateTime.DaysInMonth(DateTime.Today.Month, DateTime.Today.Month));

                    dtpQ2S.Value = Convert.ToDateTime(DateTime.Now); //Convert.ToDateTime(rngcodedata.OFdate);
                    dtpQ2E.Value = Convert.ToDateTime(DateTime.Now);

                    dtpQ3S.Value = Convert.ToDateTime(DateTime.Now);
                    dtpQ3E.Value = Convert.ToDateTime(DateTime.Now);

                    dtpQ4S.Value = Convert.ToDateTime(DateTime.Now);
                    dtpQ4E.Value = Convert.ToDateTime(DateTime.Now);


                }
            }
        }


        public string HeadersValue(int intcolumnscount)
        {
            string strValue = string.Empty;
            switch (intcolumnscount)
            {
                case 4:
                    strValue = "IV.) ";
                    break;
                case 5:
                    strValue = "V.) ";
                    break;
                case 6:
                    strValue = "VI.) ";
                    break;
                case 7:
                    strValue = "VII.) ";
                    break;
                case 8:
                    strValue = "VIII.) ";
                    break;
                case 9:
                    strValue = "IX.) ";
                    break;
                case 10:
                    strValue = "X.) ";
                    break;
                default:
                    break;
            }
            return strValue;
        }
        public string HeadersValue1(int intcolumnscount)
        {
            string strValue = string.Empty;
            switch (intcolumnscount)
            {
                case 4:
                    strValue = "IV";
                    break;
                case 5:
                    strValue = "V";
                    break;
                case 6:
                    strValue = "VI";
                    break;
                case 7:
                    strValue = "VII";
                    break;
                case 8:
                    strValue = "VIII";
                    break;
                case 9:
                    strValue = "IX";
                    break;
                case 10:
                    strValue = "X";
                    break;
                default:
                    break;
            }
            return strValue;
        }

        /**  private void rdoperiodBoth_Click(object sender, EventArgs e)
          {
              reportforselection();

              //if (rdoperiod.Checked)
              //{
              //    Rb_SNP_Mem.Enabled = true;
              //}
              //else
              //{
              //    Rb_SNP_Mem.Enabled = false;
              //    Rb_SNP_Mem.Checked = false;
              //    Rb_OBO_Mem.Checked = true;
              //}

          }*/

        /** private void reportforselection()
         {
             /**if (rdoperiodBoth.Checked)
             {
                 // Rb_SNP_Mem.Enabled = false;
                 Rb_SNP_Mem.Checked = false;
                 Rb_OBO_Mem.Checked = true;
             }
             else
             {
                 Rb_SNP_Mem.Enabled = true;
             }

             if (rdoperiod.Checked == true)
             {
                /** Ref_From_Date.Enabled = false;
                 Ref_To_Date.Enabled = false;
                 Rep_From_Date.Enabled = true;
                 Rep_To_Date.Enabled = true;

                 chkbUndupTable.Enabled = true;
             }
             else if (rdoperiodCumulative.Checked == true)
             {
                /* Ref_From_Date.Enabled = true;
                 Ref_To_Date.Enabled = true;
                 Rep_From_Date.Enabled = false;
                 Rep_To_Date.Enabled = false;

                 chkbUndupTable.Enabled = true;
             }
             else if (rdoperiodBoth.Checked == true)
             {
                 /**Ref_From_Date.Enabled = true;
                 Ref_To_Date.Enabled = true;
                 Rep_From_Date.Enabled = true;
                 Rep_To_Date.Enabled = true;

                 chkbUndupTable.Enabled = false;
                 chkbUndupTable.Checked = false;
             }

         }*/

        private void btnMergeExcelView_Click(object sender, EventArgs e)
        {
            PdfListForm pdfMergeListForm = new PdfListForm(BaseForm);
            pdfMergeListForm.StartPosition = FormStartPosition.CenterScreen;
            pdfMergeListForm.ShowDialog();
        }

        string Q1Sdate = ""; string Q1Edate = "";
        string Q2Sdate = ""; string Q2Edate = "";
        string Q3Sdate = ""; string Q3Edate = "";
        string Q4Sdate = ""; string Q4Edate = "";
        private void dtAnnualTodate_ValueChanged(object sender, EventArgs e)
        {
            string frmDate = lblAnnualFDte.Text;
            string toDate = lblAnnualTDte.Text;
            string _currDate = dtAnnualTodate.Value.ToString(); //kranthi 05/03/2024 //lblAnnualTDte.Text;//

            if (Convert.ToDateTime(_currDate).Date <= Convert.ToDateTime(toDate).Date && Convert.ToDateTime(_currDate).Date >= Convert.ToDateTime(frmDate).Date)
            {
                _errorProvider.SetError(dtAnnualTodate, null);

                Q1Sdate = ""; Q1Edate = "";
                Q2Sdate = ""; Q2Edate = "";
                Q3Sdate = ""; Q3Edate = "";
                Q4Sdate = ""; Q4Edate = "";

                string _OTodate = Convert.ToDateTime(dtAnnualTodate.Value).ToString("MM/dd/yyyy"); //kranthi 05/03/2024 lblAnnualTDte.Text;//

                /*************************************** Q1 ************************************************/
                Q1Sdate = Convert.ToDateTime(lblAnnualFDte.Text).ToString("MM/dd/yyyy");
                DateTime QTodate = new DateTime(Convert.ToDateTime(Q1Sdate).Year, Convert.ToDateTime(Q1Sdate).Month + 2,
                    DateTime.DaysInMonth(Convert.ToDateTime(Q1Sdate).Year, Convert.ToDateTime(Q1Sdate).Month + 2));
                if (Convert.ToDateTime(Q1Sdate) > Convert.ToDateTime(_currDate))
                {
                    Q1Sdate = ""; Q1Edate = ""; return;
                }
                else
                {
                    if (QTodate > Convert.ToDateTime(_currDate))
                    {
                        Q1Edate = Convert.ToDateTime(_currDate).ToString("MM/dd/yyyy");
                        return;
                    }
                    else
                        Q1Edate = QTodate.ToString("MM/dd/yyyy");
                }
                /*************************************** **** ************************************************/

                /*************************************** Q2 ************************************************/

                int YearValue = Convert.ToDateTime(lblAnnualFDte.Text).Year;
                int MonthValue = Convert.ToDateTime(lblAnnualFDte.Text).Month + 3;
                if (MonthValue > 12) { MonthValue = MonthValue - 12; YearValue = YearValue + 1; }

                Q2Sdate = new DateTime(YearValue, MonthValue, 1).ToString("MM/dd/yyyy");//Convert.ToDateTime(rngcodedata.OFdate);
                DateTime QTodate2 = new DateTime(Convert.ToDateTime(Q2Sdate).Year, Convert.ToDateTime(Q2Sdate).Month + 2,
                    DateTime.DaysInMonth(Convert.ToDateTime(Q2Sdate).Year, Convert.ToDateTime(Q2Sdate).Month + 2));
                if (Convert.ToDateTime(Q2Sdate) > Convert.ToDateTime(_currDate))
                {
                    Q2Sdate = ""; Q2Edate = ""; return;
                }
                else
                {

                    if (QTodate2 > Convert.ToDateTime(_currDate))
                    {
                        Q2Edate = Convert.ToDateTime(_currDate).ToString("MM/dd/yyyy");
                        return;
                    }
                    else
                        Q2Edate = QTodate2.ToString("MM/dd/yyyy");
                }

                /*************************************** **** ************************************************/

                /*************************************** Q3 ************************************************/

                MonthValue = Convert.ToDateTime(lblAnnualFDte.Text).Month + 6;
                if (MonthValue > 12) MonthValue = MonthValue - 12;

                Q3Sdate = new DateTime(YearValue, MonthValue, 1).ToString("MM/dd/yyyy");
                if (Convert.ToDateTime(Q3Sdate) > Convert.ToDateTime(_currDate))
                {
                    Q3Sdate = ""; Q3Edate = ""; return;
                }
                else
                {

                    DateTime QTodate3 = new DateTime(Convert.ToDateTime(Q3Sdate).Year, Convert.ToDateTime(Q3Sdate).Month + 2,
                        DateTime.DaysInMonth(Convert.ToDateTime(Q3Sdate).Year, Convert.ToDateTime(Q3Sdate).Month + 2));

                    if (QTodate3 > Convert.ToDateTime(_currDate))
                    {
                        Q3Edate = Convert.ToDateTime(_currDate).ToString("MM/dd/yyyy");
                        return;
                    }
                    else
                        Q3Edate = QTodate3.ToString("MM/dd/yyyy");
                }
                /*************************************** **** ************************************************/
                /*************************************** Q3 ************************************************/

                MonthValue = Convert.ToDateTime(lblAnnualFDte.Text).Month + 9;
                if (MonthValue > 12) MonthValue = MonthValue - 12;
                Q4Sdate = new DateTime(YearValue, MonthValue, 1).ToString("MM/dd/yyyy");
                DateTime QTodate4 = new DateTime(Convert.ToDateTime(Q4Sdate).Year, Convert.ToDateTime(Q4Sdate).Month + 2,
                    DateTime.DaysInMonth(Convert.ToDateTime(Q4Sdate).Year, Convert.ToDateTime(Q4Sdate).Month + 2));
                if (Convert.ToDateTime(Q4Sdate) > Convert.ToDateTime(_currDate))
                {
                    Q4Sdate = ""; Q4Edate = ""; return;
                }
                else
                {

                    if (QTodate4 > Convert.ToDateTime(_currDate))
                    {
                        Q4Edate = Convert.ToDateTime(_currDate).ToString("MM/dd/yyyy");
                        return;
                    }
                    else
                        Q4Edate = QTodate4.ToString("MM/dd/yyyy");
                }
                /*************************************** **** ************************************************/

            }
            else
            {
                _errorProvider.SetError(dtAnnualTodate, string.Format("Date should be between " + frmDate + " to " + toDate + "".Replace(Consts.Common.Colon, string.Empty)));
            }
        }

        /**private string Get_Sel_CA_Fund_List_To_Filter()
        {
            string Sel_Codes = null;

            if (Rb_Fund_Sel.Checked)
            {
                foreach (SPCommonEntity Entity in Sel_Funding_List)
                {
                    Sel_Codes += "'" + Entity.Code + "' ,";
                }

                if (Sel_Codes.Length > 0)
                    Sel_Codes = Sel_Codes.Substring(0, (Sel_Codes.Length - 1));
            }

            return Sel_Codes;
        }*/

        DevExpress.Spreadsheet.Style setCellStyle(string _chkSp0Active, string _chkSp2Active, DevExpress.Spreadsheet.Style _ActStyle, DevExpress.Spreadsheet.Style _inActStyle)
        {
            DevExpress.Spreadsheet.Style _cellStyle = null;

            if (_chkSp0Active != "Y")
                _cellStyle = _inActStyle;
            else
            {
                if (_chkSp2Active == "A")
                    _cellStyle = _ActStyle;
                else
                    _cellStyle = _inActStyle;
            }

            return _cellStyle;
        }

        private void On_SaveExcelForm_Closed_KV(object sender, FormClosedEventArgs e)
        {
            Random_Filename = null;
            PdfListForm form = sender as PdfListForm;
            if (form.DialogResult == DialogResult.OK)
            {
                #region FileNameBuild
                /*************************************************************/
                Random_Filename = null;
                string xlFileName = form.GetFileName();
                xlFileName = propReportPath + BaseForm.UserID + "\\" + xlFileName;
                try
                {
                    if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                    { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
                }
                catch (Exception ex)
                {
                    CommonFunctions.MessageBoxDisplay("Error");
                }

                try
                {
                    string Tmpstr = xlFileName + ".xlsx";
                    if (File.Exists(Tmpstr))
                        File.Delete(Tmpstr);
                }
                catch (Exception ex)
                {
                    int length = 8;
                    string newFileName = System.Guid.NewGuid().ToString();
                    newFileName = newFileName.Replace("-", string.Empty);

                    Random_Filename = xlFileName + newFileName.Substring(0, length) + ".xlsx";
                }

                if (!string.IsNullOrEmpty(Random_Filename))
                    xlFileName = Random_Filename;
                else
                    xlFileName += ".xlsx";

                /*************************************************************/
                #endregion

                string _excelPath = xlFileName;
                string _pdfPath = Application.MapPath("\\Excelfiles\\INDIVAgencyVistSPRpt" + DateTime.Now.ToString("MMddyyyyhhss") + ".pdf");

                #region excelGeneration
                using (DevExpress.Spreadsheet.Workbook workbook = new DevExpress.Spreadsheet.Workbook())
                {

                    bool First = true; string MS_Type = string.Empty;
                    string CAMSDesc = null; string Branch = null, Priv_Branch = null, SP_Plan_desc = null;
                    bool SPNum = true; Worksheet sheet; WorksheetCell cell; WorksheetRow Row0; int Count = 1;
                    #region Excel Cell Styles

                    /********************** SET EXCEL FONT PROPERTIES ******************************/
                    DevExpress_Excel_Properties oDevExpress_Excel_Properties = new DevExpress_Excel_Properties();
                    oDevExpress_Excel_Properties.sxlbook = workbook;
                    oDevExpress_Excel_Properties.sxlTitleFont = "Trebuchet MS";
                    oDevExpress_Excel_Properties.sxlbodyFont = "calibri";
                    /*******************************************************************************/
                    oDevExpress_Excel_Properties.getDevexpress_Excel_Properties();

                    #region Custom Styles
                    DevExpress.Spreadsheet.Style xTitleCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 20, "#002060", true, "#ffffff", "center", 1, 1, 1, 1, 1, "Thin", "#F8F9D0", "");
                    DevExpress.Spreadsheet.Style xTitleCellstyle2 = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 14, "#0070C0", true, "#EEF5FC", "center", 1, 1, 1, 1, 1, "Thin", "#FFFFFF", "");
                    DevExpress.Spreadsheet.Style xsubTitleintakeCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 10, "#0070C0", true, "#F8FBFE", "center", 1, 1, 1, 1, 1, "Thin", "#F8F9D0", "");
                    DevExpress.Spreadsheet.Style xPageTitleCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 16, "#002060", true, "#ffffff", "center", 1, 1, 1, 1, 1, "Thin", "#F8F9D0", "");
                    DevExpress.Spreadsheet.Style reportNameStyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 16, "#002060", true, "#CFE6F9", "center", 1, 1, 1, 1, 1, "Thin", "#FFFFFF", "");
                    DevExpress.Spreadsheet.Style paramsCellStyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", false, "#EEF5FC", "left", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "");

                    DevExpress.Spreadsheet.Style xAgyHeaderCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#FFFFFF", true, "#305496", "left", 1, 1, 1, 1, 1, "Thin", "#305496", "");
                    DevExpress.Spreadsheet.Style xAgyIntakeHeaderCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#FFFFFF", true, "#30963e", "left", 1, 1, 1, 1, 1, "Thin", "#30963e", "");
                    DevExpress.Spreadsheet.Style gxlBCC_sp_cr = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#d3e6f5", "center", 1, 1, 1, 1, 1, "Thin", "#d3e6f5", "");
                    DevExpress.Spreadsheet.Style gxlGCC_sp_cr = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#bee396", "center", 1, 1, 1, 1, 1, "Thin", "#bee396", "");


                    DevExpress.Spreadsheet.Style gxlLBC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 1, 0, 0, 0, "Thin", "#000000", "");
                    DevExpress.Spreadsheet.Style gxlTBC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 1, 0, 0, "Thin", "#000000", "");
                    DevExpress.Spreadsheet.Style gxlRBC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 0, 1, 0, "Thin", "#000000", "");
                    DevExpress.Spreadsheet.Style gxlBBC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 0, 0, 1, "Thin", "#000000", "");

                    DevExpress.Spreadsheet.Style gxlLTBCORN = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 1, 1, 0, 0, "Thin", "#000000", "");
                    DevExpress.Spreadsheet.Style gxlRTBCORN = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 1, 1, 0, "Thin", "#000000", "");
                    DevExpress.Spreadsheet.Style gxlLBBCORN = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 1, 0, 0, 1, "Thin", "#000000", "");
                    DevExpress.Spreadsheet.Style gxlRBBCORN = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 0, 1, 1, "Thin", "#000000", "");

                    DevExpress.Spreadsheet.Style gxlNLC_numeric = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 9, "#000000", false, "#FFFFFF", "left", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");
                    DevExpress.Spreadsheet.Style gxlNCC_numeric = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 9, "#000000", false, "#FFFFFF", "center", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");
                    DevExpress.Spreadsheet.Style gxlNRC_numeric = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 9, "#000000", false, "#FFFFFF", "right", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");

                    DevExpress.Spreadsheet.Style gxlErrBLC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#ebf7ff", "left", 1, 1, 1, 1, 1, "Thin", "#a6c9e8", "");
                    DevExpress.Spreadsheet.Style gxlErrNumb_NRC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "right", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");
                    DevExpress.Spreadsheet.Style gxlErrDeci_NRC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "right", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "D");
                    DevExpress.Spreadsheet.Style gxlGenerate_cr = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 11, "#0070C0", false, "#FFFFFF", "right", 0, 1, 1, 1, 1, "Thin", "#d3e6f5", "");
                    DevExpress.Spreadsheet.Style gxlGenerate_lr = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 10, "#0070C0", false, "#FFFFFF", "left", 0, 1, 1, 1, 1, "Thin", "#d3e6f5", "");

                    #endregion

                    #endregion
                    DevExpress.Spreadsheet.Worksheet ParamsSheet = workbook.Worksheets[0];
                    if (dt.Rows.Count > 0)
                    {
                        #region Parameters Sheet

                        ParamsSheet.Name = "Parameters";
                        ParamsSheet.ActiveView.ShowGridlines = false;

                        ParamsSheet.Columns[1].Width = 200;
                        ParamsSheet.Columns[2].Width = 300;
                        ParamsSheet.Columns[3].Width = 200;
                        ParamsSheet.Columns[4].Width = 500;
                        ParamsSheet.Columns[5].Width = 200;
                        ParamsSheet.Columns[6].Width = 200;
                        ParamsSheet.Columns[7].Width = 200;
                        ParamsSheet.Columns[8].Width = 200;
                        ParamsSheet.Columns[9].Width = 600;

                        string strAgy = Current_Hierarchy_DB.Split('-')[0];

                        AgencyControlEntity BAgyControlDetails = _model.ZipCodeAndAgency.GetAgencyControlFile(strAgy);

                        string ImgName = "";
                        if (BaseForm.BaseAgencyControlDetails.AgyShortName == "NEOCAA")
                        {
                            ImgName = "NEOCAA_" + strAgy + "_LOGO.png";
                        }
                        else
                            ImgName = BaseForm.BaseAgencyControlDetails.AgyShortName + "_00_LOGO.png";

                        int _Rowindex = 1; int _Columnindex = 1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = BAgyControlDetails.AgyName;// "Community Action Resource & Development";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = xTitleCellstyle; //  oDevExpress_Excel_Properties.gxlTitle_CellStyle1; //
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);
                        _Rowindex++;

                        string imagesPath = "https://capsysdev.capsystems.com/images/PIPlogos/" + ImgName;  // Application.MapPath("\\Resources\\Images\\NEOCAA_02_LOGO.png");
                        //DevExpress.Spreadsheet.Picture pic = ParamsSheet.Pictures.AddPicture(imagesPath, 700, 80, 630, 280);
                        DevExpress.Spreadsheet.SpreadsheetImageSource imgsrc = DevExpress.Spreadsheet.SpreadsheetImageSource.FromUri(imagesPath, workbook);
                        DevExpress.Spreadsheet.Picture pic = ParamsSheet.Pictures.AddPicture(imgsrc, 200, 0, 630, 280);


                        AgencyControlEntity _agycntrldets = new AgencyControlEntity();
                        _agycntrldets = BaseForm.BaseAgencyControlDetails;

                        if (BaseForm.BaseAgencyControlDetails.AgyShortName == "NEOCAA")
                            _agycntrldets = BAgyControlDetails;
                        else
                            _agycntrldets = BaseForm.BaseAgencyControlDetails;

                        string strStreet = (_agycntrldets.Street != "" ? _agycntrldets.Street + ", " : "");
                        string strCity = (_agycntrldets.City != "" ? _agycntrldets.City + ", " : "");
                        string strState = (_agycntrldets.State != "" ? _agycntrldets.State + ", " : "");
                        string strZipcode = (_agycntrldets.Zip1 != "" ? _agycntrldets.Zip1 + "" : "");

                        string strAddress = strStreet + strCity + strState + strZipcode; //_agycntrldets.Street + ", " + _agycntrldets.City + ", " + _agycntrldets.State + ", " + _agycntrldets.Zip1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = strAddress.Trim().TrimEnd(',');
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);

                        _Rowindex = 4;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = PrivilegeEntity.PrivilegeName;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = reportNameStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);

                        _Rowindex = 5;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "Report Parameters";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = xTitleCellstyle2; // oDevExpress_Excel_Properties.gxlTitle_CellStyle1;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);
                        _Rowindex++;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = txtHieDesc.Text.Trim();
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = xsubTitleintakeCellstyle; // oDevExpress_Excel_Properties.gxlTitle_CellStyle1;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);
                        _Rowindex++;


                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "";
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);
                        _Rowindex++;

                        //** PARAMETERS LIST **//
                        string caseType = string.Empty;
                        caseType = ((Captain.Common.Utilities.ListItem)Cmb_CaseType.SelectedItem).Text.ToString().Trim();

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblCaseType.Text.Trim();
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLHC;
                        //ParamsSheet.Rows[_Rowindex][_Columnindex+1].Style = oDevExpress_Excel_Properties.gxlNLHC;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = caseType;
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;



                        string strSelectedSP = Search_Entity.ZipCode;
                        strSelectedSP = strSelectedSP.Replace("'", "");

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblServiceplan.Text;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (Rb_SP_All.Checked ? "All" : strSelectedSP);
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;
                        string caseStatus = Rb_Stat_Both.Text;

                        if (Rb_Stat_Act.Checked == true)
                            caseStatus = Rb_Stat_Act.Text;
                        else if (Rb_Stat_InAct.Checked == true)
                            caseStatus = Rb_Stat_InAct.Text;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblCaseStatus.Text;
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = caseStatus;
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;


                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblDateSelection.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (Rb_MS_Date.Checked == true ? Rb_MS_Date.Text : Rb_MS_AddDate.Text);
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);



                        _Rowindex++;
                        _Columnindex = 1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblRepDesc.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Text.ToString().Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;


                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblReportType.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (rbQuaterly.Checked == true ? rbQuaterly.Text : rbMonthly.Text);
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "Report Period Control";
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (chkbReportPeriod.Checked == true ? "Yes" : "No");
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;


                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblProduceStatistical.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (Rb_Details_No.Checked == true ? Rb_Details_No.Text : Rb_Details_Yes.Text);
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblPovertyLevel.Text.Trim();
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblLow.Text + ": " + Txt_Pov_Low.Text + "      " + lblHigh.Text + ": " + Txt_Pov_High.Text;
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;


                        string selectedCounty = Search_Entity.County;
                        selectedCounty = selectedCounty.Replace("'", "");

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblCounty.Text.Trim();
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (Rb_County_All.Checked ? "All" : selectedCounty);
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;
                        string secretApp = Rb_Mst_NonSec.Text;

                        if (Rb_Mst_Sec.Checked == true)
                            secretApp = Rb_Mst_Sec.Text;
                        else if (Rb_Mst_BothSec.Checked == true)
                            secretApp = Rb_Mst_BothSec.Text;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblSecretApplications.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = secretApp;
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblAmounts.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (rbAmtNo.Checked ? "No" : "Yes");
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblAgyWideRep.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (rbAWRNo.Checked ? "No" : "Yes");
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "";
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "";
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex = _Rowindex + 3;
                        _Columnindex = 8;//9;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "Generated By: " + BaseForm.UserID;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = gxlGenerate_lr;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2);
                        _Rowindex++;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "Generated On: " + DateTime.Now.ToString("MM/dd/yyyy hh:mm:ss tt");
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = gxlGenerate_lr;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2);

                        ParamsSheet.IgnoredErrors.Add(ParamsSheet.GetDataRange(), DevExpress.Spreadsheet.IgnoredErrorType.NumberAsText);
                        #endregion

                        #region Other Sheets
                        _Rowindex = 0; _Columnindex = 0;

                        workbook.Unit = DevExpress.Office.DocumentUnit.Point;
                        string PrivSP = string.Empty;

                        var distinctRows = (from DataRow dRow in dt.Rows select dRow["SP0_SERVICECODE"]).Distinct();
                        foreach (var dRow in distinctRows)
                        {
                            DataTable dataTable = new DataTable();
                            DataView dv = new DataView(dt);
                            dv.RowFilter = "SP0_SERVICECODE='" + dRow + "'";
                            dataTable = dv.ToTable();

                            if (dataTable.Rows.Count > 0)
                            {
                                string ReportName = dataTable.Rows[0]["SP0_DESCRIPTION"].ToString();
                                ReportName = ReportName.Replace("/", "");

                                if (ReportName.Length >= 31)
                                {
                                    ReportName = ReportName.Substring(0, 31);
                                }
                                DevExpress.Spreadsheet.Worksheet SheetDetails = workbook.Worksheets.Add(ReportName);
                                SheetDetails.ActiveView.ShowGridlines = false;
                                SheetDetails.ActiveView.TabColor = Department_Back_Color(dataTable, null);
                                _Rowindex = 0;
                                _Columnindex = 0;

                                if (rbQuaterly.Checked)
                                {
                                    SheetDetails.Columns[0].Width = 200;
                                    SheetDetails.Columns[1].Width = 100;
                                    SheetDetails.Columns[2].Width = 80;
                                    SheetDetails.Columns[3].Width = 80;

                                    int colIndex = 3;
                                    if (rbAmtYes.Checked)
                                    {
                                        SheetDetails.Columns[4].Width = 80;
                                        SheetDetails.Columns[5].Width = 80;
                                        SheetDetails.Columns[6].Width = 80;
                                        SheetDetails.Columns[7].Width = 80;
                                        SheetDetails.Columns[8].Width = 80;
                                        SheetDetails.Columns[9].Width = 80;
                                        SheetDetails.Columns[10].Width = 80;
                                        SheetDetails.Columns[11].Width = 80;
                                        SheetDetails.Columns[12].Width = 80;
                                        colIndex = 12;
                                    }
                                    else
                                    {
                                        SheetDetails.Columns[4].Width = 140;
                                        SheetDetails.Columns[5].Width = 140;
                                        SheetDetails.Columns[6].Width = 140;
                                        SheetDetails.Columns[7].Width = 140;
                                        colIndex = 7;
                                    }

                                    SheetDetails.Columns[colIndex + 1].Width = 140;
                                    SheetDetails.Columns[colIndex + 1].Width = 140;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dataTable.Rows[0]["SP0_DESCRIPTION"].ToString();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xPageTitleCellstyle;// oDevExpress_Excel_Properties.gxlNLHC;


                                    if (rbAmtNo.Checked)
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 10); //cell.MergeAcross = 9;
                                    else
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 14); //cell.MergeAcross = 14;//13;

                                    _Rowindex++;
                                    //Row0 = sheet.Table.Rows.Add();
                                    //Row0.Height = 20;
                                    //cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");
                                    //cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");
                                    //cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");
                                    //cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;

                                    if (Q1Edate != "")
                                    {
                                        string Q1val = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(Convert.ToDateTime(Q1Sdate).Month.ToString())) + "-" + Convert.ToDateTime(Q1Sdate).Year.ToString() + " - " +
                                                      CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(Convert.ToDateTime(Q1Edate).Month.ToString())) + "-" + Convert.ToDateTime(Q1Edate).Year.ToString();
                                        //cell = Row0.Cells.Add(Q1val, DataType.String, "MainHeaderStyles1");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Q1val;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                        if (rbAmtYes.Checked)
                                        {
                                            xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                            _Columnindex = _Columnindex + 2;
                                        }
                                        else
                                            _Columnindex++;
                                    }

                                    if (Q2Edate != "")
                                    {
                                        string Q2val = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(Convert.ToDateTime(Q2Sdate).Month.ToString())) + "-" + Convert.ToDateTime(Q2Sdate).Year.ToString() + " - " +
                                                        CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(Convert.ToDateTime(Q2Edate).Month.ToString())) + "-" + Convert.ToDateTime(Q2Edate).Year.ToString();
                                        //cell = Row0.Cells.Add(Q2val, DataType.String, "MainHeaderStyles1");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Q2val;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                        if (rbAmtYes.Checked)
                                        {
                                            xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;

                                            _Columnindex = _Columnindex + 2;
                                        }
                                        else
                                            _Columnindex++;
                                    }

                                    if (Q3Edate != "")
                                    {
                                        string Q3val = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(Convert.ToDateTime(Q3Sdate).Month.ToString())) + "-" + Convert.ToDateTime(Q3Sdate).Year.ToString() + " - " +
                                                        CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(Convert.ToDateTime(Q3Edate).Month.ToString())) + "-" + Convert.ToDateTime(Q3Edate).Year.ToString();
                                        //cell = Row0.Cells.Add(Q3val, DataType.String, "MainHeaderStyles1");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Q3val;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                        if (rbAmtYes.Checked)
                                        {
                                            xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                            _Columnindex = _Columnindex + 2;
                                        }
                                        else
                                            _Columnindex++;
                                    }

                                    if (Q4Edate != "")
                                    {
                                        string Q4val = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(Convert.ToDateTime(Q4Sdate).Month.ToString())) + "-" + Convert.ToDateTime(Q4Sdate).Year.ToString() + " - " +
                                                        CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(Convert.ToDateTime(Q4Edate).Month.ToString())) + "-" + Convert.ToDateTime(Q4Edate).Year.ToString();
                                        // cell = Row0.Cells.Add(Q4val, DataType.String, "MainHeaderStyles1");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Q4val;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                        if (rbAmtYes.Checked)
                                        {
                                            xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                            _Columnindex = _Columnindex + 2;
                                        }
                                        else
                                            _Columnindex++;
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                    //cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");
                                    if (rbAmtYes.Checked)
                                    {
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                        _Columnindex = _Columnindex + 2;
                                    }
                                    else
                                        _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                    //cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");






                                    _Rowindex++;
                                    _Columnindex = 0;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Description";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Aggregate Func.";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Type";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Target";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    _Columnindex++;





                                    if (Q1Edate != "")
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                        _Columnindex++;

                                        if (rbAmtYes.Checked)
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                            _Columnindex++;
                                        }

                                    }

                                    if (Q2Edate != "")
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                        _Columnindex++;

                                        if (rbAmtYes.Checked)
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                            _Columnindex++;
                                        }

                                    }

                                    if (Q3Edate != "")
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                        _Columnindex++;
                                        if (rbAmtYes.Checked)
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                            _Columnindex++;
                                        }


                                    }

                                    if (Q4Edate != "")
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                        _Columnindex++;
                                        if (rbAmtYes.Checked)
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                            _Columnindex++;


                                        }
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients YTD";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    _Columnindex++;

                                    if (rbAmtYes.Checked)
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount YTD";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                        _Columnindex++;
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "YTD %";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    _Columnindex++;

                                    int i = 0;
                                    foreach (DataRow dr in dataTable.Rows)
                                    {
                                        //Row0 = sheet.Table.Rows.Add();

                                        _Rowindex++;
                                        _Columnindex = 0;

                                        string CAMSType = string.Empty;
                                        if (dr["SP2_TYPE"].ToString().Trim() == "CA")
                                            CAMSType = "Service";
                                        else
                                            CAMSType = "Outcome";

                                        string Ytd = string.Empty;
                                        if (dr["TARGET_VAL"].ToString() != "0")
                                        {
                                            if (!string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                            {
                                                decimal percent = (decimal.Parse(dr["YTD"].ToString().Trim() == string.Empty ? "0" : dr["YTD"].ToString().Trim()) / decimal.Parse(dr["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : dr["TARGET_VAL"].ToString().Trim())) * 100;

                                                Ytd = percent.ToString("0.00");
                                            }
                                            else
                                            {
                                                int totcnt = 0, Q1 = 0, Q2 = 0, Q3 = 0, Q4 = 0;
                                                if (Q1Edate != "")
                                                    if (!string.IsNullOrEmpty(dr["Q1_Cnt"].ToString().Trim()))
                                                        Q1 = int.Parse(dr["Q1_Cnt"].ToString().Trim());
                                                if (Q2Edate != "")
                                                    if (!string.IsNullOrEmpty(dr["Q2_Cnt"].ToString().Trim()))
                                                        Q2 = int.Parse(dr["Q2_Cnt"].ToString().Trim());
                                                if (Q3Edate != "")
                                                    if (!string.IsNullOrEmpty(dr["Q3_Cnt"].ToString().Trim()))
                                                        Q3 = int.Parse(dr["Q3_Cnt"].ToString().Trim());
                                                if (Q4Edate != "")
                                                    if (!string.IsNullOrEmpty(dr["Q4_Cnt"].ToString().Trim()))
                                                        Q4 = int.Parse(dr["Q4_Cnt"].ToString().Trim());
                                                totcnt = Q1 + Q2 + Q3 + Q4;

                                                decimal percent = (decimal.Parse(totcnt.ToString().Trim() == string.Empty ? "0" : totcnt.ToString().Trim()) / decimal.Parse(dr["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : dr["TARGET_VAL"].ToString().Trim())) * 100;

                                                Ytd = percent.ToString("0.00");
                                            }
                                        }

                                        string CntType = string.Empty;
                                        if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                            CntType = "Amount - Average";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "S")
                                            CntType = "Amount - Sum";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "E")
                                            CntType = "Amount - End of Month";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "C")
                                            CntType = "Client - Average";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "B")
                                            CntType = "Client - Sum";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "D")
                                            CntType = "Client - End of Month";





                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["CAMS_DESC"].ToString();
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlBLC, gxlErrBLC);// (dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlBLC : gxlErrBLC);
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = CntType;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlBLC, gxlErrBLC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlBLC : gxlErrBLC);
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = CAMSType;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlBLC, gxlErrBLC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlBLC : gxlErrBLC);
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = (dr["TARGET_VAL"].ToString() != "" ? Convert.ToInt32(dr["TARGET_VAL"].ToString()) : 0);
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_NRC, gxlErrNumb_NRC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlNumb_NRC : gxlErrNumb_NRC);
                                        _Columnindex++;

                                        if (dr["SP2_COUNT_TYPE"].ToString() == "B" || dr["SP2_COUNT_TYPE"].ToString() == "C" || dr["SP2_COUNT_TYPE"].ToString() == "D")
                                        {
                                            if (Q1Edate != "")
                                            {
                                                //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s106");

                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q1"].ToString() + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q1"].ToString() == "" ? "0" : dr["Q1"].ToString());
                                                }


                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    //cell = Row0.Cells.Add("", DataType.String, "s106");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                    _Columnindex++;
                                                }
                                            }

                                            if (Q2Edate != "")
                                            {
                                                //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s106");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString();

                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q2"].ToString() + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q2"].ToString() == "" ? "0" : dr["Q2"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    //cell = Row0.Cells.Add("", DataType.String, "s106");
                                                    // SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                    _Columnindex++;
                                                }
                                            }

                                            if (Q3Edate != "")
                                            {
                                                //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s106");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString();

                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q3"].ToString() + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q3"].ToString() == "" ? "0" : dr["Q3"].ToString());
                                                }


                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    //cell = Row0.Cells.Add("", DataType.String, "s106");

                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                    _Columnindex++;
                                                }
                                            }

                                            if (Q4Edate != "")
                                            {
                                                // cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s106");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString();

                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q4"].ToString() + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q4"].ToString() == "" ? "0" : dr["Q4"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    //cell = Row0.Cells.Add("", DataType.String, "s106");

                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); // oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                    _Columnindex++;
                                                }
                                            }

                                            // SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString();

                                            if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["YTD"].ToString() + "%";
                                            else
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["YTD"].ToString() == "" ? "0" : dr["YTD"].ToString());
                                            }


                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                            _Columnindex++;

                                            if (rbAmtYes.Checked)
                                            {
                                                //cell = Row0.Cells.Add("", DataType.String, "s106");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                _Columnindex++;
                                            }
                                            // cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106");



                                        }
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "S" || dr["SP2_COUNT_TYPE"].ToString() == "A" || dr["SP2_COUNT_TYPE"].ToString() == "E")
                                        {
                                            if (Q1Edate != "")
                                            {

                                                if (rbAmtYes.Checked)
                                                {
                                                    //cell = Row0.Cells.Add("", DataType.String, "s106");

                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                    _Columnindex++;
                                                }

                                                //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString();

                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q1"].ToString() + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q1"].ToString() == "" ? "0" : dr["Q1"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                _Columnindex++;
                                                // cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s106");


                                            }
                                            if (Q2Edate != "")
                                            {
                                                //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s106");

                                                if (rbAmtYes.Checked)
                                                {
                                                    //cell = Row0.Cells.Add("", DataType.String, "s106");

                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                    _Columnindex++;
                                                }
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString();
                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q2"].ToString() + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q2"].ToString() == "" ? "0" : dr["Q2"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                _Columnindex++;
                                            }
                                            if (Q3Edate != "")
                                            {

                                                if (rbAmtYes.Checked)
                                                {
                                                    //cell = Row0.Cells.Add("", DataType.String, "s106");

                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                    _Columnindex++;
                                                }
                                                //  cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s106");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString();
                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q3"].ToString() + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q3"].ToString() == "" ? "0" : dr["Q3"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                _Columnindex++;

                                            }
                                            if (Q4Edate != "")
                                            {

                                                if (rbAmtYes.Checked)
                                                {
                                                    //cell = Row0.Cells.Add("", DataType.String, "s106");

                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                    _Columnindex++;
                                                }
                                                // cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s106");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString();
                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q4"].ToString() + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q4"].ToString() == "" ? "0" : dr["Q4"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                _Columnindex++;

                                            }

                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106");



                                            if (rbAmtYes.Checked)
                                            {
                                                //cell = Row0.Cells.Add("", DataType.String, "s106");

                                                //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                                _Columnindex++;
                                            }
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString();
                                            if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["YTD"].ToString() + "%";
                                            else
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["YTD"].ToString() == "" ? "0" : dr["YTD"].ToString());
                                            }
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlDeci_NRC;
                                            _Columnindex++;
                                        }
                                        else
                                        {
                                            //cell = Row0.Cells.Add(dr["Q1_Cnt"].ToString(), DataType.String, "s106");

                                            if (Q1Edate != "")
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["Q1_Cnt"].ToString());
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_NRC, gxlErrNumb_NRC);// (dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlNumb_NRC : gxlErrNumb_NRC);
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s106");

                                                    // SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString();


                                                    if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q1"].ToString() + "%";
                                                    else
                                                    {
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q1"].ToString() == "" ? "0" : dr["Q1"].ToString());
                                                    }

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC);//(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlDeci_NRC : gxlErrDeci_NRC);
                                                    _Columnindex++;
                                                }
                                            }

                                            if (Q2Edate != "")
                                            {
                                                // cell = Row0.Cells.Add(dr["Q2_Cnt"].ToString(), DataType.String, "s106");

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["Q2_Cnt"].ToString());
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_NRC, gxlErrNumb_NRC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlNumb_NRC : gxlErrNumb_NRC);
                                                _Columnindex++;


                                                if (rbAmtYes.Checked)
                                                {
                                                    //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s106");

                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString();


                                                    if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q2"].ToString() + "%";
                                                    else
                                                    {
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q2"].ToString() == "" ? "0" : dr["Q2"].ToString());
                                                    }

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); // (dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlDeci_NRC : gxlErrDeci_NRC);
                                                    _Columnindex++;
                                                }
                                            }

                                            if (Q3Edate != "")
                                            {

                                                //cell = Row0.Cells.Add(dr["Q3_Cnt"].ToString(), DataType.String, "s106");
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["Q3_Cnt"].ToString());
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_NRC, gxlErrNumb_NRC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlNumb_NRC : gxlErrNumb_NRC);
                                                _Columnindex++;


                                                if (rbAmtYes.Checked)
                                                {
                                                    // cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s106");

                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString();


                                                    if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q3"].ToString() + "%";
                                                    else
                                                    {
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q3"].ToString() == "" ? "0" : dr["Q3"].ToString());
                                                    }


                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlDeci_NRC : gxlErrDeci_NRC);
                                                    _Columnindex++;
                                                }
                                            }
                                            if (Q4Edate != "")
                                            {
                                                // cell = Row0.Cells.Add(dr["Q4_Cnt"].ToString(), DataType.String, "s106");

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["Q4_Cnt"].ToString());
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_NRC, gxlErrNumb_NRC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlNumb_NRC : gxlErrNumb_NRC);
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    // cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s106");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString();


                                                    if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q4"].ToString() + "%";
                                                    else
                                                    {
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q4"].ToString() == "" ? "0" : dr["Q4"].ToString());
                                                    }

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlDeci_NRC : gxlErrDeci_NRC);
                                                    _Columnindex++;
                                                }
                                            }

                                            int totcnt = 0, Q1 = 0, Q2 = 0, Q3 = 0, Q4 = 0;
                                            if (Q1Edate != "")
                                                if (!string.IsNullOrEmpty(dr["Q1_Cnt"].ToString().Trim()))
                                                    Q1 = int.Parse(dr["Q1_Cnt"].ToString().Trim());
                                            if (Q2Edate != "")
                                                if (!string.IsNullOrEmpty(dr["Q2_Cnt"].ToString().Trim()))
                                                    Q2 = int.Parse(dr["Q2_Cnt"].ToString().Trim());
                                            if (Q3Edate != "")
                                                if (!string.IsNullOrEmpty(dr["Q3_Cnt"].ToString().Trim()))
                                                    Q3 = int.Parse(dr["Q3_Cnt"].ToString().Trim());
                                            if (Q4Edate != "")
                                                if (!string.IsNullOrEmpty(dr["Q4_Cnt"].ToString().Trim()))
                                                    Q4 = int.Parse(dr["Q4_Cnt"].ToString().Trim());
                                            totcnt = Q1 + Q2 + Q3 + Q4;

                                            //cell = Row0.Cells.Add(totcnt == 0 ? "" : totcnt.ToString(), DataType.String, "s106");
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = totcnt == 0 ? 0 : Convert.ToInt32(totcnt.ToString());
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_NRC, gxlErrNumb_NRC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlNumb_NRC : gxlErrNumb_NRC);
                                            _Columnindex++;

                                            if (rbAmtYes.Checked)
                                            {
                                                //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106");

                                                //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString();


                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["YTD"].ToString() + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["YTD"].ToString() == "" ? "0" : dr["YTD"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlDeci_NRC : gxlErrDeci_NRC);
                                                _Columnindex++;
                                            }

                                        }

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = (Ytd == string.Empty ? "" : Ytd + "%");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlDeci_NRC : gxlErrDeci_NRC);
                                        _Columnindex++;






                                        i++;
                                    }
                                }
                                else
                                {
                                    int _ToEndMonth = Convert.ToDateTime(dtAnnualTodate.Value).Month;
                                    DateTime FromDate = Convert.ToDateTime(rngcodedata.OFdate);
                                    DateTime ToDate = Convert.ToDateTime(dtAnnualTodate.Value);
                                    int NoMonths = GetMonthsBetween(FromDate, ToDate) + 1;


                                    SheetDetails.Columns[0].Width = 200;
                                    SheetDetails.Columns[1].Width = 100;
                                    SheetDetails.Columns[2].Width = 80;
                                    SheetDetails.Columns[3].Width = 75;

                                    int _colindex = 4;

                                    for (int xx = 0; xx < NoMonths; xx++)
                                    {
                                        SheetDetails.Columns[_colindex].Width = 75;
                                        _colindex++;

                                        if (rbAmtYes.Checked)
                                        {
                                            SheetDetails.Columns[_colindex].Width = 75;
                                            _colindex++;
                                        }
                                    }

                                    #region Oldcode
                                    //SheetDetails.Columns[_colindex].Width = 75;
                                    //_colindex++;

                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Columns[_colindex].Width = 75;
                                    //    _colindex++;
                                    //}

                                    //SheetDetails.Columns[_colindex].Width = 75;
                                    //_colindex++;

                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Columns[_colindex].Width = 75;
                                    //    _colindex++;
                                    //}

                                    //SheetDetails.Columns[_colindex].Width = 75;
                                    //_colindex++;

                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Columns[_colindex].Width = 75;
                                    //    _colindex++;
                                    //}

                                    //SheetDetails.Columns[_colindex].Width = 75;
                                    //_colindex++;

                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Columns[_colindex].Width = 75;
                                    //    _colindex++;
                                    //}

                                    //SheetDetails.Columns[_colindex].Width = 75;
                                    //_colindex++;

                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Columns[_colindex].Width = 75;
                                    //    _colindex++;
                                    //}

                                    //SheetDetails.Columns[_colindex].Width = 75;
                                    //_colindex++;

                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Columns[_colindex].Width = 75;
                                    //    _colindex++;
                                    //}

                                    //SheetDetails.Columns[_colindex].Width = 75;
                                    //_colindex++;

                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Columns[_colindex].Width = 75;
                                    //    _colindex++;
                                    //}

                                    //SheetDetails.Columns[_colindex].Width = 75;
                                    //_colindex++;

                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Columns[_colindex].Width = 75;
                                    //    _colindex++;
                                    //}

                                    //SheetDetails.Columns[_colindex].Width = 75;
                                    //_colindex++;

                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Columns[_colindex].Width = 75;
                                    //    _colindex++;
                                    //}

                                    //SheetDetails.Columns[_colindex].Width = 75;
                                    //_colindex++;

                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Columns[_colindex].Width = 75;
                                    //    _colindex++;
                                    //}

                                    //SheetDetails.Columns[_colindex].Width = 75;
                                    //_colindex++;

                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Columns[_colindex].Width = 75;
                                    //    _colindex++;
                                    //}
                                    #endregion
                                    SheetDetails.Columns[_colindex].Width = 80;
                                    _colindex++;
                                    SheetDetails.Columns[_colindex].Width = 80;
                                    _colindex++;
                                    SheetDetails.Columns[_colindex].Width = 80;
                                    _colindex++;

                                    //_Rowindex++;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dataTable.Rows[0]["SP0_DESCRIPTION"].ToString();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xPageTitleCellstyle;// oDevExpress_Excel_Properties.gxlNLHC;



                                    if (rbAmtNo.Checked)
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 17); //cell.MergeAcross = 17;
                                    else
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 30); //cell.MergeAcross = 30;//29;

                                    _Rowindex++;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;


                                    DateTime ct = Convert.ToDateTime(rngcodedata.OFdate);
                                    for (int x = 0; x < NoMonths; x++)
                                    {
                                        if (x > 0)
                                            ct = ct.AddMonths(1);

                                        string Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                        //cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Mval1;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;


                                        if (rbAmtYes.Checked)
                                        {
                                            xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                            _Columnindex = _Columnindex + 2;
                                        }
                                        else
                                            _Columnindex++;
                                    }

                                    #region OldCode
                                    //DateTime ct = Convert.ToDateTime(rngcodedata.OFdate);
                                    //string Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                    ////cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = Mval1;
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;


                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                    //    _Columnindex = _Columnindex + 2;
                                    //}
                                    //else
                                    //    _Columnindex++;

                                    //ct = ct.AddMonths(1);
                                    //Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                    ////cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = Mval1;
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                    ////_Columnindex++;

                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                    //    _Columnindex = _Columnindex + 2;
                                    //}
                                    //else
                                    //    _Columnindex++;

                                    //ct = ct.AddMonths(1);
                                    //Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                    ////cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = Mval1;
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                    //    _Columnindex = _Columnindex + 2;
                                    //}
                                    //else
                                    //    _Columnindex++;
                                    //ct = ct.AddMonths(1);
                                    //Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                    ////cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = Mval1;
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                    //    _Columnindex = _Columnindex + 2;
                                    //}
                                    //else
                                    //    _Columnindex++;
                                    //ct = ct.AddMonths(1);
                                    //Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                    ////cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = Mval1;
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                    //    _Columnindex = _Columnindex + 2;
                                    //}
                                    //else
                                    //    _Columnindex++;
                                    //ct = ct.AddMonths(1);
                                    //Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                    ////cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = Mval1;
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                    //    _Columnindex = _Columnindex + 2;
                                    //}
                                    //else
                                    //    _Columnindex++;
                                    //ct = ct.AddMonths(1);
                                    //Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                    //// cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = Mval1;
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                    //    _Columnindex = _Columnindex + 2;
                                    //}
                                    //else
                                    //    _Columnindex++;
                                    //ct = ct.AddMonths(1);
                                    //Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                    ////cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = Mval1;
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                    //    _Columnindex = _Columnindex + 2;
                                    //}
                                    //else
                                    //    _Columnindex++;
                                    //ct = ct.AddMonths(1);
                                    //Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                    ////cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = Mval1;
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                    //    _Columnindex = _Columnindex + 2;
                                    //}
                                    //else
                                    //    _Columnindex++;
                                    //ct = ct.AddMonths(1);
                                    //Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                    ////cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = Mval1;
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                    //    _Columnindex = _Columnindex + 2;
                                    //}
                                    //else
                                    //    _Columnindex++;
                                    //ct = ct.AddMonths(1);
                                    //Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                    ////cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = Mval1;
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                    //    _Columnindex = _Columnindex + 2;
                                    //}
                                    //else
                                    //    _Columnindex++;
                                    //ct = ct.AddMonths(1);
                                    //Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                    ////cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = Mval1;
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                    //    _Columnindex = _Columnindex + 2;
                                    //}
                                    //else
                                    //    _Columnindex++;

                                    #endregion
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBCHC;
                                    if (rbAmtYes.Checked)
                                    {
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2); //cell.MergeAcross = 1;
                                        _Columnindex = _Columnindex + 2;
                                    }
                                    else
                                        _Columnindex++;

                                    //cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;



                                    _Rowindex++;
                                    _Columnindex = 0;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Description";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Aggregate Func.";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;


                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Type";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Target";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    _Columnindex++;


                                    for (int x = 0; x < NoMonths; x++)
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                        _Columnindex++;

                                        if (rbAmtYes.Checked)
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                            _Columnindex++;
                                        }
                                    }

                                    #region OldCode
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //_Columnindex++;


                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //    _Columnindex++;
                                    //}
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //_Columnindex++;


                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //    _Columnindex++;
                                    //}
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //_Columnindex++;


                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //    _Columnindex++;
                                    //}
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //_Columnindex++;


                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //    _Columnindex++;
                                    //}
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //_Columnindex++;


                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //    _Columnindex++;
                                    //}
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //_Columnindex++;


                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //    _Columnindex++;
                                    //}
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //_Columnindex++;


                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //    _Columnindex++;
                                    //}
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //_Columnindex++;


                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //    _Columnindex++;
                                    //}
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //_Columnindex++;


                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //    _Columnindex++;
                                    //}
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //_Columnindex++;


                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //    _Columnindex++;
                                    //}
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //_Columnindex++;


                                    //if (rbAmtYes.Checked)
                                    //{
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                    //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    //    _Columnindex++;
                                    //}

                                    #endregion


                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients YTD";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    _Columnindex++;
                                    if (rbAmtYes.Checked)
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount YTD";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                        _Columnindex++;
                                    }


                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "YTD %";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBRHC;
                                    _Columnindex++;




                                    int i = 0;
                                    foreach (DataRow dr in dataTable.Rows)
                                    {

                                        _Rowindex++;
                                        _Columnindex = 0;

                                        // Row0 = sheet.Table.Rows.Add();


                                        string CAMSType = string.Empty;
                                        if (dr["SP2_TYPE"].ToString().Trim() == "CA")
                                            CAMSType = "Service";
                                        else
                                            CAMSType = "Outcome";

                                        string CntType = string.Empty;
                                        if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                            CntType = "Amount - Average";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "S")
                                            CntType = "Amount - Sum";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "E")
                                            CntType = "Amount - End of Month";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "C")
                                            CntType = "Client - Average";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "B")
                                            CntType = "Client - Sum";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "D")
                                            CntType = "Client - End of Month";



                                        int totcnt = 0, M1 = 0, M2 = 0, M3 = 0, M4 = 0, M5 = 0, M6 = 0, M7 = 0, M8 = 0, M9 = 0, M10 = 0, M11 = 0, M12 = 0;
                                        if (!string.IsNullOrEmpty(dr["M1_MEM"].ToString().Trim()))
                                            M1 = int.Parse(dr["M1_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M2_MEM"].ToString().Trim()))
                                            M2 = int.Parse(dr["M2_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M3_MEM"].ToString().Trim()))
                                            M3 = int.Parse(dr["M3_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M4_MEM"].ToString().Trim()))
                                            M4 = int.Parse(dr["M4_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M5_MEM"].ToString().Trim()))
                                            M5 = int.Parse(dr["M5_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M6_MEM"].ToString().Trim()))
                                            M6 = int.Parse(dr["M6_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M7_MEM"].ToString().Trim()))
                                            M7 = int.Parse(dr["M7_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M8_MEM"].ToString().Trim()))
                                            M8 = int.Parse(dr["M8_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M9_MEM"].ToString().Trim()))
                                            M9 = int.Parse(dr["M9_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M10_MEM"].ToString().Trim()))
                                            M10 = int.Parse(dr["M10_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M11_MEM"].ToString().Trim()))
                                            M11 = int.Parse(dr["M11_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M12_MEM"].ToString().Trim()))
                                            M12 = int.Parse(dr["M12_MEM"].ToString().Trim());
                                        totcnt = M1 + M2 + M3 + M4 + M5 + M6 + M7 + M8 + M9 + M10 + M11 + M12;

                                        string Ytd = string.Empty;
                                        if (dr["TARGET_VAL"].ToString() != "0")
                                        {
                                            if (!string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                            {
                                                decimal percent = (decimal.Parse(dr["YTD"].ToString().Trim() == string.Empty ? "0" : dr["YTD"].ToString().Trim()) / decimal.Parse(dr["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : dr["TARGET_VAL"].ToString().Trim())) * 100;

                                                Ytd = percent.ToString("0.00");
                                            }
                                            else
                                            {
                                                decimal percent = (decimal.Parse(totcnt.ToString().Trim() == string.Empty ? "0" : totcnt.ToString().Trim()) / decimal.Parse(dr["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : dr["TARGET_VAL"].ToString().Trim())) * 100;

                                                Ytd = percent.ToString("0.00");
                                            }
                                        }


                                        //if (dr["SP0_ACTIVE"].ToString() == "Y")
                                        //{
                                        //cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s105");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["CAMS_DESC"].ToString();
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlBLC, gxlErrBLC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlBLC : gxlErrBLC);
                                        _Columnindex++;


                                        //cell = Row0.Cells.Add(CntType, DataType.String, "s105");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = CntType;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlBLC, gxlErrBLC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlBLC : gxlErrBLC);
                                        _Columnindex++;

                                        //cell = Row0.Cells.Add(CAMSType, DataType.String, "s105");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = CAMSType;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlBLC, gxlErrBLC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlBLC : gxlErrBLC);
                                        _Columnindex++;

                                        //cell = Row0.Cells.Add(dr["TARGET_VAL"].ToString(), DataType.String, "s106");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = (dr["TARGET_VAL"].ToString() != "" ? Convert.ToInt32(dr["TARGET_VAL"].ToString()) : 0);
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_NRC, gxlErrNumb_NRC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlNumb_NRC : gxlErrNumb_NRC);
                                        _Columnindex++;




                                        if (dr["SP2_COUNT_TYPE"].ToString() == "B" || dr["SP2_COUNT_TYPE"].ToString() == "C" || dr["SP2_COUNT_TYPE"].ToString() == "D")
                                        {
                                            for (int y = 0; y < NoMonths; y++)
                                            {
                                                int x = y + 1;

                                                //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M" + x.ToString() + ""].ToString() + "%" : dr["M" + x.ToString() + ""].ToString();

                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["M" + x.ToString() + ""].ToString() + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["M" + x.ToString() + ""].ToString() == "" ? "0" : dr["M" + x.ToString() + ""].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    //cell = Row0.Cells.Add("", DataType.String, "s106");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                                    _Columnindex++;
                                                }
                                                //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M1"].ToString() + "%" : dr["M1"].ToString(), DataType.String, "s106");

                                            }

                                            #region OldCode

                                            ////cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M1"].ToString() + "%" : dr["M1"].ToString(), DataType.String, "s106");
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M1"].ToString() + "%" : dr["M1"].ToString();
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //_Columnindex++;

                                            //if (rbAmtYes.Checked)
                                            //{
                                            //    //cell = Row0.Cells.Add("", DataType.String, "s106");
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //    _Columnindex++;
                                            //}

                                            ////cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M2"].ToString() + "%" : dr["M2"].ToString(), DataType.String, "s106");
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M2"].ToString() + "%" : dr["M2"].ToString();
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //_Columnindex++;

                                            //if (rbAmtYes.Checked)
                                            //{
                                            //    //cell = Row0.Cells.Add("", DataType.String, "s106");
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //    _Columnindex++;
                                            //}

                                            ////cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M3"].ToString() + "%" : dr["M3"].ToString(), DataType.String, "s106");
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M3"].ToString() + "%" : dr["M3"].ToString();
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //_Columnindex++;
                                            //if (rbAmtYes.Checked)
                                            //{
                                            //    //cell = Row0.Cells.Add("", DataType.String, "s106");
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); // oDevExpress_Excel_Properties.gxlBRRC;
                                            //    _Columnindex++;
                                            //}

                                            ////cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M4"].ToString() + "%" : dr["M4"].ToString(), DataType.String, "s106");
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M4"].ToString() + "%" : dr["M4"].ToString();
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //_Columnindex++;

                                            //if (rbAmtYes.Checked)
                                            //{
                                            //    //cell = Row0.Cells.Add("", DataType.String, "s106");
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //    _Columnindex++;
                                            //}

                                            ////cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M5"].ToString() + "%" : dr["M5"].ToString(), DataType.String, "s106");
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M5"].ToString() + "%" : dr["M5"].ToString();
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //_Columnindex++;

                                            //if (rbAmtYes.Checked)
                                            //{
                                            //    //cell = Row0.Cells.Add("", DataType.String, "s106");
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //    _Columnindex++;
                                            //}

                                            ////cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M6"].ToString() + "%" : dr["M6"].ToString(), DataType.String, "s106");

                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M6"].ToString() + "%" : dr["M6"].ToString();
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //_Columnindex++;

                                            //if (rbAmtYes.Checked)
                                            //{
                                            //    //cell = Row0.Cells.Add("", DataType.String, "s106");
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //    _Columnindex++;
                                            //}

                                            ////cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M7"].ToString() + "%" : dr["M7"].ToString(), DataType.String, "s106");
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M7"].ToString() + "%" : dr["M7"].ToString();
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //_Columnindex++;

                                            //if (rbAmtYes.Checked)
                                            //{
                                            //    //cell = Row0.Cells.Add("", DataType.String, "s106");
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //    _Columnindex++;
                                            //}

                                            ////cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M8"].ToString() + "%" : dr["M8"].ToString(), DataType.String, "s106");
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M8"].ToString() + "%" : dr["M8"].ToString();
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //_Columnindex++;

                                            //if (rbAmtYes.Checked)
                                            //{
                                            //    //cell = Row0.Cells.Add("", DataType.String, "s106");
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //    _Columnindex++;
                                            //}

                                            ////cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M9"].ToString() + "%" : dr["M9"].ToString(), DataType.String, "s106");
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M9"].ToString() + "%" : dr["M9"].ToString();
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //_Columnindex++;
                                            //if (rbAmtYes.Checked)
                                            //{
                                            //    //cell = Row0.Cells.Add("", DataType.String, "s106");
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //    _Columnindex++;
                                            //}

                                            ////cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M10"].ToString() + "%" : dr["M10"].ToString(), DataType.String, "s106");
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M10"].ToString() + "%" : dr["M10"].ToString();
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //_Columnindex++;

                                            //if (rbAmtYes.Checked)
                                            //{
                                            //    //cell = Row0.Cells.Add("", DataType.String, "s106");
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //    _Columnindex++;
                                            //}

                                            ////cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M11"].ToString() + "%" : dr["M11"].ToString(), DataType.String, "s106");
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M11"].ToString() + "%" : dr["M11"].ToString();
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //_Columnindex++;

                                            //if (rbAmtYes.Checked)
                                            //{
                                            //    //cell = Row0.Cells.Add("", DataType.String, "s106");
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //    _Columnindex++;
                                            //}

                                            ////cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M12"].ToString() + "%" : dr["M12"].ToString(), DataType.String, "s106");
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M12"].ToString() + "%" : dr["M12"].ToString();
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //_Columnindex++;
                                            //if (rbAmtYes.Checked)
                                            //{
                                            //    //cell = Row0.Cells.Add("", DataType.String, "s106");
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            //    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            //    _Columnindex++;
                                            //}

                                            #endregion
                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106");
                                            // SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString();


                                            if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["YTD"].ToString() + "%";
                                            else
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["YTD"].ToString() == "" ? "0" : dr["YTD"].ToString());
                                            }

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            _Columnindex++;

                                            if (rbAmtYes.Checked)
                                            {
                                                //cell = Row0.Cells.Add("", DataType.String, "s106");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                                _Columnindex++;
                                            }


                                        }
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "S" || dr["SP2_COUNT_TYPE"].ToString() == "A" || dr["SP2_COUNT_TYPE"].ToString() == "E")
                                        {
                                            for (int y = 0; y < NoMonths; y++)
                                            {


                                                if (rbAmtYes.Checked)
                                                {
                                                    //cell = Row0.Cells.Add("", DataType.String, "s106");
                                                    // SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                                    _Columnindex++;
                                                }
                                                //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M1"].ToString() + "%" : dr["M1"].ToString(), DataType.String, "s106");

                                                int x = y + 1;
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M" + x.ToString() + ""].ToString() + "%" : dr["M" + x.ToString() + ""].ToString();

                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["M" + x.ToString() + ""].ToString() + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["M" + x.ToString() + ""].ToString() == "" ? "0" : dr["M" + x.ToString() + ""].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                                _Columnindex++;
                                            }


                                            if (rbAmtYes.Checked)
                                            {
                                                //cell = Row0.Cells.Add("", DataType.String, "s106");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                                _Columnindex++;
                                            }
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString();
                                            if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["YTD"].ToString() + "%";
                                            else
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["YTD"].ToString() == "" ? "0" : dr["YTD"].ToString());
                                            }
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //oDevExpress_Excel_Properties.gxlBRRC;
                                            _Columnindex++;
                                        }
                                        else
                                        {

                                            for (int y = 0; y < NoMonths; y++)
                                            {
                                                int x = y + 1;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["M" + x.ToString() + "_MEM"].ToString());
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_NRC, gxlErrNumb_NRC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlNumb_NRC : gxlErrNumb_NRC);
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M" + x.ToString() + ""].ToString() + "%" : dr["M" + x.ToString() + ""].ToString();

                                                    if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["M" + x.ToString() + ""].ToString() + "%";
                                                    else
                                                    {
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["M" + x.ToString() + ""].ToString() == "" ? "0" : dr["M" + x.ToString() + ""].ToString());
                                                    }

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlDeci_NRC : gxlErrDeci_NRC);
                                                    _Columnindex++;
                                                }
                                            }


                                            //cell = Row0.Cells.Add(totcnt == 0 ? "" : totcnt.ToString(), DataType.String, "s106");
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = totcnt == 0 ? 0 : Convert.ToInt32(totcnt.ToString());
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_NRC, gxlErrNumb_NRC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlNumb_NRC : gxlErrNumb_NRC);
                                            _Columnindex++;

                                            if (rbAmtYes.Checked)
                                            {
                                                // cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106");

                                                // SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString();

                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["YTD"].ToString() + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["YTD"].ToString() == "" ? "0" : dr["YTD"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlDeci_NRC : gxlErrDeci_NRC);
                                                _Columnindex++;
                                            }


                                        }



                                        //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106");
                                        //cell = Row0.Cells.Add(Ytd == string.Empty ? "" : Ytd + "%", DataType.String, "s106");

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = (Ytd == string.Empty ? "" : Ytd + "%");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_NRC, gxlErrDeci_NRC); //(dr["SP2_ACTIVE"].ToString() == "A" ? oDevExpress_Excel_Properties.gxlDeci_NRC : gxlErrDeci_NRC);
                                        _Columnindex++;






                                        i++;
                                    }
                                }

                            }

                            #region Audit Report
                            if (Rb_SP_Sel.Checked)
                            {
                                if (dtAudit.Rows.Count > 0)
                                {
                                    DataTable dataAudit = new DataTable();
                                    DataView dvAudit = new DataView(dtAudit);
                                    dvAudit.RowFilter = "SP='" + dRow + "'";
                                    dvAudit.RowFilter = "SP='" + dRow + "'";
                                    //if (Rb_MS_Date.Checked)
                                    //    dvAudit.Sort = "CAMS_DATE";
                                    //else dvAudit.Sort = "CAMS_DATE_ADD";
                                    dataAudit = dvAudit.ToTable();

                                    if (dataAudit.Rows.Count > 0)
                                    {
                                        string ReportName = dRow + "_Audit";//dataTable.Rows[0]["SP_Desc"].ToString();
                                        ReportName = ReportName.Replace("/", "");

                                        if (ReportName.Length >= 31)
                                        {
                                            ReportName = ReportName.Substring(0, 31);
                                        }
                                        //sheet = book.Worksheets.Add(ReportName);
                                        //sheet.Table.DefaultRowHeight = 16F;

                                        DevExpress.Spreadsheet.Worksheet SheetAudit = workbook.Worksheets.Add(ReportName);
                                        SheetAudit.ActiveView.ShowGridlines = false;
                                        _Rowindex = 0;
                                        _Columnindex = 0;


                                        SheetAudit.Columns[0].Width = 180;
                                        SheetAudit.Columns[1].Width = 75;
                                        SheetAudit.Columns[2].Width = 50;
                                        SheetAudit.Columns[3].Width = 80;
                                        SheetAudit.Columns[4].Width = 80;
                                        SheetAudit.Columns[5].Width = 80;
                                        SheetAudit.Columns[6].Width = 80;
                                        SheetAudit.Columns[7].Width = 80;
                                        SheetAudit.Columns[8].Width = 145;
                                        SheetAudit.Columns[9].Width = 145;
                                        //SheetAudit.Columns[10].Width = 145;


                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = dataAudit.Rows[0]["SP_Desc"].ToString();
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = xPageTitleCellstyle;
                                        xlRowsMerge(SheetAudit, _Rowindex, _Columnindex, 10);


                                        _Rowindex++;
                                        _Columnindex = 0;
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Description";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                        _Columnindex++;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Date";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                        _Columnindex++;

                                        if (rbQuaterly.Checked)
                                        {
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Q#";
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                            _Columnindex++;
                                        }
                                        else
                                        {
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Value = "M#";
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                            _Columnindex++;
                                        }

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                        _Columnindex++;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Total Clients";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                        _Columnindex++;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Detail Amt.";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                        _Columnindex++;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Total Amt.";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                        _Columnindex++;


                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "App No";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                        _Columnindex++;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Name";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                        _Columnindex++;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Case Worker";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                        _Columnindex++;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Site";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                        _Columnindex++;

                                        int i = 0;
                                        string QM_type = string.Empty;
                                        int QM_Count = 0;
                                        string Serv = string.Empty;
                                        string PrivClID = string.Empty;
                                        int PrvCnt = 0;
                                        foreach (DataRow dr in dataAudit.Rows)
                                        {
                                            // Row0 = sheet.Table.Rows.Add();


                                            string CAMSType = string.Empty;
                                            if (dr["SP2_TYPE"].ToString().Trim() == "CA")
                                                CAMSType = "Service";
                                            else
                                                CAMSType = "Outcome";

                                            //DataRow[] selrow1;
                                            //if (rbQuaterly.Checked)
                                            //    selrow1 = dataAudit.Select("Q_SEC='" + dr["Q_SEC"].ToString() + "' AND Client_ID='" + dr["Client_ID"].ToString() + "' AND CAMS_CODE='" + dr["CAMS_CODE"].ToString() + "'");
                                            //else
                                            //    selrow1 = dataAudit.Select("M_SEC='" + dr["M_SEC"].ToString() + "' AND Client_ID='" + dr["Client_ID"].ToString() + "' AND CAMS_CODE='" + dr["CAMS_CODE"].ToString() + "'");

                                            //if(selrow1!= null) 
                                            //{ 
                                            //    QM_Count++; dr["cnt"] = QM_Count; 
                                            //}

                                            if (rbQuaterly.Checked)
                                            {
                                                if (dr["Q_SEC"].ToString().Trim() != QM_type || dr["CAMS_CODE"].ToString().Trim() != Serv)
                                                {
                                                    i++;
                                                }
                                                //else if (PrivClID != dr["Client_ID"].ToString().Trim()) QM_Count++;
                                            }
                                            else
                                            {
                                                if (dr["M_SEC"].ToString().Trim() != QM_type || dr["CAMS_CODE"].ToString().Trim() != Serv)
                                                {
                                                    i++;
                                                }
                                                //else if (PrivClID != dr["Client_ID"].ToString().Trim()) QM_Count++;
                                            }

                                            if (rbQuaterly.Checked)
                                                QM_type = dr["Q_SEC"].ToString().Trim();
                                            else
                                                QM_type = dr["M_SEC"].ToString().Trim();

                                            Serv = dr["CAMS_CODE"].ToString().Trim();


                                            var x = (i % 2);



                                            _Rowindex++;
                                            _Columnindex = 0;
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Value = dr["CAMS_DESC"].ToString();
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                            _Columnindex++;

                                            if (Rb_MS_Date.Checked)
                                            {
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Value = LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString());

                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);

                                                _Columnindex++;
                                            }
                                            else
                                            {
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Value = LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString());
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                                _Columnindex++;
                                            }

                                            if (rbQuaterly.Checked)
                                            {
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Value = dr["Q_SEC"].ToString();
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                                _Columnindex++;
                                            }
                                            else
                                            {
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Value = dr["M_SEC"].ToString();
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                                _Columnindex++;
                                            }

                                            if (dr["Count_Type"].ToString().Trim() == "B" || dr["Count_Type"].ToString().Trim() == "C" || dr["Count_Type"].ToString().Trim() == "D")
                                            {
                                                if (dr["CASEMS_COST"].ToString() != "")
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["CASEMS_COST"].ToString());
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_NRC : oDevExpress_Excel_Properties.gxlDeci_GRC);
                                                _Columnindex++;

                                                if (dr["TotCnt"].ToString() != "")
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["TotCnt"].ToString());
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_NRC : oDevExpress_Excel_Properties.gxlDeci_GRC);
                                                _Columnindex++;

                                                //SheetAudit.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                                _Columnindex++;

                                                //SheetAudit.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                                _Columnindex++;
                                            }
                                            else if (dr["Count_Type"].ToString().Trim() == "S" || dr["Count_Type"].ToString().Trim() == "A" || dr["Count_Type"].ToString().Trim() == "E")
                                            {
                                                //SheetAudit.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                                _Columnindex++;

                                                //SheetAudit.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                                _Columnindex++;

                                                if (dr["CASEMS_COST"].ToString() != "")
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["CASEMS_COST"].ToString());
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_NRC : oDevExpress_Excel_Properties.gxlDeci_GRC);
                                                _Columnindex++;

                                                if (dr["TotCnt"].ToString() != "")
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["TotCnt"].ToString());
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_NRC : oDevExpress_Excel_Properties.gxlDeci_GRC);
                                                _Columnindex++;
                                            }
                                            else
                                            {
                                                if (dr["cnt"].ToString() != "")
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["cnt"].ToString());
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNumb_NRC : oDevExpress_Excel_Properties.gxlNumb_GRC);
                                                _Columnindex++;

                                                if (!string.IsNullOrEmpty(dr["TotCnt"].ToString().Trim()))
                                                {
                                                    if (dr["cnt"].ToString() != "")
                                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["cnt"].ToString());
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNumb_NRC : oDevExpress_Excel_Properties.gxlNumb_GRC);
                                                    _Columnindex++;
                                                }
                                                else
                                                {
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Value = 0;
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNumb_NRC : oDevExpress_Excel_Properties.gxlNumb_GRC);
                                                    _Columnindex++;
                                                }

                                                if (dr["CASEMS_COST"].ToString() != "")
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["CASEMS_COST"].ToString());
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_NRC : oDevExpress_Excel_Properties.gxlDeci_GRC);
                                                _Columnindex++;

                                                if (dr["TotCnt"].ToString() != "")
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["TotCnt"].ToString());
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_NRC : oDevExpress_Excel_Properties.gxlDeci_GRC);
                                                _Columnindex++;

                                            }

                                            SheetAudit.Rows[_Rowindex][_Columnindex].Value = dr["AppNo"].ToString();
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                            _Columnindex++;

                                            SheetAudit.Rows[_Rowindex][_Columnindex].Value = dr["Name"].ToString();
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                            _Columnindex++;

                                            SheetAudit.Rows[_Rowindex][_Columnindex].Value = dr["CAMS_WORKER"].ToString();
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                            _Columnindex++;

                                            SheetAudit.Rows[_Rowindex][_Columnindex].Value = dr["CAMS_SITE"].ToString();
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                            _Columnindex++;


                                            PrivClID = dr["Client_ID"].ToString().Trim();
                                            PrvCnt = QM_Count;
                                        }
                                    }


                                }

                            }
                            #endregion
                        }


                        #region Agency Wide Report
                        if (rbAWRYes.Checked && dt.Rows.Count > 0)
                        {
                            string PriSP = string.Empty;

                            DevExpress.Spreadsheet.Worksheet SheetAgyWide = workbook.Worksheets.Add("Agency Wide Report");
                            SheetAgyWide.ActiveView.ShowGridlines = false;
                            _Rowindex = 0;
                            _Columnindex = 0;
                            //sheet = book.Worksheets.Add("Agency Wide Report");
                            //sheet.Table.DefaultRowHeight = 16.25F;

                            var distinctSPs = (from DataRow sps in dt.Rows
                                               select sps["SP0_SERVICECODE"]).Distinct();



                            SheetAgyWide.Columns[0].Width = 200;
                            SheetAgyWide.Columns[1].Width = 200;
                            SheetAgyWide.Columns[2].Width = 150;
                            SheetAgyWide.Columns[3].Width = 100;
                            SheetAgyWide.Columns[4].Width = 75;
                            SheetAgyWide.Columns[5].Width = 75;
                            SheetAgyWide.Columns[6].Width = 75;
                            if (rbAmtYes.Checked)
                                SheetAgyWide.Columns[7].Width = 75;

                            //sheet.Table.Columns.Add(200);
                            //sheet.Table.Columns.Add(200);
                            //sheet.Table.Columns.Add(150);
                            //sheet.Table.Columns.Add(100);
                            //sheet.Table.Columns.Add(75);
                            //sheet.Table.Columns.Add(75);
                            //sheet.Table.Columns.Add(75);
                            //if (rbAmtYes.Checked)
                            //    sheet.Table.Columns.Add(75);


                            //Row0 = sheet.Table.Rows.Add();
                            //Row0.AutoFitHeight = false;
                            ////WorksheetCell cell;
                            //cell = Row0.Cells.Add();
                            //Row0.Height = 20;
                            //cell.StyleID = "s83";
                            //cell.Data.Type = DataType.String;
                            //cell.Data.Text = "Agency Wide Report";

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "Agency Wide Report";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xPageTitleCellstyle;// oDevExpress_Excel_Properties.gxlNLHC;
                            xlRowsMerge(SheetAgyWide, _Rowindex, _Columnindex, 8);
                            //cell.MergeAcross = 6;
                            _Rowindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "Service Plan";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                            _Columnindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "Description";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                            _Columnindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "Aggregate Func.";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                            _Columnindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "Type";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                            _Columnindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "Target";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                            _Columnindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "YTD";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                            _Columnindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "YTD %";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                            _Columnindex++;



                            if (rbAmtYes.Checked)
                            {
                                SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "Total Amount";
                                SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                _Columnindex++;
                            }

                            foreach (var sps in distinctRows)
                            {
                                DataTable AgyTable = new DataTable();
                                DataView dv1 = new DataView(dt);
                                dv1.RowFilter = "SP0_SERVICECODE='" + sps + "'";
                                AgyTable = dv1.ToTable();

                                if (AgyTable.Rows.Count > 0)
                                {

                                    if (PrivSP != AgyTable.Rows[0]["SP0_DESCRIPTION"].ToString().Trim() && PrivSP != "")
                                        _Rowindex++;
                                    _Columnindex = 0;//Row0 = sheet.Table.Rows.Add();

                                    int j = 0;
                                    foreach (DataRow drsp in AgyTable.Rows)
                                    {
                                        //Row0 = sheet.Table.Rows.Add();
                                        _Rowindex++;
                                        _Columnindex = 0;

                                        string CAMSType = string.Empty;
                                        if (drsp["SP2_TYPE"].ToString().Trim() == "CA")
                                            CAMSType = "Service";
                                        else
                                            CAMSType = "Outcome";

                                        string Ytd = string.Empty;
                                        int totcnt = 0;
                                        double TotalAmount = 0;
                                        if (string.IsNullOrEmpty(drsp["SP2_COUNT_TYPE"].ToString().Trim()))
                                        {
                                            int Q1 = 0, Q2 = 0, Q3 = 0, Q4 = 0;
                                            double Q1Amt = 0, Q2Amt = 0, Q3Amt = 0, Q4Amt = 0;
                                            if (rbQuaterly.Checked)
                                            {
                                                if (!string.IsNullOrEmpty(drsp["Q1_Cnt"].ToString().Trim()))
                                                    Q1 = int.Parse(drsp["Q1_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["Q2_Cnt"].ToString().Trim()))
                                                    Q2 = int.Parse(drsp["Q2_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["Q3_Cnt"].ToString().Trim()))
                                                    Q3 = int.Parse(drsp["Q3_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["Q4_Cnt"].ToString().Trim()))
                                                    Q4 = int.Parse(drsp["Q4_Cnt"].ToString().Trim());
                                                totcnt = Q1 + Q2 + Q3 + Q4;

                                                if (!string.IsNullOrEmpty(drsp["Q1"].ToString().Trim()))
                                                    Q1Amt = double.Parse(drsp["Q1"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["Q2"].ToString().Trim()))
                                                    Q2Amt = double.Parse(drsp["Q2"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["Q3"].ToString().Trim()))
                                                    Q3Amt = double.Parse(drsp["Q3"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["Q4"].ToString().Trim()))
                                                    Q4Amt = double.Parse(drsp["Q4"].ToString().Trim());
                                                TotalAmount = Q1Amt + Q2Amt + Q3Amt + Q4Amt;

                                            }
                                            else
                                            {
                                                int M1 = 0, M2 = 0, M3 = 0, M4 = 0, M5 = 0, M6 = 0, M7 = 0, M8 = 0, M9 = 0, M10 = 0, M11 = 0, M12 = 0;
                                                double M1Amt = 0, M2Amt = 0, M3Amt = 0, M4Amt = 0, M5Amt = 0, M6Amt = 0, M7Amt = 0, M8Amt = 0, M9Amt = 0, M10Amt = 0,
                                                    M11Amt = 0, M12Amt = 0;

                                                if (!string.IsNullOrEmpty(drsp["M1_MEM"].ToString().Trim()))
                                                    M1 = int.Parse(drsp["M1_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M2_MEM"].ToString().Trim()))
                                                    M2 = int.Parse(drsp["M2_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M3_MEM"].ToString().Trim()))
                                                    M3 = int.Parse(drsp["M3_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M4_MEM"].ToString().Trim()))
                                                    M4 = int.Parse(drsp["M4_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M5_MEM"].ToString().Trim()))
                                                    M5 = int.Parse(drsp["M5_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M6_MEM"].ToString().Trim()))
                                                    M6 = int.Parse(drsp["M6_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M7_MEM"].ToString().Trim()))
                                                    M7 = int.Parse(drsp["M7_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M8_MEM"].ToString().Trim()))
                                                    M8 = int.Parse(drsp["M8_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M9_MEM"].ToString().Trim()))
                                                    M9 = int.Parse(drsp["M9_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M10_MEM"].ToString().Trim()))
                                                    M10 = int.Parse(drsp["M10_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M11_MEM"].ToString().Trim()))
                                                    M11 = int.Parse(drsp["M11_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M12_MEM"].ToString().Trim()))
                                                    M12 = int.Parse(drsp["M12_MEM"].ToString().Trim());
                                                totcnt = M1 + M2 + M3 + M4 + M5 + M6 + M7 + M8 + M9 + M10 + M11 + M12;

                                                if (!string.IsNullOrEmpty(drsp["M1"].ToString().Trim()))
                                                    M1Amt = double.Parse(drsp["M1"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M2"].ToString().Trim()))
                                                    M2Amt = double.Parse(drsp["M2"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M3"].ToString().Trim()))
                                                    M3Amt = double.Parse(drsp["M3"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M4"].ToString().Trim()))
                                                    M4Amt = double.Parse(drsp["M4"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M5"].ToString().Trim()))
                                                    M5Amt = double.Parse(drsp["M5"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M6"].ToString().Trim()))
                                                    M6Amt = double.Parse(drsp["M6"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M7"].ToString().Trim()))
                                                    M7Amt = double.Parse(drsp["M7"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M8"].ToString().Trim()))
                                                    M8Amt = double.Parse(drsp["M8"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M9"].ToString().Trim()))
                                                    M9Amt = double.Parse(drsp["M9"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M10"].ToString().Trim()))
                                                    M10Amt = double.Parse(drsp["M10"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M11"].ToString().Trim()))
                                                    M11Amt = double.Parse(drsp["M11"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M12"].ToString().Trim()))
                                                    M12Amt = double.Parse(drsp["M12"].ToString().Trim());
                                                TotalAmount = M1Amt + M2Amt + M3Amt + M4Amt + M5Amt + M6Amt + M7Amt + M8Amt + M9Amt + M10Amt + M11Amt + M12Amt;

                                            }
                                        }

                                        if (drsp["TARGET_VAL"].ToString() != "0")
                                        {
                                            if (!string.IsNullOrEmpty(drsp["SP2_COUNT_TYPE"].ToString().Trim()))
                                            {
                                                decimal percent = (decimal.Parse(drsp["YTD"].ToString().Trim() == string.Empty ? "0" : drsp["YTD"].ToString().Trim()) / decimal.Parse(drsp["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : drsp["TARGET_VAL"].ToString().Trim())) * 100;

                                                Ytd = percent.ToString("0.00");
                                            }
                                            else
                                            {

                                                decimal percent = (decimal.Parse(totcnt.ToString().Trim() == string.Empty ? "0" : totcnt.ToString().Trim()) / decimal.Parse(drsp["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : drsp["TARGET_VAL"].ToString().Trim())) * 100;

                                                Ytd = percent.ToString("0.00");
                                            }
                                        }

                                        string CntType = string.Empty;
                                        if (drsp["SP2_COUNT_TYPE"].ToString() == "A")
                                            CntType = "Amount - Average";
                                        else if (drsp["SP2_COUNT_TYPE"].ToString() == "S")
                                            CntType = "Amount - Sum";
                                        else if (drsp["SP2_COUNT_TYPE"].ToString() == "E")
                                            CntType = "Amount - End of Month";
                                        else if (drsp["SP2_COUNT_TYPE"].ToString() == "C")
                                            CntType = "Client - Average";
                                        else if (drsp["SP2_COUNT_TYPE"].ToString() == "B")
                                            CntType = "Client - Sum";
                                        else if (drsp["SP2_COUNT_TYPE"].ToString() == "D")
                                            CntType = "Client - End of Month";

                                        //if (j % 2 == 0)
                                        //{
                                        if (j == 0)
                                        {
                                            //cell = Row0.Cells.Add(AgyTable.Rows[0]["SP0_DESCRIPTION"].ToString(), DataType.String, "s105");

                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = AgyTable.Rows[0]["SP0_DESCRIPTION"].ToString();
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLC_bo; //xPageTitleCellstyle;//
                                            _Columnindex++;
                                            //  _Rowindex++;
                                        }
                                        else
                                        {
                                            //cell = Row0.Cells.Add("", DataType.String, "s105");
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";// AgyTable.Rows[0]["SP0_DESCRIPTION"].ToString();
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLC_bo;
                                            _Columnindex++;
                                            // _Rowindex++;
                                        }
                                        //cell = Row0.Cells.Add(drsp["CAMS_DESC"].ToString(), DataType.String, "s105");
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = drsp["CAMS_DESC"].ToString();
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                                        _Columnindex++;

                                        //cell = Row0.Cells.Add(CntType, DataType.String, "s105");
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = CntType;
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                                        _Columnindex++;

                                        //cell = Row0.Cells.Add(CAMSType, DataType.String, "s105");
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = CAMSType;
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                                        _Columnindex++;

                                        //cell = Row0.Cells.Add(drsp["TARGET_VAL"].ToString(), DataType.String, "s106");
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(drsp["TARGET_VAL"].ToString());
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_NRC;
                                        _Columnindex++;

                                        if (!string.IsNullOrEmpty(drsp["SP2_COUNT_TYPE"].ToString().Trim()))
                                        {
                                            // cell = Row0.Cells.Add(drsp["SP2_COUNT_TYPE"].ToString() == "A" ? drsp["YTD"].ToString() + "%" : drsp["YTD"].ToString(), DataType.String, "s106");

                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = drsp["SP2_COUNT_TYPE"].ToString() == "A" ? drsp["YTD"].ToString() + "%" : drsp["YTD"].ToString();
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                                            _Columnindex++;
                                        }
                                        else
                                        {
                                            //cell = Row0.Cells.Add(totcnt.ToString(), DataType.String, "s106");
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(totcnt.ToString());
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_NRC;
                                            _Columnindex++;
                                        }
                                        //cell = Row0.Cells.Add(Ytd == string.Empty ? "" : Ytd + "%", DataType.String, "s106");
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = Ytd == string.Empty ? "" : Ytd + "%";
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNRC;
                                        _Columnindex++;

                                        if (rbAmtYes.Checked)
                                        {
                                            // cell = Row0.Cells.Add(TotalAmount.ToString("0.00"), DataType.String, "s106");

                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(TotalAmount);
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_NRC;
                                            _Columnindex++;
                                        }
                                        //}
                                        //else
                                        //{
                                        //    //if(j==1)
                                        //    //    cell = Row0.Cells.Add(AgyTable.Rows[0]["SP0_DESCRIPTION"].ToString(), DataType.String, "s95");
                                        //    //else
                                        //    cell = Row0.Cells.Add("", DataType.String, "s95");
                                        //    cell = Row0.Cells.Add(drsp["CAMS_DESC"].ToString(), DataType.String, "s95");
                                        //    cell = Row0.Cells.Add(CntType, DataType.String, "s95");
                                        //    cell = Row0.Cells.Add(CAMSType, DataType.String, "s95");
                                        //    cell = Row0.Cells.Add(drsp["TARGET_VAL"].ToString(), DataType.String, "s95RC");
                                        //    if (!string.IsNullOrEmpty(drsp["SP2_COUNT_TYPE"].ToString().Trim()))
                                        //        cell = Row0.Cells.Add(drsp["SP2_COUNT_TYPE"].ToString() == "A" ? drsp["YTD"].ToString() + "%" : drsp["YTD"].ToString(), DataType.String, "s95RC");
                                        //    else cell = Row0.Cells.Add(totcnt.ToString(), DataType.String, "s95RC");
                                        //    cell = Row0.Cells.Add(Ytd == string.Empty ? "" : Ytd + "%", DataType.String, "s95RC");
                                        //    if (rbAmtYes.Checked)
                                        //        cell = Row0.Cells.Add(TotalAmount.ToString("0.00"), DataType.String, "s106");
                                        //}
                                        j++;
                                    }
                                    PrivSP = AgyTable.Rows[0]["SP0_DESCRIPTION"].ToString().Trim();

                                }


                            }


                        }

                        #endregion
                        #endregion
                    }

                    //ParamsSheet.ActiveView.IsSelected = true;
                    workbook.Sheets.ActiveSheet = ParamsSheet;
                    // Save the document file under the specified name.
                    workbook.SaveDocument(_excelPath, DevExpress.Spreadsheet.DocumentFormat.OpenXml);
                    try
                    {
                        string localFilePath = _excelPath;
                        /// Need to check for null value of localFilePath, etc...
                        FileInfo fiDownload = new FileInfo(localFilePath);
                        /// Need to check for file exists, is local file, is allow to read, etc...
                        string name = fiDownload.Name;
                        using (FileStream fileStream = fiDownload.OpenRead())
                        {
                            Application.Download(fileStream, name);
                        }

                        if (Rb_Details_Yes.Checked && Rb_SP_All.Checked)
                        {
                            if (dtAudit.Rows.Count > 0)
                                On_SaveExcelAudit_Closed_kv(_excelPath);
                        }
                    }
                    catch (Exception ex)
                    {
                    }
                    //System.Diagnostics.Process.Start(_excelPath);
                }

                #endregion

            }
        }
        private void On_SaveExcelAudit_Closed_kv(string PdfFileName)
        {
            string strAppno = "";
            string SPCode = "";
            try
            {
                Random_Filename = null;
                string PdfName = "Pdf File";
                PdfName = PdfFileName.Replace(".xlsx", "_Audit.xlsx"); //propReportPath + BaseForm.UserID + "\\" + PdfFileName + "_Audit";
                try
                {
                    if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                    {
                        DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim());
                    }
                }
                catch (Exception ex)
                {
                    CommonFunctions.MessageBoxDisplay("Error");
                }

                try
                {
                    string Tmpstr = PdfName;//+ ".xlsx";
                    if (File.Exists(Tmpstr))
                        File.Delete(Tmpstr);
                }
                catch (Exception ex)
                {
                    int length = 8;
                    string newFileName = System.Guid.NewGuid().ToString();
                    newFileName = newFileName.Replace("-", string.Empty);

                    Random_Filename = PdfName + newFileName.Substring(0, length) + ".xls";
                }

                if (!string.IsNullOrEmpty(Random_Filename))
                    PdfName = Random_Filename;
                //else
                //    PdfName += ".xls";

                using (DevExpress.Spreadsheet.Workbook workbook = new DevExpress.Spreadsheet.Workbook())
                {
                    bool First = true;
                    string MS_Type = string.Empty;
                    string CAMSDesc = null;
                    string Branch = null, Priv_Branch = null, SP_Plan_desc = null;
                    bool SPNum = true;
                    Worksheet sheet;
                    WorksheetCell cell;
                    WorksheetRow Row0;
                    int Count = 1;
                    if (dtAudit.Rows.Count > 0)
                    {
                        #region Excel Cell Styles

                        /********************** SET EXCEL FONT PROPERTIES ******************************/
                        DevExpress_Excel_Properties oDevExpress_Excel_Properties = new DevExpress_Excel_Properties();
                        oDevExpress_Excel_Properties.sxlbook = workbook;
                        oDevExpress_Excel_Properties.sxlTitleFont = "Trebuchet MS";
                        oDevExpress_Excel_Properties.sxlbodyFont = "calibri";
                        /*******************************************************************************/
                        oDevExpress_Excel_Properties.getDevexpress_Excel_Properties();

                        #region Custom Styles
                        DevExpress.Spreadsheet.Style xTitleCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 20, "#002060", true, "#ffffff", "center", 1, 1, 1, 1, 1, "Thin", "#F8F9D0", "");
                        DevExpress.Spreadsheet.Style xTitleCellstyle2 = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 14, "#0070C0", true, "#EEF5FC", "center", 1, 1, 1, 1, 1, "Thin", "#FFFFFF", "");
                        DevExpress.Spreadsheet.Style xsubTitleintakeCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 10, "#0070C0", true, "#F8FBFE", "center", 1, 1, 1, 1, 1, "Thin", "#F8F9D0", "");
                        DevExpress.Spreadsheet.Style xPageTitleCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 16, "#002060", true, "#ffffff", "center", 1, 1, 1, 1, 1, "Thin", "#F8F9D0", "");
                        DevExpress.Spreadsheet.Style reportNameStyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 16, "#002060", true, "#CFE6F9", "center", 1, 1, 1, 1, 1, "Thin", "#FFFFFF", "");
                        DevExpress.Spreadsheet.Style paramsCellStyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", false, "#EEF5FC", "left", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "");

                        DevExpress.Spreadsheet.Style xAgyHeaderCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#FFFFFF", true, "#305496", "left", 1, 1, 1, 1, 1, "Thin", "#305496", "");
                        DevExpress.Spreadsheet.Style xAgyIntakeHeaderCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#FFFFFF", true, "#30963e", "left", 1, 1, 1, 1, 1, "Thin", "#30963e", "");
                        DevExpress.Spreadsheet.Style gxlBCC_sp_cr = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#d3e6f5", "center", 1, 1, 1, 1, 1, "Thin", "#d3e6f5", "");
                        DevExpress.Spreadsheet.Style gxlGCC_sp_cr = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#bee396", "center", 1, 1, 1, 1, 1, "Thin", "#bee396", "");


                        DevExpress.Spreadsheet.Style gxlLBC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 1, 0, 0, 0, "Thin", "#000000", "");
                        DevExpress.Spreadsheet.Style gxlTBC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 1, 0, 0, "Thin", "#000000", "");
                        DevExpress.Spreadsheet.Style gxlRBC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 0, 1, 0, "Thin", "#000000", "");
                        DevExpress.Spreadsheet.Style gxlBBC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 0, 0, 1, "Thin", "#000000", "");

                        DevExpress.Spreadsheet.Style gxlLTBCORN = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 1, 1, 0, 0, "Thin", "#000000", "");
                        DevExpress.Spreadsheet.Style gxlRTBCORN = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 1, 1, 0, "Thin", "#000000", "");
                        DevExpress.Spreadsheet.Style gxlLBBCORN = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 1, 0, 0, 1, "Thin", "#000000", "");
                        DevExpress.Spreadsheet.Style gxlRBBCORN = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 0, 1, 1, "Thin", "#000000", "");

                        DevExpress.Spreadsheet.Style gxlNLC_numeric = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 9, "#000000", false, "#FFFFFF", "left", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");
                        DevExpress.Spreadsheet.Style gxlNCC_numeric = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 9, "#000000", false, "#FFFFFF", "center", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");
                        DevExpress.Spreadsheet.Style gxlNRC_numeric = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 9, "#000000", false, "#FFFFFF", "right", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");

                        DevExpress.Spreadsheet.Style gxlErrBLC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#ebf7ff", "left", 1, 1, 1, 1, 1, "Thin", "#a6c9e8", "");
                        DevExpress.Spreadsheet.Style gxlErrNumb_NRC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "right", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");
                        DevExpress.Spreadsheet.Style gxlErrDeci_NRC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "right", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "D");
                        DevExpress.Spreadsheet.Style gxlGenerate_cr = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 11, "#0070C0", false, "#FFFFFF", "right", 0, 1, 1, 1, 1, "Thin", "#d3e6f5", "");
                        DevExpress.Spreadsheet.Style gxlGenerate_lr = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 10, "#0070C0", false, "#FFFFFF", "left", 0, 1, 1, 1, 1, "Thin", "#d3e6f5", "");

                        #endregion

                        #endregion
                        DevExpress.Spreadsheet.Worksheet ParamsSheet = workbook.Worksheets[0];
                        //this.GenerateWorksheetParameters(book.Worksheets);

                        #region Parameters Sheet

                        ParamsSheet.Name = "Parameters";
                        ParamsSheet.ActiveView.ShowGridlines = false;

                        ParamsSheet.Columns[1].Width = 200;
                        ParamsSheet.Columns[2].Width = 300;
                        ParamsSheet.Columns[3].Width = 200;
                        ParamsSheet.Columns[4].Width = 500;
                        ParamsSheet.Columns[5].Width = 200;
                        ParamsSheet.Columns[6].Width = 200;
                        ParamsSheet.Columns[7].Width = 200;
                        ParamsSheet.Columns[8].Width = 200;
                        ParamsSheet.Columns[9].Width = 600;

                        string strAgy = Current_Hierarchy_DB.Split('-')[0];

                        AgencyControlEntity BAgyControlDetails = _model.ZipCodeAndAgency.GetAgencyControlFile(strAgy);

                        string ImgName = "";
                        if (BaseForm.BaseAgencyControlDetails.AgyShortName == "NEOCAA")
                        {
                            ImgName = "NEOCAA_" + strAgy + "_LOGO.png";
                        }
                        else
                            ImgName = BaseForm.BaseAgencyControlDetails.AgyShortName + "_00_LOGO.png";

                        int _Rowindex = 1;
                        int _Columnindex = 1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = BAgyControlDetails.AgyName;// "Community Action Resource & Development";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = xTitleCellstyle; //  oDevExpress_Excel_Properties.gxlTitle_CellStyle1; //
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);
                        _Rowindex++;

                        string imagesPath = "https://capsysdev.capsystems.com/images/PIPlogos/" + ImgName;  // Application.MapPath("\\Resources\\Images\\NEOCAA_02_LOGO.png");
                                                                                                  //DevExpress.Spreadsheet.Picture pic = ParamsSheet.Pictures.AddPicture(imagesPath, 700, 80, 630, 280);
                        DevExpress.Spreadsheet.SpreadsheetImageSource imgsrc = DevExpress.Spreadsheet.SpreadsheetImageSource.FromUri(imagesPath, workbook);
                        DevExpress.Spreadsheet.Picture pic = ParamsSheet.Pictures.AddPicture(imgsrc, 200, 0, 630, 280);


                        AgencyControlEntity _agycntrldets = new AgencyControlEntity();
                        _agycntrldets = BaseForm.BaseAgencyControlDetails;

                        if (BaseForm.BaseAgencyControlDetails.AgyShortName == "NEOCAA")
                            _agycntrldets = BAgyControlDetails;
                        else
                            _agycntrldets = BaseForm.BaseAgencyControlDetails;

                        string strAddress = _agycntrldets.Street + ", " + _agycntrldets.City + ", " + _agycntrldets.State + ", " + _agycntrldets.Zip1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = strAddress;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);


                        _Rowindex = 4;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = PrivilegeEntity.PrivilegeName;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = reportNameStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);

                        _Rowindex = 5;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "Report Parameters";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = xTitleCellstyle2; // oDevExpress_Excel_Properties.gxlTitle_CellStyle1;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);
                        _Rowindex++;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = txtHieDesc.Text.Trim();
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = xsubTitleintakeCellstyle; // oDevExpress_Excel_Properties.gxlTitle_CellStyle1;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);
                        _Rowindex++;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "";
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);
                        _Rowindex++;

                        //** PARAMETERS LIST **//
                        string caseType = string.Empty;
                        caseType = ((Captain.Common.Utilities.ListItem)Cmb_CaseType.SelectedItem).Text.ToString().Trim();

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblCaseType.Text.Trim();
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        //ParamsSheet.Rows[_Rowindex][_Columnindex+1].Style = paramsCellStyle;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = caseType;
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;



                        string strSelectedSP = Search_Entity.ZipCode;
                        strSelectedSP = strSelectedSP.Replace("'", "");

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblServiceplan.Text;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (Rb_SP_All.Checked ? "All" : strSelectedSP);
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;
                        string caseStatus = Rb_Stat_Both.Text;

                        if (Rb_Stat_Act.Checked == true)
                            caseStatus = Rb_Stat_Act.Text;
                        else if (Rb_Stat_InAct.Checked == true)
                            caseStatus = Rb_Stat_InAct.Text;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblCaseStatus.Text;
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = caseStatus;
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;


                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblDateSelection.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (Rb_MS_Date.Checked == true ? Rb_MS_Date.Text : Rb_MS_AddDate.Text);
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);



                        _Rowindex++;
                        _Columnindex = 1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblRepDesc.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Text.ToString().Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;


                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblReportType.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (rbQuaterly.Checked == true ? rbQuaterly.Text : rbMonthly.Text);
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "Report Period Control";
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (chkbReportPeriod.Checked == true ? "Yes" : "No");
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;


                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblProduceStatistical.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (Rb_Details_No.Checked == true ? Rb_Details_No.Text : Rb_Details_Yes.Text);
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblPovertyLevel.Text.Trim();
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblLow.Text + ": " + Txt_Pov_Low.Text + "      " + lblHigh.Text + ": " + Txt_Pov_High.Text;
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;


                        string selectedCounty = Search_Entity.County;
                        selectedCounty = selectedCounty.Replace("'", "");

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblCounty.Text.Trim();
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (Rb_County_All.Checked ? "All" : selectedCounty);
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;
                        string secretApp = Rb_Mst_NonSec.Text;

                        if (Rb_Mst_Sec.Checked == true)
                            secretApp = Rb_Mst_Sec.Text;
                        else if (Rb_Mst_BothSec.Checked == true)
                            secretApp = Rb_Mst_BothSec.Text;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblSecretApplications.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = secretApp;
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblAmounts.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (rbAmtNo.Checked ? "No" : "Yes");
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblAgyWideRep.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (rbAWRNo.Checked ? "No" : "Yes");
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "";
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "";
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex = _Rowindex + 3;
                        _Columnindex = 8;//9;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "Generated By: " + BaseForm.UserID;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = gxlGenerate_lr;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2);
                        _Rowindex++;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "Generated On: " + DateTime.Now.ToString("MM/dd/yyyy hh:mm:ss tt");
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = gxlGenerate_lr;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2);
                        #endregion
                        string PrivSP = string.Empty;

                        var distinctRows = (from DataRow dRow in dtAudit.Rows
                                            select dRow["SP"]).Distinct();


                        _Rowindex = 0;
                        _Columnindex = 0;
                        workbook.Unit = DevExpress.Office.DocumentUnit.Point;
                        //string PrivSP = string.Empty;
                        foreach (var dRow in distinctRows)
                        {
                            SPCode = dRow.ToString();
                            DataTable dataTable = new DataTable();
                            DataView dv = new DataView(dtAudit);
                            dv.RowFilter = "SP='" + dRow + "'";
                            if (Rb_MS_Date.Checked)
                                dv.Sort = "CAMS_DATE";
                            else
                                dv.Sort = "CAMS_DATE_ADD";
                            dataTable = dv.ToTable();

                            if (dataTable.Rows.Count > 0)
                            {
                                string ReportName = dataTable.Rows[0]["SP_Desc"].ToString();
                                ReportName = ReportName.Replace("/", "");

                                if (ReportName.Length >= 31)
                                {
                                    ReportName = ReportName.Substring(0, 31);
                                }
                                //sheet = book.Worksheets.Add(ReportName);
                                //sheet.Table.DefaultRowHeight = 14.25F;

                                DevExpress.Spreadsheet.Worksheet SheetDetails = workbook.Worksheets.Add(ReportName);
                                SheetDetails.ActiveView.ShowGridlines = false;
                                _Rowindex = 0;
                                _Columnindex = 0;
                                workbook.Unit = DevExpress.Office.DocumentUnit.Point;


                                SheetDetails.Columns[0].Width = 200;//(180);
                                SheetDetails.Columns[1].Width = 75;
                                SheetDetails.Columns[2].Width = 50;
                                SheetDetails.Columns[3].Width = 80;
                                SheetDetails.Columns[4].Width = 80;
                                SheetDetails.Columns[5].Width = 80;
                                SheetDetails.Columns[6].Width = 80;
                                SheetDetails.Columns[7].Width = 80;//(145);
                                SheetDetails.Columns[8].Width = 145;
                                SheetDetails.Columns[9].Width = 145;

                                //Row0 = sheet.Table.Rows.Add();
                                //Row0.AutoFitHeight = false;
                                ////WorksheetCell cell;
                                //cell = Row0.Cells.Add();
                                //cell.StyleID = "s83";
                                //cell.Data.Type = DataType.String;
                                //cell.Data.Text = dataTable.Rows[0]["SP_Desc"].ToString();
                                //cell.MergeAcross = 10;//8;//7;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = dataTable.Rows[0]["SP_Desc"].ToString();
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = xPageTitleCellstyle;//oDevExpress_Excel_Properties.gxlNLHC;
                                xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 10);



                                // Row0 = sheet.Table.Rows.Add();
                                // Row0.Height = 20;


                                _Rowindex++;
                                _Columnindex = 0;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Description";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Date";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                _Columnindex++;


                                //cell = Row0.Cells.Add("Description", DataType.String, "MainHeaderStylesLeft");
                                //cell = Row0.Cells.Add("Date", DataType.String, "MainHeaderStylesLeft");
                                if (rbQuaterly.Checked)
                                {
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Q#";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;
                                }
                                //cell = Row0.Cells.Add("Q#", DataType.String, "MainHeaderStylesLeft");
                                else
                                {
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "M#";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                    _Columnindex++;
                                    //cell = Row0.Cells.Add("M#", DataType.String, "MainHeaderStylesLeft");
                                }

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Total Clients";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Detail Amt.";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Total Amt.";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                _Columnindex++;


                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "App No";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Name";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Case Worker";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Site";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlBLHC;
                                _Columnindex++;



                                //DataRow[] drS = dataTable.Select("AppNo='00000003'");
                                //if (drS.Length > 0)
                                //{
                                //    DataTable dtRS = drS.CopyToDataTable();
                                //}


                                int i = 0;
                                string QM_type = string.Empty;
                                int QM_Count = 0;
                                string Serv = string.Empty;
                                string PrivClID = string.Empty;
                                int PrvCnt = 0;
                                strAppno = "";
                                foreach (DataRow dr in dataTable.Rows)
                                {
                                    strAppno = dr["AppNo"].ToString();

                                    if (strAppno == "00000003")
                                    {
                                        string xx = "0";
                                    }
                                    //Row0 = sheet.Table.Rows.Add();
                                    //Row0.Height = 16;

                                    string CAMSType = string.Empty;
                                    if (dr["SP2_TYPE"].ToString().Trim() == "CA")
                                        CAMSType = "Service";
                                    else
                                        CAMSType = "Outcome";


                                    if (rbQuaterly.Checked)
                                    {
                                        if (dr["Q_SEC"].ToString().Trim() != QM_type || dr["CAMS_CODE"].ToString().Trim() != Serv)
                                        {
                                            i++;
                                        }
                                        //else if (PrivClID != dr["Client_ID"].ToString().Trim()) QM_Count++;
                                    }
                                    else
                                    {
                                        if (dr["M_SEC"].ToString().Trim() != QM_type || dr["CAMS_CODE"].ToString().Trim() != Serv)
                                        {
                                            i++;
                                        }
                                        //else if (PrivClID != dr["Client_ID"].ToString().Trim()) QM_Count++;
                                    }

                                    if (rbQuaterly.Checked)
                                        QM_type = dr["Q_SEC"].ToString().Trim();
                                    else
                                        QM_type = dr["M_SEC"].ToString().Trim();

                                    Serv = dr["CAMS_CODE"].ToString().Trim();

                                    var x = (i % 2);

                                    _Rowindex++;
                                    _Columnindex = 0;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["CAMS_DESC"].ToString();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                    _Columnindex++;

                                    if (Rb_MS_Date.Checked)
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                        _Columnindex++;

                                        //cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString()), DataType.String, "s110");
                                    }

                                    else
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                        _Columnindex++;
                                        //cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString()), DataType.String, "s110");
                                    }
                                    if (rbQuaterly.Checked)
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q_SEC"].ToString();
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                        _Columnindex++;
                                        //cell = Row0.Cells.Add(dr["Q_SEC"].ToString(), DataType.String, "s110");
                                    }
                                    else
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["M_SEC"].ToString();
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                        _Columnindex++;
                                        // cell = Row0.Cells.Add(dr["M_SEC"].ToString(), DataType.String, "s110");
                                    }

                                    if (dr["Count_Type"].ToString().Trim() == "B" || dr["Count_Type"].ToString().Trim() == "C" || dr["Count_Type"].ToString().Trim() == "D")
                                    {
                                        if (dr["CASEMS_COST"].ToString() != "")
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["CASEMS_COST"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_NRC : oDevExpress_Excel_Properties.gxlDeci_GRC);
                                        _Columnindex++;

                                        if (dr["TotCnt"].ToString() != "")
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["TotCnt"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_NRC : oDevExpress_Excel_Properties.gxlDeci_GRC);
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                        _Columnindex++;


                                    }
                                    else if (dr["Count_Type"].ToString().Trim() == "S" || dr["Count_Type"].ToString().Trim() == "A" || dr["Count_Type"].ToString().Trim() == "E")
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                        _Columnindex++;

                                        if (dr["CASEMS_COST"].ToString() != "")
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["CASEMS_COST"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_NRC : oDevExpress_Excel_Properties.gxlDeci_GRC);
                                        _Columnindex++;

                                        if (dr["TotCnt"].ToString() != "")
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["TotCnt"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_NRC : oDevExpress_Excel_Properties.gxlDeci_GRC);
                                        _Columnindex++;
                                    }
                                    else
                                    {
                                        if (dr["cnt"].ToString() != "")
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["cnt"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNumb_NRC : oDevExpress_Excel_Properties.gxlNumb_GRC);
                                        _Columnindex++;

                                        // cell = Row0.Cells.Add(dr["cnt"].ToString(), DataType.String, "s111");
                                        if (!string.IsNullOrEmpty(dr["TotCnt"].ToString().Trim()))
                                        {
                                            if (dr["cnt"].ToString() != "")
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["cnt"].ToString());
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNumb_NRC : oDevExpress_Excel_Properties.gxlNumb_GRC);
                                            _Columnindex++;
                                            // cell = Row0.Cells.Add(dr["cnt"].ToString(), DataType.String, "s111");
                                        }
                                        else
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = 0;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNumb_NRC : oDevExpress_Excel_Properties.gxlNumb_GRC);
                                            _Columnindex++;
                                            // cell = Row0.Cells.Add("", DataType.String, "s111");
                                        }

                                        if (dr["CASEMS_COST"].ToString() != "")
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["CASEMS_COST"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_NRC : oDevExpress_Excel_Properties.gxlDeci_GRC);
                                        _Columnindex++;

                                        if (dr["TotCnt"].ToString() != "")
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["TotCnt"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_NRC : oDevExpress_Excel_Properties.gxlDeci_GRC);
                                        _Columnindex++;
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["AppNo"].ToString();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Name"].ToString();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["CAMS_WORKER"].ToString();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["CAMS_SITE"].ToString();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNLC : oDevExpress_Excel_Properties.gxlGLC);
                                    _Columnindex++;

                                    PrivClID = dr["Client_ID"].ToString().Trim();
                                    PrvCnt = QM_Count;
                                }
                            }


                        }





                        //ParamsSheet.ActiveView.IsSelected = true;
                        workbook.Sheets.ActiveSheet = ParamsSheet;
                        // Save the document file under the specified name.
                        workbook.SaveDocument(PdfName, DevExpress.Spreadsheet.DocumentFormat.OpenXml);

                        try
                        {
                            string localFilePath = PdfName;
                            /// Need to check for null value of localFilePath, etc...
                            FileInfo fiDownload = new FileInfo(localFilePath);
                            /// Need to check for file exists, is local file, is allow to read, etc...
                            string name = fiDownload.Name;
                            using (FileStream fileStream = fiDownload.OpenRead())
                            {
                                Application.Download(fileStream, name);
                            }


                        }
                        catch (Exception ex)
                        {
                        }
                        AlertBox.Show("Audit Report Generated Successfully");
                    }
                }

            }
            catch (Exception ex)
            {
                string errMsg = strAppno + "  | SP:" + SPCode + "   " + ex.Message;
            }
        }

        #region Vikash added on 06/27/2024 - 06/28/2024 to Format the excel design as per "Service and Outcome Report" document

        private void On_SaveExcelForm_Closed_KV_Formatted(object sender, FormClosedEventArgs e)
        {
            Random_Filename = null;
            PdfListForm form = sender as PdfListForm;
            if (form.DialogResult == DialogResult.OK)
            {
                #region FileNameBuild
                /*************************************************************/
                Random_Filename = null;
                string xlFileName = form.GetFileName();
                xlFileName = propReportPath + BaseForm.UserID + "\\" + xlFileName;
                try
                {
                    if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                    {
                        DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim());
                    }
                }
                catch (Exception ex)
                {
                    CommonFunctions.MessageBoxDisplay("Error");
                }

                try
                {
                    string Tmpstr = xlFileName + ".xlsx";
                    if (File.Exists(Tmpstr))
                        File.Delete(Tmpstr);
                }
                catch (Exception ex)
                {
                    int length = 8;
                    string newFileName = System.Guid.NewGuid().ToString();
                    newFileName = newFileName.Replace("-", string.Empty);

                    Random_Filename = xlFileName + newFileName.Substring(0, length) + ".xlsx";
                }

                if (!string.IsNullOrEmpty(Random_Filename))
                    xlFileName = Random_Filename;
                else
                    xlFileName += ".xlsx";

                /*************************************************************/
                #endregion

                string _excelPath = xlFileName;
                string _pdfPath = Application.MapPath("\\Excelfiles\\INDIVAgencyVistSPRpt" + DateTime.Now.ToString("MMddyyyyhhss") + ".pdf");

                #region excelGeneration
                List<string> lstSheetNames = new List<string>();
                using (DevExpress.Spreadsheet.Workbook workbook = new DevExpress.Spreadsheet.Workbook())
                {

                    bool First = true;
                    string MS_Type = string.Empty;
                    string CAMSDesc = null;
                    string Branch = null, Priv_Branch = null, SP_Plan_desc = null;
                    bool SPNum = true;
                    Worksheet sheet;
                    WorksheetCell cell;
                    WorksheetRow Row0;
                    int Count = 1;

                    #region Excel Cell Styles

                    /********************** SET EXCEL FONT PROPERTIES ******************************/
                    DevExpress_Excel_Properties oDevExpress_Excel_Properties = new DevExpress_Excel_Properties();
                    oDevExpress_Excel_Properties.sxlbook = workbook;
                    oDevExpress_Excel_Properties.sxlTitleFont = "calibri";
                    oDevExpress_Excel_Properties.sxlbodyFont = "calibri";
                    /*******************************************************************************/
                    oDevExpress_Excel_Properties.getDevexpress_Excel_Properties();

                    #region Custom Styles

                    DevExpress.Spreadsheet.Style xTitleCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 20, "#002060", true, "#ffffff", "center", 1, 1, 1, 1, 1, "Thin", "#FFFFFF", "");//F8F9D0
                    DevExpress.Spreadsheet.Style xTitleCellstyle2 = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 14, "#0070C0", true, "#EEF5FC", "center", 1, 1, 1, 1, 1, "Thin", "#FFFFFF", "");
                    DevExpress.Spreadsheet.Style xsubTitleintakeCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 10, "#0070C0", true, "#F8FBFE", "center", 1, 1, 1, 1, 1, "Thin", "#F8F9D0", "");
                    DevExpress.Spreadsheet.Style xPageTitleCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 16, "#002060", true, "#ffffff", "center", 1, 1, 1, 1, 1, "Thin", "#F8F9D0", "");
                    DevExpress.Spreadsheet.Style reportNameStyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 16, "#002060", true, "#CFE6F9", "center", 1, 1, 1, 1, 1, "Thin", "#FFFFFF", "");
                    DevExpress.Spreadsheet.Style paramsCellStyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", false, "#EEF5FC", "left", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "");

                    DevExpress.Spreadsheet.Style xAgyHeaderCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#FFFFFF", true, "#305496", "left", 1, 1, 1, 1, 1, "Thin", "#305496", "");
                    DevExpress.Spreadsheet.Style xAgyIntakeHeaderCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#FFFFFF", true, "#30963e", "left", 1, 1, 1, 1, 1, "Thin", "#30963e", "");
                    DevExpress.Spreadsheet.Style gxlBCC_sp_cr = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#d3e6f5", "center", 1, 1, 1, 1, 1, "Thin", "#d3e6f5", "");
                    DevExpress.Spreadsheet.Style gxlGCC_sp_cr = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#bee396", "center", 1, 1, 1, 1, 1, "Thin", "#bee396", "");


                    DevExpress.Spreadsheet.Style gxlLBC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 1, 0, 0, 0, "Thin", "#000000", "");
                    DevExpress.Spreadsheet.Style gxlTBC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 1, 0, 0, "Thin", "#000000", "");
                    DevExpress.Spreadsheet.Style gxlRBC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 0, 1, 0, "Thin", "#000000", "");
                    DevExpress.Spreadsheet.Style gxlBBC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 0, 0, 1, "Thin", "#000000", "");

                    DevExpress.Spreadsheet.Style gxlLTBCORN = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 1, 1, 0, 0, "Thin", "#000000", "");
                    DevExpress.Spreadsheet.Style gxlRTBCORN = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 1, 1, 0, "Thin", "#000000", "");
                    DevExpress.Spreadsheet.Style gxlLBBCORN = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 1, 0, 0, 1, "Thin", "#000000", "");
                    DevExpress.Spreadsheet.Style gxlRBBCORN = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 0, 1, 1, "Thin", "#000000", "");

                    DevExpress.Spreadsheet.Style gxlNLC_numeric = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 9, "#000000", false, "#FFFFFF", "left", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");
                    DevExpress.Spreadsheet.Style gxlNCC_numeric = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 9, "#000000", false, "#FFFFFF", "center", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");
                    DevExpress.Spreadsheet.Style gxlNRC_numeric = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 9, "#000000", false, "#FFFFFF", "right", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");

                    DevExpress.Spreadsheet.Style gxlErrBLC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#ebf7ff", "left", 1, 1, 1, 1, 1, "Thin", "#a6c9e8", "");

                    DevExpress.Spreadsheet.Style gxlErrBLCW = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "left", 1, 1, 1, 1, 1, "Thin", "#a6c9e8", "");

                    DevExpress.Spreadsheet.Style gxlErrBCC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "center", 1, 1, 1, 1, 1, "Thin", "#a6c9e8", "");

                    DevExpress.Spreadsheet.Style gxlErrNumb_NRC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "right", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");

                    DevExpress.Spreadsheet.Style gxlErrNumb_NCC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "center", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");

                    DevExpress.Spreadsheet.Style gxlErrDeci_NRC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "right", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "D");

                    DevExpress.Spreadsheet.Style gxlErrDeci_NCC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "center", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "D");

                    DevExpress.Spreadsheet.Style gxlGenerate_cr = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 11, "#0070C0", false, "#FFFFFF", "right", 0, 1, 1, 1, 1, "Thin", "#d3e6f5", "");
                    DevExpress.Spreadsheet.Style gxlGenerate_lr = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 10, "#0070C0", false, "#FFFFFF", "left", 0, 1, 1, 1, 1, "Thin", "#d3e6f5", "");


                    #region Vikash added following Styles for formatting

                    DevExpress.Spreadsheet.Style xlFrameStyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 12, "#FFFFFF", false, "#1A4777", "left", 1, 1, 1, 1, 1, "Thin", "#1A4777", "");
                    DevExpress.Spreadsheet.Style xlFrameStyleR = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 12, "#FFFFFF", false, "#1A4777", "right", 1, 1, 1, 1, 1, "Thin", "#1A4777", "");
                    DevExpress.Spreadsheet.Style xlFrameBlockStyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 12, "#1A4777", true, "#b8d9ff", "center", 1, 1, 1, 1, 1, "Thin", "#b8d9ff", "");
                    DevExpress.Spreadsheet.Style xlFrameBlockStyleLeft = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 12, "#1A4777", true, "#b8d9ff", "left", 1, 1, 1, 1, 1, "Thin", "#b8d9ff", "");
                    DevExpress.Spreadsheet.Style xlFrameFooterStyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#FFFFFF", false, "#1A4777", "right", 1, 1, 1, 1, 1, "Thin", "#1A4777", "");

                    DevExpress.Spreadsheet.Style gxlErrBCC_blueBorders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "center", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "");
                    DevExpress.Spreadsheet.Style gxlErrNumb_NCC_blueBorders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "center", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "N");
                    DevExpress.Spreadsheet.Style gxlErrDeci_NCC_blueBorders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "center", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "D");
                    DevExpress.Spreadsheet.Style gxlErrBLCW_blueBorders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "left", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "");

                    DevExpress.Spreadsheet.Style gxlGLC_blueBorders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", false, "#f0ffff", "left", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "");
                    DevExpress.Spreadsheet.Style gxlGRC_blueBorders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", false, "#f0ffff", "right", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "");
                    DevExpress.Spreadsheet.Style gxlDeci_GRC_blueBorders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", false, "#f0ffff", "right", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "D");
                    DevExpress.Spreadsheet.Style gxlNumb_GRC_blueBorders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", false, "#f0ffff", "right", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "N");

                    #endregion

                    #endregion

                    #endregion

                    DevExpress.Spreadsheet.Worksheet ParamsSheet = workbook.Worksheets[0];
                    if (dt.Rows.Count > 0)
                    {
                        #region Parameters Sheet

                        ParamsSheet.Name = "Parameters";
                        ParamsSheet.ActiveView.ShowGridlines = false;

                        ParamsSheet.Columns[1].Width = 200;
                        ParamsSheet.Columns[2].Width = 300;
                        ParamsSheet.Columns[3].Width = 200;
                        ParamsSheet.Columns[4].Width = 500;
                        ParamsSheet.Columns[5].Width = 200;
                        ParamsSheet.Columns[6].Width = 200;
                        ParamsSheet.Columns[7].Width = 230;//200;
                        ParamsSheet.Columns[8].Width = 200;
                        ParamsSheet.Columns[9].Width = 600;

                        string strAgy = Current_Hierarchy_DB.Split('-')[0];

                        AgencyControlEntity BAgyControlDetails = _model.ZipCodeAndAgency.GetAgencyControlFile(strAgy);

                        string ImgName = "";
                        if (BaseForm.BaseAgencyControlDetails.AgyShortName == "NEOCAA")
                        {
                            ImgName = "NEOCAA_" + strAgy + "_LOGO.png";
                        }
                        else
                            ImgName = BaseForm.BaseAgencyControlDetails.AgyShortName + "_00_LOGO.png";

                        int _Rowindex = 1;
                        int _Columnindex = 1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = BAgyControlDetails.AgyName;// "Community Action Resource & Development";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = xTitleCellstyle; //  oDevExpress_Excel_Properties.gxlTitle_CellStyle1; //
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);
                        _Rowindex++;

                        string imagesPath = "https://capsysdev.capsystems.com/images/PIPlogos/" + ImgName;  // Application.MapPath("\\Resources\\Images\\NEOCAA_02_LOGO.png");
                        //DevExpress.Spreadsheet.Picture pic = ParamsSheet.Pictures.AddPicture(imagesPath, 700, 80, 630, 280);
                        DevExpress.Spreadsheet.SpreadsheetImageSource imgsrc = DevExpress.Spreadsheet.SpreadsheetImageSource.FromUri(imagesPath, workbook);
                        DevExpress.Spreadsheet.Picture pic = ParamsSheet.Pictures.AddPicture(imgsrc, 200, 0, 630, 280);

                        AgencyControlEntity _agycntrldets = new AgencyControlEntity();
                         _agycntrldets   = BaseForm.BaseAgencyControlDetails;

                        if (BaseForm.BaseAgencyControlDetails.AgyShortName == "NEOCAA")
                            _agycntrldets = BAgyControlDetails;// BaseForm.BaseAgencyControlDetails;
                        else
                            _agycntrldets = BaseForm.BaseAgencyControlDetails; 

                        string strStreet = (_agycntrldets.Street != "" ? _agycntrldets.Street + ", " : "");
                        string strCity = (_agycntrldets.City != "" ? _agycntrldets.City + ", " : "");
                        string strState = (_agycntrldets.State != "" ? _agycntrldets.State + ", " : "");
                        string strZipcode = (_agycntrldets.Zip1 != "" ? _agycntrldets.Zip1 + "" : "");

                        string strAddress = strStreet + strCity + strState + strZipcode; //_agycntrldets.Street + ", " + _agycntrldets.City + ", " + _agycntrldets.State + ", " + _agycntrldets.Zip1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = strAddress.Trim().TrimEnd(',');
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);

                        _Rowindex = 4;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = PrivilegeEntity.PrivilegeName;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = reportNameStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);

                        _Rowindex = 5;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "Report Parameters";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = xTitleCellstyle2; // oDevExpress_Excel_Properties.gxlTitle_CellStyle1;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);
                        _Rowindex++;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = txtHieDesc.Text.Trim();
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = xsubTitleintakeCellstyle; // oDevExpress_Excel_Properties.gxlTitle_CellStyle1;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);
                        _Rowindex++;


                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "";
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);
                        _Rowindex++;

                        //** PARAMETERS LIST **//
                        string caseType = string.Empty;
                        caseType = ((Captain.Common.Utilities.ListItem)Cmb_CaseType.SelectedItem).Text.ToString().Trim();

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblCaseType.Text.Trim();
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLHC;
                        //ParamsSheet.Rows[_Rowindex][_Columnindex+1].Style = oDevExpress_Excel_Properties.gxlNLHC;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = caseType;
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;



                        string strSelectedSP = Search_Entity.ZipCode;
                        strSelectedSP = strSelectedSP.Replace("'", "");

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblServiceplan.Text;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (Rb_SP_All.Checked ? "All" : strSelectedSP);
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;
                        string caseStatus = Rb_Stat_Both.Text;

                        if (Rb_Stat_Act.Checked == true)
                            caseStatus = Rb_Stat_Act.Text;
                        else if (Rb_Stat_InAct.Checked == true)
                            caseStatus = Rb_Stat_InAct.Text;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblCaseStatus.Text;
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = caseStatus;
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;


                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblDateSelection.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (Rb_MS_Date.Checked == true ? Rb_MS_Date.Text : Rb_MS_AddDate.Text);
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);



                        _Rowindex++;
                        _Columnindex = 1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblRepDesc.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Text.ToString().Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;


                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblReportType.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (rbQuaterly.Checked == true ? rbQuaterly.Text : rbMonthly.Text);
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "Report Period Control";
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (chkbReportPeriod.Checked == true ? "Yes" : "No");
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;


                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblProduceStatistical.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (Rb_Details_No.Checked == true ? Rb_Details_No.Text : Rb_Details_Yes.Text);
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblPovertyLevel.Text.Trim();
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblLow.Text + ": " + Txt_Pov_Low.Text + "      " + lblHigh.Text + ": " + Txt_Pov_High.Text;
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;


                        string selectedCounty = Search_Entity.County;
                        selectedCounty = selectedCounty.Replace("'", "");

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblCounty.Text.Trim();
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (Rb_County_All.Checked ? "All" : selectedCounty);
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;
                        string secretApp = Rb_Mst_NonSec.Text;

                        if (Rb_Mst_Sec.Checked == true)
                            secretApp = Rb_Mst_Sec.Text;
                        else if (Rb_Mst_BothSec.Checked == true)
                            secretApp = Rb_Mst_BothSec.Text;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblSecretApplications.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = secretApp;
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblAmounts.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (rbAmtNo.Checked ? "No" : "Yes");
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblAgyWideRep.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (rbAWRNo.Checked ? "No" : "Yes");
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblOutCounCntrl.Text.Trim();//"";
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        string selectedResults = Search_Entity.Results;
                        selectedResults = selectedResults.Replace("'", "");

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (rdbOCC_All.Checked ? "All" : selectedResults);//"";
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex = _Rowindex + 3;
                        _Columnindex = 8;//9;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "Generated By: " + BaseForm.UserID;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = gxlGenerate_lr;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2);
                        _Rowindex++;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "Generated On: " + DateTime.Now.ToString("MM/dd/yyyy hh:mm:ss tt");
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = gxlGenerate_lr;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2);

                        ParamsSheet.IgnoredErrors.Add(ParamsSheet.GetDataRange(), DevExpress.Spreadsheet.IgnoredErrorType.NumberAsText);
                        #endregion

                        #region Other Sheets
                        _Rowindex = 0;
                        _Columnindex = 0;

                        workbook.Unit = DevExpress.Office.DocumentUnit.Point;
                        string PrivSP = string.Empty;

                        DataTable dtHie_Color = new DataTable();
                        dtHie_Color.Columns.Add("Hierarchy", typeof(string));
                        dtHie_Color.Columns.Add("Department", typeof(string));
                        dtHie_Color.Columns.Add("Department Name", typeof(string));
                        dtHie_Color.Columns.Add("Color", typeof(string));

                        var distinctRows = (from DataRow dRow in dt.Rows select dRow["SP0_SERVICECODE"]).Distinct();
                        foreach (var dRow in distinctRows)
                        {
                            DataTable dataTable = new DataTable();
                            DataView dv = new DataView(dt);
                            dv.RowFilter = "SP0_SERVICECODE='" + dRow + "'";
                            dataTable = dv.ToTable();

                            if (dataTable.Rows.Count > 0)
                            {
                                string ReportName = dataTable.Rows[0]["SP0_DESCRIPTION"].ToString();

                                ReportName = Regex.Replace(ReportName, @"[^a-zA-Z0-9\s]", "");

                                //ReportName = ReportName.Replace("/", "");

                                //if (ReportName.Length > 16)
                                //{
                                //    ReportName = ReportName.Substring(0, 16);
                                //}
                                //else
                                //    ReportName = ReportName;

                                //if (rbAmtYes.Checked)
                                //    ReportName = ReportName + " (WithAmounts)";
                                //if (rbAmtNo.Checked)
                                //    ReportName = ReportName + " (NoAmounts)";

                                if (ReportName.Length > 30)
                                {
                                    ReportName = ReportName.Substring(0, 30);
                                }
                                else
                                    ReportName = ReportName;

                                bool chkSheetName = lstSheetNames.Any(x => x.Contains(ReportName));
                                if (chkSheetName)
                                {
                                    ReportName = ReportName + (lstSheetNames.Where(x => x.Contains(ReportName)).Count() + 1);
                                }
                                lstSheetNames.Add(ReportName);

                                DevExpress.Spreadsheet.Worksheet SheetDetails = workbook.Worksheets.Add(ReportName);
                                SheetDetails.ActiveView.ShowGridlines = false;
                                SheetDetails.ActiveView.TabColor = Department_Back_Color(dataTable, dtHie_Color);
                                _Rowindex = 0;
                                _Columnindex = 0;

                                if (rbQuaterly.Checked)
                                {
                                    SheetDetails.Columns[0].Width = 10;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                    _Columnindex++;

                                    SheetDetails.Columns[1].Width = 50;
                                    SheetDetails.Columns[2].Width = 270;
                                    SheetDetails.Columns[3].Width = 100;
                                    SheetDetails.Columns[4].Width = 50;

                                    int colIndex = 4;
                                    if (rbAmtYes.Checked)
                                    {
                                        SheetDetails.Columns[5].Width = 60;
                                        SheetDetails.Columns[6].Width = 60;
                                        SheetDetails.Columns[7].Width = 60;
                                        SheetDetails.Columns[8].Width = 60;
                                        SheetDetails.Columns[9].Width = 60;
                                        SheetDetails.Columns[10].Width = 60;
                                        SheetDetails.Columns[11].Width = 60;
                                        SheetDetails.Columns[12].Width = 60;
                                        SheetDetails.Columns[13].Width = 60;
                                        colIndex = 13;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = PrivilegeEntity.PrivilegeName.Trim().ToUpper();
                                        oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 16, xlFrameStyle);
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                    }
                                    else
                                    {
                                        SheetDetails.Columns[5].Width = 120;
                                        SheetDetails.Columns[6].Width = 120;
                                        SheetDetails.Columns[7].Width = 120;
                                        SheetDetails.Columns[8].Width = 120;
                                        colIndex = 8;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = PrivilegeEntity.PrivilegeName.Trim().ToUpper();
                                        oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 11, xlFrameStyle);
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                    }

                                    SheetDetails.Columns[colIndex + 1].Width = 70;
                                    SheetDetails.Columns[colIndex + 2].Width = 60;
                                    SheetDetails.Columns[colIndex + 3].Width = 10;

                                    _Rowindex++; _Columnindex = 0;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                    _Columnindex++;

                                    string _Hierarchy = string.Empty;
                                    if (dataTable.Rows[0]["Hierarchy"].ToString() != "")
                                    {
                                        _Hierarchy = dataTable.Rows[0]["Hierarchy"].ToString().Substring(0, 2) + "-" + dataTable.Rows[0]["Hierarchy"].ToString().Substring(2, 2) + "-" + dataTable.Rows[0]["Hierarchy"].ToString().Substring(4, 2);
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = _Hierarchy.ToString();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dataTable.Rows[0]["SP0_DESCRIPTION"].ToString().Trim();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dataTable.Rows[0]["SP_CODE"].ToString().PadLeft(6, '0');
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                    _Columnindex++;

                                    if (rbAmtNo.Checked)
                                    {
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, xlFrameBlockStyle);
                                        _Columnindex = _Columnindex + 7;
                                    }
                                    else
                                    {
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 12, xlFrameBlockStyle);
                                        _Columnindex = _Columnindex + 12;
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;

                                    _Rowindex++;
                                    _Columnindex = 0;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    if (rbAmtNo.Checked)
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 12, xlFrameStyle);
                                    else
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 17, xlFrameStyle);
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;


                                    _Rowindex++; _Columnindex = 0;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                    _Columnindex++;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                    _Columnindex++;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                    _Columnindex++;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                    _Columnindex++;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                    _Columnindex++;

                                    if (Q1Edate != "")
                                    {
                                        string Q1val = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(Convert.ToDateTime(Q1Sdate).Month.ToString())) + "-" + Convert.ToDateTime(Q1Sdate).Year.ToString() + " - " +
                                                      CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(Convert.ToDateTime(Q1Edate).Month.ToString())) + "-" + Convert.ToDateTime(Q1Edate).Year.ToString();

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Q1val;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                        if (rbAmtYes.Checked)
                                        {
                                            xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2);
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Font.UnderlineType = DevExpress.Spreadsheet.UnderlineType.Single;
                                            _Columnindex = _Columnindex + 2;
                                        }
                                        else
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Font.UnderlineType = DevExpress.Spreadsheet.UnderlineType.Single;
                                            _Columnindex++;
                                        }
                                    }
                                    else
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                        if (rbAmtYes.Checked)
                                        {
                                            xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2);
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            _Columnindex = _Columnindex + 2;
                                        }
                                        else
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            _Columnindex++;
                                        }
                                    }

                                    if (Q2Edate != "")
                                    {
                                        string Q2val = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(Convert.ToDateTime(Q2Sdate).Month.ToString())) + "-" + Convert.ToDateTime(Q2Sdate).Year.ToString() + " - " +
                                                        CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(Convert.ToDateTime(Q2Edate).Month.ToString())) + "-" + Convert.ToDateTime(Q2Edate).Year.ToString();

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Q2val;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Font.UnderlineType = DevExpress.Spreadsheet.UnderlineType.Single;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                        if (rbAmtYes.Checked)
                                        {
                                            xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2);
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            _Columnindex = _Columnindex + 2;
                                        }
                                        else
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            _Columnindex++;
                                        }
                                    }
                                    else
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                        if (rbAmtYes.Checked)
                                        {
                                            xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2);
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            _Columnindex = _Columnindex + 2;
                                        }
                                        else
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            _Columnindex++;
                                        }
                                    }

                                    if (Q3Edate != "")
                                    {
                                        string Q3val = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(Convert.ToDateTime(Q3Sdate).Month.ToString())) + "-" + Convert.ToDateTime(Q3Sdate).Year.ToString() + " - " +
                                                        CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(Convert.ToDateTime(Q3Edate).Month.ToString())) + "-" + Convert.ToDateTime(Q3Edate).Year.ToString();

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Q3val;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Font.UnderlineType = DevExpress.Spreadsheet.UnderlineType.Single;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                        if (rbAmtYes.Checked)
                                        {
                                            xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2);
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            _Columnindex = _Columnindex + 2;
                                        }
                                        else
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            _Columnindex++;
                                        }
                                    }
                                    else
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                        if (rbAmtYes.Checked)
                                        {
                                            xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2);
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            _Columnindex = _Columnindex + 2;
                                        }
                                        else
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            _Columnindex++;
                                        }
                                    }

                                    if (Q4Edate != "")
                                    {
                                        string Q4val = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(Convert.ToDateTime(Q4Sdate).Month.ToString())) + "-" + Convert.ToDateTime(Q4Sdate).Year.ToString() + " - " +
                                                        CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(Convert.ToDateTime(Q4Edate).Month.ToString())) + "-" + Convert.ToDateTime(Q4Edate).Year.ToString();

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Q4val;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Font.UnderlineType = DevExpress.Spreadsheet.UnderlineType.Single;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                        if (rbAmtYes.Checked)
                                        {
                                            xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2);
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            _Columnindex = _Columnindex + 2;
                                        }
                                        else
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            _Columnindex++;
                                        }
                                    }
                                    else
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                        if (rbAmtYes.Checked)
                                        {
                                            xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2);
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            _Columnindex = _Columnindex + 2;
                                        }
                                        else
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            _Columnindex++;
                                        }
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;

                                    if (rbAmtYes.Checked)
                                    {
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2);
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                        _Columnindex = _Columnindex + 2;
                                    }
                                    else
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                        _Columnindex++;
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;

                                    _Rowindex++;
                                    _Columnindex = 0;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Type";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Description";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Aggregate Func.";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Target";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    if (Q1Edate != "")
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        if(!rbAmtYes.Checked)
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        if (rbAmtYes.Checked)
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;
                                        }

                                    }
                                    else
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        if(!rbAmtYes.Checked)
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        if (rbAmtYes.Checked)
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;
                                        }
                                    }

                                    if (Q2Edate != "")
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        if (!rbAmtYes.Checked)
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        if (rbAmtYes.Checked)
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;
                                        }

                                    }
                                    else
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        if (!rbAmtYes.Checked)
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        if (rbAmtYes.Checked)
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;
                                        }
                                    }

                                    if (Q3Edate != "")
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        if (!rbAmtYes.Checked)
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;
                                        if (rbAmtYes.Checked)
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;
                                        }
                                    }
                                    else
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        if (!rbAmtYes.Checked)
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        if (rbAmtYes.Checked)
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;
                                        }
                                    }

                                    if (Q4Edate != "")
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        if (!rbAmtYes.Checked)
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;
                                        if (rbAmtYes.Checked)
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;
                                        }
                                    }
                                    else
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        if (!rbAmtYes.Checked)
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        if (rbAmtYes.Checked)
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;
                                        }
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients YTD";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    if (rbAmtYes.Checked)
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount YTD";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        _Columnindex++;
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "YTD %";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                    int i = 0;
                                    foreach (DataRow dr in dataTable.Rows)
                                    {
                                        _Rowindex++;
                                        _Columnindex = 0;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        string CAMSType = string.Empty;
                                        if (dr["SP2_TYPE"].ToString().Trim() == "CA")
                                            CAMSType = "Service";
                                        else
                                            CAMSType = "Outcome";

                                        string Ytd = string.Empty;
                                        if (dr["TARGET_VAL"].ToString() != "0")
                                        {
                                            //if (!string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                            //{
                                            //    decimal percent = (decimal.Parse(dr["YTD"].ToString().Trim() == string.Empty ? "0" : dr["YTD"].ToString().Trim()) / decimal.Parse(dr["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : dr["TARGET_VAL"].ToString().Trim())) * 100;

                                            //    Ytd = percent.ToString("0.00");
                                            //}
                                            //else
                                            //{
                                                int totcnt = 0, Q1 = 0, Q2 = 0, Q3 = 0, Q4 = 0;
                                                if (Q1Edate != "")
                                                    if (!string.IsNullOrEmpty(dr["Q1_Cnt"].ToString().Trim()))
                                                        Q1 = int.Parse(dr["Q1_Cnt"].ToString().Trim());
                                                if (Q2Edate != "")
                                                    if (!string.IsNullOrEmpty(dr["Q2_Cnt"].ToString().Trim()))
                                                        Q2 = int.Parse(dr["Q2_Cnt"].ToString().Trim());
                                                if (Q3Edate != "")
                                                    if (!string.IsNullOrEmpty(dr["Q3_Cnt"].ToString().Trim()))
                                                        Q3 = int.Parse(dr["Q3_Cnt"].ToString().Trim());
                                                if (Q4Edate != "")
                                                    if (!string.IsNullOrEmpty(dr["Q4_Cnt"].ToString().Trim()))
                                                        Q4 = int.Parse(dr["Q4_Cnt"].ToString().Trim());
                                                totcnt = Q1 + Q2 + Q3 + Q4;

                                                decimal percent = (decimal.Parse(totcnt.ToString().Trim() == string.Empty ? "0" : totcnt.ToString().Trim()) / decimal.Parse(dr["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : dr["TARGET_VAL"].ToString().Trim())) * 100;

                                                Ytd = percent.ToString("0.00");
                                            //}
                                        }

                                        string CntType = string.Empty;
                                        if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                            CntType = "Amount - Average";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "S")
                                            CntType = "Amount - Sum";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "E")
                                            CntType = "Amount - End of Month";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "C")
                                            CntType = "Client - Average";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "B")
                                            CntType = "Client - Sum";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "D")
                                            CntType = "Client - End of Month";

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = CAMSType.ToString();
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders, gxlErrBCC_blueBorders);
                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["CAMS_DESC"].ToString().Trim();
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders, gxlErrBLCW_blueBorders);
                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = CntType;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders, gxlErrBCC_blueBorders);
                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = (dr["TARGET_VAL"].ToString() != "" ? Convert.ToInt32(dr["TARGET_VAL"].ToString()) : 0);
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders, gxlErrNumb_NCC_blueBorders);
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        if (dr["SP2_COUNT_TYPE"].ToString() == "B" || dr["SP2_COUNT_TYPE"].ToString() == "C" || dr["SP2_COUNT_TYPE"].ToString() == "D")
                                        {
                                            if (Q1Edate != "")
                                            {
                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q1"].ToString();// + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q1"].ToString() == "" ? "0" : dr["Q1"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                if (!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }
                                            else
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                if (!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }

                                            if (Q2Edate != "")
                                            {
                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q2"].ToString();// + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q2"].ToString() == "" ? "0" : dr["Q2"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                if (!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }
                                            else
                                            {


                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                if (!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }

                                            if (Q3Edate != "")
                                            {
                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q3"].ToString();// + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q3"].ToString() == "" ? "0" : dr["Q3"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                if (!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }
                                            else
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                if (!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }

                                            if (Q4Edate != "")
                                            {
                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q4"].ToString();// + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q4"].ToString() == "" ? "0" : dr["Q4"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                if (!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }
                                            else
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                if (!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }

                                            if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["YTD"].ToString() + "%";
                                            else
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["YTD"].ToString() == "" ? "0" : dr["YTD"].ToString());
                                            }

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            if (rbAmtYes.Checked)
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }
                                        }
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "S" || dr["SP2_COUNT_TYPE"].ToString() == "A" || dr["SP2_COUNT_TYPE"].ToString() == "E")
                                        {
                                            if (Q1Edate != "")
                                            {
                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }

                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q1"].ToString();// + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q1"].ToString() == "" ? "0" : dr["Q1"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }
                                            else
                                            {
                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }


                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }

                                            if (Q2Edate != "")
                                            {
                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q2"].ToString();// + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q2"].ToString() == "" ? "0" : dr["Q2"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }
                                            else
                                            {
                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }


                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }

                                            if (Q3Edate != "")
                                            {

                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q3"].ToString();// + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q3"].ToString() == "" ? "0" : dr["Q3"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                               // SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                            }
                                            else
                                            {
                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }


                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }

                                            if (Q4Edate != "")
                                            {

                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q4"].ToString();// + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q4"].ToString() == "" ? "0" : dr["Q4"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                            }
                                            else
                                            {
                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }


                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }

                                            if (rbAmtYes.Checked)
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }
                                            if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["YTD"].ToString() + "%";
                                            else
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["YTD"].ToString() == "" ? "0" : dr["YTD"].ToString());
                                            }
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;
                                        }
                                        else
                                        {
                                            if (Q1Edate != "")
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["Q1_Cnt"].ToString());
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                if (!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q1"].ToString();// + "%";
                                                    else
                                                    {
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q1"].ToString() == "" ? "0" : dr["Q1"].ToString());
                                                    }

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }
                                            else
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                if (!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }

                                            if (Q2Edate != "")
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["Q2_Cnt"].ToString());
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                if (!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;


                                                if (rbAmtYes.Checked)
                                                {
                                                    if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q2"].ToString();// + "%";
                                                    else
                                                    {
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q2"].ToString() == "" ? "0" : dr["Q2"].ToString());
                                                    }

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }
                                            else
                                            {

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                if (!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }

                                            if (Q3Edate != "")
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["Q3_Cnt"].ToString());
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                if (!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;


                                                if (rbAmtYes.Checked)
                                                {
                                                    if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q3"].ToString();// + "%";
                                                    else
                                                    {
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q3"].ToString() == "" ? "0" : dr["Q3"].ToString());
                                                    }


                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }
                                            else
                                            {

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                if (!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }

                                            if (Q4Edate != "")
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["Q4_Cnt"].ToString());
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                if (!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q4"].ToString();// + "%";
                                                    else
                                                    {
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["Q4"].ToString() == "" ? "0" : dr["Q4"].ToString());
                                                    }

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }
                                            else
                                            {

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                if (!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }

                                            int totcnt = 0, Q1 = 0, Q2 = 0, Q3 = 0, Q4 = 0;
                                            if (Q1Edate != "")
                                                if (!string.IsNullOrEmpty(dr["Q1_Cnt"].ToString().Trim()))
                                                    Q1 = int.Parse(dr["Q1_Cnt"].ToString().Trim());
                                            if (Q2Edate != "")
                                                if (!string.IsNullOrEmpty(dr["Q2_Cnt"].ToString().Trim()))
                                                    Q2 = int.Parse(dr["Q2_Cnt"].ToString().Trim());
                                            if (Q3Edate != "")
                                                if (!string.IsNullOrEmpty(dr["Q3_Cnt"].ToString().Trim()))
                                                    Q3 = int.Parse(dr["Q3_Cnt"].ToString().Trim());
                                            if (Q4Edate != "")
                                                if (!string.IsNullOrEmpty(dr["Q4_Cnt"].ToString().Trim()))
                                                    Q4 = int.Parse(dr["Q4_Cnt"].ToString().Trim());
                                            totcnt = Q1 + Q2 + Q3 + Q4;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = totcnt == 0 ? 0 : Convert.ToInt32(totcnt.ToString());
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders, gxlErrNumb_NCC_blueBorders);
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            if (rbAmtYes.Checked)
                                            {
                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["YTD"].ToString() + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["YTD"].ToString() == "" ? "0" : dr["YTD"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }

                                        }

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = (Ytd == string.Empty ? "" : Ytd + "%");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        i++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    }

                                    _Rowindex++;
                                    _Columnindex = 0;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "©2024 CAPSystems Inc";
                                    if (rbAmtNo.Checked)
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 12, xlFrameFooterStyle);
                                    else
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 17, xlFrameFooterStyle);
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                }
                                else
                                {
                                    int MergeCols = 0;
                                    int _ToEndMonth = Convert.ToDateTime(dtAnnualTodate.Value).Month;
                                    DateTime FromDate = Convert.ToDateTime(rngcodedata.OFdate);
                                    DateTime ToDate = Convert.ToDateTime(dtAnnualTodate.Value);
                                    int NoMonths = GetMonthsBetween(FromDate, ToDate) + 1;

                                    SheetDetails.Columns[0].Width = 10;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                    _Columnindex++;

                                    SheetDetails.Columns[1].Width = 50;
                                    SheetDetails.Columns[2].Width = 270;
                                    SheetDetails.Columns[3].Width = 100;
                                    SheetDetails.Columns[4].Width = 50;


                                    if (rbAmtYes.Checked)
                                    {
                                        MergeCols = 9 + (NoMonths * 2);
                                    }
                                    else
                                    {
                                        MergeCols = 8 + (NoMonths);
                                    }

                                    int _colindex = 4;

                                    for (int xx = 0; xx < NoMonths; xx++)
                                    {
                                        SheetDetails.Columns[_colindex].Width = 60;
                                        _colindex++;

                                        if (rbAmtYes.Checked)
                                        {
                                            SheetDetails.Columns[_colindex].Width = 60;
                                            _colindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = PrivilegeEntity.PrivilegeName.Trim().ToUpper();
                                            oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, MergeCols - 1, xlFrameStyle); //32
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                           // _Columnindex = _Columnindex + (MergeCols - 1);
                                        }
                                        else
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = PrivilegeEntity.PrivilegeName.Trim().ToUpper();
                                            oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, MergeCols - 1, xlFrameStyle); //19
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                            //_Columnindex = _Columnindex + (MergeCols - 1);
                                        }

                                        //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        //SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                        //_Columnindex++;
                                    }

                                    SheetDetails.Columns[_colindex].Width = 70;
                                    _colindex++;
                                    SheetDetails.Columns[_colindex].Width = 70;
                                    _colindex++;
                                    SheetDetails.Columns[_colindex].Width = 70;
                                    _colindex++;
                                    if (rbAmtYes.Checked)
                                    {
                                        SheetDetails.Columns[_colindex].Width = 70;
                                        _colindex++;
                                    }
                                    SheetDetails.Columns[_colindex].Width = 10;
                                    _colindex++;

                                    _Rowindex++;
                                    _Columnindex = 0;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                    _Columnindex++;

                                    string _Hierarchy = string.Empty;
                                    if (dataTable.Rows[0]["Hierarchy"].ToString() != "")
                                    {
                                        _Hierarchy = dataTable.Rows[0]["Hierarchy"].ToString().Substring(0, 2) + "-" + dataTable.Rows[0]["Hierarchy"].ToString().Substring(2, 2) + "-" + dataTable.Rows[0]["Hierarchy"].ToString().Substring(4, 2);
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = _Hierarchy.ToString();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dataTable.Rows[0]["SP0_DESCRIPTION"].ToString().Trim();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dataTable.Rows[0]["SP_CODE"].ToString().PadLeft(6, '0');
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                    _Columnindex++;

                                    if (rbAmtNo.Checked)
                                    {
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, MergeCols - 5, xlFrameBlockStyle); //15
                                        _Columnindex = _Columnindex + (MergeCols - 5);
                                    }
                                    else
                                    {
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, MergeCols - 5, xlFrameBlockStyle); //28
                                        _Columnindex = _Columnindex + (MergeCols - 5);
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;

                                    _Rowindex++;
                                    _Columnindex = 0;
                                    if (rbAmtYes.Checked)
                                    {
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, MergeCols, xlFrameStyle); //33
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                    }
                                    else
                                    {
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, MergeCols, xlFrameStyle); //20
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                    }

                                    _Rowindex++;
                                    _Columnindex = 0;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                    _Columnindex++;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                    _Columnindex++;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                    _Columnindex++;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                    _Columnindex++;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                    _Columnindex++;

                                    DateTime ct = Convert.ToDateTime(rngcodedata.OFdate);
                                    for (int x = 0; x < NoMonths; x++)
                                    {
                                        if (x > 0)
                                            ct = ct.AddMonths(1);

                                        string Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Mval1;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;

                                        if (rbAmtYes.Checked)
                                        {
                                            xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2, xlFrameBlockStyle);
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Font.UnderlineType = DevExpress.Spreadsheet.UnderlineType.Single;
                                            _Columnindex = _Columnindex + 2;
                                        }
                                        else
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Font.UnderlineType = DevExpress.Spreadsheet.UnderlineType.Single;
                                            _Columnindex++;
                                        }
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                    if (rbAmtYes.Checked)
                                    {
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 2, xlFrameBlockStyle);
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                        _Columnindex = _Columnindex + 2;
                                    }
                                    else
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.LeftBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                        _Columnindex++;
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 15;

                                    _Rowindex++;
                                    _Columnindex = 0;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Type";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Description";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Aggregate Func.";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Target";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    for (int x = 0; x < NoMonths; x++)
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        if(!rbAmtYes.Checked)
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        if (rbAmtYes.Checked)
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;
                                        }
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients YTD";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;
                                    if (rbAmtYes.Checked)
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Amount YTD";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "YTD %";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                    int i = 0;
                                    foreach (DataRow dr in dataTable.Rows)
                                    {
                                        _Rowindex++;
                                        _Columnindex = 0;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        string CAMSType = string.Empty;
                                        if (dr["SP2_TYPE"].ToString().Trim() == "CA")
                                            CAMSType = "Service";
                                        else
                                            CAMSType = "Outcome";

                                        string CntType = string.Empty;
                                        if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                            CntType = "Amount - Average";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "S")
                                            CntType = "Amount - Sum";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "E")
                                            CntType = "Amount - End of Month";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "C")
                                            CntType = "Client - Average";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "B")
                                            CntType = "Client - Sum";
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "D")
                                            CntType = "Client - End of Month";

                                        int totcnt = 0, M1 = 0, M2 = 0, M3 = 0, M4 = 0, M5 = 0, M6 = 0, M7 = 0, M8 = 0, M9 = 0, M10 = 0, M11 = 0, M12 = 0;
                                        if (!string.IsNullOrEmpty(dr["M1_MEM"].ToString().Trim()))
                                            M1 = int.Parse(dr["M1_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M2_MEM"].ToString().Trim()))
                                            M2 = int.Parse(dr["M2_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M3_MEM"].ToString().Trim()))
                                            M3 = int.Parse(dr["M3_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M4_MEM"].ToString().Trim()))
                                            M4 = int.Parse(dr["M4_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M5_MEM"].ToString().Trim()))
                                            M5 = int.Parse(dr["M5_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M6_MEM"].ToString().Trim()))
                                            M6 = int.Parse(dr["M6_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M7_MEM"].ToString().Trim()))
                                            M7 = int.Parse(dr["M7_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M8_MEM"].ToString().Trim()))
                                            M8 = int.Parse(dr["M8_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M9_MEM"].ToString().Trim()))
                                            M9 = int.Parse(dr["M9_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M10_MEM"].ToString().Trim()))
                                            M10 = int.Parse(dr["M10_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M11_MEM"].ToString().Trim()))
                                            M11 = int.Parse(dr["M11_MEM"].ToString().Trim());
                                        if (!string.IsNullOrEmpty(dr["M12_MEM"].ToString().Trim()))
                                            M12 = int.Parse(dr["M12_MEM"].ToString().Trim());
                                        totcnt = M1 + M2 + M3 + M4 + M5 + M6 + M7 + M8 + M9 + M10 + M11 + M12;

                                        string Ytd = string.Empty;
                                        if (dr["TARGET_VAL"].ToString() != "0")
                                        {
                                            if (!string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                            {
                                                //decimal percent = (decimal.Parse(dr["YTD"].ToString().Trim() == string.Empty ? "0" : dr["YTD"].ToString().Trim()) / decimal.Parse(dr["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : dr["TARGET_VAL"].ToString().Trim())) * 100;
                                                decimal percent = (decimal.Parse(totcnt.ToString().Trim() == string.Empty ? "0" : totcnt.ToString().Trim()) / decimal.Parse(dr["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : dr["TARGET_VAL"].ToString().Trim())) * 100;

                                                Ytd = percent.ToString("0.00");
                                            }
                                            else
                                            {
                                                decimal percent = (decimal.Parse(totcnt.ToString().Trim() == string.Empty ? "0" : totcnt.ToString().Trim()) / decimal.Parse(dr["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : dr["TARGET_VAL"].ToString().Trim())) * 100;

                                                Ytd = percent.ToString("0.00");
                                            }
                                        }

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = CAMSType;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders, gxlErrBCC_blueBorders);
                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["CAMS_DESC"].ToString().Trim();
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders, gxlErrBLCW_blueBorders);
                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = CntType;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders, gxlErrBCC_blueBorders);
                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = (dr["TARGET_VAL"].ToString() != "" ? Convert.ToInt32(dr["TARGET_VAL"].ToString()) : 0);
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders, gxlErrNumb_NCC_blueBorders);
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        if (dr["SP2_COUNT_TYPE"].ToString() == "B" || dr["SP2_COUNT_TYPE"].ToString() == "C" || dr["SP2_COUNT_TYPE"].ToString() == "D")
                                        {
                                            for (int y = 0; y < NoMonths; y++)
                                            {
                                                int x = y + 1;

                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["M" + x.ToString() + ""].ToString();// + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["M" + x.ToString() + ""].ToString() == "" ? "0" : dr["M" + x.ToString() + ""].ToString());
                                                }
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                if(!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }

                                            if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["YTD"].ToString() + "%";
                                            else
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["YTD"].ToString() == "" ? "0" : dr["YTD"].ToString());
                                            }

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            if (rbAmtYes.Checked)
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }
                                        }
                                        else if (dr["SP2_COUNT_TYPE"].ToString() == "S" || dr["SP2_COUNT_TYPE"].ToString() == "A" || dr["SP2_COUNT_TYPE"].ToString() == "E")
                                        {
                                            for (int y = 0; y < NoMonths; y++)
                                            {
                                                if (rbAmtYes.Checked)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                                int x = y + 1;
                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["M" + x.ToString() + ""].ToString();// + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["M" + x.ToString() + ""].ToString() == "" ? "0" : dr["M" + x.ToString() + ""].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }


                                            if (rbAmtYes.Checked)
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }
                                            if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["YTD"].ToString() + "%";
                                            else
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["YTD"].ToString() == "" ? "0" : dr["YTD"].ToString());
                                            }
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;
                                        }
                                        else
                                        {
                                            for (int y = 0; y < NoMonths; y++)
                                            {
                                                int x = y + 1;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["M" + x.ToString() + "_MEM"].ToString());
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders, gxlErrNumb_NCC_blueBorders);
                                                if(!rbAmtYes.Checked)
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                if (rbAmtYes.Checked)
                                                {
                                                    if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["M" + x.ToString() + ""].ToString();// + "%";
                                                    else
                                                    {
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["M" + x.ToString() + ""].ToString() == "" ? "0" : dr["M" + x.ToString() + ""].ToString());
                                                    }

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Borders.RightBorder.Color = System.Drawing.ColorTranslator.FromHtml("#1A4777");
                                                    //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                            }

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = totcnt == 0 ? 0 : Convert.ToInt32(totcnt.ToString());
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders, gxlErrNumb_NCC_blueBorders);
                                            _Columnindex++;

                                            if (rbAmtYes.Checked)
                                            {
                                                if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["YTD"].ToString() + "%";
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["YTD"].ToString() == "" ? "0" : dr["YTD"].ToString());
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }
                                        }
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = (Ytd == string.Empty ? "" : Ytd + "%");
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = setCellStyle(dr["SP0_ACTIVE"].ToString(), dr["SP2_ACTIVE"].ToString(), oDevExpress_Excel_Properties.gxlDeci_DBCC_Blue_Borders, gxlErrDeci_NCC_blueBorders);
                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                        i++;
                                    }

                                    _Rowindex++;
                                    _Columnindex = 0;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "©2024 CAPSystems Inc";
                                    if (rbAmtNo.Checked)
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, MergeCols, xlFrameFooterStyle); //20
                                    else
                                        xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, MergeCols, xlFrameFooterStyle); //33
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                }

                                SheetDetails.IgnoredErrors.Add(SheetDetails.GetDataRange(), DevExpress.Spreadsheet.IgnoredErrorType.NumberAsText);
                            }

                            #region Audit Report
                            if (Rb_SP_Sel.Checked)
                            {
                                if (dtAudit.Rows.Count > 0)
                                {
                                    DataTable dataAudit = new DataTable();
                                    DataView dvAudit = new DataView(dtAudit);
                                    dvAudit.RowFilter = "SP='" + dRow + "'";
                                    dvAudit.RowFilter = "SP='" + dRow + "'";

                                    dataAudit = dvAudit.ToTable();

                                    if (dataAudit.Rows.Count > 0)
                                    {
                                        string ReportName = dRow + "_Audit";

                                        ReportName = Regex.Replace(ReportName, @"[^a-zA-Z0-9\s]", "");

                                        //ReportName = ReportName.Replace("/", "");

                                        if (ReportName.Length >= 31)
                                        {
                                            ReportName = ReportName.Substring(0, 31);
                                        }

                                        DevExpress.Spreadsheet.Worksheet SheetAudit = workbook.Worksheets.Add(ReportName);
                                        SheetAudit.ActiveView.ShowGridlines = false;
                                        _Rowindex = 0;
                                        _Columnindex = 0;

                                        SheetAudit.Columns[0].Width = 270;
                                        SheetAudit.Columns[1].Width = 75;
                                        SheetAudit.Columns[2].Width = 30;
                                        SheetAudit.Columns[3].Width = 45;
                                        SheetAudit.Columns[4].Width = 80;
                                        SheetAudit.Columns[5].Width = 75;
                                        SheetAudit.Columns[6].Width = 70;
                                        SheetAudit.Columns[7].Width = 60;
                                        SheetAudit.Columns[8].Width = 145;
                                        SheetAudit.Columns[9].Width = 145;
                                        SheetAudit.Columns[10].Width = 145;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = PrivilegeEntity.PrivilegeName.Trim().ToUpper() + "/" + "AUDIT";
                                        oDevExpress_Excel_Properties.xlRowsMerge(SheetAudit, _Rowindex, _Columnindex, 11, xlFrameStyle);
                                        SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 30;

                                        _Rowindex++;
                                        _Columnindex = 0;

                                        string _Hierarchy = string.Empty;
                                        if (dataTable.Rows[0]["Hierarchy"].ToString() != "")
                                        {
                                            _Hierarchy = dataTable.Rows[0]["Hierarchy"].ToString().Substring(0, 2) + "-" + dataTable.Rows[0]["Hierarchy"].ToString().Substring(2, 2) + "-" + dataTable.Rows[0]["Hierarchy"].ToString().Substring(4, 2);
                                        }

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = _Hierarchy.ToString();
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                        _Columnindex++;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = dataAudit.Rows[0]["SP_Desc"].ToString();
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        xlRowsMerge(SheetAudit, _Rowindex, _Columnindex, 3, xlFrameBlockStyle);
                                        _Columnindex = _Columnindex + 3;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                        SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                        _Columnindex++;

                                        xlRowsMerge(SheetAudit, _Rowindex, _Columnindex, 6, xlFrameBlockStyle);
                                        SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 30;

                                        _Rowindex++;
                                        _Columnindex = 0;
                                        xlRowsMerge(SheetAudit, _Rowindex, _Columnindex, 11, xlFrameStyle);
                                        SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                                        _Rowindex++;
                                        _Columnindex = 0;
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Description";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                        SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                        _Columnindex++;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Date";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                        SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                        _Columnindex++;

                                        if (rbQuaterly.Checked)
                                        {
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Q#";
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                            SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                            _Columnindex++;
                                        }
                                        else
                                        {
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Value = "M#";
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                            SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                            _Columnindex++;
                                        }

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                        SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                        _Columnindex++;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Total Clients";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                        SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                        _Columnindex++;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Detail Amt.";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                        SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                        _Columnindex++;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Total Amt.";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                        SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                        _Columnindex++;


                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "App No";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                        SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                        _Columnindex++;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Name";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                        SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                        _Columnindex++;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Case Worker";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                        SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                        _Columnindex++;

                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = "Site";
                                        SheetAudit.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                        SheetAudit.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                        _Columnindex++;

                                        int i = 0;
                                        string QM_type = string.Empty;
                                        int QM_Count = 0;
                                        string Serv = string.Empty;
                                        string PrivClID = string.Empty;
                                        int PrvCnt = 0;
                                        foreach (DataRow dr in dataAudit.Rows)
                                        {
                                            string CAMSType = string.Empty;
                                            if (dr["SP2_TYPE"].ToString().Trim() == "CA")
                                                CAMSType = "Service";
                                            else
                                                CAMSType = "Outcome";

                                            if (rbQuaterly.Checked)
                                            {
                                                if (dr["Q_SEC"].ToString().Trim() != QM_type || dr["CAMS_CODE"].ToString().Trim() != Serv)
                                                {
                                                    i++;
                                                }
                                            }
                                            else
                                            {
                                                if (dr["M_SEC"].ToString().Trim() != QM_type || dr["CAMS_CODE"].ToString().Trim() != Serv)
                                                {
                                                    i++;
                                                }
                                            }

                                            if (rbQuaterly.Checked)
                                                QM_type = dr["Q_SEC"].ToString().Trim();
                                            else
                                                QM_type = dr["M_SEC"].ToString().Trim();

                                            Serv = dr["CAMS_CODE"].ToString().Trim();


                                            var x = (i % 2);

                                            _Rowindex++;
                                            _Columnindex = 0;
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Value = dr["CAMS_DESC"].ToString().Trim();
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                            _Columnindex++;

                                            if (Rb_MS_Date.Checked)
                                            {
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Value = LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString());

                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders : gxlGLC_blueBorders);

                                                _Columnindex++;
                                            }
                                            else
                                            {
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Value = LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString());
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                                _Columnindex++;
                                            }

                                            if (rbQuaterly.Checked)
                                            {
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Value = dr["Q_SEC"].ToString();
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                                _Columnindex++;
                                            }
                                            else
                                            {
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Value = dr["M_SEC"].ToString();
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                                _Columnindex++;
                                            }

                                            if (dr["Count_Type"].ToString().Trim() == "B" || dr["Count_Type"].ToString().Trim() == "C" || dr["Count_Type"].ToString().Trim() == "D")
                                            {
                                                if (dr["CASEMS_COST"].ToString() != "")
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["CASEMS_COST"].ToString());
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_DBRC_Blue_Borders : gxlDeci_GRC_blueBorders);
                                                _Columnindex++;

                                                if (dr["TotCnt"].ToString() != "")
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["TotCnt"].ToString());
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_DBRC_Blue_Borders : gxlDeci_GRC_blueBorders);
                                                _Columnindex++;

                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                                _Columnindex++;

                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                                _Columnindex++;
                                            }
                                            else if (dr["Count_Type"].ToString().Trim() == "S" || dr["Count_Type"].ToString().Trim() == "A" || dr["Count_Type"].ToString().Trim() == "E")
                                            {
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                                _Columnindex++;

                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                                _Columnindex++;

                                                if (dr["CASEMS_COST"].ToString() != "")
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["CASEMS_COST"].ToString());
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_DBRC_Blue_Borders : gxlDeci_GRC_blueBorders);
                                                _Columnindex++;

                                                if (dr["TotCnt"].ToString() != "")
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["TotCnt"].ToString());
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_DBRC_Blue_Borders : gxlDeci_GRC_blueBorders);
                                                _Columnindex++;
                                            }
                                            else
                                            {
                                                if (dr["cnt"].ToString() != "")
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["cnt"].ToString());
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNumb_DBRC_Blue_Borders : gxlNumb_GRC_blueBorders);
                                                _Columnindex++;

                                                if (!string.IsNullOrEmpty(dr["TotCnt"].ToString().Trim()))
                                                {
                                                    if (dr["cnt"].ToString() != "")
                                                        SheetAudit.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["cnt"].ToString());
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNumb_DBRC_Blue_Borders : gxlNumb_GRC_blueBorders);
                                                    _Columnindex++;
                                                }
                                                else
                                                {
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Value = 0;
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlNumb_DBRC_Blue_Borders : gxlNumb_GRC_blueBorders);
                                                    _Columnindex++;
                                                }

                                                if (dr["CASEMS_COST"].ToString() != "")
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["CASEMS_COST"].ToString());
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_DBRC_Blue_Borders : gxlDeci_GRC_blueBorders);
                                                _Columnindex++;

                                                if (dr["TotCnt"].ToString() != "")
                                                    SheetAudit.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["TotCnt"].ToString());
                                                SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDeci_DBRC_Blue_Borders : gxlDeci_GRC_blueBorders);
                                                _Columnindex++;

                                            }

                                            SheetAudit.Rows[_Rowindex][_Columnindex].Value = dr["AppNo"].ToString();
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                            _Columnindex++;

                                            SheetAudit.Rows[_Rowindex][_Columnindex].Value = dr["Name"].ToString();
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                            _Columnindex++;

                                            SheetAudit.Rows[_Rowindex][_Columnindex].Value = dr["CAMS_WORKER"].ToString();
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                            _Columnindex++;

                                            SheetAudit.Rows[_Rowindex][_Columnindex].Value = dr["CAMS_SITE"].ToString();
                                            SheetAudit.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                            _Columnindex++;

                                            PrivClID = dr["Client_ID"].ToString().Trim();
                                            PrvCnt = QM_Count;
                                        }

                                        SheetAudit.IgnoredErrors.Add(SheetAudit.GetDataRange(), DevExpress.Spreadsheet.IgnoredErrorType.NumberAsText);
                                    }

                                    
                                }

                            }
                            #endregion
                        }

                        #region Agency Wide Report
                        if (rbAWRYes.Checked && dt.Rows.Count > 0)
                        {
                            string PriSP = string.Empty;
                            string prevDept = string.Empty;

                            DevExpress.Spreadsheet.Worksheet SheetAgyWide = workbook.Worksheets.Add("Agency Wide Report");
                            SheetAgyWide.ActiveView.ShowGridlines = false;
                            _Rowindex = 0;
                            _Columnindex = 0;

                            var distinctSPs = (from DataRow sps in dt.Rows
                                               select sps["SP0_SERVICECODE"]).Distinct();

                            SheetAgyWide.Columns[0].Width = 10;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                            _Columnindex++;

                            SheetAgyWide.Columns[1].Width = 250;//200;
                            SheetAgyWide.Columns[2].Width = 55;
                            SheetAgyWide.Columns[3].Width = 250;//200;
                            SheetAgyWide.Columns[4].Width = 100;
                            SheetAgyWide.Columns[5].Width = 60;
                            SheetAgyWide.Columns[6].Width = 60;
                            SheetAgyWide.Columns[7].Width = 60;
                            if (rbAmtYes.Checked)
                            {
                                SheetAgyWide.Columns[8].Width = 60;
                                SheetAgyWide.Columns[9].Width = 10;
                            }
                            else
                                SheetAgyWide.Columns[8].Width = 10;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = PrivilegeEntity.PrivilegeName.Trim().ToUpper() + "/" + "AGENCY-WIDE";
                            if (rbAmtYes.Checked)
                            {
                                oDevExpress_Excel_Properties.xlRowsMerge(SheetAgyWide, _Rowindex, _Columnindex, 8, xlFrameStyle);
                                _Columnindex = _Columnindex + 8;
                            }
                            else
                            {
                                oDevExpress_Excel_Properties.xlRowsMerge(SheetAgyWide, _Rowindex, _Columnindex, 7, xlFrameStyle);
                                _Columnindex = _Columnindex + 7;
                            }
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 30;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 30;

                            _Rowindex++;
                            _Columnindex = 0;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                            _Columnindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "Department";
                            if (rbAmtYes.Checked)
                            {
                                oDevExpress_Excel_Properties.xlRowsMerge(SheetAgyWide, _Rowindex, _Columnindex, 8, xlFrameBlockStyleLeft);
                                _Columnindex = _Columnindex + 8;
                            }
                            else
                            {
                                oDevExpress_Excel_Properties.xlRowsMerge(SheetAgyWide, _Rowindex, _Columnindex, 7, xlFrameBlockStyleLeft);
                                _Columnindex = _Columnindex + 7;
                            }
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Font.UnderlineType = DevExpress.Spreadsheet.UnderlineType.Single;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 30;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 30;

                            _Rowindex++;
                            _Columnindex = 0;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                            _Columnindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                            if (rbAmtYes.Checked)
                            {
                                oDevExpress_Excel_Properties.xlRowsMerge(SheetAgyWide, _Rowindex, _Columnindex, 8, xlFrameStyle);
                                _Columnindex = _Columnindex + 8;
                            }
                            else
                            {
                                oDevExpress_Excel_Properties.xlRowsMerge(SheetAgyWide, _Rowindex, _Columnindex, 7, xlFrameStyle);
                                _Columnindex = _Columnindex + 7;
                            }
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                            _Rowindex++;
                            _Columnindex = 0;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                            _Columnindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "Service Plan";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                            _Columnindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "Type";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                            _Columnindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "Description";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                            _Columnindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "Aggregate Func.";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                            _Columnindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "Target";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                            _Columnindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "YTD";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                            _Columnindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "YTD %";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                            _Columnindex++;

                            if (rbAmtYes.Checked)
                            {
                                SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "Total Amount";
                                SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;
                            }

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 30;

                            _Rowindex++;
                            _Columnindex = 0;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 5;
                            _Columnindex++;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                            if (rbAmtYes.Checked)
                            {
                                oDevExpress_Excel_Properties.xlRowsMerge(SheetAgyWide, _Rowindex, _Columnindex, 8, oDevExpress_Excel_Properties.gxlNLC);
                                _Columnindex = _Columnindex + 8;
                            }
                            else
                            {
                                oDevExpress_Excel_Properties.xlRowsMerge(SheetAgyWide, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlNLC);
                                _Columnindex = _Columnindex + 7;
                            }
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 5;

                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 5;

                            foreach (var sps in distinctRows)
                            {
                                DataTable AgyTable = new DataTable();
                                DataView dv1 = new DataView(dt);
                                dv1.RowFilter = "SP0_SERVICECODE='" + sps + "'";
                                AgyTable = dv1.ToTable();

                                DevExpress.Spreadsheet.Style Dept_Match_Color;

                                if (AgyTable.Rows.Count > 0)
                                {
                                    DataRow[] selColor;
                                    selColor = dtHie_Color.Select("Hierarchy='" + AgyTable.Rows[0]["HIERARCHY"].ToString().Trim() + "'");

                                    Color c = new Color();
                                    string s = selColor[0]["Color"].ToString();
                                    Match m = Regex.Match(s, @"A=(?<Alpha>\d+),\s*R=(?<Red>\d+),\s*G=(?<Green>\d+),\s*B=(?<Blue>\d+)");
                                    if (m.Success)
                                    {
                                        int alpha = int.Parse(m.Groups["Alpha"].Value);
                                        int red = int.Parse(m.Groups["Red"].Value);
                                        int green = int.Parse(m.Groups["Green"].Value);
                                        int blue = int.Parse(m.Groups["Blue"].Value);
                                        c = Color.FromArgb(alpha, red, green, blue);
                                    }

                                    string hex = c.Name.ToString().Substring(2);

                                    Dept_Match_Color = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 12, "#000000", true, ("#" + hex), "left", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "");

                                    if (prevDept != selColor[0]["Department"].ToString())
                                    {
                                        _Rowindex++;
                                        _Columnindex = 0;

                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                        _Columnindex++;

                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = selColor[0]["Department Name"].ToString().Trim();
                                        if (rbAmtYes.Checked)
                                        {
                                            oDevExpress_Excel_Properties.xlRowsMerge(SheetAgyWide, _Rowindex, _Columnindex, 8, Dept_Match_Color);
                                            _Columnindex = _Columnindex + 8;
                                        }
                                        else
                                        {
                                            oDevExpress_Excel_Properties.xlRowsMerge(SheetAgyWide, _Rowindex, _Columnindex, 7, Dept_Match_Color);
                                            _Columnindex = _Columnindex + 7;
                                        }
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Font.UnderlineType = DevExpress.Spreadsheet.UnderlineType.Single;

                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;

                                        prevDept = selColor[0]["Department"].ToString();
                                    }

                                    int j = 0;
                                    foreach (DataRow drsp in AgyTable.Rows)
                                    {
                                        _Rowindex++;
                                        _Columnindex = 0;

                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                        _Columnindex++;

                                        string CAMSType = string.Empty;
                                        if (drsp["SP2_TYPE"].ToString().Trim() == "CA")
                                            CAMSType = "Service";
                                        else
                                            CAMSType = "Outcome";

                                        string Ytd = string.Empty;
                                        int totcnt = 0;
                                        double TotalAmount = 0;
                                        if (string.IsNullOrEmpty(drsp["SP2_COUNT_TYPE"].ToString().Trim()))
                                        {
                                            int Q1 = 0, Q2 = 0, Q3 = 0, Q4 = 0;
                                            double Q1Amt = 0, Q2Amt = 0, Q3Amt = 0, Q4Amt = 0;
                                            if (rbQuaterly.Checked)
                                            {
                                                if (!string.IsNullOrEmpty(drsp["Q1_Cnt"].ToString().Trim()))
                                                    Q1 = int.Parse(drsp["Q1_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["Q2_Cnt"].ToString().Trim()))
                                                    Q2 = int.Parse(drsp["Q2_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["Q3_Cnt"].ToString().Trim()))
                                                    Q3 = int.Parse(drsp["Q3_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["Q4_Cnt"].ToString().Trim()))
                                                    Q4 = int.Parse(drsp["Q4_Cnt"].ToString().Trim());
                                                totcnt = Q1 + Q2 + Q3 + Q4;

                                                if (!string.IsNullOrEmpty(drsp["Q1"].ToString().Trim()))
                                                    Q1Amt = double.Parse(drsp["Q1"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["Q2"].ToString().Trim()))
                                                    Q2Amt = double.Parse(drsp["Q2"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["Q3"].ToString().Trim()))
                                                    Q3Amt = double.Parse(drsp["Q3"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["Q4"].ToString().Trim()))
                                                    Q4Amt = double.Parse(drsp["Q4"].ToString().Trim());
                                                TotalAmount = Q1Amt + Q2Amt + Q3Amt + Q4Amt;

                                            }
                                            else
                                            {
                                                int M1 = 0, M2 = 0, M3 = 0, M4 = 0, M5 = 0, M6 = 0, M7 = 0, M8 = 0, M9 = 0, M10 = 0, M11 = 0, M12 = 0;
                                                double M1Amt = 0, M2Amt = 0, M3Amt = 0, M4Amt = 0, M5Amt = 0, M6Amt = 0, M7Amt = 0, M8Amt = 0, M9Amt = 0, M10Amt = 0,
                                                    M11Amt = 0, M12Amt = 0;

                                                if (!string.IsNullOrEmpty(drsp["M1_MEM"].ToString().Trim()))
                                                    M1 = int.Parse(drsp["M1_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M2_MEM"].ToString().Trim()))
                                                    M2 = int.Parse(drsp["M2_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M3_MEM"].ToString().Trim()))
                                                    M3 = int.Parse(drsp["M3_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M4_MEM"].ToString().Trim()))
                                                    M4 = int.Parse(drsp["M4_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M5_MEM"].ToString().Trim()))
                                                    M5 = int.Parse(drsp["M5_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M6_MEM"].ToString().Trim()))
                                                    M6 = int.Parse(drsp["M6_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M7_MEM"].ToString().Trim()))
                                                    M7 = int.Parse(drsp["M7_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M8_MEM"].ToString().Trim()))
                                                    M8 = int.Parse(drsp["M8_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M9_MEM"].ToString().Trim()))
                                                    M9 = int.Parse(drsp["M9_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M10_MEM"].ToString().Trim()))
                                                    M10 = int.Parse(drsp["M10_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M11_MEM"].ToString().Trim()))
                                                    M11 = int.Parse(drsp["M11_MEM"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M12_MEM"].ToString().Trim()))
                                                    M12 = int.Parse(drsp["M12_MEM"].ToString().Trim());
                                                totcnt = M1 + M2 + M3 + M4 + M5 + M6 + M7 + M8 + M9 + M10 + M11 + M12;

                                                if (!string.IsNullOrEmpty(drsp["M1"].ToString().Trim()))
                                                    M1Amt = double.Parse(drsp["M1"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M2"].ToString().Trim()))
                                                    M2Amt = double.Parse(drsp["M2"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M3"].ToString().Trim()))
                                                    M3Amt = double.Parse(drsp["M3"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M4"].ToString().Trim()))
                                                    M4Amt = double.Parse(drsp["M4"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M5"].ToString().Trim()))
                                                    M5Amt = double.Parse(drsp["M5"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M6"].ToString().Trim()))
                                                    M6Amt = double.Parse(drsp["M6"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M7"].ToString().Trim()))
                                                    M7Amt = double.Parse(drsp["M7"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M8"].ToString().Trim()))
                                                    M8Amt = double.Parse(drsp["M8"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M9"].ToString().Trim()))
                                                    M9Amt = double.Parse(drsp["M9"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M10"].ToString().Trim()))
                                                    M10Amt = double.Parse(drsp["M10"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M11"].ToString().Trim()))
                                                    M11Amt = double.Parse(drsp["M11"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(drsp["M12"].ToString().Trim()))
                                                    M12Amt = double.Parse(drsp["M12"].ToString().Trim());
                                                TotalAmount = M1Amt + M2Amt + M3Amt + M4Amt + M5Amt + M6Amt + M7Amt + M8Amt + M9Amt + M10Amt + M11Amt + M12Amt;

                                            }
                                        }

                                        if (drsp["TARGET_VAL"].ToString() != "0")
                                        {
                                            if (!string.IsNullOrEmpty(drsp["SP2_COUNT_TYPE"].ToString().Trim()))
                                            {
                                                //decimal percent = (decimal.Parse(drsp["YTD"].ToString().Trim() == string.Empty ? "0" : drsp["YTD"].ToString().Trim()) / decimal.Parse(drsp["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : drsp["TARGET_VAL"].ToString().Trim())) * 100;
                                                decimal percent = (decimal.Parse(totcnt.ToString().Trim() == string.Empty ? "0" : totcnt.ToString().Trim()) / decimal.Parse(drsp["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : drsp["TARGET_VAL"].ToString().Trim())) * 100;

                                                Ytd = percent.ToString("0.00");
                                            }
                                            else
                                            {

                                                decimal percent = (decimal.Parse(totcnt.ToString().Trim() == string.Empty ? "0" : totcnt.ToString().Trim()) / decimal.Parse(drsp["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : drsp["TARGET_VAL"].ToString().Trim())) * 100;

                                                Ytd = percent.ToString("0.00");
                                            }
                                        }

                                        string CntType = string.Empty;
                                        if (drsp["SP2_COUNT_TYPE"].ToString() == "A")
                                            CntType = "Amount - Average";
                                        else if (drsp["SP2_COUNT_TYPE"].ToString() == "S")
                                            CntType = "Amount - Sum";
                                        else if (drsp["SP2_COUNT_TYPE"].ToString() == "E")
                                            CntType = "Amount - End of Month";
                                        else if (drsp["SP2_COUNT_TYPE"].ToString() == "C")
                                            CntType = "Client - Average";
                                        else if (drsp["SP2_COUNT_TYPE"].ToString() == "B")
                                            CntType = "Client - Sum";
                                        else if (drsp["SP2_COUNT_TYPE"].ToString() == "D")
                                            CntType = "Client - End of Month";

                                        if (j == 0)
                                        {
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = AgyTable.Rows[0]["SP0_DESCRIPTION"].ToString().Trim();
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = Dept_Match_Color;//oDevExpress_Excel_Properties.gxlBLC_bo;
                                            //SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 25;
                                            _Columnindex++;
                                        }
                                        else
                                        {
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = Dept_Match_Color;//oDevExpress_Excel_Properties.gxlBLC_bo;
                                            //SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 25;
                                            _Columnindex++;
                                        }

                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = CAMSType;
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders;
                                        //SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 25;
                                        _Columnindex++;

                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = drsp["CAMS_DESC"].ToString().Trim();
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                        //SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 25;
                                        _Columnindex++;

                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = CntType;
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders;
                                        //SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 25;
                                        _Columnindex++;

                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(drsp["TARGET_VAL"].ToString());
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                        //SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 25;
                                        _Columnindex++;

                                        if (!string.IsNullOrEmpty(drsp["SP2_COUNT_TYPE"].ToString().Trim()))
                                        {
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = drsp["SP2_COUNT_TYPE"].ToString() == "A" ? drsp["YTD"].ToString() + "%" : drsp["YTD"].ToString();
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders;
                                            //SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 25;
                                            _Columnindex++;
                                        }
                                        else
                                        {
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(totcnt.ToString());
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            //SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 25;
                                            _Columnindex++;
                                        }
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = Ytd == string.Empty ? "" : Ytd + "%";
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders;
                                        //SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 25;
                                        _Columnindex++;

                                        if (rbAmtYes.Checked)
                                        {
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(TotalAmount);
                                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            //SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 25;
                                            _Columnindex++;
                                        }
                                        j++;

                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                        //SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 25;

                                    }
                                    PrivSP = AgyTable.Rows[0]["SP0_DESCRIPTION"].ToString().Trim();
                                }

                                _Rowindex++;
                                _Columnindex = 0;
                                SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 5;
                                _Columnindex++;

                                SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                                if (rbAmtYes.Checked)
                                {
                                    oDevExpress_Excel_Properties.xlRowsMerge(SheetAgyWide, _Rowindex, _Columnindex, 8, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                    _Columnindex = _Columnindex + 8;
                                }
                                else
                                {
                                    oDevExpress_Excel_Properties.xlRowsMerge(SheetAgyWide, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                    _Columnindex = _Columnindex + 7;
                                }
                                SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 5;

                                SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetAgyWide.Rows[_Rowindex][_Columnindex].Style = xlFrameStyle;
                                SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 5;
                            }

                            _Rowindex++;
                            _Columnindex = 0;
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].Value = "©2024 CAPSystems Inc";
                            if (rbAmtYes.Checked)
                            {
                                oDevExpress_Excel_Properties.xlRowsMerge(SheetAgyWide, _Rowindex, _Columnindex, 10, xlFrameFooterStyle);
                            }
                            else
                            {
                                oDevExpress_Excel_Properties.xlRowsMerge(SheetAgyWide, _Rowindex, _Columnindex, 9, xlFrameFooterStyle);
                            }
                            SheetAgyWide.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                            SheetAgyWide.IgnoredErrors.Add(SheetAgyWide.GetDataRange(), DevExpress.Spreadsheet.IgnoredErrorType.NumberAsText);
                        }
                        #endregion
                        #endregion
                    }

                    workbook.Sheets.ActiveSheet = ParamsSheet;
                    workbook.SaveDocument(_excelPath, DevExpress.Spreadsheet.DocumentFormat.OpenXml);
                    try
                    {
                        string localFilePath = _excelPath;
                        FileInfo fiDownload = new FileInfo(localFilePath);
                        /// Need to check for file exists, is local file, is allow to read, etc...
                        string name = fiDownload.Name;
                        using (FileStream fileStream = fiDownload.OpenRead())
                        {
                            Application.Download(fileStream, name);
                        }

                        if (Rb_Details_Yes.Checked && Rb_SP_All.Checked)
                        {
                            if (dtAudit.Rows.Count > 0)
                                On_SaveExcelAudit_Closed_kv_Formatted(_excelPath);
                        }
                    }
                    catch (Exception ex)
                    {
                    }
                }

                #endregion

            }
        }

        private void On_SaveExcelAudit_Closed_kv_Formatted(string PdfFileName)
        {
            string strAppno = "";
            string SPCode = "";
            try
            {
                Random_Filename = null;
                string PdfName = "Pdf File";
                PdfName = PdfFileName.Replace(".xlsx", "_Audit.xlsx");
                try
                {
                    if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                    {
                        DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim());
                    }
                }
                catch (Exception ex)
                {
                    CommonFunctions.MessageBoxDisplay("Error");
                }

                try
                {
                    string Tmpstr = PdfName;//+ ".xlsx";
                    if (File.Exists(Tmpstr))
                        File.Delete(Tmpstr);
                }
                catch (Exception ex)
                {
                    int length = 8;
                    string newFileName = System.Guid.NewGuid().ToString();
                    newFileName = newFileName.Replace("-", string.Empty);

                    Random_Filename = PdfName + newFileName.Substring(0, length) + ".xls";
                }

                if (!string.IsNullOrEmpty(Random_Filename))
                    PdfName = Random_Filename;
                //else
                //    PdfName += ".xls";
                List<string> lstSheetName = new List<string>();
                using (DevExpress.Spreadsheet.Workbook workbook = new DevExpress.Spreadsheet.Workbook())
                {
                    bool First = true;
                    string MS_Type = string.Empty;
                    string CAMSDesc = null;
                    string Branch = null, Priv_Branch = null, SP_Plan_desc = null;
                    bool SPNum = true;
                    Worksheet sheet;
                    WorksheetCell cell;
                    WorksheetRow Row0;
                    int Count = 1;
                    if (dtAudit.Rows.Count > 0)
                    {
                        #region Excel Cell Styles

                        /********************** SET EXCEL FONT PROPERTIES ******************************/
                        DevExpress_Excel_Properties oDevExpress_Excel_Properties = new DevExpress_Excel_Properties();
                        oDevExpress_Excel_Properties.sxlbook = workbook;
                        oDevExpress_Excel_Properties.sxlTitleFont = "Trebuchet MS";
                        oDevExpress_Excel_Properties.sxlbodyFont = "calibri";
                        /*******************************************************************************/
                        oDevExpress_Excel_Properties.getDevexpress_Excel_Properties();

                        #region Custom Styles
                        DevExpress.Spreadsheet.Style xTitleCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 20, "#002060", true, "#ffffff", "center", 1, 1, 1, 1, 1, "Thin", "#FFFFFF", "");//F8F9D0
                        DevExpress.Spreadsheet.Style xTitleCellstyle2 = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 14, "#0070C0", true, "#EEF5FC", "center", 1, 1, 1, 1, 1, "Thin", "#FFFFFF", "");
                        DevExpress.Spreadsheet.Style xsubTitleintakeCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 10, "#0070C0", true, "#F8FBFE", "center", 1, 1, 1, 1, 1, "Thin", "#F8F9D0", "");
                        DevExpress.Spreadsheet.Style xPageTitleCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 16, "#002060", true, "#ffffff", "center", 1, 1, 1, 1, 1, "Thin", "#F8F9D0", "");
                        DevExpress.Spreadsheet.Style reportNameStyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 16, "#002060", true, "#CFE6F9", "center", 1, 1, 1, 1, 1, "Thin", "#FFFFFF", "");
                        DevExpress.Spreadsheet.Style paramsCellStyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", false, "#EEF5FC", "left", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "");

                        DevExpress.Spreadsheet.Style xAgyHeaderCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#FFFFFF", true, "#305496", "left", 1, 1, 1, 1, 1, "Thin", "#305496", "");
                        DevExpress.Spreadsheet.Style xAgyIntakeHeaderCellstyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#FFFFFF", true, "#30963e", "left", 1, 1, 1, 1, 1, "Thin", "#30963e", "");
                        DevExpress.Spreadsheet.Style gxlBCC_sp_cr = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#d3e6f5", "center", 1, 1, 1, 1, 1, "Thin", "#d3e6f5", "");
                        DevExpress.Spreadsheet.Style gxlGCC_sp_cr = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#bee396", "center", 1, 1, 1, 1, 1, "Thin", "#bee396", "");


                        DevExpress.Spreadsheet.Style gxlLBC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 1, 0, 0, 0, "Thin", "#000000", "");
                        DevExpress.Spreadsheet.Style gxlTBC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 1, 0, 0, "Thin", "#000000", "");
                        DevExpress.Spreadsheet.Style gxlRBC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 0, 1, 0, "Thin", "#000000", "");
                        DevExpress.Spreadsheet.Style gxlBBC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 0, 0, 1, "Thin", "#000000", "");

                        DevExpress.Spreadsheet.Style gxlLTBCORN = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 1, 1, 0, 0, "Thin", "#000000", "");
                        DevExpress.Spreadsheet.Style gxlRTBCORN = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 1, 1, 0, "Thin", "#000000", "");
                        DevExpress.Spreadsheet.Style gxlLBBCORN = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 1, 0, 0, 1, "Thin", "#000000", "");
                        DevExpress.Spreadsheet.Style gxlRBBCORN = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", true, "#FFFFFF", "center", 1, 0, 0, 1, 1, "Thin", "#000000", "");

                        DevExpress.Spreadsheet.Style gxlNLC_numeric = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 9, "#000000", false, "#FFFFFF", "left", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");
                        DevExpress.Spreadsheet.Style gxlNCC_numeric = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 9, "#000000", false, "#FFFFFF", "center", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");
                        DevExpress.Spreadsheet.Style gxlNRC_numeric = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 9, "#000000", false, "#FFFFFF", "right", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");

                        DevExpress.Spreadsheet.Style gxlErrBLC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#ebf7ff", "left", 1, 1, 1, 1, 1, "Thin", "#a6c9e8", "");
                        DevExpress.Spreadsheet.Style gxlErrNumb_NRC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "right", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "N");
                        DevExpress.Spreadsheet.Style gxlErrDeci_NRC = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "right", 1, 1, 1, 1, 1, "Thin", "#BFBFBF", "D");
                        DevExpress.Spreadsheet.Style gxlGenerate_cr = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 11, "#0070C0", false, "#FFFFFF", "right", 0, 1, 1, 1, 1, "Thin", "#d3e6f5", "");
                        DevExpress.Spreadsheet.Style gxlGenerate_lr = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlTitleFont, 10, "#0070C0", false, "#FFFFFF", "left", 0, 1, 1, 1, 1, "Thin", "#d3e6f5", "");

                        #region Vikash added following Styles for formatting

                        DevExpress.Spreadsheet.Style xlFrameStyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 12, "#FFFFFF", false, "#1A4777", "left", 1, 1, 1, 1, 1, "Thin", "#1A4777", "");
                        DevExpress.Spreadsheet.Style xlFrameStyleR = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 12, "#FFFFFF", false, "#1A4777", "right", 1, 1, 1, 1, 1, "Thin", "#1A4777", "");
                        DevExpress.Spreadsheet.Style xlFrameBlockStyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 12, "#1A4777", true, "#b8d9ff", "center", 1, 1, 1, 1, 1, "Thin", "#b8d9ff", "");
                        DevExpress.Spreadsheet.Style xlFrameBlockStyleLeft = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 12, "#1A4777", true, "#b8d9ff", "left", 1, 1, 1, 1, 1, "Thin", "#b8d9ff", "");
                        DevExpress.Spreadsheet.Style xlFrameFooterStyle = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#FFFFFF", false, "#1A4777", "right", 1, 1, 1, 1, 1, "Thin", "#1A4777", "");

                        DevExpress.Spreadsheet.Style gxlErrBCC_blueBorders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "center", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "");
                        DevExpress.Spreadsheet.Style gxlErrNumb_NCC_blueBorders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "center", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "N");
                        DevExpress.Spreadsheet.Style gxlErrDeci_NCC_blueBorders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "center", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "D");
                        DevExpress.Spreadsheet.Style gxlErrBLCW_blueBorders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#fc0303", false, "#FFFFFF", "left", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "");

                        DevExpress.Spreadsheet.Style gxlGLC_blueBorders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", false, "#f0ffff", "left", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "");
                        DevExpress.Spreadsheet.Style gxlGRC_blueBorders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", false, "#f0ffff", "right", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "");
                        DevExpress.Spreadsheet.Style gxlDeci_GRC_blueBorders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", false, "#f0ffff", "right", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "D");
                        DevExpress.Spreadsheet.Style gxlNumb_GRC_blueBorders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#000000", false, "#f0ffff", "right", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "N");

                        DevExpress.Spreadsheet.Style gxlDBLC_Blue_Borders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#1A4777", false, "#FFFFFF", "left", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "");
                        DevExpress.Spreadsheet.Style gxlDeci_DBRC_Blue_Borders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#1A4777", false, "#FFFFFF", "right", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "D");
                        DevExpress.Spreadsheet.Style gxlNumb_DBRC_Blue_Borders = oDevExpress_Excel_Properties.xfnCELL_STYLE(workbook, oDevExpress_Excel_Properties.sxlbodyFont, 8, "#1A4777", false, "#FFFFFF", "right", 1, 1, 1, 1, 1, "Thin", "#B8D9FF", "N");

                        #endregion

                        #endregion

                        #endregion
                        DevExpress.Spreadsheet.Worksheet ParamsSheet = workbook.Worksheets[0];
                        //this.GenerateWorksheetParameters(book.Worksheets);

                        #region Parameters Sheet

                        ParamsSheet.Name = "Parameters";
                        ParamsSheet.ActiveView.ShowGridlines = false;

                        ParamsSheet.Columns[1].Width = 200;
                        ParamsSheet.Columns[2].Width = 300;
                        ParamsSheet.Columns[3].Width = 200;
                        ParamsSheet.Columns[4].Width = 500;
                        ParamsSheet.Columns[5].Width = 200;
                        ParamsSheet.Columns[6].Width = 200;
                        ParamsSheet.Columns[7].Width = 230;//200;
                        ParamsSheet.Columns[8].Width = 200;
                        ParamsSheet.Columns[9].Width = 600;

                        string strAgy = Current_Hierarchy_DB.Split('-')[0];

                        AgencyControlEntity BAgyControlDetails = _model.ZipCodeAndAgency.GetAgencyControlFile(strAgy);

                        string ImgName = "";
                        if (BaseForm.BaseAgencyControlDetails.AgyShortName == "NEOCAA")
                        {
                            ImgName = "NEOCAA_" + strAgy + "_LOGO.png";
                        }
                        else
                            ImgName = BaseForm.BaseAgencyControlDetails.AgyShortName + "_00_LOGO.png";

                        int _Rowindex = 1;
                        int _Columnindex = 1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = BAgyControlDetails.AgyName;// "Community Action Resource & Development";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = xTitleCellstyle; //  oDevExpress_Excel_Properties.gxlTitle_CellStyle1; //
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);
                        _Rowindex++;

                        string imagesPath = "https://capsysdev.capsystems.com/images/PIPlogos/" + ImgName;  // Application.MapPath("\\Resources\\Images\\NEOCAA_02_LOGO.png");
                                                                                                  //DevExpress.Spreadsheet.Picture pic = ParamsSheet.Pictures.AddPicture(imagesPath, 700, 80, 630, 280);
                        DevExpress.Spreadsheet.SpreadsheetImageSource imgsrc = DevExpress.Spreadsheet.SpreadsheetImageSource.FromUri(imagesPath, workbook);
                        DevExpress.Spreadsheet.Picture pic = ParamsSheet.Pictures.AddPicture(imgsrc, 200, 0, 630, 280);


                        AgencyControlEntity _agycntrldets = new AgencyControlEntity();
                        _agycntrldets = BaseForm.BaseAgencyControlDetails;

                        if (BaseForm.BaseAgencyControlDetails.AgyShortName == "NEOCAA")
                            _agycntrldets = BAgyControlDetails;
                        else
                            _agycntrldets = BaseForm.BaseAgencyControlDetails;

                        string strAddress = _agycntrldets.Street + ", " + _agycntrldets.City + ", " + _agycntrldets.State + ", " + _agycntrldets.Zip1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = strAddress;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);


                        _Rowindex = 4;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = PrivilegeEntity.PrivilegeName;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = reportNameStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);

                        _Rowindex = 5;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "Report Parameters";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = xTitleCellstyle2; // oDevExpress_Excel_Properties.gxlTitle_CellStyle1;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);
                        _Rowindex++;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = txtHieDesc.Text.Trim();
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = xsubTitleintakeCellstyle; // oDevExpress_Excel_Properties.gxlTitle_CellStyle1;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);
                        _Rowindex++;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "";
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 9);
                        _Rowindex++;

                        //** PARAMETERS LIST **//
                        string caseType = string.Empty;
                        caseType = ((Captain.Common.Utilities.ListItem)Cmb_CaseType.SelectedItem).Text.ToString().Trim();

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblCaseType.Text.Trim();
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        //ParamsSheet.Rows[_Rowindex][_Columnindex+1].Style = paramsCellStyle;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = caseType;
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;



                        string strSelectedSP = Search_Entity.ZipCode;
                        strSelectedSP = strSelectedSP.Replace("'", "");

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblServiceplan.Text;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (Rb_SP_All.Checked ? "All" : strSelectedSP);
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;
                        string caseStatus = Rb_Stat_Both.Text;

                        if (Rb_Stat_Act.Checked == true)
                            caseStatus = Rb_Stat_Act.Text;
                        else if (Rb_Stat_InAct.Checked == true)
                            caseStatus = Rb_Stat_InAct.Text;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblCaseStatus.Text;
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = caseStatus;
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;


                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblDateSelection.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (Rb_MS_Date.Checked == true ? Rb_MS_Date.Text : Rb_MS_AddDate.Text);
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);

                        _Rowindex++;
                        _Columnindex = 1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblRepDesc.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = ((Captain.Common.Utilities.ListItem)cmbRngCode.SelectedItem).Text.ToString().Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;


                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblReportType.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (rbQuaterly.Checked == true ? rbQuaterly.Text : rbMonthly.Text);
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "Report Period Control";
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (chkbReportPeriod.Checked == true ? "Yes" : "No");
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;


                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblProduceStatistical.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (Rb_Details_No.Checked == true ? Rb_Details_No.Text : Rb_Details_Yes.Text);
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblPovertyLevel.Text.Trim();
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblLow.Text + ": " + Txt_Pov_Low.Text + "      " + lblHigh.Text + ": " + Txt_Pov_High.Text;
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;


                        string selectedCounty = Search_Entity.County;
                        selectedCounty = selectedCounty.Replace("'", "");

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblCounty.Text.Trim();
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (Rb_County_All.Checked ? "All" : selectedCounty);
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;
                        string secretApp = Rb_Mst_NonSec.Text;

                        if (Rb_Mst_Sec.Checked == true)
                            secretApp = Rb_Mst_Sec.Text;
                        else if (Rb_Mst_BothSec.Checked == true)
                            secretApp = Rb_Mst_BothSec.Text;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblSecretApplications.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = secretApp;
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblAmounts.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (rbAmtNo.Checked ? "No" : "Yes");
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);


                        _Rowindex++;
                        _Columnindex = 1;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblAgyWideRep.Text.Trim();
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (rbAWRNo.Checked ? "No" : "Yes");
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);
                        //_Columnindex++;

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = " ";
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        _Columnindex++;

                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = lblOutCounCntrl.Text.Trim();//"";
                        // ParamsSheet.Rows[_Rowindex][_Columnindex].Style = paramsCellStyle;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, paramsCellStyle);

                        string selectedResults = Search_Entity.Results;
                        selectedResults = selectedResults.Replace("'", "");

                        _Columnindex = _Columnindex + 2;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = (rdbOCC_All.Checked ? "All" : selectedResults);//"";
                        //ParamsSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2, oDevExpress_Excel_Properties.gxlNLC);

                        _Rowindex = _Rowindex + 3;
                        _Columnindex = 8;//9;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "Generated By: " + BaseForm.UserID;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = gxlGenerate_lr;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2);
                        _Rowindex++;
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Value = "Generated On: " + DateTime.Now.ToString("MM/dd/yyyy hh:mm:ss tt");
                        ParamsSheet.Rows[_Rowindex][_Columnindex].Style = gxlGenerate_lr;
                        xlRowsMerge(ParamsSheet, _Rowindex, _Columnindex, 2);

                        ParamsSheet.IgnoredErrors.Add(ParamsSheet.GetDataRange(), DevExpress.Spreadsheet.IgnoredErrorType.NumberAsText);
                        #endregion

                        string PrivSP = string.Empty;

                        var distinctRows = (from DataRow dRow in dtAudit.Rows
                                            select dRow["SP"]).Distinct();


                        _Rowindex = 0;
                        _Columnindex = 0;
                        workbook.Unit = DevExpress.Office.DocumentUnit.Point;
                        //string PrivSP = string.Empty;
                        foreach (var dRow in distinctRows)
                        {
                            SPCode = dRow.ToString();
                            DataTable dataTable = new DataTable();
                            DataView dv = new DataView(dtAudit);
                            dv.RowFilter = "SP='" + dRow + "'";
                            if (Rb_MS_Date.Checked)
                                dv.Sort = "CAMS_DATE";
                            else
                                dv.Sort = "CAMS_DATE_ADD";
                            dataTable = dv.ToTable();

                            if (dataTable.Rows.Count > 0)
                            {
                                string ReportName = dataTable.Rows[0]["SP_Desc"].ToString();
                                ReportName = ReportName.Replace("/", "");

                                if (ReportName.Length >= 31)
                                {
                                    ReportName = ReportName.Substring(0, 30);
                                }

                                bool chkSheetName = lstSheetName.Any(x => x.Contains(ReportName));
                                if (chkSheetName)
                                {
                                    ReportName = ReportName + (lstSheetName.Where(x => x.Contains(ReportName)).Count() + 1);
                                }
                                lstSheetName.Add(ReportName);

                                DevExpress.Spreadsheet.Worksheet SheetDetails = workbook.Worksheets.Add(ReportName);
                                SheetDetails.ActiveView.ShowGridlines = false;
                                _Rowindex = 0;
                                _Columnindex = 0;
                                workbook.Unit = DevExpress.Office.DocumentUnit.Point;


                                SheetDetails.Columns[0].Width = 270;
                                SheetDetails.Columns[1].Width = 75;
                                SheetDetails.Columns[2].Width = 30;
                                SheetDetails.Columns[3].Width = 45;
                                SheetDetails.Columns[4].Width = 80;
                                SheetDetails.Columns[5].Width = 75;
                                SheetDetails.Columns[6].Width = 70;
                                SheetDetails.Columns[7].Width = 60;
                                SheetDetails.Columns[8].Width = 145;
                                SheetDetails.Columns[9].Width = 145;
                                SheetDetails.Columns[10].Width = 145;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = PrivilegeEntity.PrivilegeName.Trim().ToUpper() + "/" + "AUDIT";
                                oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 11, xlFrameStyle);
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;

                                _Rowindex++;
                                _Columnindex = 0;

                                //string _Hierarchy = string.Empty;
                                //if (dataTable.Rows[0]["Hierarchy"].ToString() != "")
                                //{
                                //    _Hierarchy = dataTable.Rows[0]["Hierarchy"].ToString().Substring(0, 2) + "-" + dataTable.Rows[0]["Hierarchy"].ToString().Substring(2, 2) + "-" + dataTable.Rows[0]["Hierarchy"].ToString().Substring(4, 2);
                                //}

                                //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                //SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                //_Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = dataTable.Rows[0]["SP_Desc"].ToString().Trim();
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 4, xlFrameBlockStyle);
                                _Columnindex = _Columnindex + 4;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyle;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 6, xlFrameBlockStyle);
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;

                                _Rowindex++;
                                _Columnindex = 0;
                                xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 11, xlFrameStyle);
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                                _Rowindex++;
                                _Columnindex = 0;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Description";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Date";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                if (rbQuaterly.Checked)
                                {
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Q#";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                    _Columnindex++;
                                }
                                else
                                {
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "M#";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                    _Columnindex++;
                                }

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Clients";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Total Clients";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Detail Amt.";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Total Amt.";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;


                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "App No";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Name";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Case Worker";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Site";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = xlFrameBlockStyleLeft;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.IgnoredErrors.Add(SheetDetails.GetDataRange(), DevExpress.Spreadsheet.IgnoredErrorType.NumberAsText);

                                int i = 0;
                                string QM_type = string.Empty;
                                int QM_Count = 0;
                                string Serv = string.Empty;
                                string PrivClID = string.Empty;
                                int PrvCnt = 0;
                                strAppno = "";
                                foreach (DataRow dr in dataTable.Rows)
                                {
                                    strAppno = dr["AppNo"].ToString();

                                    if (strAppno == "00000003")
                                    {
                                        string xx = "0";
                                    }

                                    string CAMSType = string.Empty;
                                    if (dr["SP2_TYPE"].ToString().Trim() == "CA")
                                        CAMSType = "Service";
                                    else
                                        CAMSType = "Outcome";


                                    if (rbQuaterly.Checked)
                                    {
                                        if (dr["Q_SEC"].ToString().Trim() != QM_type || dr["CAMS_CODE"].ToString().Trim() != Serv)
                                        {
                                            i++;
                                        }
                                    }
                                    else
                                    {
                                        if (dr["M_SEC"].ToString().Trim() != QM_type || dr["CAMS_CODE"].ToString().Trim() != Serv)
                                        {
                                            i++;
                                        }
                                    }

                                    if (rbQuaterly.Checked)
                                        QM_type = dr["Q_SEC"].ToString().Trim();
                                    else
                                        QM_type = dr["M_SEC"].ToString().Trim();

                                    Serv = dr["CAMS_CODE"].ToString().Trim();

                                    var x = (i % 2);

                                    _Rowindex++;
                                    _Columnindex = 0;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["CAMS_DESC"].ToString().Trim();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                    _Columnindex++;

                                    if (Rb_MS_Date.Checked)
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                        _Columnindex++;
                                    }

                                    else
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                        _Columnindex++;
                                    }
                                    if (rbQuaterly.Checked)
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Q_SEC"].ToString();
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                        _Columnindex++;
                                    }
                                    else
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["M_SEC"].ToString();
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                        _Columnindex++;
                                    }

                                    if (dr["Count_Type"].ToString().Trim() == "B" || dr["Count_Type"].ToString().Trim() == "C" || dr["Count_Type"].ToString().Trim() == "D")
                                    {
                                        if (dr["CASEMS_COST"].ToString() != "")
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["CASEMS_COST"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDeci_DBRC_Blue_Borders : gxlDeci_GRC_blueBorders);
                                        _Columnindex++;

                                        if (dr["TotCnt"].ToString() != "")
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["TotCnt"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDeci_DBRC_Blue_Borders : gxlDeci_GRC_blueBorders);
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                        _Columnindex++;
                                    }
                                    else if (dr["Count_Type"].ToString().Trim() == "S" || dr["Count_Type"].ToString().Trim() == "A" || dr["Count_Type"].ToString().Trim() == "E")
                                    {
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                        _Columnindex++;

                                        if (dr["CASEMS_COST"].ToString() != "")
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["CASEMS_COST"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDeci_DBRC_Blue_Borders : gxlDeci_GRC_blueBorders);
                                        _Columnindex++;

                                        if (dr["TotCnt"].ToString() != "")
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["TotCnt"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDeci_DBRC_Blue_Borders : gxlDeci_GRC_blueBorders);
                                        _Columnindex++;
                                    }
                                    else
                                    {
                                        if (dr["cnt"].ToString() != "")
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["cnt"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlNumb_DBRC_Blue_Borders : gxlNumb_GRC_blueBorders);
                                        _Columnindex++;

                                        if (!string.IsNullOrEmpty(dr["TotCnt"].ToString().Trim()))
                                        {
                                            if (dr["cnt"].ToString() != "")
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToInt32(dr["cnt"].ToString());
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlNumb_DBRC_Blue_Borders : gxlNumb_GRC_blueBorders);
                                            _Columnindex++;
                                        }
                                        else
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = 0;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlNumb_DBRC_Blue_Borders : gxlDeci_GRC_blueBorders);
                                            _Columnindex++;
                                        }

                                        if (dr["CASEMS_COST"].ToString() != "")
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["CASEMS_COST"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDeci_DBRC_Blue_Borders : gxlDeci_GRC_blueBorders);
                                        _Columnindex++;

                                        if (dr["TotCnt"].ToString() != "")
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Convert.ToDecimal(dr["TotCnt"].ToString());
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDeci_DBRC_Blue_Borders : gxlDeci_GRC_blueBorders);
                                        _Columnindex++;
                                    }

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["AppNo"].ToString();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["Name"].ToString();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["CAMS_WORKER"].ToString();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = dr["CAMS_SITE"].ToString();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = (x == 0 ? gxlDBLC_Blue_Borders : gxlGLC_blueBorders);
                                    _Columnindex++;

                                    PrivClID = dr["Client_ID"].ToString().Trim();
                                    PrvCnt = QM_Count;
                                }
                                SheetDetails.IgnoredErrors.Add(SheetDetails.GetDataRange(), DevExpress.Spreadsheet.IgnoredErrorType.NumberAsText);
                            }


                        }

                        workbook.Sheets.ActiveSheet = ParamsSheet;
                        workbook.SaveDocument(PdfName, DevExpress.Spreadsheet.DocumentFormat.OpenXml);

                        try
                        {
                            string localFilePath = PdfName;
                            /// Need to check for null value of localFilePath, etc...
                            FileInfo fiDownload = new FileInfo(localFilePath);
                            /// Need to check for file exists, is local file, is allow to read, etc...
                            string name = fiDownload.Name;
                            using (FileStream fileStream = fiDownload.OpenRead())
                            {
                                Application.Download(fileStream, name);
                            }


                        }
                        catch (Exception ex)
                        {
                        }
                        AlertBox.Show("Audit Report Generated Successfully");
                    }
                }

            }
            catch (Exception ex)
            {
                string errMsg = strAppno + "  | SP:" + SPCode + "   " + ex.Message;
            }


        }

        #endregion
        private void xlRowsMerge(DevExpress.Spreadsheet.Worksheet worksheet, int Rowindex, int ColumnIndex, int numberOfColumns)
        {
            DevExpress.Spreadsheet.CellRange range = worksheet.Range.FromLTRB(ColumnIndex, Rowindex, ColumnIndex + numberOfColumns - 1, Rowindex);
            worksheet.MergeCells(range);

            // Optionally, customize merged cell appearance
            // Cell mergedCell = worksheet.Cells[Rowindex, ColumnIndex];
        }
        private void xlRowsMerge(DevExpress.Spreadsheet.Worksheet worksheet, int Rowindex, int ColumnIndex, int numberOfColumns, DevExpress.Spreadsheet.Style _cellStyle)
        {
            DevExpress.Spreadsheet.CellRange range = worksheet.Range.FromLTRB(ColumnIndex, Rowindex, ColumnIndex + numberOfColumns - 1, Rowindex);
            worksheet.MergeCells(range);
            range.Style = _cellStyle;
            // Optionally, customize merged cell appearance
            // Cell mergedCell = worksheet.Cells[Rowindex, ColumnIndex];
        }
        private void xlColsMerge(DevExpress.Spreadsheet.Worksheet worksheet, int startRowindex, int ColumnIndex, int endRowIndex)
        {
            //CellRange mergeRange = worksheet.Range.FromLTRB(0, Rowindex - 1, 0, numberOfRows - 2);
            DevExpress.Spreadsheet.CellRange mergeRange = worksheet.Range.FromLTRB(ColumnIndex, startRowindex, ColumnIndex, endRowIndex - 1);
            worksheet.MergeCells(mergeRange);


        }
        private void On_SaveExcelForm_Closed(object sender, FormClosedEventArgs e)
        {
            Random_Filename = null;
            PdfListForm form = sender as PdfListForm;
            if (form.DialogResult == DialogResult.OK)
            {
                Random_Filename = null;
                string PdfName = "Pdf File";
                PdfName = form.GetFileName();
                string PdfFileName = PdfName;
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                try
                {
                    if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                    {
                        DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim());
                    }
                }
                catch (Exception ex)
                {
                    CommonFunctions.MessageBoxDisplay("Error");
                }

                try
                {
                    string Tmpstr = PdfName + ".xls";
                    if (File.Exists(Tmpstr))
                        File.Delete(Tmpstr);
                }
                catch (Exception ex)
                {
                    int length = 8;
                    string newFileName = System.Guid.NewGuid().ToString();
                    newFileName = newFileName.Replace("-", string.Empty);

                    Random_Filename = PdfName + newFileName.Substring(0, length) + ".xls";
                }

                if (!string.IsNullOrEmpty(Random_Filename))
                    PdfName = Random_Filename;
                else
                    PdfName += ".xls";

                Workbook book = new Workbook();

                this.GenerateStyles(book.Styles);



                bool First = true;
                string MS_Type = string.Empty;
                string CAMSDesc = null;
                string Branch = null, Priv_Branch = null, SP_Plan_desc = null;
                bool SPNum = true;
                Worksheet sheet;
                WorksheetCell cell;
                WorksheetRow Row0;
                int Count = 1;


                if (dt.Rows.Count > 0)
                {
                    this.GenerateWorksheetParameters(book.Worksheets);

                    string PrivSP = string.Empty;

                    var distinctRows = (from DataRow dRow in dt.Rows
                                        select dRow["SP0_SERVICECODE"]).Distinct();

                    foreach (var dRow in distinctRows)
                    {
                        DataTable dataTable = new DataTable();
                        DataView dv = new DataView(dt);
                        dv.RowFilter = "SP0_SERVICECODE='" + dRow + "'";
                        dataTable = dv.ToTable();

                        if (dataTable.Rows.Count > 0)
                        {
                            string ReportName = dataTable.Rows[0]["SP0_DESCRIPTION"].ToString();
                            ReportName = ReportName.Replace("/", "");

                            if (ReportName.Length >= 31)
                            {
                                ReportName = ReportName.Substring(0, 31);
                            }
                            sheet = book.Worksheets.Add(ReportName);
                            sheet.Table.DefaultRowHeight = 14.25F;

                            if (rbQuaterly.Checked)
                            {
                                sheet.Table.Columns.Add(200);
                                sheet.Table.Columns.Add(100);
                                sheet.Table.Columns.Add(80);//(150);
                                sheet.Table.Columns.Add(80);//75);

                                if (rbAmtYes.Checked)
                                {
                                    sheet.Table.Columns.Add(80);
                                    sheet.Table.Columns.Add(80);
                                    sheet.Table.Columns.Add(80);
                                    sheet.Table.Columns.Add(80);
                                    sheet.Table.Columns.Add(80);
                                    sheet.Table.Columns.Add(80);
                                    sheet.Table.Columns.Add(80);
                                    sheet.Table.Columns.Add(80);
                                    sheet.Table.Columns.Add(80);
                                }
                                else
                                {
                                    sheet.Table.Columns.Add(140);
                                    sheet.Table.Columns.Add(140);
                                    sheet.Table.Columns.Add(140);
                                    sheet.Table.Columns.Add(140);
                                }

                                sheet.Table.Columns.Add(110);
                                sheet.Table.Columns.Add(110);

                                Row0 = sheet.Table.Rows.Add();
                                Row0.AutoFitHeight = false;
                                Row0.Height = 20;
                                //WorksheetCell cell;
                                cell = Row0.Cells.Add();
                                cell.StyleID = "s83";
                                cell.Data.Type = DataType.String;
                                cell.Data.Text = dataTable.Rows[0]["SP0_DESCRIPTION"].ToString();

                                if (rbAmtNo.Checked)
                                    cell.MergeAcross = 9;
                                else
                                    cell.MergeAcross = 14;//13;

                                Row0 = sheet.Table.Rows.Add();
                                Row0.Height = 20;
                                cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");
                                cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");
                                cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");
                                cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");

                                string Q1val = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ1S.Value.Month.ToString())) + "-" + dtpQ1S.Value.Year.ToString() + " - " +
                                                CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ1E.Value.Month.ToString())) + "-" + dtpQ1E.Value.Year.ToString();
                                cell = Row0.Cells.Add(Q1val, DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;
                                string Q2val = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ2S.Value.Month.ToString())) + "-" + dtpQ2S.Value.Year.ToString() + " - " +
                                                CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ2E.Value.Month.ToString())) + "-" + dtpQ2E.Value.Year.ToString();
                                cell = Row0.Cells.Add(Q2val, DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;
                                string Q3val = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ3S.Value.Month.ToString())) + "-" + dtpQ3S.Value.Year.ToString() + " - " +
                                                CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ3E.Value.Month.ToString())) + "-" + dtpQ3E.Value.Year.ToString();
                                cell = Row0.Cells.Add(Q3val, DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;
                                string Q4val = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ4S.Value.Month.ToString())) + "-" + dtpQ4S.Value.Year.ToString() + " - " +
                                                CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ4E.Value.Month.ToString())) + "-" + dtpQ4E.Value.Year.ToString();
                                cell = Row0.Cells.Add(Q4val, DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;

                                cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;
                                cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");

                                Row0 = sheet.Table.Rows.Add();
                                Row0.Height = 20;
                                cell = Row0.Cells.Add("Description", DataType.String, "MainHeaderStylesLeft");
                                cell = Row0.Cells.Add("Aggregate Func.", DataType.String, "MainHeaderStylesLeft");
                                cell = Row0.Cells.Add("Type", DataType.String, "MainHeaderStylesLeft");
                                cell = Row0.Cells.Add("Target", DataType.String, "MainHeaderStylesRight");
                                //string monthName = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ1S.Value.Month.ToString()));
                                //string Q1val = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ1S.Value.Month.ToString())) + "-" + dtpQ1S.Value.Year.ToString()+" - "+
                                //                CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ1E.Value.Month.ToString())) + "-" + dtpQ1E.Value.Year.ToString();
                                cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                    cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");
                                //string Q2val = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ2S.Value.Month.ToString())) + "-" + dtpQ2S.Value.Year.ToString() + " - " +
                                //                CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ2E.Value.Month.ToString())) + "-" + dtpQ2E.Value.Year.ToString();
                                cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                    cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");
                                //string Q3val = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ3S.Value.Month.ToString())) + "-" + dtpQ3S.Value.Year.ToString() + " - " +
                                //                CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ3E.Value.Month.ToString())) + "-" + dtpQ3E.Value.Year.ToString();
                                cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                    cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");
                                //string Q4val = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ4S.Value.Month.ToString())) + "-" + dtpQ4S.Value.Year.ToString() + " - " +
                                //                CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(dtpQ4E.Value.Month.ToString())) + "-" + dtpQ4E.Value.Year.ToString();
                                cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                {
                                    cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");
                                    cell = Row0.Cells.Add("Amount YTD", DataType.String, "MainHeaderStylesRight");
                                }
                                cell = Row0.Cells.Add("Clients YTD", DataType.String, "MainHeaderStylesRight");
                                cell = Row0.Cells.Add("YTD %", DataType.String, "MainHeaderStylesRight");


                                int i = 0;
                                foreach (DataRow dr in dataTable.Rows)
                                {
                                    Row0 = sheet.Table.Rows.Add();
                                    //Row0.Height = 16;

                                    string CAMSType = string.Empty;
                                    if (dr["SP2_TYPE"].ToString().Trim() == "CA")
                                        CAMSType = "Service";
                                    else
                                        CAMSType = "Outcome";

                                    string Ytd = string.Empty;
                                    if (dr["TARGET_VAL"].ToString() != "0")
                                    {
                                        if (!string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                        {
                                            decimal percent = (decimal.Parse(dr["YTD"].ToString().Trim() == string.Empty ? "0" : dr["YTD"].ToString().Trim()) / decimal.Parse(dr["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : dr["TARGET_VAL"].ToString().Trim())) * 100;

                                            Ytd = percent.ToString("0.00");
                                        }
                                        else
                                        {
                                            int totcnt = 0, Q1 = 0, Q2 = 0, Q3 = 0, Q4 = 0;
                                            if (!string.IsNullOrEmpty(dr["Q1_Cnt"].ToString().Trim()))
                                                Q1 = int.Parse(dr["Q1_Cnt"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(dr["Q2_Cnt"].ToString().Trim()))
                                                Q2 = int.Parse(dr["Q2_Cnt"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(dr["Q3_Cnt"].ToString().Trim()))
                                                Q3 = int.Parse(dr["Q3_Cnt"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(dr["Q4_Cnt"].ToString().Trim()))
                                                Q4 = int.Parse(dr["Q4_Cnt"].ToString().Trim());
                                            totcnt = Q1 + Q2 + Q3 + Q4;

                                            decimal percent = (decimal.Parse(totcnt.ToString().Trim() == string.Empty ? "0" : totcnt.ToString().Trim()) / decimal.Parse(dr["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : dr["TARGET_VAL"].ToString().Trim())) * 100;

                                            Ytd = percent.ToString("0.00");
                                        }
                                    }

                                    string CntType = string.Empty;
                                    if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                        CntType = "Amount - Average";
                                    else if (dr["SP2_COUNT_TYPE"].ToString() == "S")
                                        CntType = "Amount - Sum";
                                    else if (dr["SP2_COUNT_TYPE"].ToString() == "E")
                                        CntType = "Amount - End of Month";
                                    else if (dr["SP2_COUNT_TYPE"].ToString() == "C")
                                        CntType = "Client - Average";
                                    else if (dr["SP2_COUNT_TYPE"].ToString() == "B")
                                        CntType = "Client - Sum";
                                    else if (dr["SP2_COUNT_TYPE"].ToString() == "D")
                                        CntType = "Client - End of Month";


                                    if (i % 2 == 0)
                                    {
                                        if (dr["SP2_ACTIVE"].ToString() == "A")
                                        {
                                            cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s105");


                                            cell = Row0.Cells.Add(CntType, DataType.String, "s105");

                                            cell = Row0.Cells.Add(CAMSType, DataType.String, "s105");
                                            cell = Row0.Cells.Add(dr["TARGET_VAL"].ToString(), DataType.String, "s106");

                                            if (dr["SP2_COUNT_TYPE"].ToString() == "B" || dr["SP2_COUNT_TYPE"].ToString() == "C" || dr["SP2_COUNT_TYPE"].ToString() == "D")
                                            {
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106");

                                            }
                                            else if (dr["SP2_COUNT_TYPE"].ToString() == "S" || dr["SP2_COUNT_TYPE"].ToString() == "A" || dr["SP2_COUNT_TYPE"].ToString() == "E")
                                            {
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s106");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s106");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s106");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                            }
                                            else
                                            {
                                                cell = Row0.Cells.Add(dr["Q1_Cnt"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["Q2_Cnt"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["Q3_Cnt"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["Q4_Cnt"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s106");

                                                int totcnt = 0, Q1 = 0, Q2 = 0, Q3 = 0, Q4 = 0;
                                                if (!string.IsNullOrEmpty(dr["Q1_Cnt"].ToString().Trim()))
                                                    Q1 = int.Parse(dr["Q1_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(dr["Q2_Cnt"].ToString().Trim()))
                                                    Q2 = int.Parse(dr["Q2_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(dr["Q3_Cnt"].ToString().Trim()))
                                                    Q3 = int.Parse(dr["Q3_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(dr["Q4_Cnt"].ToString().Trim()))
                                                    Q4 = int.Parse(dr["Q4_Cnt"].ToString().Trim());
                                                totcnt = Q1 + Q2 + Q3 + Q4;

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106");
                                                cell = Row0.Cells.Add(totcnt == 0 ? "" : totcnt.ToString(), DataType.String, "s106");
                                            }

                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106");
                                            cell = Row0.Cells.Add(Ytd == string.Empty ? "" : Ytd + "%", DataType.String, "s106");

                                            //    if (string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                            //    cell = Row0.Cells.Add(dr["Q1_Cnt"].ToString(), DataType.String, "s106");
                                            //else
                                            //    cell = Row0.Cells.Add("", DataType.String, "s106");


                                            //if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                            //{
                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s106");
                                            //if (string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                            //    cell = Row0.Cells.Add(dr["Q2_Cnt"].ToString(), DataType.String, "s106");
                                            //else
                                            //    cell = Row0.Cells.Add("", DataType.String, "s106");
                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s106");
                                            //if (string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                            //    cell = Row0.Cells.Add(dr["Q3_Cnt"].ToString(), DataType.String, "s106");
                                            //else
                                            //    cell = Row0.Cells.Add("", DataType.String, "s106");
                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s106");
                                            //if (string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                            //    cell = Row0.Cells.Add(dr["Q4_Cnt"].ToString(), DataType.String, "s106");
                                            //else
                                            //    cell = Row0.Cells.Add("", DataType.String, "s106");
                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s106");
                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106");
                                            //cell = Row0.Cells.Add(Ytd == string.Empty ? "" : Ytd + "%", DataType.String, "s106");
                                            ////}
                                            ////else
                                            ////{
                                            ////    cell = Row0.Cells.Add(dr["Q1"].ToString(), DataType.String, "s106");
                                            ////    cell = Row0.Cells.Add(dr["Q2"].ToString(), DataType.String, "s106");
                                            ////    cell = Row0.Cells.Add(dr["Q3"].ToString(), DataType.String, "s106");
                                            ////    cell = Row0.Cells.Add(dr["Q4"].ToString(), DataType.String, "s106");
                                            ////    cell = Row0.Cells.Add(dr["YTD"].ToString(), DataType.String, "s106");
                                            ////    cell = Row0.Cells.Add(Ytd, DataType.String, "s106");
                                            ////}
                                        }
                                        else
                                        {
                                            cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s105R");

                                            cell = Row0.Cells.Add(CntType, DataType.String, "s105R");
                                            cell = Row0.Cells.Add(CAMSType, DataType.String, "s105R");
                                            cell = Row0.Cells.Add(dr["TARGET_VAL"].ToString(), DataType.String, "s106R");

                                            if (dr["SP2_COUNT_TYPE"].ToString() == "B" || dr["SP2_COUNT_TYPE"].ToString() == "C" || dr["SP2_COUNT_TYPE"].ToString() == "D")
                                            {
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106R");

                                            }
                                            else if (dr["SP2_COUNT_TYPE"].ToString() == "S" || dr["SP2_COUNT_TYPE"].ToString() == "A" || dr["SP2_COUNT_TYPE"].ToString() == "E")
                                            {
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s106R");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s106R");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s106R");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s106R");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106R");
                                                else
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                            }
                                            else
                                            {
                                                cell = Row0.Cells.Add(dr["Q1_Cnt"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["Q2_Cnt"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["Q3_Cnt"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["Q4_Cnt"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s106R");

                                                int totcnt = 0, Q1 = 0, Q2 = 0, Q3 = 0, Q4 = 0;
                                                if (!string.IsNullOrEmpty(dr["Q1_Cnt"].ToString().Trim()))
                                                    Q1 = int.Parse(dr["Q1_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(dr["Q2_Cnt"].ToString().Trim()))
                                                    Q2 = int.Parse(dr["Q2_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(dr["Q3_Cnt"].ToString().Trim()))
                                                    Q3 = int.Parse(dr["Q3_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(dr["Q4_Cnt"].ToString().Trim()))
                                                    Q4 = int.Parse(dr["Q4_Cnt"].ToString().Trim());
                                                totcnt = Q1 + Q2 + Q3 + Q4;

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106R");
                                                cell = Row0.Cells.Add(totcnt == 0 ? "" : totcnt.ToString(), DataType.String, "s106R");
                                            }

                                            //if (string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                            //    cell = Row0.Cells.Add(dr["Q1_Cnt"].ToString(), DataType.String, "s106R");
                                            //else
                                            //    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s106R");
                                            //if (string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                            //    cell = Row0.Cells.Add(dr["Q2_Cnt"].ToString(), DataType.String, "s106R");
                                            //else
                                            //    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s106R");
                                            //if (string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                            //    cell = Row0.Cells.Add(dr["Q3_Cnt"].ToString(), DataType.String, "s106R");
                                            //else
                                            //    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s106R");
                                            //if (string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                            //    cell = Row0.Cells.Add(dr["Q4_Cnt"].ToString(), DataType.String, "s106R");
                                            //else
                                            //    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s106R");


                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106R");
                                            cell = Row0.Cells.Add(Ytd == string.Empty ? "" : Ytd + "%", DataType.String, "s106R");
                                        }

                                    }
                                    else
                                    {
                                        if (dr["SP2_ACTIVE"].ToString() == "A")
                                        {
                                            cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s95");

                                            cell = Row0.Cells.Add(CntType, DataType.String, "s95");
                                            cell = Row0.Cells.Add(CAMSType, DataType.String, "s95");
                                            cell = Row0.Cells.Add(dr["TARGET_VAL"].ToString(), DataType.String, "s95RC");
                                            //if (string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                            //    cell = Row0.Cells.Add(dr["Q1_Cnt"].ToString(), DataType.String, "s95RC");
                                            //else cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s95RC");
                                            //if (string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                            //    cell = Row0.Cells.Add(dr["Q2_Cnt"].ToString(), DataType.String, "s95RC");
                                            //else cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s95RC");
                                            //if (string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                            //    cell = Row0.Cells.Add(dr["Q3_Cnt"].ToString(), DataType.String, "s95RC");
                                            //else cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s95RC");
                                            //if (string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                            //    cell = Row0.Cells.Add(dr["Q4_Cnt"].ToString(), DataType.String, "s95RC");
                                            //else cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s95RC");

                                            if (dr["SP2_COUNT_TYPE"].ToString() == "B" || dr["SP2_COUNT_TYPE"].ToString() == "C" || dr["SP2_COUNT_TYPE"].ToString() == "D")
                                            {
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s95RC");

                                            }
                                            else if (dr["SP2_COUNT_TYPE"].ToString() == "S" || dr["SP2_COUNT_TYPE"].ToString() == "A" || dr["SP2_COUNT_TYPE"].ToString() == "E")
                                            {
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s95RC");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s95RC");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s95RC");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s95RC");


                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s95RC");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");

                                            }
                                            else
                                            {
                                                cell = Row0.Cells.Add(dr["Q1_Cnt"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["Q2_Cnt"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["Q3_Cnt"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["Q4_Cnt"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s95RC");

                                                int totcnt = 0, Q1 = 0, Q2 = 0, Q3 = 0, Q4 = 0;
                                                if (!string.IsNullOrEmpty(dr["Q1_Cnt"].ToString().Trim()))
                                                    Q1 = int.Parse(dr["Q1_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(dr["Q2_Cnt"].ToString().Trim()))
                                                    Q2 = int.Parse(dr["Q2_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(dr["Q3_Cnt"].ToString().Trim()))
                                                    Q3 = int.Parse(dr["Q3_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(dr["Q4_Cnt"].ToString().Trim()))
                                                    Q4 = int.Parse(dr["Q4_Cnt"].ToString().Trim());
                                                totcnt = Q1 + Q2 + Q3 + Q4;

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(totcnt == 0 ? "" : totcnt.ToString(), DataType.String, "s95RC");
                                            }

                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s95RC");
                                            cell = Row0.Cells.Add(Ytd == string.Empty ? "" : Ytd + "%", DataType.String, "s95RC");

                                        }
                                        else
                                        {
                                            cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s95R");

                                            cell = Row0.Cells.Add(CntType, DataType.String, "s95R");
                                            cell = Row0.Cells.Add(CAMSType, DataType.String, "s95R");
                                            cell = Row0.Cells.Add(dr["TARGET_VAL"].ToString(), DataType.String, "s95RCR");

                                            if (dr["SP2_COUNT_TYPE"].ToString() == "B" || dr["SP2_COUNT_TYPE"].ToString() == "C" || dr["SP2_COUNT_TYPE"].ToString() == "D")
                                            {
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s95RCR");

                                            }
                                            else if (dr["SP2_COUNT_TYPE"].ToString() == "S" || dr["SP2_COUNT_TYPE"].ToString() == "A" || dr["SP2_COUNT_TYPE"].ToString() == "E")
                                            {
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s95RCR");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s95RCR");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s95RCR");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");

                                            }
                                            else
                                            {
                                                cell = Row0.Cells.Add(dr["Q1_Cnt"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q1"].ToString() + "%" : dr["Q1"].ToString(), DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["Q2_Cnt"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q2"].ToString() + "%" : dr["Q2"].ToString(), DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["Q3_Cnt"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q3"].ToString() + "%" : dr["Q3"].ToString(), DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["Q4_Cnt"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["Q4"].ToString() + "%" : dr["Q4"].ToString(), DataType.String, "s95RCR");

                                                int totcnt = 0, Q1 = 0, Q2 = 0, Q3 = 0, Q4 = 0;
                                                if (!string.IsNullOrEmpty(dr["Q1_Cnt"].ToString().Trim()))
                                                    Q1 = int.Parse(dr["Q1_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(dr["Q2_Cnt"].ToString().Trim()))
                                                    Q2 = int.Parse(dr["Q2_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(dr["Q3_Cnt"].ToString().Trim()))
                                                    Q3 = int.Parse(dr["Q3_Cnt"].ToString().Trim());
                                                if (!string.IsNullOrEmpty(dr["Q4_Cnt"].ToString().Trim()))
                                                    Q4 = int.Parse(dr["Q4_Cnt"].ToString().Trim());
                                                totcnt = Q1 + Q2 + Q3 + Q4;

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(totcnt == 0 ? "" : totcnt.ToString(), DataType.String, "s95RCR");
                                            }

                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s95RCR");
                                            cell = Row0.Cells.Add(Ytd == string.Empty ? "" : Ytd + "%", DataType.String, "s95RCR");
                                        }

                                    }



                                    i++;
                                }
                            }
                            else
                            {
                                sheet.Table.Columns.Add(200);
                                sheet.Table.Columns.Add(100);
                                sheet.Table.Columns.Add(80);//(150);
                                sheet.Table.Columns.Add(75);
                                sheet.Table.Columns.Add(75);
                                if (rbAmtYes.Checked)
                                    sheet.Table.Columns.Add(75);
                                sheet.Table.Columns.Add(75);
                                if (rbAmtYes.Checked)
                                    sheet.Table.Columns.Add(75);
                                sheet.Table.Columns.Add(75);
                                if (rbAmtYes.Checked)
                                    sheet.Table.Columns.Add(75);
                                sheet.Table.Columns.Add(75);
                                if (rbAmtYes.Checked)
                                    sheet.Table.Columns.Add(75);
                                sheet.Table.Columns.Add(75);
                                if (rbAmtYes.Checked)
                                    sheet.Table.Columns.Add(75);
                                sheet.Table.Columns.Add(75);
                                if (rbAmtYes.Checked)
                                    sheet.Table.Columns.Add(75);
                                sheet.Table.Columns.Add(75);
                                if (rbAmtYes.Checked)
                                    sheet.Table.Columns.Add(75);
                                sheet.Table.Columns.Add(75);
                                if (rbAmtYes.Checked)
                                    sheet.Table.Columns.Add(75);
                                sheet.Table.Columns.Add(75);
                                if (rbAmtYes.Checked)
                                    sheet.Table.Columns.Add(75);
                                sheet.Table.Columns.Add(75);
                                if (rbAmtYes.Checked)
                                    sheet.Table.Columns.Add(75);
                                sheet.Table.Columns.Add(75);
                                if (rbAmtYes.Checked)
                                    sheet.Table.Columns.Add(75);
                                sheet.Table.Columns.Add(75);
                                if (rbAmtYes.Checked)
                                    sheet.Table.Columns.Add(75);
                                sheet.Table.Columns.Add(80);
                                sheet.Table.Columns.Add(80);
                                sheet.Table.Columns.Add(80);

                                Row0 = sheet.Table.Rows.Add();
                                Row0.AutoFitHeight = false;
                                //WorksheetCell cell;
                                cell = Row0.Cells.Add();
                                Row0.Height = 20;
                                cell.StyleID = "s83";
                                cell.Data.Type = DataType.String;
                                cell.Data.Text = dataTable.Rows[0]["SP0_DESCRIPTION"].ToString();

                                if (rbAmtNo.Checked)
                                    cell.MergeAcross = 17;
                                else
                                    cell.MergeAcross = 30;//29;

                                Row0 = sheet.Table.Rows.Add();
                                Row0.Height = 20;
                                cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");
                                cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");
                                cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");
                                cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");

                                DateTime ct = Convert.ToDateTime(rngcodedata.OFdate);
                                string Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;
                                ct = ct.AddMonths(1);
                                Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;
                                ct = ct.AddMonths(1);
                                Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;
                                ct = ct.AddMonths(1);
                                Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;
                                ct = ct.AddMonths(1);
                                Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;
                                ct = ct.AddMonths(1);
                                Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;
                                ct = ct.AddMonths(1);
                                Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;
                                ct = ct.AddMonths(1);
                                Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;
                                ct = ct.AddMonths(1);
                                Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;
                                ct = ct.AddMonths(1);
                                Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;
                                ct = ct.AddMonths(1);
                                Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;
                                ct = ct.AddMonths(1);
                                Mval1 = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(Convert.ToInt16(ct.Month)) + "-" + ct.Year.ToString();
                                cell = Row0.Cells.Add(Mval1, DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;


                                cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");
                                if (rbAmtYes.Checked)
                                    cell.MergeAcross = 1;
                                cell = Row0.Cells.Add("", DataType.String, "MainHeaderStyles1");

                                Row0 = sheet.Table.Rows.Add();
                                Row0.Height = 20;
                                cell = Row0.Cells.Add("Description", DataType.String, "MainHeaderStylesLeft");
                                cell = Row0.Cells.Add("Aggregate Func.", DataType.String, "MainHeaderStylesLeft");
                                cell = Row0.Cells.Add("Type", DataType.String, "MainHeaderStylesLeft");
                                cell = Row0.Cells.Add("Target", DataType.String, "MainHeaderStylesRight");
                                cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                    cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");
                                cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                    cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");
                                cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                    cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");
                                cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                    cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");
                                cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                    cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");
                                cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                    cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");
                                cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                    cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");
                                cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                    cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");
                                cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                    cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");
                                cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                    cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");
                                cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                    cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");
                                cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                    cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");
                                if (rbAmtYes.Checked)
                                    cell = Row0.Cells.Add("Amount YTD", DataType.String, "MainHeaderStylesRight");
                                cell = Row0.Cells.Add("Clients YTD", DataType.String, "MainHeaderStylesRight");
                                cell = Row0.Cells.Add("YTD %", DataType.String, "MainHeaderStylesRight");


                                int i = 0;
                                foreach (DataRow dr in dataTable.Rows)
                                {
                                    Row0 = sheet.Table.Rows.Add();


                                    string CAMSType = string.Empty;
                                    if (dr["SP2_TYPE"].ToString().Trim() == "CA")
                                        CAMSType = "Service";
                                    else
                                        CAMSType = "Outcome";

                                    string CntType = string.Empty;
                                    if (dr["SP2_COUNT_TYPE"].ToString() == "A")
                                        CntType = "Amount - Average";
                                    else if (dr["SP2_COUNT_TYPE"].ToString() == "S")
                                        CntType = "Amount - Sum";
                                    else if (dr["SP2_COUNT_TYPE"].ToString() == "E")
                                        CntType = "Amount - End of Month";
                                    else if (dr["SP2_COUNT_TYPE"].ToString() == "C")
                                        CntType = "Client - Average";
                                    else if (dr["SP2_COUNT_TYPE"].ToString() == "B")
                                        CntType = "Client - Sum";
                                    else if (dr["SP2_COUNT_TYPE"].ToString() == "D")
                                        CntType = "Client - End of Month";



                                    int totcnt = 0, M1 = 0, M2 = 0, M3 = 0, M4 = 0, M5 = 0, M6 = 0, M7 = 0, M8 = 0, M9 = 0, M10 = 0, M11 = 0, M12 = 0;
                                    if (!string.IsNullOrEmpty(dr["M1_MEM"].ToString().Trim()))
                                        M1 = int.Parse(dr["M1_MEM"].ToString().Trim());
                                    if (!string.IsNullOrEmpty(dr["M2_MEM"].ToString().Trim()))
                                        M2 = int.Parse(dr["M2_MEM"].ToString().Trim());
                                    if (!string.IsNullOrEmpty(dr["M3_MEM"].ToString().Trim()))
                                        M3 = int.Parse(dr["M3_MEM"].ToString().Trim());
                                    if (!string.IsNullOrEmpty(dr["M4_MEM"].ToString().Trim()))
                                        M4 = int.Parse(dr["M4_MEM"].ToString().Trim());
                                    if (!string.IsNullOrEmpty(dr["M5_MEM"].ToString().Trim()))
                                        M5 = int.Parse(dr["M5_MEM"].ToString().Trim());
                                    if (!string.IsNullOrEmpty(dr["M6_MEM"].ToString().Trim()))
                                        M6 = int.Parse(dr["M6_MEM"].ToString().Trim());
                                    if (!string.IsNullOrEmpty(dr["M7_MEM"].ToString().Trim()))
                                        M7 = int.Parse(dr["M7_MEM"].ToString().Trim());
                                    if (!string.IsNullOrEmpty(dr["M8_MEM"].ToString().Trim()))
                                        M8 = int.Parse(dr["M8_MEM"].ToString().Trim());
                                    if (!string.IsNullOrEmpty(dr["M9_MEM"].ToString().Trim()))
                                        M9 = int.Parse(dr["M9_MEM"].ToString().Trim());
                                    if (!string.IsNullOrEmpty(dr["M10_MEM"].ToString().Trim()))
                                        M10 = int.Parse(dr["M10_MEM"].ToString().Trim());
                                    if (!string.IsNullOrEmpty(dr["M11_MEM"].ToString().Trim()))
                                        M11 = int.Parse(dr["M11_MEM"].ToString().Trim());
                                    if (!string.IsNullOrEmpty(dr["M12_MEM"].ToString().Trim()))
                                        M12 = int.Parse(dr["M12_MEM"].ToString().Trim());
                                    totcnt = M1 + M2 + M3 + M4 + M5 + M6 + M7 + M8 + M9 + M10 + M11 + M12;

                                    string Ytd = string.Empty;
                                    if (dr["TARGET_VAL"].ToString() != "0")
                                    {
                                        if (!string.IsNullOrEmpty(dr["SP2_COUNT_TYPE"].ToString().Trim()))
                                        {
                                            decimal percent = (decimal.Parse(dr["YTD"].ToString().Trim() == string.Empty ? "0" : dr["YTD"].ToString().Trim()) / decimal.Parse(dr["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : dr["TARGET_VAL"].ToString().Trim())) * 100;

                                            Ytd = percent.ToString("0.00");
                                        }
                                        else
                                        {
                                            decimal percent = (decimal.Parse(totcnt.ToString().Trim() == string.Empty ? "0" : totcnt.ToString().Trim()) / decimal.Parse(dr["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : dr["TARGET_VAL"].ToString().Trim())) * 100;

                                            Ytd = percent.ToString("0.00");
                                        }
                                    }

                                    if (i % 2 == 0)
                                    {
                                        if (dr["SP0_ACTIVE"].ToString() == "Y")
                                        {
                                            cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s105");
                                            cell = Row0.Cells.Add(CntType, DataType.String, "s105");
                                            cell = Row0.Cells.Add(CAMSType, DataType.String, "s105");
                                            cell = Row0.Cells.Add(dr["TARGET_VAL"].ToString(), DataType.String, "s106");





                                            if (dr["SP2_COUNT_TYPE"].ToString() == "B" || dr["SP2_COUNT_TYPE"].ToString() == "C" || dr["SP2_COUNT_TYPE"].ToString() == "D")
                                            {
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M1"].ToString() + "%" : dr["M1"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M2"].ToString() + "%" : dr["M2"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M3"].ToString() + "%" : dr["M3"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M4"].ToString() + "%" : dr["M4"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M5"].ToString() + "%" : dr["M5"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M6"].ToString() + "%" : dr["M6"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M7"].ToString() + "%" : dr["M7"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M8"].ToString() + "%" : dr["M8"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M9"].ToString() + "%" : dr["M9"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M10"].ToString() + "%" : dr["M10"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M11"].ToString() + "%" : dr["M11"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M12"].ToString() + "%" : dr["M12"].ToString(), DataType.String, "s106");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106");

                                            }
                                            else if (dr["SP2_COUNT_TYPE"].ToString() == "S" || dr["SP2_COUNT_TYPE"].ToString() == "A" || dr["SP2_COUNT_TYPE"].ToString() == "E")
                                            {
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M1"].ToString() + "%" : dr["M1"].ToString(), DataType.String, "s106");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M2"].ToString() + "%" : dr["M2"].ToString(), DataType.String, "s106");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M3"].ToString() + "%" : dr["M3"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M4"].ToString() + "%" : dr["M4"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M5"].ToString() + "%" : dr["M5"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M6"].ToString() + "%" : dr["M6"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M7"].ToString() + "%" : dr["M7"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M8"].ToString() + "%" : dr["M8"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M9"].ToString() + "%" : dr["M9"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M10"].ToString() + "%" : dr["M10"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M11"].ToString() + "%" : dr["M11"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M12"].ToString() + "%" : dr["M12"].ToString(), DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106");

                                            }
                                            else
                                            {
                                                cell = Row0.Cells.Add(dr["M1_MEM"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M1"].ToString() + "%" : dr["M1"].ToString(), DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["M2_MEM"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M2"].ToString() + "%" : dr["M2"].ToString(), DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["M3_MEM"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M3"].ToString() + "%" : dr["M3"].ToString(), DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["M4_MEM"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M4"].ToString() + "%" : dr["M4"].ToString(), DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["M5_MEM"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M5"].ToString() + "%" : dr["M5"].ToString(), DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["M6_MEM"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M6"].ToString() + "%" : dr["M6"].ToString(), DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["M7_MEM"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M7"].ToString() + "%" : dr["M7"].ToString(), DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["M8_MEM"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M8"].ToString() + "%" : dr["M8"].ToString(), DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["M9_MEM"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M9"].ToString() + "%" : dr["M9"].ToString(), DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["M10_MEM"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M10"].ToString() + "%" : dr["M10"].ToString(), DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["M11_MEM"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M11"].ToString() + "%" : dr["M11"].ToString(), DataType.String, "s106");

                                                cell = Row0.Cells.Add(dr["M12_MEM"].ToString(), DataType.String, "s106");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M12"].ToString() + "%" : dr["M12"].ToString(), DataType.String, "s106");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106");
                                                cell = Row0.Cells.Add(totcnt == 0 ? "" : totcnt.ToString(), DataType.String, "s106");
                                            }



                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106");
                                            cell = Row0.Cells.Add(Ytd == string.Empty ? "" : Ytd + "%", DataType.String, "s106");
                                            //}
                                            //else
                                            //{
                                            //    cell = Row0.Cells.Add(dr["Q1"].ToString(), DataType.String, "s106");
                                            //    cell = Row0.Cells.Add(dr["Q2"].ToString(), DataType.String, "s106");
                                            //    cell = Row0.Cells.Add(dr["Q3"].ToString(), DataType.String, "s106");
                                            //    cell = Row0.Cells.Add(dr["Q4"].ToString(), DataType.String, "s106");
                                            //    cell = Row0.Cells.Add(dr["YTD"].ToString(), DataType.String, "s106");
                                            //    cell = Row0.Cells.Add(Ytd, DataType.String, "s106");
                                            //}
                                        }
                                        else
                                        {
                                            cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s105R");
                                            cell = Row0.Cells.Add(CntType, DataType.String, "s105R");
                                            cell = Row0.Cells.Add(CAMSType, DataType.String, "s105R");

                                            cell = Row0.Cells.Add(dr["TARGET_VAL"].ToString(), DataType.String, "s106R");


                                            if (dr["SP2_COUNT_TYPE"].ToString() == "B" || dr["SP2_COUNT_TYPE"].ToString() == "C" || dr["SP2_COUNT_TYPE"].ToString() == "D")
                                            {
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M1"].ToString() + "%" : dr["M1"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M2"].ToString() + "%" : dr["M2"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M3"].ToString() + "%" : dr["M3"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M4"].ToString() + "%" : dr["M4"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M5"].ToString() + "%" : dr["M5"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M6"].ToString() + "%" : dr["M6"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M7"].ToString() + "%" : dr["M7"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M8"].ToString() + "%" : dr["M8"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M9"].ToString() + "%" : dr["M9"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M10"].ToString() + "%" : dr["M10"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M11"].ToString() + "%" : dr["M11"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M12"].ToString() + "%" : dr["M12"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106R");

                                            }
                                            else if (dr["SP2_COUNT_TYPE"].ToString() == "S" || dr["SP2_COUNT_TYPE"].ToString() == "A" || dr["SP2_COUNT_TYPE"].ToString() == "E")
                                            {
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M1"].ToString() + "%" : dr["M1"].ToString(), DataType.String, "s106R");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M2"].ToString() + "%" : dr["M2"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M3"].ToString() + "%" : dr["M3"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M4"].ToString() + "%" : dr["M4"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M5"].ToString() + "%" : dr["M5"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M6"].ToString() + "%" : dr["M6"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M7"].ToString() + "%" : dr["M7"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M8"].ToString() + "%" : dr["M8"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M9"].ToString() + "%" : dr["M9"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M10"].ToString() + "%" : dr["M10"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M11"].ToString() + "%" : dr["M11"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M12"].ToString() + "%" : dr["M12"].ToString(), DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s106R");

                                            }
                                            else
                                            {
                                                cell = Row0.Cells.Add(dr["M1_MEM"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M1"].ToString() + "%" : dr["M1"].ToString(), DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["M2_MEM"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M2"].ToString() + "%" : dr["M2"].ToString(), DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["M3_MEM"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M3"].ToString() + "%" : dr["M3"].ToString(), DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["M4_MEM"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M4"].ToString() + "%" : dr["M4"].ToString(), DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["M5_MEM"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M5"].ToString() + "%" : dr["M5"].ToString(), DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["M6_MEM"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M6"].ToString() + "%" : dr["M6"].ToString(), DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["M7_MEM"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M7"].ToString() + "%" : dr["M7"].ToString(), DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["M8_MEM"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M8"].ToString() + "%" : dr["M8"].ToString(), DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["M9_MEM"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M9"].ToString() + "%" : dr["M9"].ToString(), DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["M10_MEM"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M10"].ToString() + "%" : dr["M10"].ToString(), DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["M11_MEM"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M11"].ToString() + "%" : dr["M11"].ToString(), DataType.String, "s106R");

                                                cell = Row0.Cells.Add(dr["M12_MEM"].ToString(), DataType.String, "s106R");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M12"].ToString() + "%" : dr["M12"].ToString(), DataType.String, "s106R");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106R");
                                                cell = Row0.Cells.Add(totcnt == 0 ? "" : totcnt.ToString(), DataType.String, "s106R");

                                            }

                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s106R");
                                            cell = Row0.Cells.Add(Ytd == string.Empty ? "" : Ytd + "%", DataType.String, "s106R");
                                        }

                                    }
                                    else
                                    {
                                        if (dr["SP0_ACTIVE"].ToString() == "Y")
                                        {
                                            cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s95");
                                            cell = Row0.Cells.Add(CntType, DataType.String, "s95");
                                            cell = Row0.Cells.Add(CAMSType, DataType.String, "s95");

                                            cell = Row0.Cells.Add(dr["TARGET_VAL"].ToString(), DataType.String, "s95RC");

                                            if (dr["SP2_COUNT_TYPE"].ToString() == "B" || dr["SP2_COUNT_TYPE"].ToString() == "C" || dr["SP2_COUNT_TYPE"].ToString() == "D")
                                            {
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M1"].ToString() + "%" : dr["M1"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M2"].ToString() + "%" : dr["M2"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M3"].ToString() + "%" : dr["M3"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M4"].ToString() + "%" : dr["M4"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M5"].ToString() + "%" : dr["M5"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M6"].ToString() + "%" : dr["M6"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M7"].ToString() + "%" : dr["M7"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M8"].ToString() + "%" : dr["M8"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M9"].ToString() + "%" : dr["M9"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M10"].ToString() + "%" : dr["M10"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M11"].ToString() + "%" : dr["M11"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M12"].ToString() + "%" : dr["M12"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s95RC");

                                            }
                                            else if (dr["SP2_COUNT_TYPE"].ToString() == "S" || dr["SP2_COUNT_TYPE"].ToString() == "A" || dr["SP2_COUNT_TYPE"].ToString() == "E")
                                            {
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M1"].ToString() + "%" : dr["M1"].ToString(), DataType.String, "s95RC");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M2"].ToString() + "%" : dr["M2"].ToString(), DataType.String, "s95RC");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M3"].ToString() + "%" : dr["M3"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M4"].ToString() + "%" : dr["M4"].ToString(), DataType.String, "s95RC");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M5"].ToString() + "%" : dr["M5"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M6"].ToString() + "%" : dr["M6"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M7"].ToString() + "%" : dr["M7"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M8"].ToString() + "%" : dr["M8"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M9"].ToString() + "%" : dr["M9"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M10"].ToString() + "%" : dr["M10"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M11"].ToString() + "%" : dr["M11"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M12"].ToString() + "%" : dr["M12"].ToString(), DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RC");
                                            }
                                            else
                                            {
                                                cell = Row0.Cells.Add(dr["M1_MEM"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M1"].ToString() + "%" : dr["M1"].ToString(), DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["M2_MEM"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M2"].ToString() + "%" : dr["M2"].ToString(), DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["M3_MEM"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M3"].ToString() + "%" : dr["M3"].ToString(), DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["M4_MEM"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M4"].ToString() + "%" : dr["M4"].ToString(), DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["M5_MEM"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M5"].ToString() + "%" : dr["M5"].ToString(), DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["M6_MEM"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M6"].ToString() + "%" : dr["M6"].ToString(), DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["M7_MEM"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M7"].ToString() + "%" : dr["M7"].ToString(), DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["M8_MEM"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M8"].ToString() + "%" : dr["M8"].ToString(), DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["M9_MEM"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M9"].ToString() + "%" : dr["M9"].ToString(), DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["M10_MEM"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M10"].ToString() + "%" : dr["M10"].ToString(), DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["M11_MEM"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M11"].ToString() + "%" : dr["M11"].ToString(), DataType.String, "s95RC");

                                                cell = Row0.Cells.Add(dr["M12_MEM"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M12"].ToString() + "%" : dr["M12"].ToString(), DataType.String, "s95RC");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s95RC");
                                                cell = Row0.Cells.Add(totcnt == 0 ? "" : totcnt.ToString(), DataType.String, "s95RC");
                                            }

                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s95RC");
                                            cell = Row0.Cells.Add(Ytd == string.Empty ? "" : Ytd + "%", DataType.String, "s95RC");

                                        }
                                        else
                                        {
                                            cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s95R");
                                            cell = Row0.Cells.Add(CntType, DataType.String, "s95R");
                                            cell = Row0.Cells.Add(CAMSType, DataType.String, "s95R");
                                            cell = Row0.Cells.Add(dr["TARGET_VAL"].ToString(), DataType.String, "s95RCR");
                                            if (dr["SP2_COUNT_TYPE"].ToString() == "B" || dr["SP2_COUNT_TYPE"].ToString() == "C" || dr["SP2_COUNT_TYPE"].ToString() == "D")
                                            {
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M1"].ToString() + "%" : dr["M1"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M2"].ToString() + "%" : dr["M2"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M3"].ToString() + "%" : dr["M3"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M4"].ToString() + "%" : dr["M4"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M5"].ToString() + "%" : dr["M5"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M6"].ToString() + "%" : dr["M6"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M7"].ToString() + "%" : dr["M7"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M8"].ToString() + "%" : dr["M8"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M9"].ToString() + "%" : dr["M9"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M10"].ToString() + "%" : dr["M10"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M11"].ToString() + "%" : dr["M11"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M12"].ToString() + "%" : dr["M12"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s95RCR");

                                            }
                                            else if (dr["SP2_COUNT_TYPE"].ToString() == "S" || dr["SP2_COUNT_TYPE"].ToString() == "A" || dr["SP2_COUNT_TYPE"].ToString() == "E")
                                            {
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M1"].ToString() + "%" : dr["M1"].ToString(), DataType.String, "s95RCR");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M2"].ToString() + "%" : dr["M2"].ToString(), DataType.String, "s95RCR");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M3"].ToString() + "%" : dr["M3"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M4"].ToString() + "%" : dr["M4"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M5"].ToString() + "%" : dr["M5"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M6"].ToString() + "%" : dr["M6"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M7"].ToString() + "%" : dr["M7"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M8"].ToString() + "%" : dr["M8"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M9"].ToString() + "%" : dr["M9"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M10"].ToString() + "%" : dr["M10"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M11"].ToString() + "%" : dr["M11"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M12"].ToString() + "%" : dr["M12"].ToString(), DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add("", DataType.String, "s95RCR");
                                            }
                                            else
                                            {
                                                cell = Row0.Cells.Add(dr["M1_MEM"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M1"].ToString() + "%" : dr["M1"].ToString(), DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["M2_MEM"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M2"].ToString() + "%" : dr["M2"].ToString(), DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["M3_MEM"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M3"].ToString() + "%" : dr["M3"].ToString(), DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["M4_MEM"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M4"].ToString() + "%" : dr["M4"].ToString(), DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["M5_MEM"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M5"].ToString() + "%" : dr["M5"].ToString(), DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["M6_MEM"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M6"].ToString() + "%" : dr["M6"].ToString(), DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["M7_MEM"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M7"].ToString() + "%" : dr["M7"].ToString(), DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["M8_MEM"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M8"].ToString() + "%" : dr["M8"].ToString(), DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["M9_MEM"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M9"].ToString() + "%" : dr["M9"].ToString(), DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["M10_MEM"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M10"].ToString() + "%" : dr["M10"].ToString(), DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["M11_MEM"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M11"].ToString() + "%" : dr["M11"].ToString(), DataType.String, "s95RCR");

                                                cell = Row0.Cells.Add(dr["M12_MEM"].ToString(), DataType.String, "s95RCR");
                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["M12"].ToString() + "%" : dr["M12"].ToString(), DataType.String, "s95RCR");

                                                if (rbAmtYes.Checked)
                                                    cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s95RCR");
                                                cell = Row0.Cells.Add(totcnt == 0 ? "" : totcnt.ToString(), DataType.String, "s95RCR");
                                            }

                                            //cell = Row0.Cells.Add(dr["SP2_COUNT_TYPE"].ToString() == "A" ? dr["YTD"].ToString() + "%" : dr["YTD"].ToString(), DataType.String, "s95RCR");
                                            cell = Row0.Cells.Add(Ytd == string.Empty ? "" : Ytd + "%", DataType.String, "s95RCR");
                                        }

                                    }



                                    i++;
                                }
                            }
                        }



                        if (Rb_SP_Sel.Checked)
                        {
                            if (dtAudit.Rows.Count > 0)
                            {
                                DataTable dataAudit = new DataTable();
                                DataView dvAudit = new DataView(dtAudit);
                                dvAudit.RowFilter = "SP='" + dRow + "'";
                                dvAudit.RowFilter = "SP='" + dRow + "'";
                                //if (Rb_MS_Date.Checked)
                                //    dvAudit.Sort = "CAMS_DATE";
                                //else dvAudit.Sort = "CAMS_DATE_ADD";
                                dataAudit = dvAudit.ToTable();

                                if (dataAudit.Rows.Count > 0)
                                {
                                    string ReportName = dRow + "_Audit";//dataTable.Rows[0]["SP_Desc"].ToString();
                                    ReportName = ReportName.Replace("/", "");

                                    if (ReportName.Length >= 31)
                                    {
                                        ReportName = ReportName.Substring(0, 31);
                                    }
                                    sheet = book.Worksheets.Add(ReportName);
                                    sheet.Table.DefaultRowHeight = 16F;


                                    //sheet.Table.Columns.Add(75);
                                    //sheet.Table.Columns.Add(75);
                                    //sheet.Table.Columns.Add(75);
                                    //sheet.Table.Columns.Add(75);
                                    //sheet.Table.Columns.Add(80);
                                    //sheet.Table.Columns.Add(145);
                                    //sheet.Table.Columns.Add(75);
                                    //sheet.Table.Columns.Add(80);
                                    //sheet.Table.Columns.Add(180);
                                    //sheet.Table.Columns.Add(80);
                                    //sheet.Table.Columns.Add(80);
                                    //sheet.Table.Columns.Add(80);

                                    sheet.Table.Columns.Add(180);
                                    sheet.Table.Columns.Add(75);
                                    sheet.Table.Columns.Add(50);
                                    sheet.Table.Columns.Add(80);
                                    sheet.Table.Columns.Add(80);
                                    sheet.Table.Columns.Add(80);
                                    sheet.Table.Columns.Add(80);
                                    sheet.Table.Columns.Add(80);//(145);
                                    sheet.Table.Columns.Add(145);
                                    sheet.Table.Columns.Add(145);

                                    Row0 = sheet.Table.Rows.Add();
                                    Row0.AutoFitHeight = false;
                                    //WorksheetCell cell;
                                    cell = Row0.Cells.Add();
                                    Row0.Height = 20;
                                    cell.StyleID = "s83";
                                    cell.Data.Type = DataType.String;
                                    cell.Data.Text = dataAudit.Rows[0]["SP_Desc"].ToString();
                                    cell.MergeAcross = 10;//8;//7;


                                    Row0 = sheet.Table.Rows.Add();
                                    Row0.Height = 20;
                                    //cell = Row0.Cells.Add("Agency", DataType.String, "s94");
                                    //cell = Row0.Cells.Add("Dept", DataType.String, "s94");
                                    //cell = Row0.Cells.Add("Program", DataType.String, "s94");
                                    //cell = Row0.Cells.Add("Year", DataType.String, "s94");
                                    //cell = Row0.Cells.Add("App", DataType.String, "s94");
                                    //cell = Row0.Cells.Add("Name", DataType.String, "s94");
                                    //cell = Row0.Cells.Add("Type", DataType.String, "s94");
                                    //cell = Row0.Cells.Add("Code", DataType.String, "s94");
                                    //cell = Row0.Cells.Add("Description", DataType.String, "s94");
                                    //cell = Row0.Cells.Add("Date", DataType.String, "s94");
                                    //cell = Row0.Cells.Add("Date Added", DataType.String, "s94");
                                    //cell = Row0.Cells.Add("Amount", DataType.String, "s94");

                                    cell = Row0.Cells.Add("Description", DataType.String, "MainHeaderStylesLeft");
                                    cell = Row0.Cells.Add("Date", DataType.String, "MainHeaderStylesLeft");
                                    if (rbQuaterly.Checked)
                                        cell = Row0.Cells.Add("Q#", DataType.String, "MainHeaderStylesLeft");
                                    else
                                        cell = Row0.Cells.Add("M#", DataType.String, "MainHeaderStylesLeft");
                                    cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                                    cell = Row0.Cells.Add("Total Clients", DataType.String, "MainHeaderStylesRight");
                                    cell = Row0.Cells.Add("Detail Amt.", DataType.String, "MainHeaderStylesRight");
                                    cell = Row0.Cells.Add("Total Amt.", DataType.String, "MainHeaderStylesRight");
                                    cell = Row0.Cells.Add("App No", DataType.String, "MainHeaderStyles");
                                    cell = Row0.Cells.Add("Name", DataType.String, "MainHeaderStylesLeft");
                                    cell = Row0.Cells.Add("Case Worker", DataType.String, "MainHeaderStylesLeft");
                                    cell = Row0.Cells.Add("Site", DataType.String, "MainHeaderStylesLeft");


                                    int i = 0;
                                    string QM_type = string.Empty;
                                    int QM_Count = 0;
                                    string Serv = string.Empty;
                                    string PrivClID = string.Empty;
                                    int PrvCnt = 0;
                                    foreach (DataRow dr in dataAudit.Rows)
                                    {
                                        Row0 = sheet.Table.Rows.Add();


                                        string CAMSType = string.Empty;
                                        if (dr["SP2_TYPE"].ToString().Trim() == "CA")
                                            CAMSType = "Service";
                                        else
                                            CAMSType = "Outcome";

                                        //DataRow[] selrow1;
                                        //if (rbQuaterly.Checked)
                                        //    selrow1 = dataAudit.Select("Q_SEC='" + dr["Q_SEC"].ToString() + "' AND Client_ID='" + dr["Client_ID"].ToString() + "' AND CAMS_CODE='" + dr["CAMS_CODE"].ToString() + "'");
                                        //else
                                        //    selrow1 = dataAudit.Select("M_SEC='" + dr["M_SEC"].ToString() + "' AND Client_ID='" + dr["Client_ID"].ToString() + "' AND CAMS_CODE='" + dr["CAMS_CODE"].ToString() + "'");

                                        //if(selrow1!= null) 
                                        //{ 
                                        //    QM_Count++; dr["cnt"] = QM_Count; 
                                        //}

                                        if (rbQuaterly.Checked)
                                        {
                                            if (dr["Q_SEC"].ToString().Trim() != QM_type || dr["CAMS_CODE"].ToString().Trim() != Serv)
                                            {
                                                i++;
                                            }
                                            //else if (PrivClID != dr["Client_ID"].ToString().Trim()) QM_Count++;
                                        }
                                        else
                                        {
                                            if (dr["M_SEC"].ToString().Trim() != QM_type || dr["CAMS_CODE"].ToString().Trim() != Serv)
                                            {
                                                i++;
                                            }
                                            //else if (PrivClID != dr["Client_ID"].ToString().Trim()) QM_Count++;
                                        }

                                        if (rbQuaterly.Checked)
                                            QM_type = dr["Q_SEC"].ToString().Trim();
                                        else
                                            QM_type = dr["M_SEC"].ToString().Trim();

                                        Serv = dr["CAMS_CODE"].ToString().Trim();


                                        if (i % 2 == 0)
                                        {
                                            cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s110");
                                            if (Rb_MS_Date.Checked)
                                                cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString()), DataType.String, "s110");
                                            else
                                                cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString()), DataType.String, "s110");
                                            if (rbQuaterly.Checked)
                                                cell = Row0.Cells.Add(dr["Q_SEC"].ToString(), DataType.String, "s110");
                                            else
                                                cell = Row0.Cells.Add(dr["M_SEC"].ToString(), DataType.String, "s110");
                                            //DataRow[] selrow;
                                            //if (rbQuaterly.Checked)
                                            //    selrow = dataAudit.Select("Q_SEC='" + dr["Q_SEC"].ToString() + "' AND Client_ID='" + dr["Client_ID"].ToString() + "' AND CAMS_CODE='" + dr["CAMS_CODE"].ToString() + "'");
                                            //else
                                            //    selrow = dataAudit.Select("M_SEC='" + dr["M_SEC"].ToString() + "' AND Client_ID='" + dr["Client_ID"].ToString() + "' AND CAMS_CODE='" + dr["CAMS_CODE"].ToString() + "'");

                                            //if (selrow.Length == 1 || QM_Count == 1)
                                            //    cell = Row0.Cells.Add(QM_Count.ToString(), DataType.String, "s111");
                                            //else
                                            //    cell = Row0.Cells.Add("", DataType.String, "s111");

                                            if (dr["Count_Type"].ToString().Trim() == "B" || dr["Count_Type"].ToString().Trim() == "C" || dr["Count_Type"].ToString().Trim() == "D")
                                            {
                                                cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s111");
                                                cell = Row0.Cells.Add(dr["TotCnt"].ToString(), DataType.String, "s111");
                                                cell = Row0.Cells.Add("", DataType.String, "s111");
                                                cell = Row0.Cells.Add("", DataType.String, "s111");
                                            }
                                            else if (dr["Count_Type"].ToString().Trim() == "S" || dr["Count_Type"].ToString().Trim() == "A" || dr["Count_Type"].ToString().Trim() == "E")
                                            {
                                                cell = Row0.Cells.Add("", DataType.String, "s111");
                                                cell = Row0.Cells.Add("", DataType.String, "s111");
                                                cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s111");
                                                cell = Row0.Cells.Add(dr["TotCnt"].ToString(), DataType.String, "s111");
                                            }
                                            else
                                            {
                                                cell = Row0.Cells.Add(dr["cnt"].ToString(), DataType.String, "s111");
                                                if (!string.IsNullOrEmpty(dr["TotCnt"].ToString().Trim()))
                                                {
                                                    //DataTable dtrows= dtAudit.
                                                    cell = Row0.Cells.Add(dr["cnt"].ToString(), DataType.String, "s111");
                                                }
                                                else
                                                    cell = Row0.Cells.Add("", DataType.String, "s111");
                                                cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s111");
                                                cell = Row0.Cells.Add(dr["TotCnt"].ToString(), DataType.String, "s111");
                                            }

                                            cell = Row0.Cells.Add(dr["AppNo"].ToString(), DataType.String, "s110");
                                            cell = Row0.Cells.Add(dr["Name"].ToString(), DataType.String, "s110");
                                            cell = Row0.Cells.Add(dr["CAMS_WORKER"].ToString(), DataType.String, "s110");
                                            cell = Row0.Cells.Add(dr["CAMS_SITE"].ToString(), DataType.String, "s110");

                                            //cell = Row0.Cells.Add(dr["Agency"].ToString(), DataType.String, "s105");
                                            //cell = Row0.Cells.Add(dr["Dept"].ToString(), DataType.String, "s105");
                                            //cell = Row0.Cells.Add(dr["Program"].ToString(), DataType.String, "s105");
                                            //cell = Row0.Cells.Add(dr["Prog_Year"].ToString(), DataType.String, "s105");
                                            //cell = Row0.Cells.Add(dr["AppNo"].ToString(), DataType.String, "s105");
                                            //cell = Row0.Cells.Add(dr["Name"].ToString(), DataType.String, "s105");
                                            //cell = Row0.Cells.Add(CAMSType, DataType.String, "s105");
                                            //cell = Row0.Cells.Add(dr["CAMS_CODE"].ToString(), DataType.String, "s105");
                                            //cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s105");
                                            //cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString()), DataType.String, "s105");
                                            //cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString()), DataType.String, "s105");
                                            //cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s106");



                                        }
                                        else
                                        {
                                            cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s112");
                                            if (Rb_MS_Date.Checked)
                                                cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString()), DataType.String, "s112");
                                            else
                                                cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString()), DataType.String, "s112");
                                            if (rbQuaterly.Checked)
                                                cell = Row0.Cells.Add(dr["Q_SEC"].ToString(), DataType.String, "s112");
                                            else
                                                cell = Row0.Cells.Add(dr["M_SEC"].ToString(), DataType.String, "s112");
                                            //DataRow[] selrow;
                                            //if (rbQuaterly.Checked)
                                            //    selrow = dataAudit.Select("Q_SEC='" + dr["Q_SEC"].ToString() + "' AND Client_ID='" + dr["Client_ID"].ToString() + "' AND SP='" + dr["SP"].ToString() + "' AND CAMS_CODE='" + dr["CAMS_CODE"].ToString() + "'");
                                            //else
                                            //    selrow = dataAudit.Select("M_SEC='" + dr["M_SEC"].ToString() + "' AND Client_ID='" + dr["Client_ID"].ToString() + "' AND SP='" + dr["SP"].ToString() + "' AND CAMS_CODE='" + dr["CAMS_CODE"].ToString() + "'");

                                            //if (selrow.Length == 1 || QM_Count==1)
                                            //    cell = Row0.Cells.Add(QM_Count.ToString(), DataType.String, "s113");
                                            //else
                                            //    cell = Row0.Cells.Add("", DataType.String, "s113");

                                            if (dr["Count_Type"].ToString().Trim() == "B" || dr["Count_Type"].ToString().Trim() == "C" || dr["Count_Type"].ToString().Trim() == "D")
                                            {
                                                cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s113");
                                                cell = Row0.Cells.Add(dr["TotCnt"].ToString(), DataType.String, "s113");
                                                cell = Row0.Cells.Add("", DataType.String, "s113");
                                                cell = Row0.Cells.Add("", DataType.String, "s113");
                                            }
                                            else if (dr["Count_Type"].ToString().Trim() == "S" || dr["Count_Type"].ToString().Trim() == "A" || dr["Count_Type"].ToString().Trim() == "E")
                                            {
                                                cell = Row0.Cells.Add("", DataType.String, "s113");
                                                cell = Row0.Cells.Add("", DataType.String, "s113");
                                                cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s113");
                                                cell = Row0.Cells.Add(dr["TotCnt"].ToString(), DataType.String, "s113");
                                            }
                                            else
                                            {
                                                cell = Row0.Cells.Add(dr["cnt"].ToString(), DataType.String, "s113");
                                                if (!string.IsNullOrEmpty(dr["TotCnt"].ToString().Trim()))
                                                    cell = Row0.Cells.Add(dr["cnt"].ToString(), DataType.String, "s113");
                                                else
                                                    cell = Row0.Cells.Add("", DataType.String, "s113");
                                                cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s113");
                                                cell = Row0.Cells.Add(dr["TotCnt"].ToString(), DataType.String, "s113");
                                            }


                                            cell = Row0.Cells.Add(dr["AppNo"].ToString(), DataType.String, "s112");
                                            cell = Row0.Cells.Add(dr["Name"].ToString(), DataType.String, "s112");
                                            cell = Row0.Cells.Add(dr["CAMS_WORKER"].ToString(), DataType.String, "s112");
                                            cell = Row0.Cells.Add(dr["CAMS_SITE"].ToString(), DataType.String, "s112");



                                        }
                                        PrivClID = dr["Client_ID"].ToString().Trim();
                                        PrvCnt = QM_Count;
                                    }
                                }


                            }

                        }



                    }


                    #region Agency Wide Report
                    if (rbAWRYes.Checked && dt.Rows.Count > 0)
                    {
                        string PriSP = string.Empty;

                        sheet = book.Worksheets.Add("Agency Wide Report");
                        sheet.Table.DefaultRowHeight = 16.25F;

                        var distinctSPs = (from DataRow sps in dt.Rows
                                           select sps["SP0_SERVICECODE"]).Distinct();



                        sheet.Table.Columns.Add(200);
                        sheet.Table.Columns.Add(200);
                        sheet.Table.Columns.Add(150);
                        sheet.Table.Columns.Add(100);
                        sheet.Table.Columns.Add(75);
                        sheet.Table.Columns.Add(75);
                        sheet.Table.Columns.Add(75);
                        if (rbAmtYes.Checked)
                            sheet.Table.Columns.Add(75);


                        Row0 = sheet.Table.Rows.Add();
                        Row0.AutoFitHeight = false;
                        //WorksheetCell cell;
                        cell = Row0.Cells.Add();
                        Row0.Height = 20;
                        cell.StyleID = "s83";
                        cell.Data.Type = DataType.String;
                        cell.Data.Text = "Agency Wide Report";

                        cell.MergeAcross = 6;

                        Row0 = sheet.Table.Rows.Add();
                        Row0.Height = 20;
                        cell = Row0.Cells.Add("Service Plan", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Description", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Aggregate Func.", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Type", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Target", DataType.String, "MainHeaderStylesRight");

                        cell = Row0.Cells.Add("YTD", DataType.String, "MainHeaderStylesRight");
                        cell = Row0.Cells.Add("YTD %", DataType.String, "MainHeaderStylesRight");
                        if (rbAmtYes.Checked)
                            cell = Row0.Cells.Add("Total Amount", DataType.String, "MainHeaderStylesRight");

                        foreach (var sps in distinctRows)
                        {
                            DataTable AgyTable = new DataTable();
                            DataView dv1 = new DataView(dt);
                            dv1.RowFilter = "SP0_SERVICECODE='" + sps + "'";
                            AgyTable = dv1.ToTable();

                            if (AgyTable.Rows.Count > 0)
                            {

                                if (PrivSP != AgyTable.Rows[0]["SP0_DESCRIPTION"].ToString().Trim() && PrivSP != "")
                                    Row0 = sheet.Table.Rows.Add();

                                int j = 0;
                                foreach (DataRow drsp in AgyTable.Rows)
                                {
                                    Row0 = sheet.Table.Rows.Add();


                                    string CAMSType = string.Empty;
                                    if (drsp["SP2_TYPE"].ToString().Trim() == "CA")
                                        CAMSType = "Service";
                                    else
                                        CAMSType = "Outcome";

                                    string Ytd = string.Empty;
                                    int totcnt = 0;
                                    double TotalAmount = 0;
                                    if (string.IsNullOrEmpty(drsp["SP2_COUNT_TYPE"].ToString().Trim()))
                                    {
                                        int Q1 = 0, Q2 = 0, Q3 = 0, Q4 = 0;
                                        double Q1Amt = 0, Q2Amt = 0, Q3Amt = 0, Q4Amt = 0;
                                        if (rbQuaterly.Checked)
                                        {
                                            if (!string.IsNullOrEmpty(drsp["Q1_Cnt"].ToString().Trim()))
                                                Q1 = int.Parse(drsp["Q1_Cnt"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["Q2_Cnt"].ToString().Trim()))
                                                Q2 = int.Parse(drsp["Q2_Cnt"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["Q3_Cnt"].ToString().Trim()))
                                                Q3 = int.Parse(drsp["Q3_Cnt"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["Q4_Cnt"].ToString().Trim()))
                                                Q4 = int.Parse(drsp["Q4_Cnt"].ToString().Trim());
                                            totcnt = Q1 + Q2 + Q3 + Q4;

                                            if (!string.IsNullOrEmpty(drsp["Q1"].ToString().Trim()))
                                                Q1Amt = double.Parse(drsp["Q1"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["Q2"].ToString().Trim()))
                                                Q2Amt = double.Parse(drsp["Q2"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["Q3"].ToString().Trim()))
                                                Q3Amt = double.Parse(drsp["Q3"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["Q4"].ToString().Trim()))
                                                Q4Amt = double.Parse(drsp["Q4"].ToString().Trim());
                                            TotalAmount = Q1Amt + Q2Amt + Q3Amt + Q4Amt;

                                        }
                                        else
                                        {
                                            int M1 = 0, M2 = 0, M3 = 0, M4 = 0, M5 = 0, M6 = 0, M7 = 0, M8 = 0, M9 = 0, M10 = 0, M11 = 0, M12 = 0;
                                            double M1Amt = 0, M2Amt = 0, M3Amt = 0, M4Amt = 0, M5Amt = 0, M6Amt = 0, M7Amt = 0, M8Amt = 0, M9Amt = 0, M10Amt = 0,
                                                M11Amt = 0, M12Amt = 0;

                                            if (!string.IsNullOrEmpty(drsp["M1_MEM"].ToString().Trim()))
                                                M1 = int.Parse(drsp["M1_MEM"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M2_MEM"].ToString().Trim()))
                                                M2 = int.Parse(drsp["M2_MEM"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M3_MEM"].ToString().Trim()))
                                                M3 = int.Parse(drsp["M3_MEM"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M4_MEM"].ToString().Trim()))
                                                M4 = int.Parse(drsp["M4_MEM"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M5_MEM"].ToString().Trim()))
                                                M5 = int.Parse(drsp["M5_MEM"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M6_MEM"].ToString().Trim()))
                                                M6 = int.Parse(drsp["M6_MEM"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M7_MEM"].ToString().Trim()))
                                                M7 = int.Parse(drsp["M7_MEM"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M8_MEM"].ToString().Trim()))
                                                M8 = int.Parse(drsp["M8_MEM"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M9_MEM"].ToString().Trim()))
                                                M9 = int.Parse(drsp["M9_MEM"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M10_MEM"].ToString().Trim()))
                                                M10 = int.Parse(drsp["M10_MEM"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M11_MEM"].ToString().Trim()))
                                                M11 = int.Parse(drsp["M11_MEM"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M12_MEM"].ToString().Trim()))
                                                M12 = int.Parse(drsp["M12_MEM"].ToString().Trim());
                                            totcnt = M1 + M2 + M3 + M4 + M5 + M6 + M7 + M8 + M9 + M10 + M11 + M12;

                                            if (!string.IsNullOrEmpty(drsp["M1"].ToString().Trim()))
                                                M1Amt = double.Parse(drsp["M1"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M2"].ToString().Trim()))
                                                M2Amt = double.Parse(drsp["M2"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M3"].ToString().Trim()))
                                                M3Amt = double.Parse(drsp["M3"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M4"].ToString().Trim()))
                                                M4Amt = double.Parse(drsp["M4"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M5"].ToString().Trim()))
                                                M5Amt = double.Parse(drsp["M5"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M6"].ToString().Trim()))
                                                M6Amt = double.Parse(drsp["M6"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M7"].ToString().Trim()))
                                                M7Amt = double.Parse(drsp["M7"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M8"].ToString().Trim()))
                                                M8Amt = double.Parse(drsp["M8"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M9"].ToString().Trim()))
                                                M9Amt = double.Parse(drsp["M9"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M10"].ToString().Trim()))
                                                M10Amt = double.Parse(drsp["M10"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M11"].ToString().Trim()))
                                                M11Amt = double.Parse(drsp["M11"].ToString().Trim());
                                            if (!string.IsNullOrEmpty(drsp["M12"].ToString().Trim()))
                                                M12Amt = double.Parse(drsp["M12"].ToString().Trim());
                                            TotalAmount = M1Amt + M2Amt + M3Amt + M4Amt + M5Amt + M6Amt + M7Amt + M8Amt + M9Amt + M10Amt + M11Amt + M12Amt;

                                        }
                                    }

                                    if (drsp["TARGET_VAL"].ToString() != "0")
                                    {
                                        if (!string.IsNullOrEmpty(drsp["SP2_COUNT_TYPE"].ToString().Trim()))
                                        {
                                            decimal percent = (decimal.Parse(drsp["YTD"].ToString().Trim() == string.Empty ? "0" : drsp["YTD"].ToString().Trim()) / decimal.Parse(drsp["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : drsp["TARGET_VAL"].ToString().Trim())) * 100;

                                            Ytd = percent.ToString("0.00");
                                        }
                                        else
                                        {

                                            decimal percent = (decimal.Parse(totcnt.ToString().Trim() == string.Empty ? "0" : totcnt.ToString().Trim()) / decimal.Parse(drsp["TARGET_VAL"].ToString().Trim() == string.Empty ? "0" : drsp["TARGET_VAL"].ToString().Trim())) * 100;

                                            Ytd = percent.ToString("0.00");
                                        }
                                    }

                                    string CntType = string.Empty;
                                    if (drsp["SP2_COUNT_TYPE"].ToString() == "A")
                                        CntType = "Amount - Average";
                                    else if (drsp["SP2_COUNT_TYPE"].ToString() == "S")
                                        CntType = "Amount - Sum";
                                    else if (drsp["SP2_COUNT_TYPE"].ToString() == "E")
                                        CntType = "Amount - End of Month";
                                    else if (drsp["SP2_COUNT_TYPE"].ToString() == "C")
                                        CntType = "Client - Average";
                                    else if (drsp["SP2_COUNT_TYPE"].ToString() == "B")
                                        CntType = "Client - Sum";
                                    else if (drsp["SP2_COUNT_TYPE"].ToString() == "D")
                                        CntType = "Client - End of Month";

                                    if (j % 2 == 0)
                                    {
                                        if (j == 0)
                                            cell = Row0.Cells.Add(AgyTable.Rows[0]["SP0_DESCRIPTION"].ToString(), DataType.String, "s105");
                                        else
                                            cell = Row0.Cells.Add("", DataType.String, "s105");
                                        cell = Row0.Cells.Add(drsp["CAMS_DESC"].ToString(), DataType.String, "s105");
                                        cell = Row0.Cells.Add(CntType, DataType.String, "s105");
                                        cell = Row0.Cells.Add(CAMSType, DataType.String, "s105");
                                        cell = Row0.Cells.Add(drsp["TARGET_VAL"].ToString(), DataType.String, "s106");
                                        if (!string.IsNullOrEmpty(drsp["SP2_COUNT_TYPE"].ToString().Trim()))
                                            cell = Row0.Cells.Add(drsp["SP2_COUNT_TYPE"].ToString() == "A" ? drsp["YTD"].ToString() + "%" : drsp["YTD"].ToString(), DataType.String, "s106");
                                        else
                                            cell = Row0.Cells.Add(totcnt.ToString(), DataType.String, "s106");
                                        cell = Row0.Cells.Add(Ytd == string.Empty ? "" : Ytd + "%", DataType.String, "s106");
                                        if (rbAmtYes.Checked)
                                            cell = Row0.Cells.Add(TotalAmount.ToString("0.00"), DataType.String, "s106");
                                    }
                                    else
                                    {
                                        //if(j==1)
                                        //    cell = Row0.Cells.Add(AgyTable.Rows[0]["SP0_DESCRIPTION"].ToString(), DataType.String, "s95");
                                        //else
                                        cell = Row0.Cells.Add("", DataType.String, "s95");
                                        cell = Row0.Cells.Add(drsp["CAMS_DESC"].ToString(), DataType.String, "s95");
                                        cell = Row0.Cells.Add(CntType, DataType.String, "s95");
                                        cell = Row0.Cells.Add(CAMSType, DataType.String, "s95");
                                        cell = Row0.Cells.Add(drsp["TARGET_VAL"].ToString(), DataType.String, "s95RC");
                                        if (!string.IsNullOrEmpty(drsp["SP2_COUNT_TYPE"].ToString().Trim()))
                                            cell = Row0.Cells.Add(drsp["SP2_COUNT_TYPE"].ToString() == "A" ? drsp["YTD"].ToString() + "%" : drsp["YTD"].ToString(), DataType.String, "s95RC");
                                        else
                                            cell = Row0.Cells.Add(totcnt.ToString(), DataType.String, "s95RC");
                                        cell = Row0.Cells.Add(Ytd == string.Empty ? "" : Ytd + "%", DataType.String, "s95RC");
                                        if (rbAmtYes.Checked)
                                            cell = Row0.Cells.Add(TotalAmount.ToString("0.00"), DataType.String, "s106");
                                    }
                                    j++;
                                }
                                PrivSP = AgyTable.Rows[0]["SP0_DESCRIPTION"].ToString().Trim();

                            }


                        }


                    }

                    #endregion

                }


                FileStream stream = new FileStream(PdfName, FileMode.Create);

                book.Save(stream);
                stream.Close();

                //FileDownloadGateway downloadGateway = new FileDownloadGateway();
                //downloadGateway.Filename = "SPREPAPP_Report.xls";

                //// downloadGateway.Version = file.Version;

                //downloadGateway.SetContentType(DownloadContentType.OctetStream);

                //downloadGateway.StartFileDownload(new ContainerControl(), PdfName);

                FileInfo fiDownload = new FileInfo(PdfName);
                /// Need to check for file exists, is local file, is allow to read, etc...
                string name = fiDownload.Name;
                using (FileStream fileStream = fiDownload.OpenRead())
                {
                    Application.Download(fileStream, name);
                }

                if (Rb_Details_Yes.Checked && Rb_SP_All.Checked)
                {
                    if (dtAudit.Rows.Count > 0)
                        On_SaveExcelAudit_Closed(PdfFileName);
                }

            }

        }

        private void GenerateStyles(WorksheetStyleCollection styles)
        {
            // -----------------------------------------------
            //  Default
            // -----------------------------------------------
            WorksheetStyle Default = styles.Add("Default");
            Default.Name = "Normal";
            Default.Font.FontName = "Arial";
            Default.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  s16
            // -----------------------------------------------
            WorksheetStyle s16 = styles.Add("s16");
            // -----------------------------------------------
            //  s17
            // -----------------------------------------------
            WorksheetStyle s17 = styles.Add("s17");
            s17.NumberFormat = "0%";
            // -----------------------------------------------
            //  s18
            // -----------------------------------------------
            WorksheetStyle s18 = styles.Add("s18");
            // -----------------------------------------------
            //  s19
            // -----------------------------------------------
            WorksheetStyle s19 = styles.Add("s19");
            s19.Font.FontName = "Arial";
            // -----------------------------------------------
            //  s20
            // -----------------------------------------------
            WorksheetStyle s20 = styles.Add("s20");
            s20.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s20.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  s21
            // -----------------------------------------------
            WorksheetStyle s21 = styles.Add("s21");
            s21.Font.Bold = true;
            s21.Font.FontName = "Arial";
            s21.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s21.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s21.NumberFormat = "0%";
            // -----------------------------------------------
            //  s23
            // -----------------------------------------------
            WorksheetStyle s23 = styles.Add("s23");
            s23.Font.Bold = true;
            s23.Font.FontName = "Calibri";
            s23.Font.Size = 11;
            s23.Font.Color = "#000000";
            // -----------------------------------------------
            //  s24
            // -----------------------------------------------
            WorksheetStyle s24 = styles.Add("s24");
            s24.Interior.Color = "#D8D8D8";
            s24.Interior.Pattern = StyleInteriorPattern.Solid;
            // -----------------------------------------------
            //  s25
            // -----------------------------------------------
            WorksheetStyle s25 = styles.Add("s25");
            s25.Font.FontName = "Arial";
            s25.Interior.Color = "#D8D8D8";
            s25.Interior.Pattern = StyleInteriorPattern.Solid;
            // -----------------------------------------------
            //  s26
            // -----------------------------------------------
            WorksheetStyle s26 = styles.Add("s26");
            s26.Interior.Color = "#D8D8D8";
            s26.Interior.Pattern = StyleInteriorPattern.Solid;
            s26.NumberFormat = "0%";
            // -----------------------------------------------
            //  s27
            // -----------------------------------------------
            WorksheetStyle s27 = styles.Add("s27");
            s27.Interior.Color = "#D8D8D8";
            s27.Interior.Pattern = StyleInteriorPattern.Solid;
            s27.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s27.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  s28
            // -----------------------------------------------
            WorksheetStyle s28 = styles.Add("s28");
            s28.Font.Bold = true;
            s28.Font.FontName = "Arial";
            s28.Interior.Color = "#D8D8D8";
            s28.Interior.Pattern = StyleInteriorPattern.Solid;
            s28.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s28.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s28.NumberFormat = "0%";

            // -----------------------------------------------
            //  s71
            // -----------------------------------------------
            WorksheetStyle s71 = styles.Add("s71");
            s71.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#ABABAB");

            // -----------------------------------------------
            //  s73
            // -----------------------------------------------
            WorksheetStyle s73 = styles.Add("s73");
            s73.NumberFormat = "0%";
            // -----------------------------------------------
            //  s74
            // -----------------------------------------------
            WorksheetStyle s74 = styles.Add("s74");
            s74.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#ABABAB");
            s74.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#ABABAB");
            s74.NumberFormat = "0%";
            // -----------------------------------------------
            //  s75
            // -----------------------------------------------
            WorksheetStyle s75 = styles.Add("s75");
            s75.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#ABABAB");
            s75.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#ABABAB");
            s75.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#ABABAB");
            // -----------------------------------------------
            //  s76
            // -----------------------------------------------
            WorksheetStyle s76 = styles.Add("s76");
            s76.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#ABABAB");
            s76.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#ABABAB");
            s76.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#ABABAB");
            s76.NumberFormat = "0%";
            // -----------------------------------------------
            //  s77
            // -----------------------------------------------
            WorksheetStyle s77 = styles.Add("s77");
            s77.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#ABABAB");
            s77.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#ABABAB");
            s77.NumberFormat = "0%";
            // -----------------------------------------------
            //  s78
            // -----------------------------------------------
            WorksheetStyle s78 = styles.Add("s78");
            s78.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#ABABAB");
            s78.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#ABABAB");
            s78.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#ABABAB");
            s78.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#ABABAB");
            s78.NumberFormat = "0%";
            // -----------------------------------------------
            //  s79
            // -----------------------------------------------
            WorksheetStyle s79 = styles.Add("s79");
            s79.Font.Bold = true;
            s79.Font.FontName = "Arial";
            s79.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s79.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  s81
            // -----------------------------------------------
            WorksheetStyle s81 = styles.Add("s81");
            s81.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  s82
            // -----------------------------------------------
            WorksheetStyle s82 = styles.Add("s82");
            s82.Font.Bold = true;
            s82.Font.FontName = "Arial";
            s82.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s82.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s82.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#ABABAB");
            s82.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#ABABAB");
            s82.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#ABABAB");
            s82.NumberFormat = "0%";
            // -----------------------------------------------
            //  s83
            // -----------------------------------------------
            WorksheetStyle s83 = styles.Add("s83");
            s83.Font.Bold = true;
            s83.Font.FontName = "Arial";
            s83.Font.Size = 11;
            s83.Font.Color = "#666699";
            s83.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s83.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s83.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s84
            // -----------------------------------------------
            WorksheetStyle s84 = styles.Add("s84");
            s84.Font.Bold = true;
            s84.Font.FontName = "Arial";
            s84.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s84.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s84.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#ABABAB");
            s84.NumberFormat = "0%";
            // -----------------------------------------------
            //  s86
            // -----------------------------------------------
            WorksheetStyle s86 = styles.Add("s86");
            s86.Font.Bold = true;
            s86.Font.FontName = "Arial";
            s86.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s86.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s86.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#ABABAB");
            s86.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#ABABAB");
            s86.NumberFormat = "0%";
            // -----------------------------------------------
            //  s87
            // -----------------------------------------------
            WorksheetStyle s87 = styles.Add("s87");
            s87.Font.Bold = true;
            s87.Font.FontName = "Arial";
            s87.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s87.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s87.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#ABABAB");
            s87.NumberFormat = "0%";
            // -----------------------------------------------
            //  s90
            // -----------------------------------------------
            WorksheetStyle s90 = styles.Add("s90");
            s90.Font.Bold = true;
            s90.Font.FontName = "Arial";
            s90.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s90.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s90.NumberFormat = "0%";
            // -----------------------------------------------
            //  s92
            // -----------------------------------------------
            WorksheetStyle s92 = styles.Add("s92");
            s92.Font.Bold = true;
            s92.Font.Italic = true;
            s92.Font.FontName = "Arial";
            s92.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s92.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s92.NumberFormat = "0%";
            // -----------------------------------------------
            //  s93
            // -----------------------------------------------
            WorksheetStyle s93 = styles.Add("s93");
            s93.Font.Bold = true;
            s93.Font.Italic = true;
            s93.Font.FontName = "Arial";
            s93.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s93.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  s94
            // -----------------------------------------------
            WorksheetStyle s94 = styles.Add("s94");
            s94.Font.Bold = true;
            s94.Font.FontName = "Arial";
            s94.Font.Color = "#000000";
            s94.Interior.Color = "#B0C4DE";
            s94.Interior.Pattern = StyleInteriorPattern.Solid;
            s94.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s94.Alignment.Vertical = StyleVerticalAlignment.Top;
            s94.Alignment.WrapText = true;
            s94.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            s94.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#000000");
            s94.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#000000");
            s94.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            s94.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s95
            // -----------------------------------------------
            WorksheetStyle s95 = styles.Add("s95");
            s95.Font.FontName = "Arial";
            s95.Font.Color = "#000000";
            s95.Interior.Color = "#FFFFFF";
            s95.Interior.Pattern = StyleInteriorPattern.Solid;
            s95.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s95.Alignment.Vertical = StyleVerticalAlignment.Top;
            s95.Alignment.WrapText = true;
            s95.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s95B
            // -----------------------------------------------
            WorksheetStyle s95B = styles.Add("s95B");
            s95B.Font.FontName = "Arial";
            s95B.Font.Bold = true;
            s95B.Font.Color = "#0000FF";
            s95B.Interior.Color = "#FFFFFF";
            s95B.Interior.Pattern = StyleInteriorPattern.Solid;
            s95B.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s95B.Alignment.Vertical = StyleVerticalAlignment.Top;
            s95B.Alignment.WrapText = true;
            s95B.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            //  s95R
            // -----------------------------------------------
            WorksheetStyle s95R = styles.Add("s95R");
            s95R.Font.FontName = "Arial";
            //s95R.Font.Bold = true;
            s95R.Font.Color = "#FF0000";
            s95R.Interior.Color = "#FFFFFF";
            s95R.Interior.Pattern = StyleInteriorPattern.Solid;
            s95R.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s95R.Alignment.Vertical = StyleVerticalAlignment.Top;
            s95R.Alignment.WrapText = true;
            s95R.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s95RC
            // -----------------------------------------------
            WorksheetStyle s95RC = styles.Add("s95RC");
            s95RC.Font.FontName = "Arial";
            s95RC.Font.Color = "#000000";
            s95RC.Interior.Color = "#FFFFFF";
            s95RC.Interior.Pattern = StyleInteriorPattern.Solid;
            s95RC.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s95RC.Alignment.Vertical = StyleVerticalAlignment.Top;
            s95RC.Alignment.WrapText = true;
            s95RC.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s95RCR
            // -----------------------------------------------
            WorksheetStyle s95RCR = styles.Add("s95RCR");
            s95RCR.Font.FontName = "Arial";
            s95RCR.Font.Color = "#FF0000";
            s95RCR.Interior.Color = "#FFFFFF";
            s95RCR.Interior.Pattern = StyleInteriorPattern.Solid;
            s95RCR.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s95RCR.Alignment.Vertical = StyleVerticalAlignment.Top;
            s95RCR.Alignment.WrapText = true;
            s95RCR.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;

            // -----------------------------------------------
            //  s96
            // -----------------------------------------------
            WorksheetStyle s96 = styles.Add("s96");
            s96.Font.FontName = "Arial";
            s96.Font.Color = "#000000";
            s96.Interior.Color = "#FFFFFF";
            s96.Font.Bold = true;
            s96.Interior.Pattern = StyleInteriorPattern.Solid;
            s96.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s96.Alignment.Vertical = StyleVerticalAlignment.Top;
            s96.Alignment.WrapText = true;
            s96.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;

            // -----------------------------------------------
            //  s97
            // -----------------------------------------------
            WorksheetStyle s97 = styles.Add("s97");
            s97.Font.Bold = true;
            s97.Font.FontName = "Arial";
            s97.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s97.Alignment.Vertical = StyleVerticalAlignment.Center;
            s97.NumberFormat = "0%";
            // -----------------------------------------------
            //  s98
            // -----------------------------------------------
            WorksheetStyle s98 = styles.Add("s98");
            s98.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#A5A5A5");
            s98.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#A5A5A5");
            s98.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#A5A5A5");
            s98.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#A5A5A5");
            // -----------------------------------------------
            //  s99
            // -----------------------------------------------
            WorksheetStyle s99 = styles.Add("s99");
            s99.Font.Bold = true;
            s99.Font.FontName = "Arial";
            s99.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#A5A5A5");
            s99.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#A5A5A5");
            s99.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#A5A5A5");
            s99.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#A5A5A5");
            // -----------------------------------------------
            //  s100
            // -----------------------------------------------
            WorksheetStyle s100 = styles.Add("s100");
            s100.Font.Bold = true;
            s100.Font.FontName = "Arial";
            s100.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s100.Alignment.Vertical = StyleVerticalAlignment.Center;
            s100.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#A5A5A5");
            s100.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#A5A5A5");
            s100.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#A5A5A5");
            s100.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#A5A5A5");
            s100.NumberFormat = "0%";
            // -----------------------------------------------
            //  s101
            // -----------------------------------------------
            WorksheetStyle s101 = styles.Add("s101");
            s101.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#A5A5A5");
            s101.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#A5A5A5");
            s101.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#A5A5A5");
            s101.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#A5A5A5");
            s101.NumberFormat = "0%";
            // -----------------------------------------------
            //  s102
            // -----------------------------------------------
            WorksheetStyle s102 = styles.Add("s102");
            s102.Font.Bold = true;
            s102.Font.FontName = "Arial";
            s102.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s102.Alignment.Vertical = StyleVerticalAlignment.Center;
            s102.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#A5A5A5");
            s102.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#A5A5A5");
            s102.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#A5A5A5");
            s102.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#A5A5A5");
            s102.NumberFormat = "0%";
            // -----------------------------------------------
            //  s103
            // -----------------------------------------------
            WorksheetStyle s103 = styles.Add("s103");
            s103.Font.Bold = true;
            s103.Font.FontName = "Arial";
            s103.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s103.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s103.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#A5A5A5");
            s103.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#A5A5A5");
            s103.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#A5A5A5");
            s103.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#A5A5A5");
            s103.NumberFormat = "0%";
            // -----------------------------------------------
            //  s104
            // -----------------------------------------------
            WorksheetStyle s104 = styles.Add("s104");
            s104.Font.FontName = "Arial";
            // -----------------------------------------------
            //  s105
            // -----------------------------------------------
            WorksheetStyle s105 = styles.Add("s105");
            s105.Font.FontName = "Arial";
            s105.Font.Color = "#000000";
            s105.Interior.Color = "#DCE6F1";
            s105.Interior.Pattern = StyleInteriorPattern.Solid;
            s105.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s105.Alignment.Vertical = StyleVerticalAlignment.Top;
            s105.Alignment.WrapText = true;
            s105.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s106
            // -----------------------------------------------
            WorksheetStyle s106 = styles.Add("s106");
            s106.Font.FontName = "Arial";
            s106.Font.Color = "#000000";
            s106.Interior.Color = "#DCE6F1";
            s106.Interior.Pattern = StyleInteriorPattern.Solid;
            s106.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s106.Alignment.Vertical = StyleVerticalAlignment.Top;
            s106.Alignment.WrapText = true;
            s106.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s105R
            // -----------------------------------------------
            WorksheetStyle s105R = styles.Add("s105R");
            s105R.Font.FontName = "Arial";
            s105R.Font.Color = "#FF0000";
            s105R.Interior.Color = "#DCE6F1";
            s105R.Interior.Pattern = StyleInteriorPattern.Solid;
            s105R.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s105R.Alignment.Vertical = StyleVerticalAlignment.Top;
            s105R.Alignment.WrapText = true;
            s105R.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s106R
            // -----------------------------------------------
            WorksheetStyle s106R = styles.Add("s106R");
            s106R.Font.FontName = "Arial";
            s106R.Font.Color = "#FF0000";
            s106R.Interior.Color = "#DCE6F1";
            s106R.Interior.Pattern = StyleInteriorPattern.Solid;
            s106R.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s106R.Alignment.Vertical = StyleVerticalAlignment.Top;
            s106R.Alignment.WrapText = true;
            s106R.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;


            // -----------------------------------------------
            //  s107
            // -----------------------------------------------
            WorksheetStyle s107 = styles.Add("s107");
            s107.Font.FontName = "Arial";
            // -----------------------------------------------
            //  s108
            // -----------------------------------------------
            WorksheetStyle s108 = styles.Add("s108");
            s108.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#A5A5A5");
            s108.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#A5A5A5");
            s108.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#A5A5A5");
            s108.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#A5A5A5");
            s108.NumberFormat = "0%";

            // -----------------------------------------------
            //  s110
            // -----------------------------------------------
            WorksheetStyle s110 = styles.Add("s110");
            s110.Font.FontName = "Arial";
            s110.Font.Color = "#000000";
            s110.Interior.Color = "#FFFFFF";//**"#FCE4D6";
            s110.Interior.Pattern = StyleInteriorPattern.Solid;
            s110.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s110.Alignment.Vertical = StyleVerticalAlignment.Top;
            s110.Alignment.WrapText = true;
            s110.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s111
            // -----------------------------------------------
            WorksheetStyle s111 = styles.Add("s111");
            s111.Font.FontName = "Arial";
            s111.Font.Color = "#000000";
            s111.Interior.Color = "#FFFFFF";//**"#FCE4D6";
            s111.Interior.Pattern = StyleInteriorPattern.Solid;
            s111.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s111.Alignment.Vertical = StyleVerticalAlignment.Top;
            s111.Alignment.WrapText = true;
            s111.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s110R
            // -----------------------------------------------
            WorksheetStyle s110R = styles.Add("s110R");
            s110R.Font.FontName = "Arial";
            s110R.Font.Color = "#FF0000";
            s110R.Interior.Color = "#FFFFFF";//**"#FCE4D6";
            s110R.Interior.Pattern = StyleInteriorPattern.Solid;
            s110R.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s110R.Alignment.Vertical = StyleVerticalAlignment.Top;
            s110R.Alignment.WrapText = true;
            s110R.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s111R
            // -----------------------------------------------
            WorksheetStyle s111R = styles.Add("s111R");
            s111R.Font.FontName = "Arial";
            s111R.Font.Color = "#FF0000";
            s111R.Interior.Color = "#FFFFFF";//**"#FCE4D6";
            s111R.Interior.Pattern = StyleInteriorPattern.Solid;
            s111R.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s111R.Alignment.Vertical = StyleVerticalAlignment.Top;
            s111R.Alignment.WrapText = true;
            s111R.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;

            // -----------------------------------------------
            //  s112
            // -----------------------------------------------
            WorksheetStyle s112 = styles.Add("s112");
            s112.Font.FontName = "Arial";
            s112.Font.Color = "#000000";
            s112.Interior.Color = "#E2EFDA";
            s112.Interior.Pattern = StyleInteriorPattern.Solid;
            s112.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s112.Alignment.Vertical = StyleVerticalAlignment.Top;
            s112.Alignment.WrapText = true;
            s112.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s113
            // -----------------------------------------------
            WorksheetStyle s113 = styles.Add("s113");
            s113.Font.FontName = "Arial";
            s113.Font.Color = "#000000";
            s113.Interior.Color = "#E2EFDA";
            s113.Interior.Pattern = StyleInteriorPattern.Solid;
            s113.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s113.Alignment.Vertical = StyleVerticalAlignment.Top;
            s113.Alignment.WrapText = true;
            s113.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s112R
            // -----------------------------------------------
            WorksheetStyle s112R = styles.Add("s112R");
            s112R.Font.FontName = "Arial";
            s112R.Font.Color = "#FF0000";
            s112R.Interior.Color = "#E2EFDA";
            s112R.Interior.Pattern = StyleInteriorPattern.Solid;
            s112R.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s112R.Alignment.Vertical = StyleVerticalAlignment.Top;
            s112R.Alignment.WrapText = true;
            s112R.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s113R
            // -----------------------------------------------
            WorksheetStyle s113R = styles.Add("s113R");
            s113R.Font.FontName = "Arial";
            s113R.Font.Color = "#FF0000";
            s113R.Interior.Color = "#E2EFDA";
            s113R.Interior.Pattern = StyleInteriorPattern.Solid;
            s113R.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s113R.Alignment.Vertical = StyleVerticalAlignment.Top;
            s113R.Alignment.WrapText = true;
            s113R.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;


            // -----------------------------------------------
            //  s31
            // -----------------------------------------------
            WorksheetStyle s31 = styles.Add("s31");
            s31.Font.Bold = true;
            s31.Font.Underline = UnderlineStyle.Single;
            s31.Font.FontName = "Times New Roman";
            s31.Font.Size = 12;
            s31.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s31.Alignment.Vertical = StyleVerticalAlignment.Center;
            // -----------------------------------------------
            //  s32
            // -----------------------------------------------
            WorksheetStyle s32 = styles.Add("s32");
            s32.Font.Bold = true;
            s32.Font.Underline = UnderlineStyle.Single;
            s32.Font.FontName = "Times New Roman";
            s32.Font.Size = 12;
            s32.Font.Color = "#000000";
            s32.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s32.Alignment.Vertical = StyleVerticalAlignment.Center;
            //s32.NumberFormat = "_(* #,##0.00_);_(* \\(#,##0.00\\);_(* \"-\"??_);_(@_)";
            // -----------------------------------------------
            //  s33
            // -----------------------------------------------
            WorksheetStyle s33 = styles.Add("s33");
            s33.Font.Bold = true;
            s33.Font.Underline = UnderlineStyle.Single;
            s33.Font.FontName = "Times New Roman";
            s33.Font.Size = 12;
            s33.Font.Color = "#000000";
            s33.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s33.Alignment.Vertical = StyleVerticalAlignment.Center;
            // -----------------------------------------------
            //  s34
            // -----------------------------------------------
            WorksheetStyle s34 = styles.Add("s34");
            s34.Font.Bold = true;
            s34.Font.Underline = UnderlineStyle.Single;
            s34.Font.FontName = "Calibri";
            s34.Font.Size = 11;
            s34.Font.Color = "#000000";
            s34.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s34.Alignment.Vertical = StyleVerticalAlignment.Center;
            // -----------------------------------------------
            //  s35
            // -----------------------------------------------
            WorksheetStyle s35 = styles.Add("s35");
            s35.Font.FontName = "Calibri";
            s35.Font.Size = 11;
            s35.Font.Color = "#000000";
            s35.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s35.Alignment.Vertical = StyleVerticalAlignment.Center;
            s35.Alignment.WrapText = true;
            // -----------------------------------------------
            //  s36
            // -----------------------------------------------
            WorksheetStyle s36 = styles.Add("s36");
            s36.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s36.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  s37
            // -----------------------------------------------
            WorksheetStyle s37 = styles.Add("s37");
            s37.Font.FontName = "Calibri";
            s37.Font.Size = 11;
            s37.Font.Color = "#000000";
            s37.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s37.Alignment.Vertical = StyleVerticalAlignment.Center;
            s37.Alignment.WrapText = true;
            // -----------------------------------------------
            //  s38
            // -----------------------------------------------
            WorksheetStyle s38 = styles.Add("s38");
            //s38.Parent = "s16";
            s38.Font.FontName = "Calibri";
            s38.Font.Size = 11;
            s38.Font.Color = "#000000";
            s38.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s38.Alignment.Vertical = StyleVerticalAlignment.Center;
            s38.Alignment.WrapText = true;
            // -----------------------------------------------
            //  s39
            // -----------------------------------------------
            WorksheetStyle s39 = styles.Add("s39");
            s39.Font.FontName = "Calibri";
            s39.Font.Size = 11;
            s39.Font.Color = "#000000";
            s39.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s39.Alignment.Vertical = StyleVerticalAlignment.Center;
            s39.Alignment.WrapText = true;
            // -----------------------------------------------
            //  s40
            // -----------------------------------------------
            WorksheetStyle s40 = styles.Add("s40");
            s40.Font.Bold = true;
            s40.Font.FontName = "Calibri";
            s40.Font.Size = 11;
            s40.Font.Color = "#000000";
            s40.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s40.Alignment.Vertical = StyleVerticalAlignment.Center;
            s40.Alignment.WrapText = true;
            //// -----------------------------------------------
            ////  s41
            //// -----------------------------------------------
            //WorksheetStyle s41 = styles.Add("s41");
            //s41.Font.Bold = true;
            //s41.Font.FontName = "Calibri";
            //s41.Font.Size = 11;
            //s41.Font.Color = "#000000";
            ////s41.NumberFormat = "_(\"$\"* #,##0.00_);_(\"$\"* \\(#,##0.00\\);_(\"$\"* \"-\"??_);_(@_)";
            // -----------------------------------------------
            //  s60
            // -----------------------------------------------
            WorksheetStyle s60 = styles.Add("s60");
            s60.Font.Bold = true;
            s60.Font.FontName = "Arial";
            //s60.Font.Color = "#000000";
            //s60.Interior.Color = "#B0C4DE";
            //s60.Interior.Pattern = StyleInteriorPattern.Solid;
            s60.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s60.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s60.Alignment.WrapText = true;
            //s60.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            //s60.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#000000");
            //s60.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            //s60.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");



            // -----------------------------------------------
            //  s61
            // -----------------------------------------------
            WorksheetStyle s61 = styles.Add("s61");
            s61.Font.Bold = true;
            s61.Font.FontName = "Arial";
            //s61.Font.Color = "#000000";
            //s61.Interior.Color = "#B0C4DE";
            //s61.Interior.Pattern = StyleInteriorPattern.Solid;
            s61.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s61.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s61.Alignment.WrapText = true;
            //s61.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            //s61.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#000000");
            //s61.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            //s61.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");

            // -----------------------------------------------
            //  s62
            // -----------------------------------------------
            WorksheetStyle s62 = styles.Add("s62");
            s62.Font.Bold = true;
            s62.Font.FontName = "Arial";
            s62.Font.Size = 14;
            s62.Font.Color = "#000000";
            s62.Interior.Color = "#B0C4DE";
            s62.Interior.Pattern = StyleInteriorPattern.Solid;
            s62.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s62.Alignment.Vertical = StyleVerticalAlignment.Top;
            s62.Alignment.WrapText = true;
            //s62.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            //s62.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#000000");
            //s62.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            //s62.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s63
            // -----------------------------------------------
            WorksheetStyle s63 = styles.Add("s63");
            //s63.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            //s63.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            //s63.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            //s63.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s64
            // -----------------------------------------------
            WorksheetStyle s64 = styles.Add("s64");
            s64.Font.FontName = "Arial";
            //s64.Font.Color = "#000000";
            //s64.Interior.Color = "#FFFFFF";
            //s64.Interior.Pattern = StyleInteriorPattern.Solid;
            s64.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s64.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s64.Alignment.WrapText = true;
            //s64.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            //s64.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            //s64.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            //s64.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            //s64.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s65
            // -----------------------------------------------
            WorksheetStyle s65 = styles.Add("s65");
            s65.Font.FontName = "Arial";
            //s65.Font.Color = "#000000";
            //s65.Interior.Color = "#FFFFFF";
            //s65.Interior.Pattern = StyleInteriorPattern.Solid;
            s65.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s65.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s65.Alignment.WrapText = true;
            //s65.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            //s65.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            //s65.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            //s65.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            //s65.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s66
            // -----------------------------------------------
            WorksheetStyle s66 = styles.Add("s66");
            s66.Font.FontName = "Arial";
            s66.Font.Color = "#FF0000";
            s66.Interior.Color = "#FFFFFF";
            s66.Interior.Pattern = StyleInteriorPattern.Solid;
            s66.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s66.Alignment.Vertical = StyleVerticalAlignment.Top;
            s66.Alignment.WrapText = true;
            s66.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            //s66.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            //s66.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            //s66.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            //s66.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s67
            // -----------------------------------------------
            WorksheetStyle s67 = styles.Add("s67");
            s67.Font.FontName = "Arial";
            s67.Font.Color = "#FF0000";
            s67.Interior.Color = "#FFFFFF";
            s67.Interior.Pattern = StyleInteriorPattern.Solid;
            s67.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s67.Alignment.Vertical = StyleVerticalAlignment.Top;
            s67.Alignment.WrapText = true;
            s67.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            //s67.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            //s67.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            //s67.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            //s67.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s68
            // -----------------------------------------------
            WorksheetStyle s68 = styles.Add("s68");
            s68.Font.FontName = "Arial";
            s68.Font.Color = "#000000";
            s68.Interior.Color = "#ffe6e6";
            s68.Interior.Pattern = StyleInteriorPattern.Solid;
            s68.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s68.Alignment.Vertical = StyleVerticalAlignment.Top;
            s68.Alignment.WrapText = true;
            s68.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            //s68.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            //s68.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            //s68.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            //s68.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);

            // -----------------------------------------------
            //  s70
            // -----------------------------------------------
            WorksheetStyle s70 = styles.Add("s70");
            s70.Font.FontName = "Arial";
            s70.Font.Color = "#000000";
            s70.Interior.Color = "#d6f5d6";
            s70.Interior.Pattern = StyleInteriorPattern.Solid;
            s70.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s70.Alignment.Vertical = StyleVerticalAlignment.Top;
            s70.Alignment.WrapText = true;
            s70.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            s70.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s70.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s70.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s70.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);

            // -----------------------------------------------
            //  s72
            // -----------------------------------------------
            WorksheetStyle s72 = styles.Add("s72");
            s72.Font.FontName = "Arial";
            s72.Font.Color = "#000000";
            s72.Font.Bold = true;
            s72.Interior.Color = "#d6f5d6";
            s72.Interior.Pattern = StyleInteriorPattern.Solid;
            s72.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s72.Alignment.Vertical = StyleVerticalAlignment.Top;
            s72.Alignment.WrapText = true;
            s72.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            s72.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s72.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s72.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s72.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);

            // -----------------------------------------------
            //  s137
            // -----------------------------------------------
            WorksheetStyle s137 = styles.Add("s137");
            s137.Name = "Normal 3";
            s137.Font.FontName = "Calibri";
            s137.Font.Size = 11;
            s137.Font.Color = "#000000";
            s137.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  m2611536909264
            // -----------------------------------------------
            WorksheetStyle m2611536909264 = styles.Add("m2611536909264");
            m2611536909264.Parent = "s137";
            m2611536909264.Font.FontName = "Arial";
            m2611536909264.Font.Color = "#9400D3";
            m2611536909264.Interior.Color = "#FFFFFF";
            m2611536909264.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611536909264.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611536909264.Alignment.WrapText = true;
            m2611536909264.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611536909264.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611536909284
            // -----------------------------------------------
            WorksheetStyle m2611536909284 = styles.Add("m2611536909284");
            m2611536909284.Parent = "s137";
            m2611536909284.Font.FontName = "Arial";
            m2611536909284.Font.Color = "#9400D3";
            m2611536909284.Interior.Color = "#FFFFFF";
            m2611536909284.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611536909284.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611536909284.Alignment.WrapText = true;
            m2611536909284.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611536909284.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");

            // -----------------------------------------------
            //  m2611536909285
            // -----------------------------------------------
            WorksheetStyle m2611536909285 = styles.Add("m2611536909285");
            m2611536909285.Parent = "s137";
            m2611536909285.Font.FontName = "Arial";
            m2611536909285.Font.Size = 14;
            m2611536909285.Font.Bold = true;
            m2611536909285.Font.Color = "#9400D3";
            m2611536909285.Interior.Color = "#FFFFFF";
            m2611536909285.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611536909285.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611536909285.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m2611536909285.Alignment.WrapText = true;
            m2611536909285.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611536909285.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");

            // -----------------------------------------------
            //  m2611536909286
            // -----------------------------------------------
            WorksheetStyle m2611536909286 = styles.Add("m2611536909286");
            m2611536909286.Parent = "s137";
            m2611536909286.Font.FontName = "Arial";
            m2611536909286.Font.Color = "#9400D3";
            m2611536909286.Interior.Color = "#FFFFFF";
            m2611536909286.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611536909286.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611536909286.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            m2611536909286.Alignment.WrapText = true;
            m2611536909286.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611536909286.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611536909304
            // -----------------------------------------------
            WorksheetStyle m2611536909304 = styles.Add("m2611536909304");
            m2611536909304.Parent = "s137";
            m2611536909304.Font.FontName = "Arial";
            m2611536909304.Font.Color = "#9400D3";
            m2611536909304.Interior.Color = "#FFFFFF";
            m2611536909304.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611536909304.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611536909304.Alignment.WrapText = true;
            m2611536909304.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611536909304.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611536909324
            // -----------------------------------------------
            WorksheetStyle m2611536909324 = styles.Add("m2611536909324");
            m2611536909324.Parent = "s137";
            m2611536909324.Font.FontName = "Arial";
            m2611536909324.Font.Color = "#9400D3";
            m2611536909324.Interior.Color = "#FFFFFF";
            m2611536909324.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611536909324.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611536909324.Alignment.WrapText = true;
            m2611536909324.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611536909324.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611536909344
            // -----------------------------------------------
            WorksheetStyle m2611536909344 = styles.Add("m2611536909344");
            m2611536909344.Parent = "s137";
            m2611536909344.Font.FontName = "Arial";
            m2611536909344.Font.Color = "#9400D3";
            m2611536909344.Interior.Color = "#FFFFFF";
            m2611536909344.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611536909344.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611536909344.Alignment.WrapText = true;
            m2611536909344.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611536909344.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611540549552
            // -----------------------------------------------
            WorksheetStyle m2611540549552 = styles.Add("m2611540549552");
            m2611540549552.Parent = "s137";
            m2611540549552.Font.FontName = "Arial";
            m2611540549552.Font.Color = "#9400D3";
            m2611540549552.Interior.Color = "#FFFFFF";
            m2611540549552.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611540549552.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611540549552.Alignment.WrapText = true;
            m2611540549552.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611540549552.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611540549572
            // -----------------------------------------------
            WorksheetStyle m2611540549572 = styles.Add("m2611540549572");
            m2611540549572.Parent = "s137";
            m2611540549572.Font.FontName = "Arial";
            m2611540549572.Font.Color = "#9400D3";
            m2611540549572.Interior.Color = "#FFFFFF";
            m2611540549572.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611540549572.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611540549572.Alignment.WrapText = true;
            m2611540549572.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611540549572.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#000000");
            m2611540549572.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611540549592
            // -----------------------------------------------
            WorksheetStyle m2611540549592 = styles.Add("m2611540549592");
            m2611540549592.Parent = "s137";
            m2611540549592.Font.FontName = "Arial";
            m2611540549592.Font.Color = "#9400D3";
            m2611540549592.Interior.Color = "#FFFFFF";
            m2611540549592.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611540549592.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611540549592.Alignment.WrapText = true;
            m2611540549592.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611540549592.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611540549612
            // -----------------------------------------------
            WorksheetStyle m2611540549612 = styles.Add("m2611540549612");
            m2611540549612.Parent = "s137";
            m2611540549612.Font.FontName = "Arial";
            m2611540549612.Font.Color = "#9400D3";
            m2611540549612.Interior.Color = "#FFFFFF";
            m2611540549612.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611540549612.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611540549612.Alignment.WrapText = true;
            m2611540549612.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611540549612.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611540549632
            // -----------------------------------------------
            WorksheetStyle m2611540549632 = styles.Add("m2611540549632");
            m2611540549632.Parent = "s137";
            m2611540549632.Font.FontName = "Arial";
            m2611540549632.Font.Color = "#9400D3";
            m2611540549632.Interior.Color = "#FFFFFF";
            m2611540549632.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611540549632.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611540549632.Alignment.WrapText = true;
            m2611540549632.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611540549632.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611540549652
            // -----------------------------------------------
            WorksheetStyle m2611540549652 = styles.Add("m2611540549652");
            m2611540549652.Parent = "s137";
            m2611540549652.Font.FontName = "Arial";
            m2611540549652.Font.Color = "#9400D3";
            m2611540549652.Interior.Color = "#FFFFFF";
            m2611540549652.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611540549652.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611540549652.Alignment.WrapText = true;
            m2611540549652.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611540549652.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611540549672
            // -----------------------------------------------
            WorksheetStyle m2611540549672 = styles.Add("m2611540549672");
            m2611540549672.Parent = "s137";
            m2611540549672.Font.FontName = "Arial";
            m2611540549672.Font.Color = "#9400D3";
            m2611540549672.Interior.Color = "#FFFFFF";
            m2611540549672.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611540549672.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611540549672.Alignment.WrapText = true;
            m2611540549672.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611540549672.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");

            // -----------------------------------------------
            //  s139
            // -----------------------------------------------
            WorksheetStyle s139 = styles.Add("s139");
            s139.Parent = "s137";
            s139.Font.FontName = "Calibri";
            s139.Font.Size = 11;
            s139.Interior.Color = "#FFFFFF";
            s139.Interior.Pattern = StyleInteriorPattern.Solid;
            s139.Alignment.Vertical = StyleVerticalAlignment.Top;
            s139.Alignment.WrapText = true;
            // -----------------------------------------------
            //  s140
            // -----------------------------------------------
            WorksheetStyle s140 = styles.Add("s140");
            s140.Parent = "s137";
            s140.Font.FontName = "Calibri";
            s140.Font.Size = 11;
            s140.Interior.Color = "#FFFFFF";
            s140.Interior.Pattern = StyleInteriorPattern.Solid;
            s140.Alignment.Vertical = StyleVerticalAlignment.Top;
            s140.Alignment.WrapText = true;
            s140.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#000000");
            s140.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s141
            // -----------------------------------------------
            WorksheetStyle s141 = styles.Add("s141");
            s141.Parent = "s137";
            s141.Font.FontName = "Calibri";
            s141.Font.Size = 11;
            s141.Interior.Color = "#FFFFFF";
            s141.Interior.Pattern = StyleInteriorPattern.Solid;
            s141.Alignment.Vertical = StyleVerticalAlignment.Top;
            s141.Alignment.WrapText = true;
            s141.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s142
            // -----------------------------------------------
            WorksheetStyle s142 = styles.Add("s142");
            s142.Parent = "s137";
            s142.Font.FontName = "Calibri";
            s142.Font.Size = 11;
            s142.Interior.Color = "#FFFFFF";
            s142.Interior.Pattern = StyleInteriorPattern.Solid;
            s142.Alignment.Vertical = StyleVerticalAlignment.Top;
            s142.Alignment.WrapText = true;
            s142.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            s142.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s143
            // -----------------------------------------------
            WorksheetStyle s143 = styles.Add("s143");
            s143.Parent = "s137";
            s143.Font.FontName = "Calibri";
            s143.Font.Size = 11;
            s143.Interior.Color = "#FFFFFF";
            s143.Interior.Pattern = StyleInteriorPattern.Solid;
            s143.Alignment.Vertical = StyleVerticalAlignment.Top;
            s143.Alignment.WrapText = true;
            s143.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s144
            // -----------------------------------------------
            WorksheetStyle s144 = styles.Add("s144");
            s144.Parent = "s137";
            s144.Font.FontName = "Arial";
            s144.Font.Color = "#9400D3";
            s144.Interior.Color = "#FFFFFF";
            s144.Interior.Pattern = StyleInteriorPattern.Solid;
            s144.Alignment.Vertical = StyleVerticalAlignment.Top;
            s144.Alignment.WrapText = true;
            s144.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s145
            // -----------------------------------------------
            WorksheetStyle s145 = styles.Add("s145");
            s145.Parent = "s137";
            s145.Font.FontName = "Calibri";
            s145.Font.Size = 11;
            s145.Interior.Color = "#FFFFFF";
            s145.Interior.Pattern = StyleInteriorPattern.Solid;
            s145.Alignment.Vertical = StyleVerticalAlignment.Top;
            s145.Alignment.WrapText = true;
            s145.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s146
            // -----------------------------------------------
            WorksheetStyle s146 = styles.Add("s146");
            s146.Parent = "s137";
            s146.Font.FontName = "Calibri";
            s146.Font.Size = 11;
            s146.Interior.Color = "#FFFFFF";
            s146.Interior.Pattern = StyleInteriorPattern.Solid;
            s146.Alignment.Vertical = StyleVerticalAlignment.Top;
            s146.Alignment.WrapText = true;
            s146.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#000000");
            s146.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s169
            // -----------------------------------------------
            WorksheetStyle s169 = styles.Add("s169");
            s169.Parent = "s137";
            s169.Font.FontName = "Arial";
            s169.Font.Color = "#9400D3";
            s169.Interior.Color = "#FFFFFF";
            s169.Interior.Pattern = StyleInteriorPattern.Solid;
            s169.Alignment.Vertical = StyleVerticalAlignment.Top;
            s169.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s170
            // -----------------------------------------------
            WorksheetStyle s170 = styles.Add("s170");
            s170.Parent = "s137";
            s170.Font.FontName = "Calibri";
            s170.Font.Size = 11;
            s170.Interior.Color = "#FFFFFF";
            s170.Interior.Pattern = StyleInteriorPattern.Solid;
            s170.Alignment.Vertical = StyleVerticalAlignment.Top;
            // -----------------------------------------------
            //  s171
            // -----------------------------------------------
            WorksheetStyle s171 = styles.Add("s171");
            s171.Parent = "s137";
            s171.Font.FontName = "Calibri";
            s171.Font.Size = 11;
            s171.Interior.Color = "#FFFFFF";
            s171.Interior.Pattern = StyleInteriorPattern.Solid;
            s171.Alignment.Vertical = StyleVerticalAlignment.Top;
            s171.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s172
            // -----------------------------------------------
            WorksheetStyle s172 = styles.Add("s172");
            s172.Alignment.Vertical = StyleVerticalAlignment.Bottom;

            // -----------------------------------------------
            //  s169
            // -----------------------------------------------
            WorksheetStyle s169H = styles.Add("s169H");
            s169H.Parent = "s137";
            s169H.Font.FontName = "Arial";
            s169H.Font.Color = "#9400D3";
            s169H.Interior.Color = "#FFFFFF";
            s169H.Interior.Pattern = StyleInteriorPattern.Solid;
            s169H.Alignment.Vertical = StyleVerticalAlignment.Top;
            s169H.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s170
            // -----------------------------------------------
            WorksheetStyle s170H = styles.Add("s170H");
            s170H.Parent = "s137";
            s170H.Font.FontName = "Calibri";
            s170H.Font.Size = 11;
            s170H.Interior.Color = "#FFFFFF";
            s170H.Interior.Pattern = StyleInteriorPattern.Solid;
            s170H.Alignment.Vertical = StyleVerticalAlignment.Top;
            // -----------------------------------------------
            //  s171
            // -----------------------------------------------
            WorksheetStyle s171H = styles.Add("s171H");
            s171H.Parent = "s137";
            s171H.Font.FontName = "Calibri";
            s171H.Font.Size = 11;
            s171H.Interior.Color = "#FFFFFF";
            s171H.Interior.Pattern = StyleInteriorPattern.Solid;
            s171H.Alignment.Vertical = StyleVerticalAlignment.Top;
            s171H.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s172
            // -----------------------------------------------
            WorksheetStyle s172H = styles.Add("s172H");
            s172H.Alignment.Vertical = StyleVerticalAlignment.Bottom;

            // -----------------------------------------------
            //  MainHeaderStyles
            // -----------------------------------------------
            WorksheetStyle mainstyle = styles.Add("MainHeaderStyles");
            mainstyle.Font.FontName = "Arial";//"Calibri";//"Tahoma";
            mainstyle.Font.Size = 12;
            //**mainstyle.Font.Bold = true;
            mainstyle.Font.Color = "#FFFFFF";
            mainstyle.Interior.Color = "#0070c0";
            mainstyle.Interior.Pattern = StyleInteriorPattern.Solid;
            mainstyle.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            mainstyle.Alignment.Vertical = StyleVerticalAlignment.Center;
            // -----------------------------------------------
            //  MainHeaderStyles
            // -----------------------------------------------

            // -----------------------------------------------
            //  MainHeaderStylesLeft
            // -----------------------------------------------
            WorksheetStyle mainstyleLeft = styles.Add("MainHeaderStylesLeft");
            mainstyleLeft.Font.FontName = "Arial";//"Calibri";//"Tahoma";
            mainstyleLeft.Font.Size = 12;
            //**mainstyle.Font.Bold = true;
            mainstyleLeft.Font.Color = "#FFFFFF";
            mainstyleLeft.Interior.Color = "#0070c0";
            mainstyleLeft.Interior.Pattern = StyleInteriorPattern.Solid;
            mainstyleLeft.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            mainstyleLeft.Alignment.Vertical = StyleVerticalAlignment.Center;
            // -----------------------------------------------
            //  MainHeaderStylesLeft
            // -----------------------------------------------

            // -----------------------------------------------
            //  MainHeaderStylesLeftYellow
            // -----------------------------------------------
            WorksheetStyle mainstyleLeftY = styles.Add("MainHeaderStylesLeftYellow");
            mainstyleLeftY.Font.FontName = "Arial";//"Calibri";//"Tahoma";
            mainstyleLeftY.Font.Size = 12;
            //**mainstyle.Font.Bold = true;
            mainstyleLeftY.Font.Color = "#FFFF00";
            mainstyleLeftY.Interior.Color = "#0070c0";
            mainstyleLeftY.Interior.Pattern = StyleInteriorPattern.Solid;
            mainstyleLeftY.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            mainstyleLeftY.Alignment.Vertical = StyleVerticalAlignment.Center;
            // -----------------------------------------------
            //  MainHeaderStylesLeftYellow
            // -----------------------------------------------

            // -----------------------------------------------
            //  MainHeaderStylesRight
            // -----------------------------------------------
            WorksheetStyle mainstyleRight = styles.Add("MainHeaderStylesRight");
            mainstyleRight.Font.FontName = "Arial";//"Calibri";//"Tahoma";
            mainstyleRight.Font.Size = 12;
            //**mainstyle.Font.Bold = true;
            mainstyleRight.Font.Color = "#FFFFFF";
            mainstyleRight.Interior.Color = "#0070c0";
            mainstyleRight.Interior.Pattern = StyleInteriorPattern.Solid;
            mainstyleRight.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            mainstyleRight.Alignment.Vertical = StyleVerticalAlignment.Center;
            // -----------------------------------------------
            //  MainHeaderStylesRight
            // -----------------------------------------------

            // -----------------------------------------------
            //  MainHeaderStyles1
            // -----------------------------------------------
            WorksheetStyle mainstyle1 = styles.Add("MainHeaderStyles1");
            mainstyle1.Font.FontName = "Arial";//"Calibri";//"Tahoma";
            mainstyle1.Font.Size = 12;
            //**mainstyle1.Font.Bold = true;
            mainstyle1.Font.Color = "#FFFFFF";
            mainstyle1.Interior.Color = "#0070c0";
            mainstyle1.Interior.Pattern = StyleInteriorPattern.Solid;
            mainstyle1.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            mainstyle1.Alignment.Vertical = StyleVerticalAlignment.Center;
            mainstyle1.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#FFFFFF");
            // -----------------------------------------------
            //  MainHeaderStyles1
            // -----------------------------------------------

            // -----------------------------------------------
            //  s987
            // -----------------------------------------------
            WorksheetStyle s987 = styles.Add("s987");
            s987.Font.FontName = "Arial";//"Calibri";//"Tahoma";
            s987.Font.Size = 12;
            s987.Font.Bold = true;
            s987.Font.Color = "#FFFFFF";
            s987.Interior.Color = "#92D050";
            s987.Interior.Pattern = StyleInteriorPattern.Solid;
            s987.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s987.Alignment.Vertical = StyleVerticalAlignment.Center;

        }


        private void On_SaveExcelAudit_Closed_Main(string PdfFileName)
        {
            Random_Filename = null;
            string PdfName = "Pdf File";
            PdfName = propReportPath + BaseForm.UserID + "\\" + PdfFileName + "_Audit";
            try
            {
                if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                {
                    DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim());
                }
            }
            catch (Exception ex)
            {
                CommonFunctions.MessageBoxDisplay("Error");
            }

            try
            {
                string Tmpstr = PdfName + ".xls";
                if (File.Exists(Tmpstr))
                    File.Delete(Tmpstr);
            }
            catch (Exception ex)
            {
                int length = 8;
                string newFileName = System.Guid.NewGuid().ToString();
                newFileName = newFileName.Replace("-", string.Empty);

                Random_Filename = PdfName + newFileName.Substring(0, length) + ".xls";
            }

            if (!string.IsNullOrEmpty(Random_Filename))
                PdfName = Random_Filename;
            else
                PdfName += ".xls";



            Workbook book = new Workbook();

            this.GenerateStyles(book.Styles);



            bool First = true;
            string MS_Type = string.Empty;
            string CAMSDesc = null;
            string Branch = null, Priv_Branch = null, SP_Plan_desc = null;
            bool SPNum = true;
            Worksheet sheet;
            WorksheetCell cell;
            WorksheetRow Row0;
            int Count = 1;


            if (dtAudit.Rows.Count > 0)
            {
                this.GenerateWorksheetParameters(book.Worksheets);

                string PrivSP = string.Empty;

                var distinctRows = (from DataRow dRow in dtAudit.Rows
                                    select dRow["SP"]).Distinct();

                foreach (var dRow in distinctRows)
                {
                    DataTable dataTable = new DataTable();
                    DataView dv = new DataView(dtAudit);
                    dv.RowFilter = "SP='" + dRow + "'";
                    dataTable = dv.ToTable();

                    if (dataTable.Rows.Count > 0)
                    {
                        string ReportName = dataTable.Rows[0]["SP_Desc"].ToString();
                        ReportName = ReportName.Replace("/", "");

                        if (ReportName.Length >= 31)
                        {
                            ReportName = ReportName.Substring(0, 31);
                        }
                        sheet = book.Worksheets.Add(ReportName);
                        sheet.Table.DefaultRowHeight = 14.25F;


                        sheet.Table.Columns.Add(75);
                        sheet.Table.Columns.Add(75);
                        sheet.Table.Columns.Add(75);
                        sheet.Table.Columns.Add(75);
                        sheet.Table.Columns.Add(80);
                        sheet.Table.Columns.Add(145);
                        sheet.Table.Columns.Add(75);
                        sheet.Table.Columns.Add(80);
                        sheet.Table.Columns.Add(180);
                        sheet.Table.Columns.Add(80);
                        sheet.Table.Columns.Add(80);
                        sheet.Table.Columns.Add(80);

                        Row0 = sheet.Table.Rows.Add();
                        Row0.AutoFitHeight = false;
                        //WorksheetCell cell;
                        cell = Row0.Cells.Add();
                        cell.StyleID = "s83";
                        cell.Data.Type = DataType.String;
                        cell.Data.Text = dataTable.Rows[0]["SP_Desc"].ToString();
                        cell.MergeAcross = 9;


                        Row0 = sheet.Table.Rows.Add();

                        cell = Row0.Cells.Add("Agency", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Dept", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Program", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Year", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("App", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Name", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Type", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Code", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Description", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Date", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Date Added", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Amount", DataType.String, "MainHeaderStylesRight");


                        int i = 0;
                        foreach (DataRow dr in dataTable.Rows)
                        {
                            Row0 = sheet.Table.Rows.Add();


                            string CAMSType = string.Empty;
                            if (dr["SP2_TYPE"].ToString().Trim() == "CA")
                                CAMSType = "Service";
                            else
                                CAMSType = "Outcome";



                            if (i % 2 == 0)
                            {
                                cell = Row0.Cells.Add(dr["Agency"].ToString(), DataType.String, "s105");
                                cell = Row0.Cells.Add(dr["Dept"].ToString(), DataType.String, "s105");
                                cell = Row0.Cells.Add(dr["Program"].ToString(), DataType.String, "s105");
                                cell = Row0.Cells.Add(dr["Prog_Year"].ToString(), DataType.String, "s105");
                                cell = Row0.Cells.Add(dr["AppNo"].ToString(), DataType.String, "s105");
                                cell = Row0.Cells.Add(dr["Name"].ToString(), DataType.String, "s105");
                                cell = Row0.Cells.Add(CAMSType, DataType.String, "s105");
                                cell = Row0.Cells.Add(dr["CAMS_CODE"].ToString(), DataType.String, "s105");
                                cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s105");
                                cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString()), DataType.String, "s105");
                                cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString()), DataType.String, "s105");
                                cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s106");



                            }
                            else
                            {

                                cell = Row0.Cells.Add(dr["Agency"].ToString(), DataType.String, "s95");
                                cell = Row0.Cells.Add(dr["Dept"].ToString(), DataType.String, "s95");
                                cell = Row0.Cells.Add(dr["Program"].ToString(), DataType.String, "s95");
                                cell = Row0.Cells.Add(dr["Prog_Year"].ToString(), DataType.String, "s95");
                                cell = Row0.Cells.Add(dr["AppNo"].ToString(), DataType.String, "s95");
                                cell = Row0.Cells.Add(dr["Name"].ToString(), DataType.String, "s95");
                                cell = Row0.Cells.Add(CAMSType, DataType.String, "s95");
                                cell = Row0.Cells.Add(dr["CAMS_CODE"].ToString(), DataType.String, "s95");
                                cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s95");
                                cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString()), DataType.String, "s95");
                                cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString()), DataType.String, "s95");
                                cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s95RC");


                            }




                            //if (dr["SP0_SERVICECODE"].ToString() != PrivSP)
                            //{



                            //    PrivSP = dr["SP0_SERVICECODE"].ToString();
                            //}


                            i++;
                        }
                    }


                }



            }


            FileStream stream = new FileStream(PdfName, FileMode.Create);

            book.Save(stream);
            stream.Close();

            AlertBox.Show(PdfFileName + "_Audit.xls file Generated Successfully");

            ////FileDownloadGateway downloadGateway = new FileDownloadGateway();
            ////downloadGateway.Filename = "SPREPAPP_Report.xls";

            ////// downloadGateway.Version = file.Version;

            ////downloadGateway.SetContentType(DownloadContentType.OctetStream);

            ////downloadGateway.StartFileDownload(new ContainerControl(), PdfName);

            //FileInfo fiDownload = new FileInfo(PdfName);
            ///// Need to check for file exists, is local file, is allow to read, etc...
            //string name = fiDownload.Name;
            //using (FileStream fileStream = fiDownload.OpenRead())
            //{
            //    Application.Download(fileStream, name);
            //}

            //}

        }


        private void On_SaveExcelAudit_Closed(string PdfFileName)
        {
            Random_Filename = null;
            string PdfName = "Pdf File";
            PdfName = propReportPath + BaseForm.UserID + "\\" + PdfFileName + "_Audit";
            try
            {
                if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                {
                    DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim());
                }
            }
            catch (Exception ex)
            {
                CommonFunctions.MessageBoxDisplay("Error");
            }

            try
            {
                string Tmpstr = PdfName + ".xls";
                if (File.Exists(Tmpstr))
                    File.Delete(Tmpstr);
            }
            catch (Exception ex)
            {
                int length = 8;
                string newFileName = System.Guid.NewGuid().ToString();
                newFileName = newFileName.Replace("-", string.Empty);

                Random_Filename = PdfName + newFileName.Substring(0, length) + ".xls";
            }

            if (!string.IsNullOrEmpty(Random_Filename))
                PdfName = Random_Filename;
            else
                PdfName += ".xls";



            Workbook book = new Workbook();

            this.GenerateStyles(book.Styles);



            bool First = true;
            string MS_Type = string.Empty;
            string CAMSDesc = null;
            string Branch = null, Priv_Branch = null, SP_Plan_desc = null;
            bool SPNum = true;
            Worksheet sheet;
            WorksheetCell cell;
            WorksheetRow Row0;
            int Count = 1;


            if (dtAudit.Rows.Count > 0)
            {
                this.GenerateWorksheetParameters(book.Worksheets);

                string PrivSP = string.Empty;

                var distinctRows = (from DataRow dRow in dtAudit.Rows
                                    select dRow["SP"]).Distinct();

                foreach (var dRow in distinctRows)
                {
                    DataTable dataTable = new DataTable();
                    DataView dv = new DataView(dtAudit);
                    dv.RowFilter = "SP='" + dRow + "'";
                    if (Rb_MS_Date.Checked)
                        dv.Sort = "CAMS_DATE";
                    else
                        dv.Sort = "CAMS_DATE_ADD";
                    dataTable = dv.ToTable();

                    if (dataTable.Rows.Count > 0)
                    {
                        string ReportName = dataTable.Rows[0]["SP_Desc"].ToString();
                        ReportName = ReportName.Replace("/", "");

                        if (ReportName.Length >= 31)
                        {
                            ReportName = ReportName.Substring(0, 31);
                        }
                        sheet = book.Worksheets.Add(ReportName);
                        sheet.Table.DefaultRowHeight = 14.25F;


                        //sheet.Table.Columns.Add(75);
                        //sheet.Table.Columns.Add(75);
                        //sheet.Table.Columns.Add(75);
                        //sheet.Table.Columns.Add(75);
                        //sheet.Table.Columns.Add(80);
                        //sheet.Table.Columns.Add(145);
                        //sheet.Table.Columns.Add(75);
                        //sheet.Table.Columns.Add(80);
                        //sheet.Table.Columns.Add(180);
                        //sheet.Table.Columns.Add(80);
                        //sheet.Table.Columns.Add(80);
                        //sheet.Table.Columns.Add(80);



                        //cell = Row0.Cells.Add("Agency", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Dept", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Program", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Year", DataType.String, "s94");
                        //cell = Row0.Cells.Add("App", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Name", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Type", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Code", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Description", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Date", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Date Added", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Amount", DataType.String, "s94");


                        sheet.Table.Columns.Add(200);//(180);
                        sheet.Table.Columns.Add(75);
                        sheet.Table.Columns.Add(50);
                        sheet.Table.Columns.Add(80);
                        sheet.Table.Columns.Add(80);
                        sheet.Table.Columns.Add(80);
                        sheet.Table.Columns.Add(80);
                        sheet.Table.Columns.Add(80);//(145);
                        sheet.Table.Columns.Add(145);
                        sheet.Table.Columns.Add(145);

                        Row0 = sheet.Table.Rows.Add();
                        Row0.AutoFitHeight = false;
                        //WorksheetCell cell;
                        cell = Row0.Cells.Add();
                        cell.StyleID = "s83";
                        cell.Data.Type = DataType.String;
                        cell.Data.Text = dataTable.Rows[0]["SP_Desc"].ToString();
                        cell.MergeAcross = 10;//8;//7;


                        Row0 = sheet.Table.Rows.Add();
                        Row0.Height = 20;
                        //cell = Row0.Cells.Add("Agency", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Dept", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Program", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Year", DataType.String, "s94");
                        //cell = Row0.Cells.Add("App", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Name", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Type", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Code", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Description", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Date", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Date Added", DataType.String, "s94");
                        //cell = Row0.Cells.Add("Amount", DataType.String, "s94");

                        cell = Row0.Cells.Add("Description", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Date", DataType.String, "MainHeaderStylesLeft");
                        if (rbQuaterly.Checked)
                            cell = Row0.Cells.Add("Q#", DataType.String, "MainHeaderStylesLeft");
                        else
                            cell = Row0.Cells.Add("M#", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Clients", DataType.String, "MainHeaderStylesRight");
                        cell = Row0.Cells.Add("Total Clients", DataType.String, "MainHeaderStylesRight");
                        cell = Row0.Cells.Add("Detail Amt.", DataType.String, "MainHeaderStylesRight");
                        cell = Row0.Cells.Add("Total Amt.", DataType.String, "MainHeaderStylesRight");
                        cell = Row0.Cells.Add("App No", DataType.String, "MainHeaderStyles");
                        cell = Row0.Cells.Add("Name", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Case Worker", DataType.String, "MainHeaderStylesLeft");
                        cell = Row0.Cells.Add("Site", DataType.String, "MainHeaderStylesLeft");


                        int i = 0;
                        string QM_type = string.Empty;
                        int QM_Count = 0;
                        string Serv = string.Empty;
                        string PrivClID = string.Empty;
                        int PrvCnt = 0;
                        foreach (DataRow dr in dataTable.Rows)
                        {
                            Row0 = sheet.Table.Rows.Add();
                            //Row0.Height = 16;

                            string CAMSType = string.Empty;
                            if (dr["SP2_TYPE"].ToString().Trim() == "CA")
                                CAMSType = "Service";
                            else
                                CAMSType = "Outcome";

                            //DataRow[] selrow1;
                            //if (rbQuaterly.Checked)
                            //    selrow1 = dataAudit.Select("Q_SEC='" + dr["Q_SEC"].ToString() + "' AND Client_ID='" + dr["Client_ID"].ToString() + "' AND CAMS_CODE='" + dr["CAMS_CODE"].ToString() + "'");
                            //else
                            //    selrow1 = dataAudit.Select("M_SEC='" + dr["M_SEC"].ToString() + "' AND Client_ID='" + dr["Client_ID"].ToString() + "' AND CAMS_CODE='" + dr["CAMS_CODE"].ToString() + "'");

                            //if(selrow1!= null) 
                            //{ 
                            //    QM_Count++; dr["cnt"] = QM_Count; 
                            //}

                            if (rbQuaterly.Checked)
                            {
                                if (dr["Q_SEC"].ToString().Trim() != QM_type || dr["CAMS_CODE"].ToString().Trim() != Serv)
                                {
                                    i++;
                                }
                                //else if (PrivClID != dr["Client_ID"].ToString().Trim()) QM_Count++;
                            }
                            else
                            {
                                if (dr["M_SEC"].ToString().Trim() != QM_type || dr["CAMS_CODE"].ToString().Trim() != Serv)
                                {
                                    i++;
                                }
                                //else if (PrivClID != dr["Client_ID"].ToString().Trim()) QM_Count++;
                            }

                            if (rbQuaterly.Checked)
                                QM_type = dr["Q_SEC"].ToString().Trim();
                            else
                                QM_type = dr["M_SEC"].ToString().Trim();

                            Serv = dr["CAMS_CODE"].ToString().Trim();


                            if (i % 2 == 0)
                            {
                                cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s110");
                                if (Rb_MS_Date.Checked)
                                    cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString()), DataType.String, "s110");
                                else
                                    cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString()), DataType.String, "s110");
                                if (rbQuaterly.Checked)
                                    cell = Row0.Cells.Add(dr["Q_SEC"].ToString(), DataType.String, "s110");
                                else
                                    cell = Row0.Cells.Add(dr["M_SEC"].ToString(), DataType.String, "s110");
                                //DataRow[] selrow;
                                //if (rbQuaterly.Checked)
                                //    selrow = dataAudit.Select("Q_SEC='" + dr["Q_SEC"].ToString() + "' AND Client_ID='" + dr["Client_ID"].ToString() + "' AND CAMS_CODE='" + dr["CAMS_CODE"].ToString() + "'");
                                //else
                                //    selrow = dataAudit.Select("M_SEC='" + dr["M_SEC"].ToString() + "' AND Client_ID='" + dr["Client_ID"].ToString() + "' AND CAMS_CODE='" + dr["CAMS_CODE"].ToString() + "'");

                                //if (selrow.Length == 1 || QM_Count == 1)
                                //    cell = Row0.Cells.Add(QM_Count.ToString(), DataType.String, "s111");
                                //else
                                //    cell = Row0.Cells.Add("", DataType.String, "s111");

                                if (dr["Count_Type"].ToString().Trim() == "B" || dr["Count_Type"].ToString().Trim() == "C" || dr["Count_Type"].ToString().Trim() == "D")
                                {
                                    cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s111");
                                    cell = Row0.Cells.Add(dr["TotCnt"].ToString(), DataType.String, "s111");
                                    cell = Row0.Cells.Add("", DataType.String, "s111");
                                    cell = Row0.Cells.Add("", DataType.String, "s111");
                                }
                                else if (dr["Count_Type"].ToString().Trim() == "S" || dr["Count_Type"].ToString().Trim() == "A" || dr["Count_Type"].ToString().Trim() == "E")
                                {
                                    cell = Row0.Cells.Add("", DataType.String, "s111");
                                    cell = Row0.Cells.Add("", DataType.String, "s111");
                                    cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s111");
                                    cell = Row0.Cells.Add(dr["TotCnt"].ToString(), DataType.String, "s111");
                                }
                                else
                                {
                                    cell = Row0.Cells.Add(dr["cnt"].ToString(), DataType.String, "s111");
                                    if (!string.IsNullOrEmpty(dr["TotCnt"].ToString().Trim()))
                                        cell = Row0.Cells.Add(dr["cnt"].ToString(), DataType.String, "s111");
                                    else
                                        cell = Row0.Cells.Add("", DataType.String, "s111");
                                    cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s111");
                                    cell = Row0.Cells.Add(dr["TotCnt"].ToString(), DataType.String, "s111");
                                }

                                cell = Row0.Cells.Add(dr["AppNo"].ToString(), DataType.String, "s110");
                                cell = Row0.Cells.Add(dr["Name"].ToString(), DataType.String, "s110");
                                cell = Row0.Cells.Add(dr["CAMS_WORKER"].ToString(), DataType.String, "s110");
                                cell = Row0.Cells.Add(dr["CAMS_SITE"].ToString(), DataType.String, "s110");

                                //cell = Row0.Cells.Add(dr["Agency"].ToString(), DataType.String, "s105");
                                //cell = Row0.Cells.Add(dr["Dept"].ToString(), DataType.String, "s105");
                                //cell = Row0.Cells.Add(dr["Program"].ToString(), DataType.String, "s105");
                                //cell = Row0.Cells.Add(dr["Prog_Year"].ToString(), DataType.String, "s105");
                                //cell = Row0.Cells.Add(dr["AppNo"].ToString(), DataType.String, "s105");
                                //cell = Row0.Cells.Add(dr["Name"].ToString(), DataType.String, "s105");
                                //cell = Row0.Cells.Add(CAMSType, DataType.String, "s105");
                                //cell = Row0.Cells.Add(dr["CAMS_CODE"].ToString(), DataType.String, "s105");
                                //cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s105");
                                //cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString()), DataType.String, "s105");
                                //cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString()), DataType.String, "s105");
                                //cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s106");



                            }
                            else
                            {
                                cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s112");
                                if (Rb_MS_Date.Checked)
                                    cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString()), DataType.String, "s112");
                                else
                                    cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString()), DataType.String, "s112");
                                if (rbQuaterly.Checked)
                                    cell = Row0.Cells.Add(dr["Q_SEC"].ToString(), DataType.String, "s112");
                                else
                                    cell = Row0.Cells.Add(dr["M_SEC"].ToString(), DataType.String, "s112");
                                //DataRow[] selrow;
                                //if (rbQuaterly.Checked)
                                //    selrow = dataAudit.Select("Q_SEC='" + dr["Q_SEC"].ToString() + "' AND Client_ID='" + dr["Client_ID"].ToString() + "' AND SP='" + dr["SP"].ToString() + "' AND CAMS_CODE='" + dr["CAMS_CODE"].ToString() + "'");
                                //else
                                //    selrow = dataAudit.Select("M_SEC='" + dr["M_SEC"].ToString() + "' AND Client_ID='" + dr["Client_ID"].ToString() + "' AND SP='" + dr["SP"].ToString() + "' AND CAMS_CODE='" + dr["CAMS_CODE"].ToString() + "'");

                                //if (selrow.Length == 1 || QM_Count==1)
                                //    cell = Row0.Cells.Add(QM_Count.ToString(), DataType.String, "s113");
                                //else
                                //    cell = Row0.Cells.Add("", DataType.String, "s113");

                                if (dr["Count_Type"].ToString().Trim() == "B" || dr["Count_Type"].ToString().Trim() == "C" || dr["Count_Type"].ToString().Trim() == "D")
                                {
                                    cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s113");
                                    cell = Row0.Cells.Add(dr["TotCnt"].ToString(), DataType.String, "s113");
                                    cell = Row0.Cells.Add("", DataType.String, "s113");
                                    cell = Row0.Cells.Add("", DataType.String, "s113");
                                }
                                else if (dr["Count_Type"].ToString().Trim() == "S" || dr["Count_Type"].ToString().Trim() == "A" || dr["Count_Type"].ToString().Trim() == "E")
                                {
                                    cell = Row0.Cells.Add("", DataType.String, "s113");
                                    cell = Row0.Cells.Add("", DataType.String, "s113");
                                    cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s113");
                                    cell = Row0.Cells.Add(dr["TotCnt"].ToString(), DataType.String, "s113");
                                }
                                else
                                {
                                    cell = Row0.Cells.Add(dr["cnt"].ToString(), DataType.String, "s113");
                                    if (!string.IsNullOrEmpty(dr["TotCnt"].ToString().Trim()))
                                        cell = Row0.Cells.Add(dr["cnt"].ToString(), DataType.String, "s113");
                                    else
                                        cell = Row0.Cells.Add("", DataType.String, "s113");
                                    cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s113");
                                    cell = Row0.Cells.Add(dr["TotCnt"].ToString(), DataType.String, "s113");
                                }


                                cell = Row0.Cells.Add(dr["AppNo"].ToString(), DataType.String, "s112");
                                cell = Row0.Cells.Add(dr["Name"].ToString(), DataType.String, "s112");
                                cell = Row0.Cells.Add(dr["CAMS_WORKER"].ToString(), DataType.String, "s112");
                                cell = Row0.Cells.Add(dr["CAMS_SITE"].ToString(), DataType.String, "s112");

                                //cell = Row0.Cells.Add(dr["Agency"].ToString(), DataType.String, "s95");
                                //cell = Row0.Cells.Add(dr["Dept"].ToString(), DataType.String, "s95");
                                //cell = Row0.Cells.Add(dr["Program"].ToString(), DataType.String, "s95");
                                //cell = Row0.Cells.Add(dr["Prog_Year"].ToString(), DataType.String, "s95");
                                //cell = Row0.Cells.Add(dr["AppNo"].ToString(), DataType.String, "s95");
                                //cell = Row0.Cells.Add(dr["Name"].ToString(), DataType.String, "s95");
                                //cell = Row0.Cells.Add(CAMSType, DataType.String, "s95");
                                //cell = Row0.Cells.Add(dr["CAMS_CODE"].ToString(), DataType.String, "s95");
                                //cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s95");
                                //cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString()), DataType.String, "s95");
                                //cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString()), DataType.String, "s95");
                                //cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s95RC");


                            }
                            PrivClID = dr["Client_ID"].ToString().Trim();
                            PrvCnt = QM_Count;
                        }
                    }


                }



            }


            FileStream stream = new FileStream(PdfName, FileMode.Create);

            book.Save(stream);
            stream.Close();

            AlertBox.Show(PdfFileName + "_Audit.xls file Generated Successfully");

            ////FileDownloadGateway downloadGateway = new FileDownloadGateway();
            ////downloadGateway.Filename = "SPREPAPP_Report.xls";

            ////// downloadGateway.Version = file.Version;

            ////downloadGateway.SetContentType(DownloadContentType.OctetStream);

            ////downloadGateway.StartFileDownload(new ContainerControl(), PdfName);

            //FileInfo fiDownload = new FileInfo(PdfName);
            ///// Need to check for file exists, is local file, is allow to read, etc...
            //string name = fiDownload.Name;
            //using (FileStream fileStream = fiDownload.OpenRead())
            //{
            //    Application.Download(fileStream, name);
            //}

            //}

        }



        //private void GenerateStyles1(WorksheetStyleCollection styles)
        //{
        //    // -----------------------------------------------
        //    //  Default
        //    // -----------------------------------------------
        //    WorksheetStyle Default = styles.Add("Default");
        //    Default.Name = "Normal";
        //    Default.Font.FontName = "Arial";
        //    Default.Alignment.Vertical = StyleVerticalAlignment.Bottom;
        //    // -----------------------------------------------
        //    //  s62
        //    // -----------------------------------------------
        //    WorksheetStyle s62 = styles.Add("s62");
        //    s62.Alignment.Horizontal = StyleHorizontalAlignment.Center;
        //    s62.Alignment.Vertical = StyleVerticalAlignment.Bottom;
        //    // -----------------------------------------------
        //    //  s63
        //    // -----------------------------------------------
        //    WorksheetStyle s63 = styles.Add("s63");
        //    s63.Font.Bold = true;
        //    s63.Font.FontName = "Calibri Light";
        //    s63.Font.Size = 16;
        //    s63.Interior.Color = "#DEEBF6";
        //    s63.Interior.Pattern = StyleInteriorPattern.Solid;
        //    s63.Alignment.Horizontal = StyleHorizontalAlignment.Left;
        //    s63.Alignment.Vertical = StyleVerticalAlignment.Center;
        //    // -----------------------------------------------
        //    //  s64
        //    // -----------------------------------------------
        //    WorksheetStyle s64 = styles.Add("s64");
        //    s64.Font.Bold = true;
        //    s64.Font.FontName = "Calibri Light";
        //    s64.Font.Size = 16;
        //    s64.Interior.Color = "#DEEBF6";
        //    s64.Interior.Pattern = StyleInteriorPattern.Solid;
        //    s64.Alignment.Horizontal = StyleHorizontalAlignment.Center;
        //    s64.Alignment.Vertical = StyleVerticalAlignment.Center;
        //    // -----------------------------------------------
        //    //  s65
        //    // -----------------------------------------------
        //    WorksheetStyle s65 = styles.Add("s65");
        //    s65.Interior.Color = "#DEEBF6";
        //    s65.Interior.Pattern = StyleInteriorPattern.Solid;
        //    s65.Alignment.Horizontal = StyleHorizontalAlignment.Center;
        //    s65.Alignment.Vertical = StyleVerticalAlignment.Bottom;
        //    // -----------------------------------------------
        //    //  s66
        //    // -----------------------------------------------
        //    WorksheetStyle s66 = styles.Add("s66");
        //    s66.Interior.Color = "#DEEBF6";
        //    s66.Interior.Pattern = StyleInteriorPattern.Solid;
        //    // -----------------------------------------------
        //    //  s67
        //    // -----------------------------------------------
        //    WorksheetStyle s67 = styles.Add("s67");
        //    s67.Interior.Color = "#DEEBF6";
        //    s67.Interior.Pattern = StyleInteriorPattern.Solid;
        //    s67.Alignment.Horizontal = StyleHorizontalAlignment.Center;
        //    s67.Alignment.Vertical = StyleVerticalAlignment.Center;
        //    // -----------------------------------------------
        //    //  s68
        //    // -----------------------------------------------
        //    WorksheetStyle s68 = styles.Add("s68");
        //    s68.Font.Bold = true;
        //    s68.Font.FontName = "Calibri";
        //    s68.Font.Size = 11;
        //    s68.Font.Color = "#000000";
        //    s68.Interior.Color = "#FBE4D5";
        //    s68.Interior.Pattern = StyleInteriorPattern.Solid;
        //    s68.Alignment.Horizontal = StyleHorizontalAlignment.Center;
        //    s68.Alignment.Vertical = StyleVerticalAlignment.Center;
        //    s68.Alignment.WrapText = true;
        //    s68.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
        //    s68.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#000000");
        //    s68.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
        //    s68.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
        //    // -----------------------------------------------
        //    //  s69
        //    // -----------------------------------------------
        //    WorksheetStyle s69 = styles.Add("s69");
        //    s69.Font.Bold = true;
        //    s69.Font.FontName = "Calibri";
        //    s69.Font.Size = 11;
        //    s69.Font.Color = "#000000";
        //    s69.Interior.Color = "#FBE4D5";
        //    s69.Interior.Pattern = StyleInteriorPattern.Solid;
        //    s69.Alignment.Horizontal = StyleHorizontalAlignment.Left;
        //    s69.Alignment.Vertical = StyleVerticalAlignment.Center;
        //    s69.Alignment.WrapText = true;
        //    s69.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
        //    s69.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#000000");
        //    s69.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
        //    s69.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
        //    // -----------------------------------------------
        //    //  s70
        //    // -----------------------------------------------
        //    WorksheetStyle s70 = styles.Add("s70");
        //    s70.Font.Bold = true;
        //    s70.Font.FontName = "Calibri";
        //    s70.Font.Size = 11;
        //    s70.Font.Color = "#000000";
        //    s70.Interior.Color = "#FBE4D5";
        //    s70.Interior.Pattern = StyleInteriorPattern.Solid;
        //    s70.Alignment.Horizontal = StyleHorizontalAlignment.Left;
        //    s70.Alignment.Vertical = StyleVerticalAlignment.Center;
        //    s70.Alignment.WrapText = true;
        //    s70.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
        //    s70.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#000000");
        //    s70.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#000000");
        //    s70.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
        //    // -----------------------------------------------
        //    //  s71
        //    // -----------------------------------------------
        //    WorksheetStyle s71 = styles.Add("s71");
        //    s71.Font.Bold = true;
        //    s71.Font.FontName = "Calibri";
        //    s71.Font.Size = 11;
        //    s71.Font.Color = "#000000";
        //    s71.Interior.Color = "#FBE4D5";
        //    s71.Interior.Pattern = StyleInteriorPattern.Solid;
        //    s71.Alignment.Horizontal = StyleHorizontalAlignment.Left;
        //    s71.Alignment.Vertical = StyleVerticalAlignment.Center;
        //    s71.Alignment.WrapText = true;
        //    s71.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
        //    s71.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
        //    s71.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
        //    s71.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
        //    s71.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
        //    // -----------------------------------------------
        //    //  s72
        //    // -----------------------------------------------
        //    WorksheetStyle s72 = styles.Add("s72");
        //    s72.Font.Bold = true;
        //    s72.Font.FontName = "Calibri";
        //    s72.Font.Size = 11;
        //    s72.Font.Color = "#000000";
        //    s72.Interior.Color = "#FBE4D5";
        //    s72.Interior.Pattern = StyleInteriorPattern.Solid;
        //    s72.Alignment.Horizontal = StyleHorizontalAlignment.Center;
        //    s72.Alignment.Vertical = StyleVerticalAlignment.Center;
        //    s72.Alignment.WrapText = true;
        //    s72.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
        //    s72.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
        //    s72.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
        //    s72.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
        //    s72.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
        //    // -----------------------------------------------
        //    //  s73
        //    // -----------------------------------------------
        //    WorksheetStyle s73 = styles.Add("s73");
        //    s73.Alignment.Horizontal = StyleHorizontalAlignment.Center;
        //    s73.Alignment.Vertical = StyleVerticalAlignment.Center;
        //    s73.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
        //    s73.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
        //    s73.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
        //    s73.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
        //    // -----------------------------------------------
        //    //  s74
        //    // -----------------------------------------------
        //    WorksheetStyle s74 = styles.Add("s74");
        //    s74.Font.FontName = "Arial";
        //    s74.Font.Color = "#000000";
        //    s74.Interior.Color = "#FFFFFF";
        //    s74.Interior.Pattern = StyleInteriorPattern.Solid;
        //    s74.Alignment.Horizontal = StyleHorizontalAlignment.Left;
        //    s74.Alignment.Vertical = StyleVerticalAlignment.Center;
        //    s74.Alignment.WrapText = true;
        //    s74.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
        //    s74.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
        //    s74.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
        //    s74.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
        //    s74.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
        //    // -----------------------------------------------
        //    //  s75
        //    // -----------------------------------------------
        //    WorksheetStyle s75 = styles.Add("s75");
        //    s75.Alignment.Horizontal = StyleHorizontalAlignment.Center;
        //    s75.Alignment.Vertical = StyleVerticalAlignment.Bottom;
        //    s75.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
        //    s75.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
        //    s75.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
        //    s75.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
        //    // -----------------------------------------------
        //    //  s76
        //    // -----------------------------------------------
        //    WorksheetStyle s76 = styles.Add("s76");
        //    s76.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
        //    s76.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
        //    s76.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
        //    s76.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
        //}


        //private void On_SaveExcelAuditLatest_Closed(string PdfFileName)
        //{
        //    Random_Filename = null;
        //    string PdfName = "Pdf File";
        //    PdfName = propReportPath + BaseForm.UserID + "\\" + PdfFileName + "_Audit";
        //    try
        //    {
        //        if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
        //        { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
        //    }
        //    catch (Exception ex)
        //    {
        //        CommonFunctions.MessageBoxDisplay("Error");
        //    }

        //    try
        //    {
        //        string Tmpstr = PdfName + ".xls";
        //        if (File.Exists(Tmpstr))
        //            File.Delete(Tmpstr);
        //    }
        //    catch (Exception ex)
        //    {
        //        int length = 8;
        //        string newFileName = System.Guid.NewGuid().ToString();
        //        newFileName = newFileName.Replace("-", string.Empty);

        //        Random_Filename = PdfName + newFileName.Substring(0, length) + ".xls";
        //    }

        //    if (!string.IsNullOrEmpty(Random_Filename))
        //        PdfName = Random_Filename;
        //    else
        //        PdfName += ".xls";



        //    Workbook book = new Workbook();

        //    this.GenerateStyles1(book.Styles);



        //    bool First = true; string MS_Type = string.Empty;
        //    string CAMSDesc = null; string Branch = null, Priv_Branch = null, SP_Plan_desc = null;
        //    bool SPNum = true; Worksheet sheet; WorksheetCell cell; WorksheetRow Row0; int Count = 1;


        //    if (dtAudit.Rows.Count > 0)
        //    {
        //        this.GenerateWorksheetParameters(book.Worksheets);

        //        string PrivSP = string.Empty;

        //        var distinctRows = (from DataRow dRow in dtAudit.Rows
        //                            select dRow["SP"]).Distinct();

        //        foreach (var dRow in distinctRows)
        //        {
        //            DataTable dataTable = new DataTable();
        //            DataView dv = new DataView(dtAudit);
        //            dv.RowFilter = "SP='" + dRow + "'";
        //            dataTable = dv.ToTable();

        //            if (dataTable.Rows.Count > 0)
        //            {
        //                string ReportName = dataTable.Rows[0]["SP_Desc"].ToString();
        //                ReportName = ReportName.Replace("/", "");

        //                if (ReportName.Length >= 31)
        //                {
        //                    ReportName = ReportName.Substring(0, 31);
        //                }
        //                sheet = book.Worksheets.Add(ReportName);
        //                sheet.Table.DefaultRowHeight = 14.25F;


        //                sheet.Table.Columns.Add(75);
        //                sheet.Table.Columns.Add(75);
        //                sheet.Table.Columns.Add(75);
        //                sheet.Table.Columns.Add(75);
        //                sheet.Table.Columns.Add(80);
        //                sheet.Table.Columns.Add(145);
        //                sheet.Table.Columns.Add(75);
        //                sheet.Table.Columns.Add(80);
        //                sheet.Table.Columns.Add(180);
        //                sheet.Table.Columns.Add(80);
        //                sheet.Table.Columns.Add(80);
        //                sheet.Table.Columns.Add(80);

        //                Row0 = sheet.Table.Rows.Add();
        //                Row0.AutoFitHeight = false;
        //                //WorksheetCell cell;
        //                cell = Row0.Cells.Add();
        //                cell.StyleID = "s63";
        //                cell.Data.Type = DataType.String;
        //                cell.Data.Text = dataTable.Rows[0]["SP_Desc"].ToString();
        //                cell.MergeAcross = 9;

        //                Row0 = sheet.Table.Rows.Add();
        //                cell = Row0.Cells.Add();
        //                cell.StyleID = "s63";
        //                cell.Data.Type = DataType.String;
        //                cell.Data.Text = dataTable.Rows[0]["CAMS_BRANCH_DESC"].ToString();
        //                cell.MergeAcross = 9;

        //                //Row0 = sheet.Table.Rows.Add();

        //                //cell = Row0.Cells.Add("Agency", DataType.String, "s94");
        //                //cell = Row0.Cells.Add("Dept", DataType.String, "s94");
        //                //cell = Row0.Cells.Add("Program", DataType.String, "s94");
        //                //cell = Row0.Cells.Add("Year", DataType.String, "s94");
        //                //cell = Row0.Cells.Add("App", DataType.String, "s94");
        //                //cell = Row0.Cells.Add("Name", DataType.String, "s94");
        //                //cell = Row0.Cells.Add("Type", DataType.String, "s94");
        //                //cell = Row0.Cells.Add("Code", DataType.String, "s94");
        //                //cell = Row0.Cells.Add("Description", DataType.String, "s94");
        //                //cell = Row0.Cells.Add("Date", DataType.String, "s94");
        //                //cell = Row0.Cells.Add("Date Added", DataType.String, "s94");
        //                //cell = Row0.Cells.Add("Amount", DataType.String, "s94");

        //                if(dtdistinct.Rows.Count>0)
        //                {
        //                    foreach(DataRow drd in dtdistinct.Rows)
        //                    {
        //                        DataTable dtselect = new DataTable();
        //                        DataView dv1 = new DataView(dataTable);
        //                        dv1.RowFilter = "CAMS_CODE='" + drd["CAMS_CODE"].ToString() + "' AND AppNo='" + drd["AppNo"].ToString()+"'";
        //                        dtselect = dv.ToTable();

        //                        int i = 0;
        //                        string PrivBranch = string.Empty; string PrivService = string.Empty, PrivApp = string.Empty;
        //                        bool Q1 = false, Q2 = false, Q3 = false, Q4 = false;

        //                        foreach (DataRow dr in dtselect.Rows)
        //                        {
        //                            Row0 = sheet.Table.Rows.Add();
        //                            if (PrivBranch != dr["CAMS_BRANCH"].ToString())
        //                            {
        //                                cell = Row0.Cells.Add();
        //                                cell.StyleID = "s63";
        //                                cell.Data.Type = DataType.String;
        //                                cell.Data.Text = dataTable.Rows[0]["CAMS_BRANCH_DESC"].ToString();
        //                                cell.MergeAcross = 9;

        //                                Row0 = sheet.Table.Rows.Add();
        //                            }

        //                            if (PrivService != dr["CAMS_CODE"].ToString())
        //                            {
        //                                cell = Row0.Cells.Add();
        //                                cell.StyleID = "s63";
        //                                cell.Data.Type = DataType.String;
        //                                cell.Data.Text = dataTable.Rows[0]["CAMS_DESC"].ToString();
        //                                cell.MergeAcross = 9;

        //                                Row0 = sheet.Table.Rows.Add();
        //                                if (rbQuaterly.Checked)
        //                                {
        //                                    cell = Row0.Cells.Add("App No", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("Name", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("Case Worker", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("Q1 - Date", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("Q2 - Date", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("Q3 - Date", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("Q4 - Date", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("Site", DataType.String, "s68");
        //                                }
        //                                else
        //                                {
        //                                    cell = Row0.Cells.Add("App No", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("Name", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("Case Worker", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("M1 - Date", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("M2 - Date", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("M3 - Date", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("M4 - Date", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("M5 - Date", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("M6 - Date", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("M7 - Date", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("M8 - Date", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("M9 - Date", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("M10 - Date", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("M11 - Date", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("M12 - Date", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("", DataType.String, "s68");
        //                                    cell = Row0.Cells.Add("Site", DataType.String, "s68");
        //                                }
        //                                Row0 = sheet.Table.Rows.Add();
        //                            }

        //                            if (rbQuaterly.Checked)
        //                            {
        //                                cell = Row0.Cells.Add(dr["AppNo"].ToString(), DataType.String, "s74");
        //                                cell = Row0.Cells.Add(dr["Name"].ToString(), DataType.String, "s74");
        //                                cell = Row0.Cells.Add(dr["CAMS_WORKER"].ToString(), DataType.String, "s74");

        //                                if ((dtpQ1S.Value <= Convert.ToDateTime(dr["CAMS_DATE"].ToString()).Date && dtpQ1E.Value >= Convert.ToDateTime(dr["CAMS_DATE"].ToString()).Date))
        //                                {

        //                                }

        //                            }


        //                        }

        //                    }
        //                }




        //                //foreach (DataRow dr in dataTable.Rows)
        //                //{
        //                //    Row0 = sheet.Table.Rows.Add();

        //                //    if (PrivBranch != dr["CAMS_BRANCH"].ToString())
        //                //    {
        //                //        cell = Row0.Cells.Add();
        //                //        cell.StyleID = "s63";
        //                //        cell.Data.Type = DataType.String;
        //                //        cell.Data.Text = dataTable.Rows[0]["CAMS_BRANCH_DESC"].ToString();
        //                //        cell.MergeAcross = 9;

        //                //        Row0 = sheet.Table.Rows.Add();
        //                //    }
        //                //    if (PrivService != dr["CAMS_CODE"].ToString())
        //                //    {
        //                //        cell = Row0.Cells.Add();
        //                //        cell.StyleID = "s63";
        //                //        cell.Data.Type = DataType.String;
        //                //        cell.Data.Text = dataTable.Rows[0]["CAMS_DESC"].ToString();
        //                //        cell.MergeAcross = 9;

        //                //        Row0 = sheet.Table.Rows.Add();
        //                //        if (rbQuaterly.Checked)
        //                //        {
        //                //            cell = Row0.Cells.Add("App No", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("Name", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("Case Worker", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("Q1 - Date", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("Q2 - Date", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("Q3 - Date", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("Q4 - Date", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("Site", DataType.String, "s68");
        //                //        }
        //                //        else
        //                //        {
        //                //            cell = Row0.Cells.Add("App No", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("Name", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("Case Worker", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("M1 - Date", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("M2 - Date", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("M3 - Date", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("M4 - Date", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("M5 - Date", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("M6 - Date", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("M7 - Date", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("M8 - Date", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("M9 - Date", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("M10 - Date", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("M11 - Date", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("M12 - Date", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("", DataType.String, "s68");
        //                //            cell = Row0.Cells.Add("Site", DataType.String, "s68");
        //                //        }
        //                //        Row0 = sheet.Table.Rows.Add();
        //                //    }


        //                //    //cell = Row0.Cells.Add(dr["CAMS_CODE"].ToString(), DataType.String, "s68");
        //                //    //cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s68");
        //                //    //cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString()), DataType.String, "s68");
        //                //    //cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString()), DataType.String, "s68");
        //                //    //cell = Row0.Cells.Add("Amount", DataType.String, "s68");

        //                //    if(PrivApp!= dr["AppNo"].ToString())
        //                //    { Q1 = false;Q2 = false;Q3 = false;Q4 = false; }

        //                //    if (rbQuaterly.Checked)
        //                //    {
        //                //        cell = Row0.Cells.Add(dr["AppNo"].ToString(), DataType.String, "s74");
        //                //        cell = Row0.Cells.Add(dr["Name"].ToString(), DataType.String, "s74");
        //                //        cell = Row0.Cells.Add(dr["CAMS_WORKER"].ToString(), DataType.String, "s74");

        //                //        if ((dtpQ1S.Value <= Convert.ToDateTime(dr["CAMS_DATE"].ToString()).Date && dtpQ1E.Value >= Convert.ToDateTime(dr["CAMS_DATE"].ToString()).Date))
        //                //        {

        //                //        }


        //                //    }


        //                //    string CAMSType = string.Empty;
        //                //    if (dr["SP2_TYPE"].ToString().Trim() == "CA") CAMSType = "Service"; else CAMSType = "Outcome";



        //                //    if (i % 2 == 0)
        //                //    {
        //                //        cell = Row0.Cells.Add(dr["Agency"].ToString(), DataType.String, "s105");
        //                //        cell = Row0.Cells.Add(dr["Dept"].ToString(), DataType.String, "s105");
        //                //        cell = Row0.Cells.Add(dr["Program"].ToString(), DataType.String, "s105");
        //                //        cell = Row0.Cells.Add(dr["Prog_Year"].ToString(), DataType.String, "s105");
        //                //        cell = Row0.Cells.Add(dr["AppNo"].ToString(), DataType.String, "s105");
        //                //        cell = Row0.Cells.Add(dr["Name"].ToString(), DataType.String, "s105");
        //                //        cell = Row0.Cells.Add(CAMSType, DataType.String, "s105");
        //                //        cell = Row0.Cells.Add(dr["CAMS_CODE"].ToString(), DataType.String, "s105");
        //                //        cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s105");
        //                //        cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString()), DataType.String, "s105");
        //                //        cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString()), DataType.String, "s105");
        //                //        cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s106");



        //                //    }
        //                //    else
        //                //    {

        //                //        cell = Row0.Cells.Add(dr["Agency"].ToString(), DataType.String, "s95");
        //                //        cell = Row0.Cells.Add(dr["Dept"].ToString(), DataType.String, "s95");
        //                //        cell = Row0.Cells.Add(dr["Program"].ToString(), DataType.String, "s95");
        //                //        cell = Row0.Cells.Add(dr["Prog_Year"].ToString(), DataType.String, "s95");
        //                //        cell = Row0.Cells.Add(dr["AppNo"].ToString(), DataType.String, "s95");
        //                //        cell = Row0.Cells.Add(dr["Name"].ToString(), DataType.String, "s95");
        //                //        cell = Row0.Cells.Add(CAMSType, DataType.String, "s95");
        //                //        cell = Row0.Cells.Add(dr["CAMS_CODE"].ToString(), DataType.String, "s95");
        //                //        cell = Row0.Cells.Add(dr["CAMS_DESC"].ToString(), DataType.String, "s95");
        //                //        cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE"].ToString()), DataType.String, "s95");
        //                //        cell = Row0.Cells.Add(LookupDataAccess.Getdate(dr["CAMS_DATE_ADD"].ToString()), DataType.String, "s95");
        //                //        cell = Row0.Cells.Add(dr["CASEMS_COST"].ToString(), DataType.String, "s95RC");


        //                //    }




        //                //    //if (dr["SP0_SERVICECODE"].ToString() != PrivSP)
        //                //    //{



        //                //    //    PrivSP = dr["SP0_SERVICECODE"].ToString();
        //                //    //}


        //                //    i++;
        //                //}
        //            }


        //        }



        //    }


        //    FileStream stream = new FileStream(PdfName, FileMode.Create);

        //    book.Save(stream);
        //    stream.Close();

        //    AlertBox.Show(PdfFileName + "_Audit.xls file Generated Successfully");

        //    ////FileDownloadGateway downloadGateway = new FileDownloadGateway();
        //    ////downloadGateway.Filename = "SPREPAPP_Report.xls";

        //    ////// downloadGateway.Version = file.Version;

        //    ////downloadGateway.SetContentType(DownloadContentType.OctetStream);

        //    ////downloadGateway.StartFileDownload(new ContainerControl(), PdfName);

        //    //FileInfo fiDownload = new FileInfo(PdfName);
        //    ///// Need to check for file exists, is local file, is allow to read, etc...
        //    //string name = fiDownload.Name;
        //    //using (FileStream fileStream = fiDownload.OpenRead())
        //    //{
        //    //    Application.Download(fileStream, name);
        //    //}

        //    //}

        //}


        public int GetMonthsBetween(DateTime from, DateTime to)
        {
            if (from > to) return GetMonthsBetween(to, from);

            var monthDiff = Math.Abs((to.Year * 12 + (to.Month - 1)) - (from.Year * 12 + (from.Month - 1)));

            if (from.AddMonths(monthDiff) > to || to.Day < from.Day)
            {
                return monthDiff - 1;
            }
            else
            {
                return monthDiff;
            }
        }

        public Color Department_Back_Color(DataTable dt, DataTable dtHie_Color)
        {
            System.Drawing.Color back_color = CommonFunctions.Get_Dept_Back_Color(dt.Rows[0]["Hierarchy"].ToString().Substring(2, 2));
            if (dt.Rows[0]["Hierarchy"].ToString().Substring(2, 2) == "**")
                dtHie_Color.Rows.Add(dt.Rows[0]["Hierarchy"].ToString(), dt.Rows[0]["Hierarchy"].ToString().Substring(2, 2), "", back_color);
            string strYear = string.Empty;
            if (CmbYear.Visible == true)
            {
                strYear = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString();
            }
            List<HierarchyEntity> hierachyEntity = _model.HierarchyAndPrograms.GetCaseHierarchyDepartment(dt.Rows[0]["Hierarchy"].ToString().Substring(0, 2), dt.Rows[0]["Hierarchy"].ToString().Substring(2, 2), dt.Rows[0]["Hierarchy"].ToString().Substring(4, 2), strYear, BaseForm.BaseApplicationNo, "DEPT");

            if (hierachyEntity.Count > 0)
            {
                foreach (HierarchyEntity HieEntity in hierachyEntity)
                {
                    if (!string.IsNullOrEmpty(HieEntity.Dept))
                    {
                        if (dt.Rows[0]["Hierarchy"].ToString().Substring(2, 2) == HieEntity.Dept && HieEntity.Prog == string.Empty)
                        {
                            back_color = CommonFunctions.Get_Dept_Back_Color(dt.Rows[0]["Hierarchy"].ToString().Substring(2, 2));
                            dtHie_Color.Rows.Add(dt.Rows[0]["Hierarchy"].ToString(), dt.Rows[0]["Hierarchy"].ToString().Substring(2, 2), HieEntity.HirarchyName, back_color);
                        }
                    }
                }
            }
            return back_color;
        }

        //Added by Vikash on 02/03/2025 as per Suffolk document
        private void rdbOCC_All_Click(object sender, EventArgs e)
        {
            ListcommonEntity_Results.Clear();

            _errorProvider.SetError(rdbOCC_Sel, null);
        }

        private void rdbOCC_Sel_Click(object sender, EventArgs e)
        {
            DataSet dsResults = Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.RESULTS);

            DataTable dtResults = dsResults.Tables[0];

            if (dtResults.Rows.Count > 0)
            {
                SelectZipSiteCountyForm countyform = new SelectZipSiteCountyForm(BaseForm, ListcommonEntity_Results, "Results");
                countyform.FormClosed += new FormClosedEventHandler(Results_Form_Closed);
                countyform.StartPosition = FormStartPosition.CenterScreen;
                countyform.ShowDialog();
            }
        }
        string results_code = string.Empty;
        private void Results_Form_Closed(object sender, FormClosedEventArgs e)
        {
            SelectZipSiteCountyForm form = sender as SelectZipSiteCountyForm;

            if (form.DialogResult == DialogResult.OK)
            {
                ListcommonEntity_Results = form.SelectedResultsEntity;
                results_code = string.Empty;
                foreach (CommonEntity entity in ListcommonEntity_Results)
                {
                    results_code = results_code + entity.Code + ",";
                }
                results_code = results_code.Trim().TrimEnd(',');
            }
        }

        private string Get_Sel_Results()
        {
            string Sel_Result_Codes = null;
            foreach (CommonEntity Entity in ListcommonEntity_Results)
            {
                Sel_Result_Codes += Entity.Code + ",";
            }

            if (Sel_Result_Codes.Length > 0)
                Sel_Result_Codes = Sel_Result_Codes.Substring(0, (Sel_Result_Codes.Length - 1));

            return Sel_Result_Codes;
        }

        private void Fill_Results_Selected_List(string Results_Str)
        {
            foreach (CommonEntity Ent in Results_List)
            {
                if (Results_Str.Contains(Ent.Code))
                    ListcommonEntity_Results.Add(new CommonEntity(Ent));
            }
        }
    }
}

/* Random Color Generator Code
List<lstColors> chkDeptColor = DeptBackColor.Where(x => x.Dept_Code.ToString() == dt.Rows[0]["Hierarchy"].ToString().Substring(2, 2)).ToList();
if (chkDeptColor.Count == 0)
{
    string _color = CommonFunctions.generateColor();
    back_color = System.Drawing.ColorTranslator.FromHtml(_color);
    DeptBackColor.Add(new lstColors { Dept_Code = dt.Rows[0]["Hierarchy"].ToString().Substring(2, 2), color = _color });
}
else
{
    back_color = System.Drawing.ColorTranslator.FromHtml(chkDeptColor[0].color);
}
public class lstColors
{
    public string Dept_Code
    {
        get;
        set;
    }

    public string color
    {
        get;
        set;
    }
}
 
 
 */