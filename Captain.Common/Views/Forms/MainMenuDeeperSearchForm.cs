#region Using

using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Collections;

using System.Web.Configuration;
using Captain.Common.Views.Forms.Base;
using Captain.Common.Utilities;
using Captain.Common.Menus;
using System.Data.SqlClient;
using Captain.Common.Model.Data;
using Captain.Common.Model.Objects;

using Captain.Common.Views.UserControls.Base;
using Captain.Common.Exceptions;
using System.Diagnostics;
using Captain.Common.Views.Forms;
using System.IO;
using System.Linq;

using iTextSharp;
using iTextSharp.text;
using iTextSharp.text.pdf;
using iTextSharp.text.html.simpleparser;
using System.Text.RegularExpressions;
using Wisej.Web;
using DevExpress.DashboardWin.Design;
using DevExpress.XtraCharts.Native;
using static Amazon.S3.Util.S3EventNotification;

#endregion

namespace Captain.Common.Views.Forms
{
    public partial class MMDeeperSearchForm : Form
    {
        #region private variables

        private ErrorProvider _errorProvider = null;
        //private GridControl _intakeHierarchy = null;
        private bool boolChangeStatus = false;
        private CaptainModel _model = null;
        private List<HierarchyEntity> _selectedHierarchies = null;

        #endregion

        public MMDeeperSearchForm(BaseForm baseform)
        {
            InitializeComponent();
            _model = new CaptainModel();

            BaseForm = baseform;

            this.Text = "Client Inquiry";
            propAgencyControlDetails = _model.ZipCodeAndAgency.GetAgencyControlFile("00");
            propReportPath = _model.lookupDataAccess.GetReportPath();
            propRelation = _model.lookupDataAccess.GetRelationship();
            ProgramDefinitionEntity programEntity = _model.HierarchyAndPrograms.GetCaseDepadp(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg);
            if (programEntity != null)
            {
                programDefinitionList = programEntity;
            }
            Lbl_Recent_Lstc_Date.Text = "";
            //Lbl_BaseApp.Text = "in " + BaseForm.BaseAgency + "-" + BaseForm.BaseDept + "-" + BaseForm.BaseProg + " " + BaseForm.BaseYear + " " + BaseForm.BaseApplicationNo;
            string Recent_Lstc_Date = CommonFunctions.ChangeDateFormat(Convert.ToDateTime(BaseForm.BaseCaseMstListEntity[0].DateLstc1).ToShortDateString(), Consts.DateTimeFormats.DateSaveFormat, Consts.DateTimeFormats.DateDisplayFormat);
            //Lbl_Recent_Lstc_Date.Text +=  " " + Recent_Lstc_Date ;
            MaskedTextBox mskphn = new MaskedTextBox();
            mskphn.Mask = "(000)000-0000";
            mskphn.Text = BaseForm.BaseCaseMstListEntity[0].Area.Trim().Trim() + BaseForm.BaseCaseMstListEntity[0].Phone.Trim().Trim();
            MaskedTextBox mskCellphn = new MaskedTextBox(); mskCellphn.Mask = "(000)000-0000";
            mskCellphn.Text = BaseForm.BaseCaseMstListEntity[0].CellPhone.Trim().Trim();
            string Phone = string.Empty, CellPhone = string.Empty, Suffix = string.Empty;
            string Email = BaseForm.BaseCaseMstListEntity[0].Email.Trim() == string.Empty ? " " : " Email: " + BaseForm.BaseCaseMstListEntity[0].Email.Trim();
            if (!string.IsNullOrEmpty(BaseForm.BaseCaseMstListEntity[0].Phone.Trim())) Phone = "Phone # " + mskphn.Text.Trim();
            if (!string.IsNullOrEmpty(BaseForm.BaseCaseMstListEntity[0].CellPhone.Trim())) CellPhone = " Cell # " + mskCellphn.Text.Trim();
            // Murali added address suffix field on 04/10/2021
            if (!string.IsNullOrEmpty(BaseForm.BaseCaseMstListEntity[0].Suffix.Trim())) Suffix = " " + BaseForm.BaseCaseMstListEntity[0].Suffix.Trim();

            Lbl_Add1.Text = BaseForm.BaseCaseMstListEntity[0].Hn + " " + BaseForm.BaseCaseMstListEntity[0].Street + Suffix + ". Apt " + BaseForm.BaseCaseMstListEntity[0].Apt;
            Lbl_Add2.Text = BaseForm.BaseCaseMstListEntity[0].City + ", " + BaseForm.BaseCaseMstListEntity[0].State + ". " + BaseForm.BaseCaseMstListEntity[0].Zip;
            lblPhone.Text = Phone + CellPhone + Email;
            caseHierarchy = _model.lookupDataAccess.GetHierarchyByUserID(BaseForm.UserProfile.UserID, "I", "Reports");
            userPrivilege = _model.UserProfileAccess.GetScreensByUserID(BaseForm.BusinessModuleID, BaseForm.UserID, BaseForm.BaseAgency + BaseForm.BaseDept + BaseForm.BaseProg);
            Fill_Sel_Hierarchy_SPs();

            Get_Vendor_List();

            PPC_List = _model.SPAdminData.Get_AgyRecs_With_Ext("00201", "6", "2", null, null);
            ProgramDefinitionEntity programEntity1 = _model.HierarchyAndPrograms.GetCaseDepadp(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg);
            if (programEntity1 != null)
                CategoryCode = programEntity1.DepSerpostPAYCAT.Trim();

            if (string.IsNullOrEmpty(CategoryCode.Trim()))
            {

                if (PPC_List.Count > 0)
                {
                    PPC_List = PPC_List.FindAll(u => u.Ext_1 != "");
                    if (PPC_List.Count > 0)
                    {
                        foreach (Agy_Ext_Entity Entity in PPC_List)
                        {
                            if (!string.IsNullOrEmpty(Entity.Ext_1.Trim()))
                            {
                                if (BaseForm.BaseAgency == Entity.Ext_1.Substring(0, 2))
                                {
                                    CategoryCode = Entity.Ext_2.Trim();
                                }
                            }
                        }
                    }

                }


            }
            string HIE = BaseForm.BaseAgency + BaseForm.BaseDept + BaseForm.BaseProg;

            if (string.IsNullOrEmpty(CategoryCode.Trim()))
                CntlCAEntity = _model.FieldControls.GetFLDCNTLHIE("CASE0063", HIE, "FLDCNTL");
            else if (CategoryCode == "03")
                CntlCAEntity = _model.FieldControls.GetFLDCNTLHIE("PAYCAT" + CategoryCode.Trim(), HIE, "FLDCNTL");
            else
                CntlCAEntity = _model.FieldControls.GetFLDCNTLHIE("CASE0063", HIE, "FLDCNTL");

            commonReasonlist = CommonFunctions.AgyTabsFilterOrderbyCode(BaseForm.BaseAgyTabsEntity, "S0133", BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, string.Empty);



            DataSet dsSource = Captain.DatabaseLayer.Lookups.GetLookUpFromAGYTAB("08004");
            if (dsSource.Tables.Count > 0)
                dtSource = dsSource.Tables[0];

            DataSet ds = Captain.DatabaseLayer.CaseMst.GetSiteByHIE(BaseForm.BaseAgency, string.Empty, string.Empty);
            if (ds.Tables.Count > 0)
            {
                DataTable dt = ds.Tables[0];
                dtSite = ds.Tables[0];   // Added by Vikash to get the Site name to the report on 02/21/2023

            }

            DataSet ds2 = Captain.DatabaseLayer.AgyTab.GetHierarchyNames(BaseForm.BaseAgency, "**", "**");
            string strNameFormat = null, strCwFormat = null;
            if (ds2.Tables[0].Rows.Count > 0)
            {
                strNameFormat = ds2.Tables[0].Rows[0]["HIE_CN_FORMAT"].ToString();
                strCwFormat = ds2.Tables[0].Rows[0]["HIE_CW_FORMAT"].ToString();
            }
            DataSet ds1 = Captain.DatabaseLayer.CaseMst.GetCaseWorker(strCwFormat, BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg);
            if (ds1.Tables.Count > 0)
            {
                DataTable dt1 = ds1.Tables[0];
                dtWorker = ds1.Tables[0];   // Added by sudheer to get the caseworker name to the report on 02/21/2023
            }


            fillSnpDetails(true);
            //Fill_Other_prog_Grid();

        }

        string CategoryCode = string.Empty;
        List<Agy_Ext_Entity> PPC_List = new List<Agy_Ext_Entity>();
        public List<FldcntlHieEntity> CntlCAEntity { get; set; }
        public MMDeeperSearchForm()
        {
            InitializeComponent();
        }


        #region properties

        public BaseForm BaseForm { get; set; }
        public PrivilegeEntity Privileges { get; set; }

        public string Agency { get; set; }

        public string Dept { get; set; }


        public string Program { get; set; }

        public PrivilegeEntity Priviliges { get; set; }
        public List<HierarchyEntity> caseHierarchy { get; set; }
        public ProgramDefinitionEntity programDefinitionList { get; set; }

        public string ProgramYear { get; set; }


        public string AgencyName { get; set; }


        public string DeptName { get; set; }


        public string ProgramName { get; set; }


        public string ApplicationNo { get; set; }

        public char AddPriv { get; set; }

        public DataTable ClientTotal { get; set; }
        public DataTable dtcasespm { get; set; }
        public DataTable dtcaseact { get; set; }
        public DataTable dtcasems { get; set; }
        public DataTable dtcasecont { get; set; }
        public DataTable dtactrefs { get; set; }
        public DataTable dtmatasmt { get; set; }
        public DataTable dtliheapb { get; set; }
        public DataTable dtpayment { get; set; }
        public DataTable dtemsres { get; set; }
        public DataTable dtemsclcpmc { get; set; }
        public DataTable dtCASEMST { get; set; }
        public DataTable dtCASESNP { get; set; }
        List<CommonEntity> propRelation { get; set; }

        public List<PrivilegeEntity> userPrivilege { get; set; }


        public ProgramDefinitionEntity ProgramDefinition { get; set; }

        public AgencyControlEntity propAgencyControlDetails { get; set; }

        #endregion

        private void pictureBox2_Click(object sender, EventArgs e)
        {

        }

        private void FillCombo()
        {
            Captain.Common.Utilities.ListItem listems = propApplication.Find(u => u.Value.ToString() == "05");
            Captain.Common.Utilities.ListItem listEnergyassisteance = propApplication.Find(u => u.Value.ToString() == "08");

            string Acr_State = "";
            if (propAgencyControlDetails != null)
                Acr_State = propAgencyControlDetails.State;

            cmbSelect.Items.Clear();
            cmbSelect.Items.Add(new Captain.Common.Utilities.ListItem("All", "A"));

            cmbSelect.Items.Add(new Captain.Common.Utilities.ListItem("Client Intake", "I"));
            if (listems == null)
                cmbSelect.Items.Add(new Captain.Common.Utilities.ListItem("Service Plans", "S"));
            cmbSelect.Items.Add(new Captain.Common.Utilities.ListItem("Contact Date", "C"));
            cmbSelect.Items.Add(new Captain.Common.Utilities.ListItem("Refer From/To", "R"));
            cmbSelect.Items.Add(new Captain.Common.Utilities.ListItem("Full Assessment (Matrix)", "M"));
            if (listEnergyassisteance != null)
                cmbSelect.Items.Add(new Captain.Common.Utilities.ListItem("Fuel Assistance Benefit", "B"));
            if (listems != null)
                cmbSelect.Items.Add(new Captain.Common.Utilities.ListItem("Emergency Services", "E"));
            //cmbSelect.Items.Add(new Captain.Common.Utilities.ListItem("Closed", "C"));
            cmbSelect.SelectedIndex = 0;
        }

        private void fillSnpDetails(bool boolfillcontrols)
        {
            dataGridCaseSnp.SelectionChanged -= new EventHandler(dataGridCaseSnp_SelectionChanged);
            dataGridCaseSnp.Rows.Clear();
            if (BaseForm.BaseCaseSnpEntity != null)
            {
                CaseSnpEntity casesnpApplicant = BaseForm.BaseCaseSnpEntity.Find(u => u.FamilySeq.Equals(BaseForm.BaseCaseMstListEntity[0].FamilySeq));

                List<CaseSnpEntity> caseSnpMembers = BaseForm.BaseCaseSnpEntity.FindAll(u => u.FamilySeq != BaseForm.BaseCaseMstListEntity[0].FamilySeq);
                int rowIndex = 0;
                if (casesnpApplicant != null)
                {
                    string memberCode = string.Empty;
                    CommonEntity rel = propRelation.Find(u => u.Code.Equals(casesnpApplicant.MemberCode));
                    if (rel != null) memberCode = rel.Desc;
                    string name = LookupDataAccess.GetMemberName(casesnpApplicant.NameixFi, casesnpApplicant.NameixMi, casesnpApplicant.NameixLast, BaseForm.BaseHierarchyCnFormat);
                    string TmpSsn = casesnpApplicant.Ssno.Trim();
                    TmpSsn = LookupDataAccess.GetCardNo(TmpSsn, "1", string.Empty, string.Empty);
                    rowIndex = dataGridCaseSnp.Rows.Add(casesnpApplicant.FamilySeq, name, memberCode, LookupDataAccess.Getdate(casesnpApplicant.AltBdate.Trim()), TmpSsn, casesnpApplicant.Ssno.Trim(), casesnpApplicant.NameixFi);
                    if (casesnpApplicant.Status.Trim() != "A")
                        dataGridCaseSnp.Rows[rowIndex].DefaultCellStyle.ForeColor = Color.Red;
                    if (casesnpApplicant.Status.Trim() == "A")
                        dataGridCaseSnp.Rows[rowIndex].DefaultCellStyle.ForeColor = Color.Blue;
                    if (casesnpApplicant.Status.Trim() != "A")
                        dataGridCaseSnp.Rows[rowIndex].Cells["Name"].Style.ForeColor = Color.Blue;  //MemberName
                    if (casesnpApplicant.Exclude == "Y")
                        dataGridCaseSnp.Rows[rowIndex].Cells["Relation"].Style.ForeColor = Color.Red;
                    dataGridCaseSnp.Rows[rowIndex].Tag = casesnpApplicant;
                }
                foreach (CaseSnpEntity caseSnp in caseSnpMembers)
                {
                    string memberCode = string.Empty;
                    CommonEntity rel = propRelation.Find(u => u.Code.Equals(caseSnp.MemberCode));
                    if (rel != null) memberCode = rel.Desc;
                    string name = LookupDataAccess.GetMemberName(caseSnp.NameixFi, caseSnp.NameixMi, caseSnp.NameixLast, BaseForm.BaseHierarchyCnFormat);
                    string strAltDate = LookupDataAccess.Getdate(caseSnp.AltBdate);
                    string strSsno = LookupDataAccess.GetCardNo(caseSnp.Ssno, "1", programDefinitionList.SSNReasonFlag.Trim(), caseSnp.SsnReason);
                    string TmpSsn = caseSnp.Ssno.Trim();
                    TmpSsn = LookupDataAccess.GetCardNo(TmpSsn, "1", string.Empty, string.Empty);
                    rowIndex = dataGridCaseSnp.Rows.Add(caseSnp.FamilySeq, name, memberCode, LookupDataAccess.Getdate(caseSnp.AltBdate.Trim()), TmpSsn, caseSnp.Ssno.Trim(), caseSnp.NameixFi);
                    dataGridCaseSnp.Rows[rowIndex].Tag = caseSnp;
                    if (caseSnp.Status.Trim() != "A")
                        dataGridCaseSnp.Rows[rowIndex].DefaultCellStyle.ForeColor = Color.Red;
                    if (caseSnp.Exclude == "Y")
                        dataGridCaseSnp.Rows[rowIndex].Cells["Relation"].Style.ForeColor = Color.Red;

                    CommonFunctions.setTooltip(rowIndex, caseSnp.AddOperator, caseSnp.DateAdd, caseSnp.LstcOperator, caseSnp.DateLstc, dataGridCaseSnp);
                }
            }

            
            if (dataGridCaseSnp.Rows.Count > 0)
            {
                dataGridCaseSnp.Rows[0].Selected = true;
            }
            dataGridCaseSnp.SelectionChanged += new EventHandler(dataGridCaseSnp_SelectionChanged);
        }


        string AllHieSer_Sw = "N";
        private void Fill_Other_prog_Grid()
        {
            this.GvwAppHou.SelectionChanged -= new System.EventHandler(this.GvwAppHou_SelectionChanged);

            //string Gbl_Hierarchy = BaseForm.UserProfile.Agency + BaseForm.UserProfile.Dept + BaseForm.UserProfile.Prog + BaseForm.UserProfile.Year;
            //string Gbl_Hierarchy = Agency + Dept + Program + ProgramYear;
            string Gbl_Hierarchy = BaseForm.BaseAgency + BaseForm.BaseDept + BaseForm.BaseProg + BaseForm.BaseYear, Mst_Active = "", Snp_Active = "";
            //Old_AppNo = BaseForm.BaseApplicationNo;

            ProgramDefinitionEntity programEntity = _model.HierarchyAndPrograms.GetCaseDepadp(Agency, Dept, Program);
            if (programEntity != null)
            {
                ProgramDefinition = programEntity;
            }

            //GvwAppHou.Rows.Clear();
            DataSet ds = Captain.DatabaseLayer.MainMenu.MainMenuSearch("APP", "ALL", null, null, BaseForm.BaseApplicationNo, null, null, null, null, null, null, null, null, null, null, Gbl_Hierarchy, null, BaseForm.UserID, string.Empty, string.Empty, null);
            DataTable dt = ds.Tables[0];

            if (dt.Rows.Count > 0)
            {
                DataRow dr_Mst = dt.Rows[0];
                GvwAppHou.Rows.Clear();

                string Mst_App_Key = dr_Mst["Agency"].ToString() + dr_Mst["Dept"].ToString() + dr_Mst["Prog"].ToString() + dr_Mst["SnpYear"] + dr_Mst["AppNo"];    //RecKey

                //DataSet ds1 = Captain.DatabaseLayer.MainMenu.MainMenuGetHouseDetails(Mst_App_Key);
                //DataTable dt1 = ds1.Tables[0];
                GvwAppHou.Rows.Clear();
                try
                {
                    int TmpRows = 0;
                    //foreach (DataRow dr in dt1.Rows)

                    string TMPSnp_FName = "", TMPSnp_LName = "", Recent_Lstc_Date = "", Address1 = "", Address2 = "", Phone = "", CellPhone = "", Email = "", TmpClientID = "";
                    List<CommonEntity> dates = new List<CommonEntity>();
                    foreach (DataRow dr in dt.Rows)
                    {
                        //if (dr["Ssn"].ToString() == dataGridCaseSnp.CurrentRow.Cells["TmpSSN"].Value.ToString())//dr["AppNo"].ToString().Substring(10, 1) == "A"
                        if (dr["Fname"].ToString() == dataGridCaseSnp.SelectedRows[0].Cells["gvFName"].Value.ToString() && LookupDataAccess.Getdate(dr["DOB"].ToString()) == dataGridCaseSnp.SelectedRows[0].Cells["Dob"].Value.ToString())
                        {

                            int rowIndex = 0;
                            string TmpName = null, TmpAddress = null, TmpDOB = null, TmpUpdated = null, TmpSsn = null;
                            int TmpLength = 0;
                            char TmpSpace = ' ';

                            TmpName = LookupDataAccess.GetMemberName(dr["Fname"].ToString(), dr["MName"].ToString(), dr["Lname"].ToString(), BaseForm.BaseHierarchyCnFormat.ToString());
                            TMPSnp_FName = dr["Fname"].ToString().Trim();
                            TMPSnp_LName = string.Empty;
                            TmpDOB = null;


                            TmpDOB = dr["DOB"].ToString();
                            if (string.IsNullOrEmpty(TmpDOB))
                            {
                                TMPSnp_LName = dr["Lname"].ToString().Trim();
                            }
                            //TmpDOB = dr["Dob"].ToString();
                            //TmpDOB = TmpDOB.Substring(4,2) + '/' + TmpDOB.Substring(1,2) + '/' + TmpDOB.Substring(7,2);
                            string[] time2 = Regex.Split(TmpDOB.ToString(), " ");
                            TmpDOB = time2[0];

                            if (!string.IsNullOrEmpty(dr["ClientID"].ToString().Trim()))
                                TmpClientID = dr["ClientID"].ToString().Trim();

                            //TmpName = dr["Fname"] + ", " + dr["Lname"] + "  " + dr["MName"];
                            //TmpSsn = dr["Ssn"].ToString();
                            TmpSsn = dataGridCaseSnp.SelectedRows[0].Cells["TmpSSN"].Value.ToString();
                            DataSet ds2 = Captain.DatabaseLayer.MainMenu.MainMenuOtherPrograms_DeeperSearch(TmpSsn, Mst_App_Key.Substring(0, 10), BaseForm.UserID, null, TMPSnp_FName, TMPSnp_LName, TmpDOB, TmpClientID);
                            DataTable dt2 = ds2.Tables[0];

                            if (ds2.Tables[1].Rows.Count > 0) ClientTotal = ds2.Tables[1];
                            if (ds2.Tables[2].Rows.Count > 0) dtcasespm = ds2.Tables[2];
                            if (ds2.Tables[3].Rows.Count > 0) dtcaseact = ds2.Tables[3];
                            if (ds2.Tables[4].Rows.Count > 0) dtcasems = ds2.Tables[4];
                            if (ds2.Tables[5].Rows.Count > 0) dtcasecont = ds2.Tables[5];
                            if (ds2.Tables[6].Rows.Count > 0) dtactrefs = ds2.Tables[6];
                            if (ds2.Tables[7].Rows.Count > 0) dtmatasmt = ds2.Tables[7];
                            if (ds2.Tables[8].Rows.Count > 0) dtliheapb = ds2.Tables[8];
                            if (ds2.Tables[9].Rows.Count > 0) dtpayment = ds2.Tables[9];
                            if (ds2.Tables[10].Rows.Count > 0) dtemsres = ds2.Tables[10];
                            if (ds2.Tables[11].Rows.Count > 0) dtemsclcpmc = ds2.Tables[11];
                            if (ds2.Tables[12].Rows.Count > 0) dtCASEMST = ds2.Tables[12];
                            if (ds2.Tables[13].Rows.Count > 0) dtCASESNP = ds2.Tables[13];


                            TmpLength = (9 - TmpSsn.Length);
                            for (int i = 0; i < TmpLength; i++)
                                TmpAddress += TmpSpace;
                            TmpSsn += TmpAddress;
                            //TmpSsn = TmpSsn.Substring(0, 3) + '-' + TmpSsn.Substring(3, 2) + '-' + TmpSsn.Substring(5, 4);
                            TmpSsn = LookupDataAccess.GetCardNo(TmpSsn, "1", string.Empty, string.Empty);
                            TmpDOB = null;


                            TmpDOB = dr["DOB"].ToString();
                            //TmpDOB = dr["Dob"].ToString();
                            //TmpDOB = TmpDOB.Substring(4,2) + '/' + TmpDOB.Substring(1,2) + '/' + TmpDOB.Substring(7,2);
                            string[] time = Regex.Split(TmpDOB.ToString(), " ");
                            TmpDOB = time[0];
                            TmpUpdated = null;
                            TmpUpdated = dr["SNP_DATE_LSTC"].ToString();
                            //TmpUpdated = dr["Updated"].ToString();

                            time = null;
                            time = Regex.Split(TmpUpdated.ToString(), " ");
                            TmpUpdated = time[0];
                            //TmpUpdated = TmpUpdated.Substring(3, 2) + '/' + TmpUpdated.Substring(0, 2) + '/' + TmpUpdated.Substring(6, 2);



                            int TmpOtherCount = 0;
                            TmpOtherCount = dt2.Rows.Count;
                            string[] TmpOtherProgstr = new string[TmpOtherCount];

                            string TmpOtherProgstr1 = null;
                            string TmpOtherProgstr2 = null;
                            // string TmpOtherProgstr3 = null;
                            if (dt2.Rows.Count > 0)
                            {
                                //DataView dv1 = new DataView(dt2);
                                //dv1.RowFilter = "MST_AGENCY= '" + BaseForm.BaseAgency + "'";
                                //dt2 = dv1.ToTable();

                                DataView dv = new DataView(dt2);
                                dv.RowFilter = "MST_AGENCY= '" + BaseForm.BaseAgency + "'";
                                dv.Sort = "MST_DATE_LSTC_1 Desc";
                                dt2 = dv.ToTable();


                                int i = 0;
                                foreach (DataRow dr1 in dt2.Rows)
                                {
                                    TmpOtherProgstr[i] = dr1["Hierarchy"].ToString();
                                    switch (i)
                                    {
                                        case 0: TmpOtherProgstr1 = TmpOtherProgstr[i]; break;
                                        case 1: TmpOtherProgstr2 = TmpOtherProgstr[i]; break;
                                            //case 2: TmpOtherProgstr3 = TmpOtherProgstr[i]; break;
                                    }
                                    // Murali added suffix field in address on 04/10/2021
                                    string strsufffix = string.Empty;
                                    if (!string.IsNullOrEmpty(dr1["Suffix"].ToString().Trim()))
                                        strsufffix = " " + dr1["Suffix"].ToString().Trim();

                                    Address1 = dr1["Hno"].ToString() + " " + dr1["Street"].ToString() + strsufffix + ". Apt " + dr1["Apt"].ToString();
                                    Address2 = dr1["City"].ToString() + ", " + dr1["State1"].ToString() + ". " + dr1["Zip"].ToString();
                                    if (i == 0)
                                    {
                                        Phone = dr1["Phone"].ToString(); CellPhone = dr1["MST_CELL_PHONE"].ToString(); Email = dr1["MST_EMAIL"].ToString();
                                    }
                                    Recent_Lstc_Date = CommonFunctions.ChangeDateFormat(Convert.ToDateTime(dr1["MST_DATE_LSTC_1"].ToString()).ToShortDateString(), Consts.DateTimeFormats.DateSaveFormat, Consts.DateTimeFormats.DateDisplayFormat);

                                    dates.Add(new CommonEntity(Recent_Lstc_Date, dr1["Hierarchy"].ToString(), dr1["MST_YEAR"].ToString(), dr1["MST_APP_NO"].ToString(), Address1, Address2, Phone, CellPhone, Email));

                                    if (dr1["Pdf_Sw"].ToString() == "Y" || dr1["CNotes_Sw"].ToString() == "Y")
                                        AllHieSer_Sw = "Y";

                                    string ISCaseNotes = "N";

                                    PrivilegeEntity Privileges = new PrivilegeEntity();
                                    //List<PrivilegeEntity> userPrivilege = _model.UserProfileAccess.GetScreensByUserID(BaseForm.BusinessModuleID, BaseForm.UserID, AGY + Dept + Prog);
                                    if (userPrivilege.Count > 0)
                                        Privileges = userPrivilege.Find(u => u.Program == "CASE2001");

                                    string strScreenDesc = string.Empty;
                                    string strFieldName = dr1["MST_AGENCY"].ToString() + dr1["MST_DEPT"].ToString() + dr1["MST_PROGRAM"].ToString() + dr1["MST_YEAR"].ToString() + dr1["MST_APP_NO"].ToString();
                                    List<EMPLFUNCEntity> empfuncEntity = _model.TmsApcndata.GetCaseNotesDesc(BaseForm.UserID, BaseForm.BusinessModuleID, dr1["MST_AGENCY"].ToString() + dr1["MST_DEPT"].ToString() + dr1["MST_PROGRAM"].ToString(), strFieldName);
                                    if (empfuncEntity.Count > 0) ISCaseNotes = "Y";

                                    ////List<CaseNotesEntity> caseNotesEntity = new List<CaseNotesEntity>();
                                    ////caseNotesEntity = _model.TmsApcndata.GetCaseNotesScreenFieldName(Privileges.Program, dr1["MST_AGENCY"].ToString() + dr1["MST_DEPT"].ToString() + dr1["MST_PROGRAM"].ToString() + dr1["MST_YEAR"].ToString() + dr1["MST_APP_NO"].ToString());
                                    ////if (caseNotesEntity.Count > 0) ISCaseNotes = "Y";

                                    string _HIEnYear = dr1["Hierarchy"].ToString().Substring(0, 11);
                                    string _Appno = dr1["Hierarchy"].ToString().Substring(11, 11).Trim();
                                    string _prgdesc = dr1["Hierarchy"].ToString().Substring(23, dr1["Hierarchy"].ToString().Length - 23);


                                    //rowIndex = GvwAppHou.Rows.Add(dr1["Hierarchy"].ToString(), Recent_Lstc_Date.ToString(), dr1["MST_AGENCY"].ToString(), dr1["MST_DEPT"].ToString(), dr1["MST_PROGRAM"].ToString(), dr1["MST_YEAR"].ToString(), dr1["MST_APP_NO"].ToString(), TmpSsn, TmpDOB, dr1["Pdf_Sw"].ToString(), dr1["CNotes_Sw"].ToString(), ISCaseNotes);
                                    rowIndex = GvwAppHou.Rows.Add(_HIEnYear.ToString(), _Appno, _prgdesc, Recent_Lstc_Date.ToString(), dr1["MST_AGENCY"].ToString(), dr1["MST_DEPT"].ToString(), dr1["MST_PROGRAM"].ToString(), dr1["MST_YEAR"].ToString(), dr1["MST_APP_NO"].ToString(), TmpSsn, TmpDOB, dr1["Pdf_Sw"].ToString(), dr1["CNotes_Sw"].ToString(), ISCaseNotes);
                                    GvwAppHou.Rows[rowIndex].Tag = dr;

                                    i++;
                                }
                            }

                            Lbl_App_Name.Text = TmpName;

                            if (dates.Count > 0)
                            {
                                dates = dates.OrderByDescending(u => Convert.ToDateTime(u.Code.Trim())).ToList();
                                Lbl_Recent_Lstc_Date.Text = "Most Recent Demographics SAVED on " + dates[0].Code.ToString() + " " + "in " + dates[0].Desc.Substring(0, 2).ToString() + "-" + dates[0].Desc.Substring(2, 2).ToString() + "-" + dates[0].Desc.Substring(4, 2).ToString() + " " + dates[0].Hierarchy.ToString() + " " + dates[0].Extension.ToString();

                                //Lbl_BaseApp.Text = "in " + dates[0].Desc.Substring(0, 2).ToString() + "-" + dates[0].Desc.Substring(2, 2).ToString() + "-" + dates[0].Desc.Substring(4, 2).ToString() + " " + dates[0].Hierarchy.ToString() + " " + dates[0].Extension.ToString();

                                MaskedTextBox mskphn = new MaskedTextBox();
                                mskphn.Mask = "(000)000-0000";
                                mskphn.Text = dates[0].PDept.Trim();
                                MaskedTextBox mskCellphn = new MaskedTextBox(); mskCellphn.Mask = "(000)000-0000";
                                mskCellphn.Text = dates[0].Pprog.Trim();
                                //string Phone = string.Empty, CellPhone = string.Empty;
                                Email = dates[0].Active.Trim() == string.Empty ? " " : " Email: " + Email.Trim();
                                if (!string.IsNullOrEmpty(Phone.Trim())) Phone = "Phone # " + mskphn.Text.Trim();
                                if (!string.IsNullOrEmpty(CellPhone.Trim())) CellPhone = " Cell # " + mskCellphn.Text.Trim();
                                Lbl_Add1.Text = dates[0].Pyear.Trim();
                                Lbl_Add2.Text = dates[0].PAgency.Trim();
                                lblPhone.Text = Phone + CellPhone + Email;
                            }

                            //rowIndex = GvwAppHou.Rows.Add(TmpName, TmpSsn, TmpDOB, TmpUpdated, TmpOtherProgstr1, TmpOtherProgstr2); //, TmpOtherProgstr3
                            //GvwAppHou.Rows[rowIndex].Tag = dr;

                            //if (dr["AppNo"].ToString().Substring(10, 1) == "A")
                            //    GvwAppHou.Rows[rowIndex].DefaultCellStyle.ForeColor = Color.Blue;

                            Mst_Active = dr["MST_ACTIVE_STATUS"].ToString().Trim();
                            Snp_Active = dr["AppStatus"].ToString().Trim();// != "A")

                            /*Commented by Sudheer on 02/29/2016

                            if (dr["AppNo"].ToString().Substring(10, 1) == "A" && Mst_Active != "Y")
                                GvwAppHou.Rows[rowIndex].Cells["ZCRZIP"].Style.ForeColor = Color.Red;

                            if (Snp_Active != "A")
                                GvwAppHou.Rows[rowIndex].Cells["ZCRZIP"].Style.ForeColor = Color.Red;

                            */

                            //if (TmpOtherCount > 2)  //TmpOtherCount > 3
                            //{
                            //    int AddOtherRows = (TmpOtherCount - 2) / 2;
                            //    int aa = (TmpOtherCount - 2) % 2;
                            //    for (int i = 0; i < AddOtherRows; ) //for (int i = 3; i < AddOtherRows; )
                            //    {
                            //        TmpOtherProgstr1 = TmpOtherProgstr[i + 2]; //TmpOtherProgstr1 = TmpOtherProgstr[i];
                            //        TmpOtherProgstr2 = TmpOtherProgstr[i + 1 + 2]; //TmpOtherProgstr2 = TmpOtherProgstr[i + 1];
                            //        //TmpOtherProgstr3 = TmpOtherProgstr[i + 2];
                            //        rowIndex = GvwAppHou.Rows.Add(" ", " ", " ", " ", TmpOtherProgstr1, TmpOtherProgstr2); //, TmpOtherProgstr3
                            //        GvwAppHou.Rows[rowIndex].Tag = dr;
                            //        i += 2;
                            //    }
                            //    if (aa > 0)
                            //    {
                            //        TmpOtherProgstr1 = TmpOtherProgstr2 = null;
                            //        switch (aa)
                            //        {
                            //            case 1: TmpOtherProgstr1 = TmpOtherProgstr[TmpOtherProgstr.Length - 1]; break;
                            //            case 2: TmpOtherProgstr1 = TmpOtherProgstr[TmpOtherProgstr.Length - 1];
                            //                TmpOtherProgstr2 = TmpOtherProgstr[TmpOtherProgstr.Length - 2]; break;
                            //        }
                            //        rowIndex = GvwAppHou.Rows.Add(" ", " ", " ", " ", TmpOtherProgstr1, TmpOtherProgstr2, " ");
                            //        GvwAppHou.Rows[rowIndex].Tag = dr;
                            //    }
                            //}

                            TmpRows++;
                        }

                        //if (GvwAppHou.Rows.Count > 0)
                        //{
                        //    GvwAppHou.Rows[0].Tag = 0; //Old_AppNo = TxtAppNo.Text;
                        //    GvwAppHou.CurrentCell = GvwAppHou.Rows[0].Cells[0];
                        //    GvwAppHou.Rows[0].Selected = true;
                        //    //if (!Adv_search)
                        //    //ShowHierachyandApplNo(Agency, Dept, Program, ProgramYear, TxtAppNo.Text);
                        //    this.GvwAppHou.SelectionChanged += new System.EventHandler(this.GvwAppHou_SelectionChanged);
                        //    Fill_Totals_Grid();
                        //    FillCombo();
                        //}
                        //else
                        //{
                        //    if(AddPriv == 'Y')
                        //        BtnAddApp.Visible = true;

                        //    Btn_First.Visible = BtnP10.Visible = BtnPrev.Visible =
                        //    BtnNxt.Visible = BtnN10.Visible = BtnLast.Visible = false;
                        //}

                    }
                    if (GvwAppHou.Rows.Count > 0)
                    {
                        GvwAppHou.Rows[0].Tag = 0; //Old_AppNo = TxtAppNo.Text;
                        GvwAppHou.CurrentCell = GvwAppHou.Rows[0].Cells[0];
                        GvwAppHou.Rows[0].Selected = true;
                        //if (!Adv_search)
                        //ShowHierachyandApplNo(Agency, Dept, Program, ProgramYear, TxtAppNo.Text);
                        this.GvwAppHou.SelectionChanged += new System.EventHandler(this.GvwAppHou_SelectionChanged);
                        Fill_Totals_Grid();
                        FillCombo();
                    }
                    else
                    {
                        TotalsGrid.Rows.Clear();
                    }
                }
                catch (Exception ex) { }
            }
        }

        public string propReportPath { get; set; }
        List<Client_InqTotal_entity> Client_Tot_List = new List<Client_InqTotal_entity>();
        List<CaseMstEntity> CASEMSTList = new List<CaseMstEntity>();
        List<CaseSnpEntity> casesnpList = new List<CaseSnpEntity>();
        List<CaseIncomeEntity> incomelist = new List<CaseIncomeEntity>();
        List<CASESPMEntity> spmlist = new List<CASESPMEntity>();
        List<CASEACTEntity> actList = new List<CASEACTEntity>();
        List<CASEMSEntity> MSlist = new List<CASEMSEntity>();
        List<ACTREFSEntity> Actrefslist = new List<ACTREFSEntity>();
        List<CASECONTEntity> ContList = new List<CASECONTEntity>();
        List<MATASMTEntity> MATAList = new List<MATASMTEntity>();
        List<LIHEAPBEntity> LPBList = new List<LIHEAPBEntity>();
        List<PAYMNETEntity> PaymentList = new List<PAYMNETEntity>();
        List<EMSRESEntity> EMSRESList = new List<EMSRESEntity>();
        List<EMSCLCPMCEntity> EMSCLCList = new List<EMSCLCPMCEntity>();
        List<CASESP1Entity> SP1List = new List<CASESP1Entity>();
        List<CASEREFEntity> CASEREFREF_List = new List<CASEREFEntity>();
        List<MATDEFBMEntity> MATADEFBMentity = new List<MATDEFBMEntity>();
        List<Captain.Common.Utilities.ListItem> propApplication = new List<Captain.Common.Utilities.ListItem>();
        List<EMSBDCEntity> propEmsbdc_List { get; set; }
        List<EMSCLAPMAEntity> propEMSCLAPMAList { get; set; }
        List<CommonEntity> propfundingsource { get; set; }
        CaseSnpEntity SelSnp = new CaseSnpEntity();
        DataTable dtSP1 = new DataTable(); DataSet dsSite = new DataSet();
        //string Img_Blank = Consts.Icons.ico_Blank;
        //  string Img_Tick = new Gizmox.WebGUI.Common.Resources.ImageResourceHandle("tick.ico");
        private string strNameFormat = string.Empty;

        private void ClearEntities()
        {
            Client_Tot_List = new List<Client_InqTotal_entity>();
            CASEMSTList = new List<CaseMstEntity>();
            casesnpList = new List<CaseSnpEntity>();
            incomelist = new List<CaseIncomeEntity>();
            spmlist = new List<CASESPMEntity>();
            actList = new List<CASEACTEntity>();
            MSlist = new List<CASEMSEntity>();
            Actrefslist = new List<ACTREFSEntity>();
            ContList = new List<CASECONTEntity>();
            MATAList = new List<MATASMTEntity>();
            LPBList = new List<LIHEAPBEntity>();
            PaymentList = new List<PAYMNETEntity>();
            EMSRESList = new List<EMSRESEntity>();
            EMSCLCList = new List<EMSCLCPMCEntity>();

        }

        //ProgramDefinitionEntity programEntity = new ProgramDefinitionEntity();
        HierarchyEntity programEntity = new HierarchyEntity();
        string strAgency = string.Empty, strDept = string.Empty, strProgram = string.Empty, strYear = string.Empty, strApp = string.Empty;
        private void Fill_Totals_Grid()
        {
            TotalsGrid.Rows.Clear();
            string AGY = GvwAppHou.SelectedRows[0].Cells["Grd_Agy"].Value.ToString();
            string Dept = GvwAppHou.SelectedRows[0].Cells["Grd_Dept"].Value.ToString();
            string Prog = GvwAppHou.SelectedRows[0].Cells["Grd_Prog"].Value.ToString();
            string Year = GvwAppHou.SelectedRows[0].Cells["Grd_Year"].Value.ToString();
            string App = GvwAppHou.SelectedRows[0].Cells["Grd_App"].Value.ToString();

            if (chkbAllHier.Checked == false)
            {
                if (GvwAppHou.SelectedRows[0].Cells["Pdf_Sw"].Value.ToString() == "N") PbPdf.Visible = false; else PbPdf.Visible = true;
                if (GvwAppHou.SelectedRows[0].Cells["CNotes_Sw"].Value.ToString() == "N") Btn_CaseNotes.Visible = false;
                else { if (GvwAppHou.SelectedRows[0].Cells["ISCaseNotes"].Value.ToString() == "N") Btn_CaseNotes.Visible = false; else Btn_CaseNotes.Visible = true; }
            }

            strAgency = AGY; strDept = Dept; strProgram = Prog; strYear = Year; strApp = App;

            string Acr_State = "";
            if (propAgencyControlDetails != null)
                Acr_State = propAgencyControlDetails.State;

            //Client_Tot_List = _model.AdhocData.Get_ClientInq_Totals(AGY, Dept, Prog, Year, App);
            //programEntity = _model.HierarchyAndPrograms.GetCaseDepadp(AGY, Dept, Prog);
            programEntity = caseHierarchy.Find(u => u.Agency.Equals(AGY) && u.Dept.Equals(Dept) && u.Prog.Equals(Prog));

            DataSet dsModule = Captain.DatabaseLayer.Lookups.GetModules();
            DataTable dt2 = dsModule.Tables[0];

            List<Captain.Common.Utilities.ListItem> listApplications = new List<Captain.Common.Utilities.ListItem>();

            foreach (DataRow dr in dt2.Rows)
            {
                listApplications.Add(new Captain.Common.Utilities.ListItem(dr["APPL_DESCRIPTION"].ToString(), dr["APPL_CODE"].ToString()));
            }
            propApplication = listApplications;

            ClearEntities();
            DataSet ds = DatabaseLayer.SPAdminDB.Get_ClientInq_Totals(AGY, Dept, Prog, Year, App);
            if (ds.Tables.Count > 0)
            {
                if (ds.Tables[0].Rows.Count > 0)
                {
                    foreach (DataRow row in ds.Tables[0].Rows)
                        Client_Tot_List.Add(new Client_InqTotal_entity(row));
                }
                if (ds.Tables[1].Rows.Count > 0)
                {
                    foreach (DataRow row in ds.Tables[1].Rows)
                        CASEMSTList.Add(new CaseMstEntity(row));
                }
                if (ds.Tables[2].Rows.Count > 0)
                {
                    foreach (DataRow row in ds.Tables[2].Rows)
                        casesnpList.Add(new CaseSnpEntity(row));
                }
                if (ds.Tables[3].Rows.Count > 0)
                {
                    foreach (DataRow row in ds.Tables[3].Rows)
                        incomelist.Add(new CaseIncomeEntity(row, string.Empty));
                }
                if (ds.Tables[4].Rows.Count > 0)
                {
                    foreach (DataRow row in ds.Tables[4].Rows)
                        spmlist.Add(new CASESPMEntity(row));
                }
                if (ds.Tables[5].Rows.Count > 0)
                {
                    foreach (DataRow row in ds.Tables[5].Rows)
                        actList.Add(new CASEACTEntity(row));
                    actList = actList.FindAll(u => u.Branch != "9");
                }
                if (ds.Tables[6].Rows.Count > 0)
                {
                    foreach (DataRow row in ds.Tables[6].Rows)
                        MSlist.Add(new CASEMSEntity(row));

                    MSlist = MSlist.FindAll(u => u.Branch != "9");
                }
                if (ds.Tables[7].Rows.Count > 0)
                {
                    foreach (DataRow row in ds.Tables[7].Rows)
                        ContList.Add(new CASECONTEntity(row));
                }
                if (ds.Tables[8].Rows.Count > 0)
                {
                    foreach (DataRow row in ds.Tables[8].Rows)
                        Actrefslist.Add(new ACTREFSEntity(row));
                }
                if (ds.Tables[9].Rows.Count > 0)
                {
                    foreach (DataRow row in ds.Tables[9].Rows)
                        MATAList.Add(new MATASMTEntity(row, "Browse"));
                }
                if (ds.Tables[10].Rows.Count > 0)
                {
                    foreach (DataRow row in ds.Tables[10].Rows)
                        LPBList.Add(new LIHEAPBEntity(row));
                }
                if (ds.Tables[11].Rows.Count > 0)
                {
                    foreach (DataRow row in ds.Tables[11].Rows)
                        PaymentList.Add(new PAYMNETEntity(row));
                }

                Captain.Common.Utilities.ListItem listems = propApplication.Find(u => u.Value.ToString() == "05");

                if (listems != null)
                {
                    if (ds.Tables[12].Rows.Count > 0)
                    {
                        foreach (DataRow row in ds.Tables[12].Rows)
                            EMSRESList.Add(new EMSRESEntity(row));
                    }
                    if (ds.Tables[13].Rows.Count > 0)
                    {
                        foreach (DataRow row in ds.Tables[13].Rows)
                            EMSCLCList.Add(new EMSCLCPMCEntity(row));
                    }

                    propEmsbdc_List = _model.EMSBDCData.GetEmsBdcAllData(AGY, Dept, Prog, Year, string.Empty, string.Empty, string.Empty, string.Empty, string.Empty, string.Empty, string.Empty);
                    propEMSCLAPMAList = _model.EMSBDCData.GetEmsclapmaAllData(AGY, Dept, Prog, Year, App, string.Empty, string.Empty, string.Empty, string.Empty, string.Empty);

                }

                if (CASEMSTList.Count > 0 && casesnpList.Count > 0)
                    SelSnp = casesnpList.Find(u => u.App.Equals(CASEMSTList[0].ApplNo) && u.FamilySeq.Equals(CASEMSTList[0].FamilySeq));

            }

            if (Client_Tot_List.Count > 0)
            {
                Captain.Common.Utilities.ListItem listems = propApplication.Find(u => u.Value.ToString() == "05");
                Captain.Common.Utilities.ListItem listEnergyassisteance = propApplication.Find(u => u.Value.ToString() == "08");

                TotalsGrid.Rows.Add("Client Intake", CASEMSTList.Count.ToString(), "0");
                foreach (Client_InqTotal_entity ent in Client_Tot_List)
                {
                    if (ent.Sno.Trim() == "9" || ent.Sno.Trim() == "10") //if (("9, 10").Contains(ent.Sno.Trim()))
                    {
                        if (listems != null)
                            TotalsGrid.Rows.Add(ent.Total_Desc, ent.Total_Cnt, ent.Sno);
                    }
                    else if (ent.Sno.Trim() == "7" || ent.Sno.Trim() == "8")
                    {
                        if (listEnergyassisteance != null)
                            TotalsGrid.Rows.Add(ent.Total_Desc, ent.Total_Cnt, ent.Sno);
                    }
                    else if (ent.Sno.Trim() == "1" || ent.Sno.Trim() == "2" || ent.Sno.Trim() == "3")
                    {
                        if (listems == null)
                            TotalsGrid.Rows.Add(ent.Total_Desc, ent.Total_Cnt, ent.Sno);
                    }
                    else
                        TotalsGrid.Rows.Add(ent.Total_Desc, ent.Total_Cnt, ent.Sno);

                    //if ((Acr_State == "TX" && ent.Sno.Contains("9, 10")))
                    //    TotalsGrid.Rows.Add(ent.Total_Desc, ent.Total_Cnt);
                }
            }


        }

        private void GvwAppHou_SelectionChanged(object sender, EventArgs e)
        {
            if (chkbAllHier.Checked == false)
            {
                TotalsGrid.Rows.Clear();
                Fill_Totals_Grid();

                //if (GvwAppHou.CurrentRow.Cells["Pdf_Sw"].Value.ToString() == "N") PbPdf.Visible = false; else PbPdf.Visible = true;
                //if (GvwAppHou.CurrentRow.Cells["CNotes_Sw"].Value.ToString() == "N") Btn_CaseNotes.Visible = false; else Btn_CaseNotes.Visible = true; 
            }

        }

        private void Btn_Client_Intake_Click(object sender, EventArgs e)
        {
            string AGY = GvwAppHou.SelectedRows[0].Cells["Grd_Agy"].Value.ToString();
            string Dept = GvwAppHou.SelectedRows[0].Cells["Grd_Dept"].Value.ToString();
            string Prog = GvwAppHou.SelectedRows[0].Cells["Grd_Prog"].Value.ToString();
            string Year = GvwAppHou.SelectedRows[0].Cells["Grd_Year"].Value.ToString();
            string App = GvwAppHou.SelectedRows[0].Cells["Grd_App"].Value.ToString();
            string ApplicantLastName = "";

            CaseMstEntity MSTEntity = _model.CaseMstData.GetCaseMST(AGY, Dept, Prog, Year, App);
            List<CaseSnpEntity> caseSnpEntity = _model.CaseMstData.GetCaseSnpadpyn(AGY, Dept, Prog, Year, App);
            CaseSnpEntity SNPEntity = new CaseSnpEntity();
            if (MSTEntity != null)
            {
                SNPEntity = _model.CaseMstData.GetCaseSnpDetails(AGY, Dept, Prog, Year, App, MSTEntity.FamilySeq);
                if (SNPEntity != null)
                    ApplicantLastName = SNPEntity.NameixLast;
            }
            PrivilegeEntity Privileges = new PrivilegeEntity();
            Privileges.Program = "Main Menu";


            //CaseSnpEntity caseSnpEntity = gvwCustomer.Rows[e.RowIndex].Tag as CaseSnpEntity;
            //CaseMstEntity caseMST = CaseMST;
            bool isApplicant = false;
            //if (MSTEntity.FamilySeq.Equals(caseSnpEntity.FamilySeq)) isApplicant = true;
            //ClientSNPForm clientSNPEditForm = new ClientSNPForm(BaseForm, true /*isApplicant*/ , MSTEntity, SNPEntity, Consts.Common.View, Privileges, caseSnpEntity, ApplicantLastName);
            // clientSNPEditForm.ShowDialog();

        }

        private void Btn_CaseNotes_Click(object sender, EventArgs e)
        {
            //MessageBox.Show("Under Construction", "CAPSYSTEMS");

            string AGY = GvwAppHou.SelectedRows[0].Cells["Grd_Agy"].Value.ToString();
            string Dept = GvwAppHou.SelectedRows[0].Cells["Grd_Dept"].Value.ToString();
            string Prog = GvwAppHou.SelectedRows[0].Cells["Grd_Prog"].Value.ToString();
            string Year = GvwAppHou.SelectedRows[0].Cells["Grd_Year"].Value.ToString();
            string App = GvwAppHou.SelectedRows[0].Cells["Grd_App"].Value.ToString();

            PrivilegeEntity Privileges = new PrivilegeEntity();
            //List<PrivilegeEntity> userPrivilege = _model.UserProfileAccess.GetScreensByUserID(BaseForm.BusinessModuleID, BaseForm.UserID, AGY + Dept + Prog);
            List<PrivilegeEntity> userPrivilege = _model.UserProfileAccess.GetScreensByUserID(BaseForm.BusinessModuleID, BaseForm.UserID, BaseForm.BaseAgency + BaseForm.BaseDept + BaseForm.BaseProg);
            if (userPrivilege.Count > 0)
                Privileges = userPrivilege.Find(u => u.Program == "CASE2001");

            string strFieldName = AGY + Dept + Prog;
            CaseNotesPrintPreview caseNotesPrintPreview = new CaseNotesPrintPreview(BaseForm, Privileges, strYear, App, Lbl_App_Name.Text.Trim(), strFieldName);
            caseNotesPrintPreview.StartPosition = FormStartPosition.CenterScreen;
            caseNotesPrintPreview.ShowDialog();

            //List<CaseNotesEntity> caseNotesEntity = new List<CaseNotesEntity>();
            //caseNotesEntity = _model.TmsApcndata.GetCaseNotesScreenFieldName(Privileges.Program, AGY + Dept + Prog + Year + App);

            //if (caseNotesEntity.Count > 0)
            //{
            //    On_CaseNotesForm_Closed(caseNotesEntity, Privileges);
            //    FrmViewer objfrm = new FrmViewer(PdfName);
            //    objfrm.FormClosed += new Form.FormClosedEventHandler(On_Delete_PDF_File);
            //    objfrm.ShowDialog();
            //}
            //else
            //{
            //    MessageBox.Show("No Casenotes Found for this Applicant");
            //}

            ////CaseNotes caseNotes = new CaseNotes(BaseForm, Privileges, caseNotesEntity, AGY + Dept + Prog + Year + App,BaseForm.BaseApplicationName,App);
            //////caseNotes.FormClosed += new Form.FormClosedEventHandler(OnCaseNotesFormClosed);
            ////caseNotes.ShowDialog();

        }



        string PdfCont = string.Empty;
        PdfContentByte cb;
        int X_Pos, Y_Pos;
        string strFolderPath = string.Empty;
        string Random_Filename = null; string PdfName = "Pdf File";
        private void On_SaveFormClosed(string Selection)
        {


            string AGY = GvwAppHou.SelectedRows[0].Cells["Grd_Agy"].Value.ToString();
            string Dept = GvwAppHou.SelectedRows[0].Cells["Grd_Dept"].Value.ToString();
            string Prog = GvwAppHou.SelectedRows[0].Cells["Grd_Prog"].Value.ToString();
            string Year = GvwAppHou.SelectedRows[0].Cells["Grd_Year"].Value.ToString();
            string App = GvwAppHou.SelectedRows[0].Cells["Grd_App"].Value.ToString();
            string Acr_State = "";
            if (propAgencyControlDetails != null)
                Acr_State = propAgencyControlDetails.State;

            SP1List = new List<CASESP1Entity>();

            Captain.Common.Utilities.ListItem listems = propApplication.Find(u => u.Value.ToString() == "05");
            Captain.Common.Utilities.ListItem listEnergyassisteance = propApplication.Find(u => u.Value.ToString() == "08");

            Fill_CaseWorker(AGY, Dept, Prog, Year);
            Fill_Languages_List();
            Get_Vendor_Brose_List();
            dsSite = Captain.DatabaseLayer.CaseMst.GetSiteByHIE(AGY, string.Empty, string.Empty);
            CASEREFEntity Search_REF_Entity = new CASEREFEntity(true);
            CASEREFREF_List = _model.SPAdminData.Browse_CASEREF(Search_REF_Entity, "Browse");
            //SP1List = _model.SPAdminData.Browse_CASESP1(string.Empty, AGY, Dept, Prog);
            DataSet ds = Captain.DatabaseLayer.SPAdminDB.Browse_CASESP1(string.Empty, AGY, Dept, Prog, string.Empty);
            //DataTable dt = new DataTable();
            if (ds.Tables.Count > 0)
                dtSP1 = ds.Tables[0];

            propfundingsource = _model.lookupDataAccess.GetAgyFunds(); //CommonFunctions.AgyTabsFilterCode(BaseForm.BaseAgyTabsEntity, "00501", BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg,Mode);

            propfundingsource = filterByHIE(propfundingsource, "View");
            Fill_CAMAST_List();
            Fill_MSMAST_List();

            CASEMSTList = CASEMSTList.OrderBy(u => u.ApplAgency).ThenBy(u => u.ApplDept).ThenBy(u => u.ApplProgram).ThenBy(u => u.ApplYr).ThenBy(u => u.ApplNo).ToList();

            //if(((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString()=="A" || ((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString()=="I")
            if (Selection.Contains("I") || Selection.Contains("A"))
            {
                if (chkbAllHier.Checked == false)
                {
                    ClientIntakeForm(AGY, Dept, Prog, Year, App);
                    PdfCont += "I";
                }
            }

            if (Selection.Contains("S") || Selection.Contains("A")) //if (((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "A" || ((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "S")
            {
                if (spmlist.Count > 0)
                {
                    //document.SetPageSize(iTextSharp.text.PageSize.A4);
                    //if (Selection == "A")
                    //    document.NewPage();
                    //CaseSpmPdf(document);
                    if (chkbAllHier.Checked)
                        CaseSpmPdfAllHiers();
                    else
                        CaseSpmPdf();
                    PdfCont += "S";
                }
            }

            if (Selection.Contains("C") || Selection.Contains("A"))//if (((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "A" || ((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "C")
            {
                if (ContList.Count > 0)
                {
                    //document.SetPageSize(iTextSharp.text.PageSize.A4);
                    //if (Selection == "A")
                    //    document.NewPage();
                    //CaseCONTPdf(document);
                    CaseCONTPdf();
                    PdfCont += "C";
                }
            }

            if (Selection.Contains("A") || Selection.Contains("R"))//if (((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "A" || ((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "R")
            {
                if (Actrefslist.Count > 0)
                {
                    //document.SetPageSize(iTextSharp.text.PageSize.A4);
                    //if (Selection == "A")
                    //    document.NewPage();
                    //ACTREFSPdf(document);
                    ACTREFSPdf();
                    PdfCont += "R";
                }
            }
            if (Selection.Contains("A") || Selection.Contains("M"))//if (((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "A" || ((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "M")
            {
                if (MATAList.Count > 0)
                {
                    //document.SetPageSize(iTextSharp.text.PageSize.A4);
                    //if (Selection == "A")
                    //    document.NewPage();
                    //MATASMTPdf(document);
                    if (chkbAllHier.Checked)
                        MATASMTPdfAllHier();
                    else
                        MATASMTPdf();
                    PdfCont += "M";
                }
            }


            if (Selection.Contains("A") || Selection.Contains("L"))//if (((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "A" || ((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "L")
            {
                if (LPBList.Count > 0)
                {
                    //document.SetPageSize(iTextSharp.text.PageSize.A4);
                    //if (Selection == "A")
                    //    document.NewPage();
                    //LiheapList(document);
                    LiheapList();
                    PdfCont += "L";
                }
            }

            if (listems != null)
            {
                if (Selection.Contains("A") || Selection.Contains("E"))//if (((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "A" || ((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "E")
                {
                    if (EMSRESList.Count > 0)
                    {
                        //document.SetPageSize(iTextSharp.text.PageSize.A4);
                        //if (Selection == "A")
                        //    document.NewPage();
                        //EMSRESPdf(document);
                        EMSRESPdf();
                        PdfCont += "E";
                    }
                }
            }

            //if(Count==0 && Selection!="A")
            //    document.Add(new Paragraph("No Records Found............................................... "));

            //document.Close();
            //fs.Close();
            //fs.Dispose();

            //FrmViewer objfrm = new FrmViewer(PdfName);
            //objfrm.FormClosed += new Form.FormClosedEventHandler(On_Delete_PDF_File);
            //objfrm.ShowDialog();

        }


        //private void On_SaveFormClosed(string Selection)
        //{
        //    Random_Filename = null;

        //    PdfName = BaseForm.BaseApplicationNo.ToString() + "Report";//form.GetFileName();
        //    PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
        //    try
        //    {
        //        if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
        //        { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
        //    }
        //    catch (Exception ex)
        //    {
        //        CommonFunctions.MessageBoxDisplay("Error");
        //    }


        //    try
        //    {
        //        string Tmpstr = PdfName + ".pdf";
        //        if (File.Exists(Tmpstr))
        //            File.Delete(Tmpstr);
        //    }
        //    catch (Exception ex)
        //    {
        //        int length = 8;
        //        string newFileName = System.Guid.NewGuid().ToString();
        //        newFileName = newFileName.Replace("-", string.Empty);

        //        Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
        //    }

        //    if (!string.IsNullOrEmpty(Random_Filename))
        //        PdfName = Random_Filename;
        //    else
        //        PdfName += ".pdf";

        //    FileStream fs = new FileStream(PdfName, FileMode.Create);

        //    Document document = new Document();
        //    document.SetPageSize(iTextSharp.text.PageSize.LETTER.Rotate());
        //    PdfWriter writer = PdfWriter.GetInstance(document, fs);
        //    document.Open();
        //    BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
        //    iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
        //    BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
        //    iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(1, 9, 4);
        //    BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

        //    iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
        //    iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
        //    iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
        //    iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(1, 9, 1);
        //    iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
        //    iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);
        //    cb = writer.DirectContent;

        //    string AGY = GvwAppHou.CurrentRow.Cells["Grd_Agy"].Value.ToString();
        //    string Dept = GvwAppHou.CurrentRow.Cells["Grd_Dept"].Value.ToString();
        //    string Prog = GvwAppHou.CurrentRow.Cells["Grd_Prog"].Value.ToString();
        //    string Year = GvwAppHou.CurrentRow.Cells["Grd_Year"].Value.ToString();
        //    string App = GvwAppHou.CurrentRow.Cells["Grd_App"].Value.ToString();
        //    string Acr_State = "";
        //    if (propAgencyControlDetails != null)
        //        Acr_State = propAgencyControlDetails.State;

        //    SP1List = new List<CASESP1Entity>();


        //    Fill_CaseWorker();
        //    Fill_Languages_List();
        //    Get_Vendor_Brose_List();
        //    dsSite = Captain.DatabaseLayer.CaseMst.GetSiteByHIE(AGY, string.Empty, string.Empty);
        //    CASEREFEntity Search_REF_Entity = new CASEREFEntity(true);
        //    CASEREFREF_List = _model.SPAdminData.Browse_CASEREF(Search_REF_Entity, "Browse");
        //    //SP1List = _model.SPAdminData.Browse_CASESP1(string.Empty, AGY, Dept, Prog);
        //    DataSet ds = Captain.DatabaseLayer.SPAdminDB.Browse_CASESP1(string.Empty, AGY, Dept, Prog);
        //    //DataTable dt = new DataTable();
        //    if (ds.Tables.Count > 0)
        //        dtSP1 = ds.Tables[0];

        //    propfundingsource = _model.lookupDataAccess.GetAgyFunds(); //CommonFunctions.AgyTabsFilterCode(BaseForm.BaseAgyTabsEntity, "00501", BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg,Mode);

        //    propfundingsource = filterByHIE(propfundingsource, "View");
        //    Fill_CAMAST_List();
        //    Fill_MSMAST_List();

        //    //if(((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString()=="A" || ((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString()=="I")
        //    if (Selection.Contains("I") || Selection.Contains("A"))
        //        ClientIntakeForm(document, AGY, Dept, Prog, Year, App, cb, writer);

        //    if (Selection.Contains("S") || Selection.Contains("A")) //if (((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "A" || ((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "S")
        //    {
        //        if (spmlist.Count > 0)
        //        {
        //            document.SetPageSize(iTextSharp.text.PageSize.A4);
        //            if (Selection == "A")
        //                document.NewPage();
        //            CaseSpmPdf(document);
        //        }
        //    }

        //    if (Selection.Contains("C") || Selection.Contains("A"))//if (((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "A" || ((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "C")
        //    {
        //        if (ContList.Count > 0)
        //        {
        //            document.SetPageSize(iTextSharp.text.PageSize.A4);
        //            if (Selection == "A")
        //                document.NewPage();
        //            CaseCONTPdf(document);
        //        }
        //    }

        //    if (Selection.Contains("A") || Selection.Contains("R"))//if (((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "A" || ((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "R")
        //    {
        //        if (Actrefslist.Count > 0)
        //        {
        //            document.SetPageSize(iTextSharp.text.PageSize.A4);
        //            if (Selection == "A")
        //                document.NewPage();
        //            ACTREFSPdf(document);
        //        }
        //    }
        //    if (Selection.Contains("A") || Selection.Contains("M"))//if (((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "A" || ((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "M")
        //    {
        //        if (MATAList.Count > 0)
        //        {
        //            document.SetPageSize(iTextSharp.text.PageSize.A4);
        //            if (Selection == "A")
        //                document.NewPage();
        //            MATASMTPdf(document);
        //        }
        //    }


        //    if (Selection.Contains("A") || Selection.Contains("L"))//if (((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "A" || ((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "L")
        //    {
        //        if (LPBList.Count > 0)
        //        {
        //            document.SetPageSize(iTextSharp.text.PageSize.A4);
        //            if (Selection == "A")
        //                document.NewPage();
        //            LiheapList(document);
        //        }
        //    }

        //    if (Acr_State == "TX")
        //    {
        //        if (Selection.Contains("A") || Selection.Contains("E"))//if (((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "A" || ((Captain.Common.Utilities.ListItem)cmbSelect.SelectedItem).Value.ToString() == "E")
        //        {
        //            if (EMSRESList.Count > 0)
        //            {
        //                document.SetPageSize(iTextSharp.text.PageSize.A4);
        //                if (Selection == "A")
        //                    document.NewPage();
        //                EMSRESPdf(document);
        //            }
        //        }
        //    }

        //    if (Count == 0 && Selection != "A")
        //        document.Add(new Paragraph("No Records Found............................................... "));

        //    document.Close();
        //    fs.Close();
        //    fs.Dispose();

        //    FrmViewer objfrm = new FrmViewer(PdfName);
        //    objfrm.FormClosed += new Form.FormClosedEventHandler(On_Delete_PDF_File);
        //    objfrm.ShowDialog();

        //}

        private List<CommonEntity> filterByHIE(List<CommonEntity> LookupValues, string Mode)
        {
            string AGY = GvwAppHou.SelectedRows[0].Cells["Grd_Agy"].Value.ToString();
            string Dept = GvwAppHou.SelectedRows[0].Cells["Grd_Dept"].Value.ToString();
            string Prog = GvwAppHou.SelectedRows[0].Cells["Grd_Prog"].Value.ToString();
            string Year = GvwAppHou.SelectedRows[0].Cells["Grd_Year"].Value.ToString();
            string App = GvwAppHou.SelectedRows[0].Cells["Grd_App"].Value.ToString();
            string HIE = AGY + Dept + Prog;
            List<CommonEntity> _AgytabsFilter = new List<CommonEntity>();
            _AgytabsFilter = LookupValues;
            if (LookupValues.Count > 0)
            {

                if (Mode.ToUpper() == "ADD")
                {
                    _AgytabsFilter = _AgytabsFilter.FindAll(u => (u.ListHierarchy.Contains(HIE) || u.ListHierarchy.Contains(AGY + Dept + "**") || u.ListHierarchy.Contains(AGY + "****") || u.ListHierarchy.Contains("******")) && u.Active.ToString().ToUpper() == "Y").ToList();
                }
                else
                {
                    _AgytabsFilter = _AgytabsFilter.FindAll(u => u.ListHierarchy.Contains(HIE) || u.ListHierarchy.Contains(AGY + Dept + "**") || u.ListHierarchy.Contains(AGY + "****") || u.ListHierarchy.Contains("******")).ToList();
                }

                _AgytabsFilter = _AgytabsFilter.OrderByDescending(u => u.Active).ThenBy(u => u.Desc).ToList();
            }

            return _AgytabsFilter;
        }

        private void On_Delete_PDF_File(object sender, FormClosedEventArgs e)
        {
            if (PdfCont.Contains("I"))
            {
                PdfName = "I" + BaseForm.BaseApplicationNo + ".pdf";
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                System.IO.File.Delete(PdfName);
            }
            if (PdfCont.Contains("S"))
            {
                PdfName = "S" + BaseForm.BaseApplicationNo + ".pdf";
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                System.IO.File.Delete(PdfName);
            }
            if (PdfCont.Contains("C"))
            {
                PdfName = "C" + BaseForm.BaseApplicationNo + ".pdf";
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                System.IO.File.Delete(PdfName);
            }
            if (PdfCont.Contains("R"))
            {
                PdfName = "R" + BaseForm.BaseApplicationNo + ".pdf";
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                System.IO.File.Delete(PdfName);
            }
            if (PdfCont.Contains("M"))
            {
                PdfName = "M" + BaseForm.BaseApplicationNo + ".pdf";
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                System.IO.File.Delete(PdfName);
            }
            if (PdfCont.Contains("L"))
            {
                PdfName = "L" + BaseForm.BaseApplicationNo + ".pdf";
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                System.IO.File.Delete(PdfName);
            }
            if (PdfCont.Contains("E"))
            {
                PdfName = "E" + BaseForm.BaseApplicationNo + ".pdf";
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                System.IO.File.Delete(PdfName);
            }
            //System.IO.File.Delete(PdfName);
        }

        #region Casemanagement Application
        private void ClientIntakeForm(string AGY, string Dept, string Prog, string Year, string App)
        {
            Random_Filename = null;

            PdfName = "I" + BaseForm.BaseApplicationNo.ToString(); //form.GetFileName();
            PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
            try
            {
                if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
            }
            catch (Exception ex)
            {
                CommonFunctions.MessageBoxDisplay("Error");
            }


            try
            {
                string Tmpstr = PdfName + ".pdf";
                if (File.Exists(Tmpstr))
                    File.Delete(Tmpstr);
            }
            catch (Exception ex)
            {
                int length = 8;
                string newFileName = System.Guid.NewGuid().ToString();
                newFileName = newFileName.Replace("-", string.Empty);

                Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
            }

            if (!string.IsNullOrEmpty(Random_Filename))
                PdfName = Random_Filename;
            else
                PdfName += ".pdf";

            FileStream fs = new FileStream(PdfName, FileMode.Create);

            Document document = new Document();
            document.SetPageSize(iTextSharp.text.PageSize.LETTER.Rotate());
            PdfWriter writer = PdfWriter.GetInstance(document, fs);
            document.Open();

            cb = writer.DirectContent;

            BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
            iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
            BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
            iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(bf_times, 9, 4);
            BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

            iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
            iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
            iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
            iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(bf_times, 9, 1);
            iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
            iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);


            //Agency Control Table
            string Attention = string.Empty;
            DataSet ds = Captain.DatabaseLayer.ADMNB001DB.ADMNB001_Browse_AGCYCNTL("00", null, null, null, null, null, null);
            if (ds != null && ds.Tables[0].Rows.Count > 0)
                Attention = ds.Tables[0].Rows[0]["ACR_03_ATTESTATION"].ToString().Trim();

            //Mst Details Table
            //DataSet dsCaseMST = DatabaseLayer.CaseSnpData.GetCaseMST(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, BaseForm.BaseYear, BaseForm.BaseApplicationNo);
            //DataRow drCaseMST = dsCaseMST.Tables[0].Rows[0];

            ////Snp details Table
            //DataSet dsCaseSNP = DatabaseLayer.CaseSnpData.GetCaseSnpDetails(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, BaseForm.BaseYear, BaseForm.BaseApplicationNo, null);
            //if (dsCaseSNP.Tables.Count > 0)
            //    dtCaseSNP = dsCaseSNP.Tables[0];

            //Casesite Table
            List<CaseSiteEntity> SiteList = new List<CaseSiteEntity>();
            CaseSiteEntity Search_Site = new CaseSiteEntity(true);
            Search_Site.SiteAGENCY = AGY; Search_Site.SiteNUMBER = CASEMSTList[0].Site;
            Search_Site.SiteROOM = "0000";
            SiteList = _model.CaseMstData.Browse_CASESITE(Search_Site, "Browse");

            ////Services Table
            //List<CaseMSTSER> MSTSER_List = new List<CaseMSTSER>();
            //CaseMSTSER Search_MSTSER = new CaseMSTSER(true);
            //Search_MSTSER.Agency = BaseForm.BaseAgency; Search_MSTSER.Dept = BaseForm.BaseDept; Search_MSTSER.Program = BaseForm.BaseProg;
            //Search_MSTSER.Year = BaseForm.BaseYear; Search_MSTSER.AppNo = BaseForm.BaseApplicationNo;
            //MSTSER_List = _model.CaseMstData.Browse_MSTSER(Search_MSTSER, "Browse");

            ////AddCust Table
            //List<AddCustEntity> ADDCUST_List = new List<AddCustEntity>();
            //AddCustEntity Search_AddCust = new AddCustEntity(true);
            //Search_AddCust.ACTAGENCY = BaseForm.BaseAgency; Search_AddCust.ACTDEPT = BaseForm.BaseDept; Search_AddCust.ACTPROGRAM = BaseForm.BaseProg;
            //Search_AddCust.ACTYEAR = BaseForm.BaseYear; Search_AddCust.ACTAPPNO = BaseForm.BaseApplicationNo;
            //ADDCUST_List = _model.CaseMstData.Browse_ADDCUST(Search_AddCust, "Browse");

            ////CUSTFLDS Table for custom Questions
            //List<CustfldsEntity> custQues_List = new List<CustfldsEntity>();
            //CustfldsEntity Search_CustQues = new CustfldsEntity(true);
            //custQues_List = _model.SPAdminData.Browse_CUSTFLDS(Search_CustQues, "Browse");

            //List<CustRespEntity> custResp_List = new List<CustRespEntity>();
            //CustRespEntity Search_CustResp = new CustRespEntity(true);
            //Search_CustResp.ScrCode = "CASE2001";
            //custResp_List = _model.FieldControls.Browse_CUSTRESP(Search_CustResp, "Browse");

            //CaseHie Table
            DataSet dsCaseHie = DatabaseLayer.ADMNB001DB.ADMNB001_GetCashie("**-**-**", BaseForm.UserID, BaseForm.BaseAdminAgency, string.Empty);
            DataTable dtCaseHie = dsCaseHie.Tables[0];

            //Getting CaseWorker
            DataSet dsVerifier = DatabaseLayer.CaseMst.GetCaseWorker("I", AGY, Dept, Prog);
            DataTable dtVerifier = dsVerifier.Tables[0];

            ////CaseIncome Table
            //DataSet dsCaseIncome = DatabaseLayer.CaseMst.GetCASEINCOME(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, BaseForm.BaseYear, BaseForm.BaseApplicationNo);
            //DataTable dtCaseIncome = dsCaseIncome.Tables[0];
            DataSet dsIncome = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.INCOMETYPES);

            DataSet dsCaseDiff = DatabaseLayer.CaseMst.GetCASEDiffadpya(AGY, Dept, Prog, Year, App);
            DataTable dtCasediff = dsCaseDiff.Tables[0];

            ////CHLDMST Table
            //ChldMstEntity chldMstDetails = _model.ChldMstData.GetChldMstDetails(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, BaseForm.BaseYear, BaseForm.BaseApplicationNo, string.Empty);

            ////CHLDEMER TABLE
            //List<ChldMstEMEMEntitty> chldEmemDetails = _model.ChldMstData.GetChldEmemList(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, BaseForm.BaseYear, BaseForm.BaseApplicationNo, string.Empty);
            //CaseCondEntitty caseconddet = _model.ChldMstData.GetCaseCondDetails(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, BaseForm.BaseYear, BaseForm.BaseApplicationNo, string.Empty);

            AGYTABSEntity searchAgytabs = new AGYTABSEntity(true);
            searchAgytabs.Tabs_Type = "S0060";  //List<AGYTABSEntity> TransportList = AgyTabs_List.FindAll(u => u.Tabs_Type.ToString().Trim().Equals("S0041"));
            List<AGYTABSEntity> AgyTabs_List = _model.AdhocData.Browse_AGYTABS(searchAgytabs);

            DataSet Relations = DatabaseLayer.AgyTab.GetAgyTabDetails(Consts.AgyTab.RELATIONSHIP);
            //DataTable dtrelation = Relations.Tables[0];
            List<CommonEntity> commonEntity = new List<CommonEntity>();
            if (Relations != null && Relations.Tables[0].Rows.Count > 0)
            {
                foreach (DataRow dr in Relations.Tables[0].Rows)
                    commonEntity.Add(new CommonEntity(dr["AGY_1"].ToString(), dr["Agy_8"].ToString(), dr["AGY_2"].ToString()));
            }

            CommonEntity MotherEntity = new CommonEntity(); List<CommonEntity> FatherEntity = new List<CommonEntity>();
            if (commonEntity.Count > 0)
            {
                MotherEntity = commonEntity.Find(u => u.Hierarchy.Equals("G1"));
                FatherEntity = commonEntity.FindAll(u => u.Hierarchy.Equals("G2"));
            }

            List<CommonEntity> lookInsuranceCategory = _model.lookupDataAccess.GetInsuranceCategory();

            DataSet dsFUND = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.CASEMNGMTFUNDSRC, "A");
            DataTable dtFUND = dsFUND.Tables[0];

            cb.BeginText();
            X_Pos = 400; Y_Pos = 580;
            cb.SetFontAndSize(bf_helv, 13);
            //cb.SetColorFill(BaseColor.BLUE.Darker());
            string Header_Desc = string.Empty; string Form_Selection = string.Empty;

            //if (Privileges.ModuleCode == "03")
            //{
            string ShortName = string.Empty;
            string AgencyName = string.Empty; string SerHie = "N";

            if (ds != null && ds.Tables[0].Rows.Count > 0)
            {
                ShortName = ds.Tables[0].Rows[0]["ACR_SHORT_NAME"].ToString().Trim();
                if (ds.Tables[0].Rows[0]["ACR_SERVINQ_CASEHIE"].ToString().Trim() == "1") SerHie = "Y"; else SerHie = "N";

            }


            if (dtCaseHie.Rows.Count > 0)
            {
                foreach (DataRow drCasehie in dtCaseHie.Rows)
                {
                    if (drCasehie["Code"].ToString().Trim() == AGY + Dept + Prog)
                    {
                        AgencyName = drCasehie["HIE_NAME"].ToString().Trim(); break;
                    }
                }

                cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, ShortName + " - CLIENT INTAKE", X_Pos, Y_Pos - 25, 0);
                Header_Desc = ShortName + " - INTAKE APPLICATION";
                Form_Selection = AgencyName;//"Casemanagement Application";

                //cb.SetFontAndSize(bf_helv, 9);
                //cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Applicant No: ", 30, Y_Pos - 40, 0);
                //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(BaseForm.BaseApplicationNo, Timesline), 30 + 72, Y_Pos-40, 0);

                cb.SetFontAndSize(bf_helv, 13);
                cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Form_Selection, X_Pos, Y_Pos - 40, 0);
            }

            cb.SetFontAndSize(bf_helv, 9);
            //cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Date Printed: ", 740, Y_Pos - 40, 0);
            //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase(LookupDataAccess.Getdate(DateTime.Now.ToShortDateString()), Times), 780, Y_Pos - 40, 0);
            X_Pos = 30; Y_Pos -= 55;


            #region Comment block
            //}
            //else if (Privileges.ModuleCode == "02")
            //{
            //    string ShortName = string.Empty;
            //    if (dtCaseHie.Rows.Count > 0)
            //    {
            //        foreach (DataRow drCasehie in dtCaseHie.Rows)
            //        {
            //            if (drCasehie["Code"].ToString() == BaseForm.BaseAgency + BaseForm.BaseDept + BaseForm.BaseProg)
            //            {
            //                ShortName = drCasehie["HIE_SHORT_NAME"].ToString().Trim(); break;
            //            }
            //        }
            //        cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, ShortName + "  EARLY CARE & EDUCATION ", X_Pos, Y_Pos - 25, 0);
            //        Header_Desc = ShortName + "  EARLY CARE & EDUCATION ";

            //            Form_Selection = "CASE MANAGEMENT APPLICATION";

            //        cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Form_Selection, X_Pos, Y_Pos - 40, 0);

            //    }

            //    cb.SetFontAndSize(bf_helv, 9);
            //    X_Pos = 30; Y_Pos -= 50;
            //}
            //else //if (Privileges.ModuleCode == "05" )
            //{
            //    cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, "Application For Assistance", X_Pos, Y_Pos, 0);
            //    cb.SetFontAndSize(bf_helv, 9);
            //    cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "OFFICE USE ONLY ________________________________", 780, Y_Pos, 0);
            //    string SiteName = null, Site_city = null, Site_street = null, Site_state = null; string Site_zipcode = null;
            //    Header_Desc = "Application For Assistance";
            //    //To dispalying the Programme Address
            //    if (SiteList.Count > 0)
            //    {
            //        //drCaseSite = dsCaseSite.Tables[0].Rows[0];

            //        if (!string.IsNullOrEmpty(SiteList[0].SiteNAME.Trim()))
            //            SiteName = SiteList[0].SiteNAME.Trim();
            //        if (!string.IsNullOrEmpty(SiteList[0].SiteSTREET.Trim()))
            //            Site_street = "," + SiteList[0].SiteSTREET.Trim();
            //        if (!string.IsNullOrEmpty(SiteList[0].SiteCITY.Trim()))
            //            Site_city = "," + SiteList[0].SiteCITY.Trim();
            //        if (!string.IsNullOrEmpty(SiteList[0].SiteSTATE.Trim()))
            //            Site_state = "," + SiteList[0].SiteSTATE.Trim();
            //        if (SiteList[0].SiteZIP.Trim() != "0")
            //            Site_zipcode = "," + SiteList[0].SiteZIP.Trim();
            //    }
            //    cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, SiteName + Site_street + Site_city + Site_state + Site_zipcode, X_Pos, Y_Pos - 13, 0);
            //    cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "CABA# ___________________________________________", 780, Y_Pos - 13, 0);

            //    //To Print the Verifier Name on Application
            //    string Intake_Worker = null;
            //    if (dtVerifier.Rows.Count > 0)
            //    {
            //        foreach (DataRow drVerifier in dtVerifier.Rows)
            //        {
            //            if (drCaseMST["MST_INTAKE_WORKER"].ToString().Trim() == drVerifier["PWH_CASEWORKER"].ToString().Trim())
            //            {
            //                Intake_Worker = drVerifier["NAME"].ToString().Trim();
            //                break;
            //            }
            //        }
            //    }
            //    if (!string.IsNullOrEmpty(Intake_Worker))
            //        cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Intake_Worker, X_Pos, Y_Pos - 26, 0);
            //    else
            //        cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, "  ", X_Pos, Y_Pos - 26, 0);
            //    cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Search Results ______________________________________", 780, Y_Pos - 26, 0);
            //    cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "___________________________________________________", 780, Y_Pos - 39, 0);
            //    cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "___________________________________________________", 780, Y_Pos - 52, 0);
            //    cb.SetFontAndSize(bf_helv, 9);
            //    X_Pos = 30; Y_Pos -= 72;
            //}

            //cb.SetFontAndSize(bf_helv, 9);
            //X_Pos = 30; Y_Pos -= 72;



            //cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Date: ", 740, Y_Pos, 0);
            //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase(LookupDataAccess.Getdate(DateTime.Now.ToShortDateString()), Timesline), 780, Y_Pos, 0);

            ////Y_Pos -= 13;
            #endregion

            cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Applicant No: ", X_Pos, Y_Pos, 0);
            cb.EndText();
            ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(App, Timesline), X_Pos + 72, Y_Pos, 0);
            cb.BeginText();
            cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Date Printed: ", 700, Y_Pos, 0);
            cb.EndText();
            ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase(DateTime.Now.ToString("g"), Timesline), 780, Y_Pos, 0);
            cb.BeginText();
            Y_Pos -= 15;
            cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Applicant Name   ", X_Pos, Y_Pos, 0);
            cb.EndText();
            ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(BaseForm.BaseApplicationName, Timesline), X_Pos + 72, Y_Pos, 0);
            cb.BeginText();
            cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Application Date: ", 720, Y_Pos, 0);
            cb.EndText();
            if (!string.IsNullOrEmpty(CASEMSTList[0].IntakeDate.Trim()))
                ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase(LookupDataAccess.Getdate(CASEMSTList[0].IntakeDate.Trim()), Timesline), 780, Y_Pos, 0);
            else
                ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase("____________", Times), 780, Y_Pos, 0);

            //Y_Pos -= 13;
            //if (Privileges.ModuleCode == "05" || gvApp.CurrentRow.Cells["AppDet"].Value.ToString() == "Application for Assistance")
            //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Are you a citizen or naturalized Alien?", X_Pos, Y_Pos, 0);
            //else
            //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Do you have a disability and need an accommdation or special help to complete this application?", X_Pos, Y_Pos, 0);

            /************************************CheckBoxes****************************/
            iTextSharp.text.Rectangle rect = new iTextSharp.text.Rectangle(806, 40, 788, 60);
            PdfAppearance[] onOff = new PdfAppearance[2];
            onOff[0] = cb.CreateAppearance(20, 20);
            onOff[0].Rectangle(1, 20, 1, 20);
            onOff[0].Rectangle(18, 18, 1, 1);
            onOff[0].Stroke();
            onOff[1] = cb.CreateAppearance(20, 20);
            onOff[1].SetRGBColorFill(255, 128, 128);
            onOff[1].Rectangle(18, 18, 1, 1);
            onOff[1].FillStroke();
            onOff[1].MoveTo(1, 1);
            onOff[1].LineTo(19, 19);
            onOff[1].MoveTo(1, 19);
            onOff[1].LineTo(19, 1);

            RadioCheckField checkbox;
            PdfFormField SField;
            //if (Privileges.ModuleCode == "05" || gvApp.CurrentRow.Cells["AppDet"].Value.ToString() == "Application for Assistance")
            //{
            //    rect = new iTextSharp.text.Rectangle(190, Y_Pos + 8, 198, Y_Pos);
            //    //rect.Rotate();
            //    checkbox = new RadioCheckField(writer, rect, "Yes", "On");
            //    checkbox.BorderColor = new GrayColor(0.3f);
            //    checkbox.Rotation = 90;
            //    SField = checkbox.CheckField;
            //    writer.AddAnnotation(SField);
            //    ColumnText.ShowTextAligned(cb, Element.ALIGN_LEFT, new Phrase("Yes", Times), 200, Y_Pos, 0);
            //    rect = new iTextSharp.text.Rectangle(220, Y_Pos + 8, 228, Y_Pos);
            //    checkbox = new RadioCheckField(writer, rect, "No", "On");
            //    checkbox.BorderColor = new GrayColor(0.3f);
            //    checkbox.Rotation = 90;
            //    SField = checkbox.CheckField;
            //    writer.AddAnnotation(SField);
            //    ColumnText.ShowTextAligned(cb, Element.ALIGN_LEFT, new Phrase("No", Times), 230, Y_Pos, 0);

            //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "If no, are you a qualified Alien??", 320, Y_Pos, 0);

            //    rect = new iTextSharp.text.Rectangle(450, Y_Pos + 8, 458, Y_Pos);
            //    //rect.Rotate();
            //    checkbox = new RadioCheckField(writer, rect, "SecondYes", "On");
            //    checkbox.BorderColor = new GrayColor(0.3f);
            //    checkbox.Rotation = 90;
            //    SField = checkbox.CheckField;
            //    writer.AddAnnotation(SField);
            //    ColumnText.ShowTextAligned(cb, Element.ALIGN_LEFT, new Phrase("Yes", Times), 460, Y_Pos, 0);
            //    rect = new iTextSharp.text.Rectangle(480, Y_Pos + 8, 488, Y_Pos);
            //    checkbox = new RadioCheckField(writer, rect, "SecondNo", "On");
            //    checkbox.BorderColor = new GrayColor(0.3f);
            //    checkbox.Rotation = 90;
            //    SField = checkbox.CheckField;
            //    writer.AddAnnotation(SField);
            //    ColumnText.ShowTextAligned(cb, Element.ALIGN_LEFT, new Phrase("No", Times), 490, Y_Pos, 0);
            //}
            //else
            //{
            //    rect = new iTextSharp.text.Rectangle(390, Y_Pos + 8, 398, Y_Pos);
            //    //rect.Rotate();
            //    checkbox = new RadioCheckField(writer, rect, "SecondYes", "On");
            //    checkbox.BorderColor = new GrayColor(0.3f);
            //    checkbox.Rotation = 90;
            //    SField = checkbox.CheckField;
            //    writer.AddAnnotation(SField);
            //    ColumnText.ShowTextAligned(cb, Element.ALIGN_LEFT, new Phrase("Yes", Times), 400, Y_Pos, 0);
            //    rect = new iTextSharp.text.Rectangle(420, Y_Pos + 8, 428, Y_Pos);
            //    checkbox = new RadioCheckField(writer, rect, "SecondNo", "On");
            //    checkbox.BorderColor = new GrayColor(0.3f);
            //    checkbox.Rotation = 90;
            //    SField = checkbox.CheckField;
            //    writer.AddAnnotation(SField);
            //    ColumnText.ShowTextAligned(cb, Element.ALIGN_LEFT, new Phrase("No", Times), 430, Y_Pos, 0);
            //}
            X_Pos = 30; Y_Pos -= 13;
            //cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Applicant Name   ", X_Pos, Y_Pos, 0);
            //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(BaseForm.BaseApplicationName, Timesline), X_Pos + 72, Y_Pos, 0);
            //string Zip = string.Empty;
            //if (!string.IsNullOrEmpty(drCaseMST["MST_ZIP"].ToString().Trim()))
            //    Zip = "00000".Substring(0, 5 - drCaseMST["MST_ZIP"].ToString().Trim().Length) + drCaseMST["MST_ZIP"].ToString().Trim();
            cb.BeginText();
            cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Address ", X_Pos, Y_Pos, 0);
            cb.EndText();
            string Apt = string.Empty; string Floor = string.Empty; string HN = string.Empty; string Suffix = string.Empty; string Street = string.Empty;
            string Zip = string.Empty;
            if (!string.IsNullOrEmpty(CASEMSTList[0].Apt.Trim()))
                Apt = ", Apt  " + CASEMSTList[0].Apt.Trim() + "   ";
            if (!string.IsNullOrEmpty(CASEMSTList[0].Flr.Trim()))
                Floor = "Flr  " + CASEMSTList[0].Flr.Trim() + "   ";
            if (!string.IsNullOrEmpty(CASEMSTList[0].Street.Trim()))
                Street = CASEMSTList[0].Street.Trim() + " ";
            if (!string.IsNullOrEmpty(CASEMSTList[0].Suffix.Trim()))
                Suffix = ", " + CASEMSTList[0].Suffix.Trim();
            if (!string.IsNullOrEmpty(CASEMSTList[0].Hn.Trim()))
                HN = CASEMSTList[0].Hn.Trim() + " ";
            if (!string.IsNullOrEmpty(CASEMSTList[0].Zip.Trim()) && CASEMSTList[0].Zip != "0")
                Zip = "00000".Substring(0, 5 - CASEMSTList[0].Zip.Trim().Length) + CASEMSTList[0].Zip.Trim();
            string Comma = string.Empty;
            if (!string.IsNullOrEmpty(CASEMSTList[0].Suffix.ToString().Trim()) && (!string.IsNullOrEmpty(CASEMSTList[0].Apt.ToString().Trim()) || !string.IsNullOrEmpty(CASEMSTList[0].Flr.ToString().Trim())))
                Comma = ", ";

            string Address = HN + Street + Suffix + Apt + Floor + ", " + CASEMSTList[0].City.Trim() + ", " + CASEMSTList[0].State.Trim() + " " + Zip;
            ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(Address, Timesline), X_Pos + 72, Y_Pos, 0);

            string Language = null;
            DataSet dsLang = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.LANGUAGECODES);
            DataTable dtLang = dsLang.Tables[0];
            foreach (DataRow drLang in dtLang.Rows)
            {
                if (CASEMSTList[0].Language.Trim() == drLang["Code"].ToString().Trim())
                {
                    Language = drLang["LookUpDesc"].ToString().Trim(); break;
                }
            }
            cb.BeginText();
            cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Primary Language ", 400, Y_Pos, 0); //380 changed on 05/22/2017
            cb.EndText();
            ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(Language, Timesline), 470, Y_Pos, 0);
            if (!string.IsNullOrEmpty(CASEMSTList[0].Site.Trim()))
            {
                DataSet dsSITE = DatabaseLayer.CaseMst.GetSITEDESC(AGY, CASEMSTList[0].Site);
                DataRow drSITE = dsSITE.Tables[0].Rows[0];
                string Site_Name = null;
                cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Site : ", 640, Y_Pos, 0);
                Site_Name = drSITE["SiteName"].ToString().Trim();
                //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(Site_Name, Timesline), 650, Y_Pos, 0);
                ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(CASEMSTList[0].Site, Timesline), 650, Y_Pos, 0);
            }
            else
            {
                cb.BeginText();
                cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Site : ", 640, Y_Pos, 0);
                cb.EndText();
                cb.SetLineWidth(0.5f);
                //cb.SetLineCap(5);
                cb.MoveTo(650, Y_Pos - 2);
                cb.LineTo(705, Y_Pos - 2);
                cb.Stroke();
            }
            Y_Pos -= 13;
            //cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Address ", X_Pos, Y_Pos, 0);
            //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(drCaseMST["MST_HN"].ToString().Trim() + " " + drCaseMST["MST_STREET"].ToString().Trim() + "," + drCaseMST["MST_CITY"].ToString().Trim() + "," + drCaseMST["MST_STATE"].ToString().Trim() + "," + drCaseMST["MST_ZIP"].ToString().Trim(), Timesline), X_Pos + 72, Y_Pos, 0);
            cb.BeginText();
            cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Mailing Address", X_Pos, Y_Pos, 0);
            cb.EndText();
            string House_NO = null, Street1 = null, city = null, state = null, zip = null, DApt = null; string DSuffix = string.Empty;
            if (dtCasediff.Rows.Count > 0)
            {
                foreach (DataRow drCaseDiff in dtCasediff.Rows)
                {
                    if (!string.IsNullOrEmpty(drCaseDiff["DIFF_HN"].ToString().Trim()))
                        House_NO = drCaseDiff["DIFF_HN"].ToString().Trim() + " ";
                    if (!string.IsNullOrEmpty(drCaseDiff["DIFF_APT"].ToString().Trim()))
                        DApt = drCaseDiff["DIFF_APT"].ToString().Trim() + " ";
                    if (!string.IsNullOrEmpty(drCaseDiff["DIFF_SUFFIX"].ToString().Trim()))
                        DSuffix = " " + drCaseDiff["DIFF_SUFFIX"].ToString().Trim();
                    if (!string.IsNullOrEmpty(drCaseDiff["DIFF_STREET"].ToString().Trim()))
                        Street1 = drCaseDiff["DIFF_STREET"].ToString().Trim() + DSuffix + ",";
                    if (!string.IsNullOrEmpty(drCaseDiff["DIFF_CITY"].ToString().Trim()))
                        city = drCaseDiff["DIFF_CITY"].ToString().Trim() + ",";
                    if (!string.IsNullOrEmpty(drCaseDiff["DIFF_STATE"].ToString().Trim()))
                        state = drCaseDiff["DIFF_STATE"].ToString().Trim();
                    if (!string.IsNullOrEmpty(drCaseDiff["DIFF_ZIP"].ToString().Trim()))
                        zip = "00000".Substring(0, 5 - drCaseDiff["DIFF_ZIP"].ToString().Trim().Length) + drCaseDiff["DIFF_ZIP"].ToString().Trim();
                    if (zip == "00000") zip = ""; else zip = ", " + zip;
                }
                ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(House_NO + Street1 + DApt + city + state + zip, Timesline), X_Pos + 72, Y_Pos, 0);
            }
            else
            {
                //cb.SetLineWidth(0.5f);
                ////cb.SetLineCap(5);
                //cb.MoveTo(X_Pos + 72, Y_Pos);
                //cb.LineTo(210, Y_Pos);
                //cb.Stroke();
                //string Apt = string.Empty; string Floor = string.Empty; string HN = string.Empty; string Suffix = string.Empty; string Street = string.Empty;
                //string Zip = string.Empty;
                if (!string.IsNullOrEmpty(CASEMSTList[0].Apt.Trim()))
                    Apt = "Apt  " + CASEMSTList[0].Apt.Trim() + "   ";
                if (!string.IsNullOrEmpty(CASEMSTList[0].Flr.Trim()))
                    Floor = "Flr  " + CASEMSTList[0].Flr.Trim() + "   ";
                if (!string.IsNullOrEmpty(CASEMSTList[0].Street.Trim()))
                    Street = CASEMSTList[0].Street.Trim() + " ";
                if (!string.IsNullOrEmpty(CASEMSTList[0].Suffix.Trim()))
                    Suffix = CASEMSTList[0].Suffix.Trim() + ", ";
                if (!string.IsNullOrEmpty(CASEMSTList[0].Hn.Trim()))
                    HN = CASEMSTList[0].Hn.Trim() + " ";
                if (!string.IsNullOrEmpty(CASEMSTList[0].Zip.Trim()) && CASEMSTList[0].Zip != "0")
                    Zip = "00000".Substring(0, 5 - CASEMSTList[0].Zip.Trim().Length) + CASEMSTList[0].Zip.Trim();

                Address = HN + Street + Suffix + Apt + Floor + ", " + CASEMSTList[0].City.Trim() + ", " + CASEMSTList[0].State.Trim() + " " + Zip;

                ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(Address, Timesline), X_Pos + 72, Y_Pos, 0);
            }


            if (!string.IsNullOrEmpty(CASEMSTList[0].Email.Trim()))
            {
                ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase("Email : ", Times), 400, Y_Pos, 0);//380 changed on 05/22/2017
                ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(CASEMSTList[0].Email.Trim(), Timesline), 430, Y_Pos, 0);
            }
            else
            {
                cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Email", 400, Y_Pos, 0); //380 changed on 05/22/2017
                cb.SetLineWidth(0.5f);
                //cb.SetLineCap(5);
                cb.MoveTo(430, Y_Pos);
                cb.LineTo(520, Y_Pos);
                cb.Stroke();
            }
            cb.BeginText();
            cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Home Telephone ", 640, Y_Pos, 0);
            cb.EndText();
            MaskedTextBox mskPhn = new MaskedTextBox();
            mskPhn.Mask = "(000)000-0000";
            mskPhn.Text = CASEMSTList[0].Area + CASEMSTList[0].Phone;   //"(" + drCaseMST["MST_AREA"].ToString() + ")" + drCaseMST["MST_PHONE"].ToString()
            ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(mskPhn.Text, Timesline), 650, Y_Pos, 0);
            Y_Pos -= 13;
            //cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Mailing Address", X_Pos, Y_Pos, 0);
            //string House_NO = null, Street = null, city = null, state = null, zip = null;
            //if (dtCasediff.Rows.Count > 0)
            //{
            //    foreach (DataRow drCaseDiff in dtCasediff.Rows)
            //    {
            //        if (!string.IsNullOrEmpty(drCaseDiff["DIFF_HN"].ToString().Trim()))
            //            House_NO = drCaseDiff["DIFF_HN"].ToString().Trim() + " ";
            //        if (!string.IsNullOrEmpty(drCaseDiff["DIFF_STREET"].ToString().Trim()))
            //            Street = drCaseDiff["DIFF_STREET"].ToString().Trim() + ",";
            //        if (!string.IsNullOrEmpty(drCaseDiff["DIFF_STREET"].ToString().Trim()))
            //            city = drCaseDiff["DIFF_STREET"].ToString().Trim() + ",";
            //        if (!string.IsNullOrEmpty(drCaseDiff["DIFF_STATE"].ToString().Trim()))
            //            state = drCaseDiff["DIFF_STATE"].ToString().Trim() + ",";
            //        zip = drCaseDiff["DIFF_ZIP"].ToString().Trim();
            //    }
            //    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(House_NO + Street + city + state + zip, Timesline), X_Pos + 72, Y_Pos, 0);
            //}
            //else
            //{
            //    //cb.SetLineWidth(0.5f);
            //    ////cb.SetLineCap(5);
            //    //cb.MoveTo(X_Pos + 72, Y_Pos);
            //    //cb.LineTo(210, Y_Pos);
            //    //cb.Stroke();
            //    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(drCaseMST["MST_HN"].ToString().Trim() + " " + drCaseMST["MST_STREET"].ToString().Trim() + "," + drCaseMST["MST_CITY"].ToString().Trim() + "," + drCaseMST["MST_STATE"].ToString().Trim() + "," + drCaseMST["MST_ZIP"].ToString().Trim(), Timesline), X_Pos + 72, Y_Pos, 0);
            //}
            cb.BeginText();
            cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Message Number", 400, Y_Pos, 0);//380 changed on 05/22/2017
            cb.EndText();
            if (!string.IsNullOrEmpty(CASEMSTList[0].MessagePhone.Trim()))
            {
                MaskedTextBox mskMessage = new MaskedTextBox();
                mskMessage.Mask = "(000)000-0000";
                mskMessage.Text = CASEMSTList[0].MessagePhone.Trim();
                ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(mskMessage.Text, Timesline), 470, Y_Pos, 0);
            }
            else
            {
                cb.SetLineWidth(0.5f);
                //cb.SetLineCap(5);
                cb.MoveTo(470, Y_Pos);
                cb.LineTo(505, Y_Pos);
                cb.Stroke();
            }
            cb.BeginText();
            cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Cell Number", 640, Y_Pos, 0);
            cb.EndText();
            if (!string.IsNullOrEmpty(CASEMSTList[0].CellPhone.Trim()))
            {
                MaskedTextBox mskCell = new MaskedTextBox();
                mskCell.Mask = "(000)000-0000";
                mskCell.Text = CASEMSTList[0].CellPhone.Trim();
                ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(mskCell.Text, Timesline), 650, Y_Pos, 0);
            }
            else
            {
                cb.SetLineWidth(0.5f);
                //cb.SetLineCap(5);
                cb.MoveTo(650, Y_Pos - 3);
                cb.LineTo(705, Y_Pos - 3);
                cb.Stroke();
            }

            //Y_Pos -= 13;
            //cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Message Number", 640, Y_Pos, 0);
            //if (!string.IsNullOrEmpty(drCaseMST["MST_MESSAGE_PHONE"].ToString().Trim()))
            //{
            //    MaskedTextBox mskMessage = new MaskedTextBox();
            //    mskMessage.Mask = "(000) 000-0000";
            //    mskMessage.Text = drCaseMST["MST_MESSAGE_PHONE"].ToString().Trim();
            //    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(mskMessage.Text, Timesline), 650, Y_Pos, 0);
            //}
            //else
            //{
            //    cb.SetLineWidth(0.5f);
            //    //cb.SetLineCap(5);
            //    cb.MoveTo(650, Y_Pos - 3);
            //    cb.LineTo(705, Y_Pos - 3);
            //    cb.Stroke();
            //}

            Y_Pos -= 8;
            SetLine();
            Y_Pos -= 20;
            cb.BeginText();
            cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Housing Situation", X_Pos, Y_Pos, 0);
            cb.EndText();
            DataSet dsHouseMain = Captain.DatabaseLayer.AgyTab.GetAgyTab(Consts.AgyTab.HOUSINGTYPES);
            string strMainData = dsHouseMain.Tables[0].Rows[0]["Agy_9"].ToString();
            string CodeColSubscript = string.Empty, DescColSubscript = string.Empty;
            if (!string.IsNullOrEmpty(dsHouseMain.Tables[0].Rows[0]["AGY_ACTIVE"].ToString().Trim()))
                CodeColSubscript = "AGY_" + dsHouseMain.Tables[0].Rows[0]["AGY_ACTIVE"].ToString().Trim();
            if (!string.IsNullOrEmpty(dsHouseMain.Tables[0].Rows[0]["AGY_DEFAULT"].ToString().Trim()))
                DescColSubscript = "AGY_" + dsHouseMain.Tables[0].Rows[0]["AGY_DEFAULT"].ToString().Trim();


            //DataSet dsHousing = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.HOUSINGTYPES);
            DataSet dsHousing = DatabaseLayer.AgyTab.GetAgyTabDetails(Consts.AgyTab.HOUSINGTYPES);
            DataTable dtHousing = dsHousing.Tables[0];
            PdfFormField Field;
            X_Pos = 140;
            string CheckTitle = string.Empty;
            foreach (DataRow drHousing in dtHousing.Rows)
            {
                if (drHousing["AGY_ACTIVE"].ToString() == "Y" ||
                    (drHousing["AGY_ACTIVE"].ToString() == "N" && !string.IsNullOrEmpty(CASEMSTList[0].Housing.Trim()) && CASEMSTList[0].Housing.Trim() == drHousing[CodeColSubscript].ToString().Trim()))
                {
                    rect = new iTextSharp.text.Rectangle(X_Pos, Y_Pos + 8, X_Pos + 8, Y_Pos);
                    checkbox = new RadioCheckField(writer, rect, drHousing[DescColSubscript].ToString().Trim(), "Yes");
                    checkbox.BorderColor = new GrayColor(0.3f);
                    checkbox.Rotation = 90;
                    checkbox.CheckType = RadioCheckField.TYPE_CHECK;
                    if (CASEMSTList[0].Housing.Trim().Trim() == drHousing[CodeColSubscript].ToString().Trim())
                        checkbox.Checked = true;
                    Field = checkbox.CheckField;
                    writer.AddAnnotation(Field);
                    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(drHousing[DescColSubscript].ToString().Trim(), Times), X_Pos + 10, Y_Pos, 0);
                    X_Pos += 90;
                    if (X_Pos > 600)
                    {
                        X_Pos = 140;
                        Y_Pos -= 13;
                    }
                }
            }

            Y_Pos -= 25; X_Pos = 30;
            cb.BeginText();
            cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Family Type", X_Pos, Y_Pos, 0);
            cb.EndText();
            X_Pos = 140;

            DataSet dsFamilyMain = Captain.DatabaseLayer.AgyTab.GetAgyTab(Consts.AgyTab.HOUSINGTYPES);
            strMainData = dsFamilyMain.Tables[0].Rows[0]["Agy_9"].ToString();
            CodeColSubscript = string.Empty; DescColSubscript = string.Empty;
            if (!string.IsNullOrEmpty(dsFamilyMain.Tables[0].Rows[0]["AGY_ACTIVE"].ToString().Trim()))
                CodeColSubscript = "AGY_" + dsFamilyMain.Tables[0].Rows[0]["AGY_ACTIVE"].ToString().Trim();
            if (!string.IsNullOrEmpty(dsFamilyMain.Tables[0].Rows[0]["AGY_DEFAULT"].ToString().Trim()))
                DescColSubscript = "AGY_" + dsFamilyMain.Tables[0].Rows[0]["AGY_DEFAULT"].ToString().Trim();

            //DataSet dsFamilyType = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.FAMILYTYPE);
            DataSet dsFamilyType = DatabaseLayer.AgyTab.GetAgyTabDetails(Consts.AgyTab.FAMILYTYPE);
            DataTable dtFamilyType = dsFamilyType.Tables[0];
            foreach (DataRow drFamilyType in dtFamilyType.Rows)
            {
                if (drFamilyType["AGY_ACTIVE"].ToString() == "Y" ||
                    (drFamilyType["AGY_ACTIVE"].ToString() == "N" && !string.IsNullOrEmpty(CASEMSTList[0].FamilyType.Trim()) && CASEMSTList[0].FamilyType.Trim() == drFamilyType[CodeColSubscript].ToString().Trim()))
                {
                    rect = new iTextSharp.text.Rectangle(X_Pos, Y_Pos + 8, X_Pos + 8, Y_Pos);
                    //checkbox = new RadioCheckField(writer, rect, "F" + drFamilyType["LookUpDesc"].ToString().Trim(), "On");
                    checkbox = new RadioCheckField(writer, rect, "F" + drFamilyType[DescColSubscript].ToString().Trim(), "Yes");
                    checkbox.BorderColor = new GrayColor(0.3f);
                    checkbox.Rotation = 90;
                    checkbox.CheckType = RadioCheckField.TYPE_CHECK;
                    if (CASEMSTList[0].FamilyType.Trim() == drFamilyType[CodeColSubscript].ToString().Trim())
                        checkbox.Checked = true;
                    Field = checkbox.CheckField;
                    writer.AddAnnotation(Field);
                    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(drFamilyType[DescColSubscript].ToString().Trim(), Times), X_Pos + 10, Y_Pos, 0);
                    X_Pos += 130;
                    if (X_Pos > 600)
                    {
                        Y_Pos -= 13;
                        X_Pos = 140;
                    }

                }
            }

            Y_Pos -= 25; X_Pos = 30;
            int Count = casesnpList.Count;
            int Adults = 0, Child = 0, under5 = 0;
            foreach (CaseSnpEntity drsnp in casesnpList)
            {
                if (!string.IsNullOrEmpty(drsnp.Age))
                {
                    if (int.Parse(drsnp.Age) >= 18)
                        Adults++;
                    else
                        Child++;
                    if (int.Parse(drsnp.Age) < 5)
                        under5++;
                }
            }
            cb.BeginText();
            cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Total No of Household Members: ", X_Pos, Y_Pos, 0);
            cb.EndText();
            ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(Count.ToString(), Timesline), X_Pos + 123, Y_Pos, 0);
            cb.BeginText();
            cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "No of Adults: ", 210, Y_Pos, 0);
            cb.EndText();
            ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(Adults.ToString(), Timesline), 260, Y_Pos, 0);
            cb.BeginText();
            cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "No of Children: ", 310, Y_Pos, 0);
            cb.EndText();
            ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(Child.ToString(), Timesline), 370, Y_Pos, 0);
            cb.BeginText();
            cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "No of Children under 5: ", 420, Y_Pos, 0);
            cb.EndText();
            ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(under5.ToString(), Timesline), 508, Y_Pos, 0);
            //cb.EndText();

            //Temp table not displayed on the screen
            PdfPTable head = new PdfPTable(1);
            head.HorizontalAlignment = Element.ALIGN_CENTER;
            head.TotalWidth = 50f;
            head.SpacingAfter = 270f;
            PdfPCell headcell = new PdfPCell(new Phrase(""));
            headcell.HorizontalAlignment = Element.ALIGN_CENTER;
            headcell.Border = iTextSharp.text.Rectangle.NO_BORDER;
            head.AddCell(headcell);

            #region To Print SNP Details in the Table
            PdfPTable Snp_Table = new PdfPTable(13);
            Snp_Table.TotalWidth = 750f;
            Snp_Table.WidthPercentage = 100;
            Snp_Table.LockedWidth = true;
            float[] widths = new float[] { 55f, 45f, 25f, 25f, 10f, 13f, 30f, 28f, 42f, 18f, 18f, 22f, 35f };// 30f, 25f, 18f, 18f, 20f, 25f, 30f, 20f, 25f, 18f, 18f, 22f };
            Snp_Table.SetWidths(widths);
            Snp_Table.HorizontalAlignment = Element.ALIGN_CENTER;
            //Snp_Table.SpacingBefore = 270f;

            PdfPCell Header = new PdfPCell(new Phrase("HOUSEHOLD MEMBERS Listing yourself first, complete all spaces below for ALL persons living in the home.", TblFontBold));
            Header.Colspan = 15;
            Header.FixedHeight = 15f;
            Header.BackgroundColor = BaseColor.LIGHT_GRAY;
            Header.Border = iTextSharp.text.Rectangle.BOX;
            Snp_Table.AddCell(Header);

            PdfPCell row2 = new PdfPCell(new Phrase(""));
            row2.Colspan = 9;
            row2.FixedHeight = 15f;
            row2.Border = iTextSharp.text.Rectangle.BOX;
            Snp_Table.AddCell(row2);

            PdfPCell row2_Health = new PdfPCell(new Phrase("Health", TableFontBoldItalic));
            row2_Health.HorizontalAlignment = Element.ALIGN_CENTER;
            row2_Health.FixedHeight = 15f;
            row2_Health.Border = iTextSharp.text.Rectangle.BOX;
            Snp_Table.AddCell(row2_Health);

            PdfPCell row2_Space = new PdfPCell(new Phrase(""));
            row2_Space.Colspan = 3;
            row2_Space.FixedHeight = 15f;
            row2_Space.Border = iTextSharp.text.Rectangle.BOX;
            Snp_Table.AddCell(row2_Space);

            //PdfPCell row3 = new PdfPCell(new Phrase(""));
            //row3.Colspan = 3;
            //row3.FixedHeight = 15f;
            //row3.Border = iTextSharp.text.Rectangle.BOX;
            //Snp_Table.AddCell(row3);

            PdfPCell row3 = new PdfPCell(new Phrase(""));
            row3.Colspan = 2;
            row3.FixedHeight = 15f;
            row3.Border = iTextSharp.text.Rectangle.BOX;
            Snp_Table.AddCell(row3);

            PdfPCell row3_SSN = new PdfPCell(new Phrase("Social", TableFontBoldItalic));
            row3_SSN.HorizontalAlignment = Element.ALIGN_CENTER;
            row3_SSN.FixedHeight = 15f;
            row3_SSN.Border = iTextSharp.text.Rectangle.TOP_BORDER + iTextSharp.text.Rectangle.LEFT_BORDER + iTextSharp.text.Rectangle.RIGHT_BORDER;
            Snp_Table.AddCell(row3_SSN);

            PdfPCell row3_Birth = new PdfPCell(new Phrase("BirthDate", TableFontBoldItalic));
            row3_Birth.HorizontalAlignment = Element.ALIGN_CENTER;
            row3_Birth.FixedHeight = 15f;
            row3_Birth.Border = iTextSharp.text.Rectangle.BOX;
            Snp_Table.AddCell(row3_Birth);

            PdfPCell row3_Space = new PdfPCell(new Phrase(""));
            //row3_Space.Colspan = 2;
            row3_Space.FixedHeight = 15f;
            row3_Space.Border = iTextSharp.text.Rectangle.BOX;
            Snp_Table.AddCell(row3_Space);

            PdfPCell row3_Sex = new PdfPCell(new Phrase("Sex", TableFontBoldItalic));
            row3_Sex.HorizontalAlignment = Element.ALIGN_CENTER;
            row3_Sex.FixedHeight = 15f;
            row3_Sex.Border = iTextSharp.text.Rectangle.BOX;
            Snp_Table.AddCell(row3_Sex);

            PdfPCell row3_Space2 = new PdfPCell(new Phrase(""));
            row3_Space2.Colspan = 3;
            row3_Space2.HorizontalAlignment = Element.ALIGN_CENTER;
            row3_Space2.FixedHeight = 15f;
            row3_Space2.Border = iTextSharp.text.Rectangle.BOX;
            Snp_Table.AddCell(row3_Space2);

            PdfPCell row3_Insurance = new PdfPCell(new Phrase("Insurance ", TableFontBoldItalic));
            row3_Insurance.HorizontalAlignment = Element.ALIGN_CENTER;
            row3_Insurance.FixedHeight = 15f;
            row3_Insurance.Border = iTextSharp.text.Rectangle.BOX;
            Snp_Table.AddCell(row3_Insurance);

            PdfPCell row3_Veteran = new PdfPCell(new Phrase("Veteran", TableFontBoldItalic));
            row3_Veteran.HorizontalAlignment = Element.ALIGN_CENTER;
            row3_Veteran.FixedHeight = 15f;
            row3_Veteran.Border = iTextSharp.text.Rectangle.BOX;
            Snp_Table.AddCell(row3_Veteran);

            PdfPCell row3_Receive_FS = new PdfPCell(new Phrase("Receive FS", TableFontBoldItalic));
            row3_Receive_FS.HorizontalAlignment = Element.ALIGN_CENTER;
            row3_Receive_FS.FixedHeight = 15f;
            row3_Receive_FS.Border = iTextSharp.text.Rectangle.BOX;
            Snp_Table.AddCell(row3_Receive_FS);

            PdfPCell row3_Space3 = new PdfPCell(new Phrase("", TableFontBoldItalic));
            row3_Space3.HorizontalAlignment = Element.ALIGN_CENTER;
            row3_Space3.FixedHeight = 15f;
            row3_Space3.Border = iTextSharp.text.Rectangle.BOX;
            Snp_Table.AddCell(row3_Space3);

            string[] col = { "Name (last, first, MI)", "Relationship to Applicant", "Security", "mm/dd/yyyy", "Age", "M/F", "Ethnicity", "Race", "Education", "Y/N", "Y/N", "Y/N", "Disabled" };
            for (int i = 0; i < col.Length; ++i)
            {
                PdfPCell cell = new PdfPCell(new Phrase(col[i], TableFontBoldItalic));
                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                cell.FixedHeight = 15f;
                if (i == 2) cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER + iTextSharp.text.Rectangle.LEFT_BORDER + iTextSharp.text.Rectangle.RIGHT_BORDER;
                else cell.Border = iTextSharp.text.Rectangle.BOX;
                Snp_Table.AddCell(cell);
            }

            int Tbl_Count = 0; string FamSeq = string.Empty;
            List<CaseSnpEntity> snplist = new List<CaseSnpEntity>();
            foreach (CaseSnpEntity entity in casesnpList)
            {
                if (CASEMSTList[0].FamilySeq == entity.FamilySeq)
                {
                    FamSeq = entity.FamilySeq.Trim();
                    string ApplicantName = entity.NameixLast + " " + entity.NameixFi + " " + entity.NameixMi;//snpEntity.NameixFi.Trim() + " " + snpEntity.NameixLast.Trim();
                    PdfPCell Name = new PdfPCell(new Phrase(ApplicantName, TableFont));
                    Name.HorizontalAlignment = Element.ALIGN_LEFT;
                    Name.FixedHeight = 15f;
                    Name.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(Name);

                    string Relation = null;
                    DataSet dsRelation = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.RELATIONSHIP);
                    DataTable dtRelation = dsRelation.Tables[0];
                    foreach (DataRow drRelation in dtRelation.Rows)
                    {
                        if (entity.MemberCode.Trim() == drRelation["Code"].ToString().Trim())
                        {
                            Relation = drRelation["LookUpDesc"].ToString().Trim(); break;
                        }
                    }
                    PdfPCell RelationShip = new PdfPCell(new Phrase(Relation, TableFont));
                    RelationShip.HorizontalAlignment = Element.ALIGN_LEFT;
                    RelationShip.FixedHeight = 15f;
                    RelationShip.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(RelationShip);
                    string SSNNum = null;
                    if (!string.IsNullOrEmpty(entity.Ssno.Trim()))
                        //SSNNum = drCaseSNP["SNP_SSNO"].ToString().Trim();
                        SSNNum = "xxx" + "-" + "xx" + "-" + entity.Ssno.Trim().Substring(5, 4);
                    PdfPCell SSN = new PdfPCell(new Phrase(SSNNum, TableFont));
                    SSN.HorizontalAlignment = Element.ALIGN_CENTER;
                    SSN.FixedHeight = 15f;
                    SSN.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(SSN);

                    string DOB = string.Empty;
                    if (!string.IsNullOrEmpty(entity.AltBdate))
                    {
                        DOB = CommonFunctions.ChangeDateFormat(entity.AltBdate.Trim(), Consts.DateTimeFormats.DateSaveFormat, Consts.DateTimeFormats.DateDisplayFormat);
                    }
                    PdfPCell BirthDate = new PdfPCell(new Phrase(LookupDataAccess.Getdate(entity.AltBdate.Trim()), TableFont));
                    BirthDate.HorizontalAlignment = Element.ALIGN_CENTER;
                    BirthDate.FixedHeight = 15f;
                    BirthDate.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(BirthDate);

                    if (entity.Age.Trim() != "0")
                    {
                        PdfPCell Age = new PdfPCell(new Phrase(entity.Age.Trim(), TableFont));
                        Age.HorizontalAlignment = Element.ALIGN_CENTER;
                        Age.FixedHeight = 15f;
                        Age.Border = iTextSharp.text.Rectangle.BOX;
                        Snp_Table.AddCell(Age);
                    }
                    else
                    {
                        PdfPCell Age = new PdfPCell(new Phrase("", TableFont));
                        Age.HorizontalAlignment = Element.ALIGN_CENTER;
                        Age.FixedHeight = 15f;
                        Age.Border = iTextSharp.text.Rectangle.BOX;
                        Snp_Table.AddCell(Age);
                    }

                    PdfPCell Sex = new PdfPCell(new Phrase(entity.Sex.Trim(), TableFont));
                    Sex.HorizontalAlignment = Element.ALIGN_CENTER;
                    Sex.FixedHeight = 15f;
                    Sex.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(Sex);

                    string Etinic = null;
                    DataSet dsEtinic = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.ETHNICODES);
                    DataTable dtEtinic = dsEtinic.Tables[0];
                    foreach (DataRow drEtinic in dtEtinic.Rows)
                    {
                        if (entity.Ethnic.Trim() == drEtinic["Code"].ToString().Trim())
                        {
                            Etinic = drEtinic["LookUpDesc"].ToString().Trim(); break;
                        }
                    }
                    PdfPCell Snp_Ethnic = new PdfPCell(new Phrase(Etinic, TableFont));
                    Snp_Ethnic.HorizontalAlignment = Element.ALIGN_LEFT;
                    Snp_Ethnic.FixedHeight = 15f;
                    Snp_Ethnic.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(Snp_Ethnic);

                    string Race = null;
                    DataSet dsRace = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.RACE);
                    DataTable dtRace = dsRace.Tables[0];
                    foreach (DataRow drRace in dtRace.Rows)
                    {
                        if (entity.Race.Trim() == drRace["Code"].ToString().Trim())
                        {
                            Race = drRace["LookUpDesc"].ToString().Trim(); break;
                        }
                    }
                    PdfPCell Snp_Race = new PdfPCell(new Phrase(Race, TableFont));
                    Snp_Race.HorizontalAlignment = Element.ALIGN_LEFT;
                    Snp_Race.FixedHeight = 15f;
                    Snp_Race.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(Snp_Race);

                    string Education = null;
                    DataSet dsEducation = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.EDUCATIONCODES);
                    DataTable dtEducation = dsEducation.Tables[0];
                    foreach (DataRow drEducation in dtEducation.Rows)
                    {
                        if (entity.Education.Trim() == drEducation["Code"].ToString().Trim())
                        {
                            Education = drEducation["LookUpDesc"].ToString().Trim(); break;
                        }
                    }
                    PdfPCell Snp_Education = new PdfPCell(new Phrase(Education, TableFont));
                    Snp_Education.HorizontalAlignment = Element.ALIGN_LEFT;
                    Snp_Education.FixedHeight = 15f;
                    Snp_Education.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(Snp_Education);

                    PdfPCell Insurance = new PdfPCell(new Phrase(entity.HealthIns.Trim(), TableFont));
                    Insurance.HorizontalAlignment = Element.ALIGN_CENTER;
                    Insurance.FixedHeight = 15f;
                    Insurance.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(Insurance);

                    PdfPCell Vetran = new PdfPCell(new Phrase(entity.Vet.Trim(), TableFont));
                    Vetran.HorizontalAlignment = Element.ALIGN_CENTER;
                    Vetran.FixedHeight = 15f;
                    Vetran.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(Vetran);

                    PdfPCell FoodStamps1 = new PdfPCell(new Phrase(entity.FootStamps.Trim(), TableFont));
                    FoodStamps1.HorizontalAlignment = Element.ALIGN_CENTER;
                    FoodStamps1.FixedHeight = 15f;
                    FoodStamps1.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(FoodStamps1);

                    string AGYDisable = null;
                    DataSet dsDisable = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.DISABLED);
                    DataTable dtDisable = dsDisable.Tables[0];
                    foreach (DataRow drDisable in dtDisable.Rows)
                    {
                        if (entity.Disable.Trim() == drDisable["Code"].ToString().Trim())
                            AGYDisable = drDisable["LookUpDesc"].ToString().Trim();
                    }
                    PdfPCell Disabled = new PdfPCell(new Phrase(AGYDisable, TableFont));
                    Disabled.HorizontalAlignment = Element.ALIGN_LEFT;
                    Disabled.FixedHeight = 15f;
                    Disabled.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(Disabled);
                }
            }

            string MotherName = string.Empty; string FatherName = string.Empty;
            string M_Address = string.Empty; string F_Address = string.Empty;
            string M_Phone = string.Empty; string F_Phone = string.Empty;
            string M_FullPart = string.Empty; string F_FullPart = string.Empty;
            foreach (CaseSnpEntity drCaseSNP in casesnpList)
            {
                if (FamSeq != drCaseSNP.FamilySeq.Trim())
                {
                    if (MotherEntity != null)
                    {
                        if (drCaseSNP.MemberCode == MotherEntity.Code)
                        {
                            MotherName = drCaseSNP.EmployerName.Trim();
                            if (!string.IsNullOrEmpty(drCaseSNP.EmployerStreet.Trim()))
                                M_Address = drCaseSNP.EmployerStreet.Trim() + ",";
                            if (!string.IsNullOrEmpty(drCaseSNP.EmployerCity.Trim()))
                                M_Address = drCaseSNP.EmployerCity.Trim();
                            if (!string.IsNullOrEmpty(drCaseSNP.EmplPhone.Trim()))
                                M_Phone = drCaseSNP.EmplPhone.Trim();
                            if (drCaseSNP.FullTimeHours.Trim() != "0")
                                M_FullPart = "F";
                            else if (drCaseSNP.FullTimeHours.Trim() != "0")
                                M_FullPart = "P";
                        }
                    }

                    if (FatherEntity.Count > 0)
                    {
                        foreach (CommonEntity cm in FatherEntity)
                        {
                            if (cm.Code == drCaseSNP.MemberCode)
                            {
                                FatherName = drCaseSNP.EmployerName.Trim();
                                if (!string.IsNullOrEmpty(drCaseSNP.EmployerStreet))
                                    F_Address = drCaseSNP.EmployerStreet.Trim() + ",";
                                if (!string.IsNullOrEmpty(drCaseSNP.EmployerCity.Trim()))
                                    F_Address = drCaseSNP.EmployerCity.Trim();
                                if (!string.IsNullOrEmpty(drCaseSNP.EmplPhone.Trim()))
                                    F_Phone = drCaseSNP.EmplPhone.Trim();
                                if (drCaseSNP.FullTimeHours.Trim() != "0")
                                    F_FullPart = "F";
                                else if (drCaseSNP.FullTimeHours.Trim() != "0")
                                    F_FullPart = "P";
                                break;
                            }
                        }
                    }

                    string ApplicantName = drCaseSNP.NameixLast.Trim() + " " + drCaseSNP.NameixFi.Trim() + " " + drCaseSNP.NameixMi.Trim();//snpEntity.NameixFi.Trim() + " " + snpEntity.NameixLast.Trim();
                    PdfPCell Name = new PdfPCell(new Phrase(ApplicantName, TableFont));
                    Name.HorizontalAlignment = Element.ALIGN_LEFT;
                    Name.FixedHeight = 15f;
                    Name.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(Name);

                    string Relation = null;
                    DataSet dsRelation = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.RELATIONSHIP);
                    DataTable dtRelation = dsRelation.Tables[0];
                    foreach (DataRow drRelation in dtRelation.Rows)
                    {
                        if (drCaseSNP.MemberCode.Trim() == drRelation["Code"].ToString().Trim())
                        {
                            Relation = drRelation["LookUpDesc"].ToString().Trim(); break;
                        }
                    }
                    PdfPCell RelationShip = new PdfPCell(new Phrase(Relation, TableFont));
                    RelationShip.HorizontalAlignment = Element.ALIGN_LEFT;
                    RelationShip.FixedHeight = 15f;
                    RelationShip.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(RelationShip);
                    string SSNNum = null;
                    if (!string.IsNullOrEmpty(drCaseSNP.Ssno.Trim()))
                        SSNNum = "xxx" + "-" + "xx" + "-" + drCaseSNP.Ssno.Trim().Substring(5, 4);
                    PdfPCell SSN = new PdfPCell(new Phrase(SSNNum, TableFont));
                    SSN.HorizontalAlignment = Element.ALIGN_CENTER;
                    SSN.FixedHeight = 15f;
                    SSN.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(SSN);

                    string DOB = string.Empty;
                    if (!string.IsNullOrEmpty(drCaseSNP.AltBdate))
                    {
                        DOB = CommonFunctions.ChangeDateFormat(drCaseSNP.AltBdate.Trim(), Consts.DateTimeFormats.DateSaveFormat, Consts.DateTimeFormats.DateDisplayFormat);
                    }
                    PdfPCell BirthDate = new PdfPCell(new Phrase(LookupDataAccess.Getdate(drCaseSNP.AltBdate.Trim()), TableFont));
                    BirthDate.HorizontalAlignment = Element.ALIGN_CENTER;
                    BirthDate.FixedHeight = 15f;
                    BirthDate.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(BirthDate);

                    if (drCaseSNP.Age.Trim() != "0")
                    {
                        PdfPCell Age = new PdfPCell(new Phrase(drCaseSNP.Age.Trim(), TableFont));
                        Age.HorizontalAlignment = Element.ALIGN_CENTER;
                        Age.FixedHeight = 15f;
                        Age.Border = iTextSharp.text.Rectangle.BOX;
                        Snp_Table.AddCell(Age);
                    }
                    else
                    {
                        PdfPCell Age = new PdfPCell(new Phrase("", TableFont));
                        Age.HorizontalAlignment = Element.ALIGN_CENTER;
                        Age.FixedHeight = 15f;
                        Age.Border = iTextSharp.text.Rectangle.BOX;
                        Snp_Table.AddCell(Age);
                    }

                    PdfPCell Sex = new PdfPCell(new Phrase(drCaseSNP.Sex.Trim(), TableFont));
                    Sex.HorizontalAlignment = Element.ALIGN_CENTER;
                    Sex.FixedHeight = 15f;
                    Sex.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(Sex);

                    string Etinic = null;
                    DataSet dsEtinic = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.ETHNICODES);
                    DataTable dtEtinic = dsEtinic.Tables[0];
                    foreach (DataRow drEtinic in dtEtinic.Rows)
                    {
                        if (drCaseSNP.Ethnic.Trim() == drEtinic["Code"].ToString().Trim())
                        {
                            Etinic = drEtinic["LookUpDesc"].ToString().Trim(); break;
                        }
                    }
                    PdfPCell Snp_Ethnic = new PdfPCell(new Phrase(Etinic, TableFont));
                    Snp_Ethnic.HorizontalAlignment = Element.ALIGN_LEFT;
                    Snp_Ethnic.FixedHeight = 15f;
                    Snp_Ethnic.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(Snp_Ethnic);

                    string Race = null;
                    DataSet dsRace = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.RACE);
                    DataTable dtRace = dsRace.Tables[0];
                    foreach (DataRow drRace in dtRace.Rows)
                    {
                        if (drCaseSNP.Race.Trim() == drRace["Code"].ToString().Trim())
                        {
                            Race = drRace["LookUpDesc"].ToString().Trim(); break;
                        }
                    }
                    PdfPCell Snp_Race = new PdfPCell(new Phrase(Race, TableFont));
                    Snp_Race.HorizontalAlignment = Element.ALIGN_LEFT;
                    Snp_Race.FixedHeight = 15f;
                    Snp_Race.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(Snp_Race);

                    string Education = null;
                    DataSet dsEducation = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.EDUCATIONCODES);
                    DataTable dtEducation = dsEducation.Tables[0];
                    foreach (DataRow drEducation in dtEducation.Rows)
                    {
                        if (drCaseSNP.Education.Trim() == drEducation["Code"].ToString().Trim())
                        {
                            Education = drEducation["LookUpDesc"].ToString().Trim(); break;
                        }
                    }
                    PdfPCell Snp_Education = new PdfPCell(new Phrase(Education, TableFont));
                    Snp_Education.HorizontalAlignment = Element.ALIGN_LEFT;
                    Snp_Education.FixedHeight = 15f;
                    Snp_Education.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(Snp_Education);

                    PdfPCell Insurance = new PdfPCell(new Phrase(drCaseSNP.HealthIns.Trim(), TableFont));
                    Insurance.HorizontalAlignment = Element.ALIGN_CENTER;
                    Insurance.FixedHeight = 15f;
                    Insurance.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(Insurance);

                    PdfPCell Vetran = new PdfPCell(new Phrase(drCaseSNP.Vet.Trim(), TableFont));
                    Vetran.HorizontalAlignment = Element.ALIGN_CENTER;
                    Vetran.FixedHeight = 15f;
                    Vetran.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(Vetran);

                    PdfPCell FoodStamps1 = new PdfPCell(new Phrase(drCaseSNP.FootStamps.Trim(), TableFont));
                    FoodStamps1.HorizontalAlignment = Element.ALIGN_CENTER;
                    FoodStamps1.FixedHeight = 15f;
                    FoodStamps1.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(FoodStamps1);

                    string AGYDisable = null;
                    DataSet dsDisable = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.DISABLED);
                    DataTable dtDisable = dsDisable.Tables[0];
                    foreach (DataRow drDisable in dtDisable.Rows)
                    {
                        if (drCaseSNP.Disable.Trim() == drDisable["Code"].ToString().Trim())
                            AGYDisable = drDisable["LookUpDesc"].ToString().Trim();
                    }
                    PdfPCell Disabled = new PdfPCell(new Phrase(AGYDisable, TableFont));
                    Disabled.HorizontalAlignment = Element.ALIGN_LEFT;
                    Disabled.FixedHeight = 15f;
                    Disabled.Border = iTextSharp.text.Rectangle.BOX;
                    Snp_Table.AddCell(Disabled);

                    Tbl_Count++;
                    if (Tbl_Count > 10)
                        break;
                }
            }
            int Len_Var = 130 - Tbl_Count * 13;
            for (int j = 0; j <= Len_Var; ++j)  //120
            {
                PdfPCell SpaceCell = new PdfPCell(new Phrase(" ", TableFont));
                SpaceCell.HorizontalAlignment = Element.ALIGN_CENTER;
                SpaceCell.FixedHeight = 15f;
                SpaceCell.Border = iTextSharp.text.Rectangle.BOX;
                Snp_Table.AddCell(SpaceCell);
            }

            document.Add(head);
            document.Add(Snp_Table);
            document.NewPage();

            #endregion End Of SNP details Table

            //cb.BeginText();
            //X_Pos = 400; Y_Pos = 580;
            //cb.SetFontAndSize(bf_helv, 13);
            //cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Header_Desc, X_Pos, Y_Pos, 0);

            //cb.SetFontAndSize(bf_helv, 9);
            //cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Applicant No: ", 30, Y_Pos - 15, 0);
            //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(BaseForm.BaseApplicationNo, Timesline), 30 + 72, Y_Pos - 15, 0);

            //cb.SetFontAndSize(bf_helv, 13);
            //cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Form_Selection, X_Pos, Y_Pos - 15, 0);
            //cb.SetFontAndSize(bf_helv, 9);
            //cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Date Printed: ", 740, Y_Pos - 15, 0);
            //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase(LookupDataAccess.Getdate(DateTime.Now.ToShortDateString()), Times), 780, Y_Pos - 15, 0);

            //X_Pos = 30; Y_Pos -= 30;
            //cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Applicant Name   ", X_Pos, Y_Pos, 0);
            //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(BaseForm.BaseApplicationName, Timesline), X_Pos + 72, Y_Pos, 0);

            //cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Application Date: ", 740, Y_Pos, 0);
            //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase(LookupDataAccess.Getdate(drCaseMST["MST_INTAKE_DATE"].ToString().Trim()), Timesline), 780, Y_Pos, 0);

            //cb.EndText();

            iTextSharp.text.Font HeaderFontBold = new iTextSharp.text.Font(bf_helv, 13);
            //start the Income details of a Family to the table

            //PdfPTable SpaceTable = new PdfPTable(1);
            //SpaceTable.TotalWidth = 750f;
            //SpaceTable.WidthPercentage = 100;
            //SpaceTable.LockedWidth = true;
            //float[] SpaceTablewidths = new float[] { 80f };
            //SpaceTable.SetWidths(SpaceTablewidths);
            //SpaceTable.HorizontalAlignment = Element.ALIGN_CENTER;
            //SpaceTable.SpacingAfter = 70f;

            #region Income Table

            PdfPTable IncomeTable = new PdfPTable(5);
            IncomeTable.TotalWidth = 750f;
            IncomeTable.WidthPercentage = 100;
            IncomeTable.LockedWidth = true;
            float[] Incomewidths = new float[] { 80f, 50f, 40f, 90f, 80f };
            IncomeTable.SetWidths(Incomewidths);
            IncomeTable.HorizontalAlignment = Element.ALIGN_CENTER;
            IncomeTable.SpacingBefore = 100f;

            PdfPCell IncomeCell = new PdfPCell(new Phrase(Header_Desc, HeaderFontBold));
            IncomeCell.Colspan = 5;
            IncomeCell.HorizontalAlignment = Element.ALIGN_CENTER;
            IncomeCell.FixedHeight = 15f;
            IncomeCell.Border = iTextSharp.text.Rectangle.NO_BORDER;
            IncomeTable.AddCell(IncomeCell);

            PdfPCell IncomeCell1 = new PdfPCell(new Phrase(Form_Selection, HeaderFontBold));
            IncomeCell1.Colspan = 5;
            IncomeCell1.HorizontalAlignment = Element.ALIGN_CENTER;
            IncomeCell1.FixedHeight = 15f;
            IncomeCell1.Border = iTextSharp.text.Rectangle.NO_BORDER;
            IncomeTable.AddCell(IncomeCell1);

            PdfPCell IncomeCell0 = new PdfPCell(new Phrase("Applicant No: " + BaseForm.BaseApplicationNo, TableFont));
            IncomeCell0.Colspan = 2;
            IncomeCell0.HorizontalAlignment = Element.ALIGN_LEFT;
            IncomeCell0.FixedHeight = 15f;
            IncomeCell0.Border = iTextSharp.text.Rectangle.NO_BORDER;
            IncomeTable.AddCell(IncomeCell0);

            PdfPCell IncomeCell2 = new PdfPCell(new Phrase("Date Printed: " + DateTime.Now.ToString("g"), TableFont));
            IncomeCell2.Colspan = 3;
            IncomeCell2.HorizontalAlignment = Element.ALIGN_RIGHT;
            IncomeCell2.FixedHeight = 15f;
            IncomeCell2.Border = iTextSharp.text.Rectangle.NO_BORDER;
            IncomeTable.AddCell(IncomeCell2);

            PdfPCell IncomeCell3 = new PdfPCell(new Phrase("Applicant Name   " + BaseForm.BaseApplicationName, TableFont));
            IncomeCell3.Colspan = 3;
            IncomeCell3.HorizontalAlignment = Element.ALIGN_LEFT;
            IncomeCell3.FixedHeight = 15f;
            IncomeCell3.Border = iTextSharp.text.Rectangle.NO_BORDER;
            IncomeTable.AddCell(IncomeCell3);

            if (!string.IsNullOrEmpty(CASEMSTList[0].IntakeDate.Trim()))
            {
                PdfPCell IncomeCell4 = new PdfPCell(new Phrase("Application Date: " + LookupDataAccess.Getdate(CASEMSTList[0].IntakeDate.Trim()), TableFont));
                IncomeCell4.Colspan = 2;
                IncomeCell4.HorizontalAlignment = Element.ALIGN_RIGHT;
                IncomeCell4.FixedHeight = 15f;
                IncomeCell4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                IncomeTable.AddCell(IncomeCell4);
            }
            else
            {
                PdfPCell IncomeCell4 = new PdfPCell(new Phrase("Application Date: " + "____________", TableFont));
                IncomeCell4.Colspan = 2;
                IncomeCell4.HorizontalAlignment = Element.ALIGN_RIGHT;
                IncomeCell4.FixedHeight = 15f;
                IncomeCell4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                IncomeTable.AddCell(IncomeCell4);
            }
            PdfPCell IncomeHeader = new PdfPCell(new Phrase("Financial Information - As reported by Applicant", TblFontBold));
            IncomeHeader.Colspan = 5;
            IncomeHeader.FixedHeight = 15f;
            IncomeHeader.BackgroundColor = BaseColor.LIGHT_GRAY;
            IncomeHeader.Border = iTextSharp.text.Rectangle.BOX;
            IncomeTable.AddCell(IncomeHeader);
            string[] Incomecol = { "Household Member", "Amount", "Interval", "Income Sources", "How Verified?" };
            for (int p = 0; p < Incomecol.Length; ++p)
            {
                PdfPCell Incomecell = new PdfPCell(new Phrase(Incomecol[p], TableFontBoldItalic));
                Incomecell.HorizontalAlignment = Element.ALIGN_CENTER;
                Incomecell.FixedHeight = 15f;
                Incomecell.Border = iTextSharp.text.Rectangle.BOX;
                IncomeTable.AddCell(Incomecell);
            }

            //if (dsIncome.Tables.Count > 0)


            decimal Row_Prog_Income = 0; string interval = null, MemName = null, Income_Verifier = null;
            string IncomeDesc = null, privSeq = null;
            if (incomelist.Count > 0)
            {
                //DataView dv = dtCaseIncome.DefaultView;
                //dv.RowFilter = "INCOME_EXCLUDE = 'N'";
                //dv.Sort = "INCOME_FAMILY_SEQ ASC";
                //dtCaseIncome = dv.ToTable();
                dtIncome = dsIncome.Tables[0];
                foreach (CaseIncomeEntity drCaseIncome in incomelist)
                {
                    Income_Verifier = interval = IncomeDesc = string.Empty;
                    if (drCaseIncome.FamilySeq.Trim() != privSeq)
                    {
                        if (!string.IsNullOrEmpty(drCaseIncome.FamilySeq.Trim()))
                            MemName = Get_Member_Name(drCaseIncome.FamilySeq.Trim(), string.Empty);
                        PdfPCell House_HoldMem = new PdfPCell(new Phrase(MemName, TableFont));
                        House_HoldMem.Colspan = 5;
                        House_HoldMem.HorizontalAlignment = Element.ALIGN_LEFT;
                        House_HoldMem.FixedHeight = 15f;
                        House_HoldMem.Border = iTextSharp.text.Rectangle.BOX;
                        IncomeTable.AddCell(House_HoldMem);
                        privSeq = drCaseIncome.FamilySeq.Trim();
                    }
                    PdfPCell Income_Space = new PdfPCell(new Phrase("", TableFont));
                    Income_Space.Colspan = 1;
                    Income_Space.HorizontalAlignment = Element.ALIGN_CENTER;
                    Income_Space.FixedHeight = 15f;
                    Income_Space.Border = iTextSharp.text.Rectangle.BOX;
                    IncomeTable.AddCell(Income_Space);

                    if (!string.IsNullOrEmpty(drCaseIncome.ProgIncome.Trim()))
                        Row_Prog_Income = decimal.Parse(drCaseIncome.ProgIncome.Trim());
                    PdfPCell Amount = new PdfPCell(new Phrase(Row_Prog_Income.ToString(), TableFont));
                    Amount.HorizontalAlignment = Element.ALIGN_CENTER;
                    Amount.FixedHeight = 15f;
                    Amount.Border = iTextSharp.text.Rectangle.BOX;
                    IncomeTable.AddCell(Amount);

                    if (!string.IsNullOrEmpty(drCaseIncome.Interval.Trim()))
                        interval = LookupDataAccess.ShowIncomeInterval(drCaseIncome.Interval.Trim());
                    PdfPCell Freq = new PdfPCell(new Phrase(interval, TableFont));
                    Freq.HorizontalAlignment = Element.ALIGN_LEFT;
                    Freq.FixedHeight = 15f;
                    Freq.Border = iTextSharp.text.Rectangle.BOX;
                    IncomeTable.AddCell(Freq);

                    if (!string.IsNullOrEmpty(drCaseIncome.Type.Trim()))
                        IncomeDesc = Get_IncomeType_Desc(drCaseIncome.Type.Trim());

                    PdfPCell IncomeSource = new PdfPCell(new Phrase(IncomeDesc, TableFont));
                    IncomeSource.HorizontalAlignment = Element.ALIGN_CENTER;
                    IncomeSource.FixedHeight = 15f;
                    IncomeSource.Border = iTextSharp.text.Rectangle.BOX;
                    IncomeTable.AddCell(IncomeSource);

                    if (!string.IsNullOrEmpty(drCaseIncome.HowVerified.Trim()))
                        Income_Verifier = drCaseIncome.HowVerified.Trim();

                    PdfPCell IncomeVer = new PdfPCell(new Phrase(Income_Verifier, TableFont));
                    IncomeVer.HorizontalAlignment = Element.ALIGN_LEFT;
                    IncomeVer.FixedHeight = 15f;
                    IncomeVer.Border = iTextSharp.text.Rectangle.BOX;
                    IncomeTable.AddCell(IncomeVer);

                }
            }

            PdfPTable TotIncomeTable = new PdfPTable(8);
            TotIncomeTable.TotalWidth = 750f;
            TotIncomeTable.WidthPercentage = 100;
            TotIncomeTable.LockedWidth = true;
            float[] TotIncomeTablewidths = new float[] { 50f, 30f, 50f, 40f, 60f, 30f, 50f, 30f };
            TotIncomeTable.SetWidths(TotIncomeTablewidths);
            TotIncomeTable.HorizontalAlignment = Element.ALIGN_CENTER;
            //IncomeTable.SpacingBefore = 60f;

            PdfPCell Total_Space = new PdfPCell(new Phrase("", TableFont));
            Total_Space.Colspan = 8;
            Total_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            Total_Space.FixedHeight = 15f;
            Total_Space.Border = iTextSharp.text.Rectangle.BOX;
            TotIncomeTable.AddCell(Total_Space);

            PdfPCell Total = new PdfPCell(new Phrase("Total Income", TableFont));
            Total.HorizontalAlignment = Element.ALIGN_LEFT;
            Total.FixedHeight = 15f;
            Total.Border = iTextSharp.text.Rectangle.BOX;
            TotIncomeTable.AddCell(Total);

            PdfPCell Total_Income = new PdfPCell(new Phrase(CASEMSTList[0].FamIncome.Trim(), TableFont));
            Total_Income.HorizontalAlignment = Element.ALIGN_CENTER;
            Total_Income.FixedHeight = 15f;
            Total_Income.Border = iTextSharp.text.Rectangle.BOX;
            TotIncomeTable.AddCell(Total_Income);

            PdfPCell Program = new PdfPCell(new Phrase("Program Income", TableFont));
            Program.HorizontalAlignment = Element.ALIGN_LEFT;
            Program.FixedHeight = 15f;
            Program.Border = iTextSharp.text.Rectangle.BOX;
            TotIncomeTable.AddCell(Program);

            PdfPCell Program_Income = new PdfPCell(new Phrase(CASEMSTList[0].ProgIncome.Trim(), TableFont));
            Program_Income.HorizontalAlignment = Element.ALIGN_CENTER;
            Program_Income.FixedHeight = 15f;
            Program_Income.Border = iTextSharp.text.Rectangle.BOX;
            TotIncomeTable.AddCell(Program_Income);

            PdfPCell Federal = new PdfPCell(new Phrase("% of Federal Poverty Level", TableFont));
            Federal.HorizontalAlignment = Element.ALIGN_LEFT;
            Federal.FixedHeight = 15f;
            Federal.Border = iTextSharp.text.Rectangle.BOX;
            TotIncomeTable.AddCell(Federal);

            PdfPCell Federal_Poverty = new PdfPCell(new Phrase(CASEMSTList[0].Poverty.Trim() + "%", TableFont));
            Federal_Poverty.HorizontalAlignment = Element.ALIGN_CENTER;
            Federal_Poverty.FixedHeight = 15f;
            Federal_Poverty.Border = iTextSharp.text.Rectangle.BOX;
            TotIncomeTable.AddCell(Federal_Poverty);

            PdfPCell HUD = new PdfPCell(new Phrase("HUD%", TableFont));
            HUD.HorizontalAlignment = Element.ALIGN_LEFT;
            HUD.FixedHeight = 15f;
            HUD.Border = iTextSharp.text.Rectangle.BOX;
            TotIncomeTable.AddCell(HUD);

            PdfPCell HUD_Value = new PdfPCell(new Phrase(CASEMSTList[0].Hud.Trim() + "%", TableFont));
            HUD_Value.HorizontalAlignment = Element.ALIGN_CENTER;
            HUD_Value.FixedHeight = 15f;
            HUD_Value.Border = iTextSharp.text.Rectangle.BOX;
            TotIncomeTable.AddCell(HUD_Value);

            document.Add(IncomeTable);
            document.Add(TotIncomeTable);

            #endregion

            #region Income Verification

            //    iTextSharp.text.Image _image_UnChecked = iTextSharp.text.Image.GetInstance(Context.Server.MapPath("~\\Resources\\Icons\\16X16\\CheckBoxUnchecked.JPG"));
            //  iTextSharp.text.Image _image_Checked = iTextSharp.text.Image.GetInstance(Context.Server.MapPath("~\\Resources\\Icons\\16X16\\CheckBoxChecked.JPG"));


            iTextSharp.text.Image _image_UnChecked = iTextSharp.text.Image.GetInstance(Application.MapPath("~\\Resources\\Icons\\16X16\\CheckBoxUnchecked.JPG"));
            iTextSharp.text.Image _image_Checked = iTextSharp.text.Image.GetInstance(Application.MapPath("~\\Resources\\Icons\\16X16\\CheckBoxChecked.JPG"));

            _image_UnChecked.ScalePercent(60f);
            _image_Checked.ScalePercent(60f);


            PdfPTable Income_Last = new PdfPTable(15);
            Income_Last.TotalWidth = 750f;
            Income_Last.WidthPercentage = 100;
            Income_Last.LockedWidth = true;
            float[] Income_Lastwidths = new float[] { 20f, 8f, 13f, 8f, 20f, 8f, 25f, 8f, 18f, 8f, 15f, 25f, 20f, 13f, 30f };
            Income_Last.SetWidths(Income_Lastwidths);
            Income_Last.HorizontalAlignment = Element.ALIGN_CENTER;
            Income_Last.SpacingBefore = 20f;

            PdfPCell Income_Verified = new PdfPCell(new Phrase("Income Verified", TableFontBoldItalic));
            Income_Verified.HorizontalAlignment = Element.ALIGN_LEFT;
            Income_Verified.FixedHeight = 15f;
            Income_Verified.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Income_Last.AddCell(Income_Verified);

            if (CASEMSTList[0].VerifyW2.Trim() == "Y")
            {
                PdfPCell W2Cheked = new PdfPCell(_image_Checked);
                W2Cheked.VerticalAlignment = Element.ALIGN_MIDDLE;
                W2Cheked.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
                //W2Cheked.FixedHeight = 15f;
                W2Cheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Income_Last.AddCell(W2Cheked);
            }
            else
            {
                PdfPCell W2UnCheked = new PdfPCell(_image_UnChecked);
                W2UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
                W2UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
                //W2UnCheked.FixedHeight = 15f;
                W2UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Income_Last.AddCell(W2UnCheked);
            }

            PdfPCell W2Text = new PdfPCell(new Phrase("W2", Times));
            W2Text.HorizontalAlignment = Element.ALIGN_LEFT;
            W2Text.FixedHeight = 15f;
            W2Text.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Income_Last.AddCell(W2Text);

            if (CASEMSTList[0].VerifyCheckStub.Trim() == "Y")
            {
                PdfPCell CHECK_STUB_Check = new PdfPCell(_image_Checked);
                CHECK_STUB_Check.VerticalAlignment = Element.ALIGN_MIDDLE;
                CHECK_STUB_Check.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
                //W2Cheked.FixedHeight = 15f;
                CHECK_STUB_Check.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Income_Last.AddCell(CHECK_STUB_Check);
            }
            else
            {
                PdfPCell CHECK_STUB_UnCheked = new PdfPCell(_image_UnChecked);
                CHECK_STUB_UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
                CHECK_STUB_UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
                //W2UnCheked.FixedHeight = 15f;
                CHECK_STUB_UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Income_Last.AddCell(CHECK_STUB_UnCheked);
            }

            PdfPCell CHECK_STUB = new PdfPCell(new Phrase("CHECK_STUB", Times));
            CHECK_STUB.HorizontalAlignment = Element.ALIGN_LEFT;
            CHECK_STUB.FixedHeight = 15f;
            CHECK_STUB.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Income_Last.AddCell(CHECK_STUB);

            if (CASEMSTList[0].VerifyLetter.Trim() == "Y")
            {
                PdfPCell LETTER_Check = new PdfPCell(_image_Checked);
                LETTER_Check.VerticalAlignment = Element.ALIGN_MIDDLE;
                LETTER_Check.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
                //W2Cheked.FixedHeight = 15f;
                LETTER_Check.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Income_Last.AddCell(LETTER_Check);
            }
            else
            {
                PdfPCell LETTER_UnCheked = new PdfPCell(_image_UnChecked);
                LETTER_UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
                LETTER_UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
                //W2UnCheked.FixedHeight = 15f;
                LETTER_UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Income_Last.AddCell(LETTER_UnCheked);
            }

            PdfPCell LETTER = new PdfPCell(new Phrase("Letter/Budget Sheet", Times));
            LETTER.HorizontalAlignment = Element.ALIGN_LEFT;
            LETTER.FixedHeight = 15f;
            LETTER.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Income_Last.AddCell(LETTER);

            if (CASEMSTList[0].VerifyTaxReturn.Trim() == "Y")
            {
                PdfPCell TAX_RETURN_Check = new PdfPCell(_image_Checked);
                TAX_RETURN_Check.VerticalAlignment = Element.ALIGN_MIDDLE;
                TAX_RETURN_Check.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
                //W2Cheked.FixedHeight = 15f;
                TAX_RETURN_Check.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Income_Last.AddCell(TAX_RETURN_Check);
            }
            else
            {
                PdfPCell TAX_RETURN_UnCheked = new PdfPCell(_image_UnChecked);
                TAX_RETURN_UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
                TAX_RETURN_UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
                //W2UnCheked.FixedHeight = 15f;
                TAX_RETURN_UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Income_Last.AddCell(TAX_RETURN_UnCheked);
            }

            PdfPCell TAX_RETURN = new PdfPCell(new Phrase("Tax Returns", Times));
            TAX_RETURN.HorizontalAlignment = Element.ALIGN_LEFT;
            TAX_RETURN.FixedHeight = 15f;
            TAX_RETURN.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Income_Last.AddCell(TAX_RETURN);

            if (CASEMSTList[0].VerifyOther.Trim() == "Y")
            {
                PdfPCell OTHER_Check = new PdfPCell(_image_Checked);
                OTHER_Check.VerticalAlignment = Element.ALIGN_MIDDLE;
                OTHER_Check.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
                //W2Cheked.FixedHeight = 15f;
                OTHER_Check.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Income_Last.AddCell(OTHER_Check);
            }
            else
            {
                PdfPCell OTHER_UnCheked = new PdfPCell(_image_UnChecked);
                OTHER_UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
                OTHER_UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
                //W2UnCheked.FixedHeight = 15f;
                OTHER_UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Income_Last.AddCell(OTHER_UnCheked);
            }

            PdfPCell OTHER = new PdfPCell(new Phrase("Other", Times));
            OTHER.HorizontalAlignment = Element.ALIGN_LEFT;
            OTHER.FixedHeight = 15f;
            OTHER.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Income_Last.AddCell(OTHER);

            PdfPCell Verification_Date = new PdfPCell(new Phrase("Verification Date:", Times));
            Verification_Date.HorizontalAlignment = Element.ALIGN_LEFT;
            Verification_Date.FixedHeight = 15f;
            Verification_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Income_Last.AddCell(Verification_Date);

            if (!string.IsNullOrEmpty(CASEMSTList[0].EligDate.Trim().Trim()))
            {
                PdfPCell Verify_Date = new PdfPCell(new Phrase(LookupDataAccess.Getdate(CASEMSTList[0].EligDate.Trim().Trim()), Timesline));
                Verify_Date.HorizontalAlignment = Element.ALIGN_LEFT;
                Verify_Date.FixedHeight = 15f;
                Verify_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Income_Last.AddCell(Verify_Date);
            }
            else
            {
                PdfPCell Verify_Date_Space = new PdfPCell(new Phrase("________________", Times));
                Verify_Date_Space.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
                Verify_Date_Space.HorizontalAlignment = Element.ALIGN_LEFT;
                Verify_Date_Space.FixedHeight = 15f;
                Verify_Date_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Income_Last.AddCell(Verify_Date_Space);
            }

            PdfPCell Verifier_Head = new PdfPCell(new Phrase("Verifier:", Times));
            Verifier_Head.HorizontalAlignment = Element.ALIGN_LEFT;
            Verifier_Head.FixedHeight = 15f;
            Verifier_Head.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Income_Last.AddCell(Verifier_Head);

            string CaseWorker = null;
            if (dtVerifier.Rows.Count > 0)
            {
                foreach (DataRow drVerifier in dtVerifier.Rows)
                {
                    if (CASEMSTList[0].Verifier.Trim().Trim() == drVerifier["PWH_CASEWORKER"].ToString().Trim())
                    {
                        CaseWorker = drVerifier["NAME"].ToString().Trim();
                        break;
                    }
                }
            }

            if (!string.IsNullOrEmpty(CaseWorker))
            {
                PdfPCell Verifier = new PdfPCell(new Phrase(CaseWorker, Timesline));
                Verifier.HorizontalAlignment = Element.ALIGN_LEFT;
                Verifier.FixedHeight = 15f;
                Verifier.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Income_Last.AddCell(Verifier);
            }
            else
            {
                PdfPCell Verifier_Space = new PdfPCell(new Phrase("_______________________________", Times));
                Verifier_Space.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
                Verifier_Space.HorizontalAlignment = Element.ALIGN_LEFT;
                Verifier_Space.FixedHeight = 15f;
                Verifier_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Income_Last.AddCell(Verifier_Space);
            }



            document.Add(Income_Last);


            #endregion

            #region LastIncome Table Not Used

            //PdfPTable Income_Last = new PdfPTable(15);
            //Income_Last.TotalWidth = 750f;
            //Income_Last.WidthPercentage = 100;
            //Income_Last.LockedWidth = true;
            //float[] Income_Lastwidths = new float[] { 20f, 8f, 13f, 8f, 20f, 8f, 25f, 8f, 18f, 8f, 15f, 25f, 20f, 13f, 30f };
            //Income_Last.SetWidths(Income_Lastwidths);
            //Income_Last.HorizontalAlignment = Element.ALIGN_CENTER;
            //Income_Last.SpacingBefore = 20f;


            //iTextSharp.text.Image _image_UnChecked = iTextSharp.text.Image.GetInstance(Context.Server.MapPath("~\\Resources\\Icons\\16X16\\CheckBoxUnchecked.JPG"));
            //iTextSharp.text.Image _image_Checked = iTextSharp.text.Image.GetInstance(Context.Server.MapPath("~\\Resources\\Icons\\16X16\\CheckBoxChecked.JPG"));

            //_image_UnChecked.ScalePercent(60f);
            //_image_Checked.ScalePercent(60f);


            //PdfPCell Income_Verified = new PdfPCell(new Phrase("Income Verified", TableFontBoldItalic));
            //Income_Verified.HorizontalAlignment = Element.ALIGN_LEFT;
            //Income_Verified.FixedHeight = 15f;
            //Income_Verified.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //Income_Last.AddCell(Income_Verified);

            //if (drCaseMST["MST_VERIFY_W2"].ToString().Trim() == "Y")
            //{
            //    PdfPCell W2Cheked = new PdfPCell(_image_Checked);
            //    W2Cheked.VerticalAlignment = Element.ALIGN_MIDDLE;
            //    W2Cheked.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
            //    //W2Cheked.FixedHeight = 15f;
            //    W2Cheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(W2Cheked);
            //}
            //else
            //{
            //    PdfPCell W2UnCheked = new PdfPCell(_image_UnChecked);
            //    W2UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
            //    W2UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
            //    //W2UnCheked.FixedHeight = 15f;
            //    W2UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(W2UnCheked);
            //}

            //PdfPCell W2Text = new PdfPCell(new Phrase("W2", Times));
            //W2Text.HorizontalAlignment = Element.ALIGN_LEFT;
            //W2Text.FixedHeight = 15f;
            //W2Text.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //Income_Last.AddCell(W2Text);

            //if (drCaseMST["MST_VERIFY_CHECK_STUB"].ToString().Trim() == "Y")
            //{
            //    PdfPCell CHECK_STUB_Check = new PdfPCell(_image_Checked);
            //    CHECK_STUB_Check.VerticalAlignment = Element.ALIGN_MIDDLE;
            //    CHECK_STUB_Check.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
            //    //W2Cheked.FixedHeight = 15f;
            //    CHECK_STUB_Check.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(CHECK_STUB_Check);
            //}
            //else
            //{
            //    PdfPCell CHECK_STUB_UnCheked = new PdfPCell(_image_UnChecked);
            //    CHECK_STUB_UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
            //    CHECK_STUB_UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
            //    //W2UnCheked.FixedHeight = 15f;
            //    CHECK_STUB_UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(CHECK_STUB_UnCheked);
            //}

            //PdfPCell CHECK_STUB = new PdfPCell(new Phrase("CHECK_STUB", Times));
            //CHECK_STUB.HorizontalAlignment = Element.ALIGN_LEFT;
            //CHECK_STUB.FixedHeight = 15f;
            //CHECK_STUB.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //Income_Last.AddCell(CHECK_STUB);

            //if (drCaseMST["MST_VERIFY_LETTER"].ToString().Trim() == "Y")
            //{
            //    PdfPCell LETTER_Check = new PdfPCell(_image_Checked);
            //    LETTER_Check.VerticalAlignment = Element.ALIGN_MIDDLE;
            //    LETTER_Check.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
            //    //W2Cheked.FixedHeight = 15f;
            //    LETTER_Check.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(LETTER_Check);
            //}
            //else
            //{
            //    PdfPCell LETTER_UnCheked = new PdfPCell(_image_UnChecked);
            //    LETTER_UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
            //    LETTER_UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
            //    //W2UnCheked.FixedHeight = 15f;
            //    LETTER_UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(LETTER_UnCheked);
            //}

            //PdfPCell LETTER = new PdfPCell(new Phrase("Letter/Budget Sheet", Times));
            //LETTER.HorizontalAlignment = Element.ALIGN_LEFT;
            //LETTER.FixedHeight = 15f;
            //LETTER.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //Income_Last.AddCell(LETTER);

            //if (drCaseMST["MST_VERIFY_TAX_RETURN"].ToString().Trim() == "Y")
            //{
            //    PdfPCell TAX_RETURN_Check = new PdfPCell(_image_Checked);
            //    TAX_RETURN_Check.VerticalAlignment = Element.ALIGN_MIDDLE;
            //    TAX_RETURN_Check.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
            //    //W2Cheked.FixedHeight = 15f;
            //    TAX_RETURN_Check.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(TAX_RETURN_Check);
            //}
            //else
            //{
            //    PdfPCell TAX_RETURN_UnCheked = new PdfPCell(_image_UnChecked);
            //    TAX_RETURN_UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
            //    TAX_RETURN_UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
            //    //W2UnCheked.FixedHeight = 15f;
            //    TAX_RETURN_UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(TAX_RETURN_UnCheked);
            //}

            //PdfPCell TAX_RETURN = new PdfPCell(new Phrase("Tax Returns", Times));
            //TAX_RETURN.HorizontalAlignment = Element.ALIGN_LEFT;
            //TAX_RETURN.FixedHeight = 15f;
            //TAX_RETURN.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //Income_Last.AddCell(TAX_RETURN);

            //if (drCaseMST["MST_VERIFY_OTHER"].ToString().Trim() == "Y")
            //{
            //    PdfPCell OTHER_Check = new PdfPCell(_image_Checked);
            //    OTHER_Check.VerticalAlignment = Element.ALIGN_MIDDLE;
            //    OTHER_Check.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
            //    //W2Cheked.FixedHeight = 15f;
            //    OTHER_Check.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(OTHER_Check);
            //}
            //else
            //{
            //    PdfPCell OTHER_UnCheked = new PdfPCell(_image_UnChecked);
            //    OTHER_UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
            //    OTHER_UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
            //    //W2UnCheked.FixedHeight = 15f;
            //    OTHER_UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(OTHER_UnCheked);
            //}

            //PdfPCell OTHER = new PdfPCell(new Phrase("Other", Times));
            //OTHER.HorizontalAlignment = Element.ALIGN_LEFT;
            //OTHER.FixedHeight = 15f;
            //OTHER.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //Income_Last.AddCell(OTHER);

            //PdfPCell Verification_Date = new PdfPCell(new Phrase("Verification Date:", Times));
            //Verification_Date.HorizontalAlignment = Element.ALIGN_LEFT;
            //Verification_Date.FixedHeight = 15f;
            //Verification_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //Income_Last.AddCell(Verification_Date);

            //if (!string.IsNullOrEmpty(drCaseMST["MST_ELIG_DATE"].ToString().Trim()))
            //{
            //    PdfPCell Verify_Date = new PdfPCell(new Phrase(drCaseMST["MST_ELIG_DATE"].ToString().Trim(), Timesline));
            //    Verify_Date.HorizontalAlignment = Element.ALIGN_LEFT;
            //    Verify_Date.FixedHeight = 15f;
            //    Verify_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(Verify_Date);
            //}
            //else
            //{
            //    PdfPCell Verify_Date_Space = new PdfPCell(new Phrase("________________", Times));
            //    Verify_Date_Space.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
            //    Verify_Date_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            //    Verify_Date_Space.FixedHeight = 15f;
            //    Verify_Date_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(Verify_Date_Space);
            //}

            //PdfPCell Verifier_Head = new PdfPCell(new Phrase("Verifier:", Times));
            //Verifier_Head.HorizontalAlignment = Element.ALIGN_LEFT;
            //Verifier_Head.FixedHeight = 15f;
            //Verifier_Head.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //Income_Last.AddCell(Verifier_Head);

            //string CaseWorker = null;
            //if (dtVerifier.Rows.Count > 0)
            //{
            //    foreach (DataRow drVerifier in dtVerifier.Rows)
            //    {
            //        if (drCaseMST["MST_VERIFIER"].ToString().Trim() == drVerifier["PWH_CASEWORKER"].ToString().Trim())
            //        {
            //            CaseWorker = drVerifier["NAME"].ToString().Trim();
            //            break;
            //        }
            //    }
            //}

            //if (!string.IsNullOrEmpty(CaseWorker))
            //{
            //    PdfPCell Verifier = new PdfPCell(new Phrase(CaseWorker, Timesline));
            //    Verifier.HorizontalAlignment = Element.ALIGN_LEFT;
            //    Verifier.FixedHeight = 15f;
            //    Verifier.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(Verifier);
            //}
            //else
            //{
            //    PdfPCell Verifier_Space = new PdfPCell(new Phrase("_______________________________", Times));
            //    Verifier_Space.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
            //    Verifier_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            //    Verifier_Space.FixedHeight = 15f;
            //    Verifier_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(Verifier_Space);
            //}

            //if (ShortName != "UETHDA")
            //{
            //    PdfPCell V_Space = new PdfPCell(new Phrase("", Times));
            //    V_Space.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
            //    V_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            //    V_Space.Colspan = 15;
            //    V_Space.FixedHeight = 15f;
            //    V_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(V_Space);

            //    PdfPCell P_Ver = new PdfPCell(new Phrase("Parent Verification ______________________________________________________________________________", Times));
            //    P_Ver.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
            //    P_Ver.HorizontalAlignment = Element.ALIGN_LEFT;
            //    P_Ver.Colspan = 11;
            //    P_Ver.FixedHeight = 15f;
            //    P_Ver.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(P_Ver);

            //    PdfPCell P_Ver1 = new PdfPCell(new Phrase("Reverify Date: ________________", Times));
            //    P_Ver1.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
            //    P_Ver1.HorizontalAlignment = Element.ALIGN_LEFT;
            //    P_Ver1.Colspan = 2;
            //    P_Ver1.FixedHeight = 15f;
            //    P_Ver1.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(P_Ver1);

            //    //PdfPCell Ver_Date_Space = new PdfPCell(new Phrase("________________", Times));
            //    //Ver_Date_Space.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
            //    //Ver_Date_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            //    //Ver_Date_Space.FixedHeight = 15f;
            //    //Ver_Date_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    //Income_Last.AddCell(Ver_Date_Space);

            //    PdfPCell P_Ver2 = new PdfPCell(new Phrase("Verifier ", Times));
            //    P_Ver2.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
            //    P_Ver2.HorizontalAlignment = Element.ALIGN_LEFT;
            //    //P_Ver2.Colspan = 4;
            //    P_Ver2.FixedHeight = 15f;
            //    P_Ver2.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(P_Ver2);

            //    PdfPCell Ver_Space = new PdfPCell(new Phrase("_______________________________", Times));
            //    Ver_Space.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
            //    Ver_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            //    Ver_Space.FixedHeight = 15f;
            //    Ver_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Income_Last.AddCell(Ver_Space);
            //}

            //End of Income Details

            #endregion

            //#region Start of Energy Calculations
            //PdfPTable Energy = new PdfPTable(3);
            //Energy.TotalWidth = 750f;
            //Energy.WidthPercentage = 100;
            //Energy.LockedWidth = true;
            //float[] Energy_widths = new float[] { 60, 60f, 60f };
            //Energy.SetWidths(Energy_widths);
            //Energy.HorizontalAlignment = Element.ALIGN_CENTER;
            //Energy.SpacingBefore = 20f;


            //if (Privileges.ModuleCode == "05" || gvApp.CurrentRow.Cells["AppDet"].Value.ToString() == "Application for Assistance" || DEPState == "TX")
            //{
            //    PdfPCell Compute = new PdfPCell(new Phrase("Compute Energy Burden", TblFontBold));
            //    Compute.HorizontalAlignment = Element.ALIGN_LEFT;
            //    Compute.FixedHeight = 15f;
            //    Compute.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Energy.AddCell(Compute);

            //    PdfPCell Compute_Space = new PdfPCell(new Phrase("", TableFontBoldItalic));
            //    Compute_Space.Colspan = 2;
            //    Compute_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            //    Compute_Space.FixedHeight = 15f;
            //    Compute_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Energy.AddCell(Compute_Space);

            //    decimal UtilityCost = 0; decimal EnergyBurden = 0;
            //    if (ADDCUST_List.Count > 0)
            //    {
            //        AddCustEntity Custdet = ADDCUST_List.Find(u => u.ACTCODE.Equals("C00012") && u.ACTAPPNO.Equals(BaseForm.BaseApplicationNo));
            //        if (Custdet != null)
            //        {
            //            if (!string.IsNullOrEmpty(Custdet.ACTNUMRESP.Trim()))
            //                UtilityCost = decimal.Parse(Custdet.ACTNUMRESP.Trim());
            //        }
            //    }

            //    PdfPCell Utility_Costs = new PdfPCell(new Phrase("Utility Costs: " + UtilityCost.ToString("0.00"), Times));
            //    Utility_Costs.HorizontalAlignment = Element.ALIGN_LEFT;
            //    Utility_Costs.FixedHeight = 15f;
            //    Utility_Costs.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Energy.AddCell(Utility_Costs);

            //    PdfPCell Annual_Income = new PdfPCell(new Phrase("Annual Income Total:" + drCaseMST["MST_FAM_INCOME"].ToString().Trim(), Times));
            //    Annual_Income.HorizontalAlignment = Element.ALIGN_CENTER;
            //    Annual_Income.FixedHeight = 15f;
            //    Annual_Income.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Energy.AddCell(Annual_Income);

            //    if (decimal.Parse(drCaseMST["MST_FAM_INCOME"].ToString().Trim()) > 0 && UtilityCost > 0)
            //        EnergyBurden = (UtilityCost / decimal.Parse(drCaseMST["MST_FAM_INCOME"].ToString().Trim())) * 100;

            //    PdfPCell Energy_Burden = new PdfPCell(new Phrase("Energy Burden: " + EnergyBurden.ToString("0.00") + "%", Times));
            //    Energy_Burden.HorizontalAlignment = Element.ALIGN_CENTER;
            //    Energy_Burden.FixedHeight = 15f;
            //    Energy_Burden.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //    Energy.AddCell(Energy_Burden);
            //}

            //#endregion


            //cb.BeginText();
            //X_Pos = 400; Y_Pos = 580;
            //cb.SetFontAndSize(bf_helv, 13);
            //cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Header_Desc, X_Pos, Y_Pos, 0);
            //cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Form_Selection, X_Pos, Y_Pos - 15, 0);
            //cb.SetFontAndSize(bf_helv, 9);
            //cb.EndText();

            //cb.BeginText();
            //X_Pos = 400; Y_Pos = 580;
            //cb.SetFontAndSize(bf_helv, 13);
            //cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Header_Desc, X_Pos, Y_Pos, 0);

            //cb.SetFontAndSize(bf_helv, 9);
            //cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Applicant No: ", 30, Y_Pos - 15, 0);
            //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(BaseForm.BaseApplicationNo, Timesline), 30 + 72, Y_Pos - 15, 0);

            //cb.SetFontAndSize(bf_helv, 13);
            //cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Form_Selection, X_Pos, Y_Pos - 15, 0);
            //cb.SetFontAndSize(bf_helv, 9);
            //cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Date Printed: ", 740, Y_Pos - 15, 0);
            //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase(LookupDataAccess.Getdate(DateTime.Now.ToShortDateString()), Times), 780, Y_Pos - 15, 0);

            //X_Pos = 30; Y_Pos -= 30;
            //cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Applicant Name   ", X_Pos, Y_Pos, 0);
            //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(BaseForm.BaseApplicationName, Timesline), X_Pos + 72, Y_Pos, 0);

            //cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Application Date: ", 740, Y_Pos, 0);
            //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase(LookupDataAccess.Getdate(drCaseMST["MST_INTAKE_DATE"].ToString().Trim()), Timesline), 780, Y_Pos, 0);

            //cb.EndText();

            //PdfPTable Spacetable = new PdfPTable(1);
            //Spacetable.HorizontalAlignment = Element.ALIGN_CENTER;
            //Spacetable.TotalWidth = 600f;

            //document.Add(Spacetable);



            //#endregion

            //#region Health Insurance Information

            //PdfPTable InsuranceTable = new PdfPTable(5);
            //InsuranceTable.TotalWidth = 750f;
            //InsuranceTable.WidthPercentage = 100;
            //InsuranceTable.LockedWidth = true;
            //float[] InsuranceTable_widths = new float[] { 25f, 30f, 45f, 60f, 25f };
            //InsuranceTable.SetWidths(InsuranceTable_widths);
            //InsuranceTable.HorizontalAlignment = Element.ALIGN_CENTER;
            //InsuranceTable.SpacingBefore = 10f;

            //PdfPCell INS_Head = new PdfPCell(new Phrase("HEALTH INSURANCE INFORMATION", TblFontBold));
            //INS_Head.Colspan = 5;
            //INS_Head.HorizontalAlignment = Element.ALIGN_LEFT;
            //INS_Head.FixedHeight = 15f;
            //INS_Head.Border = iTextSharp.text.Rectangle.BOX;
            //INS_Head.BorderWidth = 1f;
            //InsuranceTable.AddCell(INS_Head);

            //for (int i = 0; i < 4; i++)
            //{
            //    PdfPCell I1 = new PdfPCell(new Phrase("Name", TableFont));
            //    I1.HorizontalAlignment = Element.ALIGN_LEFT;
            //    I1.Colspan = 5;
            //    I1.FixedHeight = 15f;
            //    I1.BorderWidth = 1f;
            //    I1.Border = iTextSharp.text.Rectangle.BOX;
            //    InsuranceTable.AddCell(I1);

            //    if (chldMstDetails != null && i == 0)
            //    {
            //        PdfPCell I2 = new PdfPCell(new Phrase("Medical", TableFont));
            //        I2.HorizontalAlignment = Element.ALIGN_LEFT;
            //        I2.Rowspan = 2;
            //        I2.BorderWidth = 1f;
            //        I2.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(I2);

            //        PdfPCell I3 = new PdfPCell(new Phrase("Insurance Plan", TableFont));
            //        I3.HorizontalAlignment = Element.ALIGN_LEFT;
            //        I3.BorderWidth = 1f;
            //        I3.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(I3);

            //        PdfPCell I4 = new PdfPCell(new Phrase("Doctor Name", TableFont));
            //        I4.HorizontalAlignment = Element.ALIGN_LEFT;
            //        I4.BorderWidth = 1f;
            //        I4.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(I4);

            //        PdfPCell I5 = new PdfPCell(new Phrase(chldMstDetails.DoctorAddress.Trim(), TableFont));
            //        I5.HorizontalAlignment = Element.ALIGN_LEFT;
            //        I5.BorderWidth = 1f;
            //        I5.Rowspan = 2;
            //        I5.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(I5);

            //        PdfPCell I6 = new PdfPCell(new Phrase("Telephone", TableFont));
            //        I6.HorizontalAlignment = Element.ALIGN_LEFT;
            //        I6.BorderWidth = 1f;
            //        I6.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(I6);

            //        if (!string.IsNullOrEmpty(chldMstDetails.MedPlan.Trim()))
            //        {
            //            PdfPCell I7 = new PdfPCell(new Phrase(chldMstDetails.MedPlan.Trim(), TableFont));
            //            I7.HorizontalAlignment = Element.ALIGN_LEFT;
            //            I7.BorderWidth = 1f;
            //            I7.Border = iTextSharp.text.Rectangle.BOX;
            //            InsuranceTable.AddCell(I7);
            //        }
            //        else
            //        {
            //            PdfPCell I7 = new PdfPCell(new Phrase("", TableFont));
            //            I7.HorizontalAlignment = Element.ALIGN_LEFT;
            //            I7.BorderWidth = 1f;
            //            I7.FixedHeight = 15f;
            //            I7.Border = iTextSharp.text.Rectangle.BOX;
            //            InsuranceTable.AddCell(I7);
            //        }

            //        if (!string.IsNullOrEmpty(chldMstDetails.DoctorName.Trim()))
            //        {
            //            PdfPCell I8 = new PdfPCell(new Phrase(chldMstDetails.DoctorName.Trim(), TableFont));
            //            I8.HorizontalAlignment = Element.ALIGN_LEFT;
            //            I8.BorderWidth = 1f;
            //            I8.Border = iTextSharp.text.Rectangle.BOX;
            //            InsuranceTable.AddCell(I8);
            //        }
            //        else
            //        {
            //            PdfPCell I8 = new PdfPCell(new Phrase("", TableFont));
            //            I8.HorizontalAlignment = Element.ALIGN_LEFT;
            //            I8.BorderWidth = 1f;
            //            I8.FixedHeight = 15f;
            //            I8.Border = iTextSharp.text.Rectangle.BOX;
            //            InsuranceTable.AddCell(I8);
            //        }

            //        if (!string.IsNullOrEmpty(chldMstDetails.DoctorPhone.Trim()))
            //        {
            //            PdfPCell I9 = new PdfPCell(new Phrase(chldMstDetails.DoctorPhone.Trim(), TableFont));
            //            I9.HorizontalAlignment = Element.ALIGN_LEFT;
            //            I9.BorderWidth = 1f;
            //            I9.Border = iTextSharp.text.Rectangle.BOX;
            //            InsuranceTable.AddCell(I9);
            //        }
            //        else
            //        {
            //            PdfPCell I9 = new PdfPCell(new Phrase("", TableFont));
            //            I9.HorizontalAlignment = Element.ALIGN_LEFT;
            //            I9.BorderWidth = 1f;
            //            I9.FixedHeight = 15f;
            //            I9.Border = iTextSharp.text.Rectangle.BOX;
            //            InsuranceTable.AddCell(I9);
            //        }

            //        PdfPCell D1 = new PdfPCell(new Phrase("Dental", TableFont));
            //        D1.HorizontalAlignment = Element.ALIGN_LEFT;
            //        D1.BorderWidth = 1f;
            //        D1.Rowspan = 2;
            //        D1.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(D1);

            //        PdfPCell D2 = new PdfPCell(new Phrase("Insurance Plan", TableFont));
            //        D2.HorizontalAlignment = Element.ALIGN_LEFT;
            //        D2.BorderWidth = 1f;
            //        D2.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(I3);

            //        PdfPCell D3 = new PdfPCell(new Phrase("Doctor Name", TableFont));
            //        D3.HorizontalAlignment = Element.ALIGN_LEFT;
            //        D3.BorderWidth = 1f;
            //        D3.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(D3);

            //        PdfPCell D4 = new PdfPCell(new Phrase(chldMstDetails.DentistAddress.Trim(), TableFont));
            //        D4.HorizontalAlignment = Element.ALIGN_LEFT;
            //        D4.BorderWidth = 1f;
            //        D4.Rowspan = 2;
            //        D4.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(D4);

            //        PdfPCell D5 = new PdfPCell(new Phrase("Telephone", TableFont));
            //        D5.HorizontalAlignment = Element.ALIGN_LEFT;
            //        D5.BorderWidth = 1f;
            //        D5.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(D5);

            //        if (!string.IsNullOrEmpty(chldMstDetails.DentalPlan.Trim()))
            //        {
            //            PdfPCell D6 = new PdfPCell(new Phrase(chldMstDetails.DentalPlan.Trim(), TableFont));
            //            D6.HorizontalAlignment = Element.ALIGN_LEFT;
            //            D6.BorderWidth = 1f;
            //            D6.Border = iTextSharp.text.Rectangle.BOX;
            //            InsuranceTable.AddCell(D6);
            //        }
            //        else
            //        {
            //            PdfPCell D6 = new PdfPCell(new Phrase("", TableFont));
            //            D6.HorizontalAlignment = Element.ALIGN_LEFT;
            //            D6.BorderWidth = 1f;
            //            D6.FixedHeight = 15f;
            //            D6.Border = iTextSharp.text.Rectangle.BOX;
            //            InsuranceTable.AddCell(D6);
            //        }

            //        if (!string.IsNullOrEmpty(chldMstDetails.DentistName.Trim()))
            //        {
            //            PdfPCell D7 = new PdfPCell(new Phrase(chldMstDetails.DentistName.Trim(), TableFont));
            //            D7.HorizontalAlignment = Element.ALIGN_LEFT;
            //            D7.BorderWidth = 1f;
            //            D7.Border = iTextSharp.text.Rectangle.BOX;
            //            InsuranceTable.AddCell(D7);
            //        }
            //        else
            //        {
            //            PdfPCell D7 = new PdfPCell(new Phrase("", TableFont));
            //            D7.HorizontalAlignment = Element.ALIGN_LEFT;
            //            D7.BorderWidth = 1f;
            //            D7.FixedHeight = 15f;
            //            D7.Border = iTextSharp.text.Rectangle.BOX;
            //            InsuranceTable.AddCell(D7);
            //        }

            //        if (!string.IsNullOrEmpty(chldMstDetails.DentistPhone.Trim()))
            //        {
            //            PdfPCell D8 = new PdfPCell(new Phrase(chldMstDetails.DentistPhone.Trim(), TableFont));
            //            D8.HorizontalAlignment = Element.ALIGN_LEFT;
            //            D8.BorderWidth = 1f;
            //            D8.Border = iTextSharp.text.Rectangle.BOX;
            //            InsuranceTable.AddCell(D8);
            //        }
            //        else
            //        {
            //            PdfPCell D8 = new PdfPCell(new Phrase("", TableFont));
            //            D8.HorizontalAlignment = Element.ALIGN_LEFT;
            //            D8.BorderWidth = 1f;
            //            D8.FixedHeight = 15f;
            //            D8.Border = iTextSharp.text.Rectangle.BOX;
            //            InsuranceTable.AddCell(D8);
            //        }
            //    }
            //    else
            //    {
            //        PdfPCell I2 = new PdfPCell(new Phrase("Medical", TableFont));
            //        I2.HorizontalAlignment = Element.ALIGN_LEFT;
            //        I2.Rowspan = 2;
            //        I2.BorderWidth = 1f;
            //        I2.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(I2);

            //        PdfPCell I3 = new PdfPCell(new Phrase("Insurance Plan", TableFont));
            //        I3.HorizontalAlignment = Element.ALIGN_LEFT;
            //        I3.BorderWidth = 1f;
            //        I3.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(I3);

            //        PdfPCell I4 = new PdfPCell(new Phrase("Doctor Name", TableFont));
            //        I4.HorizontalAlignment = Element.ALIGN_LEFT;
            //        I4.BorderWidth = 1f;
            //        I4.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(I4);

            //        PdfPCell I5 = new PdfPCell(new Phrase("", TableFont));
            //        I5.HorizontalAlignment = Element.ALIGN_LEFT;
            //        I5.BorderWidth = 1f;
            //        I5.Rowspan = 2;
            //        I5.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(I5);

            //        PdfPCell I6 = new PdfPCell(new Phrase("Telephone", TableFont));
            //        I6.HorizontalAlignment = Element.ALIGN_LEFT;
            //        I6.BorderWidth = 1f;
            //        I6.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(I6);

            //        PdfPCell I7 = new PdfPCell(new Phrase("", TableFont));
            //        I7.HorizontalAlignment = Element.ALIGN_LEFT;
            //        I7.BorderWidth = 1f;
            //        I7.FixedHeight = 15f;
            //        I7.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(I7);

            //        PdfPCell I8 = new PdfPCell(new Phrase("", TableFont));
            //        I8.HorizontalAlignment = Element.ALIGN_LEFT;
            //        I8.BorderWidth = 1f;
            //        I8.FixedHeight = 15f;
            //        I8.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(I8);

            //        PdfPCell I9 = new PdfPCell(new Phrase("", TableFont));
            //        I9.HorizontalAlignment = Element.ALIGN_LEFT;
            //        I9.BorderWidth = 1f;
            //        I9.FixedHeight = 15f;
            //        I9.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(I9);


            //        PdfPCell D1 = new PdfPCell(new Phrase("Dental", TableFont));
            //        D1.HorizontalAlignment = Element.ALIGN_LEFT;
            //        D1.BorderWidth = 1f;
            //        D1.Rowspan = 2;
            //        D1.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(D1);

            //        PdfPCell D2 = new PdfPCell(new Phrase("Insurance Plan", TableFont));
            //        D2.HorizontalAlignment = Element.ALIGN_LEFT;
            //        D2.BorderWidth = 1f;
            //        D2.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(I3);

            //        PdfPCell D3 = new PdfPCell(new Phrase("Doctor Name", TableFont));
            //        D3.HorizontalAlignment = Element.ALIGN_LEFT;
            //        D3.BorderWidth = 1f;
            //        D3.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(D3);

            //        PdfPCell D4 = new PdfPCell(new Phrase("", TableFont));
            //        D4.HorizontalAlignment = Element.ALIGN_LEFT;
            //        D4.BorderWidth = 1f;
            //        D4.Rowspan = 2;
            //        D4.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(D4);

            //        PdfPCell D5 = new PdfPCell(new Phrase("Telephone", TableFont));
            //        D5.HorizontalAlignment = Element.ALIGN_LEFT;
            //        D5.BorderWidth = 1f;
            //        D5.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(D5);

            //        PdfPCell D6 = new PdfPCell(new Phrase("", TableFont));
            //        D6.HorizontalAlignment = Element.ALIGN_LEFT;
            //        D6.BorderWidth = 1f;
            //        D6.FixedHeight = 15f;
            //        D6.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(D6);

            //        PdfPCell D7 = new PdfPCell(new Phrase("", TableFont));
            //        D7.HorizontalAlignment = Element.ALIGN_LEFT;
            //        D7.BorderWidth = 1f;
            //        D7.FixedHeight = 15f;
            //        D7.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(D7);

            //        PdfPCell D8 = new PdfPCell(new Phrase("", TableFont));
            //        D8.HorizontalAlignment = Element.ALIGN_LEFT;
            //        D8.BorderWidth = 1f;
            //        D8.FixedHeight = 15f;
            //        D8.Border = iTextSharp.text.Rectangle.BOX;
            //        InsuranceTable.AddCell(D8);
            //    }
            //}

            //document.Add(InsuranceTable);

            //#endregion

            //#region Mediacal data from chldmst

            ////PdfPTable MediaclTable = new PdfPTable(4);
            ////MediaclTable.TotalWidth = 750f;
            ////MediaclTable.WidthPercentage = 100;
            ////MediaclTable.LockedWidth = true;
            ////float[] MediaclTable_widths = new float[] { 55f, 50f, 40f, 50f };
            ////MediaclTable.SetWidths(MediaclTable_widths);
            ////MediaclTable.HorizontalAlignment = Element.ALIGN_CENTER;
            ////MediaclTable.SpacingBefore = 10f;
            ////if (chldMstDetails != null)
            ////{

            ////    PdfPCell Chld_Med_Plan = new PdfPCell(new Phrase("Child Medical Insurance Plan", Times));
            ////    Chld_Med_Plan.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Med_Plan.FixedHeight = 15f;
            ////    Chld_Med_Plan.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Med_Plan);

            ////    if (!string.IsNullOrEmpty(chldMstDetails.MedPlan.Trim()))
            ////    {
            ////        PdfPCell Chld_Med_Plan_Line = new PdfPCell(new Phrase(chldMstDetails.MedPlan.Trim(), Timesline));
            ////        Chld_Med_Plan_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Med_Plan_Line.FixedHeight = 15f;
            ////        Chld_Med_Plan_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Med_Plan_Line);
            ////    }
            ////    else
            ////    {
            ////        PdfPCell Chld_Med_Plan_Line = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        Chld_Med_Plan_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Med_Plan_Line.FixedHeight = 15f;
            ////        Chld_Med_Plan_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Med_Plan_Line);
            ////    }

            ////    PdfPCell Chld_Med_No = new PdfPCell(new Phrase("Medical Insurance Name", Times));
            ////    Chld_Med_No.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////    //Emer_Space.Colspan = 2;
            ////    Chld_Med_No.FixedHeight = 15f;
            ////    Chld_Med_No.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Med_No);

            ////    if (!string.IsNullOrEmpty(chldMstDetails.MedInsurer.Trim()))
            ////    {
            ////        PdfPCell Chld_Med_No_Line = new PdfPCell(new Phrase(chldMstDetails.MedInsurer.Trim(), Timesline));
            ////        Chld_Med_No_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Med_No_Line.FixedHeight = 15f;
            ////        Chld_Med_No_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Med_No_Line);
            ////    }
            ////    else
            ////    {
            ////        PdfPCell Chld_Med_No_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////        Chld_Med_No_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Med_No_Line.FixedHeight = 15f;
            ////        Chld_Med_No_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Med_No_Line);
            ////    }

            ////    PdfPCell Chld_Ins_Catg = new PdfPCell(new Phrase("Medical Insurance Category", Times));
            ////    Chld_Ins_Catg.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    //Emer_Space.Colspan = 2;
            ////    Chld_Ins_Catg.FixedHeight = 15f;
            ////    Chld_Ins_Catg.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Ins_Catg);

            ////    if (!string.IsNullOrEmpty(chldMstDetails.InsCat.Trim()))
            ////    {
            ////        string INS_CATG_DESC=string.Empty;
            ////        if (lookInsuranceCategory.Count > 0)
            ////        {
            ////            foreach (CommonEntity Ins in lookInsuranceCategory)
            ////            {
            ////                if (chldMstDetails.InsCat.Trim() == Ins.Code.Trim())
            ////                {
            ////                    INS_CATG_DESC = Ins.Desc.Trim(); break;
            ////                }
            ////            }
            ////        }

            ////        PdfPCell Chld_Med_No_Line = new PdfPCell(new Phrase(INS_CATG_DESC, Timesline));
            ////        Chld_Med_No_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Med_No_Line.FixedHeight = 15f;
            ////        Chld_Med_No_Line.Colspan = 3;
            ////        Chld_Med_No_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Med_No_Line);
            ////    }
            ////    else
            ////    {
            ////        PdfPCell Chld_Med_No_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////        Chld_Med_No_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Med_No_Line.Colspan = 3;
            ////        Chld_Med_No_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Med_No_Line);
            ////    }


            ////    PdfPCell Chld_Doctor = new PdfPCell(new Phrase("Child Doctor & Address", Times));
            ////    Chld_Doctor.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Doctor.FixedHeight = 15f;
            ////    Chld_Doctor.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Doctor);

            ////    if (!string.IsNullOrEmpty(chldMstDetails.DoctorName.Trim()))
            ////    {
            ////        PdfPCell Chld_Doctor_Line = new PdfPCell(new Phrase(chldMstDetails.DoctorName.Trim() + ", " + chldMstDetails.DoctorAddress, Timesline));
            ////        Chld_Doctor_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Doctor_Line.FixedHeight = 15f;
            ////        Chld_Doctor_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Doctor_Line);
            ////    }
            ////    else
            ////    {
            ////        PdfPCell Chld_Doctor_Line = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        Chld_Doctor_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Doctor_Line.FixedHeight = 15f;
            ////        Chld_Doctor_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Doctor_Line);
            ////    }

            ////    PdfPCell Chld_Doc_Phone = new PdfPCell(new Phrase("Phone#", Times));
            ////    Chld_Doc_Phone.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////    //Emer_Space.Colspan = 2;
            ////    Chld_Doc_Phone.FixedHeight = 15f;
            ////    Chld_Doc_Phone.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Doc_Phone);

            ////    if (!string.IsNullOrEmpty(chldMstDetails.DoctorPhone.Trim()))
            ////    {
            ////        MaskedTextBox mskdocphn = new MaskedTextBox();
            ////        mskdocphn.Mask = "(000)000-0000";
            ////        mskdocphn.Text = chldMstDetails.DoctorPhone.Trim();
            ////        PdfPCell Chld_Doc_Phone_Line = new PdfPCell(new Phrase(mskdocphn.Text.Trim(), Timesline));
            ////        Chld_Doc_Phone_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Doc_Phone_Line.FixedHeight = 15f;
            ////        Chld_Doc_Phone_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Doc_Phone_Line);
            ////    }
            ////    else
            ////    {
            ////        PdfPCell Chld_Doc_Phone_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////        Chld_Doc_Phone_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Doc_Phone_Line.FixedHeight = 15f;
            ////        Chld_Doc_Phone_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Doc_Phone_Line);
            ////    }


            ////    PdfPCell Emer_Space2 = new PdfPCell(new Phrase("", Times));
            ////    Emer_Space2.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Emer_Space2.Colspan = 4;
            ////    Emer_Space2.FixedHeight = 10f;
            ////    Emer_Space2.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Emer_Space2);

            ////    PdfPCell Chld_Dent_Plan = new PdfPCell(new Phrase("Child Dental Insurance Plan", Times));
            ////    Chld_Dent_Plan.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Dent_Plan.FixedHeight = 15f;
            ////    Chld_Dent_Plan.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Dent_Plan);

            ////    if (!string.IsNullOrEmpty(chldMstDetails.DentalPlan.Trim()))
            ////    {
            ////        PdfPCell Chld_Dent_Plan_Line = new PdfPCell(new Phrase(chldMstDetails.DentalPlan.Trim(), Timesline));
            ////        Chld_Dent_Plan_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Dent_Plan_Line.FixedHeight = 15f;
            ////        Chld_Dent_Plan_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Dent_Plan_Line);
            ////    }
            ////    else
            ////    {
            ////        PdfPCell Chld_Dent_Plan_Line = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        Chld_Dent_Plan_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Dent_Plan_Line.FixedHeight = 15f;
            ////        Chld_Dent_Plan_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Dent_Plan_Line);
            ////    }

            ////    PdfPCell Chld_Dent_No = new PdfPCell(new Phrase("Dental Insurance Name", Times));
            ////    Chld_Dent_No.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////    //Emer_Space.Colspan = 2;
            ////    Chld_Dent_No.FixedHeight = 15f;
            ////    Chld_Dent_No.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Dent_No);

            ////    if (!string.IsNullOrEmpty(chldMstDetails.DentalInsurer.Trim()))
            ////    {
            ////        PdfPCell Chld_Dent_No_Line = new PdfPCell(new Phrase(chldMstDetails.DentalInsurer.Trim(), Timesline));
            ////        Chld_Dent_No_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Dent_No_Line.FixedHeight = 15f;
            ////        Chld_Dent_No_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Dent_No_Line);
            ////    }
            ////    else
            ////    {
            ////        PdfPCell Chld_Dent_No_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////        Chld_Dent_No_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Dent_No_Line.FixedHeight = 15f;
            ////        Chld_Dent_No_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Dent_No_Line);
            ////    }


            ////    PdfPCell Chld_Dentist = new PdfPCell(new Phrase("Child Dentist & Address", Times));
            ////    Chld_Dentist.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Dentist.FixedHeight = 15f;
            ////    Chld_Dentist.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Dentist);
            ////    if (!string.IsNullOrEmpty(chldMstDetails.DentistName.Trim()))
            ////    {
            ////        PdfPCell Chld_Dentist_Line = new PdfPCell(new Phrase(chldMstDetails.DentistName.Trim() + ", " + chldMstDetails.DentistAddress, Timesline));
            ////        Chld_Dentist_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Dentist_Line.FixedHeight = 15f;
            ////        Chld_Dentist_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Dentist_Line);
            ////    }
            ////    else
            ////    {
            ////        PdfPCell Chld_Dentist_Line = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        Chld_Dentist_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Dentist_Line.FixedHeight = 15f;
            ////        Chld_Dentist_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Dentist_Line);
            ////    }

            ////    PdfPCell Chld_Dentist_Phone = new PdfPCell(new Phrase("Phone#", Times));
            ////    Chld_Dentist_Phone.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////    //Emer_Space.Colspan = 2;
            ////    Chld_Dentist_Phone.FixedHeight = 15f;
            ////    Chld_Dentist_Phone.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Dentist_Phone);

            ////    if (!string.IsNullOrEmpty(chldMstDetails.DentistPhone.Trim()))
            ////    {
            ////        MaskedTextBox mskdocphn = new MaskedTextBox();
            ////        mskdocphn.Mask = "(000)000-0000";
            ////        mskdocphn.Text = chldMstDetails.DentistPhone.Trim();
            ////        PdfPCell Chld_Dentist_Phone_Line = new PdfPCell(new Phrase(mskdocphn.Text.Trim(), Timesline));
            ////        Chld_Dentist_Phone_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Dentist_Phone_Line.FixedHeight = 15f;
            ////        Chld_Dentist_Phone_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Dentist_Phone_Line);
            ////    }
            ////    else
            ////    {
            ////        PdfPCell Chld_Dentist_Phone_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////        Chld_Dentist_Phone_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Chld_Dentist_Phone_Line.FixedHeight = 15f;
            ////        Chld_Dentist_Phone_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Chld_Dentist_Phone_Line);
            ////    }

            ////    PdfPCell Emer_Space3 = new PdfPCell(new Phrase("", Times));
            ////    Emer_Space3.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Emer_Space3.Colspan = 4;
            ////    Emer_Space3.FixedHeight = 10f;
            ////    Emer_Space3.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Emer_Space3);

            ////    if (caseconddet != null)
            ////    {
            ////        PdfPCell ALLERGIES = new PdfPCell(new Phrase("My Child has the following ALLERGIES", Times));
            ////        ALLERGIES.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        ALLERGIES.FixedHeight = 15f;
            ////        ALLERGIES.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(ALLERGIES);

            ////        if (!string.IsNullOrEmpty(caseconddet.Allergy.Trim()))
            ////        {
            ////            string Allergy_desc = caseconddet.Allergy.Replace("\r\n", " ");
            ////            PdfPCell ALLERGIESLine = new PdfPCell(new Phrase(Allergy_desc.Trim(), Timesline));
            ////            ALLERGIESLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            ALLERGIESLine.Colspan = 2;
            ////            ALLERGIESLine.FixedHeight = 15f;
            ////            ALLERGIESLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(ALLERGIESLine);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell ALLERGIESLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            ALLERGIESLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            ALLERGIESLine.Colspan = 2;
            ////            ALLERGIESLine.FixedHeight = 15f;
            ////            ALLERGIESLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(ALLERGIESLine);
            ////        }
            ////        PdfPCell ALLERGIES_Space = new PdfPCell(new Phrase("", Times));
            ////        ALLERGIES_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //ALLERGIES_Space.Colspan = 2;
            ////        ALLERGIES_Space.FixedHeight = 15f;
            ////        ALLERGIES_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(ALLERGIES_Space);

            ////        PdfPCell DISABILITY = new PdfPCell(new Phrase("Has been diagonosed with following DISABILITY", Times));
            ////        DISABILITY.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        DISABILITY.FixedHeight = 15f;
            ////        DISABILITY.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DISABILITY);

            ////        if (!string.IsNullOrEmpty(chldMstDetails.Disability.Trim()))
            ////        {
            ////            PdfPCell DISABILITYLine = new PdfPCell(new Phrase(chldMstDetails.DisabilityType.Trim(), Timesline));
            ////            DISABILITYLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            DISABILITYLine.FixedHeight = 15f;
            ////            DISABILITYLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(DISABILITYLine);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell DISABILITYLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            DISABILITYLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            DISABILITYLine.FixedHeight = 15f;
            ////            DISABILITYLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(DISABILITYLine);
            ////        }

            ////        PdfPCell DISABILITY_Date = new PdfPCell(new Phrase("Date", Times));
            ////        DISABILITY_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////        //DISABILITY_Space.Colspan = 2;
            ////        DISABILITY_Date.FixedHeight = 15f;
            ////        DISABILITY_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DISABILITY_Date);

            ////        if (!string.IsNullOrEmpty(chldMstDetails.DiagnosisDate.Trim()))
            ////        {
            ////            PdfPCell DISABILITY_Date_Line = new PdfPCell(new Phrase(LookupDataAccess.Getdate(chldMstDetails.DiagnosisDate.Trim()), Timesline));
            ////            DISABILITY_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            DISABILITY_Date_Line.FixedHeight = 15f;
            ////            DISABILITY_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(DISABILITY_Date_Line);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell DISABILITY_Date_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////            DISABILITY_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            DISABILITY_Date_Line.FixedHeight = 15f;
            ////            DISABILITY_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(DISABILITY_Date_Line);
            ////        }


            ////        PdfPCell MEDICATIONS = new PdfPCell(new Phrase("is taking following MEDICATIONS", Times));
            ////        MEDICATIONS.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        MEDICATIONS.FixedHeight = 15f;
            ////        MEDICATIONS.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICATIONS);

            ////        if (!string.IsNullOrEmpty(caseconddet.Medications.Trim()))
            ////        {
            ////            string Medications_desc = caseconddet.Medications.Replace("\r\n", " ");
            ////            PdfPCell MEDICATIONSLine = new PdfPCell(new Phrase(Medications_desc.Trim(), Timesline));
            ////            MEDICATIONSLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICATIONSLine.Colspan = 2;
            ////            MEDICATIONSLine.FixedHeight = 15f;
            ////            MEDICATIONSLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICATIONSLine);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell MEDICATIONSLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            MEDICATIONSLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICATIONSLine.Colspan = 2;
            ////            MEDICATIONSLine.FixedHeight = 15f;
            ////            MEDICATIONSLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICATIONSLine);
            ////        }

            ////        PdfPCell MEDICATIONS_Space = new PdfPCell(new Phrase("", Times));
            ////        MEDICATIONS_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //MEDICATIONS_Space.Colspan = 2;
            ////        MEDICATIONS_Space.FixedHeight = 15f;
            ////        MEDICATIONS_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICATIONS_Space);

            ////        PdfPCell MEDICAL = new PdfPCell(new Phrase("has the following MEDICAL CONDITIONS", Times));
            ////        MEDICAL.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        MEDICAL.FixedHeight = 15f;
            ////        MEDICAL.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICAL);

            ////        if (!string.IsNullOrEmpty(caseconddet.MedConds.Trim()))
            ////        {
            ////            string MedConds_desc = caseconddet.MedConds.Replace("\r\n", " ");
            ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase(MedConds_desc.Trim(), Timesline));
            ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICALLine.Colspan = 2;
            ////            MEDICALLine.FixedHeight = 15f;
            ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICALLine);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICALLine.Colspan = 2;
            ////            MEDICALLine.FixedHeight = 15f;
            ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICALLine);
            ////        }

            ////        PdfPCell MEDICAL_Space = new PdfPCell(new Phrase("", Times));
            ////        MEDICAL_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //MEDICAL_Space.Colspan = 2;
            ////        MEDICAL_Space.FixedHeight = 15f;
            ////        MEDICAL_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICAL_Space);

            ////        PdfPCell Diet = new PdfPCell(new Phrase("DIETARY RESTRICTIONS", Times));
            ////        Diet.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Diet.FixedHeight = 15f;
            ////        Diet.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Diet);

            ////        if (!string.IsNullOrEmpty(caseconddet.DietRestrct.Trim()))
            ////        {
            ////            string MedConds_desc = caseconddet.DietRestrct.Replace("\r\n", " ");
            ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase(MedConds_desc.Trim(), Timesline));
            ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICALLine.Colspan = 2;
            ////            MEDICALLine.FixedHeight = 15f;
            ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICALLine);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICALLine.Colspan = 2;
            ////            MEDICALLine.FixedHeight = 15f;
            ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICALLine);
            ////        }

            ////        PdfPCell DIET_Space = new PdfPCell(new Phrase("", Times));
            ////        DIET_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //MEDICAL_Space.Colspan = 2;
            ////        DIET_Space.FixedHeight = 15f;
            ////        DIET_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DIET_Space);

            ////        PdfPCell House = new PdfPCell(new Phrase("HOUSEHOLD CONCERNS ", Times));
            ////        House.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        House.FixedHeight = 15f;
            ////        House.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(House);

            ////        if (!string.IsNullOrEmpty(caseconddet.HHConcerns.Trim()))
            ////        {
            ////            string MedConds_desc = caseconddet.HHConcerns.Replace("\r\n", " ");
            ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase(MedConds_desc.Trim(), Timesline));
            ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICALLine.Colspan = 2;
            ////            MEDICALLine.FixedHeight = 15f;
            ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICALLine);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICALLine.Colspan = 2;
            ////            MEDICALLine.FixedHeight = 15f;
            ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICALLine);
            ////        }

            ////        PdfPCell HH_Space = new PdfPCell(new Phrase("", Times));
            ////        HH_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //MEDICAL_Space.Colspan = 2;
            ////        HH_Space.FixedHeight = 15f;
            ////        HH_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(HH_Space);

            ////        PdfPCell Devp = new PdfPCell(new Phrase("DEVELOPMENTAL CONCERNS ", Times));
            ////        Devp.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Devp.FixedHeight = 15f;
            ////        Devp.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Devp);

            ////        if (!string.IsNullOrEmpty(caseconddet.DevlConcerns.Trim()))
            ////        {
            ////            string MedConds_desc = caseconddet.DevlConcerns.Replace("\r\n", " ");
            ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase(MedConds_desc.Trim(), Timesline));
            ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICALLine.Colspan = 2;
            ////            MEDICALLine.FixedHeight = 15f;
            ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICALLine);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICALLine.Colspan = 2;
            ////            MEDICALLine.FixedHeight = 15f;
            ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICALLine);
            ////        }

            ////        PdfPCell DEVL_Space = new PdfPCell(new Phrase("", Times));
            ////        DEVL_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //MEDICAL_Space.Colspan = 2;
            ////        DEVL_Space.FixedHeight = 15f;
            ////        DEVL_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DEVL_Space);

            ////        PdfPCell AltFnd = new PdfPCell(new Phrase("Alternate Fund", Times));
            ////        AltFnd.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        AltFnd.FixedHeight = 15f;
            ////        AltFnd.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(AltFnd);

            ////        if (!string.IsNullOrEmpty(chldMstDetails.AltFundSrc.Trim()))
            ////        {
            ////            string AltFund_Desc = string.Empty;
            ////            foreach (DataRow drFUND in dtFUND.Rows)
            ////            {
            ////                if (chldMstDetails.AltFundSrc.ToString().Trim() == drFUND["Code"].ToString().Trim())
            ////                {
            ////                    AltFund_Desc = drFUND["LookUpDesc"].ToString().Trim(); break;
            ////                }
            ////            }

            ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase(AltFund_Desc, Timesline));
            ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            AltFnddesc.FixedHeight = 15f;
            ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(AltFnddesc);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            AltFnddesc.FixedHeight = 15f;
            ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(AltFnddesc);
            ////        }

            ////        PdfPCell Trans = new PdfPCell(new Phrase("Transport", Times));
            ////        Trans.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////        Trans.FixedHeight = 15f;
            ////        Trans.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Trans);

            ////        if (!string.IsNullOrEmpty(chldMstDetails.Transport.Trim()))
            ////        {
            ////            string Trans_Desc = string.Empty;
            ////            List<CommonEntity> lookClsTransport = _model.lookupDataAccess.GetCMBTransport();
            ////            foreach (CommonEntity agyEntity in lookClsTransport)
            ////            {
            ////                if (chldMstDetails.Transport.ToString().Trim() == agyEntity.Code.ToString().Trim())
            ////                {
            ////                    Trans_Desc = agyEntity.Desc.ToString().Trim(); break;
            ////                }
            ////            }

            ////            if (!string.IsNullOrEmpty(Trans_Desc.Trim()))
            ////            {
            ////                PdfPCell AltFnddesc = new PdfPCell(new Phrase(Trans_Desc, Timesline));
            ////                AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////                AltFnddesc.FixedHeight = 15f;
            ////                AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////                MediaclTable.AddCell(AltFnddesc);
            ////            }
            ////            else
            ////            {
            ////                PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________", Times));
            ////                AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////                AltFnddesc.FixedHeight = 15f;
            ////                AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////                MediaclTable.AddCell(AltFnddesc);
            ////            }
            ////        }
            ////        else
            ////        {
            ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________", Times));
            ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            AltFnddesc.FixedHeight = 15f;
            ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(AltFnddesc);
            ////        }

            ////        PdfPCell Pick = new PdfPCell(new Phrase("Pickup", Times));
            ////        Pick.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Pick.FixedHeight = 15f;
            ////        Pick.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Pick);

            ////        if (!string.IsNullOrEmpty(chldMstDetails.PickOff.Trim()))
            ////        {
            ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase(chldMstDetails.PickOff.Trim(), Timesline));
            ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            AltFnddesc.FixedHeight = 15f;
            ////            AltFnddesc.Colspan = 3;
            ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(AltFnddesc);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            AltFnddesc.FixedHeight = 15f;
            ////            AltFnddesc.Colspan = 3;
            ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(AltFnddesc);
            ////        }

            ////        PdfPCell Drop = new PdfPCell(new Phrase("Dropoff", Times));
            ////        Drop.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Drop.FixedHeight = 15f;
            ////        Drop.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Drop);

            ////        if (!string.IsNullOrEmpty(chldMstDetails.DropOff.Trim()))
            ////        {
            ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase(chldMstDetails.DropOff.Trim(), Timesline));
            ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            AltFnddesc.FixedHeight = 15f;
            ////            AltFnddesc.Colspan = 3;
            ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(AltFnddesc);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            AltFnddesc.FixedHeight = 15f;
            ////            AltFnddesc.Colspan = 3;
            ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(AltFnddesc);
            ////        }

            ////        PdfPCell Last_Space = new PdfPCell(new Phrase("", Times));
            ////        Last_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Last_Space.Colspan = 4;
            ////        Last_Space.FixedHeight = 15f;
            ////        Last_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Last_Space);

            ////        PdfPCell Signature = new PdfPCell(new Phrase("Signature of Parent/Gurdian", Times));
            ////        Signature.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //Signature.FixedHeight = 15f;
            ////        Signature.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Signature);

            ////        PdfPCell SignatureLine = new PdfPCell(new Phrase("______________________________________", Times));
            ////        SignatureLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //SignatureLine.FixedHeight = 15f;
            ////        SignatureLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(SignatureLine);

            ////        PdfPCell Signature_Date = new PdfPCell(new Phrase("Date", Times));
            ////        Signature_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////        //DISABILITY_Space.Colspan = 2;
            ////        //Signature_Date.FixedHeight = 15f;
            ////        Signature_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Signature_Date);

            ////        PdfPCell Signature_Date_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////        Signature_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //Signature_Date_Line.FixedHeight = 15f;
            ////        Signature_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Signature_Date_Line);

            ////        PdfPCell Line_Last = new PdfPCell(new Phrase("", Times));
            ////        Line_Last.HorizontalAlignment = Element.ALIGN_CENTER;
            ////        Line_Last.Colspan = 6;
            ////        //Line_Last.FixedHeight = 15f;
            ////        Line_Last.BorderWidthBottom = 2f;
            ////        Line_Last.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
            ////        MediaclTable.AddCell(Line_Last);
            ////    }
            ////    else
            ////    {
            ////        PdfPCell ALLERGIES = new PdfPCell(new Phrase("My Child has the following ALLERGIES", Times));
            ////        ALLERGIES.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        ALLERGIES.FixedHeight = 15f;
            ////        ALLERGIES.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(ALLERGIES);

            ////        PdfPCell ALLERGIESLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        ALLERGIESLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        ALLERGIESLine.FixedHeight = 15f;
            ////        ALLERGIESLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(ALLERGIESLine);

            ////        PdfPCell ALLERGIES_Space = new PdfPCell(new Phrase("", Times));
            ////        ALLERGIES_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        ALLERGIES_Space.Colspan = 2;
            ////        ALLERGIES_Space.FixedHeight = 15f;
            ////        ALLERGIES_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(ALLERGIES_Space);

            ////        PdfPCell DISABILITY = new PdfPCell(new Phrase("Has been diagonosed with following DISABILITY", Times));
            ////        DISABILITY.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        DISABILITY.FixedHeight = 15f;
            ////        DISABILITY.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DISABILITY);

            ////        PdfPCell DISABILITYLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        DISABILITYLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        DISABILITYLine.FixedHeight = 15f;
            ////        DISABILITYLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DISABILITYLine);

            ////        PdfPCell DISABILITY_Date = new PdfPCell(new Phrase("Date", Times));
            ////        DISABILITY_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////        //DISABILITY_Space.Colspan = 2;
            ////        DISABILITY_Date.FixedHeight = 15f;
            ////        DISABILITY_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DISABILITY_Date);

            ////        PdfPCell DISABILITY_Date_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////        DISABILITY_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        DISABILITY_Date_Line.FixedHeight = 15f;
            ////        DISABILITY_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DISABILITY_Date_Line);

            ////        PdfPCell MEDICATIONS = new PdfPCell(new Phrase("is taking following MEDICATIONS", Times));
            ////        MEDICATIONS.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        MEDICATIONS.FixedHeight = 15f;
            ////        MEDICATIONS.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICATIONS);

            ////        PdfPCell MEDICATIONSLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        MEDICATIONSLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        MEDICATIONSLine.FixedHeight = 15f;
            ////        MEDICATIONSLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICATIONSLine);

            ////        PdfPCell MEDICATIONS_Space = new PdfPCell(new Phrase("", Times));
            ////        MEDICATIONS_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        MEDICATIONS_Space.Colspan = 2;
            ////        MEDICATIONS_Space.FixedHeight = 15f;
            ////        MEDICATIONS_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICATIONS_Space);

            ////        PdfPCell MEDICAL = new PdfPCell(new Phrase("has the following MEDICAL CONDITIONS", Times));
            ////        MEDICAL.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        MEDICAL.FixedHeight = 15f;
            ////        MEDICAL.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICAL);

            ////        PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        MEDICALLine.FixedHeight = 15f;
            ////        MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICALLine);

            ////        PdfPCell MEDICAL_Space = new PdfPCell(new Phrase("", Times));
            ////        MEDICAL_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        MEDICAL_Space.Colspan = 2;
            ////        MEDICAL_Space.FixedHeight = 15f;
            ////        MEDICAL_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICAL_Space);

            ////        PdfPCell Diet = new PdfPCell(new Phrase("DIETARY RESTRICTIONS", Times));
            ////        Diet.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Diet.FixedHeight = 15f;
            ////        Diet.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Diet);

            ////        PdfPCell DIETLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        DIETLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //DIETLine.Colspan = 2;
            ////        DIETLine.FixedHeight = 15f;
            ////        DIETLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DIETLine);

            ////        PdfPCell DIET_Space = new PdfPCell(new Phrase("", Times));
            ////        DIET_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        DIET_Space.Colspan = 2;
            ////        DIET_Space.FixedHeight = 15f;
            ////        DIET_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DIET_Space);

            ////        PdfPCell House = new PdfPCell(new Phrase("HOUSEHOLD CONCERNS ", Times));
            ////        House.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        House.FixedHeight = 15f;
            ////        House.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(House);

            ////        PdfPCell HOUSEHOLDLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        HOUSEHOLDLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //HOUSEHOLDLine.Colspan = 2;
            ////        HOUSEHOLDLine.FixedHeight = 15f;
            ////        HOUSEHOLDLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(HOUSEHOLDLine);

            ////        PdfPCell HOUSEHOLD_Space = new PdfPCell(new Phrase("", Times));
            ////        HOUSEHOLD_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        HOUSEHOLD_Space.Colspan = 2;
            ////        HOUSEHOLD_Space.FixedHeight = 15f;
            ////        HOUSEHOLD_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(HOUSEHOLD_Space);

            ////        PdfPCell Devp = new PdfPCell(new Phrase("DEVELOPMENTAL CONCERNS ", Times));
            ////        Devp.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Devp.FixedHeight = 15f;
            ////        Devp.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Devp);

            ////        PdfPCell DevpLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        DevpLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //DevpLine.Colspan = 2;
            ////        DevpLine.FixedHeight = 15f;
            ////        DevpLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DevpLine);

            ////        PdfPCell Devp_Space = new PdfPCell(new Phrase("", Times));
            ////        Devp_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Devp_Space.Colspan = 2;
            ////        Devp_Space.FixedHeight = 15f;
            ////        Devp_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Devp_Space);

            ////        PdfPCell AltFnd = new PdfPCell(new Phrase("Alternate Fund", Times));
            ////        AltFnd.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        AltFnd.FixedHeight = 15f;
            ////        AltFnd.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(AltFnd);

            ////        PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        AltFnddesc.FixedHeight = 15f;
            ////        AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(AltFnddesc);

            ////        PdfPCell Trans = new PdfPCell(new Phrase("Transport", Times));
            ////        Trans.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////        Trans.FixedHeight = 15f;
            ////        Trans.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Trans);


            ////        PdfPCell Trans_Space = new PdfPCell(new Phrase("_____________________", Times));
            ////        Trans_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Trans_Space.FixedHeight = 15f;
            ////        Trans_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Trans_Space);

            ////        PdfPCell Pick = new PdfPCell(new Phrase("Pickup", Times));
            ////        Pick.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Pick.FixedHeight = 15f;
            ////        Pick.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Pick);


            ////        PdfPCell PickSpace = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        PickSpace.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        PickSpace.FixedHeight = 15f;
            ////        PickSpace.Colspan = 3;
            ////        PickSpace.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(PickSpace);

            ////        PdfPCell Drop = new PdfPCell(new Phrase("Dropoff", Times));
            ////        Drop.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Drop.FixedHeight = 15f;
            ////        Drop.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Drop);


            ////        PdfPCell dropSpace = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        dropSpace.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        dropSpace.FixedHeight = 15f;
            ////        dropSpace.Colspan = 3;
            ////        dropSpace.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(dropSpace);

            ////        PdfPCell Last_Space = new PdfPCell(new Phrase("", Times));
            ////        Last_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Last_Space.Colspan = 4;
            ////        Last_Space.FixedHeight = 15f;
            ////        Last_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Last_Space);

            ////        PdfPCell Signature = new PdfPCell(new Phrase("Signature of Parent/Gurdian", Times));
            ////        Signature.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //Signature.FixedHeight = 15f;
            ////        Signature.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Signature);

            ////        PdfPCell SignatureLine = new PdfPCell(new Phrase("______________________________________", Times));
            ////        SignatureLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //SignatureLine.FixedHeight = 15f;
            ////        SignatureLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(SignatureLine);

            ////        PdfPCell Signature_Date = new PdfPCell(new Phrase("Date", Times));
            ////        Signature_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////        //DISABILITY_Space.Colspan = 2;
            ////        //Signature_Date.FixedHeight = 15f;
            ////        Signature_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Signature_Date);

            ////        PdfPCell Signature_Date_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////        Signature_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //Signature_Date_Line.FixedHeight = 15f;
            ////        Signature_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Signature_Date_Line);

            ////        PdfPCell Line_Last = new PdfPCell(new Phrase("", Times));
            ////        Line_Last.HorizontalAlignment = Element.ALIGN_CENTER;
            ////        Line_Last.Colspan = 6;
            ////        //Line_Last.FixedHeight = 15f;
            ////        Line_Last.BorderWidthBottom = 2f;
            ////        Line_Last.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
            ////        MediaclTable.AddCell(Line_Last);
            ////    }
            ////}
            ////else
            ////{
            ////    PdfPCell Chld_Med_Plan = new PdfPCell(new Phrase("Child Medical Insurance Plan", Times));
            ////    Chld_Med_Plan.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Med_Plan.FixedHeight = 15f;
            ////    Chld_Med_Plan.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Med_Plan);

            ////    PdfPCell Chld_Med_Plan_Line = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////    Chld_Med_Plan_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Med_Plan_Line.FixedHeight = 15f;
            ////    Chld_Med_Plan_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Med_Plan_Line);

            ////    PdfPCell Chld_Med_No = new PdfPCell(new Phrase("Medical Insurance Name", Times));
            ////    Chld_Med_No.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////    //Emer_Space.Colspan = 2;
            ////    Chld_Med_No.FixedHeight = 15f;
            ////    Chld_Med_No.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Med_No);


            ////    PdfPCell Chld_Med_No_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////    Chld_Med_No_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Med_No_Line.FixedHeight = 15f;
            ////    Chld_Med_No_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Med_No_Line);

            ////    PdfPCell Chld_Ins_Catg = new PdfPCell(new Phrase("Medical Insurance Category", Times));
            ////    Chld_Ins_Catg.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////    //Emer_Space.Colspan = 2;
            ////    Chld_Ins_Catg.FixedHeight = 15f;
            ////    Chld_Ins_Catg.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Ins_Catg);


            ////    PdfPCell Chld_Ins_Catg_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////    Chld_Ins_Catg_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Ins_Catg_Line.FixedHeight = 15f;
            ////    Chld_Ins_Catg_Line.Colspan = 3;
            ////    Chld_Ins_Catg_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Ins_Catg_Line);

            ////    PdfPCell Chld_Doctor = new PdfPCell(new Phrase("Child Doctor & Address", Times));
            ////    Chld_Doctor.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Doctor.FixedHeight = 15f;
            ////    Chld_Doctor.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Doctor);

            ////    PdfPCell Chld_Doctor_Line = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////    Chld_Doctor_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Doctor_Line.FixedHeight = 15f;
            ////    Chld_Doctor_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Doctor_Line);

            ////    PdfPCell Chld_Doc_Phone = new PdfPCell(new Phrase("Phone#", Times));
            ////    Chld_Doc_Phone.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////    //Emer_Space.Colspan = 2;
            ////    Chld_Doc_Phone.FixedHeight = 15f;
            ////    Chld_Doc_Phone.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Doc_Phone);


            ////    PdfPCell Chld_Doc_Phone_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////    Chld_Doc_Phone_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Doc_Phone_Line.FixedHeight = 15f;
            ////    Chld_Doc_Phone_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Doc_Phone_Line);

            ////    PdfPCell Emer_Space2 = new PdfPCell(new Phrase("", Times));
            ////    Emer_Space2.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Emer_Space2.Colspan = 4;
            ////    Emer_Space2.FixedHeight = 10f;
            ////    Emer_Space2.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Emer_Space2);

            ////    PdfPCell Chld_Dent_Plan = new PdfPCell(new Phrase("Child Dental Insurance Plan", Times));
            ////    Chld_Dent_Plan.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Dent_Plan.FixedHeight = 15f;
            ////    Chld_Dent_Plan.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Dent_Plan);

            ////    PdfPCell Chld_Dent_Plan_Line = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////    Chld_Dent_Plan_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Dent_Plan_Line.FixedHeight = 15f;
            ////    Chld_Dent_Plan_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Dent_Plan_Line);

            ////    PdfPCell Chld_Dent_No = new PdfPCell(new Phrase("Dental Insurance Name", Times));
            ////    Chld_Dent_No.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////    //Emer_Space.Colspan = 2;
            ////    Chld_Dent_No.FixedHeight = 15f;
            ////    Chld_Dent_No.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Dent_No);

            ////    PdfPCell Chld_Dent_No_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////    Chld_Dent_No_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Dent_No_Line.FixedHeight = 15f;
            ////    Chld_Dent_No_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Dent_No_Line);

            ////    PdfPCell Chld_Dentist = new PdfPCell(new Phrase("Child Dentist & Address", Times));
            ////    Chld_Dentist.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Dentist.FixedHeight = 15f;
            ////    Chld_Dentist.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Dentist);

            ////    PdfPCell Chld_Dentist_Line = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////    Chld_Dentist_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Dentist_Line.FixedHeight = 15f;
            ////    Chld_Dentist_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Dentist_Line);

            ////    PdfPCell Chld_Dentist_Phone = new PdfPCell(new Phrase("Phone#", Times));
            ////    Chld_Dentist_Phone.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////    //Emer_Space.Colspan = 2;
            ////    Chld_Dentist_Phone.FixedHeight = 15f;
            ////    Chld_Dentist_Phone.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Dentist_Phone);

            ////    PdfPCell Chld_Dentist_Phone_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////    Chld_Dentist_Phone_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Chld_Dentist_Phone_Line.FixedHeight = 15f;
            ////    Chld_Dentist_Phone_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Chld_Dentist_Phone_Line);

            ////    PdfPCell Emer_Space3 = new PdfPCell(new Phrase("", Times));
            ////    Emer_Space3.HorizontalAlignment = Element.ALIGN_LEFT;
            ////    Emer_Space3.Colspan = 4;
            ////    Emer_Space3.FixedHeight = 10f;
            ////    Emer_Space3.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////    MediaclTable.AddCell(Emer_Space3);

            ////    if (caseconddet != null)
            ////    {
            ////        PdfPCell ALLERGIES = new PdfPCell(new Phrase("My Child has the following ALLERGIES", Times));
            ////        ALLERGIES.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        ALLERGIES.FixedHeight = 15f;
            ////        ALLERGIES.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(ALLERGIES);

            ////        if (!string.IsNullOrEmpty(caseconddet.Allergy.Trim()))
            ////        {
            ////            string Allergy_desc = caseconddet.Allergy.Replace("\r\n", " ");
            ////            PdfPCell ALLERGIESLine = new PdfPCell(new Phrase(Allergy_desc.Trim(), Times));
            ////            ALLERGIESLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            ALLERGIESLine.Colspan = 2;
            ////            ALLERGIESLine.FixedHeight = 15f;
            ////            ALLERGIESLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(ALLERGIESLine);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell ALLERGIESLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            ALLERGIESLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            ALLERGIESLine.Colspan = 2;
            ////            ALLERGIESLine.FixedHeight = 15f;
            ////            ALLERGIESLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(ALLERGIESLine);
            ////        }
            ////        PdfPCell ALLERGIES_Space = new PdfPCell(new Phrase("", Times));
            ////        ALLERGIES_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //ALLERGIES_Space.Colspan = 2;
            ////        ALLERGIES_Space.FixedHeight = 15f;
            ////        ALLERGIES_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(ALLERGIES_Space);

            ////        PdfPCell DISABILITY = new PdfPCell(new Phrase("Has been diagonosed with following DISABILITY", Times));
            ////        DISABILITY.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        DISABILITY.FixedHeight = 15f;
            ////        DISABILITY.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DISABILITY);

            ////        if (!string.IsNullOrEmpty(chldMstDetails.Disability.Trim()))
            ////        {
            ////            PdfPCell DISABILITYLine = new PdfPCell(new Phrase(chldMstDetails.DisabilityType.Trim(), Times));
            ////            DISABILITYLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            DISABILITYLine.FixedHeight = 15f;
            ////            DISABILITYLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(DISABILITYLine);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell DISABILITYLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            DISABILITYLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            DISABILITYLine.FixedHeight = 15f;
            ////            DISABILITYLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(DISABILITYLine);
            ////        }

            ////        PdfPCell DISABILITY_Date = new PdfPCell(new Phrase("Date", Times));
            ////        DISABILITY_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////        //DISABILITY_Space.Colspan = 2;
            ////        DISABILITY_Date.FixedHeight = 15f;
            ////        DISABILITY_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DISABILITY_Date);

            ////        if (!string.IsNullOrEmpty(chldMstDetails.DiagnosisDate.Trim()))
            ////        {
            ////            PdfPCell DISABILITY_Date_Line = new PdfPCell(new Phrase(LookupDataAccess.Getdate(chldMstDetails.DiagnosisDate.Trim()), Times));
            ////            DISABILITY_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            DISABILITY_Date_Line.FixedHeight = 15f;
            ////            DISABILITY_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(DISABILITY_Date_Line);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell DISABILITY_Date_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////            DISABILITY_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            DISABILITY_Date_Line.FixedHeight = 15f;
            ////            DISABILITY_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(DISABILITY_Date_Line);
            ////        }


            ////        PdfPCell MEDICATIONS = new PdfPCell(new Phrase("is taking following MEDICATIONS", Times));
            ////        MEDICATIONS.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        MEDICATIONS.FixedHeight = 15f;
            ////        MEDICATIONS.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICATIONS);

            ////        if (!string.IsNullOrEmpty(caseconddet.Medications.Trim()))
            ////        {
            ////            string Medications_desc = caseconddet.Medications.Replace("\r\n", " ");
            ////            PdfPCell MEDICATIONSLine = new PdfPCell(new Phrase(Medications_desc.Trim(), Times));
            ////            MEDICATIONSLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICATIONSLine.Colspan = 2;
            ////            MEDICATIONSLine.FixedHeight = 15f;
            ////            MEDICATIONSLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICATIONSLine);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell MEDICATIONSLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            MEDICATIONSLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICATIONSLine.Colspan = 2;
            ////            MEDICATIONSLine.FixedHeight = 15f;
            ////            MEDICATIONSLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICATIONSLine);
            ////        }

            ////        PdfPCell MEDICATIONS_Space = new PdfPCell(new Phrase("", Times));
            ////        MEDICATIONS_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //MEDICATIONS_Space.Colspan = 2;
            ////        MEDICATIONS_Space.FixedHeight = 15f;
            ////        MEDICATIONS_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICATIONS_Space);

            ////        PdfPCell MEDICAL = new PdfPCell(new Phrase("has the following MEDICAL CONDITIONS", Times));
            ////        MEDICAL.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        MEDICAL.FixedHeight = 15f;
            ////        MEDICAL.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICAL);

            ////        if (!string.IsNullOrEmpty(caseconddet.MedConds.Trim()))
            ////        {
            ////            string MedConds_desc = caseconddet.MedConds.Replace("\r\n", " ");
            ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase(MedConds_desc.Trim(), Times));
            ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICALLine.Colspan = 2;
            ////            MEDICALLine.FixedHeight = 15f;
            ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICALLine);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICALLine.Colspan = 2;
            ////            MEDICALLine.FixedHeight = 15f;
            ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICALLine);
            ////        }

            ////        PdfPCell MEDICAL_Space = new PdfPCell(new Phrase("", Times));
            ////        MEDICAL_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //MEDICAL_Space.Colspan = 2;
            ////        MEDICAL_Space.FixedHeight = 15f;
            ////        MEDICAL_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICAL_Space);

            ////        PdfPCell Diet = new PdfPCell(new Phrase("DIETARY RESTRICTIONS", Times));
            ////        Diet.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Diet.FixedHeight = 15f;
            ////        Diet.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Diet);

            ////        if (!string.IsNullOrEmpty(caseconddet.DietRestrct.Trim()))
            ////        {
            ////            string MedConds_desc = caseconddet.DietRestrct.Replace("\r\n", " ");
            ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase(MedConds_desc.Trim(), Times));
            ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICALLine.Colspan = 2;
            ////            MEDICALLine.FixedHeight = 15f;
            ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICALLine);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICALLine.Colspan = 2;
            ////            MEDICALLine.FixedHeight = 15f;
            ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICALLine);
            ////        }

            ////        PdfPCell DIET_Space = new PdfPCell(new Phrase("", Times));
            ////        DIET_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //MEDICAL_Space.Colspan = 2;
            ////        DIET_Space.FixedHeight = 15f;
            ////        DIET_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DIET_Space);

            ////        PdfPCell House = new PdfPCell(new Phrase("HOUSEHOLD CONCERNS ", Times));
            ////        House.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        House.FixedHeight = 15f;
            ////        House.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(House);

            ////        if (!string.IsNullOrEmpty(caseconddet.HHConcerns.Trim()))
            ////        {
            ////            string MedConds_desc = caseconddet.HHConcerns.Replace("\r\n", " ");
            ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase(MedConds_desc.Trim(), Times));
            ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICALLine.Colspan = 2;
            ////            MEDICALLine.FixedHeight = 15f;
            ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICALLine);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICALLine.Colspan = 2;
            ////            MEDICALLine.FixedHeight = 15f;
            ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICALLine);
            ////        }

            ////        PdfPCell HH_Space = new PdfPCell(new Phrase("", Times));
            ////        HH_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //MEDICAL_Space.Colspan = 2;
            ////        HH_Space.FixedHeight = 15f;
            ////        HH_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(HH_Space);

            ////        PdfPCell Devp = new PdfPCell(new Phrase("DEVELOPMENTAL CONCERNS ", Times));
            ////        Devp.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Devp.FixedHeight = 15f;
            ////        Devp.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Devp);

            ////        if (!string.IsNullOrEmpty(caseconddet.DevlConcerns.Trim()))
            ////        {
            ////            string MedConds_desc = caseconddet.DevlConcerns.Replace("\r\n", " ");
            ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase(MedConds_desc.Trim(), Times));
            ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICALLine.Colspan = 2;
            ////            MEDICALLine.FixedHeight = 15f;
            ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICALLine);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            MEDICALLine.Colspan = 2;
            ////            MEDICALLine.FixedHeight = 15f;
            ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(MEDICALLine);
            ////        }

            ////        PdfPCell DEVL_Space = new PdfPCell(new Phrase("", Times));
            ////        DEVL_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //MEDICAL_Space.Colspan = 2;
            ////        DEVL_Space.FixedHeight = 15f;
            ////        DEVL_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DEVL_Space);

            ////        PdfPCell AltFnd = new PdfPCell(new Phrase("Alternate Fund", Times));
            ////        AltFnd.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        AltFnd.FixedHeight = 15f;
            ////        AltFnd.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(AltFnd);

            ////        if (!string.IsNullOrEmpty(chldMstDetails.AltFundSrc.Trim()))
            ////        {
            ////            string AltFund_Desc = string.Empty;
            ////            foreach (DataRow drFUND in dtFUND.Rows)
            ////            {
            ////                if (chldMstDetails.AltFundSrc.ToString().Trim() == drFUND["Code"].ToString().Trim())
            ////                {
            ////                    AltFund_Desc = drFUND["LookUpDesc"].ToString().Trim(); break;
            ////                }
            ////            }

            ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase(AltFund_Desc, Timesline));
            ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            AltFnddesc.FixedHeight = 15f;
            ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(AltFnddesc);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            AltFnddesc.FixedHeight = 15f;
            ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(AltFnddesc);
            ////        }

            ////        PdfPCell Trans = new PdfPCell(new Phrase("Transport", Times));
            ////        Trans.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////        Trans.FixedHeight = 15f;
            ////        Trans.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Trans);

            ////        if (!string.IsNullOrEmpty(chldMstDetails.Transport.Trim()))
            ////        {
            ////            string Trans_Desc = string.Empty;
            ////            List<CommonEntity> lookClsTransport = _model.lookupDataAccess.GetCMBTransport();
            ////            foreach (CommonEntity agyEntity in lookClsTransport)
            ////            {
            ////                if (chldMstDetails.Transport.ToString().Trim() == agyEntity.Code.ToString().Trim())
            ////                {
            ////                    Trans_Desc = agyEntity.Desc.ToString().Trim(); break;
            ////                }
            ////            }

            ////            if (!string.IsNullOrEmpty(Trans_Desc.Trim()))
            ////            {
            ////                PdfPCell AltFnddesc = new PdfPCell(new Phrase(Trans_Desc, Timesline));
            ////                AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////                AltFnddesc.FixedHeight = 15f;
            ////                AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////                MediaclTable.AddCell(AltFnddesc);
            ////            }
            ////            else
            ////            {
            ////                PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________", Times));
            ////                AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////                AltFnddesc.FixedHeight = 15f;
            ////                AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////                MediaclTable.AddCell(AltFnddesc);
            ////            }
            ////        }
            ////        else
            ////        {
            ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________", Times));
            ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            AltFnddesc.FixedHeight = 15f;
            ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(AltFnddesc);
            ////        }

            ////        PdfPCell Pick = new PdfPCell(new Phrase("Pickup", Times));
            ////        Pick.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Pick.FixedHeight = 15f;
            ////        Pick.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Pick);

            ////        if (!string.IsNullOrEmpty(chldMstDetails.PickOff.Trim()))
            ////        {
            ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase(chldMstDetails.PickOff.Trim(), Timesline));
            ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            AltFnddesc.FixedHeight = 15f;
            ////            AltFnddesc.Colspan = 3;
            ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(AltFnddesc);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            AltFnddesc.FixedHeight = 15f;
            ////            AltFnddesc.Colspan = 3;
            ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(AltFnddesc);
            ////        }

            ////        PdfPCell Drop = new PdfPCell(new Phrase("Dropoff", Times));
            ////        Drop.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Drop.FixedHeight = 15f;
            ////        Drop.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Drop);

            ////        if (!string.IsNullOrEmpty(chldMstDetails.DropOff.Trim()))
            ////        {
            ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase(chldMstDetails.DropOff.Trim(), Timesline));
            ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            AltFnddesc.FixedHeight = 15f;
            ////            AltFnddesc.Colspan = 3;
            ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(AltFnddesc);
            ////        }
            ////        else
            ////        {
            ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////            AltFnddesc.FixedHeight = 15f;
            ////            AltFnddesc.Colspan = 3;
            ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////            MediaclTable.AddCell(AltFnddesc);
            ////        }

            ////        PdfPCell Last_Space = new PdfPCell(new Phrase("", Times));
            ////        Last_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Last_Space.Colspan = 4;
            ////        Last_Space.FixedHeight = 15f;
            ////        Last_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Last_Space);

            ////        PdfPCell Signature = new PdfPCell(new Phrase("Signature of Parent/Gurdian", Times));
            ////        Signature.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //Signature.FixedHeight = 15f;
            ////        Signature.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Signature);

            ////        PdfPCell SignatureLine = new PdfPCell(new Phrase("______________________________________", Times));
            ////        SignatureLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //SignatureLine.FixedHeight = 15f;
            ////        SignatureLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(SignatureLine);

            ////        PdfPCell Signature_Date = new PdfPCell(new Phrase("Date", Times));
            ////        Signature_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////        //DISABILITY_Space.Colspan = 2;
            ////        //Signature_Date.FixedHeight = 15f;
            ////        Signature_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Signature_Date);

            ////        PdfPCell Signature_Date_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////        Signature_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //Signature_Date_Line.FixedHeight = 15f;
            ////        Signature_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Signature_Date_Line);

            ////        PdfPCell Line_Last = new PdfPCell(new Phrase("", Times));
            ////        Line_Last.HorizontalAlignment = Element.ALIGN_CENTER;
            ////        Line_Last.Colspan = 6;
            ////        //Line_Last.FixedHeight = 15f;
            ////        Line_Last.BorderWidthBottom = 2f;
            ////        Line_Last.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
            ////        MediaclTable.AddCell(Line_Last);
            ////    }
            ////    else
            ////    {
            ////        PdfPCell ALLERGIES = new PdfPCell(new Phrase("My Child has the following ALLERGIES", Times));
            ////        ALLERGIES.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        ALLERGIES.FixedHeight = 15f;
            ////        ALLERGIES.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(ALLERGIES);

            ////        PdfPCell ALLERGIESLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        ALLERGIESLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        ALLERGIESLine.FixedHeight = 15f;
            ////        ALLERGIESLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(ALLERGIESLine);

            ////        PdfPCell ALLERGIES_Space = new PdfPCell(new Phrase("", Times));
            ////        ALLERGIES_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        ALLERGIES_Space.Colspan = 2;
            ////        ALLERGIES_Space.FixedHeight = 15f;
            ////        ALLERGIES_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(ALLERGIES_Space);

            ////        PdfPCell DISABILITY = new PdfPCell(new Phrase("Has been diagonosed with following DISABILITY", Times));
            ////        DISABILITY.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        DISABILITY.FixedHeight = 15f;
            ////        DISABILITY.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DISABILITY);

            ////        PdfPCell DISABILITYLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        DISABILITYLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        DISABILITYLine.FixedHeight = 15f;
            ////        DISABILITYLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DISABILITYLine);

            ////        PdfPCell DISABILITY_Date = new PdfPCell(new Phrase("Date", Times));
            ////        DISABILITY_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////        //DISABILITY_Space.Colspan = 2;
            ////        DISABILITY_Date.FixedHeight = 15f;
            ////        DISABILITY_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DISABILITY_Date);

            ////        PdfPCell DISABILITY_Date_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////        DISABILITY_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        DISABILITY_Date_Line.FixedHeight = 15f;
            ////        DISABILITY_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DISABILITY_Date_Line);

            ////        PdfPCell MEDICATIONS = new PdfPCell(new Phrase("is taking following MEDICATIONS", Times));
            ////        MEDICATIONS.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        MEDICATIONS.FixedHeight = 15f;
            ////        MEDICATIONS.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICATIONS);

            ////        PdfPCell MEDICATIONSLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        MEDICATIONSLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        MEDICATIONSLine.FixedHeight = 15f;
            ////        MEDICATIONSLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICATIONSLine);

            ////        PdfPCell MEDICATIONS_Space = new PdfPCell(new Phrase("", Times));
            ////        MEDICATIONS_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        MEDICATIONS_Space.Colspan = 2;
            ////        MEDICATIONS_Space.FixedHeight = 15f;
            ////        MEDICATIONS_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICATIONS_Space);

            ////        PdfPCell MEDICAL = new PdfPCell(new Phrase("has the following MEDICAL CONDITIONS", Times));
            ////        MEDICAL.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        MEDICAL.FixedHeight = 15f;
            ////        MEDICAL.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICAL);

            ////        PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        MEDICALLine.FixedHeight = 15f;
            ////        MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICALLine);

            ////        PdfPCell MEDICAL_Space = new PdfPCell(new Phrase("", Times));
            ////        MEDICAL_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        MEDICAL_Space.Colspan = 2;
            ////        MEDICAL_Space.FixedHeight = 15f;
            ////        MEDICAL_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(MEDICAL_Space);

            ////        PdfPCell Diet = new PdfPCell(new Phrase("DIETARY RESTRICTIONS", Times));
            ////        Diet.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Diet.FixedHeight = 15f;
            ////        Diet.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Diet);

            ////        PdfPCell DIETLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        DIETLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //DIETLine.Colspan = 2;
            ////        DIETLine.FixedHeight = 15f;
            ////        DIETLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DIETLine);

            ////        PdfPCell DIET_Space = new PdfPCell(new Phrase("", Times));
            ////        DIET_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        DIET_Space.Colspan = 2;
            ////        DIET_Space.FixedHeight = 15f;
            ////        DIET_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DIET_Space);

            ////        PdfPCell House = new PdfPCell(new Phrase("HOUSEHOLD CONCERNS ", Times));
            ////        House.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        House.FixedHeight = 15f;
            ////        House.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(House);

            ////        PdfPCell HOUSEHOLDLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        HOUSEHOLDLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //HOUSEHOLDLine.Colspan = 2;
            ////        HOUSEHOLDLine.FixedHeight = 15f;
            ////        HOUSEHOLDLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(HOUSEHOLDLine);

            ////        PdfPCell HOUSEHOLD_Space = new PdfPCell(new Phrase("", Times));
            ////        HOUSEHOLD_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        HOUSEHOLD_Space.Colspan = 2;
            ////        HOUSEHOLD_Space.FixedHeight = 15f;
            ////        HOUSEHOLD_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(HOUSEHOLD_Space);

            ////        PdfPCell Devp = new PdfPCell(new Phrase("DEVELOPMENTAL CONCERNS ", Times));
            ////        Devp.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Devp.FixedHeight = 15f;
            ////        Devp.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Devp);

            ////        PdfPCell DevpLine = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        DevpLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //DevpLine.Colspan = 2;
            ////        DevpLine.FixedHeight = 15f;
            ////        DevpLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(DevpLine);

            ////        PdfPCell Devp_Space = new PdfPCell(new Phrase("", Times));
            ////        Devp_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Devp_Space.Colspan = 2;
            ////        Devp_Space.FixedHeight = 15f;
            ////        Devp_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Devp_Space);

            ////        PdfPCell AltFnd = new PdfPCell(new Phrase("Alternate Fund", Times));
            ////        AltFnd.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        AltFnd.FixedHeight = 15f;
            ////        AltFnd.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(AltFnd);

            ////        PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        AltFnddesc.FixedHeight = 15f;
            ////        AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(AltFnddesc);

            ////        PdfPCell Trans = new PdfPCell(new Phrase("Transport", Times));
            ////        Trans.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////        Trans.FixedHeight = 15f;
            ////        Trans.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Trans);


            ////        PdfPCell Trans_Space = new PdfPCell(new Phrase("_____________________", Times));
            ////        Trans_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Trans_Space.FixedHeight = 15f;
            ////        Trans_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Trans_Space);

            ////        PdfPCell Pick = new PdfPCell(new Phrase("Pickup", Times));
            ////        Pick.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Pick.FixedHeight = 15f;
            ////        Pick.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Pick);


            ////        PdfPCell PickSpace = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        PickSpace.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        PickSpace.FixedHeight = 15f;
            ////        PickSpace.Colspan = 3;
            ////        PickSpace.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(PickSpace);

            ////        PdfPCell Drop = new PdfPCell(new Phrase("Dropoff", Times));
            ////        Drop.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Drop.FixedHeight = 15f;
            ////        Drop.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Drop);


            ////        PdfPCell dropSpace = new PdfPCell(new Phrase("_____________________________________________", Times));
            ////        dropSpace.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        dropSpace.FixedHeight = 15f;
            ////        dropSpace.Colspan = 3;
            ////        dropSpace.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(dropSpace);

            ////        PdfPCell Last_Space = new PdfPCell(new Phrase("", Times));
            ////        Last_Space.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        Last_Space.Colspan = 4;
            ////        Last_Space.FixedHeight = 15f;
            ////        Last_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Last_Space);

            ////        PdfPCell Signature = new PdfPCell(new Phrase("Signature of Parent/Gurdian", Times));
            ////        Signature.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //Signature.FixedHeight = 15f;
            ////        Signature.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Signature);

            ////        PdfPCell SignatureLine = new PdfPCell(new Phrase("______________________________________", Times));
            ////        SignatureLine.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //SignatureLine.FixedHeight = 15f;
            ////        SignatureLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(SignatureLine);

            ////        PdfPCell Signature_Date = new PdfPCell(new Phrase("Date", Times));
            ////        Signature_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
            ////        //DISABILITY_Space.Colspan = 2;
            ////        //Signature_Date.FixedHeight = 15f;
            ////        Signature_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Signature_Date);

            ////        PdfPCell Signature_Date_Line = new PdfPCell(new Phrase("_____________________", Times));
            ////        Signature_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
            ////        //Signature_Date_Line.FixedHeight = 15f;
            ////        Signature_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
            ////        MediaclTable.AddCell(Signature_Date_Line);

            ////        PdfPCell Line_Last = new PdfPCell(new Phrase("", Times));
            ////        Line_Last.HorizontalAlignment = Element.ALIGN_CENTER;
            ////        Line_Last.Colspan = 6;
            ////        //Line_Last.FixedHeight = 15f;
            ////        Line_Last.BorderWidthBottom = 2f;
            ////        Line_Last.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
            ////        MediaclTable.AddCell(Line_Last);
            ////    }
            ////}

            ////}
            ////document.Add(MediaclTable);
            //#endregion
            //}

            document.Close();
            fs.Close();
            fs.Dispose();

        }

        //private void ClientIntakeForm(Document document, string AGY, string Dept, string Prog, string Year, string App, PdfContentByte cb, PdfWriter writer)
        //{
        //    BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
        //    iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
        //    BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
        //    iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(1, 9, 4);
        //    BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

        //    iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
        //    iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
        //    iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
        //    iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(1, 9, 1);
        //    iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
        //    iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);


        //    //Agency Control Table
        //    string Attention = string.Empty;
        //    DataSet ds = Captain.DatabaseLayer.ADMNB001DB.ADMNB001_Browse_AGCYCNTL("00", null, null, null, null, null, null);
        //    if (ds != null && ds.Tables[0].Rows.Count > 0)
        //        Attention = ds.Tables[0].Rows[0]["ACR_03_ATTESTATION"].ToString().Trim();

        //    //Mst Details Table
        //    //DataSet dsCaseMST = DatabaseLayer.CaseSnpData.GetCaseMST(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, BaseForm.BaseYear, BaseForm.BaseApplicationNo);
        //    //DataRow drCaseMST = dsCaseMST.Tables[0].Rows[0];

        //    ////Snp details Table
        //    //DataSet dsCaseSNP = DatabaseLayer.CaseSnpData.GetCaseSnpDetails(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, BaseForm.BaseYear, BaseForm.BaseApplicationNo, null);
        //    //if (dsCaseSNP.Tables.Count > 0)
        //    //    dtCaseSNP = dsCaseSNP.Tables[0];

        //    //Casesite Table
        //    List<CaseSiteEntity> SiteList = new List<CaseSiteEntity>();
        //    CaseSiteEntity Search_Site = new CaseSiteEntity(true);
        //    Search_Site.SiteAGENCY = AGY; Search_Site.SiteNUMBER = CASEMSTList[0].Site;
        //    Search_Site.SiteROOM = "0000";
        //    SiteList = _model.CaseMstData.Browse_CASESITE(Search_Site, "Browse");

        //    ////Services Table
        //    //List<CaseMSTSER> MSTSER_List = new List<CaseMSTSER>();
        //    //CaseMSTSER Search_MSTSER = new CaseMSTSER(true);
        //    //Search_MSTSER.Agency = BaseForm.BaseAgency; Search_MSTSER.Dept = BaseForm.BaseDept; Search_MSTSER.Program = BaseForm.BaseProg;
        //    //Search_MSTSER.Year = BaseForm.BaseYear; Search_MSTSER.AppNo = BaseForm.BaseApplicationNo;
        //    //MSTSER_List = _model.CaseMstData.Browse_MSTSER(Search_MSTSER, "Browse");

        //    ////AddCust Table
        //    //List<AddCustEntity> ADDCUST_List = new List<AddCustEntity>();
        //    //AddCustEntity Search_AddCust = new AddCustEntity(true);
        //    //Search_AddCust.ACTAGENCY = BaseForm.BaseAgency; Search_AddCust.ACTDEPT = BaseForm.BaseDept; Search_AddCust.ACTPROGRAM = BaseForm.BaseProg;
        //    //Search_AddCust.ACTYEAR = BaseForm.BaseYear; Search_AddCust.ACTAPPNO = BaseForm.BaseApplicationNo;
        //    //ADDCUST_List = _model.CaseMstData.Browse_ADDCUST(Search_AddCust, "Browse");

        //    ////CUSTFLDS Table for custom Questions
        //    //List<CustfldsEntity> custQues_List = new List<CustfldsEntity>();
        //    //CustfldsEntity Search_CustQues = new CustfldsEntity(true);
        //    //custQues_List = _model.SPAdminData.Browse_CUSTFLDS(Search_CustQues, "Browse");

        //    //List<CustRespEntity> custResp_List = new List<CustRespEntity>();
        //    //CustRespEntity Search_CustResp = new CustRespEntity(true);
        //    //Search_CustResp.ScrCode = "CASE2001";
        //    //custResp_List = _model.FieldControls.Browse_CUSTRESP(Search_CustResp, "Browse");

        //    //CaseHie Table
        //    DataSet dsCaseHie = DatabaseLayer.ADMNB001DB.ADMNB001_GetCashie("**-**-**");
        //    DataTable dtCaseHie = dsCaseHie.Tables[0];

        //    //Getting CaseWorker
        //    DataSet dsVerifier = DatabaseLayer.CaseMst.GetCaseWorker("I", AGY, Dept, Prog);
        //    DataTable dtVerifier = dsVerifier.Tables[0];

        //    ////CaseIncome Table
        //    //DataSet dsCaseIncome = DatabaseLayer.CaseMst.GetCASEINCOME(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, BaseForm.BaseYear, BaseForm.BaseApplicationNo);
        //    //DataTable dtCaseIncome = dsCaseIncome.Tables[0];
        //    DataSet dsIncome = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.INCOMETYPES);

        //    DataSet dsCaseDiff = DatabaseLayer.CaseMst.GetCASEDiffadpya(AGY, Dept, Prog, Year, App);
        //    DataTable dtCasediff = dsCaseDiff.Tables[0];

        //    ////CHLDMST Table
        //    //ChldMstEntity chldMstDetails = _model.ChldMstData.GetChldMstDetails(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, BaseForm.BaseYear, BaseForm.BaseApplicationNo, string.Empty);

        //    ////CHLDEMER TABLE
        //    //List<ChldMstEMEMEntitty> chldEmemDetails = _model.ChldMstData.GetChldEmemList(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, BaseForm.BaseYear, BaseForm.BaseApplicationNo, string.Empty);
        //    //CaseCondEntitty caseconddet = _model.ChldMstData.GetCaseCondDetails(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, BaseForm.BaseYear, BaseForm.BaseApplicationNo, string.Empty);

        //    AGYTABSEntity searchAgytabs = new AGYTABSEntity(true);
        //    searchAgytabs.Tabs_Type = "S0060";  //List<AGYTABSEntity> TransportList = AgyTabs_List.FindAll(u => u.Tabs_Type.ToString().Trim().Equals("S0041"));
        //    List<AGYTABSEntity> AgyTabs_List = _model.AdhocData.Browse_AGYTABS(searchAgytabs);

        //    DataSet Relations = DatabaseLayer.AgyTab.GetAgyTabDetails(Consts.AgyTab.RELATIONSHIP);
        //    //DataTable dtrelation = Relations.Tables[0];
        //    List<CommonEntity> commonEntity = new List<CommonEntity>();
        //    if (Relations != null && Relations.Tables[0].Rows.Count > 0)
        //    {
        //        foreach (DataRow dr in Relations.Tables[0].Rows)
        //            commonEntity.Add(new CommonEntity(dr["AGY_1"].ToString(), dr["Agy_8"].ToString(), dr["AGY_2"].ToString()));
        //    }

        //    CommonEntity MotherEntity = new CommonEntity(); List<CommonEntity> FatherEntity = new List<CommonEntity>();
        //    if (commonEntity.Count > 0)
        //    {
        //        MotherEntity = commonEntity.Find(u => u.Hierarchy.Equals("G1"));
        //        FatherEntity = commonEntity.FindAll(u => u.Hierarchy.Equals("G2"));
        //    }

        //    List<CommonEntity> lookInsuranceCategory = _model.lookupDataAccess.GetInsuranceCategory();

        //    DataSet dsFUND = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.CASEMNGMTFUNDSRC, "A");
        //    DataTable dtFUND = dsFUND.Tables[0];

        //    cb.BeginText();
        //    X_Pos = 400; Y_Pos = 580;
        //    cb.SetFontAndSize(bf_helv, 13);
        //    //cb.SetColorFill(BaseColor.BLUE.Darker());
        //    string Header_Desc = string.Empty; string Form_Selection = string.Empty;

        //    //if (Privileges.ModuleCode == "03")
        //    //{
        //    string ShortName = string.Empty;
        //    string AgencyName = string.Empty; string SerHie = "N";

        //    if (ds != null && ds.Tables[0].Rows.Count > 0)
        //    {
        //        ShortName = ds.Tables[0].Rows[0]["ACR_SHORT_NAME"].ToString().Trim();
        //        if (ds.Tables[0].Rows[0]["ACR_SERVINQ_CASEHIE"].ToString().Trim() == "1") SerHie = "Y"; else SerHie = "N";

        //    }


        //    if (dtCaseHie.Rows.Count > 0)
        //    {
        //        foreach (DataRow drCasehie in dtCaseHie.Rows)
        //        {
        //            if (drCasehie["Code"].ToString().Trim() == AGY + Dept + Prog)
        //            {
        //                AgencyName = drCasehie["HIE_NAME"].ToString().Trim(); break;
        //            }
        //        }

        //        cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, ShortName + " - INTAKE APPLICATION", X_Pos, Y_Pos - 25, 0);
        //        Header_Desc = ShortName + " - INTAKE APPLICATION";
        //        Form_Selection = AgencyName;//"Casemanagement Application";

        //        //cb.SetFontAndSize(bf_helv, 9);
        //        //cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Applicant No: ", 30, Y_Pos - 40, 0);
        //        //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(BaseForm.BaseApplicationNo, Timesline), 30 + 72, Y_Pos-40, 0);

        //        cb.SetFontAndSize(bf_helv, 13);
        //        cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Form_Selection, X_Pos, Y_Pos - 40, 0);
        //    }

        //    cb.SetFontAndSize(bf_helv, 9);
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Date Printed: ", 740, Y_Pos - 40, 0);
        //    //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase(LookupDataAccess.Getdate(DateTime.Now.ToShortDateString()), Times), 780, Y_Pos - 40, 0);
        //    X_Pos = 30; Y_Pos -= 55;


        //    #region Comment block
        //    //}
        //    //else if (Privileges.ModuleCode == "02")
        //    //{
        //    //    string ShortName = string.Empty;
        //    //    if (dtCaseHie.Rows.Count > 0)
        //    //    {
        //    //        foreach (DataRow drCasehie in dtCaseHie.Rows)
        //    //        {
        //    //            if (drCasehie["Code"].ToString() == BaseForm.BaseAgency + BaseForm.BaseDept + BaseForm.BaseProg)
        //    //            {
        //    //                ShortName = drCasehie["HIE_SHORT_NAME"].ToString().Trim(); break;
        //    //            }
        //    //        }
        //    //        cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, ShortName + "  EARLY CARE & EDUCATION ", X_Pos, Y_Pos - 25, 0);
        //    //        Header_Desc = ShortName + "  EARLY CARE & EDUCATION ";

        //    //            Form_Selection = "CASE MANAGEMENT APPLICATION";

        //    //        cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Form_Selection, X_Pos, Y_Pos - 40, 0);

        //    //    }

        //    //    cb.SetFontAndSize(bf_helv, 9);
        //    //    X_Pos = 30; Y_Pos -= 50;
        //    //}
        //    //else //if (Privileges.ModuleCode == "05" )
        //    //{
        //    //    cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, "Application For Assistance", X_Pos, Y_Pos, 0);
        //    //    cb.SetFontAndSize(bf_helv, 9);
        //    //    cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "OFFICE USE ONLY ________________________________", 780, Y_Pos, 0);
        //    //    string SiteName = null, Site_city = null, Site_street = null, Site_state = null; string Site_zipcode = null;
        //    //    Header_Desc = "Application For Assistance";
        //    //    //To dispalying the Programme Address
        //    //    if (SiteList.Count > 0)
        //    //    {
        //    //        //drCaseSite = dsCaseSite.Tables[0].Rows[0];

        //    //        if (!string.IsNullOrEmpty(SiteList[0].SiteNAME.Trim()))
        //    //            SiteName = SiteList[0].SiteNAME.Trim();
        //    //        if (!string.IsNullOrEmpty(SiteList[0].SiteSTREET.Trim()))
        //    //            Site_street = "," + SiteList[0].SiteSTREET.Trim();
        //    //        if (!string.IsNullOrEmpty(SiteList[0].SiteCITY.Trim()))
        //    //            Site_city = "," + SiteList[0].SiteCITY.Trim();
        //    //        if (!string.IsNullOrEmpty(SiteList[0].SiteSTATE.Trim()))
        //    //            Site_state = "," + SiteList[0].SiteSTATE.Trim();
        //    //        if (SiteList[0].SiteZIP.Trim() != "0")
        //    //            Site_zipcode = "," + SiteList[0].SiteZIP.Trim();
        //    //    }
        //    //    cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, SiteName + Site_street + Site_city + Site_state + Site_zipcode, X_Pos, Y_Pos - 13, 0);
        //    //    cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "CABA# ___________________________________________", 780, Y_Pos - 13, 0);

        //    //    //To Print the Verifier Name on Application
        //    //    string Intake_Worker = null;
        //    //    if (dtVerifier.Rows.Count > 0)
        //    //    {
        //    //        foreach (DataRow drVerifier in dtVerifier.Rows)
        //    //        {
        //    //            if (drCaseMST["MST_INTAKE_WORKER"].ToString().Trim() == drVerifier["PWH_CASEWORKER"].ToString().Trim())
        //    //            {
        //    //                Intake_Worker = drVerifier["NAME"].ToString().Trim();
        //    //                break;
        //    //            }
        //    //        }
        //    //    }
        //    //    if (!string.IsNullOrEmpty(Intake_Worker))
        //    //        cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Intake_Worker, X_Pos, Y_Pos - 26, 0);
        //    //    else
        //    //        cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, "  ", X_Pos, Y_Pos - 26, 0);
        //    //    cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Search Results ______________________________________", 780, Y_Pos - 26, 0);
        //    //    cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "___________________________________________________", 780, Y_Pos - 39, 0);
        //    //    cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "___________________________________________________", 780, Y_Pos - 52, 0);
        //    //    cb.SetFontAndSize(bf_helv, 9);
        //    //    X_Pos = 30; Y_Pos -= 72;
        //    //}

        //    //cb.SetFontAndSize(bf_helv, 9);
        //    //X_Pos = 30; Y_Pos -= 72;



        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Date: ", 740, Y_Pos, 0);
        //    //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase(LookupDataAccess.Getdate(DateTime.Now.ToShortDateString()), Timesline), 780, Y_Pos, 0);

        //    ////Y_Pos -= 13;
        //    #endregion

        //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Applicant No: ", X_Pos, Y_Pos, 0);
        //    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(App, Timesline), X_Pos + 72, Y_Pos, 0);

        //    cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Date Printed: ", 700, Y_Pos, 0);
        //    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase(DateTime.Now.ToString("g"), Timesline), 780, Y_Pos, 0);

        //    Y_Pos -= 15;
        //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Applicant Name   ", X_Pos, Y_Pos, 0);
        //    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(BaseForm.BaseApplicationName, Timesline), X_Pos + 72, Y_Pos, 0);

        //    cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Application Date: ", 720, Y_Pos, 0);
        //    if (!string.IsNullOrEmpty(CASEMSTList[0].IntakeDate.Trim()))
        //        ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase(LookupDataAccess.Getdate(CASEMSTList[0].IntakeDate.Trim()), Timesline), 780, Y_Pos, 0);
        //    else
        //        ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase("____________", Times), 780, Y_Pos, 0);

        //    //Y_Pos -= 13;
        //    //if (Privileges.ModuleCode == "05" || gvApp.CurrentRow.Cells["AppDet"].Value.ToString() == "Application for Assistance")
        //    //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Are you a citizen or naturalized Alien?", X_Pos, Y_Pos, 0);
        //    //else
        //    //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Do you have a disability and need an accommdation or special help to complete this application?", X_Pos, Y_Pos, 0);

        //    /************************************CheckBoxes****************************/
        //    iTextSharp.text.Rectangle rect = new iTextSharp.text.Rectangle(806, 40, 788, 60);
        //    PdfAppearance[] onOff = new PdfAppearance[2];
        //    onOff[0] = cb.CreateAppearance(20, 20);
        //    onOff[0].Rectangle(1, 20, 1, 20);
        //    onOff[0].Rectangle(18, 18, 1, 1);
        //    onOff[0].Stroke();
        //    onOff[1] = cb.CreateAppearance(20, 20);
        //    onOff[1].SetRGBColorFill(255, 128, 128);
        //    onOff[1].Rectangle(18, 18, 1, 1);
        //    onOff[1].FillStroke();
        //    onOff[1].MoveTo(1, 1);
        //    onOff[1].LineTo(19, 19);
        //    onOff[1].MoveTo(1, 19);
        //    onOff[1].LineTo(19, 1);

        //    RadioCheckField checkbox;
        //    PdfFormField SField;
        //    //if (Privileges.ModuleCode == "05" || gvApp.CurrentRow.Cells["AppDet"].Value.ToString() == "Application for Assistance")
        //    //{
        //    //    rect = new iTextSharp.text.Rectangle(190, Y_Pos + 8, 198, Y_Pos);
        //    //    //rect.Rotate();
        //    //    checkbox = new RadioCheckField(writer, rect, "Yes", "On");
        //    //    checkbox.BorderColor = new GrayColor(0.3f);
        //    //    checkbox.Rotation = 90;
        //    //    SField = checkbox.CheckField;
        //    //    writer.AddAnnotation(SField);
        //    //    ColumnText.ShowTextAligned(cb, Element.ALIGN_LEFT, new Phrase("Yes", Times), 200, Y_Pos, 0);
        //    //    rect = new iTextSharp.text.Rectangle(220, Y_Pos + 8, 228, Y_Pos);
        //    //    checkbox = new RadioCheckField(writer, rect, "No", "On");
        //    //    checkbox.BorderColor = new GrayColor(0.3f);
        //    //    checkbox.Rotation = 90;
        //    //    SField = checkbox.CheckField;
        //    //    writer.AddAnnotation(SField);
        //    //    ColumnText.ShowTextAligned(cb, Element.ALIGN_LEFT, new Phrase("No", Times), 230, Y_Pos, 0);

        //    //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "If no, are you a qualified Alien??", 320, Y_Pos, 0);

        //    //    rect = new iTextSharp.text.Rectangle(450, Y_Pos + 8, 458, Y_Pos);
        //    //    //rect.Rotate();
        //    //    checkbox = new RadioCheckField(writer, rect, "SecondYes", "On");
        //    //    checkbox.BorderColor = new GrayColor(0.3f);
        //    //    checkbox.Rotation = 90;
        //    //    SField = checkbox.CheckField;
        //    //    writer.AddAnnotation(SField);
        //    //    ColumnText.ShowTextAligned(cb, Element.ALIGN_LEFT, new Phrase("Yes", Times), 460, Y_Pos, 0);
        //    //    rect = new iTextSharp.text.Rectangle(480, Y_Pos + 8, 488, Y_Pos);
        //    //    checkbox = new RadioCheckField(writer, rect, "SecondNo", "On");
        //    //    checkbox.BorderColor = new GrayColor(0.3f);
        //    //    checkbox.Rotation = 90;
        //    //    SField = checkbox.CheckField;
        //    //    writer.AddAnnotation(SField);
        //    //    ColumnText.ShowTextAligned(cb, Element.ALIGN_LEFT, new Phrase("No", Times), 490, Y_Pos, 0);
        //    //}
        //    //else
        //    //{
        //    //    rect = new iTextSharp.text.Rectangle(390, Y_Pos + 8, 398, Y_Pos);
        //    //    //rect.Rotate();
        //    //    checkbox = new RadioCheckField(writer, rect, "SecondYes", "On");
        //    //    checkbox.BorderColor = new GrayColor(0.3f);
        //    //    checkbox.Rotation = 90;
        //    //    SField = checkbox.CheckField;
        //    //    writer.AddAnnotation(SField);
        //    //    ColumnText.ShowTextAligned(cb, Element.ALIGN_LEFT, new Phrase("Yes", Times), 400, Y_Pos, 0);
        //    //    rect = new iTextSharp.text.Rectangle(420, Y_Pos + 8, 428, Y_Pos);
        //    //    checkbox = new RadioCheckField(writer, rect, "SecondNo", "On");
        //    //    checkbox.BorderColor = new GrayColor(0.3f);
        //    //    checkbox.Rotation = 90;
        //    //    SField = checkbox.CheckField;
        //    //    writer.AddAnnotation(SField);
        //    //    ColumnText.ShowTextAligned(cb, Element.ALIGN_LEFT, new Phrase("No", Times), 430, Y_Pos, 0);
        //    //}
        //    X_Pos = 30; Y_Pos -= 13;
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Applicant Name   ", X_Pos, Y_Pos, 0);
        //    //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(BaseForm.BaseApplicationName, Timesline), X_Pos + 72, Y_Pos, 0);
        //    //string Zip = string.Empty;
        //    //if (!string.IsNullOrEmpty(drCaseMST["MST_ZIP"].ToString().Trim()))
        //    //    Zip = "00000".Substring(0, 5 - drCaseMST["MST_ZIP"].ToString().Trim().Length) + drCaseMST["MST_ZIP"].ToString().Trim();
        //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Address ", X_Pos, Y_Pos, 0);
        //    string Apt = string.Empty; string Floor = string.Empty; string HN = string.Empty; string Suffix = string.Empty; string Street = string.Empty;
        //    string Zip = string.Empty;
        //    if (!string.IsNullOrEmpty(CASEMSTList[0].Apt.Trim()))
        //        Apt = "Apt  " + CASEMSTList[0].Apt.Trim() + "   ";
        //    if (!string.IsNullOrEmpty(CASEMSTList[0].Flr.Trim()))
        //        Floor = "Flr  " + CASEMSTList[0].Flr.Trim() + "   ";
        //    if (!string.IsNullOrEmpty(CASEMSTList[0].Street.Trim()))
        //        Street = CASEMSTList[0].Street.Trim() + " ";
        //    if (!string.IsNullOrEmpty(CASEMSTList[0].Suffix.Trim()))
        //        Suffix = CASEMSTList[0].Suffix.Trim() + ", ";
        //    if (!string.IsNullOrEmpty(CASEMSTList[0].Hn.Trim()))
        //        HN = CASEMSTList[0].Hn.Trim() + " ";
        //    if (!string.IsNullOrEmpty(CASEMSTList[0].Zip.Trim()) && CASEMSTList[0].Zip != "0")
        //        Zip = "00000".Substring(0, 5 - CASEMSTList[0].Zip.Trim().Length) + CASEMSTList[0].Zip.Trim();

        //    string Address = HN + Street + Suffix + Apt + Floor + ", " + CASEMSTList[0].City.Trim() + ", " + CASEMSTList[0].City.Trim() + " " + Zip;
        //    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(Address, Timesline), X_Pos + 72, Y_Pos, 0);

        //    string Language = null;
        //    DataSet dsLang = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.LANGUAGECODES);
        //    DataTable dtLang = dsLang.Tables[0];
        //    foreach (DataRow drLang in dtLang.Rows)
        //    {
        //        if (CASEMSTList[0].Language.Trim() == drLang["Code"].ToString().Trim())
        //        {
        //            Language = drLang["LookUpDesc"].ToString().Trim(); break;
        //        }
        //    }

        //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Primary Language ", 380, Y_Pos, 0);
        //    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(Language, Timesline), 450, Y_Pos, 0);
        //    if (!string.IsNullOrEmpty(CASEMSTList[0].Site.Trim()))
        //    {
        //        DataSet dsSITE = DatabaseLayer.CaseMst.GetSITEDESC(AGY, CASEMSTList[0].Site);
        //        DataRow drSITE = dsSITE.Tables[0].Rows[0];
        //        string Site_Name = null;
        //        cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Site : ", 640, Y_Pos, 0);
        //        Site_Name = drSITE["SiteName"].ToString().Trim();
        //        //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(Site_Name, Timesline), 650, Y_Pos, 0);
        //        ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(CASEMSTList[0].Site, Timesline), 650, Y_Pos, 0);
        //    }
        //    else
        //    {
        //        cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Site : ", 640, Y_Pos, 0);
        //        cb.SetLineWidth(0.5f);
        //        //cb.SetLineCap(5);
        //        cb.MoveTo(650, Y_Pos - 2);
        //        cb.LineTo(705, Y_Pos - 2);
        //        cb.Stroke();
        //    }
        //    Y_Pos -= 13;
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Address ", X_Pos, Y_Pos, 0);
        //    //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(drCaseMST["MST_HN"].ToString().Trim() + " " + drCaseMST["MST_STREET"].ToString().Trim() + "," + drCaseMST["MST_CITY"].ToString().Trim() + "," + drCaseMST["MST_STATE"].ToString().Trim() + "," + drCaseMST["MST_ZIP"].ToString().Trim(), Timesline), X_Pos + 72, Y_Pos, 0);
        //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Mailing Address", X_Pos, Y_Pos, 0);
        //    string House_NO = null, Street1 = null, city = null, state = null, zip = null; string DSuffix = string.Empty;
        //    if (dtCasediff.Rows.Count > 0)
        //    {
        //        foreach (DataRow drCaseDiff in dtCasediff.Rows)
        //        {
        //            if (!string.IsNullOrEmpty(drCaseDiff["DIFF_HN"].ToString().Trim()))
        //                House_NO = drCaseDiff["DIFF_HN"].ToString().Trim() + " ";
        //            if (!string.IsNullOrEmpty(drCaseDiff["DIFF_SUFFIX"].ToString().Trim()))
        //                DSuffix = " " + drCaseDiff["DIFF_SUFFIX"].ToString().Trim();
        //            if (!string.IsNullOrEmpty(drCaseDiff["DIFF_STREET"].ToString().Trim()))
        //                Street1 = drCaseDiff["DIFF_STREET"].ToString().Trim() + DSuffix + ",";
        //            if (!string.IsNullOrEmpty(drCaseDiff["DIFF_CITY"].ToString().Trim()))
        //                city = drCaseDiff["DIFF_CITY"].ToString().Trim() + ",";
        //            if (!string.IsNullOrEmpty(drCaseDiff["DIFF_STATE"].ToString().Trim()))
        //                state = drCaseDiff["DIFF_STATE"].ToString().Trim();
        //            if (!string.IsNullOrEmpty(drCaseDiff["DIFF_ZIP"].ToString().Trim()))
        //                zip = "00000".Substring(0, 5 - drCaseDiff["DIFF_ZIP"].ToString().Trim().Length) + drCaseDiff["DIFF_ZIP"].ToString().Trim();
        //            if (zip == "00000") zip = ""; else zip = ", " + zip;
        //        }
        //        ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(House_NO + Street1 + city + state + zip, Timesline), X_Pos + 72, Y_Pos, 0);
        //    }
        //    else
        //    {
        //        //cb.SetLineWidth(0.5f);
        //        ////cb.SetLineCap(5);
        //        //cb.MoveTo(X_Pos + 72, Y_Pos);
        //        //cb.LineTo(210, Y_Pos);
        //        //cb.Stroke();
        //        //string Apt = string.Empty; string Floor = string.Empty; string HN = string.Empty; string Suffix = string.Empty; string Street = string.Empty;
        //        //string Zip = string.Empty;
        //        if (!string.IsNullOrEmpty(CASEMSTList[0].Apt.Trim()))
        //            Apt = "Apt  " + CASEMSTList[0].Apt.Trim() + "   ";
        //        if (!string.IsNullOrEmpty(CASEMSTList[0].Flr.Trim()))
        //            Floor = "Flr  " + CASEMSTList[0].Flr.Trim() + "   ";
        //        if (!string.IsNullOrEmpty(CASEMSTList[0].Street.Trim()))
        //            Street = CASEMSTList[0].Street.Trim() + " ";
        //        if (!string.IsNullOrEmpty(CASEMSTList[0].Suffix.Trim()))
        //            Suffix = CASEMSTList[0].Suffix.Trim() + ", ";
        //        if (!string.IsNullOrEmpty(CASEMSTList[0].Hn.Trim()))
        //            HN = CASEMSTList[0].Hn.Trim() + " ";
        //        if (!string.IsNullOrEmpty(CASEMSTList[0].Zip.Trim()) && CASEMSTList[0].Zip != "0")
        //            Zip = "00000".Substring(0, 5 - CASEMSTList[0].Zip.Trim().Length) + CASEMSTList[0].Zip.Trim();

        //        Address = HN + Street + Suffix + Apt + Floor + ", " + CASEMSTList[0].City.Trim() + ", " + CASEMSTList[0].City.Trim() + " " + Zip;

        //        ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(Address, Timesline), X_Pos + 72, Y_Pos, 0);
        //    }


        //    if (!string.IsNullOrEmpty(CASEMSTList[0].Email.Trim()))
        //    {
        //        ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase("Email : ", Times), 380, Y_Pos, 0);
        //        ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(CASEMSTList[0].Email.Trim(), Timesline), 410, Y_Pos, 0);
        //    }
        //    else
        //    {
        //        cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Email", 380, Y_Pos, 0);
        //        cb.SetLineWidth(0.5f);
        //        //cb.SetLineCap(5);
        //        cb.MoveTo(410, Y_Pos);
        //        cb.LineTo(520, Y_Pos);
        //        cb.Stroke();
        //    }
        //    cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Home Telephone ", 640, Y_Pos, 0);
        //    MaskedTextBox mskPhn = new MaskedTextBox();
        //    mskPhn.Mask = "(000)000-0000";
        //    mskPhn.Text = CASEMSTList[0].Area + CASEMSTList[0].Phone;   //"(" + drCaseMST["MST_AREA"].ToString() + ")" + drCaseMST["MST_PHONE"].ToString()
        //    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(mskPhn.Text, Timesline), 650, Y_Pos, 0);
        //    Y_Pos -= 13;
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Mailing Address", X_Pos, Y_Pos, 0);
        //    //string House_NO = null, Street = null, city = null, state = null, zip = null;
        //    //if (dtCasediff.Rows.Count > 0)
        //    //{
        //    //    foreach (DataRow drCaseDiff in dtCasediff.Rows)
        //    //    {
        //    //        if (!string.IsNullOrEmpty(drCaseDiff["DIFF_HN"].ToString().Trim()))
        //    //            House_NO = drCaseDiff["DIFF_HN"].ToString().Trim() + " ";
        //    //        if (!string.IsNullOrEmpty(drCaseDiff["DIFF_STREET"].ToString().Trim()))
        //    //            Street = drCaseDiff["DIFF_STREET"].ToString().Trim() + ",";
        //    //        if (!string.IsNullOrEmpty(drCaseDiff["DIFF_STREET"].ToString().Trim()))
        //    //            city = drCaseDiff["DIFF_STREET"].ToString().Trim() + ",";
        //    //        if (!string.IsNullOrEmpty(drCaseDiff["DIFF_STATE"].ToString().Trim()))
        //    //            state = drCaseDiff["DIFF_STATE"].ToString().Trim() + ",";
        //    //        zip = drCaseDiff["DIFF_ZIP"].ToString().Trim();
        //    //    }
        //    //    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(House_NO + Street + city + state + zip, Timesline), X_Pos + 72, Y_Pos, 0);
        //    //}
        //    //else
        //    //{
        //    //    //cb.SetLineWidth(0.5f);
        //    //    ////cb.SetLineCap(5);
        //    //    //cb.MoveTo(X_Pos + 72, Y_Pos);
        //    //    //cb.LineTo(210, Y_Pos);
        //    //    //cb.Stroke();
        //    //    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(drCaseMST["MST_HN"].ToString().Trim() + " " + drCaseMST["MST_STREET"].ToString().Trim() + "," + drCaseMST["MST_CITY"].ToString().Trim() + "," + drCaseMST["MST_STATE"].ToString().Trim() + "," + drCaseMST["MST_ZIP"].ToString().Trim(), Timesline), X_Pos + 72, Y_Pos, 0);
        //    //}
        //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Message Number", 380, Y_Pos, 0);
        //    if (!string.IsNullOrEmpty(CASEMSTList[0].MessagePhone.Trim()))
        //    {
        //        MaskedTextBox mskMessage = new MaskedTextBox();
        //        mskMessage.Mask = "(000)000-0000";
        //        mskMessage.Text = CASEMSTList[0].MessagePhone.Trim();
        //        ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(mskMessage.Text, Timesline), 450, Y_Pos, 0);
        //    }
        //    else
        //    {
        //        cb.SetLineWidth(0.5f);
        //        //cb.SetLineCap(5);
        //        cb.MoveTo(450, Y_Pos);
        //        cb.LineTo(505, Y_Pos);
        //        cb.Stroke();
        //    }

        //    cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Cell Number", 640, Y_Pos, 0);
        //    if (!string.IsNullOrEmpty(CASEMSTList[0].CellPhone.Trim()))
        //    {
        //        MaskedTextBox mskCell = new MaskedTextBox();
        //        mskCell.Mask = "(000)000-0000";
        //        mskCell.Text = CASEMSTList[0].CellPhone.Trim();
        //        ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(mskCell.Text, Timesline), 650, Y_Pos, 0);
        //    }
        //    else
        //    {
        //        cb.SetLineWidth(0.5f);
        //        //cb.SetLineCap(5);
        //        cb.MoveTo(650, Y_Pos - 3);
        //        cb.LineTo(705, Y_Pos - 3);
        //        cb.Stroke();
        //    }

        //    //Y_Pos -= 13;
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Message Number", 640, Y_Pos, 0);
        //    //if (!string.IsNullOrEmpty(drCaseMST["MST_MESSAGE_PHONE"].ToString().Trim()))
        //    //{
        //    //    MaskedTextBox mskMessage = new MaskedTextBox();
        //    //    mskMessage.Mask = "(000) 000-0000";
        //    //    mskMessage.Text = drCaseMST["MST_MESSAGE_PHONE"].ToString().Trim();
        //    //    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(mskMessage.Text, Timesline), 650, Y_Pos, 0);
        //    //}
        //    //else
        //    //{
        //    //    cb.SetLineWidth(0.5f);
        //    //    //cb.SetLineCap(5);
        //    //    cb.MoveTo(650, Y_Pos - 3);
        //    //    cb.LineTo(705, Y_Pos - 3);
        //    //    cb.Stroke();
        //    //}

        //    Y_Pos -= 8;
        //    SetLine();
        //    Y_Pos -= 20;
        //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Housing Situation", X_Pos, Y_Pos, 0);
        //    DataSet dsHouseMain = Captain.DatabaseLayer.AgyTab.GetAgyTab(Consts.AgyTab.HOUSINGTYPES);
        //    string strMainData = dsHouseMain.Tables[0].Rows[0]["Agy_9"].ToString();
        //    string CodeColSubscript = string.Empty, DescColSubscript = string.Empty;
        //    if (!string.IsNullOrEmpty(dsHouseMain.Tables[0].Rows[0]["AGY_ACTIVE"].ToString().Trim()))
        //        CodeColSubscript = "AGY_" + dsHouseMain.Tables[0].Rows[0]["AGY_ACTIVE"].ToString().Trim();
        //    if (!string.IsNullOrEmpty(dsHouseMain.Tables[0].Rows[0]["AGY_DEFAULT"].ToString().Trim()))
        //        DescColSubscript = "AGY_" + dsHouseMain.Tables[0].Rows[0]["AGY_DEFAULT"].ToString().Trim();


        //    //DataSet dsHousing = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.HOUSINGTYPES);
        //    DataSet dsHousing = DatabaseLayer.AgyTab.GetAgyTabDetails(Consts.AgyTab.HOUSINGTYPES);
        //    DataTable dtHousing = dsHousing.Tables[0];
        //    PdfFormField Field;
        //    X_Pos = 140;
        //    string CheckTitle = string.Empty;
        //    foreach (DataRow drHousing in dtHousing.Rows)
        //    {
        //        if (drHousing["AGY_ACTIVE"].ToString() == "Y" ||
        //            (drHousing["AGY_ACTIVE"].ToString() == "N" && !string.IsNullOrEmpty(CASEMSTList[0].Housing.Trim()) && CASEMSTList[0].Housing.Trim() == drHousing[CodeColSubscript].ToString().Trim()))
        //        {
        //            rect = new iTextSharp.text.Rectangle(X_Pos, Y_Pos + 8, X_Pos + 8, Y_Pos);
        //            checkbox = new RadioCheckField(writer, rect, drHousing[DescColSubscript].ToString().Trim(), "On");
        //            checkbox.BorderColor = new GrayColor(0.3f);
        //            checkbox.Rotation = 90;
        //            if (CASEMSTList[0].Housing.Trim().Trim() == drHousing[CodeColSubscript].ToString().Trim())
        //                checkbox.Checked = true;
        //            Field = checkbox.CheckField;
        //            writer.AddAnnotation(Field);
        //            ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(drHousing[DescColSubscript].ToString().Trim(), Times), X_Pos + 10, Y_Pos, 0);
        //            X_Pos += 90;
        //            if (X_Pos > 600)
        //            {
        //                X_Pos = 140;
        //                Y_Pos -= 13;
        //            }
        //        }
        //    }

        //    Y_Pos -= 25; X_Pos = 30;
        //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Family Type", X_Pos, Y_Pos, 0);
        //    X_Pos = 140;

        //    DataSet dsFamilyMain = Captain.DatabaseLayer.AgyTab.GetAgyTab(Consts.AgyTab.HOUSINGTYPES);
        //    strMainData = dsFamilyMain.Tables[0].Rows[0]["Agy_9"].ToString();
        //    CodeColSubscript = string.Empty; DescColSubscript = string.Empty;
        //    if (!string.IsNullOrEmpty(dsFamilyMain.Tables[0].Rows[0]["AGY_ACTIVE"].ToString().Trim()))
        //        CodeColSubscript = "AGY_" + dsFamilyMain.Tables[0].Rows[0]["AGY_ACTIVE"].ToString().Trim();
        //    if (!string.IsNullOrEmpty(dsFamilyMain.Tables[0].Rows[0]["AGY_DEFAULT"].ToString().Trim()))
        //        DescColSubscript = "AGY_" + dsFamilyMain.Tables[0].Rows[0]["AGY_DEFAULT"].ToString().Trim();

        //    //DataSet dsFamilyType = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.FAMILYTYPE);
        //    DataSet dsFamilyType = DatabaseLayer.AgyTab.GetAgyTabDetails(Consts.AgyTab.FAMILYTYPE);
        //    DataTable dtFamilyType = dsFamilyType.Tables[0];
        //    foreach (DataRow drFamilyType in dtFamilyType.Rows)
        //    {
        //        if (drFamilyType["AGY_ACTIVE"].ToString() == "Y" ||
        //            (drFamilyType["AGY_ACTIVE"].ToString() == "N" && !string.IsNullOrEmpty(CASEMSTList[0].FamilyType.Trim()) && CASEMSTList[0].FamilyType.Trim() == drFamilyType[CodeColSubscript].ToString().Trim()))
        //        {
        //            rect = new iTextSharp.text.Rectangle(X_Pos, Y_Pos + 8, X_Pos + 8, Y_Pos);
        //            //checkbox = new RadioCheckField(writer, rect, "F" + drFamilyType["LookUpDesc"].ToString().Trim(), "On");
        //            checkbox = new RadioCheckField(writer, rect, "F" + drFamilyType[DescColSubscript].ToString().Trim(), "On");
        //            checkbox.BorderColor = new GrayColor(0.3f);
        //            checkbox.Rotation = 90;
        //            if (CASEMSTList[0].FamilyType.Trim() == drFamilyType[CodeColSubscript].ToString().Trim())
        //                checkbox.Checked = true;
        //            Field = checkbox.CheckField;
        //            writer.AddAnnotation(Field);
        //            ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(drFamilyType[DescColSubscript].ToString().Trim(), Times), X_Pos + 10, Y_Pos, 0);
        //            X_Pos += 130;
        //            if (X_Pos > 600)
        //            {
        //                Y_Pos -= 13;
        //                X_Pos = 140;
        //            }

        //        }
        //    }

        //    Y_Pos -= 25; X_Pos = 30;
        //    int Count = casesnpList.Count;
        //    int Adults = 0, Child = 0, under5 = 0;
        //    foreach (CaseSnpEntity drsnp in casesnpList)
        //    {
        //        if (!string.IsNullOrEmpty(drsnp.Age))
        //        {
        //            if (int.Parse(drsnp.Age) >= 18)
        //                Adults++;
        //            else
        //                Child++;
        //            if (int.Parse(drsnp.Age) < 5)
        //                under5++;
        //        }
        //    }
        //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Total No of Household Members: ", X_Pos, Y_Pos, 0);
        //    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(Count.ToString(), Timesline), X_Pos + 123, Y_Pos, 0);
        //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "No of Adults: ", 210, Y_Pos, 0);
        //    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(Adults.ToString(), Timesline), 260, Y_Pos, 0);
        //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "No of Children: ", 310, Y_Pos, 0);
        //    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(Child.ToString(), Timesline), 370, Y_Pos, 0);
        //    cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "No of Children under 5: ", 420, Y_Pos, 0);
        //    ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(under5.ToString(), Timesline), 508, Y_Pos, 0);
        //    cb.EndText();

        //    //Temp table not displayed on the screen
        //    PdfPTable head = new PdfPTable(1);
        //    head.HorizontalAlignment = Element.ALIGN_CENTER;
        //    head.TotalWidth = 50f;
        //    PdfPCell headcell = new PdfPCell(new Phrase(""));
        //    headcell.HorizontalAlignment = Element.ALIGN_CENTER;
        //    headcell.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    head.AddCell(headcell);

        //    #region To Print SNP Details in the Table
        //    PdfPTable Snp_Table = new PdfPTable(13);
        //    Snp_Table.TotalWidth = 750f;
        //    Snp_Table.WidthPercentage = 100;
        //    Snp_Table.LockedWidth = true;
        //    float[] widths = new float[] { 55f, 45f, 25f, 25f, 10f, 13f, 30f, 28f, 42f, 18f, 18f, 22f, 35f };// 30f, 25f, 18f, 18f, 20f, 25f, 30f, 20f, 25f, 18f, 18f, 22f };
        //    Snp_Table.SetWidths(widths);
        //    Snp_Table.HorizontalAlignment = Element.ALIGN_CENTER;
        //    Snp_Table.SpacingBefore = 270f;

        //    PdfPCell Header = new PdfPCell(new Phrase("HOUSEHOLD MEMBERS Listing yourself first, complete all spaces below for ALL persons living in the home.", TblFontBold));
        //    Header.Colspan = 15;
        //    Header.FixedHeight = 15f;
        //    Header.BackgroundColor = BaseColor.LIGHT_GRAY;
        //    Header.Border = iTextSharp.text.Rectangle.BOX;
        //    Snp_Table.AddCell(Header);

        //    PdfPCell row2 = new PdfPCell(new Phrase(""));
        //    row2.Colspan = 9;
        //    row2.FixedHeight = 15f;
        //    row2.Border = iTextSharp.text.Rectangle.BOX;
        //    Snp_Table.AddCell(row2);

        //    PdfPCell row2_Health = new PdfPCell(new Phrase("Health", TableFontBoldItalic));
        //    row2_Health.HorizontalAlignment = Element.ALIGN_CENTER;
        //    row2_Health.FixedHeight = 15f;
        //    row2_Health.Border = iTextSharp.text.Rectangle.BOX;
        //    Snp_Table.AddCell(row2_Health);

        //    PdfPCell row2_Space = new PdfPCell(new Phrase(""));
        //    row2_Space.Colspan = 3;
        //    row2_Space.FixedHeight = 15f;
        //    row2_Space.Border = iTextSharp.text.Rectangle.BOX;
        //    Snp_Table.AddCell(row2_Space);

        //    //PdfPCell row3 = new PdfPCell(new Phrase(""));
        //    //row3.Colspan = 3;
        //    //row3.FixedHeight = 15f;
        //    //row3.Border = iTextSharp.text.Rectangle.BOX;
        //    //Snp_Table.AddCell(row3);

        //    PdfPCell row3 = new PdfPCell(new Phrase(""));
        //    row3.Colspan = 2;
        //    row3.FixedHeight = 15f;
        //    row3.Border = iTextSharp.text.Rectangle.BOX;
        //    Snp_Table.AddCell(row3);

        //    PdfPCell row3_SSN = new PdfPCell(new Phrase("Social", TableFontBoldItalic));
        //    row3_SSN.HorizontalAlignment = Element.ALIGN_CENTER;
        //    row3_SSN.FixedHeight = 15f;
        //    row3_SSN.Border = iTextSharp.text.Rectangle.TOP_BORDER + iTextSharp.text.Rectangle.LEFT_BORDER + iTextSharp.text.Rectangle.RIGHT_BORDER;
        //    Snp_Table.AddCell(row3_SSN);

        //    PdfPCell row3_Birth = new PdfPCell(new Phrase("BirthDate", TableFontBoldItalic));
        //    row3_Birth.HorizontalAlignment = Element.ALIGN_CENTER;
        //    row3_Birth.FixedHeight = 15f;
        //    row3_Birth.Border = iTextSharp.text.Rectangle.BOX;
        //    Snp_Table.AddCell(row3_Birth);

        //    PdfPCell row3_Space = new PdfPCell(new Phrase(""));
        //    //row3_Space.Colspan = 2;
        //    row3_Space.FixedHeight = 15f;
        //    row3_Space.Border = iTextSharp.text.Rectangle.BOX;
        //    Snp_Table.AddCell(row3_Space);

        //    PdfPCell row3_Sex = new PdfPCell(new Phrase("Sex", TableFontBoldItalic));
        //    row3_Sex.HorizontalAlignment = Element.ALIGN_CENTER;
        //    row3_Sex.FixedHeight = 15f;
        //    row3_Sex.Border = iTextSharp.text.Rectangle.BOX;
        //    Snp_Table.AddCell(row3_Sex);

        //    PdfPCell row3_Space2 = new PdfPCell(new Phrase(""));
        //    row3_Space2.Colspan = 3;
        //    row3_Space2.HorizontalAlignment = Element.ALIGN_CENTER;
        //    row3_Space2.FixedHeight = 15f;
        //    row3_Space2.Border = iTextSharp.text.Rectangle.BOX;
        //    Snp_Table.AddCell(row3_Space2);

        //    PdfPCell row3_Insurance = new PdfPCell(new Phrase("Insurance ", TableFontBoldItalic));
        //    row3_Insurance.HorizontalAlignment = Element.ALIGN_CENTER;
        //    row3_Insurance.FixedHeight = 15f;
        //    row3_Insurance.Border = iTextSharp.text.Rectangle.BOX;
        //    Snp_Table.AddCell(row3_Insurance);

        //    PdfPCell row3_Veteran = new PdfPCell(new Phrase("Veteran", TableFontBoldItalic));
        //    row3_Veteran.HorizontalAlignment = Element.ALIGN_CENTER;
        //    row3_Veteran.FixedHeight = 15f;
        //    row3_Veteran.Border = iTextSharp.text.Rectangle.BOX;
        //    Snp_Table.AddCell(row3_Veteran);

        //    PdfPCell row3_Receive_FS = new PdfPCell(new Phrase("Receive FS", TableFontBoldItalic));
        //    row3_Receive_FS.HorizontalAlignment = Element.ALIGN_CENTER;
        //    row3_Receive_FS.FixedHeight = 15f;
        //    row3_Receive_FS.Border = iTextSharp.text.Rectangle.BOX;
        //    Snp_Table.AddCell(row3_Receive_FS);

        //    PdfPCell row3_Space3 = new PdfPCell(new Phrase("", TableFontBoldItalic));
        //    row3_Space3.HorizontalAlignment = Element.ALIGN_CENTER;
        //    row3_Space3.FixedHeight = 15f;
        //    row3_Space3.Border = iTextSharp.text.Rectangle.BOX;
        //    Snp_Table.AddCell(row3_Space3);

        //    string[] col = { "Name (last, first, MI)", "Relationship to Applicant", "Security", "mm/dd/yyyy", "Age", "M/F", "Ethnicity", "Race", "Education", "Y/N", "Y/N", "Y/N", "Disabled" };
        //    for (int i = 0; i < col.Length; ++i)
        //    {
        //        PdfPCell cell = new PdfPCell(new Phrase(col[i], TableFontBoldItalic));
        //        cell.HorizontalAlignment = Element.ALIGN_CENTER;
        //        cell.FixedHeight = 15f;
        //        if (i == 2) cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER + iTextSharp.text.Rectangle.LEFT_BORDER + iTextSharp.text.Rectangle.RIGHT_BORDER;
        //        else cell.Border = iTextSharp.text.Rectangle.BOX;
        //        Snp_Table.AddCell(cell);
        //    }

        //    int Tbl_Count = 0; string FamSeq = string.Empty;
        //    List<CaseSnpEntity> snplist = new List<CaseSnpEntity>();
        //    foreach (CaseSnpEntity entity in casesnpList)
        //    {
        //        if (CASEMSTList[0].FamilySeq == entity.FamilySeq)
        //        {
        //            FamSeq = entity.FamilySeq.Trim();
        //            string ApplicantName = entity.NameixLast + " " + entity.NameixFi + " " + entity.NameixMi;//snpEntity.NameixFi.Trim() + " " + snpEntity.NameixLast.Trim();
        //            PdfPCell Name = new PdfPCell(new Phrase(ApplicantName, TableFont));
        //            Name.HorizontalAlignment = Element.ALIGN_LEFT;
        //            Name.FixedHeight = 15f;
        //            Name.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(Name);

        //            string Relation = null;
        //            DataSet dsRelation = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.RELATIONSHIP);
        //            DataTable dtRelation = dsRelation.Tables[0];
        //            foreach (DataRow drRelation in dtRelation.Rows)
        //            {
        //                if (entity.MemberCode.Trim() == drRelation["Code"].ToString().Trim())
        //                {
        //                    Relation = drRelation["LookUpDesc"].ToString().Trim(); break;
        //                }
        //            }
        //            PdfPCell RelationShip = new PdfPCell(new Phrase(Relation, TableFont));
        //            RelationShip.HorizontalAlignment = Element.ALIGN_LEFT;
        //            RelationShip.FixedHeight = 15f;
        //            RelationShip.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(RelationShip);
        //            string SSNNum = null;
        //            if (!string.IsNullOrEmpty(entity.Ssno.Trim()))
        //                //SSNNum = drCaseSNP["SNP_SSNO"].ToString().Trim();
        //                SSNNum = "xxx" + "-" + "xx" + "-" + entity.Ssno.Trim().Substring(5, 4);
        //            PdfPCell SSN = new PdfPCell(new Phrase(SSNNum, TableFont));
        //            SSN.HorizontalAlignment = Element.ALIGN_CENTER;
        //            SSN.FixedHeight = 15f;
        //            SSN.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(SSN);

        //            string DOB = string.Empty;
        //            if (!string.IsNullOrEmpty(entity.AltBdate))
        //            {
        //                DOB = CommonFunctions.ChangeDateFormat(entity.AltBdate.Trim(), Consts.DateTimeFormats.DateSaveFormat, Consts.DateTimeFormats.DateDisplayFormat);
        //            }
        //            PdfPCell BirthDate = new PdfPCell(new Phrase(LookupDataAccess.Getdate(entity.AltBdate.Trim()), TableFont));
        //            BirthDate.HorizontalAlignment = Element.ALIGN_CENTER;
        //            BirthDate.FixedHeight = 15f;
        //            BirthDate.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(BirthDate);

        //            if (entity.Age.Trim() != "0")
        //            {
        //                PdfPCell Age = new PdfPCell(new Phrase(entity.Age.Trim(), TableFont));
        //                Age.HorizontalAlignment = Element.ALIGN_CENTER;
        //                Age.FixedHeight = 15f;
        //                Age.Border = iTextSharp.text.Rectangle.BOX;
        //                Snp_Table.AddCell(Age);
        //            }
        //            else
        //            {
        //                PdfPCell Age = new PdfPCell(new Phrase("", TableFont));
        //                Age.HorizontalAlignment = Element.ALIGN_CENTER;
        //                Age.FixedHeight = 15f;
        //                Age.Border = iTextSharp.text.Rectangle.BOX;
        //                Snp_Table.AddCell(Age);
        //            }

        //            PdfPCell Sex = new PdfPCell(new Phrase(entity.Sex.Trim(), TableFont));
        //            Sex.HorizontalAlignment = Element.ALIGN_CENTER;
        //            Sex.FixedHeight = 15f;
        //            Sex.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(Sex);

        //            string Etinic = null;
        //            DataSet dsEtinic = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.ETHNICODES);
        //            DataTable dtEtinic = dsEtinic.Tables[0];
        //            foreach (DataRow drEtinic in dtEtinic.Rows)
        //            {
        //                if (entity.Ethnic.Trim() == drEtinic["Code"].ToString().Trim())
        //                {
        //                    Etinic = drEtinic["LookUpDesc"].ToString().Trim(); break;
        //                }
        //            }
        //            PdfPCell Snp_Ethnic = new PdfPCell(new Phrase(Etinic, TableFont));
        //            Snp_Ethnic.HorizontalAlignment = Element.ALIGN_LEFT;
        //            Snp_Ethnic.FixedHeight = 15f;
        //            Snp_Ethnic.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(Snp_Ethnic);

        //            string Race = null;
        //            DataSet dsRace = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.RACE);
        //            DataTable dtRace = dsRace.Tables[0];
        //            foreach (DataRow drRace in dtRace.Rows)
        //            {
        //                if (entity.Race.Trim() == drRace["Code"].ToString().Trim())
        //                {
        //                    Race = drRace["LookUpDesc"].ToString().Trim(); break;
        //                }
        //            }
        //            PdfPCell Snp_Race = new PdfPCell(new Phrase(Race, TableFont));
        //            Snp_Race.HorizontalAlignment = Element.ALIGN_LEFT;
        //            Snp_Race.FixedHeight = 15f;
        //            Snp_Race.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(Snp_Race);

        //            string Education = null;
        //            DataSet dsEducation = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.EDUCATIONCODES);
        //            DataTable dtEducation = dsEducation.Tables[0];
        //            foreach (DataRow drEducation in dtEducation.Rows)
        //            {
        //                if (entity.Education.Trim() == drEducation["Code"].ToString().Trim())
        //                {
        //                    Education = drEducation["LookUpDesc"].ToString().Trim(); break;
        //                }
        //            }
        //            PdfPCell Snp_Education = new PdfPCell(new Phrase(Education, TableFont));
        //            Snp_Education.HorizontalAlignment = Element.ALIGN_LEFT;
        //            Snp_Education.FixedHeight = 15f;
        //            Snp_Education.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(Snp_Education);

        //            PdfPCell Insurance = new PdfPCell(new Phrase(entity.HealthIns.Trim(), TableFont));
        //            Insurance.HorizontalAlignment = Element.ALIGN_CENTER;
        //            Insurance.FixedHeight = 15f;
        //            Insurance.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(Insurance);

        //            PdfPCell Vetran = new PdfPCell(new Phrase(entity.Vet.Trim(), TableFont));
        //            Vetran.HorizontalAlignment = Element.ALIGN_CENTER;
        //            Vetran.FixedHeight = 15f;
        //            Vetran.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(Vetran);

        //            PdfPCell FoodStamps1 = new PdfPCell(new Phrase(entity.FootStamps.Trim(), TableFont));
        //            FoodStamps1.HorizontalAlignment = Element.ALIGN_CENTER;
        //            FoodStamps1.FixedHeight = 15f;
        //            FoodStamps1.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(FoodStamps1);

        //            string AGYDisable = null;
        //            DataSet dsDisable = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.DISABLED);
        //            DataTable dtDisable = dsDisable.Tables[0];
        //            foreach (DataRow drDisable in dtDisable.Rows)
        //            {
        //                if (entity.Disable.Trim() == drDisable["Code"].ToString().Trim())
        //                    AGYDisable = drDisable["LookUpDesc"].ToString().Trim();
        //            }
        //            PdfPCell Disabled = new PdfPCell(new Phrase(AGYDisable, TableFont));
        //            Disabled.HorizontalAlignment = Element.ALIGN_LEFT;
        //            Disabled.FixedHeight = 15f;
        //            Disabled.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(Disabled);
        //        }
        //    }

        //    string MotherName = string.Empty; string FatherName = string.Empty;
        //    string M_Address = string.Empty; string F_Address = string.Empty;
        //    string M_Phone = string.Empty; string F_Phone = string.Empty;
        //    string M_FullPart = string.Empty; string F_FullPart = string.Empty;
        //    foreach (CaseSnpEntity drCaseSNP in casesnpList)
        //    {
        //        if (FamSeq != drCaseSNP.FamilySeq.Trim())
        //        {
        //            if (MotherEntity != null)
        //            {
        //                if (drCaseSNP.MemberCode == MotherEntity.Code)
        //                {
        //                    MotherName = drCaseSNP.EmployerName.Trim();
        //                    if (!string.IsNullOrEmpty(drCaseSNP.EmployerStreet.Trim()))
        //                        M_Address = drCaseSNP.EmployerStreet.Trim() + ",";
        //                    if (!string.IsNullOrEmpty(drCaseSNP.EmployerCity.Trim()))
        //                        M_Address = drCaseSNP.EmployerCity.Trim();
        //                    if (!string.IsNullOrEmpty(drCaseSNP.EmplPhone.Trim()))
        //                        M_Phone = drCaseSNP.EmplPhone.Trim();
        //                    if (drCaseSNP.FullTimeHours.Trim() != "0")
        //                        M_FullPart = "F";
        //                    else if (drCaseSNP.FullTimeHours.Trim() != "0")
        //                        M_FullPart = "P";
        //                }
        //            }

        //            if (FatherEntity.Count > 0)
        //            {
        //                foreach (CommonEntity cm in FatherEntity)
        //                {
        //                    if (cm.Code == drCaseSNP.MemberCode)
        //                    {
        //                        FatherName = drCaseSNP.EmployerName.Trim();
        //                        if (!string.IsNullOrEmpty(drCaseSNP.EmployerStreet))
        //                            F_Address = drCaseSNP.EmployerStreet.Trim() + ",";
        //                        if (!string.IsNullOrEmpty(drCaseSNP.EmployerCity.Trim()))
        //                            F_Address = drCaseSNP.EmployerCity.Trim();
        //                        if (!string.IsNullOrEmpty(drCaseSNP.EmplPhone.Trim()))
        //                            F_Phone = drCaseSNP.EmplPhone.Trim();
        //                        if (drCaseSNP.FullTimeHours.Trim() != "0")
        //                            F_FullPart = "F";
        //                        else if (drCaseSNP.FullTimeHours.Trim() != "0")
        //                            F_FullPart = "P";
        //                        break;
        //                    }
        //                }
        //            }

        //            string ApplicantName = drCaseSNP.NameixLast.Trim() + " " + drCaseSNP.NameixFi.Trim() + " " + drCaseSNP.NameixMi.Trim();//snpEntity.NameixFi.Trim() + " " + snpEntity.NameixLast.Trim();
        //            PdfPCell Name = new PdfPCell(new Phrase(ApplicantName, TableFont));
        //            Name.HorizontalAlignment = Element.ALIGN_LEFT;
        //            Name.FixedHeight = 15f;
        //            Name.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(Name);

        //            string Relation = null;
        //            DataSet dsRelation = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.RELATIONSHIP);
        //            DataTable dtRelation = dsRelation.Tables[0];
        //            foreach (DataRow drRelation in dtRelation.Rows)
        //            {
        //                if (drCaseSNP.MemberCode.Trim() == drRelation["Code"].ToString().Trim())
        //                {
        //                    Relation = drRelation["LookUpDesc"].ToString().Trim(); break;
        //                }
        //            }
        //            PdfPCell RelationShip = new PdfPCell(new Phrase(Relation, TableFont));
        //            RelationShip.HorizontalAlignment = Element.ALIGN_LEFT;
        //            RelationShip.FixedHeight = 15f;
        //            RelationShip.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(RelationShip);
        //            string SSNNum = null;
        //            if (!string.IsNullOrEmpty(drCaseSNP.Ssno.Trim()))
        //                SSNNum = "xxx" + "-" + "xx" + "-" + drCaseSNP.Ssno.Trim().Substring(5, 4);
        //            PdfPCell SSN = new PdfPCell(new Phrase(SSNNum, TableFont));
        //            SSN.HorizontalAlignment = Element.ALIGN_CENTER;
        //            SSN.FixedHeight = 15f;
        //            SSN.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(SSN);

        //            string DOB = string.Empty;
        //            if (!string.IsNullOrEmpty(drCaseSNP.AltBdate))
        //            {
        //                DOB = CommonFunctions.ChangeDateFormat(drCaseSNP.AltBdate.Trim(), Consts.DateTimeFormats.DateSaveFormat, Consts.DateTimeFormats.DateDisplayFormat);
        //            }
        //            PdfPCell BirthDate = new PdfPCell(new Phrase(LookupDataAccess.Getdate(drCaseSNP.AltBdate.Trim()), TableFont));
        //            BirthDate.HorizontalAlignment = Element.ALIGN_CENTER;
        //            BirthDate.FixedHeight = 15f;
        //            BirthDate.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(BirthDate);

        //            if (drCaseSNP.Age.Trim() != "0")
        //            {
        //                PdfPCell Age = new PdfPCell(new Phrase(drCaseSNP.Age.Trim(), TableFont));
        //                Age.HorizontalAlignment = Element.ALIGN_CENTER;
        //                Age.FixedHeight = 15f;
        //                Age.Border = iTextSharp.text.Rectangle.BOX;
        //                Snp_Table.AddCell(Age);
        //            }
        //            else
        //            {
        //                PdfPCell Age = new PdfPCell(new Phrase("", TableFont));
        //                Age.HorizontalAlignment = Element.ALIGN_CENTER;
        //                Age.FixedHeight = 15f;
        //                Age.Border = iTextSharp.text.Rectangle.BOX;
        //                Snp_Table.AddCell(Age);
        //            }

        //            PdfPCell Sex = new PdfPCell(new Phrase(drCaseSNP.Sex.Trim(), TableFont));
        //            Sex.HorizontalAlignment = Element.ALIGN_CENTER;
        //            Sex.FixedHeight = 15f;
        //            Sex.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(Sex);

        //            string Etinic = null;
        //            DataSet dsEtinic = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.ETHNICODES);
        //            DataTable dtEtinic = dsEtinic.Tables[0];
        //            foreach (DataRow drEtinic in dtEtinic.Rows)
        //            {
        //                if (drCaseSNP.Ethnic.Trim() == drEtinic["Code"].ToString().Trim())
        //                {
        //                    Etinic = drEtinic["LookUpDesc"].ToString().Trim(); break;
        //                }
        //            }
        //            PdfPCell Snp_Ethnic = new PdfPCell(new Phrase(Etinic, TableFont));
        //            Snp_Ethnic.HorizontalAlignment = Element.ALIGN_LEFT;
        //            Snp_Ethnic.FixedHeight = 15f;
        //            Snp_Ethnic.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(Snp_Ethnic);

        //            string Race = null;
        //            DataSet dsRace = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.RACE);
        //            DataTable dtRace = dsRace.Tables[0];
        //            foreach (DataRow drRace in dtRace.Rows)
        //            {
        //                if (drCaseSNP.Race.Trim() == drRace["Code"].ToString().Trim())
        //                {
        //                    Race = drRace["LookUpDesc"].ToString().Trim(); break;
        //                }
        //            }
        //            PdfPCell Snp_Race = new PdfPCell(new Phrase(Race, TableFont));
        //            Snp_Race.HorizontalAlignment = Element.ALIGN_LEFT;
        //            Snp_Race.FixedHeight = 15f;
        //            Snp_Race.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(Snp_Race);

        //            string Education = null;
        //            DataSet dsEducation = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.EDUCATIONCODES);
        //            DataTable dtEducation = dsEducation.Tables[0];
        //            foreach (DataRow drEducation in dtEducation.Rows)
        //            {
        //                if (drCaseSNP.Education.Trim() == drEducation["Code"].ToString().Trim())
        //                {
        //                    Education = drEducation["LookUpDesc"].ToString().Trim(); break;
        //                }
        //            }
        //            PdfPCell Snp_Education = new PdfPCell(new Phrase(Education, TableFont));
        //            Snp_Education.HorizontalAlignment = Element.ALIGN_LEFT;
        //            Snp_Education.FixedHeight = 15f;
        //            Snp_Education.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(Snp_Education);

        //            PdfPCell Insurance = new PdfPCell(new Phrase(drCaseSNP.HealthIns.Trim(), TableFont));
        //            Insurance.HorizontalAlignment = Element.ALIGN_CENTER;
        //            Insurance.FixedHeight = 15f;
        //            Insurance.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(Insurance);

        //            PdfPCell Vetran = new PdfPCell(new Phrase(drCaseSNP.Vet.Trim(), TableFont));
        //            Vetran.HorizontalAlignment = Element.ALIGN_CENTER;
        //            Vetran.FixedHeight = 15f;
        //            Vetran.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(Vetran);

        //            PdfPCell FoodStamps1 = new PdfPCell(new Phrase(drCaseSNP.FootStamps.Trim(), TableFont));
        //            FoodStamps1.HorizontalAlignment = Element.ALIGN_CENTER;
        //            FoodStamps1.FixedHeight = 15f;
        //            FoodStamps1.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(FoodStamps1);

        //            string AGYDisable = null;
        //            DataSet dsDisable = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.DISABLED);
        //            DataTable dtDisable = dsDisable.Tables[0];
        //            foreach (DataRow drDisable in dtDisable.Rows)
        //            {
        //                if (drCaseSNP.Disable.Trim() == drDisable["Code"].ToString().Trim())
        //                    AGYDisable = drDisable["LookUpDesc"].ToString().Trim();
        //            }
        //            PdfPCell Disabled = new PdfPCell(new Phrase(AGYDisable, TableFont));
        //            Disabled.HorizontalAlignment = Element.ALIGN_LEFT;
        //            Disabled.FixedHeight = 15f;
        //            Disabled.Border = iTextSharp.text.Rectangle.BOX;
        //            Snp_Table.AddCell(Disabled);

        //            Tbl_Count++;
        //            if (Tbl_Count > 10)
        //                break;
        //        }
        //    }
        //    int Len_Var = 130 - Tbl_Count * 13;
        //    for (int j = 0; j <= Len_Var; ++j)  //120
        //    {
        //        PdfPCell SpaceCell = new PdfPCell(new Phrase(" ", TableFont));
        //        SpaceCell.HorizontalAlignment = Element.ALIGN_CENTER;
        //        SpaceCell.FixedHeight = 15f;
        //        SpaceCell.Border = iTextSharp.text.Rectangle.BOX;
        //        Snp_Table.AddCell(SpaceCell);
        //    }

        //    document.Add(head);
        //    document.Add(Snp_Table);
        //    document.NewPage();

        //    #endregion End Of SNP details Table

        //    //cb.BeginText();
        //    //X_Pos = 400; Y_Pos = 580;
        //    //cb.SetFontAndSize(bf_helv, 13);
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Header_Desc, X_Pos, Y_Pos, 0);

        //    //cb.SetFontAndSize(bf_helv, 9);
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Applicant No: ", 30, Y_Pos - 15, 0);
        //    //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(BaseForm.BaseApplicationNo, Timesline), 30 + 72, Y_Pos - 15, 0);

        //    //cb.SetFontAndSize(bf_helv, 13);
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Form_Selection, X_Pos, Y_Pos - 15, 0);
        //    //cb.SetFontAndSize(bf_helv, 9);
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Date Printed: ", 740, Y_Pos - 15, 0);
        //    //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase(LookupDataAccess.Getdate(DateTime.Now.ToShortDateString()), Times), 780, Y_Pos - 15, 0);

        //    //X_Pos = 30; Y_Pos -= 30;
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Applicant Name   ", X_Pos, Y_Pos, 0);
        //    //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(BaseForm.BaseApplicationName, Timesline), X_Pos + 72, Y_Pos, 0);

        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Application Date: ", 740, Y_Pos, 0);
        //    //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase(LookupDataAccess.Getdate(drCaseMST["MST_INTAKE_DATE"].ToString().Trim()), Timesline), 780, Y_Pos, 0);

        //    //cb.EndText();

        //    iTextSharp.text.Font HeaderFontBold = new iTextSharp.text.Font(bf_helv, 13);
        //    //start the Income details of a Family to the table

        //    //PdfPTable SpaceTable = new PdfPTable(1);
        //    //SpaceTable.TotalWidth = 750f;
        //    //SpaceTable.WidthPercentage = 100;
        //    //SpaceTable.LockedWidth = true;
        //    //float[] SpaceTablewidths = new float[] { 80f };
        //    //SpaceTable.SetWidths(SpaceTablewidths);
        //    //SpaceTable.HorizontalAlignment = Element.ALIGN_CENTER;
        //    //SpaceTable.SpacingAfter = 70f;

        //    #region Income Table

        //    PdfPTable IncomeTable = new PdfPTable(5);
        //    IncomeTable.TotalWidth = 750f;
        //    IncomeTable.WidthPercentage = 100;
        //    IncomeTable.LockedWidth = true;
        //    float[] Incomewidths = new float[] { 80f, 50f, 40f, 90f, 80f };
        //    IncomeTable.SetWidths(Incomewidths);
        //    IncomeTable.HorizontalAlignment = Element.ALIGN_CENTER;
        //    IncomeTable.SpacingBefore = 100f;

        //    PdfPCell IncomeCell = new PdfPCell(new Phrase(Header_Desc, HeaderFontBold));
        //    IncomeCell.Colspan = 5;
        //    IncomeCell.HorizontalAlignment = Element.ALIGN_CENTER;
        //    IncomeCell.FixedHeight = 15f;
        //    IncomeCell.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    IncomeTable.AddCell(IncomeCell);

        //    PdfPCell IncomeCell1 = new PdfPCell(new Phrase(Form_Selection, HeaderFontBold));
        //    IncomeCell1.Colspan = 5;
        //    IncomeCell1.HorizontalAlignment = Element.ALIGN_CENTER;
        //    IncomeCell1.FixedHeight = 15f;
        //    IncomeCell1.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    IncomeTable.AddCell(IncomeCell1);

        //    PdfPCell IncomeCell0 = new PdfPCell(new Phrase("Applicant No: " + BaseForm.BaseApplicationNo, TableFont));
        //    IncomeCell0.Colspan = 2;
        //    IncomeCell0.HorizontalAlignment = Element.ALIGN_LEFT;
        //    IncomeCell0.FixedHeight = 15f;
        //    IncomeCell0.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    IncomeTable.AddCell(IncomeCell0);

        //    PdfPCell IncomeCell2 = new PdfPCell(new Phrase("Date Printed: " + DateTime.Now.ToString("g"), TableFont));
        //    IncomeCell2.Colspan = 3;
        //    IncomeCell2.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    IncomeCell2.FixedHeight = 15f;
        //    IncomeCell2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    IncomeTable.AddCell(IncomeCell2);

        //    PdfPCell IncomeCell3 = new PdfPCell(new Phrase("Applicant Name   " + BaseForm.BaseApplicationName, TableFont));
        //    IncomeCell3.Colspan = 3;
        //    IncomeCell3.HorizontalAlignment = Element.ALIGN_LEFT;
        //    IncomeCell3.FixedHeight = 15f;
        //    IncomeCell3.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    IncomeTable.AddCell(IncomeCell3);

        //    if (!string.IsNullOrEmpty(CASEMSTList[0].IntakeDate.Trim()))
        //    {
        //        PdfPCell IncomeCell4 = new PdfPCell(new Phrase("Application Date: " + LookupDataAccess.Getdate(CASEMSTList[0].IntakeDate.Trim()), TableFont));
        //        IncomeCell4.Colspan = 2;
        //        IncomeCell4.HorizontalAlignment = Element.ALIGN_RIGHT;
        //        IncomeCell4.FixedHeight = 15f;
        //        IncomeCell4.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //        IncomeTable.AddCell(IncomeCell4);
        //    }
        //    else
        //    {
        //        PdfPCell IncomeCell4 = new PdfPCell(new Phrase("Application Date: " + "____________", TableFont));
        //        IncomeCell4.Colspan = 2;
        //        IncomeCell4.HorizontalAlignment = Element.ALIGN_RIGHT;
        //        IncomeCell4.FixedHeight = 15f;
        //        IncomeCell4.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //        IncomeTable.AddCell(IncomeCell4);
        //    }
        //    PdfPCell IncomeHeader = new PdfPCell(new Phrase("Financial Information - As reported by Applicant", TblFontBold));
        //    IncomeHeader.Colspan = 5;
        //    IncomeHeader.FixedHeight = 15f;
        //    IncomeHeader.BackgroundColor = BaseColor.LIGHT_GRAY;
        //    IncomeHeader.Border = iTextSharp.text.Rectangle.BOX;
        //    IncomeTable.AddCell(IncomeHeader);
        //    string[] Incomecol = { "Household Member", "Amount", "Interval", "Income Sources", "How Verified?" };
        //    for (int p = 0; p < Incomecol.Length; ++p)
        //    {
        //        PdfPCell Incomecell = new PdfPCell(new Phrase(Incomecol[p], TableFontBoldItalic));
        //        Incomecell.HorizontalAlignment = Element.ALIGN_CENTER;
        //        Incomecell.FixedHeight = 15f;
        //        Incomecell.Border = iTextSharp.text.Rectangle.BOX;
        //        IncomeTable.AddCell(Incomecell);
        //    }

        //    //if (dsIncome.Tables.Count > 0)


        //    decimal Row_Prog_Income = 0; string interval = null, MemName = null, Income_Verifier = null;
        //    string IncomeDesc = null, privSeq = null;
        //    if (incomelist.Count > 0)
        //    {
        //        //DataView dv = dtCaseIncome.DefaultView;
        //        //dv.RowFilter = "INCOME_EXCLUDE = 'N'";
        //        //dv.Sort = "INCOME_FAMILY_SEQ ASC";
        //        //dtCaseIncome = dv.ToTable();
        //        dtIncome = dsIncome.Tables[0];
        //        foreach (CaseIncomeEntity drCaseIncome in incomelist)
        //        {
        //            Income_Verifier = interval = IncomeDesc = string.Empty;
        //            if (drCaseIncome.FamilySeq.Trim() != privSeq)
        //            {
        //                if (!string.IsNullOrEmpty(drCaseIncome.FamilySeq.Trim()))
        //                    MemName = Get_Member_Name(drCaseIncome.FamilySeq.Trim(), string.Empty);
        //                PdfPCell House_HoldMem = new PdfPCell(new Phrase(MemName, TableFont));
        //                House_HoldMem.Colspan = 5;
        //                House_HoldMem.HorizontalAlignment = Element.ALIGN_LEFT;
        //                House_HoldMem.FixedHeight = 15f;
        //                House_HoldMem.Border = iTextSharp.text.Rectangle.BOX;
        //                IncomeTable.AddCell(House_HoldMem);
        //                privSeq = drCaseIncome.FamilySeq.Trim();
        //            }
        //            PdfPCell Income_Space = new PdfPCell(new Phrase("", TableFont));
        //            Income_Space.Colspan = 1;
        //            Income_Space.HorizontalAlignment = Element.ALIGN_CENTER;
        //            Income_Space.FixedHeight = 15f;
        //            Income_Space.Border = iTextSharp.text.Rectangle.BOX;
        //            IncomeTable.AddCell(Income_Space);

        //            if (!string.IsNullOrEmpty(drCaseIncome.ProgIncome.Trim()))
        //                Row_Prog_Income = decimal.Parse(drCaseIncome.ProgIncome.Trim());
        //            PdfPCell Amount = new PdfPCell(new Phrase(Row_Prog_Income.ToString(), TableFont));
        //            Amount.HorizontalAlignment = Element.ALIGN_CENTER;
        //            Amount.FixedHeight = 15f;
        //            Amount.Border = iTextSharp.text.Rectangle.BOX;
        //            IncomeTable.AddCell(Amount);

        //            if (!string.IsNullOrEmpty(drCaseIncome.Interval.Trim()))
        //                interval = LookupDataAccess.ShowIncomeInterval(drCaseIncome.Interval.Trim());
        //            PdfPCell Freq = new PdfPCell(new Phrase(interval, TableFont));
        //            Freq.HorizontalAlignment = Element.ALIGN_LEFT;
        //            Freq.FixedHeight = 15f;
        //            Freq.Border = iTextSharp.text.Rectangle.BOX;
        //            IncomeTable.AddCell(Freq);

        //            if (!string.IsNullOrEmpty(drCaseIncome.Type.Trim()))
        //                IncomeDesc = Get_IncomeType_Desc(drCaseIncome.Type.Trim());

        //            PdfPCell IncomeSource = new PdfPCell(new Phrase(IncomeDesc, TableFont));
        //            IncomeSource.HorizontalAlignment = Element.ALIGN_CENTER;
        //            IncomeSource.FixedHeight = 15f;
        //            IncomeSource.Border = iTextSharp.text.Rectangle.BOX;
        //            IncomeTable.AddCell(IncomeSource);

        //            if (!string.IsNullOrEmpty(drCaseIncome.HowVerified.Trim()))
        //                Income_Verifier = drCaseIncome.HowVerified.Trim();

        //            PdfPCell IncomeVer = new PdfPCell(new Phrase(Income_Verifier, TableFont));
        //            IncomeVer.HorizontalAlignment = Element.ALIGN_LEFT;
        //            IncomeVer.FixedHeight = 15f;
        //            IncomeVer.Border = iTextSharp.text.Rectangle.BOX;
        //            IncomeTable.AddCell(IncomeVer);

        //        }
        //    }

        //    PdfPTable TotIncomeTable = new PdfPTable(8);
        //    TotIncomeTable.TotalWidth = 750f;
        //    TotIncomeTable.WidthPercentage = 100;
        //    TotIncomeTable.LockedWidth = true;
        //    float[] TotIncomeTablewidths = new float[] { 50f, 30f, 50f, 40f, 60f, 30f, 50f, 30f };
        //    TotIncomeTable.SetWidths(TotIncomeTablewidths);
        //    TotIncomeTable.HorizontalAlignment = Element.ALIGN_CENTER;
        //    //IncomeTable.SpacingBefore = 60f;

        //    PdfPCell Total_Space = new PdfPCell(new Phrase("", TableFont));
        //    Total_Space.Colspan = 8;
        //    Total_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    Total_Space.FixedHeight = 15f;
        //    Total_Space.Border = iTextSharp.text.Rectangle.BOX;
        //    TotIncomeTable.AddCell(Total_Space);

        //    PdfPCell Total = new PdfPCell(new Phrase("Total Income", TableFont));
        //    Total.HorizontalAlignment = Element.ALIGN_LEFT;
        //    Total.FixedHeight = 15f;
        //    Total.Border = iTextSharp.text.Rectangle.BOX;
        //    TotIncomeTable.AddCell(Total);

        //    PdfPCell Total_Income = new PdfPCell(new Phrase(CASEMSTList[0].FamIncome.Trim(), TableFont));
        //    Total_Income.HorizontalAlignment = Element.ALIGN_CENTER;
        //    Total_Income.FixedHeight = 15f;
        //    Total_Income.Border = iTextSharp.text.Rectangle.BOX;
        //    TotIncomeTable.AddCell(Total_Income);

        //    PdfPCell Program = new PdfPCell(new Phrase("Program Income", TableFont));
        //    Program.HorizontalAlignment = Element.ALIGN_LEFT;
        //    Program.FixedHeight = 15f;
        //    Program.Border = iTextSharp.text.Rectangle.BOX;
        //    TotIncomeTable.AddCell(Program);

        //    PdfPCell Program_Income = new PdfPCell(new Phrase(CASEMSTList[0].ProgIncome.Trim(), TableFont));
        //    Program_Income.HorizontalAlignment = Element.ALIGN_CENTER;
        //    Program_Income.FixedHeight = 15f;
        //    Program_Income.Border = iTextSharp.text.Rectangle.BOX;
        //    TotIncomeTable.AddCell(Program_Income);

        //    PdfPCell Federal = new PdfPCell(new Phrase("% of Federal Poverty Level", TableFont));
        //    Federal.HorizontalAlignment = Element.ALIGN_LEFT;
        //    Federal.FixedHeight = 15f;
        //    Federal.Border = iTextSharp.text.Rectangle.BOX;
        //    TotIncomeTable.AddCell(Federal);

        //    PdfPCell Federal_Poverty = new PdfPCell(new Phrase(CASEMSTList[0].Poverty.Trim() + "%", TableFont));
        //    Federal_Poverty.HorizontalAlignment = Element.ALIGN_CENTER;
        //    Federal_Poverty.FixedHeight = 15f;
        //    Federal_Poverty.Border = iTextSharp.text.Rectangle.BOX;
        //    TotIncomeTable.AddCell(Federal_Poverty);

        //    PdfPCell HUD = new PdfPCell(new Phrase("HUD%", TableFont));
        //    HUD.HorizontalAlignment = Element.ALIGN_LEFT;
        //    HUD.FixedHeight = 15f;
        //    HUD.Border = iTextSharp.text.Rectangle.BOX;
        //    TotIncomeTable.AddCell(HUD);

        //    PdfPCell HUD_Value = new PdfPCell(new Phrase(CASEMSTList[0].Hud.Trim() + "%", TableFont));
        //    HUD_Value.HorizontalAlignment = Element.ALIGN_CENTER;
        //    HUD_Value.FixedHeight = 15f;
        //    HUD_Value.Border = iTextSharp.text.Rectangle.BOX;
        //    TotIncomeTable.AddCell(HUD_Value);

        //    document.Add(IncomeTable);
        //    document.Add(TotIncomeTable);

        //    #endregion

        //    #region Income Verification

        //    iTextSharp.text.Image _image_UnChecked = iTextSharp.text.Image.GetInstance(Context.Server.MapPath("~\\Resources\\Icons\\16X16\\CheckBoxUnchecked.JPG"));
        //    iTextSharp.text.Image _image_Checked = iTextSharp.text.Image.GetInstance(Context.Server.MapPath("~\\Resources\\Icons\\16X16\\CheckBoxChecked.JPG"));

        //    _image_UnChecked.ScalePercent(60f);
        //    _image_Checked.ScalePercent(60f);


        //    PdfPTable Income_Last = new PdfPTable(15);
        //    Income_Last.TotalWidth = 750f;
        //    Income_Last.WidthPercentage = 100;
        //    Income_Last.LockedWidth = true;
        //    float[] Income_Lastwidths = new float[] { 20f, 8f, 13f, 8f, 20f, 8f, 25f, 8f, 18f, 8f, 15f, 25f, 20f, 13f, 30f };
        //    Income_Last.SetWidths(Income_Lastwidths);
        //    Income_Last.HorizontalAlignment = Element.ALIGN_CENTER;
        //    Income_Last.SpacingBefore = 20f;

        //    PdfPCell Income_Verified = new PdfPCell(new Phrase("Income Verified", TableFontBoldItalic));
        //    Income_Verified.HorizontalAlignment = Element.ALIGN_LEFT;
        //    Income_Verified.FixedHeight = 15f;
        //    Income_Verified.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    Income_Last.AddCell(Income_Verified);

        //    if (CASEMSTList[0].VerifyW2.Trim() == "Y")
        //    {
        //        PdfPCell W2Cheked = new PdfPCell(_image_Checked);
        //        W2Cheked.VerticalAlignment = Element.ALIGN_MIDDLE;
        //        W2Cheked.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
        //        //W2Cheked.FixedHeight = 15f;
        //        W2Cheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //        Income_Last.AddCell(W2Cheked);
        //    }
        //    else
        //    {
        //        PdfPCell W2UnCheked = new PdfPCell(_image_UnChecked);
        //        W2UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
        //        W2UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
        //        //W2UnCheked.FixedHeight = 15f;
        //        W2UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //        Income_Last.AddCell(W2UnCheked);
        //    }

        //    PdfPCell W2Text = new PdfPCell(new Phrase("W2", Times));
        //    W2Text.HorizontalAlignment = Element.ALIGN_LEFT;
        //    W2Text.FixedHeight = 15f;
        //    W2Text.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    Income_Last.AddCell(W2Text);

        //    if (CASEMSTList[0].VerifyCheckStub.Trim() == "Y")
        //    {
        //        PdfPCell CHECK_STUB_Check = new PdfPCell(_image_Checked);
        //        CHECK_STUB_Check.VerticalAlignment = Element.ALIGN_MIDDLE;
        //        CHECK_STUB_Check.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
        //        //W2Cheked.FixedHeight = 15f;
        //        CHECK_STUB_Check.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //        Income_Last.AddCell(CHECK_STUB_Check);
        //    }
        //    else
        //    {
        //        PdfPCell CHECK_STUB_UnCheked = new PdfPCell(_image_UnChecked);
        //        CHECK_STUB_UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
        //        CHECK_STUB_UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
        //        //W2UnCheked.FixedHeight = 15f;
        //        CHECK_STUB_UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //        Income_Last.AddCell(CHECK_STUB_UnCheked);
        //    }

        //    PdfPCell CHECK_STUB = new PdfPCell(new Phrase("CHECK_STUB", Times));
        //    CHECK_STUB.HorizontalAlignment = Element.ALIGN_LEFT;
        //    CHECK_STUB.FixedHeight = 15f;
        //    CHECK_STUB.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    Income_Last.AddCell(CHECK_STUB);

        //    if (CASEMSTList[0].VerifyLetter.Trim() == "Y")
        //    {
        //        PdfPCell LETTER_Check = new PdfPCell(_image_Checked);
        //        LETTER_Check.VerticalAlignment = Element.ALIGN_MIDDLE;
        //        LETTER_Check.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
        //        //W2Cheked.FixedHeight = 15f;
        //        LETTER_Check.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //        Income_Last.AddCell(LETTER_Check);
        //    }
        //    else
        //    {
        //        PdfPCell LETTER_UnCheked = new PdfPCell(_image_UnChecked);
        //        LETTER_UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
        //        LETTER_UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
        //        //W2UnCheked.FixedHeight = 15f;
        //        LETTER_UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //        Income_Last.AddCell(LETTER_UnCheked);
        //    }

        //    PdfPCell LETTER = new PdfPCell(new Phrase("Letter/Budget Sheet", Times));
        //    LETTER.HorizontalAlignment = Element.ALIGN_LEFT;
        //    LETTER.FixedHeight = 15f;
        //    LETTER.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    Income_Last.AddCell(LETTER);

        //    if (CASEMSTList[0].VerifyTaxReturn.Trim() == "Y")
        //    {
        //        PdfPCell TAX_RETURN_Check = new PdfPCell(_image_Checked);
        //        TAX_RETURN_Check.VerticalAlignment = Element.ALIGN_MIDDLE;
        //        TAX_RETURN_Check.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
        //        //W2Cheked.FixedHeight = 15f;
        //        TAX_RETURN_Check.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //        Income_Last.AddCell(TAX_RETURN_Check);
        //    }
        //    else
        //    {
        //        PdfPCell TAX_RETURN_UnCheked = new PdfPCell(_image_UnChecked);
        //        TAX_RETURN_UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
        //        TAX_RETURN_UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
        //        //W2UnCheked.FixedHeight = 15f;
        //        TAX_RETURN_UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //        Income_Last.AddCell(TAX_RETURN_UnCheked);
        //    }

        //    PdfPCell TAX_RETURN = new PdfPCell(new Phrase("Tax Returns", Times));
        //    TAX_RETURN.HorizontalAlignment = Element.ALIGN_LEFT;
        //    TAX_RETURN.FixedHeight = 15f;
        //    TAX_RETURN.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    Income_Last.AddCell(TAX_RETURN);

        //    if (CASEMSTList[0].VerifyOther.Trim() == "Y")
        //    {
        //        PdfPCell OTHER_Check = new PdfPCell(_image_Checked);
        //        OTHER_Check.VerticalAlignment = Element.ALIGN_MIDDLE;
        //        OTHER_Check.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
        //        //W2Cheked.FixedHeight = 15f;
        //        OTHER_Check.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //        Income_Last.AddCell(OTHER_Check);
        //    }
        //    else
        //    {
        //        PdfPCell OTHER_UnCheked = new PdfPCell(_image_UnChecked);
        //        OTHER_UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
        //        OTHER_UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
        //        //W2UnCheked.FixedHeight = 15f;
        //        OTHER_UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //        Income_Last.AddCell(OTHER_UnCheked);
        //    }

        //    PdfPCell OTHER = new PdfPCell(new Phrase("Other", Times));
        //    OTHER.HorizontalAlignment = Element.ALIGN_LEFT;
        //    OTHER.FixedHeight = 15f;
        //    OTHER.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    Income_Last.AddCell(OTHER);

        //    PdfPCell Verification_Date = new PdfPCell(new Phrase("Verification Date:", Times));
        //    Verification_Date.HorizontalAlignment = Element.ALIGN_LEFT;
        //    Verification_Date.FixedHeight = 15f;
        //    Verification_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    Income_Last.AddCell(Verification_Date);

        //    if (!string.IsNullOrEmpty(CASEMSTList[0].EligDate.Trim().Trim()))
        //    {
        //        PdfPCell Verify_Date = new PdfPCell(new Phrase(LookupDataAccess.Getdate(CASEMSTList[0].EligDate.Trim().Trim()), Timesline));
        //        Verify_Date.HorizontalAlignment = Element.ALIGN_LEFT;
        //        Verify_Date.FixedHeight = 15f;
        //        Verify_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //        Income_Last.AddCell(Verify_Date);
        //    }
        //    else
        //    {
        //        PdfPCell Verify_Date_Space = new PdfPCell(new Phrase("________________", Times));
        //        Verify_Date_Space.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
        //        Verify_Date_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //        Verify_Date_Space.FixedHeight = 15f;
        //        Verify_Date_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //        Income_Last.AddCell(Verify_Date_Space);
        //    }

        //    PdfPCell Verifier_Head = new PdfPCell(new Phrase("Verifier:", Times));
        //    Verifier_Head.HorizontalAlignment = Element.ALIGN_LEFT;
        //    Verifier_Head.FixedHeight = 15f;
        //    Verifier_Head.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    Income_Last.AddCell(Verifier_Head);

        //    string CaseWorker = null;
        //    if (dtVerifier.Rows.Count > 0)
        //    {
        //        foreach (DataRow drVerifier in dtVerifier.Rows)
        //        {
        //            if (CASEMSTList[0].Verifier.Trim().Trim() == drVerifier["PWH_CASEWORKER"].ToString().Trim())
        //            {
        //                CaseWorker = drVerifier["NAME"].ToString().Trim();
        //                break;
        //            }
        //        }
        //    }

        //    if (!string.IsNullOrEmpty(CaseWorker))
        //    {
        //        PdfPCell Verifier = new PdfPCell(new Phrase(CaseWorker, Timesline));
        //        Verifier.HorizontalAlignment = Element.ALIGN_LEFT;
        //        Verifier.FixedHeight = 15f;
        //        Verifier.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //        Income_Last.AddCell(Verifier);
        //    }
        //    else
        //    {
        //        PdfPCell Verifier_Space = new PdfPCell(new Phrase("_______________________________", Times));
        //        Verifier_Space.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
        //        Verifier_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //        Verifier_Space.FixedHeight = 15f;
        //        Verifier_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //        Income_Last.AddCell(Verifier_Space);
        //    }



        //    document.Add(Income_Last);


        //    #endregion

        //    #region LastIncome Table Not Used

        //    //PdfPTable Income_Last = new PdfPTable(15);
        //    //Income_Last.TotalWidth = 750f;
        //    //Income_Last.WidthPercentage = 100;
        //    //Income_Last.LockedWidth = true;
        //    //float[] Income_Lastwidths = new float[] { 20f, 8f, 13f, 8f, 20f, 8f, 25f, 8f, 18f, 8f, 15f, 25f, 20f, 13f, 30f };
        //    //Income_Last.SetWidths(Income_Lastwidths);
        //    //Income_Last.HorizontalAlignment = Element.ALIGN_CENTER;
        //    //Income_Last.SpacingBefore = 20f;


        //    //iTextSharp.text.Image _image_UnChecked = iTextSharp.text.Image.GetInstance(Context.Server.MapPath("~\\Resources\\Icons\\16X16\\CheckBoxUnchecked.JPG"));
        //    //iTextSharp.text.Image _image_Checked = iTextSharp.text.Image.GetInstance(Context.Server.MapPath("~\\Resources\\Icons\\16X16\\CheckBoxChecked.JPG"));

        //    //_image_UnChecked.ScalePercent(60f);
        //    //_image_Checked.ScalePercent(60f);


        //    //PdfPCell Income_Verified = new PdfPCell(new Phrase("Income Verified", TableFontBoldItalic));
        //    //Income_Verified.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //Income_Verified.FixedHeight = 15f;
        //    //Income_Verified.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //Income_Last.AddCell(Income_Verified);

        //    //if (drCaseMST["MST_VERIFY_W2"].ToString().Trim() == "Y")
        //    //{
        //    //    PdfPCell W2Cheked = new PdfPCell(_image_Checked);
        //    //    W2Cheked.VerticalAlignment = Element.ALIGN_MIDDLE;
        //    //    W2Cheked.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
        //    //    //W2Cheked.FixedHeight = 15f;
        //    //    W2Cheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(W2Cheked);
        //    //}
        //    //else
        //    //{
        //    //    PdfPCell W2UnCheked = new PdfPCell(_image_UnChecked);
        //    //    W2UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
        //    //    W2UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    //    //W2UnCheked.FixedHeight = 15f;
        //    //    W2UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(W2UnCheked);
        //    //}

        //    //PdfPCell W2Text = new PdfPCell(new Phrase("W2", Times));
        //    //W2Text.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //W2Text.FixedHeight = 15f;
        //    //W2Text.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //Income_Last.AddCell(W2Text);

        //    //if (drCaseMST["MST_VERIFY_CHECK_STUB"].ToString().Trim() == "Y")
        //    //{
        //    //    PdfPCell CHECK_STUB_Check = new PdfPCell(_image_Checked);
        //    //    CHECK_STUB_Check.VerticalAlignment = Element.ALIGN_MIDDLE;
        //    //    CHECK_STUB_Check.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
        //    //    //W2Cheked.FixedHeight = 15f;
        //    //    CHECK_STUB_Check.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(CHECK_STUB_Check);
        //    //}
        //    //else
        //    //{
        //    //    PdfPCell CHECK_STUB_UnCheked = new PdfPCell(_image_UnChecked);
        //    //    CHECK_STUB_UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
        //    //    CHECK_STUB_UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    //    //W2UnCheked.FixedHeight = 15f;
        //    //    CHECK_STUB_UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(CHECK_STUB_UnCheked);
        //    //}

        //    //PdfPCell CHECK_STUB = new PdfPCell(new Phrase("CHECK_STUB", Times));
        //    //CHECK_STUB.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //CHECK_STUB.FixedHeight = 15f;
        //    //CHECK_STUB.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //Income_Last.AddCell(CHECK_STUB);

        //    //if (drCaseMST["MST_VERIFY_LETTER"].ToString().Trim() == "Y")
        //    //{
        //    //    PdfPCell LETTER_Check = new PdfPCell(_image_Checked);
        //    //    LETTER_Check.VerticalAlignment = Element.ALIGN_MIDDLE;
        //    //    LETTER_Check.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
        //    //    //W2Cheked.FixedHeight = 15f;
        //    //    LETTER_Check.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(LETTER_Check);
        //    //}
        //    //else
        //    //{
        //    //    PdfPCell LETTER_UnCheked = new PdfPCell(_image_UnChecked);
        //    //    LETTER_UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
        //    //    LETTER_UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    //    //W2UnCheked.FixedHeight = 15f;
        //    //    LETTER_UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(LETTER_UnCheked);
        //    //}

        //    //PdfPCell LETTER = new PdfPCell(new Phrase("Letter/Budget Sheet", Times));
        //    //LETTER.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //LETTER.FixedHeight = 15f;
        //    //LETTER.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //Income_Last.AddCell(LETTER);

        //    //if (drCaseMST["MST_VERIFY_TAX_RETURN"].ToString().Trim() == "Y")
        //    //{
        //    //    PdfPCell TAX_RETURN_Check = new PdfPCell(_image_Checked);
        //    //    TAX_RETURN_Check.VerticalAlignment = Element.ALIGN_MIDDLE;
        //    //    TAX_RETURN_Check.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
        //    //    //W2Cheked.FixedHeight = 15f;
        //    //    TAX_RETURN_Check.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(TAX_RETURN_Check);
        //    //}
        //    //else
        //    //{
        //    //    PdfPCell TAX_RETURN_UnCheked = new PdfPCell(_image_UnChecked);
        //    //    TAX_RETURN_UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
        //    //    TAX_RETURN_UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    //    //W2UnCheked.FixedHeight = 15f;
        //    //    TAX_RETURN_UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(TAX_RETURN_UnCheked);
        //    //}

        //    //PdfPCell TAX_RETURN = new PdfPCell(new Phrase("Tax Returns", Times));
        //    //TAX_RETURN.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //TAX_RETURN.FixedHeight = 15f;
        //    //TAX_RETURN.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //Income_Last.AddCell(TAX_RETURN);

        //    //if (drCaseMST["MST_VERIFY_OTHER"].ToString().Trim() == "Y")
        //    //{
        //    //    PdfPCell OTHER_Check = new PdfPCell(_image_Checked);
        //    //    OTHER_Check.VerticalAlignment = Element.ALIGN_MIDDLE;
        //    //    OTHER_Check.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
        //    //    //W2Cheked.FixedHeight = 15f;
        //    //    OTHER_Check.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(OTHER_Check);
        //    //}
        //    //else
        //    //{
        //    //    PdfPCell OTHER_UnCheked = new PdfPCell(_image_UnChecked);
        //    //    OTHER_UnCheked.VerticalAlignment = Element.ALIGN_MIDDLE;
        //    //    OTHER_UnCheked.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    //    //W2UnCheked.FixedHeight = 15f;
        //    //    OTHER_UnCheked.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(OTHER_UnCheked);
        //    //}

        //    //PdfPCell OTHER = new PdfPCell(new Phrase("Other", Times));
        //    //OTHER.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //OTHER.FixedHeight = 15f;
        //    //OTHER.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //Income_Last.AddCell(OTHER);

        //    //PdfPCell Verification_Date = new PdfPCell(new Phrase("Verification Date:", Times));
        //    //Verification_Date.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //Verification_Date.FixedHeight = 15f;
        //    //Verification_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //Income_Last.AddCell(Verification_Date);

        //    //if (!string.IsNullOrEmpty(drCaseMST["MST_ELIG_DATE"].ToString().Trim()))
        //    //{
        //    //    PdfPCell Verify_Date = new PdfPCell(new Phrase(drCaseMST["MST_ELIG_DATE"].ToString().Trim(), Timesline));
        //    //    Verify_Date.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //    Verify_Date.FixedHeight = 15f;
        //    //    Verify_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(Verify_Date);
        //    //}
        //    //else
        //    //{
        //    //    PdfPCell Verify_Date_Space = new PdfPCell(new Phrase("________________", Times));
        //    //    Verify_Date_Space.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
        //    //    Verify_Date_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //    Verify_Date_Space.FixedHeight = 15f;
        //    //    Verify_Date_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(Verify_Date_Space);
        //    //}

        //    //PdfPCell Verifier_Head = new PdfPCell(new Phrase("Verifier:", Times));
        //    //Verifier_Head.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //Verifier_Head.FixedHeight = 15f;
        //    //Verifier_Head.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //Income_Last.AddCell(Verifier_Head);

        //    //string CaseWorker = null;
        //    //if (dtVerifier.Rows.Count > 0)
        //    //{
        //    //    foreach (DataRow drVerifier in dtVerifier.Rows)
        //    //    {
        //    //        if (drCaseMST["MST_VERIFIER"].ToString().Trim() == drVerifier["PWH_CASEWORKER"].ToString().Trim())
        //    //        {
        //    //            CaseWorker = drVerifier["NAME"].ToString().Trim();
        //    //            break;
        //    //        }
        //    //    }
        //    //}

        //    //if (!string.IsNullOrEmpty(CaseWorker))
        //    //{
        //    //    PdfPCell Verifier = new PdfPCell(new Phrase(CaseWorker, Timesline));
        //    //    Verifier.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //    Verifier.FixedHeight = 15f;
        //    //    Verifier.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(Verifier);
        //    //}
        //    //else
        //    //{
        //    //    PdfPCell Verifier_Space = new PdfPCell(new Phrase("_______________________________", Times));
        //    //    Verifier_Space.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
        //    //    Verifier_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //    Verifier_Space.FixedHeight = 15f;
        //    //    Verifier_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(Verifier_Space);
        //    //}

        //    //if (ShortName != "UETHDA")
        //    //{
        //    //    PdfPCell V_Space = new PdfPCell(new Phrase("", Times));
        //    //    V_Space.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
        //    //    V_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //    V_Space.Colspan = 15;
        //    //    V_Space.FixedHeight = 15f;
        //    //    V_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(V_Space);

        //    //    PdfPCell P_Ver = new PdfPCell(new Phrase("Parent Verification ______________________________________________________________________________", Times));
        //    //    P_Ver.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
        //    //    P_Ver.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //    P_Ver.Colspan = 11;
        //    //    P_Ver.FixedHeight = 15f;
        //    //    P_Ver.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(P_Ver);

        //    //    PdfPCell P_Ver1 = new PdfPCell(new Phrase("Reverify Date: ________________", Times));
        //    //    P_Ver1.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
        //    //    P_Ver1.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //    P_Ver1.Colspan = 2;
        //    //    P_Ver1.FixedHeight = 15f;
        //    //    P_Ver1.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(P_Ver1);

        //    //    //PdfPCell Ver_Date_Space = new PdfPCell(new Phrase("________________", Times));
        //    //    //Ver_Date_Space.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
        //    //    //Ver_Date_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //    //Ver_Date_Space.FixedHeight = 15f;
        //    //    //Ver_Date_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    //Income_Last.AddCell(Ver_Date_Space);

        //    //    PdfPCell P_Ver2 = new PdfPCell(new Phrase("Verifier ", Times));
        //    //    P_Ver2.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
        //    //    P_Ver2.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //    //P_Ver2.Colspan = 4;
        //    //    P_Ver2.FixedHeight = 15f;
        //    //    P_Ver2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(P_Ver2);

        //    //    PdfPCell Ver_Space = new PdfPCell(new Phrase("_______________________________", Times));
        //    //    Ver_Space.VerticalAlignment = PdfPCell.BOTTOM_BORDER;
        //    //    Ver_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //    Ver_Space.FixedHeight = 15f;
        //    //    Ver_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Income_Last.AddCell(Ver_Space);
        //    //}

        //    //End of Income Details

        //    #endregion

        //    //#region Start of Energy Calculations
        //    //PdfPTable Energy = new PdfPTable(3);
        //    //Energy.TotalWidth = 750f;
        //    //Energy.WidthPercentage = 100;
        //    //Energy.LockedWidth = true;
        //    //float[] Energy_widths = new float[] { 60, 60f, 60f };
        //    //Energy.SetWidths(Energy_widths);
        //    //Energy.HorizontalAlignment = Element.ALIGN_CENTER;
        //    //Energy.SpacingBefore = 20f;


        //    //if (Privileges.ModuleCode == "05" || gvApp.CurrentRow.Cells["AppDet"].Value.ToString() == "Application for Assistance" || DEPState == "TX")
        //    //{
        //    //    PdfPCell Compute = new PdfPCell(new Phrase("Compute Energy Burden", TblFontBold));
        //    //    Compute.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //    Compute.FixedHeight = 15f;
        //    //    Compute.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Energy.AddCell(Compute);

        //    //    PdfPCell Compute_Space = new PdfPCell(new Phrase("", TableFontBoldItalic));
        //    //    Compute_Space.Colspan = 2;
        //    //    Compute_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //    Compute_Space.FixedHeight = 15f;
        //    //    Compute_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Energy.AddCell(Compute_Space);

        //    //    decimal UtilityCost = 0; decimal EnergyBurden = 0;
        //    //    if (ADDCUST_List.Count > 0)
        //    //    {
        //    //        AddCustEntity Custdet = ADDCUST_List.Find(u => u.ACTCODE.Equals("C00012") && u.ACTAPPNO.Equals(BaseForm.BaseApplicationNo));
        //    //        if (Custdet != null)
        //    //        {
        //    //            if (!string.IsNullOrEmpty(Custdet.ACTNUMRESP.Trim()))
        //    //                UtilityCost = decimal.Parse(Custdet.ACTNUMRESP.Trim());
        //    //        }
        //    //    }

        //    //    PdfPCell Utility_Costs = new PdfPCell(new Phrase("Utility Costs: " + UtilityCost.ToString("0.00"), Times));
        //    //    Utility_Costs.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //    Utility_Costs.FixedHeight = 15f;
        //    //    Utility_Costs.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Energy.AddCell(Utility_Costs);

        //    //    PdfPCell Annual_Income = new PdfPCell(new Phrase("Annual Income Total:" + drCaseMST["MST_FAM_INCOME"].ToString().Trim(), Times));
        //    //    Annual_Income.HorizontalAlignment = Element.ALIGN_CENTER;
        //    //    Annual_Income.FixedHeight = 15f;
        //    //    Annual_Income.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Energy.AddCell(Annual_Income);

        //    //    if (decimal.Parse(drCaseMST["MST_FAM_INCOME"].ToString().Trim()) > 0 && UtilityCost > 0)
        //    //        EnergyBurden = (UtilityCost / decimal.Parse(drCaseMST["MST_FAM_INCOME"].ToString().Trim())) * 100;

        //    //    PdfPCell Energy_Burden = new PdfPCell(new Phrase("Energy Burden: " + EnergyBurden.ToString("0.00") + "%", Times));
        //    //    Energy_Burden.HorizontalAlignment = Element.ALIGN_CENTER;
        //    //    Energy_Burden.FixedHeight = 15f;
        //    //    Energy_Burden.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    //    Energy.AddCell(Energy_Burden);
        //    //}

        //    //#endregion


        //    //cb.BeginText();
        //    //X_Pos = 400; Y_Pos = 580;
        //    //cb.SetFontAndSize(bf_helv, 13);
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Header_Desc, X_Pos, Y_Pos, 0);
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Form_Selection, X_Pos, Y_Pos - 15, 0);
        //    //cb.SetFontAndSize(bf_helv, 9);
        //    //cb.EndText();

        //    //cb.BeginText();
        //    //X_Pos = 400; Y_Pos = 580;
        //    //cb.SetFontAndSize(bf_helv, 13);
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Header_Desc, X_Pos, Y_Pos, 0);

        //    //cb.SetFontAndSize(bf_helv, 9);
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Applicant No: ", 30, Y_Pos - 15, 0);
        //    //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(BaseForm.BaseApplicationNo, Timesline), 30 + 72, Y_Pos - 15, 0);

        //    //cb.SetFontAndSize(bf_helv, 13);
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, Form_Selection, X_Pos, Y_Pos - 15, 0);
        //    //cb.SetFontAndSize(bf_helv, 9);
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Date Printed: ", 740, Y_Pos - 15, 0);
        //    //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase(LookupDataAccess.Getdate(DateTime.Now.ToShortDateString()), Times), 780, Y_Pos - 15, 0);

        //    //X_Pos = 30; Y_Pos -= 30;
        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_LEFT, "Applicant Name   ", X_Pos, Y_Pos, 0);
        //    //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_LEFT, new Phrase(BaseForm.BaseApplicationName, Timesline), X_Pos + 72, Y_Pos, 0);

        //    //cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Application Date: ", 740, Y_Pos, 0);
        //    //ColumnText.ShowTextAligned(cb, PdfContentByte.ALIGN_RIGHT, new Phrase(LookupDataAccess.Getdate(drCaseMST["MST_INTAKE_DATE"].ToString().Trim()), Timesline), 780, Y_Pos, 0);

        //    //cb.EndText();

        //    //PdfPTable Spacetable = new PdfPTable(1);
        //    //Spacetable.HorizontalAlignment = Element.ALIGN_CENTER;
        //    //Spacetable.TotalWidth = 600f;

        //    //document.Add(Spacetable);



        //    //#endregion

        //    //#region Health Insurance Information

        //    //PdfPTable InsuranceTable = new PdfPTable(5);
        //    //InsuranceTable.TotalWidth = 750f;
        //    //InsuranceTable.WidthPercentage = 100;
        //    //InsuranceTable.LockedWidth = true;
        //    //float[] InsuranceTable_widths = new float[] { 25f, 30f, 45f, 60f, 25f };
        //    //InsuranceTable.SetWidths(InsuranceTable_widths);
        //    //InsuranceTable.HorizontalAlignment = Element.ALIGN_CENTER;
        //    //InsuranceTable.SpacingBefore = 10f;

        //    //PdfPCell INS_Head = new PdfPCell(new Phrase("HEALTH INSURANCE INFORMATION", TblFontBold));
        //    //INS_Head.Colspan = 5;
        //    //INS_Head.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //INS_Head.FixedHeight = 15f;
        //    //INS_Head.Border = iTextSharp.text.Rectangle.BOX;
        //    //INS_Head.BorderWidth = 1f;
        //    //InsuranceTable.AddCell(INS_Head);

        //    //for (int i = 0; i < 4; i++)
        //    //{
        //    //    PdfPCell I1 = new PdfPCell(new Phrase("Name", TableFont));
        //    //    I1.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //    I1.Colspan = 5;
        //    //    I1.FixedHeight = 15f;
        //    //    I1.BorderWidth = 1f;
        //    //    I1.Border = iTextSharp.text.Rectangle.BOX;
        //    //    InsuranceTable.AddCell(I1);

        //    //    if (chldMstDetails != null && i == 0)
        //    //    {
        //    //        PdfPCell I2 = new PdfPCell(new Phrase("Medical", TableFont));
        //    //        I2.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        I2.Rowspan = 2;
        //    //        I2.BorderWidth = 1f;
        //    //        I2.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(I2);

        //    //        PdfPCell I3 = new PdfPCell(new Phrase("Insurance Plan", TableFont));
        //    //        I3.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        I3.BorderWidth = 1f;
        //    //        I3.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(I3);

        //    //        PdfPCell I4 = new PdfPCell(new Phrase("Doctor Name", TableFont));
        //    //        I4.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        I4.BorderWidth = 1f;
        //    //        I4.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(I4);

        //    //        PdfPCell I5 = new PdfPCell(new Phrase(chldMstDetails.DoctorAddress.Trim(), TableFont));
        //    //        I5.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        I5.BorderWidth = 1f;
        //    //        I5.Rowspan = 2;
        //    //        I5.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(I5);

        //    //        PdfPCell I6 = new PdfPCell(new Phrase("Telephone", TableFont));
        //    //        I6.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        I6.BorderWidth = 1f;
        //    //        I6.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(I6);

        //    //        if (!string.IsNullOrEmpty(chldMstDetails.MedPlan.Trim()))
        //    //        {
        //    //            PdfPCell I7 = new PdfPCell(new Phrase(chldMstDetails.MedPlan.Trim(), TableFont));
        //    //            I7.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //            I7.BorderWidth = 1f;
        //    //            I7.Border = iTextSharp.text.Rectangle.BOX;
        //    //            InsuranceTable.AddCell(I7);
        //    //        }
        //    //        else
        //    //        {
        //    //            PdfPCell I7 = new PdfPCell(new Phrase("", TableFont));
        //    //            I7.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //            I7.BorderWidth = 1f;
        //    //            I7.FixedHeight = 15f;
        //    //            I7.Border = iTextSharp.text.Rectangle.BOX;
        //    //            InsuranceTable.AddCell(I7);
        //    //        }

        //    //        if (!string.IsNullOrEmpty(chldMstDetails.DoctorName.Trim()))
        //    //        {
        //    //            PdfPCell I8 = new PdfPCell(new Phrase(chldMstDetails.DoctorName.Trim(), TableFont));
        //    //            I8.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //            I8.BorderWidth = 1f;
        //    //            I8.Border = iTextSharp.text.Rectangle.BOX;
        //    //            InsuranceTable.AddCell(I8);
        //    //        }
        //    //        else
        //    //        {
        //    //            PdfPCell I8 = new PdfPCell(new Phrase("", TableFont));
        //    //            I8.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //            I8.BorderWidth = 1f;
        //    //            I8.FixedHeight = 15f;
        //    //            I8.Border = iTextSharp.text.Rectangle.BOX;
        //    //            InsuranceTable.AddCell(I8);
        //    //        }

        //    //        if (!string.IsNullOrEmpty(chldMstDetails.DoctorPhone.Trim()))
        //    //        {
        //    //            PdfPCell I9 = new PdfPCell(new Phrase(chldMstDetails.DoctorPhone.Trim(), TableFont));
        //    //            I9.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //            I9.BorderWidth = 1f;
        //    //            I9.Border = iTextSharp.text.Rectangle.BOX;
        //    //            InsuranceTable.AddCell(I9);
        //    //        }
        //    //        else
        //    //        {
        //    //            PdfPCell I9 = new PdfPCell(new Phrase("", TableFont));
        //    //            I9.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //            I9.BorderWidth = 1f;
        //    //            I9.FixedHeight = 15f;
        //    //            I9.Border = iTextSharp.text.Rectangle.BOX;
        //    //            InsuranceTable.AddCell(I9);
        //    //        }

        //    //        PdfPCell D1 = new PdfPCell(new Phrase("Dental", TableFont));
        //    //        D1.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        D1.BorderWidth = 1f;
        //    //        D1.Rowspan = 2;
        //    //        D1.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(D1);

        //    //        PdfPCell D2 = new PdfPCell(new Phrase("Insurance Plan", TableFont));
        //    //        D2.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        D2.BorderWidth = 1f;
        //    //        D2.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(I3);

        //    //        PdfPCell D3 = new PdfPCell(new Phrase("Doctor Name", TableFont));
        //    //        D3.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        D3.BorderWidth = 1f;
        //    //        D3.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(D3);

        //    //        PdfPCell D4 = new PdfPCell(new Phrase(chldMstDetails.DentistAddress.Trim(), TableFont));
        //    //        D4.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        D4.BorderWidth = 1f;
        //    //        D4.Rowspan = 2;
        //    //        D4.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(D4);

        //    //        PdfPCell D5 = new PdfPCell(new Phrase("Telephone", TableFont));
        //    //        D5.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        D5.BorderWidth = 1f;
        //    //        D5.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(D5);

        //    //        if (!string.IsNullOrEmpty(chldMstDetails.DentalPlan.Trim()))
        //    //        {
        //    //            PdfPCell D6 = new PdfPCell(new Phrase(chldMstDetails.DentalPlan.Trim(), TableFont));
        //    //            D6.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //            D6.BorderWidth = 1f;
        //    //            D6.Border = iTextSharp.text.Rectangle.BOX;
        //    //            InsuranceTable.AddCell(D6);
        //    //        }
        //    //        else
        //    //        {
        //    //            PdfPCell D6 = new PdfPCell(new Phrase("", TableFont));
        //    //            D6.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //            D6.BorderWidth = 1f;
        //    //            D6.FixedHeight = 15f;
        //    //            D6.Border = iTextSharp.text.Rectangle.BOX;
        //    //            InsuranceTable.AddCell(D6);
        //    //        }

        //    //        if (!string.IsNullOrEmpty(chldMstDetails.DentistName.Trim()))
        //    //        {
        //    //            PdfPCell D7 = new PdfPCell(new Phrase(chldMstDetails.DentistName.Trim(), TableFont));
        //    //            D7.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //            D7.BorderWidth = 1f;
        //    //            D7.Border = iTextSharp.text.Rectangle.BOX;
        //    //            InsuranceTable.AddCell(D7);
        //    //        }
        //    //        else
        //    //        {
        //    //            PdfPCell D7 = new PdfPCell(new Phrase("", TableFont));
        //    //            D7.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //            D7.BorderWidth = 1f;
        //    //            D7.FixedHeight = 15f;
        //    //            D7.Border = iTextSharp.text.Rectangle.BOX;
        //    //            InsuranceTable.AddCell(D7);
        //    //        }

        //    //        if (!string.IsNullOrEmpty(chldMstDetails.DentistPhone.Trim()))
        //    //        {
        //    //            PdfPCell D8 = new PdfPCell(new Phrase(chldMstDetails.DentistPhone.Trim(), TableFont));
        //    //            D8.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //            D8.BorderWidth = 1f;
        //    //            D8.Border = iTextSharp.text.Rectangle.BOX;
        //    //            InsuranceTable.AddCell(D8);
        //    //        }
        //    //        else
        //    //        {
        //    //            PdfPCell D8 = new PdfPCell(new Phrase("", TableFont));
        //    //            D8.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //            D8.BorderWidth = 1f;
        //    //            D8.FixedHeight = 15f;
        //    //            D8.Border = iTextSharp.text.Rectangle.BOX;
        //    //            InsuranceTable.AddCell(D8);
        //    //        }
        //    //    }
        //    //    else
        //    //    {
        //    //        PdfPCell I2 = new PdfPCell(new Phrase("Medical", TableFont));
        //    //        I2.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        I2.Rowspan = 2;
        //    //        I2.BorderWidth = 1f;
        //    //        I2.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(I2);

        //    //        PdfPCell I3 = new PdfPCell(new Phrase("Insurance Plan", TableFont));
        //    //        I3.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        I3.BorderWidth = 1f;
        //    //        I3.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(I3);

        //    //        PdfPCell I4 = new PdfPCell(new Phrase("Doctor Name", TableFont));
        //    //        I4.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        I4.BorderWidth = 1f;
        //    //        I4.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(I4);

        //    //        PdfPCell I5 = new PdfPCell(new Phrase("", TableFont));
        //    //        I5.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        I5.BorderWidth = 1f;
        //    //        I5.Rowspan = 2;
        //    //        I5.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(I5);

        //    //        PdfPCell I6 = new PdfPCell(new Phrase("Telephone", TableFont));
        //    //        I6.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        I6.BorderWidth = 1f;
        //    //        I6.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(I6);

        //    //        PdfPCell I7 = new PdfPCell(new Phrase("", TableFont));
        //    //        I7.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        I7.BorderWidth = 1f;
        //    //        I7.FixedHeight = 15f;
        //    //        I7.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(I7);

        //    //        PdfPCell I8 = new PdfPCell(new Phrase("", TableFont));
        //    //        I8.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        I8.BorderWidth = 1f;
        //    //        I8.FixedHeight = 15f;
        //    //        I8.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(I8);

        //    //        PdfPCell I9 = new PdfPCell(new Phrase("", TableFont));
        //    //        I9.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        I9.BorderWidth = 1f;
        //    //        I9.FixedHeight = 15f;
        //    //        I9.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(I9);


        //    //        PdfPCell D1 = new PdfPCell(new Phrase("Dental", TableFont));
        //    //        D1.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        D1.BorderWidth = 1f;
        //    //        D1.Rowspan = 2;
        //    //        D1.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(D1);

        //    //        PdfPCell D2 = new PdfPCell(new Phrase("Insurance Plan", TableFont));
        //    //        D2.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        D2.BorderWidth = 1f;
        //    //        D2.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(I3);

        //    //        PdfPCell D3 = new PdfPCell(new Phrase("Doctor Name", TableFont));
        //    //        D3.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        D3.BorderWidth = 1f;
        //    //        D3.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(D3);

        //    //        PdfPCell D4 = new PdfPCell(new Phrase("", TableFont));
        //    //        D4.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        D4.BorderWidth = 1f;
        //    //        D4.Rowspan = 2;
        //    //        D4.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(D4);

        //    //        PdfPCell D5 = new PdfPCell(new Phrase("Telephone", TableFont));
        //    //        D5.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        D5.BorderWidth = 1f;
        //    //        D5.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(D5);

        //    //        PdfPCell D6 = new PdfPCell(new Phrase("", TableFont));
        //    //        D6.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        D6.BorderWidth = 1f;
        //    //        D6.FixedHeight = 15f;
        //    //        D6.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(D6);

        //    //        PdfPCell D7 = new PdfPCell(new Phrase("", TableFont));
        //    //        D7.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        D7.BorderWidth = 1f;
        //    //        D7.FixedHeight = 15f;
        //    //        D7.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(D7);

        //    //        PdfPCell D8 = new PdfPCell(new Phrase("", TableFont));
        //    //        D8.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //        D8.BorderWidth = 1f;
        //    //        D8.FixedHeight = 15f;
        //    //        D8.Border = iTextSharp.text.Rectangle.BOX;
        //    //        InsuranceTable.AddCell(D8);
        //    //    }
        //    //}

        //    //document.Add(InsuranceTable);

        //    //#endregion

        //    //#region Mediacal data from chldmst

        //    ////PdfPTable MediaclTable = new PdfPTable(4);
        //    ////MediaclTable.TotalWidth = 750f;
        //    ////MediaclTable.WidthPercentage = 100;
        //    ////MediaclTable.LockedWidth = true;
        //    ////float[] MediaclTable_widths = new float[] { 55f, 50f, 40f, 50f };
        //    ////MediaclTable.SetWidths(MediaclTable_widths);
        //    ////MediaclTable.HorizontalAlignment = Element.ALIGN_CENTER;
        //    ////MediaclTable.SpacingBefore = 10f;
        //    ////if (chldMstDetails != null)
        //    ////{

        //    ////    PdfPCell Chld_Med_Plan = new PdfPCell(new Phrase("Child Medical Insurance Plan", Times));
        //    ////    Chld_Med_Plan.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Med_Plan.FixedHeight = 15f;
        //    ////    Chld_Med_Plan.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Med_Plan);

        //    ////    if (!string.IsNullOrEmpty(chldMstDetails.MedPlan.Trim()))
        //    ////    {
        //    ////        PdfPCell Chld_Med_Plan_Line = new PdfPCell(new Phrase(chldMstDetails.MedPlan.Trim(), Timesline));
        //    ////        Chld_Med_Plan_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Med_Plan_Line.FixedHeight = 15f;
        //    ////        Chld_Med_Plan_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Med_Plan_Line);
        //    ////    }
        //    ////    else
        //    ////    {
        //    ////        PdfPCell Chld_Med_Plan_Line = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        Chld_Med_Plan_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Med_Plan_Line.FixedHeight = 15f;
        //    ////        Chld_Med_Plan_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Med_Plan_Line);
        //    ////    }

        //    ////    PdfPCell Chld_Med_No = new PdfPCell(new Phrase("Medical Insurance Name", Times));
        //    ////    Chld_Med_No.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////    //Emer_Space.Colspan = 2;
        //    ////    Chld_Med_No.FixedHeight = 15f;
        //    ////    Chld_Med_No.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Med_No);

        //    ////    if (!string.IsNullOrEmpty(chldMstDetails.MedInsurer.Trim()))
        //    ////    {
        //    ////        PdfPCell Chld_Med_No_Line = new PdfPCell(new Phrase(chldMstDetails.MedInsurer.Trim(), Timesline));
        //    ////        Chld_Med_No_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Med_No_Line.FixedHeight = 15f;
        //    ////        Chld_Med_No_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Med_No_Line);
        //    ////    }
        //    ////    else
        //    ////    {
        //    ////        PdfPCell Chld_Med_No_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////        Chld_Med_No_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Med_No_Line.FixedHeight = 15f;
        //    ////        Chld_Med_No_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Med_No_Line);
        //    ////    }

        //    ////    PdfPCell Chld_Ins_Catg = new PdfPCell(new Phrase("Medical Insurance Category", Times));
        //    ////    Chld_Ins_Catg.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    //Emer_Space.Colspan = 2;
        //    ////    Chld_Ins_Catg.FixedHeight = 15f;
        //    ////    Chld_Ins_Catg.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Ins_Catg);

        //    ////    if (!string.IsNullOrEmpty(chldMstDetails.InsCat.Trim()))
        //    ////    {
        //    ////        string INS_CATG_DESC=string.Empty;
        //    ////        if (lookInsuranceCategory.Count > 0)
        //    ////        {
        //    ////            foreach (CommonEntity Ins in lookInsuranceCategory)
        //    ////            {
        //    ////                if (chldMstDetails.InsCat.Trim() == Ins.Code.Trim())
        //    ////                {
        //    ////                    INS_CATG_DESC = Ins.Desc.Trim(); break;
        //    ////                }
        //    ////            }
        //    ////        }

        //    ////        PdfPCell Chld_Med_No_Line = new PdfPCell(new Phrase(INS_CATG_DESC, Timesline));
        //    ////        Chld_Med_No_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Med_No_Line.FixedHeight = 15f;
        //    ////        Chld_Med_No_Line.Colspan = 3;
        //    ////        Chld_Med_No_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Med_No_Line);
        //    ////    }
        //    ////    else
        //    ////    {
        //    ////        PdfPCell Chld_Med_No_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////        Chld_Med_No_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Med_No_Line.Colspan = 3;
        //    ////        Chld_Med_No_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Med_No_Line);
        //    ////    }


        //    ////    PdfPCell Chld_Doctor = new PdfPCell(new Phrase("Child Doctor & Address", Times));
        //    ////    Chld_Doctor.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Doctor.FixedHeight = 15f;
        //    ////    Chld_Doctor.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Doctor);

        //    ////    if (!string.IsNullOrEmpty(chldMstDetails.DoctorName.Trim()))
        //    ////    {
        //    ////        PdfPCell Chld_Doctor_Line = new PdfPCell(new Phrase(chldMstDetails.DoctorName.Trim() + ", " + chldMstDetails.DoctorAddress, Timesline));
        //    ////        Chld_Doctor_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Doctor_Line.FixedHeight = 15f;
        //    ////        Chld_Doctor_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Doctor_Line);
        //    ////    }
        //    ////    else
        //    ////    {
        //    ////        PdfPCell Chld_Doctor_Line = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        Chld_Doctor_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Doctor_Line.FixedHeight = 15f;
        //    ////        Chld_Doctor_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Doctor_Line);
        //    ////    }

        //    ////    PdfPCell Chld_Doc_Phone = new PdfPCell(new Phrase("Phone#", Times));
        //    ////    Chld_Doc_Phone.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////    //Emer_Space.Colspan = 2;
        //    ////    Chld_Doc_Phone.FixedHeight = 15f;
        //    ////    Chld_Doc_Phone.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Doc_Phone);

        //    ////    if (!string.IsNullOrEmpty(chldMstDetails.DoctorPhone.Trim()))
        //    ////    {
        //    ////        MaskedTextBox mskdocphn = new MaskedTextBox();
        //    ////        mskdocphn.Mask = "(000)000-0000";
        //    ////        mskdocphn.Text = chldMstDetails.DoctorPhone.Trim();
        //    ////        PdfPCell Chld_Doc_Phone_Line = new PdfPCell(new Phrase(mskdocphn.Text.Trim(), Timesline));
        //    ////        Chld_Doc_Phone_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Doc_Phone_Line.FixedHeight = 15f;
        //    ////        Chld_Doc_Phone_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Doc_Phone_Line);
        //    ////    }
        //    ////    else
        //    ////    {
        //    ////        PdfPCell Chld_Doc_Phone_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////        Chld_Doc_Phone_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Doc_Phone_Line.FixedHeight = 15f;
        //    ////        Chld_Doc_Phone_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Doc_Phone_Line);
        //    ////    }


        //    ////    PdfPCell Emer_Space2 = new PdfPCell(new Phrase("", Times));
        //    ////    Emer_Space2.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Emer_Space2.Colspan = 4;
        //    ////    Emer_Space2.FixedHeight = 10f;
        //    ////    Emer_Space2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Emer_Space2);

        //    ////    PdfPCell Chld_Dent_Plan = new PdfPCell(new Phrase("Child Dental Insurance Plan", Times));
        //    ////    Chld_Dent_Plan.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Dent_Plan.FixedHeight = 15f;
        //    ////    Chld_Dent_Plan.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Dent_Plan);

        //    ////    if (!string.IsNullOrEmpty(chldMstDetails.DentalPlan.Trim()))
        //    ////    {
        //    ////        PdfPCell Chld_Dent_Plan_Line = new PdfPCell(new Phrase(chldMstDetails.DentalPlan.Trim(), Timesline));
        //    ////        Chld_Dent_Plan_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Dent_Plan_Line.FixedHeight = 15f;
        //    ////        Chld_Dent_Plan_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Dent_Plan_Line);
        //    ////    }
        //    ////    else
        //    ////    {
        //    ////        PdfPCell Chld_Dent_Plan_Line = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        Chld_Dent_Plan_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Dent_Plan_Line.FixedHeight = 15f;
        //    ////        Chld_Dent_Plan_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Dent_Plan_Line);
        //    ////    }

        //    ////    PdfPCell Chld_Dent_No = new PdfPCell(new Phrase("Dental Insurance Name", Times));
        //    ////    Chld_Dent_No.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////    //Emer_Space.Colspan = 2;
        //    ////    Chld_Dent_No.FixedHeight = 15f;
        //    ////    Chld_Dent_No.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Dent_No);

        //    ////    if (!string.IsNullOrEmpty(chldMstDetails.DentalInsurer.Trim()))
        //    ////    {
        //    ////        PdfPCell Chld_Dent_No_Line = new PdfPCell(new Phrase(chldMstDetails.DentalInsurer.Trim(), Timesline));
        //    ////        Chld_Dent_No_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Dent_No_Line.FixedHeight = 15f;
        //    ////        Chld_Dent_No_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Dent_No_Line);
        //    ////    }
        //    ////    else
        //    ////    {
        //    ////        PdfPCell Chld_Dent_No_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////        Chld_Dent_No_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Dent_No_Line.FixedHeight = 15f;
        //    ////        Chld_Dent_No_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Dent_No_Line);
        //    ////    }


        //    ////    PdfPCell Chld_Dentist = new PdfPCell(new Phrase("Child Dentist & Address", Times));
        //    ////    Chld_Dentist.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Dentist.FixedHeight = 15f;
        //    ////    Chld_Dentist.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Dentist);
        //    ////    if (!string.IsNullOrEmpty(chldMstDetails.DentistName.Trim()))
        //    ////    {
        //    ////        PdfPCell Chld_Dentist_Line = new PdfPCell(new Phrase(chldMstDetails.DentistName.Trim() + ", " + chldMstDetails.DentistAddress, Timesline));
        //    ////        Chld_Dentist_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Dentist_Line.FixedHeight = 15f;
        //    ////        Chld_Dentist_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Dentist_Line);
        //    ////    }
        //    ////    else
        //    ////    {
        //    ////        PdfPCell Chld_Dentist_Line = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        Chld_Dentist_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Dentist_Line.FixedHeight = 15f;
        //    ////        Chld_Dentist_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Dentist_Line);
        //    ////    }

        //    ////    PdfPCell Chld_Dentist_Phone = new PdfPCell(new Phrase("Phone#", Times));
        //    ////    Chld_Dentist_Phone.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////    //Emer_Space.Colspan = 2;
        //    ////    Chld_Dentist_Phone.FixedHeight = 15f;
        //    ////    Chld_Dentist_Phone.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Dentist_Phone);

        //    ////    if (!string.IsNullOrEmpty(chldMstDetails.DentistPhone.Trim()))
        //    ////    {
        //    ////        MaskedTextBox mskdocphn = new MaskedTextBox();
        //    ////        mskdocphn.Mask = "(000)000-0000";
        //    ////        mskdocphn.Text = chldMstDetails.DentistPhone.Trim();
        //    ////        PdfPCell Chld_Dentist_Phone_Line = new PdfPCell(new Phrase(mskdocphn.Text.Trim(), Timesline));
        //    ////        Chld_Dentist_Phone_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Dentist_Phone_Line.FixedHeight = 15f;
        //    ////        Chld_Dentist_Phone_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Dentist_Phone_Line);
        //    ////    }
        //    ////    else
        //    ////    {
        //    ////        PdfPCell Chld_Dentist_Phone_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////        Chld_Dentist_Phone_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Chld_Dentist_Phone_Line.FixedHeight = 15f;
        //    ////        Chld_Dentist_Phone_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Chld_Dentist_Phone_Line);
        //    ////    }

        //    ////    PdfPCell Emer_Space3 = new PdfPCell(new Phrase("", Times));
        //    ////    Emer_Space3.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Emer_Space3.Colspan = 4;
        //    ////    Emer_Space3.FixedHeight = 10f;
        //    ////    Emer_Space3.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Emer_Space3);

        //    ////    if (caseconddet != null)
        //    ////    {
        //    ////        PdfPCell ALLERGIES = new PdfPCell(new Phrase("My Child has the following ALLERGIES", Times));
        //    ////        ALLERGIES.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        ALLERGIES.FixedHeight = 15f;
        //    ////        ALLERGIES.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(ALLERGIES);

        //    ////        if (!string.IsNullOrEmpty(caseconddet.Allergy.Trim()))
        //    ////        {
        //    ////            string Allergy_desc = caseconddet.Allergy.Replace("\r\n", " ");
        //    ////            PdfPCell ALLERGIESLine = new PdfPCell(new Phrase(Allergy_desc.Trim(), Timesline));
        //    ////            ALLERGIESLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            ALLERGIESLine.Colspan = 2;
        //    ////            ALLERGIESLine.FixedHeight = 15f;
        //    ////            ALLERGIESLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(ALLERGIESLine);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell ALLERGIESLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            ALLERGIESLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            ALLERGIESLine.Colspan = 2;
        //    ////            ALLERGIESLine.FixedHeight = 15f;
        //    ////            ALLERGIESLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(ALLERGIESLine);
        //    ////        }
        //    ////        PdfPCell ALLERGIES_Space = new PdfPCell(new Phrase("", Times));
        //    ////        ALLERGIES_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //ALLERGIES_Space.Colspan = 2;
        //    ////        ALLERGIES_Space.FixedHeight = 15f;
        //    ////        ALLERGIES_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(ALLERGIES_Space);

        //    ////        PdfPCell DISABILITY = new PdfPCell(new Phrase("Has been diagonosed with following DISABILITY", Times));
        //    ////        DISABILITY.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        DISABILITY.FixedHeight = 15f;
        //    ////        DISABILITY.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DISABILITY);

        //    ////        if (!string.IsNullOrEmpty(chldMstDetails.Disability.Trim()))
        //    ////        {
        //    ////            PdfPCell DISABILITYLine = new PdfPCell(new Phrase(chldMstDetails.DisabilityType.Trim(), Timesline));
        //    ////            DISABILITYLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            DISABILITYLine.FixedHeight = 15f;
        //    ////            DISABILITYLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(DISABILITYLine);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell DISABILITYLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            DISABILITYLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            DISABILITYLine.FixedHeight = 15f;
        //    ////            DISABILITYLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(DISABILITYLine);
        //    ////        }

        //    ////        PdfPCell DISABILITY_Date = new PdfPCell(new Phrase("Date", Times));
        //    ////        DISABILITY_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////        //DISABILITY_Space.Colspan = 2;
        //    ////        DISABILITY_Date.FixedHeight = 15f;
        //    ////        DISABILITY_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DISABILITY_Date);

        //    ////        if (!string.IsNullOrEmpty(chldMstDetails.DiagnosisDate.Trim()))
        //    ////        {
        //    ////            PdfPCell DISABILITY_Date_Line = new PdfPCell(new Phrase(LookupDataAccess.Getdate(chldMstDetails.DiagnosisDate.Trim()), Timesline));
        //    ////            DISABILITY_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            DISABILITY_Date_Line.FixedHeight = 15f;
        //    ////            DISABILITY_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(DISABILITY_Date_Line);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell DISABILITY_Date_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////            DISABILITY_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            DISABILITY_Date_Line.FixedHeight = 15f;
        //    ////            DISABILITY_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(DISABILITY_Date_Line);
        //    ////        }


        //    ////        PdfPCell MEDICATIONS = new PdfPCell(new Phrase("is taking following MEDICATIONS", Times));
        //    ////        MEDICATIONS.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        MEDICATIONS.FixedHeight = 15f;
        //    ////        MEDICATIONS.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICATIONS);

        //    ////        if (!string.IsNullOrEmpty(caseconddet.Medications.Trim()))
        //    ////        {
        //    ////            string Medications_desc = caseconddet.Medications.Replace("\r\n", " ");
        //    ////            PdfPCell MEDICATIONSLine = new PdfPCell(new Phrase(Medications_desc.Trim(), Timesline));
        //    ////            MEDICATIONSLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICATIONSLine.Colspan = 2;
        //    ////            MEDICATIONSLine.FixedHeight = 15f;
        //    ////            MEDICATIONSLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICATIONSLine);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell MEDICATIONSLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            MEDICATIONSLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICATIONSLine.Colspan = 2;
        //    ////            MEDICATIONSLine.FixedHeight = 15f;
        //    ////            MEDICATIONSLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICATIONSLine);
        //    ////        }

        //    ////        PdfPCell MEDICATIONS_Space = new PdfPCell(new Phrase("", Times));
        //    ////        MEDICATIONS_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //MEDICATIONS_Space.Colspan = 2;
        //    ////        MEDICATIONS_Space.FixedHeight = 15f;
        //    ////        MEDICATIONS_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICATIONS_Space);

        //    ////        PdfPCell MEDICAL = new PdfPCell(new Phrase("has the following MEDICAL CONDITIONS", Times));
        //    ////        MEDICAL.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        MEDICAL.FixedHeight = 15f;
        //    ////        MEDICAL.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICAL);

        //    ////        if (!string.IsNullOrEmpty(caseconddet.MedConds.Trim()))
        //    ////        {
        //    ////            string MedConds_desc = caseconddet.MedConds.Replace("\r\n", " ");
        //    ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase(MedConds_desc.Trim(), Timesline));
        //    ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICALLine.Colspan = 2;
        //    ////            MEDICALLine.FixedHeight = 15f;
        //    ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICALLine);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICALLine.Colspan = 2;
        //    ////            MEDICALLine.FixedHeight = 15f;
        //    ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICALLine);
        //    ////        }

        //    ////        PdfPCell MEDICAL_Space = new PdfPCell(new Phrase("", Times));
        //    ////        MEDICAL_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //MEDICAL_Space.Colspan = 2;
        //    ////        MEDICAL_Space.FixedHeight = 15f;
        //    ////        MEDICAL_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICAL_Space);

        //    ////        PdfPCell Diet = new PdfPCell(new Phrase("DIETARY RESTRICTIONS", Times));
        //    ////        Diet.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Diet.FixedHeight = 15f;
        //    ////        Diet.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Diet);

        //    ////        if (!string.IsNullOrEmpty(caseconddet.DietRestrct.Trim()))
        //    ////        {
        //    ////            string MedConds_desc = caseconddet.DietRestrct.Replace("\r\n", " ");
        //    ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase(MedConds_desc.Trim(), Timesline));
        //    ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICALLine.Colspan = 2;
        //    ////            MEDICALLine.FixedHeight = 15f;
        //    ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICALLine);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICALLine.Colspan = 2;
        //    ////            MEDICALLine.FixedHeight = 15f;
        //    ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICALLine);
        //    ////        }

        //    ////        PdfPCell DIET_Space = new PdfPCell(new Phrase("", Times));
        //    ////        DIET_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //MEDICAL_Space.Colspan = 2;
        //    ////        DIET_Space.FixedHeight = 15f;
        //    ////        DIET_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DIET_Space);

        //    ////        PdfPCell House = new PdfPCell(new Phrase("HOUSEHOLD CONCERNS ", Times));
        //    ////        House.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        House.FixedHeight = 15f;
        //    ////        House.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(House);

        //    ////        if (!string.IsNullOrEmpty(caseconddet.HHConcerns.Trim()))
        //    ////        {
        //    ////            string MedConds_desc = caseconddet.HHConcerns.Replace("\r\n", " ");
        //    ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase(MedConds_desc.Trim(), Timesline));
        //    ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICALLine.Colspan = 2;
        //    ////            MEDICALLine.FixedHeight = 15f;
        //    ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICALLine);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICALLine.Colspan = 2;
        //    ////            MEDICALLine.FixedHeight = 15f;
        //    ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICALLine);
        //    ////        }

        //    ////        PdfPCell HH_Space = new PdfPCell(new Phrase("", Times));
        //    ////        HH_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //MEDICAL_Space.Colspan = 2;
        //    ////        HH_Space.FixedHeight = 15f;
        //    ////        HH_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(HH_Space);

        //    ////        PdfPCell Devp = new PdfPCell(new Phrase("DEVELOPMENTAL CONCERNS ", Times));
        //    ////        Devp.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Devp.FixedHeight = 15f;
        //    ////        Devp.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Devp);

        //    ////        if (!string.IsNullOrEmpty(caseconddet.DevlConcerns.Trim()))
        //    ////        {
        //    ////            string MedConds_desc = caseconddet.DevlConcerns.Replace("\r\n", " ");
        //    ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase(MedConds_desc.Trim(), Timesline));
        //    ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICALLine.Colspan = 2;
        //    ////            MEDICALLine.FixedHeight = 15f;
        //    ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICALLine);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICALLine.Colspan = 2;
        //    ////            MEDICALLine.FixedHeight = 15f;
        //    ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICALLine);
        //    ////        }

        //    ////        PdfPCell DEVL_Space = new PdfPCell(new Phrase("", Times));
        //    ////        DEVL_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //MEDICAL_Space.Colspan = 2;
        //    ////        DEVL_Space.FixedHeight = 15f;
        //    ////        DEVL_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DEVL_Space);

        //    ////        PdfPCell AltFnd = new PdfPCell(new Phrase("Alternate Fund", Times));
        //    ////        AltFnd.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        AltFnd.FixedHeight = 15f;
        //    ////        AltFnd.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(AltFnd);

        //    ////        if (!string.IsNullOrEmpty(chldMstDetails.AltFundSrc.Trim()))
        //    ////        {
        //    ////            string AltFund_Desc = string.Empty;
        //    ////            foreach (DataRow drFUND in dtFUND.Rows)
        //    ////            {
        //    ////                if (chldMstDetails.AltFundSrc.ToString().Trim() == drFUND["Code"].ToString().Trim())
        //    ////                {
        //    ////                    AltFund_Desc = drFUND["LookUpDesc"].ToString().Trim(); break;
        //    ////                }
        //    ////            }

        //    ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase(AltFund_Desc, Timesline));
        //    ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            AltFnddesc.FixedHeight = 15f;
        //    ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(AltFnddesc);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            AltFnddesc.FixedHeight = 15f;
        //    ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(AltFnddesc);
        //    ////        }

        //    ////        PdfPCell Trans = new PdfPCell(new Phrase("Transport", Times));
        //    ////        Trans.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////        Trans.FixedHeight = 15f;
        //    ////        Trans.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Trans);

        //    ////        if (!string.IsNullOrEmpty(chldMstDetails.Transport.Trim()))
        //    ////        {
        //    ////            string Trans_Desc = string.Empty;
        //    ////            List<CommonEntity> lookClsTransport = _model.lookupDataAccess.GetCMBTransport();
        //    ////            foreach (CommonEntity agyEntity in lookClsTransport)
        //    ////            {
        //    ////                if (chldMstDetails.Transport.ToString().Trim() == agyEntity.Code.ToString().Trim())
        //    ////                {
        //    ////                    Trans_Desc = agyEntity.Desc.ToString().Trim(); break;
        //    ////                }
        //    ////            }

        //    ////            if (!string.IsNullOrEmpty(Trans_Desc.Trim()))
        //    ////            {
        //    ////                PdfPCell AltFnddesc = new PdfPCell(new Phrase(Trans_Desc, Timesline));
        //    ////                AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////                AltFnddesc.FixedHeight = 15f;
        //    ////                AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////                MediaclTable.AddCell(AltFnddesc);
        //    ////            }
        //    ////            else
        //    ////            {
        //    ////                PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________", Times));
        //    ////                AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////                AltFnddesc.FixedHeight = 15f;
        //    ////                AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////                MediaclTable.AddCell(AltFnddesc);
        //    ////            }
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________", Times));
        //    ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            AltFnddesc.FixedHeight = 15f;
        //    ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(AltFnddesc);
        //    ////        }

        //    ////        PdfPCell Pick = new PdfPCell(new Phrase("Pickup", Times));
        //    ////        Pick.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Pick.FixedHeight = 15f;
        //    ////        Pick.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Pick);

        //    ////        if (!string.IsNullOrEmpty(chldMstDetails.PickOff.Trim()))
        //    ////        {
        //    ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase(chldMstDetails.PickOff.Trim(), Timesline));
        //    ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            AltFnddesc.FixedHeight = 15f;
        //    ////            AltFnddesc.Colspan = 3;
        //    ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(AltFnddesc);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            AltFnddesc.FixedHeight = 15f;
        //    ////            AltFnddesc.Colspan = 3;
        //    ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(AltFnddesc);
        //    ////        }

        //    ////        PdfPCell Drop = new PdfPCell(new Phrase("Dropoff", Times));
        //    ////        Drop.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Drop.FixedHeight = 15f;
        //    ////        Drop.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Drop);

        //    ////        if (!string.IsNullOrEmpty(chldMstDetails.DropOff.Trim()))
        //    ////        {
        //    ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase(chldMstDetails.DropOff.Trim(), Timesline));
        //    ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            AltFnddesc.FixedHeight = 15f;
        //    ////            AltFnddesc.Colspan = 3;
        //    ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(AltFnddesc);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            AltFnddesc.FixedHeight = 15f;
        //    ////            AltFnddesc.Colspan = 3;
        //    ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(AltFnddesc);
        //    ////        }

        //    ////        PdfPCell Last_Space = new PdfPCell(new Phrase("", Times));
        //    ////        Last_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Last_Space.Colspan = 4;
        //    ////        Last_Space.FixedHeight = 15f;
        //    ////        Last_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Last_Space);

        //    ////        PdfPCell Signature = new PdfPCell(new Phrase("Signature of Parent/Gurdian", Times));
        //    ////        Signature.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //Signature.FixedHeight = 15f;
        //    ////        Signature.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Signature);

        //    ////        PdfPCell SignatureLine = new PdfPCell(new Phrase("______________________________________", Times));
        //    ////        SignatureLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //SignatureLine.FixedHeight = 15f;
        //    ////        SignatureLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(SignatureLine);

        //    ////        PdfPCell Signature_Date = new PdfPCell(new Phrase("Date", Times));
        //    ////        Signature_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////        //DISABILITY_Space.Colspan = 2;
        //    ////        //Signature_Date.FixedHeight = 15f;
        //    ////        Signature_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Signature_Date);

        //    ////        PdfPCell Signature_Date_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////        Signature_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //Signature_Date_Line.FixedHeight = 15f;
        //    ////        Signature_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Signature_Date_Line);

        //    ////        PdfPCell Line_Last = new PdfPCell(new Phrase("", Times));
        //    ////        Line_Last.HorizontalAlignment = Element.ALIGN_CENTER;
        //    ////        Line_Last.Colspan = 6;
        //    ////        //Line_Last.FixedHeight = 15f;
        //    ////        Line_Last.BorderWidthBottom = 2f;
        //    ////        Line_Last.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
        //    ////        MediaclTable.AddCell(Line_Last);
        //    ////    }
        //    ////    else
        //    ////    {
        //    ////        PdfPCell ALLERGIES = new PdfPCell(new Phrase("My Child has the following ALLERGIES", Times));
        //    ////        ALLERGIES.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        ALLERGIES.FixedHeight = 15f;
        //    ////        ALLERGIES.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(ALLERGIES);

        //    ////        PdfPCell ALLERGIESLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        ALLERGIESLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        ALLERGIESLine.FixedHeight = 15f;
        //    ////        ALLERGIESLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(ALLERGIESLine);

        //    ////        PdfPCell ALLERGIES_Space = new PdfPCell(new Phrase("", Times));
        //    ////        ALLERGIES_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        ALLERGIES_Space.Colspan = 2;
        //    ////        ALLERGIES_Space.FixedHeight = 15f;
        //    ////        ALLERGIES_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(ALLERGIES_Space);

        //    ////        PdfPCell DISABILITY = new PdfPCell(new Phrase("Has been diagonosed with following DISABILITY", Times));
        //    ////        DISABILITY.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        DISABILITY.FixedHeight = 15f;
        //    ////        DISABILITY.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DISABILITY);

        //    ////        PdfPCell DISABILITYLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        DISABILITYLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        DISABILITYLine.FixedHeight = 15f;
        //    ////        DISABILITYLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DISABILITYLine);

        //    ////        PdfPCell DISABILITY_Date = new PdfPCell(new Phrase("Date", Times));
        //    ////        DISABILITY_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////        //DISABILITY_Space.Colspan = 2;
        //    ////        DISABILITY_Date.FixedHeight = 15f;
        //    ////        DISABILITY_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DISABILITY_Date);

        //    ////        PdfPCell DISABILITY_Date_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////        DISABILITY_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        DISABILITY_Date_Line.FixedHeight = 15f;
        //    ////        DISABILITY_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DISABILITY_Date_Line);

        //    ////        PdfPCell MEDICATIONS = new PdfPCell(new Phrase("is taking following MEDICATIONS", Times));
        //    ////        MEDICATIONS.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        MEDICATIONS.FixedHeight = 15f;
        //    ////        MEDICATIONS.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICATIONS);

        //    ////        PdfPCell MEDICATIONSLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        MEDICATIONSLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        MEDICATIONSLine.FixedHeight = 15f;
        //    ////        MEDICATIONSLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICATIONSLine);

        //    ////        PdfPCell MEDICATIONS_Space = new PdfPCell(new Phrase("", Times));
        //    ////        MEDICATIONS_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        MEDICATIONS_Space.Colspan = 2;
        //    ////        MEDICATIONS_Space.FixedHeight = 15f;
        //    ////        MEDICATIONS_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICATIONS_Space);

        //    ////        PdfPCell MEDICAL = new PdfPCell(new Phrase("has the following MEDICAL CONDITIONS", Times));
        //    ////        MEDICAL.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        MEDICAL.FixedHeight = 15f;
        //    ////        MEDICAL.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICAL);

        //    ////        PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        MEDICALLine.FixedHeight = 15f;
        //    ////        MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICALLine);

        //    ////        PdfPCell MEDICAL_Space = new PdfPCell(new Phrase("", Times));
        //    ////        MEDICAL_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        MEDICAL_Space.Colspan = 2;
        //    ////        MEDICAL_Space.FixedHeight = 15f;
        //    ////        MEDICAL_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICAL_Space);

        //    ////        PdfPCell Diet = new PdfPCell(new Phrase("DIETARY RESTRICTIONS", Times));
        //    ////        Diet.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Diet.FixedHeight = 15f;
        //    ////        Diet.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Diet);

        //    ////        PdfPCell DIETLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        DIETLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //DIETLine.Colspan = 2;
        //    ////        DIETLine.FixedHeight = 15f;
        //    ////        DIETLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DIETLine);

        //    ////        PdfPCell DIET_Space = new PdfPCell(new Phrase("", Times));
        //    ////        DIET_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        DIET_Space.Colspan = 2;
        //    ////        DIET_Space.FixedHeight = 15f;
        //    ////        DIET_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DIET_Space);

        //    ////        PdfPCell House = new PdfPCell(new Phrase("HOUSEHOLD CONCERNS ", Times));
        //    ////        House.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        House.FixedHeight = 15f;
        //    ////        House.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(House);

        //    ////        PdfPCell HOUSEHOLDLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        HOUSEHOLDLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //HOUSEHOLDLine.Colspan = 2;
        //    ////        HOUSEHOLDLine.FixedHeight = 15f;
        //    ////        HOUSEHOLDLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(HOUSEHOLDLine);

        //    ////        PdfPCell HOUSEHOLD_Space = new PdfPCell(new Phrase("", Times));
        //    ////        HOUSEHOLD_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        HOUSEHOLD_Space.Colspan = 2;
        //    ////        HOUSEHOLD_Space.FixedHeight = 15f;
        //    ////        HOUSEHOLD_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(HOUSEHOLD_Space);

        //    ////        PdfPCell Devp = new PdfPCell(new Phrase("DEVELOPMENTAL CONCERNS ", Times));
        //    ////        Devp.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Devp.FixedHeight = 15f;
        //    ////        Devp.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Devp);

        //    ////        PdfPCell DevpLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        DevpLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //DevpLine.Colspan = 2;
        //    ////        DevpLine.FixedHeight = 15f;
        //    ////        DevpLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DevpLine);

        //    ////        PdfPCell Devp_Space = new PdfPCell(new Phrase("", Times));
        //    ////        Devp_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Devp_Space.Colspan = 2;
        //    ////        Devp_Space.FixedHeight = 15f;
        //    ////        Devp_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Devp_Space);

        //    ////        PdfPCell AltFnd = new PdfPCell(new Phrase("Alternate Fund", Times));
        //    ////        AltFnd.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        AltFnd.FixedHeight = 15f;
        //    ////        AltFnd.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(AltFnd);

        //    ////        PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        AltFnddesc.FixedHeight = 15f;
        //    ////        AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(AltFnddesc);

        //    ////        PdfPCell Trans = new PdfPCell(new Phrase("Transport", Times));
        //    ////        Trans.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////        Trans.FixedHeight = 15f;
        //    ////        Trans.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Trans);


        //    ////        PdfPCell Trans_Space = new PdfPCell(new Phrase("_____________________", Times));
        //    ////        Trans_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Trans_Space.FixedHeight = 15f;
        //    ////        Trans_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Trans_Space);

        //    ////        PdfPCell Pick = new PdfPCell(new Phrase("Pickup", Times));
        //    ////        Pick.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Pick.FixedHeight = 15f;
        //    ////        Pick.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Pick);


        //    ////        PdfPCell PickSpace = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        PickSpace.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        PickSpace.FixedHeight = 15f;
        //    ////        PickSpace.Colspan = 3;
        //    ////        PickSpace.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(PickSpace);

        //    ////        PdfPCell Drop = new PdfPCell(new Phrase("Dropoff", Times));
        //    ////        Drop.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Drop.FixedHeight = 15f;
        //    ////        Drop.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Drop);


        //    ////        PdfPCell dropSpace = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        dropSpace.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        dropSpace.FixedHeight = 15f;
        //    ////        dropSpace.Colspan = 3;
        //    ////        dropSpace.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(dropSpace);

        //    ////        PdfPCell Last_Space = new PdfPCell(new Phrase("", Times));
        //    ////        Last_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Last_Space.Colspan = 4;
        //    ////        Last_Space.FixedHeight = 15f;
        //    ////        Last_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Last_Space);

        //    ////        PdfPCell Signature = new PdfPCell(new Phrase("Signature of Parent/Gurdian", Times));
        //    ////        Signature.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //Signature.FixedHeight = 15f;
        //    ////        Signature.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Signature);

        //    ////        PdfPCell SignatureLine = new PdfPCell(new Phrase("______________________________________", Times));
        //    ////        SignatureLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //SignatureLine.FixedHeight = 15f;
        //    ////        SignatureLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(SignatureLine);

        //    ////        PdfPCell Signature_Date = new PdfPCell(new Phrase("Date", Times));
        //    ////        Signature_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////        //DISABILITY_Space.Colspan = 2;
        //    ////        //Signature_Date.FixedHeight = 15f;
        //    ////        Signature_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Signature_Date);

        //    ////        PdfPCell Signature_Date_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////        Signature_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //Signature_Date_Line.FixedHeight = 15f;
        //    ////        Signature_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Signature_Date_Line);

        //    ////        PdfPCell Line_Last = new PdfPCell(new Phrase("", Times));
        //    ////        Line_Last.HorizontalAlignment = Element.ALIGN_CENTER;
        //    ////        Line_Last.Colspan = 6;
        //    ////        //Line_Last.FixedHeight = 15f;
        //    ////        Line_Last.BorderWidthBottom = 2f;
        //    ////        Line_Last.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
        //    ////        MediaclTable.AddCell(Line_Last);
        //    ////    }
        //    ////}
        //    ////else
        //    ////{
        //    ////    PdfPCell Chld_Med_Plan = new PdfPCell(new Phrase("Child Medical Insurance Plan", Times));
        //    ////    Chld_Med_Plan.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Med_Plan.FixedHeight = 15f;
        //    ////    Chld_Med_Plan.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Med_Plan);

        //    ////    PdfPCell Chld_Med_Plan_Line = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////    Chld_Med_Plan_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Med_Plan_Line.FixedHeight = 15f;
        //    ////    Chld_Med_Plan_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Med_Plan_Line);

        //    ////    PdfPCell Chld_Med_No = new PdfPCell(new Phrase("Medical Insurance Name", Times));
        //    ////    Chld_Med_No.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////    //Emer_Space.Colspan = 2;
        //    ////    Chld_Med_No.FixedHeight = 15f;
        //    ////    Chld_Med_No.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Med_No);


        //    ////    PdfPCell Chld_Med_No_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////    Chld_Med_No_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Med_No_Line.FixedHeight = 15f;
        //    ////    Chld_Med_No_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Med_No_Line);

        //    ////    PdfPCell Chld_Ins_Catg = new PdfPCell(new Phrase("Medical Insurance Category", Times));
        //    ////    Chld_Ins_Catg.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////    //Emer_Space.Colspan = 2;
        //    ////    Chld_Ins_Catg.FixedHeight = 15f;
        //    ////    Chld_Ins_Catg.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Ins_Catg);


        //    ////    PdfPCell Chld_Ins_Catg_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////    Chld_Ins_Catg_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Ins_Catg_Line.FixedHeight = 15f;
        //    ////    Chld_Ins_Catg_Line.Colspan = 3;
        //    ////    Chld_Ins_Catg_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Ins_Catg_Line);

        //    ////    PdfPCell Chld_Doctor = new PdfPCell(new Phrase("Child Doctor & Address", Times));
        //    ////    Chld_Doctor.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Doctor.FixedHeight = 15f;
        //    ////    Chld_Doctor.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Doctor);

        //    ////    PdfPCell Chld_Doctor_Line = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////    Chld_Doctor_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Doctor_Line.FixedHeight = 15f;
        //    ////    Chld_Doctor_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Doctor_Line);

        //    ////    PdfPCell Chld_Doc_Phone = new PdfPCell(new Phrase("Phone#", Times));
        //    ////    Chld_Doc_Phone.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////    //Emer_Space.Colspan = 2;
        //    ////    Chld_Doc_Phone.FixedHeight = 15f;
        //    ////    Chld_Doc_Phone.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Doc_Phone);


        //    ////    PdfPCell Chld_Doc_Phone_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////    Chld_Doc_Phone_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Doc_Phone_Line.FixedHeight = 15f;
        //    ////    Chld_Doc_Phone_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Doc_Phone_Line);

        //    ////    PdfPCell Emer_Space2 = new PdfPCell(new Phrase("", Times));
        //    ////    Emer_Space2.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Emer_Space2.Colspan = 4;
        //    ////    Emer_Space2.FixedHeight = 10f;
        //    ////    Emer_Space2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Emer_Space2);

        //    ////    PdfPCell Chld_Dent_Plan = new PdfPCell(new Phrase("Child Dental Insurance Plan", Times));
        //    ////    Chld_Dent_Plan.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Dent_Plan.FixedHeight = 15f;
        //    ////    Chld_Dent_Plan.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Dent_Plan);

        //    ////    PdfPCell Chld_Dent_Plan_Line = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////    Chld_Dent_Plan_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Dent_Plan_Line.FixedHeight = 15f;
        //    ////    Chld_Dent_Plan_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Dent_Plan_Line);

        //    ////    PdfPCell Chld_Dent_No = new PdfPCell(new Phrase("Dental Insurance Name", Times));
        //    ////    Chld_Dent_No.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////    //Emer_Space.Colspan = 2;
        //    ////    Chld_Dent_No.FixedHeight = 15f;
        //    ////    Chld_Dent_No.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Dent_No);

        //    ////    PdfPCell Chld_Dent_No_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////    Chld_Dent_No_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Dent_No_Line.FixedHeight = 15f;
        //    ////    Chld_Dent_No_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Dent_No_Line);

        //    ////    PdfPCell Chld_Dentist = new PdfPCell(new Phrase("Child Dentist & Address", Times));
        //    ////    Chld_Dentist.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Dentist.FixedHeight = 15f;
        //    ////    Chld_Dentist.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Dentist);

        //    ////    PdfPCell Chld_Dentist_Line = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////    Chld_Dentist_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Dentist_Line.FixedHeight = 15f;
        //    ////    Chld_Dentist_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Dentist_Line);

        //    ////    PdfPCell Chld_Dentist_Phone = new PdfPCell(new Phrase("Phone#", Times));
        //    ////    Chld_Dentist_Phone.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////    //Emer_Space.Colspan = 2;
        //    ////    Chld_Dentist_Phone.FixedHeight = 15f;
        //    ////    Chld_Dentist_Phone.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Dentist_Phone);

        //    ////    PdfPCell Chld_Dentist_Phone_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////    Chld_Dentist_Phone_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Chld_Dentist_Phone_Line.FixedHeight = 15f;
        //    ////    Chld_Dentist_Phone_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Chld_Dentist_Phone_Line);

        //    ////    PdfPCell Emer_Space3 = new PdfPCell(new Phrase("", Times));
        //    ////    Emer_Space3.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////    Emer_Space3.Colspan = 4;
        //    ////    Emer_Space3.FixedHeight = 10f;
        //    ////    Emer_Space3.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////    MediaclTable.AddCell(Emer_Space3);

        //    ////    if (caseconddet != null)
        //    ////    {
        //    ////        PdfPCell ALLERGIES = new PdfPCell(new Phrase("My Child has the following ALLERGIES", Times));
        //    ////        ALLERGIES.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        ALLERGIES.FixedHeight = 15f;
        //    ////        ALLERGIES.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(ALLERGIES);

        //    ////        if (!string.IsNullOrEmpty(caseconddet.Allergy.Trim()))
        //    ////        {
        //    ////            string Allergy_desc = caseconddet.Allergy.Replace("\r\n", " ");
        //    ////            PdfPCell ALLERGIESLine = new PdfPCell(new Phrase(Allergy_desc.Trim(), Times));
        //    ////            ALLERGIESLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            ALLERGIESLine.Colspan = 2;
        //    ////            ALLERGIESLine.FixedHeight = 15f;
        //    ////            ALLERGIESLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(ALLERGIESLine);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell ALLERGIESLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            ALLERGIESLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            ALLERGIESLine.Colspan = 2;
        //    ////            ALLERGIESLine.FixedHeight = 15f;
        //    ////            ALLERGIESLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(ALLERGIESLine);
        //    ////        }
        //    ////        PdfPCell ALLERGIES_Space = new PdfPCell(new Phrase("", Times));
        //    ////        ALLERGIES_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //ALLERGIES_Space.Colspan = 2;
        //    ////        ALLERGIES_Space.FixedHeight = 15f;
        //    ////        ALLERGIES_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(ALLERGIES_Space);

        //    ////        PdfPCell DISABILITY = new PdfPCell(new Phrase("Has been diagonosed with following DISABILITY", Times));
        //    ////        DISABILITY.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        DISABILITY.FixedHeight = 15f;
        //    ////        DISABILITY.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DISABILITY);

        //    ////        if (!string.IsNullOrEmpty(chldMstDetails.Disability.Trim()))
        //    ////        {
        //    ////            PdfPCell DISABILITYLine = new PdfPCell(new Phrase(chldMstDetails.DisabilityType.Trim(), Times));
        //    ////            DISABILITYLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            DISABILITYLine.FixedHeight = 15f;
        //    ////            DISABILITYLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(DISABILITYLine);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell DISABILITYLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            DISABILITYLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            DISABILITYLine.FixedHeight = 15f;
        //    ////            DISABILITYLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(DISABILITYLine);
        //    ////        }

        //    ////        PdfPCell DISABILITY_Date = new PdfPCell(new Phrase("Date", Times));
        //    ////        DISABILITY_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////        //DISABILITY_Space.Colspan = 2;
        //    ////        DISABILITY_Date.FixedHeight = 15f;
        //    ////        DISABILITY_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DISABILITY_Date);

        //    ////        if (!string.IsNullOrEmpty(chldMstDetails.DiagnosisDate.Trim()))
        //    ////        {
        //    ////            PdfPCell DISABILITY_Date_Line = new PdfPCell(new Phrase(LookupDataAccess.Getdate(chldMstDetails.DiagnosisDate.Trim()), Times));
        //    ////            DISABILITY_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            DISABILITY_Date_Line.FixedHeight = 15f;
        //    ////            DISABILITY_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(DISABILITY_Date_Line);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell DISABILITY_Date_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////            DISABILITY_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            DISABILITY_Date_Line.FixedHeight = 15f;
        //    ////            DISABILITY_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(DISABILITY_Date_Line);
        //    ////        }


        //    ////        PdfPCell MEDICATIONS = new PdfPCell(new Phrase("is taking following MEDICATIONS", Times));
        //    ////        MEDICATIONS.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        MEDICATIONS.FixedHeight = 15f;
        //    ////        MEDICATIONS.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICATIONS);

        //    ////        if (!string.IsNullOrEmpty(caseconddet.Medications.Trim()))
        //    ////        {
        //    ////            string Medications_desc = caseconddet.Medications.Replace("\r\n", " ");
        //    ////            PdfPCell MEDICATIONSLine = new PdfPCell(new Phrase(Medications_desc.Trim(), Times));
        //    ////            MEDICATIONSLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICATIONSLine.Colspan = 2;
        //    ////            MEDICATIONSLine.FixedHeight = 15f;
        //    ////            MEDICATIONSLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICATIONSLine);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell MEDICATIONSLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            MEDICATIONSLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICATIONSLine.Colspan = 2;
        //    ////            MEDICATIONSLine.FixedHeight = 15f;
        //    ////            MEDICATIONSLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICATIONSLine);
        //    ////        }

        //    ////        PdfPCell MEDICATIONS_Space = new PdfPCell(new Phrase("", Times));
        //    ////        MEDICATIONS_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //MEDICATIONS_Space.Colspan = 2;
        //    ////        MEDICATIONS_Space.FixedHeight = 15f;
        //    ////        MEDICATIONS_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICATIONS_Space);

        //    ////        PdfPCell MEDICAL = new PdfPCell(new Phrase("has the following MEDICAL CONDITIONS", Times));
        //    ////        MEDICAL.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        MEDICAL.FixedHeight = 15f;
        //    ////        MEDICAL.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICAL);

        //    ////        if (!string.IsNullOrEmpty(caseconddet.MedConds.Trim()))
        //    ////        {
        //    ////            string MedConds_desc = caseconddet.MedConds.Replace("\r\n", " ");
        //    ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase(MedConds_desc.Trim(), Times));
        //    ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICALLine.Colspan = 2;
        //    ////            MEDICALLine.FixedHeight = 15f;
        //    ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICALLine);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICALLine.Colspan = 2;
        //    ////            MEDICALLine.FixedHeight = 15f;
        //    ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICALLine);
        //    ////        }

        //    ////        PdfPCell MEDICAL_Space = new PdfPCell(new Phrase("", Times));
        //    ////        MEDICAL_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //MEDICAL_Space.Colspan = 2;
        //    ////        MEDICAL_Space.FixedHeight = 15f;
        //    ////        MEDICAL_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICAL_Space);

        //    ////        PdfPCell Diet = new PdfPCell(new Phrase("DIETARY RESTRICTIONS", Times));
        //    ////        Diet.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Diet.FixedHeight = 15f;
        //    ////        Diet.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Diet);

        //    ////        if (!string.IsNullOrEmpty(caseconddet.DietRestrct.Trim()))
        //    ////        {
        //    ////            string MedConds_desc = caseconddet.DietRestrct.Replace("\r\n", " ");
        //    ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase(MedConds_desc.Trim(), Times));
        //    ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICALLine.Colspan = 2;
        //    ////            MEDICALLine.FixedHeight = 15f;
        //    ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICALLine);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICALLine.Colspan = 2;
        //    ////            MEDICALLine.FixedHeight = 15f;
        //    ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICALLine);
        //    ////        }

        //    ////        PdfPCell DIET_Space = new PdfPCell(new Phrase("", Times));
        //    ////        DIET_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //MEDICAL_Space.Colspan = 2;
        //    ////        DIET_Space.FixedHeight = 15f;
        //    ////        DIET_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DIET_Space);

        //    ////        PdfPCell House = new PdfPCell(new Phrase("HOUSEHOLD CONCERNS ", Times));
        //    ////        House.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        House.FixedHeight = 15f;
        //    ////        House.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(House);

        //    ////        if (!string.IsNullOrEmpty(caseconddet.HHConcerns.Trim()))
        //    ////        {
        //    ////            string MedConds_desc = caseconddet.HHConcerns.Replace("\r\n", " ");
        //    ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase(MedConds_desc.Trim(), Times));
        //    ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICALLine.Colspan = 2;
        //    ////            MEDICALLine.FixedHeight = 15f;
        //    ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICALLine);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICALLine.Colspan = 2;
        //    ////            MEDICALLine.FixedHeight = 15f;
        //    ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICALLine);
        //    ////        }

        //    ////        PdfPCell HH_Space = new PdfPCell(new Phrase("", Times));
        //    ////        HH_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //MEDICAL_Space.Colspan = 2;
        //    ////        HH_Space.FixedHeight = 15f;
        //    ////        HH_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(HH_Space);

        //    ////        PdfPCell Devp = new PdfPCell(new Phrase("DEVELOPMENTAL CONCERNS ", Times));
        //    ////        Devp.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Devp.FixedHeight = 15f;
        //    ////        Devp.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Devp);

        //    ////        if (!string.IsNullOrEmpty(caseconddet.DevlConcerns.Trim()))
        //    ////        {
        //    ////            string MedConds_desc = caseconddet.DevlConcerns.Replace("\r\n", " ");
        //    ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase(MedConds_desc.Trim(), Times));
        //    ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICALLine.Colspan = 2;
        //    ////            MEDICALLine.FixedHeight = 15f;
        //    ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICALLine);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            MEDICALLine.Colspan = 2;
        //    ////            MEDICALLine.FixedHeight = 15f;
        //    ////            MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(MEDICALLine);
        //    ////        }

        //    ////        PdfPCell DEVL_Space = new PdfPCell(new Phrase("", Times));
        //    ////        DEVL_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //MEDICAL_Space.Colspan = 2;
        //    ////        DEVL_Space.FixedHeight = 15f;
        //    ////        DEVL_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DEVL_Space);

        //    ////        PdfPCell AltFnd = new PdfPCell(new Phrase("Alternate Fund", Times));
        //    ////        AltFnd.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        AltFnd.FixedHeight = 15f;
        //    ////        AltFnd.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(AltFnd);

        //    ////        if (!string.IsNullOrEmpty(chldMstDetails.AltFundSrc.Trim()))
        //    ////        {
        //    ////            string AltFund_Desc = string.Empty;
        //    ////            foreach (DataRow drFUND in dtFUND.Rows)
        //    ////            {
        //    ////                if (chldMstDetails.AltFundSrc.ToString().Trim() == drFUND["Code"].ToString().Trim())
        //    ////                {
        //    ////                    AltFund_Desc = drFUND["LookUpDesc"].ToString().Trim(); break;
        //    ////                }
        //    ////            }

        //    ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase(AltFund_Desc, Timesline));
        //    ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            AltFnddesc.FixedHeight = 15f;
        //    ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(AltFnddesc);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            AltFnddesc.FixedHeight = 15f;
        //    ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(AltFnddesc);
        //    ////        }

        //    ////        PdfPCell Trans = new PdfPCell(new Phrase("Transport", Times));
        //    ////        Trans.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////        Trans.FixedHeight = 15f;
        //    ////        Trans.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Trans);

        //    ////        if (!string.IsNullOrEmpty(chldMstDetails.Transport.Trim()))
        //    ////        {
        //    ////            string Trans_Desc = string.Empty;
        //    ////            List<CommonEntity> lookClsTransport = _model.lookupDataAccess.GetCMBTransport();
        //    ////            foreach (CommonEntity agyEntity in lookClsTransport)
        //    ////            {
        //    ////                if (chldMstDetails.Transport.ToString().Trim() == agyEntity.Code.ToString().Trim())
        //    ////                {
        //    ////                    Trans_Desc = agyEntity.Desc.ToString().Trim(); break;
        //    ////                }
        //    ////            }

        //    ////            if (!string.IsNullOrEmpty(Trans_Desc.Trim()))
        //    ////            {
        //    ////                PdfPCell AltFnddesc = new PdfPCell(new Phrase(Trans_Desc, Timesline));
        //    ////                AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////                AltFnddesc.FixedHeight = 15f;
        //    ////                AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////                MediaclTable.AddCell(AltFnddesc);
        //    ////            }
        //    ////            else
        //    ////            {
        //    ////                PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________", Times));
        //    ////                AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////                AltFnddesc.FixedHeight = 15f;
        //    ////                AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////                MediaclTable.AddCell(AltFnddesc);
        //    ////            }
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________", Times));
        //    ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            AltFnddesc.FixedHeight = 15f;
        //    ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(AltFnddesc);
        //    ////        }

        //    ////        PdfPCell Pick = new PdfPCell(new Phrase("Pickup", Times));
        //    ////        Pick.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Pick.FixedHeight = 15f;
        //    ////        Pick.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Pick);

        //    ////        if (!string.IsNullOrEmpty(chldMstDetails.PickOff.Trim()))
        //    ////        {
        //    ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase(chldMstDetails.PickOff.Trim(), Timesline));
        //    ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            AltFnddesc.FixedHeight = 15f;
        //    ////            AltFnddesc.Colspan = 3;
        //    ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(AltFnddesc);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            AltFnddesc.FixedHeight = 15f;
        //    ////            AltFnddesc.Colspan = 3;
        //    ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(AltFnddesc);
        //    ////        }

        //    ////        PdfPCell Drop = new PdfPCell(new Phrase("Dropoff", Times));
        //    ////        Drop.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Drop.FixedHeight = 15f;
        //    ////        Drop.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Drop);

        //    ////        if (!string.IsNullOrEmpty(chldMstDetails.DropOff.Trim()))
        //    ////        {
        //    ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase(chldMstDetails.DropOff.Trim(), Timesline));
        //    ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            AltFnddesc.FixedHeight = 15f;
        //    ////            AltFnddesc.Colspan = 3;
        //    ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(AltFnddesc);
        //    ////        }
        //    ////        else
        //    ////        {
        //    ////            PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////            AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////            AltFnddesc.FixedHeight = 15f;
        //    ////            AltFnddesc.Colspan = 3;
        //    ////            AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////            MediaclTable.AddCell(AltFnddesc);
        //    ////        }

        //    ////        PdfPCell Last_Space = new PdfPCell(new Phrase("", Times));
        //    ////        Last_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Last_Space.Colspan = 4;
        //    ////        Last_Space.FixedHeight = 15f;
        //    ////        Last_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Last_Space);

        //    ////        PdfPCell Signature = new PdfPCell(new Phrase("Signature of Parent/Gurdian", Times));
        //    ////        Signature.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //Signature.FixedHeight = 15f;
        //    ////        Signature.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Signature);

        //    ////        PdfPCell SignatureLine = new PdfPCell(new Phrase("______________________________________", Times));
        //    ////        SignatureLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //SignatureLine.FixedHeight = 15f;
        //    ////        SignatureLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(SignatureLine);

        //    ////        PdfPCell Signature_Date = new PdfPCell(new Phrase("Date", Times));
        //    ////        Signature_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////        //DISABILITY_Space.Colspan = 2;
        //    ////        //Signature_Date.FixedHeight = 15f;
        //    ////        Signature_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Signature_Date);

        //    ////        PdfPCell Signature_Date_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////        Signature_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //Signature_Date_Line.FixedHeight = 15f;
        //    ////        Signature_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Signature_Date_Line);

        //    ////        PdfPCell Line_Last = new PdfPCell(new Phrase("", Times));
        //    ////        Line_Last.HorizontalAlignment = Element.ALIGN_CENTER;
        //    ////        Line_Last.Colspan = 6;
        //    ////        //Line_Last.FixedHeight = 15f;
        //    ////        Line_Last.BorderWidthBottom = 2f;
        //    ////        Line_Last.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
        //    ////        MediaclTable.AddCell(Line_Last);
        //    ////    }
        //    ////    else
        //    ////    {
        //    ////        PdfPCell ALLERGIES = new PdfPCell(new Phrase("My Child has the following ALLERGIES", Times));
        //    ////        ALLERGIES.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        ALLERGIES.FixedHeight = 15f;
        //    ////        ALLERGIES.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(ALLERGIES);

        //    ////        PdfPCell ALLERGIESLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        ALLERGIESLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        ALLERGIESLine.FixedHeight = 15f;
        //    ////        ALLERGIESLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(ALLERGIESLine);

        //    ////        PdfPCell ALLERGIES_Space = new PdfPCell(new Phrase("", Times));
        //    ////        ALLERGIES_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        ALLERGIES_Space.Colspan = 2;
        //    ////        ALLERGIES_Space.FixedHeight = 15f;
        //    ////        ALLERGIES_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(ALLERGIES_Space);

        //    ////        PdfPCell DISABILITY = new PdfPCell(new Phrase("Has been diagonosed with following DISABILITY", Times));
        //    ////        DISABILITY.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        DISABILITY.FixedHeight = 15f;
        //    ////        DISABILITY.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DISABILITY);

        //    ////        PdfPCell DISABILITYLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        DISABILITYLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        DISABILITYLine.FixedHeight = 15f;
        //    ////        DISABILITYLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DISABILITYLine);

        //    ////        PdfPCell DISABILITY_Date = new PdfPCell(new Phrase("Date", Times));
        //    ////        DISABILITY_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////        //DISABILITY_Space.Colspan = 2;
        //    ////        DISABILITY_Date.FixedHeight = 15f;
        //    ////        DISABILITY_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DISABILITY_Date);

        //    ////        PdfPCell DISABILITY_Date_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////        DISABILITY_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        DISABILITY_Date_Line.FixedHeight = 15f;
        //    ////        DISABILITY_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DISABILITY_Date_Line);

        //    ////        PdfPCell MEDICATIONS = new PdfPCell(new Phrase("is taking following MEDICATIONS", Times));
        //    ////        MEDICATIONS.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        MEDICATIONS.FixedHeight = 15f;
        //    ////        MEDICATIONS.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICATIONS);

        //    ////        PdfPCell MEDICATIONSLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        MEDICATIONSLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        MEDICATIONSLine.FixedHeight = 15f;
        //    ////        MEDICATIONSLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICATIONSLine);

        //    ////        PdfPCell MEDICATIONS_Space = new PdfPCell(new Phrase("", Times));
        //    ////        MEDICATIONS_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        MEDICATIONS_Space.Colspan = 2;
        //    ////        MEDICATIONS_Space.FixedHeight = 15f;
        //    ////        MEDICATIONS_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICATIONS_Space);

        //    ////        PdfPCell MEDICAL = new PdfPCell(new Phrase("has the following MEDICAL CONDITIONS", Times));
        //    ////        MEDICAL.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        MEDICAL.FixedHeight = 15f;
        //    ////        MEDICAL.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICAL);

        //    ////        PdfPCell MEDICALLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        MEDICALLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        MEDICALLine.FixedHeight = 15f;
        //    ////        MEDICALLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICALLine);

        //    ////        PdfPCell MEDICAL_Space = new PdfPCell(new Phrase("", Times));
        //    ////        MEDICAL_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        MEDICAL_Space.Colspan = 2;
        //    ////        MEDICAL_Space.FixedHeight = 15f;
        //    ////        MEDICAL_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(MEDICAL_Space);

        //    ////        PdfPCell Diet = new PdfPCell(new Phrase("DIETARY RESTRICTIONS", Times));
        //    ////        Diet.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Diet.FixedHeight = 15f;
        //    ////        Diet.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Diet);

        //    ////        PdfPCell DIETLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        DIETLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //DIETLine.Colspan = 2;
        //    ////        DIETLine.FixedHeight = 15f;
        //    ////        DIETLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DIETLine);

        //    ////        PdfPCell DIET_Space = new PdfPCell(new Phrase("", Times));
        //    ////        DIET_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        DIET_Space.Colspan = 2;
        //    ////        DIET_Space.FixedHeight = 15f;
        //    ////        DIET_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DIET_Space);

        //    ////        PdfPCell House = new PdfPCell(new Phrase("HOUSEHOLD CONCERNS ", Times));
        //    ////        House.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        House.FixedHeight = 15f;
        //    ////        House.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(House);

        //    ////        PdfPCell HOUSEHOLDLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        HOUSEHOLDLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //HOUSEHOLDLine.Colspan = 2;
        //    ////        HOUSEHOLDLine.FixedHeight = 15f;
        //    ////        HOUSEHOLDLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(HOUSEHOLDLine);

        //    ////        PdfPCell HOUSEHOLD_Space = new PdfPCell(new Phrase("", Times));
        //    ////        HOUSEHOLD_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        HOUSEHOLD_Space.Colspan = 2;
        //    ////        HOUSEHOLD_Space.FixedHeight = 15f;
        //    ////        HOUSEHOLD_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(HOUSEHOLD_Space);

        //    ////        PdfPCell Devp = new PdfPCell(new Phrase("DEVELOPMENTAL CONCERNS ", Times));
        //    ////        Devp.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Devp.FixedHeight = 15f;
        //    ////        Devp.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Devp);

        //    ////        PdfPCell DevpLine = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        DevpLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //DevpLine.Colspan = 2;
        //    ////        DevpLine.FixedHeight = 15f;
        //    ////        DevpLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(DevpLine);

        //    ////        PdfPCell Devp_Space = new PdfPCell(new Phrase("", Times));
        //    ////        Devp_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Devp_Space.Colspan = 2;
        //    ////        Devp_Space.FixedHeight = 15f;
        //    ////        Devp_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Devp_Space);

        //    ////        PdfPCell AltFnd = new PdfPCell(new Phrase("Alternate Fund", Times));
        //    ////        AltFnd.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        AltFnd.FixedHeight = 15f;
        //    ////        AltFnd.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(AltFnd);

        //    ////        PdfPCell AltFnddesc = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        AltFnddesc.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        AltFnddesc.FixedHeight = 15f;
        //    ////        AltFnddesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(AltFnddesc);

        //    ////        PdfPCell Trans = new PdfPCell(new Phrase("Transport", Times));
        //    ////        Trans.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////        Trans.FixedHeight = 15f;
        //    ////        Trans.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Trans);


        //    ////        PdfPCell Trans_Space = new PdfPCell(new Phrase("_____________________", Times));
        //    ////        Trans_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Trans_Space.FixedHeight = 15f;
        //    ////        Trans_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Trans_Space);

        //    ////        PdfPCell Pick = new PdfPCell(new Phrase("Pickup", Times));
        //    ////        Pick.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Pick.FixedHeight = 15f;
        //    ////        Pick.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Pick);


        //    ////        PdfPCell PickSpace = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        PickSpace.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        PickSpace.FixedHeight = 15f;
        //    ////        PickSpace.Colspan = 3;
        //    ////        PickSpace.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(PickSpace);

        //    ////        PdfPCell Drop = new PdfPCell(new Phrase("Dropoff", Times));
        //    ////        Drop.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Drop.FixedHeight = 15f;
        //    ////        Drop.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Drop);


        //    ////        PdfPCell dropSpace = new PdfPCell(new Phrase("_____________________________________________", Times));
        //    ////        dropSpace.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        dropSpace.FixedHeight = 15f;
        //    ////        dropSpace.Colspan = 3;
        //    ////        dropSpace.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(dropSpace);

        //    ////        PdfPCell Last_Space = new PdfPCell(new Phrase("", Times));
        //    ////        Last_Space.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        Last_Space.Colspan = 4;
        //    ////        Last_Space.FixedHeight = 15f;
        //    ////        Last_Space.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Last_Space);

        //    ////        PdfPCell Signature = new PdfPCell(new Phrase("Signature of Parent/Gurdian", Times));
        //    ////        Signature.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //Signature.FixedHeight = 15f;
        //    ////        Signature.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Signature);

        //    ////        PdfPCell SignatureLine = new PdfPCell(new Phrase("______________________________________", Times));
        //    ////        SignatureLine.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //SignatureLine.FixedHeight = 15f;
        //    ////        SignatureLine.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(SignatureLine);

        //    ////        PdfPCell Signature_Date = new PdfPCell(new Phrase("Date", Times));
        //    ////        Signature_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    ////        //DISABILITY_Space.Colspan = 2;
        //    ////        //Signature_Date.FixedHeight = 15f;
        //    ////        Signature_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Signature_Date);

        //    ////        PdfPCell Signature_Date_Line = new PdfPCell(new Phrase("_____________________", Times));
        //    ////        Signature_Date_Line.HorizontalAlignment = Element.ALIGN_LEFT;
        //    ////        //Signature_Date_Line.FixedHeight = 15f;
        //    ////        Signature_Date_Line.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ////        MediaclTable.AddCell(Signature_Date_Line);

        //    ////        PdfPCell Line_Last = new PdfPCell(new Phrase("", Times));
        //    ////        Line_Last.HorizontalAlignment = Element.ALIGN_CENTER;
        //    ////        Line_Last.Colspan = 6;
        //    ////        //Line_Last.FixedHeight = 15f;
        //    ////        Line_Last.BorderWidthBottom = 2f;
        //    ////        Line_Last.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
        //    ////        MediaclTable.AddCell(Line_Last);
        //    ////    }
        //    ////}

        //    ////}
        //    ////document.Add(MediaclTable);
        //    //#endregion
        //    //}



        //}

        private void SetLine()
        {
            cb.SetLineWidth(2f);
            cb.SetLineCap(5);
            cb.MoveTo(X_Pos, Y_Pos);
            cb.LineTo(780, Y_Pos);
            cb.Stroke();
        }

        private string Get_Member_Name(string Mem_Seq, string NameFormat)
        {
            string Member_NAme = string.Empty;
            foreach (CaseSnpEntity drCaseSnp in casesnpList)
            {
                if (Mem_Seq == drCaseSnp.FamilySeq.Trim())
                {
                    if (NameFormat == "First")
                    {
                        Member_NAme = drCaseSnp.FamilySeq.Trim(); break;
                    }
                    else
                        Member_NAme = LookupDataAccess.GetMemberName(drCaseSnp.NameixFi.Trim(), drCaseSnp.NameixMi.Trim(), drCaseSnp.NameixLast.Trim(), "1") + "  "; break;
                }
            }

            return Member_NAme;
        }

        DataTable dtIncome = new DataTable();
        private string Get_IncomeType_Desc(string Type_Code)
        {
            string Income_Desc = string.Empty;
            foreach (DataRow drIncome in dtIncome.Rows)
            {
                if (Type_Code == drIncome["Code"].ToString().Trim())
                {
                    Income_Desc = drIncome["LookUpDesc"].ToString().Trim(); break;
                }
            }

            return Income_Desc;
        }

        #endregion

        //private void CaseSpmPdf(Document document)
        //{
        //    BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
        //    iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
        //    BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
        //    iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(1, 9, 4);
        //    BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

        //    iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
        //    iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
        //    iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
        //    iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(1, 9, 1);
        //    iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
        //    iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);

        //    PdfPTable SPMTable = new PdfPTable(5);
        //    SPMTable.TotalWidth = 550f;
        //    SPMTable.WidthPercentage = 100;
        //    SPMTable.LockedWidth = true;
        //    float[] widths2 = new float[] {15f, 70f, 40f, 35f, 20f };
        //    SPMTable.SetWidths(widths2);
        //    SPMTable.HorizontalAlignment = Element.ALIGN_CENTER;

        //    string ProgramName = string.Empty;
        //    if (programEntity != null)
        //        ProgramName = programEntity.AgencyName;

        //    PdfPCell H1 = new PdfPCell(new Phrase("Hierarchy:" + CASEMSTList[0].ApplAgency + "-" + CASEMSTList[0].ApplDept + "-" + CASEMSTList[0].ApplProgram+" "+ CASEMSTList[0].ApplYr+"  "+ProgramName, TblFontBold));
        //    H1.HorizontalAlignment = Element.ALIGN_LEFT;
        //    H1.Colspan = 2;
        //    H1.FixedHeight = 15f;
        //    H1.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    SPMTable.AddCell(H1);

        //    PdfPCell H2 = new PdfPCell(new Phrase("App:" + CASEMSTList[0].ApplNo + "  "+LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()) , TblFontBold));
        //    H2.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    H2.Colspan = 3;
        //    H2.FixedHeight = 15f;
        //    H2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    SPMTable.AddCell(H2);

        //    PdfPCell S2 = new PdfPCell(new Phrase("", TblFontBold));
        //    S2.HorizontalAlignment = Element.ALIGN_CENTER;
        //    S2.Colspan = 5;
        //    S2.FixedHeight = 15f;
        //    S2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    SPMTable.AddCell(S2);

        //    PdfPCell Header = new PdfPCell(new Phrase("Service Plans", TblFontBold));
        //    Header.HorizontalAlignment = Element.ALIGN_CENTER;
        //    Header.Colspan = 5;
        //    Header.FixedHeight = 15f;
        //    Header.Border = iTextSharp.text.Rectangle.BOX;
        //    SPMTable.AddCell(Header);

        //    string[] HeaderSeq = { "Code", "Description", "Site","CaseWorker","Start Date" };
        //    for (int i = 0; i < HeaderSeq.Length; ++i)
        //    {
        //        PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
        //        cell.HorizontalAlignment = Element.ALIGN_CENTER;
        //        //cell.FixedHeight = 15f;
        //        cell.Border = iTextSharp.text.Rectangle.BOX;
        //        SPMTable.AddCell(cell);
        //    }

        //    bool first = false;
        //    foreach (CASESPMEntity Entity in spmlist)
        //    {
        //        if (first)
        //        {
        //            PdfPCell Header1 = new PdfPCell(new Phrase("Service Plan", TblFontBold));
        //            Header1.HorizontalAlignment = Element.ALIGN_CENTER;
        //            Header1.Colspan = 5;
        //            Header1.FixedHeight = 15f;
        //            Header1.Border = iTextSharp.text.Rectangle.BOX;
        //            SPMTable.AddCell(Header1);

        //            string[] HeaderSeq1 = { "Code", "Description", "Site", "CaseWorker", "Start Date" };
        //            for (int i = 0; i < HeaderSeq1.Length; ++i)
        //            {
        //                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq1[i], TblFontBold));
        //                cell.HorizontalAlignment = Element.ALIGN_CENTER;
        //                //cell.FixedHeight = 15f;
        //                cell.Border = iTextSharp.text.Rectangle.BOX;
        //                SPMTable.AddCell(cell);
        //            }
        //        }


        //        PdfPCell A1 = new PdfPCell(new Phrase(Entity.service_plan, TableFont));
        //        A1.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A1.Border = iTextSharp.text.Rectangle.BOX;
        //        SPMTable.AddCell(A1);

        //        PdfPCell A2 = new PdfPCell(new Phrase(Entity.Sp0_Desc, TableFont));
        //        A2.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A2.Border = iTextSharp.text.Rectangle.BOX;
        //        SPMTable.AddCell(A2);

        //        PdfPCell A3 = new PdfPCell(new Phrase(Entity.Site_Desc, TableFont));
        //        A3.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A3.Border = iTextSharp.text.Rectangle.BOX;
        //        SPMTable.AddCell(A3);

        //        PdfPCell A4 = new PdfPCell(new Phrase(Get_CaseWorker_DESC(Entity.caseworker), TableFont));
        //        A4.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A4.Border = iTextSharp.text.Rectangle.BOX;
        //        SPMTable.AddCell(A4);

        //        PdfPCell A5 = new PdfPCell(new Phrase(LookupDataAccess.Getdate(Entity.startdate.Trim()), TableFont));
        //        A5.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A5.Border = iTextSharp.text.Rectangle.BOX;
        //        SPMTable.AddCell(A5);


        //        if (SPMTable.Rows.Count > 0)
        //        {
        //            document.Add(SPMTable);
        //            SPMTable.DeleteBodyRows();
        //        }
        //        if (actList.Count > 0)
        //        {
        //            SP_Programs_List = _model.lookupDataAccess.Get_SerPlan_Prog_List(BaseForm.UserProfile.UserID, Entity.service_plan);

        //            List<CASEACTEntity> SelActList = actList.FindAll(u => u.Service_plan.Equals(Entity.service_plan) && u.SPM_Seq.Equals(Entity.Seq));
        //            SelActList = SelActList.OrderBy(u => u.Service_plan).ThenBy(u => u.SPM_Seq).ThenBy(u => u.Branch).ThenBy(u => u.Group).ThenBy(u => u.ACT_Code).ToList();

        //            if (SelActList.Count > 0) CASEACTPdf(document, SelActList);

        //            List<CASEMSEntity> SelMSList = MSlist.FindAll(u => u.Service_plan.Equals(Entity.service_plan) && u.SPM_Seq.Equals(Entity.Seq));
        //            SelMSList = SelMSList.OrderBy(u => u.Service_plan).ThenBy(u => u.SPM_Seq).ThenBy(u => u.Branch).ThenBy(u => u.Group).ThenBy(u => u.MS_Code).ToList();

        //            if (SelMSList.Count > 0) CASEMSPdf(document, SelMSList);

        //            if (SelActList.Count > 0 || SelMSList.Count > 0)
        //            {
        //                first = true;
        //            }
        //            else first = false;
        //        }

        //    }

        //    document.Add(SPMTable);

        //}

        List<CASESP1Entity> SP_Hierarchies = new List<CASESP1Entity>();
        List<CASESP1Entity> Service_Hierarchies = new List<CASESP1Entity>();
        private void Fill_Sel_Hierarchy_SPs()
        {
            //if (ACR_SERV_Hies == "Y" || ACR_SERV_Hies == "S")
            //    Service_Hierarchies = _model.SPAdminData.CASESP1_SerPlans(null, null, null, null, BaseForm.UserID);

            if (BaseForm.BaseAgencyControlDetails.ServicePlanHiecontrol == "Y" || BaseForm.BaseAgencyControlDetails.ServicePlanHiecontrol == "S")
            {
                if (BaseForm.BaseAgencyControlDetails.SerPlanAllow.Trim() == "D")
                    Service_Hierarchies = _model.SPAdminData.CASESP1_SerPlans(null, BaseForm.BaseAgency, BaseForm.BaseDept, null, BaseForm.UserID);
                else
                    Service_Hierarchies = _model.SPAdminData.CASESP1_SerPlans(null, BaseForm.BaseAgency, null, null, BaseForm.UserID);
            }
            else
                SP_Hierarchies = _model.SPAdminData.Browse_CASESP1(null, BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg);
        }

        #region SPMPdf

        private void CaseSpmPdf()
        {
            Random_Filename = null;

            PdfName = "S" + BaseForm.BaseApplicationNo.ToString();//form.GetFileName();
            PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
            try
            {
                if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
            }
            catch (Exception ex)
            {
                CommonFunctions.MessageBoxDisplay("Error");
            }


            try
            {
                string Tmpstr = PdfName + ".pdf";
                if (File.Exists(Tmpstr))
                    File.Delete(Tmpstr);
            }
            catch (Exception ex)
            {
                int length = 8;
                string newFileName = System.Guid.NewGuid().ToString();
                newFileName = newFileName.Replace("-", string.Empty);

                Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
            }

            if (!string.IsNullOrEmpty(Random_Filename))
                PdfName = Random_Filename;
            else
                PdfName += ".pdf";

            FileStream fs = new FileStream(PdfName, FileMode.Create);

            Document document = new Document(PageSize.A4, 25, 25, 30, 30);
            PdfWriter writer = PdfWriter.GetInstance(document, fs);
            document.Open();

            cb = writer.DirectContent;

            BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
            iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
            BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
            iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(bf_times, 9, 4);
            BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

            iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
            //iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
            iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
            //iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(1, 9, 1);
            iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
            iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);


            BaseFont bf_Calibri = BaseFont.CreateFont("c:/windows/fonts/calibri.ttf", BaseFont.WINANSI, BaseFont.EMBEDDED);
            BaseFont bf_Times = BaseFont.CreateFont(BaseFont.TIMES_BOLD, BaseFont.CP1250, false);
            iTextSharp.text.Font fc = new iTextSharp.text.Font(bf_Calibri, 11, 2);
            iTextSharp.text.Font fc1 = new iTextSharp.text.Font(bf_Calibri, 10, 1, new BaseColor(System.Drawing.ColorTranslator.FromHtml("#6499c1")));
            iTextSharp.text.Font Sideheading = new iTextSharp.text.Font(bf_Calibri, 10, 1, new BaseColor(System.Drawing.ColorTranslator.FromHtml("#6499c1")));
            iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_Calibri, 10);
            iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(bf_Calibri, 10, 1, BaseColor.BLACK);
            iTextSharp.text.Font TblFontBold1 = new iTextSharp.text.Font(bf_Calibri, 10.01f, 1, BaseColor.BLACK);
            iTextSharp.text.Font TblFontBold2 = new iTextSharp.text.Font(bf_Calibri, 10.02f, 1, BaseColor.BLACK);
            iTextSharp.text.Font TblFontBold3 = new iTextSharp.text.Font(bf_Calibri, 10.03f, 1, BaseColor.BLACK);
            iTextSharp.text.Font TableFontRed = new iTextSharp.text.Font(bf_Calibri, 10, 0, BaseColor.RED);
            iTextSharp.text.Font TableFontYellow = new iTextSharp.text.Font(bf_Calibri, 10, 0, BaseColor.YELLOW);

            iTextSharp.text.Font TblFont = new iTextSharp.text.Font(bf_Times, 8);
            iTextSharp.text.Font SerOutFont = new iTextSharp.text.Font(bf_Calibri, 11, 1, new BaseColor(System.Drawing.ColorTranslator.FromHtml("#6499c1")));


            //PdfPTable SPMTable = new PdfPTable(5);
            //SPMTable.TotalWidth = 550f;
            //SPMTable.WidthPercentage = 100;
            //SPMTable.LockedWidth = true;
            //float[] widths2 = new float[] { 15f, 70f, 40f, 35f, 20f };
            //SPMTable.SetWidths(widths2);
            //SPMTable.HorizontalAlignment = Element.ALIGN_CENTER;

            //string ProgramName = string.Empty;
            //if (programEntity != null)
            //    ProgramName = programEntity.HirarchyName;

            //PdfPCell H1 = new PdfPCell(new Phrase("Hierarchy:" + CASEMSTList[0].ApplAgency + "-" + CASEMSTList[0].ApplDept + "-" + CASEMSTList[0].ApplProgram + " " + CASEMSTList[0].ApplYr + "  " + ProgramName, TblFontBold));
            //H1.HorizontalAlignment = Element.ALIGN_LEFT;
            //H1.Colspan = 2;
            //H1.FixedHeight = 15f;
            //H1.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //SPMTable.AddCell(H1);

            //PdfPCell H2 = new PdfPCell(new Phrase("App:" + CASEMSTList[0].ApplNo + "  " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), TblFontBold));
            //H2.HorizontalAlignment = Element.ALIGN_RIGHT;
            //H2.Colspan = 3;
            //H2.FixedHeight = 15f;
            //H2.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //SPMTable.AddCell(H2);

            //PdfPCell S2 = new PdfPCell(new Phrase("", TblFontBold));
            //S2.HorizontalAlignment = Element.ALIGN_CENTER;
            //S2.Colspan = 5;
            //S2.FixedHeight = 15f;
            //S2.Border = iTextSharp.text.Rectangle.NO_BORDER;
            //SPMTable.AddCell(S2);

            //PdfPCell Header = new PdfPCell(new Phrase("Service Plans", TblFontBold));
            //Header.HorizontalAlignment = Element.ALIGN_CENTER;
            //Header.Colspan = 5;
            //Header.FixedHeight = 15f;
            //Header.Border = iTextSharp.text.Rectangle.BOX;
            //SPMTable.AddCell(Header);


            /******************************* Head  1 ********************************************/
            PdfPTable Header = new PdfPTable(2);
            Header.TotalWidth = 510f;
            Header.WidthPercentage = 100;
            Header.LockedWidth = true;
            float[] Headerwidths = new float[] { 50f, 17f };
            Header.SetWidths(Headerwidths);
            Header.HorizontalAlignment = Element.ALIGN_CENTER;
            Header.SpacingAfter = 07f;

            PdfPCell AppName = new PdfPCell(new Phrase("Applicant Name: " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), fc1));
            AppName.HorizontalAlignment = Element.ALIGN_LEFT;
            AppName.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Header.AddCell(AppName);

            PdfPCell Application = new PdfPCell(new Phrase("App#: " + CASEMSTList[0].ApplNo, fc1));
            Application.HorizontalAlignment = Element.ALIGN_RIGHT;
            Application.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Header.AddCell(Application);

            PdfPCell hIER = new PdfPCell(new Phrase("Intake Hierarchy: " + CASEMSTList[0].ApplAgency + "-" + CASEMSTList[0].ApplDept + "-" + CASEMSTList[0].ApplProgram + " " + CASEMSTList[0].ApplYr + "  " + ProgramName, fc1));
            hIER.HorizontalAlignment = Element.ALIGN_RIGHT;
            hIER.Border = iTextSharp.text.Rectangle.NO_BORDER;
            hIER.Colspan = 2;
            Header.AddCell(hIER);

            /***************************************************************************/


            PdfPTable topTable = new PdfPTable(4);
            topTable.TotalWidth = 510f;
            topTable.WidthPercentage = 100;
            topTable.LockedWidth = true;
            float[] widths1 = new float[] { 100f, 10f, 110f, 60f };
            topTable.SetWidths(widths1);
            topTable.HorizontalAlignment = Element.ALIGN_CENTER;

            PdfPTable table = new PdfPTable(4);
            table.TotalWidth = 515f;
            table.WidthPercentage = 100;
            table.LockedWidth = true;
            float[] widths = new float[] { 50f, 25f, 25f, 90f };
            table.SetWidths(widths);
            table.HorizontalAlignment = Element.ALIGN_CENTER;

            string Year = null;
            if (!string.IsNullOrEmpty(BaseForm.BaseYear.Trim()))
                Year = BaseForm.BaseYear;

            int X_Pos, Y_Pos;

            DataSet dsSP_CaseSP2 = new DataSet(); DataTable dtSP_CaseSP2 = new DataTable();
            string CAMSDesc = null; string CaDate = null; string CaDate_Follow_on = null;
            string SerVicePlan = null, Priv_ServicePlan = null; string SP_Desc = null;
            bool First = true; string Desc = null; string Branch = null, Priv_Branch = null, SP_Plan_desc = null;

            string Vendorname = null, Source = null, BillingName = null, Account = null, BenefitReason = null, SupApproval = null, PrePayApproval = null, SentForPay = null, BillPeriod = null,
            Fund1 = null, Fund2 = null, Fund3 = null, Budget = null,
            UOM1 = null, UOM2 = null, UOM3 = null,
            Amt1 = null, Amt2 = null, Amt3 = null, Cost = null, ArrearAmt = null, Total = null, Unit = null, Rate = null,
            Bundle = null, Payment = null, Check = null, by = null,
            Site = null, CaseWorker = null, Program = null,
            CheckDte = null, CompleteDte = null, ServiceReqDte = null, Date1 = null, Date2 = null, DateOn = null;
            string Service_desc = null;
            string CAMSType = null; string Priv_Cams_Desc = null;
            string PrivSource = string.Empty;

            if (spmlist.Count > 0)
            {
                if (BaseForm.BaseAgencyControlDetails.ServicePlanHiecontrol == "Y")
                {
                    List<CASESPMEntity> SPM_list = new List<CASESPMEntity>();
                    if (Service_Hierarchies.Count > 0)
                    {
                        foreach (CASESP1Entity SP1 in Service_Hierarchies)
                        {
                            List<CASESPMEntity> SPMEntity = spmlist.FindAll(u => u.service_plan.Trim() == SP1.Code.Trim());
                            if (SPMEntity.Count > 0)
                                SPM_list.AddRange(SPMEntity);
                        }
                    }
                    if (SPM_list.Count > 0) spmlist = SPM_list;
                }

                bool isFirstRecord = true;
                bool isCAFirstRecord = true;




                foreach (CASESPMEntity Entity in spmlist)
                {
                    CASEACTEntity Search_Enty = new CASEACTEntity(true);
                    Search_Enty.Agency = BaseForm.BaseAgency;
                    Search_Enty.Dept = BaseForm.BaseDept;
                    Search_Enty.Program = BaseForm.BaseProg;
                    Search_Enty.Year = Entity.year;                             // Year will be always Four-Spaces in CASEACT
                    Search_Enty.App_no = BaseForm.BaseApplicationNo;
                    Search_Enty.SPM_Seq = Entity.Seq;
                    Search_Enty.Service_plan = Entity.service_plan;

                    List<CASEACTEntity> SP_Activity_Details = _model.SPAdminData.Browse_CASEACT(Search_Enty, "Browse", "PAYMENT");
                    SP_Activity_Details = SP_Activity_Details.OrderByDescending(u => Convert.ToDateTime(u.ACT_Date.Trim())).ToList();

                    CASEMSEntity Search_EntyMS = new CASEMSEntity(true);
                    Search_EntyMS.Agency = BaseForm.BaseAgency;
                    Search_EntyMS.Dept = BaseForm.BaseDept;
                    Search_EntyMS.Program = BaseForm.BaseProg;
                    Search_EntyMS.Year = Entity.year;                              // Year will be always Four-Spaces in CASEMS
                    Search_EntyMS.App_no = BaseForm.BaseApplicationNo;
                    Search_EntyMS.SPM_Seq = Entity.Seq;
                    Search_EntyMS.Service_plan = Entity.service_plan;

                    List<CASEMSEntity> SP_MS_Details = _model.SPAdminData.Browse_CASEMS(Search_EntyMS, "Browse");
                    SP_MS_Details = SP_MS_Details.OrderByDescending(u => Convert.ToDateTime(u.Date.Trim())).ToList();

                    SerVicePlan = Entity.service_plan.ToString().Trim();
                    string Branch_SPM = Entity.sel_branches.ToString().Trim();
                    int length = Entity.sel_branches.Length;
                    DataSet dsSP_Services = DatabaseLayer.SPAdminDB.Browse_CASESP0(SerVicePlan, null, null, null, null, null, null, null, null);
                    DataRow drSP_Services = dsSP_Services.Tables[0].Rows[0];
                    SP_Desc = drSP_Services["sp0_description"].ToString().Trim();

                    //if (SPGrid.Rows.Count > 0)
                    SP_Programs_List = _model.lookupDataAccess.Get_SerPlan_Prog_List(BaseForm.UserProfile.UserID, SerVicePlan, BaseForm.BaseAgencyControlDetails.ServicePlanHiecontrol);


                    //if (SP_Activity_Details.Count > 0 || SP_MS_Details.Count > 0)
                    //{
                    for (int i = 0; i < length;)
                    {
                        // Dataset Caseactdetails = DatabaseLayer.SPAdminDB.Browse_CASEACT();
                        string Temp_Branch = Entity.sel_branches.Substring(i, 1);
                        dsSP_CaseSP2 = DatabaseLayer.SPAdminDB.Browse_CASESP2(SerVicePlan, Temp_Branch, null, null);
                        dtSP_CaseSP2 = dsSP_CaseSP2.Tables[0];

                        Priv_Branch = null; bool isoutcome = false;

                        if (dtSP_CaseSP2.Rows.Count > 0)
                        {
                            DataView dv = dtSP_CaseSP2.DefaultView;
                            dv.Sort = "sp2_branch DESC, sp2_type";
                            dtSP_CaseSP2 = dv.ToTable();

                            //**** SP Loop Startss ***///

                            foreach (DataRow dr in dtSP_CaseSP2.Rows)
                            {
                                CaDate = null; CaDate_Follow_on = null;
                                Branch = dr["sp2_branch"].ToString().Trim();
                                CAMSType = dr["sp2_type"].ToString();


                                /**************************************** HEADER ******************************************/

                                if (SerVicePlan == dr["sp2_serviceplan"].ToString() && Branch != Priv_Branch)
                                {

                                    isFirstRecord = true;
                                    isCAFirstRecord = true;

                                    if (table.Rows.Count > 0)
                                    {
                                        document.Add(Header);
                                        document.Add(topTable);
                                        document.Add(table);

                                        table.DeleteBodyRows();
                                        topTable.DeleteBodyRows();
                                    }


                                    if (!First)
                                        document.NewPage();
                                    Service_desc = drSP_Services["sp0_pbranch_desc"].ToString();
                                    if (!First)
                                    {
                                        if (Branch.Trim() == drSP_Services["sp0_branch1_code"].ToString().Trim())
                                            Service_desc = drSP_Services["sp0_branch1_desc"].ToString();
                                        else if (Branch.Trim() == drSP_Services["sp0_branch2_code"].ToString().Trim())
                                            Service_desc = drSP_Services["sp0_branch2_desc"].ToString();
                                        else if (Branch.Trim() == drSP_Services["sp0_branch3_code"].ToString().Trim())
                                            Service_desc = drSP_Services["sp0_branch3_desc"].ToString();
                                        else if (Branch.Trim() == drSP_Services["sp0_branch4_code"].ToString().Trim())
                                            Service_desc = drSP_Services["sp0_branch4_desc"].ToString();
                                        else if (Branch.Trim() == drSP_Services["sp0_branch5_code"].ToString().Trim())
                                            Service_desc = drSP_Services["sp0_branch5_desc"].ToString();
                                    }

                                    if (isFirstRecord)
                                    {
                                        PdfPCell SP_Desc_Header = new PdfPCell(new Phrase("Service Plan: " + SP_Desc.Trim(), fc1));
                                        SP_Desc_Header.HorizontalAlignment = Element.ALIGN_CENTER;
                                        SP_Desc_Header.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        SP_Desc_Header.Colspan = 4;
                                        topTable.AddCell(SP_Desc_Header);

                                        PdfPCell topboarder = new PdfPCell(new Phrase("", TblFontBold));
                                        topboarder.HorizontalAlignment = Element.ALIGN_LEFT;
                                        topboarder.Colspan = 4;
                                        topboarder.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                        topTable.AddCell(topboarder);

                                        PdfPCell SiteDesc = new PdfPCell(new Phrase("Site: " + Entity.Site_Desc, fc1));
                                        SiteDesc.HorizontalAlignment = Element.ALIGN_LEFT;
                                        SiteDesc.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                                        topTable.AddCell(SiteDesc);

                                        PdfPCell CaseWorkerDesc = new PdfPCell(new Phrase("Case Worker: " + Get_CaseWorker_DESC(Entity.caseworker), fc1));
                                        CaseWorkerDesc.HorizontalAlignment = Element.ALIGN_LEFT;
                                        CaseWorkerDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        CaseWorkerDesc.Colspan = 2;
                                        topTable.AddCell(CaseWorkerDesc);

                                        PdfPCell SP_Desc_Date = new PdfPCell(new Phrase("Start Date: " + LookupDataAccess.Getdate(Entity.startdate.Trim()), fc1));
                                        SP_Desc_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
                                        SP_Desc_Date.Border = iTextSharp.text.Rectangle.RIGHT_BORDER;
                                        topTable.AddCell(SP_Desc_Date);

                                        PdfPCell bottomboarder = new PdfPCell(new Phrase("", TblFontBold));
                                        bottomboarder.HorizontalAlignment = Element.ALIGN_LEFT;
                                        bottomboarder.Colspan = 4;
                                        bottomboarder.Border = iTextSharp.text.Rectangle.TOP_BORDER;
                                        topTable.AddCell(bottomboarder);

                                        PdfPCell ServiceDesc = new PdfPCell(new Phrase("", TblFontBold));
                                        ServiceDesc.HorizontalAlignment = Element.ALIGN_CENTER;
                                        ServiceDesc.Colspan = 4;
                                        ServiceDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        topTable.AddCell(ServiceDesc);

                                        ServiceDesc = new PdfPCell(new Phrase("Branch: " + Service_desc.Trim(), TblFontBold));
                                        ServiceDesc.HorizontalAlignment = Element.ALIGN_CENTER;
                                        ServiceDesc.Colspan = 4;
                                        ServiceDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(ServiceDesc);

                                        PdfPCell ServicesHeader = new PdfPCell(new Phrase("", fc1));
                                        ServicesHeader.HorizontalAlignment = Element.ALIGN_CENTER;
                                        ServicesHeader.Colspan = 4;
                                        ServicesHeader.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(ServicesHeader);

                                        isFirstRecord = false;
                                        isoutcome = true;
                                    }

                                    Priv_Branch = Branch; SerVicePlan = dr["sp2_serviceplan"].ToString();
                                }

                                /******************************************************************************************/


                                /********************************
                                    /// Services Printing Code//////
                                    **********************************/
                                if (CAMSType == "CA")
                                {

                                    if (isCAFirstRecord)
                                    {
                                        PdfPCell ServicesHeader1 = new PdfPCell(new Phrase("Services", SerOutFont));
                                        ServicesHeader1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        ServicesHeader1.Colspan = 4;
                                        ServicesHeader1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(ServicesHeader1);

                                        isCAFirstRecord = false;
                                    }


                                    //string Priv_Cams_Desc = null;
                                    DataSet dsCAMAST = DatabaseLayer.SPAdminDB.Browse_CAMAST(null, dr["sp2_cams_code"].ToString().Trim(), null, null);

                                    if (dsCAMAST.Tables[0].Rows.Count > 0)
                                    {
                                        DataRow drCAMAST = dsCAMAST.Tables[0].Rows[0];
                                        CAMSDesc = drCAMAST["CA_DESC"].ToString().Trim();


                                        List<CASEACTEntity> SelService = SP_Activity_Details.FindAll(u => u.ACT_Code.Trim() == dr["sp2_cams_code"].ToString().Trim());

                                        if (SelService.Count > 0)
                                        {
                                            PdfPCell ServicesDesc = new PdfPCell(new Phrase("Service: ", Sideheading));
                                            ServicesDesc.HorizontalAlignment = Element.ALIGN_LEFT; ServicesDesc.FixedHeight = 20f;
                                            ServicesDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(ServicesDesc);

                                            PdfPCell RowDesc = new PdfPCell(new Phrase(CAMSDesc.Trim(), TblFontBold));
                                            RowDesc.HorizontalAlignment = Element.ALIGN_LEFT;
                                            RowDesc.Colspan = 3; RowDesc.FixedHeight = 20f;
                                            RowDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(RowDesc);

                                            //Header for Service plan
                                            if (CategoryCode == "01" || CategoryCode == "02" || CategoryCode == "03" || CategoryCode == "04")
                                            {
                                                PdfPCell VendorCol = new PdfPCell(new Phrase("Vendor", TblFontBold));
                                                VendorCol.HorizontalAlignment = Element.ALIGN_LEFT;
                                                VendorCol.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                VendorCol.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                VendorCol.BorderWidthBottom = 0.7f;
                                                table.AddCell(VendorCol);

                                                PdfPCell ServiceDate = new PdfPCell(new Phrase("Service Date", TblFontBold));
                                                ServiceDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                ServiceDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                ServiceDate.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                ServiceDate.BorderWidthBottom = 0.7f;
                                                table.AddCell(ServiceDate);

                                                PdfPCell FollowUpDate = new PdfPCell(new Phrase("Follow-Up On", TblFontBold));
                                                FollowUpDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                FollowUpDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                FollowUpDate.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                FollowUpDate.BorderWidthBottom = 0.7f;
                                                table.AddCell(FollowUpDate);

                                                PdfPCell ServiceDetails = new PdfPCell(new Phrase("Service Details", TblFontBold));
                                                ServiceDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                ServiceDetails.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                ServiceDetails.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                ServiceDetails.BorderWidthBottom = 0.7f;
                                                table.AddCell(ServiceDetails);
                                                Priv_Branch = Branch;
                                                First = false;
                                            }
                                            else
                                            {
                                                PdfPCell ServiceDate = new PdfPCell(new Phrase("Service Date", TblFontBold));
                                                ServiceDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                ServiceDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                ServiceDate.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                ServiceDate.BorderWidthBottom = 0.7f;
                                                table.AddCell(ServiceDate);

                                                PdfPCell FollowUpDate = new PdfPCell(new Phrase("Follow-Up On", TblFontBold));
                                                FollowUpDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                FollowUpDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                FollowUpDate.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                FollowUpDate.BorderWidthBottom = 0.7f;
                                                table.AddCell(FollowUpDate);

                                                PdfPCell ServiceDetails = new PdfPCell(new Phrase("Service Details", TblFontBold));
                                                ServiceDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                ServiceDetails.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                ServiceDetails.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                ServiceDetails.BorderWidthBottom = 0.7f;
                                                ServiceDetails.Colspan = 2;
                                                table.AddCell(ServiceDetails);
                                                Priv_Branch = Branch;
                                                First = false;
                                            }

                                            if (SelService.Count > 0)
                                            {
                                                foreach (CASEACTEntity entity in SelService)
                                                {
                                                    Phrase phrase = new Phrase();
                                                    Phrase phraseCat4 = new Phrase();
                                                    PdfPTable servDetails = new PdfPTable(2);
                                                    Phrase completedate = new Phrase();
                                                    string strType = CommonFunctions.FollowupIndicatior(entity.Followup_On);
                                                    //Category 1 Service Details  
                                                    if (CategoryCode == "01")
                                                    {
                                                        Vendorname = Get_Vendor_Name(entity.Vendor_No);

                                                        CaDate = LookupDataAccess.Getdate(entity.ACT_Date).ToString();

                                                        if (entity.Followup_Comp != "")
                                                        {
                                                            CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                            completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                        }
                                                        else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "R")
                                                        {
                                                            CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                            completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                            completedate.Add(new Chunk("!", TableFontRed));
                                                        }
                                                        else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "Y")
                                                        {
                                                            CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                            completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                            completedate.Add(new Chunk("!", TableFontYellow));
                                                        }

                                                        servDetails.TotalWidth = 240f;
                                                        servDetails.WidthPercentage = 100;
                                                        servDetails.LockedWidth = true;
                                                        float[] serwidths = new float[] { 90f, 150f };
                                                        servDetails.SetWidths(serwidths);
                                                        servDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        servDetails.SpacingAfter = 07f;

                                                        //if (entity.ActSeek_Date != "")
                                                        //{
                                                        ServiceReqDte = "Service Requested Date: " + LookupDataAccess.Getdate(entity.ActSeek_Date).ToString();// + ", ";
                                                                                                                                                              //phrase.Add(new Chunk(ServiceReqDte, TableFont));
                                                                                                                                                              //}
                                                        PdfPCell ServReqDte = new PdfPCell(new Phrase(ServiceReqDte, TableFont));
                                                        ServReqDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        ServReqDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        ServReqDte.Colspan = 2;
                                                        servDetails.AddCell(ServReqDte);

                                                        CaseWorker = "Case Worker: " + GetWorkerName(entity.Caseworker);// + ", ";
                                                                                                                        //if (!string.IsNullOrEmpty(entity.Caseworker.Trim()))
                                                                                                                        // phrase.Add(new Chunk(CaseWorker, TableFont));
                                                        PdfPCell caseWorker = new PdfPCell(new Phrase(CaseWorker, TableFont));
                                                        caseWorker.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        caseWorker.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        caseWorker.Colspan = 2;
                                                        servDetails.AddCell(caseWorker);

                                                        Site = "Site: " + GetSiteName(entity.Site);// + ", ";
                                                                                                   //if (!string.IsNullOrEmpty(entity.Site.Trim()))
                                                                                                   // phrase.Add(new Chunk(Site, TableFont));
                                                        PdfPCell site = new PdfPCell(new Phrase(Site, TableFont));
                                                        site.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        site.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        site.Colspan = 2;
                                                        servDetails.AddCell(site);

                                                        Fund1 = "Fund: " + GetFundName(entity.Fund1);// + ", ";
                                                                                                     //if (!string.IsNullOrEmpty(entity.Fund1.Trim()))
                                                                                                     //{
                                                                                                     //phrase.Add(new Chunk(Fund1, TableFont));
                                                                                                     //}
                                                        PdfPCell fund1 = new PdfPCell(new Phrase(Fund1, TableFont));
                                                        fund1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        fund1.Colspan = 2;
                                                        servDetails.AddCell(fund1);

                                                        Fund2 = "Fund 2: " + GetFundName(entity.Fund2);// + ", ";
                                                                                                       //if (!string.IsNullOrEmpty(entity.Fund2.Trim()))
                                                                                                       //{
                                                                                                       //phrase.Add(new Chunk(Fund2, TableFont));
                                                                                                       //}
                                                        PdfPCell fund2 = new PdfPCell(new Phrase(Fund2, TableFont));
                                                        fund2.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        fund2.Colspan = 2;
                                                        servDetails.AddCell(fund2);

                                                        Fund3 = "Fund 3: " + GetFundName(entity.Fund3);// + ", ";
                                                                                                       //if (!string.IsNullOrEmpty(entity.Fund3.Trim()))
                                                                                                       //{
                                                                                                       //    phrase.Add(new Chunk(Fund3, TableFont));
                                                                                                       //}
                                                        PdfPCell fund3 = new PdfPCell(new Phrase(Fund3, TableFont));
                                                        fund3.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        fund3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        fund3.Colspan = 2;
                                                        servDetails.AddCell(fund3);

                                                        UOM1 = "UOM: " + GetUOMName(entity.UOM);// + ", ";
                                                                                                //if (!string.IsNullOrEmpty(entity.UOM.Trim()))
                                                                                                //{
                                                                                                //    phrase.Add(new Chunk(UOM1, TableFont));
                                                                                                //}
                                                        PdfPCell uom1 = new PdfPCell(new Phrase(UOM1, TableFont));
                                                        uom1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        uom1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        uom1.Colspan = 2;
                                                        servDetails.AddCell(uom1);

                                                        Unit = "# of Units: " + entity.Units;// + ", ";
                                                                                             //if (!string.IsNullOrEmpty(entity.Units.Trim()))
                                                                                             //{
                                                                                             //    phrase.Add(new Chunk(Unit, TableFont));
                                                                                             //}
                                                        PdfPCell unit = new PdfPCell(new Phrase(Unit, TableFont));
                                                        unit.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        unit.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        unit.Colspan = 2;
                                                        servDetails.AddCell(unit);

                                                        Amt1 = "Amount: " + entity.Amount;// + ", ";
                                                                                          //if (!string.IsNullOrEmpty(entity.Amount.Trim()))
                                                                                          //{
                                                                                          //    phrase.Add(new Chunk(Amt1, TableFont));
                                                                                          //}
                                                        PdfPCell amt1 = new PdfPCell(new Phrase(Amt1, TableFont));
                                                        amt1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        amt1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        amt1.Colspan = 2;
                                                        servDetails.AddCell(amt1);

                                                        Rate = "Rate: " + entity.Rate;// + ", ";
                                                                                      //if (!string.IsNullOrEmpty(entity.Rate.Trim()))
                                                                                      //{
                                                                                      //    phrase.Add(new Chunk(Rate, TableFont));
                                                                                      //}
                                                        PdfPCell rate = new PdfPCell(new Phrase(Rate, TableFont));
                                                        rate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        rate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        rate.Colspan = 2;
                                                        servDetails.AddCell(rate);

                                                        //if (entity.Check_No != "")
                                                        //{
                                                        Check = "Check#: " + ("0000000000".Substring(0, 10 - entity.Check_No.Trim().Length) + entity.Check_No.Trim());// + ", ";
                                                                                                                                                                      //phrase.Add(new Chunk(Check, TblFontBold));
                                                                                                                                                                      //}
                                                        PdfPCell chk = new PdfPCell(new Phrase(Check, TableFont));
                                                        chk.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        chk.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        chk.Colspan = 2;
                                                        servDetails.AddCell(chk);

                                                        //if (entity.Check_Date != "")
                                                        //{
                                                        CheckDte = "Check Date: " + LookupDataAccess.Getdate(entity.Check_Date).ToString();// + ", ";
                                                                                                                                           //phrase.Add(new Chunk(CheckDte, TblFontBold));
                                                                                                                                           //}
                                                        PdfPCell chkDte = new PdfPCell(new Phrase(CheckDte, TableFont));
                                                        chkDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        chkDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        chkDte.Colspan = 2;
                                                        servDetails.AddCell(chkDte);

                                                        //if (entity.Followup_Comp != "")
                                                        //{
                                                        CompleteDte = "Complete Date: " + LookupDataAccess.Getdate(entity.Followup_Comp).ToString();// + ", ";
                                                                                                                                                    //phrase.Add(new Chunk(CompleteDte, TableFont));
                                                                                                                                                    //}
                                                        PdfPCell cmpDte = new PdfPCell(new Phrase(CompleteDte, TableFont));
                                                        cmpDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        cmpDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        cmpDte.Colspan = 2;
                                                        servDetails.AddCell(cmpDte);

                                                        by = "by: " + entity.Followup_By;// + ", ";
                                                                                         //if (!string.IsNullOrEmpty(entity.Followup_By.Trim()))
                                                                                         //{
                                                                                         //phrase.Add(new Chunk(by, TableFont));
                                                                                         //}
                                                        PdfPCell bywhom = new PdfPCell(new Phrase(by, TableFont));
                                                        bywhom.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        bywhom.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        bywhom.Colspan = 2;
                                                        servDetails.AddCell(bywhom);

                                                        Program = "Program: " + Set_SP_Program_TextReport(entity.Act_PROG);
                                                        //if (!string.IsNullOrEmpty(entity.Act_PROG.Trim()))
                                                        //{
                                                        //    phrase.Add(new Chunk(Program, TableFont));
                                                        //}
                                                        PdfPCell prog = new PdfPCell(new Phrase(Program, TableFont));
                                                        prog.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        prog.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        prog.Colspan = 2;
                                                        servDetails.AddCell(prog);

                                                    }
                                                    //Category 2 Service Details
                                                    else if (CategoryCode == "02")
                                                    {
                                                        Vendorname = Get_Vendor_Name(entity.Vendor_No);

                                                        CaDate = LookupDataAccess.Getdate(entity.ACT_Date).ToString();

                                                        if (entity.Followup_Comp != "")
                                                        {
                                                            CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                            completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                        }
                                                        else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "R")
                                                        {
                                                            CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                            completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                            completedate.Add(new Chunk("!", TableFontRed));
                                                        }
                                                        else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "Y")
                                                        {
                                                            CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                            completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                            completedate.Add(new Chunk("!", TableFontYellow));
                                                        }

                                                        servDetails.TotalWidth = 240f;
                                                        servDetails.WidthPercentage = 100;
                                                        servDetails.LockedWidth = true;
                                                        float[] serwidths = new float[] { 90f, 150f };
                                                        servDetails.SetWidths(serwidths);
                                                        servDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        servDetails.SpacingAfter = 07f;

                                                        //if (entity.ActSeek_Date != "")
                                                        //{
                                                        ServiceReqDte = "Service Requested Date: " + LookupDataAccess.Getdate(entity.ActSeek_Date).ToString();// + ", ";
                                                                                                                                                              //phrase.Add(new Chunk(ServiceReqDte, TableFont));
                                                                                                                                                              //}
                                                        PdfPCell ServReqDte = new PdfPCell(new Phrase(ServiceReqDte, TableFont));
                                                        ServReqDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        ServReqDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        ServReqDte.Colspan = 2;
                                                        servDetails.AddCell(ServReqDte);

                                                        CaseWorker = "Case Worker: " + GetWorkerName(entity.Caseworker);// + ", ";
                                                                                                                        //if (!string.IsNullOrEmpty(entity.Caseworker.Trim()))
                                                                                                                        //phrase.Add(new Chunk(CaseWorker, TableFont));
                                                        PdfPCell caseWorker = new PdfPCell(new Phrase(CaseWorker, TableFont));
                                                        caseWorker.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        caseWorker.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        caseWorker.Colspan = 2;
                                                        servDetails.AddCell(caseWorker);

                                                        Site = "Site: " + GetSiteName(entity.Site);// + ", ";
                                                                                                   //if (!string.IsNullOrEmpty(entity.Site.Trim()))
                                                                                                   //phrase.Add(new Chunk(Site, TableFont));
                                                        PdfPCell site = new PdfPCell(new Phrase(Site, TableFont));
                                                        site.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        site.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        site.Colspan = 2;
                                                        servDetails.AddCell(site);

                                                        BillPeriod = "Billing Period: " + entity.BillingPeriod;// + ", ";
                                                                                                               //if (!string.IsNullOrEmpty(entity.BillingPeriod.Trim()))
                                                                                                               //phrase.Add(new Chunk(BillPeriod, TableFont));
                                                        PdfPCell billperiod = new PdfPCell(new Phrase(BillPeriod, TableFont));
                                                        billperiod.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        billperiod.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        billperiod.Colspan = 2;
                                                        servDetails.AddCell(billperiod);

                                                        Account = "Account#: " + entity.Account;// + ", ";
                                                                                                //if (!string.IsNullOrEmpty(entity.Account.Trim()))
                                                                                                //{
                                                                                                //phrase.Add(new Chunk(Account, TableFont));
                                                                                                //}
                                                        PdfPCell act = new PdfPCell(new Phrase(Account, TableFont));
                                                        act.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        act.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        act.Colspan = 2;
                                                        servDetails.AddCell(act);

                                                        ArrearAmt = "Arrears Amt: " + entity.ArrearsAmt;// + ", ";
                                                                                                        //if (!string.IsNullOrEmpty(entity.ArrearsAmt.Trim()))
                                                                                                        //{
                                                                                                        //phrase.Add(new Chunk(ArrearAmt, TableFont));
                                                                                                        //}
                                                        PdfPCell arrAmt = new PdfPCell(new Phrase(ArrearAmt, TableFont));
                                                        arrAmt.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        arrAmt.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        arrAmt.Colspan = 2;
                                                        servDetails.AddCell(arrAmt);

                                                        Cost = "Amt Paid: " + entity.Cost;// + ", ";
                                                                                          //if (!string.IsNullOrEmpty(entity.Cost.Trim()))
                                                                                          //{
                                                                                          //phrase.Add(new Chunk(Cost, TableFont));
                                                                                          //}
                                                        PdfPCell cost = new PdfPCell(new Phrase(Cost, TableFont));
                                                        cost.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        cost.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        cost.Colspan = 2;
                                                        servDetails.AddCell(cost);

                                                        SupApproval = "Supervisor Approval: " + entity.LVL1Apprval;// + ", ";
                                                                                                                   //if (!string.IsNullOrEmpty(entity.LVL1Apprval.Trim()))
                                                                                                                   //{
                                                                                                                   //phrase.Add(new Chunk(SupApproval, TableFont));
                                                                                                                   //}
                                                        PdfPCell subaprvl = new PdfPCell(new Phrase(SupApproval, TableFont));
                                                        subaprvl.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        subaprvl.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        subaprvl.Colspan = 2;
                                                        servDetails.AddCell(subaprvl);

                                                        Date1 = "Date: " + entity.LVL1AprrvalDate;// + ", ";
                                                                                                  //if (!string.IsNullOrEmpty(entity.LVL1AprrvalDate.Trim()))
                                                                                                  //{
                                                                                                  //phrase.Add(new Chunk(Date1, TableFont));
                                                                                                  //}
                                                        PdfPCell dte1 = new PdfPCell(new Phrase(Date1, TableFont));
                                                        dte1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        dte1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        dte1.Colspan = 2;
                                                        servDetails.AddCell(dte1);

                                                        PrePayApproval = "Pre-Payment Approval: " + entity.LVL2Apprval;// + ", ";
                                                                                                                       //if (!string.IsNullOrEmpty(entity.LVL2Apprval.Trim()))
                                                                                                                       //{
                                                                                                                       //phrase.Add(new Chunk(PrePayApproval, TableFont));
                                                                                                                       //}
                                                        PdfPCell prepay = new PdfPCell(new Phrase(PrePayApproval, TableFont));
                                                        prepay.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        prepay.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        prepay.Colspan = 2;
                                                        servDetails.AddCell(prepay);

                                                        Date2 = "Date: " + entity.LVL2ApprvalDate;// + ", ";
                                                                                                  //if (!string.IsNullOrEmpty(entity.LVL2ApprvalDate.Trim()))
                                                                                                  //{
                                                                                                  //phrase.Add(new Chunk(Date2, TableFont));
                                                                                                  //}
                                                        PdfPCell dte2 = new PdfPCell(new Phrase(Date2, TableFont));
                                                        dte2.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        dte2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        dte2.Colspan = 2;
                                                        servDetails.AddCell(dte2);

                                                        SentForPay = "Sent for Payment by User: " + entity.SentPmtUser;// + ", ";
                                                                                                                       //if (!string.IsNullOrEmpty(entity.SentPmtUser.Trim()))
                                                                                                                       //{
                                                                                                                       //phrase.Add(new Chunk(SentForPay, TableFont));
                                                                                                                       //}
                                                        PdfPCell sentfor = new PdfPCell(new Phrase(SentForPay, TableFont));
                                                        sentfor.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        sentfor.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        sentfor.Colspan = 2;
                                                        servDetails.AddCell(sentfor);

                                                        DateOn = "On: " + entity.SentPmtDate;// + ", ";
                                                                                             //if (!string.IsNullOrEmpty(entity.SentPmtDate.Trim()))
                                                                                             //{
                                                                                             //phrase.Add(new Chunk(DateOn, TableFont));
                                                                                             //}
                                                        PdfPCell dteOn = new PdfPCell(new Phrase(DateOn, TableFont));
                                                        dteOn.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        dteOn.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        dteOn.Colspan = 2;
                                                        servDetails.AddCell(dteOn);

                                                        Fund1 = "Fund: " + GetFundName(entity.Fund1);// + ", ";
                                                                                                     //if (!string.IsNullOrEmpty(entity.Fund1.Trim()))
                                                                                                     //{
                                                                                                     //phrase.Add(new Chunk(Fund1, TableFont));
                                                                                                     //}
                                                        PdfPCell fund1 = new PdfPCell(new Phrase(Fund1, TableFont));
                                                        fund1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        fund1.Colspan = 2;
                                                        servDetails.AddCell(fund1);

                                                        //if (entity.BundleNo != "")
                                                        //{
                                                        Bundle = "Bundle#: " + entity.BundleNo;// + ", ";
                                                                                               //phrase.Add(new Chunk(Bundle, TblFontBold));
                                                                                               //}
                                                        PdfPCell bundle = new PdfPCell(new Phrase(Bundle, TableFont));
                                                        bundle.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        bundle.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        bundle.Colspan = 2;
                                                        servDetails.AddCell(bundle);

                                                        //if (entity.Followup_Comp != "")
                                                        //{
                                                        CompleteDte = "Complete Date: " + LookupDataAccess.Getdate(entity.Followup_Comp).ToString();// + ", ";
                                                        //phrase.Add(new Chunk(CompleteDte, TableFont));
                                                        //}
                                                        PdfPCell cmpDte = new PdfPCell(new Phrase(CompleteDte, TableFont));
                                                        cmpDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        cmpDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        cmpDte.Colspan = 2;
                                                        servDetails.AddCell(cmpDte);

                                                        by = "by: " + entity.Followup_By;// + ", ";
                                                                                         //if (!string.IsNullOrEmpty(entity.Followup_By.Trim()))
                                                                                         //{
                                                                                         //phrase.Add(new Chunk(by, TableFont));
                                                                                         //}
                                                        PdfPCell bywhom = new PdfPCell(new Phrase(by, TableFont));
                                                        bywhom.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        bywhom.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        bywhom.Colspan = 2;
                                                        servDetails.AddCell(bywhom);

                                                        Program = "Program: " + Set_SP_Program_TextReport(entity.Act_PROG);
                                                        //if (!string.IsNullOrEmpty(entity.Act_PROG.Trim()))
                                                        //{
                                                        //phrase.Add(new Chunk(Program, TableFont));
                                                        //}
                                                        PdfPCell prog = new PdfPCell(new Phrase(Program, TableFont));
                                                        prog.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        prog.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        prog.Colspan = 2;
                                                        servDetails.AddCell(prog);
                                                    }
                                                    //Category 3 Service Details
                                                    else if (CategoryCode == "03")
                                                    {
                                                        Vendorname = Get_Vendor_Name(entity.Vendor_No);

                                                        CaDate = LookupDataAccess.Getdate(entity.ACT_Date).ToString();

                                                        if (entity.Followup_Comp != "")
                                                        {
                                                            CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                            completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                        }
                                                        else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "R")
                                                        {
                                                            CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                            completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                            completedate.Add(new Chunk("!", TableFontRed));
                                                        }
                                                        else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "Y")
                                                        {
                                                            CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                            completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                            completedate.Add(new Chunk("!", TableFontYellow));
                                                        }

                                                        servDetails.TotalWidth = 240f;
                                                        servDetails.WidthPercentage = 100;
                                                        servDetails.LockedWidth = true;
                                                        float[] serwidths = new float[] { 90f, 150f };
                                                        servDetails.SetWidths(serwidths);
                                                        servDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        servDetails.SpacingAfter = 07f;

                                                        //if (entity.ActSeek_Date != "")
                                                        //{
                                                        ServiceReqDte = "Service Requested Date: " + LookupDataAccess.Getdate(entity.ActSeek_Date).ToString();// + ", ";
                                                                                                                                                              //**phrase.Add(new Chunk(ServiceReqDte, TableFont));

                                                        PdfPCell ServReqDte = new PdfPCell(new Phrase(ServiceReqDte, TableFont));
                                                        ServReqDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        ServReqDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        ServReqDte.Colspan = 2;
                                                        servDetails.AddCell(ServReqDte);
                                                        //}

                                                        CaseWorker = "Case Worker: " + GetWorkerName(entity.Caseworker);// + ", ";
                                                                                                                        //if (!string.IsNullOrEmpty(entity.Caseworker.Trim()))
                                                                                                                        //{
                                                                                                                        //**phrase.Add(new Chunk(CaseWorker, TableFont));

                                                        PdfPCell caseWorker = new PdfPCell(new Phrase(CaseWorker, TableFont));
                                                        caseWorker.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        caseWorker.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        caseWorker.Colspan = 2;
                                                        servDetails.AddCell(caseWorker);
                                                        //}

                                                        Site = "Site: " + GetSiteName(entity.Site);// + ", ";
                                                                                                   //if (!string.IsNullOrEmpty(entity.Site.Trim()))
                                                                                                   //{
                                                                                                   //**phrase.Add(new Chunk(Site, TableFont));

                                                        PdfPCell site = new PdfPCell(new Phrase(Site, TableFont));
                                                        site.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        site.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        site.Colspan = 2;
                                                        servDetails.AddCell(site);
                                                        //}

                                                        Fund1 = "Fund: " + GetFundName(entity.Fund1);// + ", ";
                                                                                                     //if (!string.IsNullOrEmpty(entity.Fund1.Trim()))
                                                                                                     //{
                                                                                                     //**phrase.Add(new Chunk(Fund1, TableFont));

                                                        PdfPCell fund1 = new PdfPCell(new Phrase(Fund1, TableFont));
                                                        fund1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        fund1.Colspan = 2;
                                                        servDetails.AddCell(fund1);
                                                        //}

                                                        Fund2 = "Fund 2: " + GetFundName(entity.Fund2);// + ", ";
                                                                                                       //if (!string.IsNullOrEmpty(entity.Fund2.Trim()))
                                                                                                       //{
                                                                                                       //**phrase.Add(new Chunk(Fund2, TableFont));

                                                        PdfPCell fund2 = new PdfPCell(new Phrase(Fund2, TableFont));
                                                        fund2.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        fund2.Colspan = 2;
                                                        servDetails.AddCell(fund2);
                                                        //}

                                                        Fund3 = "Fund 3: " + GetFundName(entity.Fund3);// + ", ";
                                                                                                       //if (!string.IsNullOrEmpty(entity.Fund3.Trim()))
                                                                                                       //{
                                                                                                       //**phrase.Add(new Chunk(Fund3, TableFont));

                                                        PdfPCell fund3 = new PdfPCell(new Phrase(Fund3, TableFont));
                                                        fund3.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        fund3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        fund3.Colspan = 2;
                                                        servDetails.AddCell(fund3);
                                                        //}

                                                        UOM1 = "UOM: " + GetUOMName(entity.UOM);// + ", ";
                                                                                                //if (!string.IsNullOrEmpty(entity.UOM.Trim()))
                                                                                                //{
                                                                                                //**phrase.Add(new Chunk(UOM1, TableFont));

                                                        PdfPCell uom1 = new PdfPCell(new Phrase(UOM1, TableFont));
                                                        uom1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        uom1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        uom1.Colspan = 2;
                                                        servDetails.AddCell(uom1);
                                                        //}

                                                        UOM2 = "UOM 2: " + GetUOMName(entity.UOM2);// + ", ";
                                                                                                   //if (!string.IsNullOrEmpty(entity.UOM2.Trim()))
                                                                                                   //{
                                                                                                   //**phrase.Add(new Chunk(UOM2, TableFont));

                                                        PdfPCell uom2 = new PdfPCell(new Phrase(UOM2, TableFont));
                                                        uom2.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        uom2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        uom2.Colspan = 2;
                                                        servDetails.AddCell(uom2);
                                                        //}

                                                        UOM3 = "UOM 3: " + GetUOMName(entity.UOM3);// + ", ";
                                                                                                   //if (!string.IsNullOrEmpty(entity.UOM3.Trim()))
                                                                                                   //{
                                                                                                   //**phrase.Add(new Chunk(UOM3, TableFont));

                                                        PdfPCell uom3 = new PdfPCell(new Phrase(UOM3, TableFont));
                                                        uom3.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        uom3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        uom3.Colspan = 2;
                                                        servDetails.AddCell(uom3);
                                                        //}

                                                        Amt1 = "Amount: " + entity.Amount;// + ", ";
                                                                                          //if (!string.IsNullOrEmpty(entity.Amount.Trim()))
                                                                                          //{
                                                                                          //**phrase.Add(new Chunk(Amt1, TableFont));

                                                        PdfPCell amt1 = new PdfPCell(new Phrase(Amt1, TableFont));
                                                        amt1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        amt1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        amt1.Colspan = 2;
                                                        servDetails.AddCell(amt1);
                                                        //}

                                                        Amt2 = "Amount 2: " + entity.Amount2;// + ", ";
                                                                                             //if (!string.IsNullOrEmpty(entity.Amount2.Trim()))
                                                                                             //{
                                                                                             //**phrase.Add(new Chunk(Amt2, TableFont));

                                                        PdfPCell amt2 = new PdfPCell(new Phrase(Amt2, TableFont));
                                                        amt2.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        amt2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        amt2.Colspan = 2;
                                                        servDetails.AddCell(amt2);
                                                        //}

                                                        Amt3 = "Amount 3: " + entity.Amount3;// + ", ";
                                                                                             //if (!string.IsNullOrEmpty(entity.Amount3.Trim()))
                                                                                             //{
                                                                                             //**phrase.Add(new Chunk(Amt3, TableFont));

                                                        PdfPCell amt3 = new PdfPCell(new Phrase(Amt3, TableFont));
                                                        amt3.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        amt3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        amt3.Colspan = 2;
                                                        servDetails.AddCell(amt3);
                                                        //}

                                                        Total = "Total: " + entity.Cost;// + ", ";
                                                                                        //if (!string.IsNullOrEmpty(entity.Cost.Trim()))
                                                                                        //{
                                                                                        //**phrase.Add(new Chunk(Total, TableFont));

                                                        PdfPCell tot = new PdfPCell(new Phrase(Total, TableFont));
                                                        tot.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        tot.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        tot.Colspan = 2;
                                                        servDetails.AddCell(tot);
                                                        //}

                                                        //if (entity.Check_No != "")
                                                        //{
                                                        Check = "Check#: " + ("0000000000".Substring(0, 10 - entity.Check_No.Trim().Length) + entity.Check_No.Trim());// + ", ";
                                                                                                                                                                      //**phrase.Add(new Chunk(Check, TblFontBold));

                                                        PdfPCell chk = new PdfPCell(new Phrase(Check, TableFont));
                                                        chk.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        chk.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        chk.Colspan = 2;
                                                        servDetails.AddCell(chk);
                                                        //}

                                                        //if (entity.Check_Date != "")
                                                        //{
                                                        CheckDte = "Check Date: " + LookupDataAccess.Getdate(entity.Check_Date).ToString();// + ", ";
                                                                                                                                           //**phrase.Add(new Chunk(CheckDte, TblFontBold));

                                                        PdfPCell chkDte = new PdfPCell(new Phrase(CheckDte, TableFont));
                                                        chkDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        chkDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        chkDte.Colspan = 2;
                                                        servDetails.AddCell(chkDte);
                                                        //}

                                                        //if (entity.Followup_Comp != "")
                                                        //{
                                                        CompleteDte = "Complete Date: " + LookupDataAccess.Getdate(entity.Followup_Comp).ToString();// + ", ";
                                                                                                                                                    //**phrase.Add(new Chunk(CompleteDte, TableFont));

                                                        PdfPCell cmpDte = new PdfPCell(new Phrase(CompleteDte, TableFont));
                                                        cmpDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        cmpDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        cmpDte.Colspan = 2;
                                                        servDetails.AddCell(cmpDte);
                                                        //}

                                                        by = "by: " + entity.Followup_By;// + ", ";
                                                                                         //if (!string.IsNullOrEmpty(entity.Followup_By.Trim()))
                                                                                         //{
                                                                                         //**phrase.Add(new Chunk(by, TableFont));

                                                        PdfPCell bywhom = new PdfPCell(new Phrase(by, TableFont));
                                                        bywhom.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        bywhom.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        bywhom.Colspan = 2;
                                                        servDetails.AddCell(bywhom);
                                                        //}

                                                        Program = "Program: " + Set_SP_Program_TextReport(entity.Act_PROG);
                                                        //if (!string.IsNullOrEmpty(entity.Act_PROG.Trim()))
                                                        //{
                                                        //**phrase.Add(new Chunk(Program, TableFont));

                                                        PdfPCell prog = new PdfPCell(new Phrase(Program, TableFont));
                                                        prog.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        prog.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        prog.Colspan = 2;
                                                        servDetails.AddCell(prog);
                                                        //}
                                                    }
                                                    //Category 4 Service Details
                                                    else if (CategoryCode == "04")
                                                    {
                                                        #region Nested Table created on 02/02/2024 by Vikash as per CEAP Enhancement document

                                                        Vendorname = Get_Vendor_Name(entity.Vendor_No);

                                                        CaDate = LookupDataAccess.Getdate(entity.ACT_Date).ToString();

                                                        if (entity.Followup_Comp != "")
                                                        {
                                                            CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                            completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                        }
                                                        else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "R")
                                                        {
                                                            CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                            completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                            completedate.Add(new Chunk("!", TableFontRed));
                                                        }
                                                        else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "Y")
                                                        {
                                                            CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                            completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                            completedate.Add(new Chunk("!", TableFontYellow));
                                                        }

                                                        servDetails.TotalWidth = 240f;
                                                        servDetails.WidthPercentage = 100;
                                                        servDetails.LockedWidth = true;
                                                        float[] serwidths = new float[] { 90f, 150f };
                                                        servDetails.SetWidths(serwidths);
                                                        servDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        servDetails.SpacingAfter = 07f;

                                                        //if (entity.ActSeek_Date != "")
                                                        //{
                                                        ServiceReqDte = "Service Requested Date: " + LookupDataAccess.Getdate(entity.ActSeek_Date).ToString();// + ", ";

                                                        PdfPCell ServReqDte = new PdfPCell(new Phrase(ServiceReqDte, TableFont));
                                                        ServReqDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        ServReqDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        ServReqDte.Colspan = 2;
                                                        servDetails.AddCell(ServReqDte);
                                                        //}

                                                        CaseWorker = "Case Worker: " + GetWorkerName(entity.Caseworker);// + ", ";
                                                                                                                        //if (!string.IsNullOrEmpty(entity.Caseworker.Trim()))
                                                                                                                        //{
                                                        PdfPCell caseWorker = new PdfPCell(new Phrase(CaseWorker, TableFont));
                                                        caseWorker.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        caseWorker.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        caseWorker.Colspan = 2;
                                                        servDetails.AddCell(caseWorker);
                                                        //}

                                                        //Site = "Site: " + GetSiteName(entity.Site);// + ", ";
                                                        //if (!string.IsNullOrEmpty(entity.Site.Trim()))
                                                        //{
                                                        //    PdfPCell site = new PdfPCell(new Phrase(Site, TableFont));
                                                        //    site.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        //    site.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        //    site.Colspan = 2;
                                                        //    servDetails.AddCell(site);
                                                        //}


                                                        Source = "Source: " + Fill_Sources(entity.CA_Source);// + ", ";
                                                                                                             //if (!string.IsNullOrEmpty(entity.CA_Source.Trim()))
                                                                                                             //{
                                                        PdfPCell source = new PdfPCell(new Phrase(Source, TableFont));
                                                        source.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        source.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        source.Colspan = 2;
                                                        servDetails.AddCell(source);
                                                        //}

                                                        BillingName = "Billing Name: " + entity.BillngFname + " " + entity.BillngLname;// + ", ";
                                                                                                                                       //if (!string.IsNullOrEmpty(entity.BillngType.Trim()))
                                                                                                                                       //{
                                                        PdfPCell billingName = new PdfPCell(new Phrase(BillingName, TableFont));
                                                        billingName.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        billingName.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        billingName.Colspan = 2;
                                                        servDetails.AddCell(billingName);
                                                        //}

                                                        Account = "Account#: " + entity.Account;// + ", ";
                                                                                                //if (!string.IsNullOrEmpty(entity.Account.Trim()))
                                                                                                //{
                                                        PdfPCell acc = new PdfPCell(new Phrase(Account, TableFont));
                                                        acc.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        acc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        acc.Colspan = 2;
                                                        servDetails.AddCell(acc);
                                                        //}

                                                        //Fund1 = "Fund: " + GetFundName(entity.Fund1);// + ", ";
                                                        //if (!string.IsNullOrEmpty(entity.Fund1.Trim()))
                                                        //{
                                                        //    PdfPCell fund1 = new PdfPCell(new Phrase(Fund1, TableFont));
                                                        //    fund1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        //    fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        //    fund1.Colspan = 2;
                                                        //    servDetails.AddCell(fund1);
                                                        //}

                                                        Budget = "Budget: " + BudgetDesc(entity.BDC_ID);// + ", ";
                                                                                                        //if (!string.IsNullOrEmpty(entity.BDC_ID.Trim()))
                                                                                                        //{
                                                        PdfPCell budget = new PdfPCell(new Phrase(Budget, TableFont));
                                                        budget.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        budget.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        budget.Colspan = 2;
                                                        servDetails.AddCell(budget);
                                                        //}

                                                        BenefitReason = "Benefit Reason: " + BenefitReasonDesc(entity.BenefitReason);// + ", ";
                                                                                                                                     //if (!string.IsNullOrEmpty(entity.BenefitReason.Trim()))
                                                                                                                                     //{
                                                        PdfPCell benfReason = new PdfPCell(new Phrase(BenefitReason, TableFont));
                                                        benfReason.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        benfReason.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        benfReason.Colspan = 2;
                                                        servDetails.AddCell(benfReason);
                                                        //}

                                                        //if (entity.Followup_Comp != "")
                                                        //{
                                                        CompleteDte = "Complete Date: " + LookupDataAccess.Getdate(entity.Followup_Comp).ToString();// + ", ";

                                                        PdfPCell cmpDate = new PdfPCell(new Phrase(CompleteDte, TableFont));
                                                        cmpDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        cmpDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        cmpDate.Colspan = 2;
                                                        servDetails.AddCell(cmpDate);
                                                        //}

                                                        by = "by: " + entity.Followup_By;// + ", ";
                                                                                         //if (!string.IsNullOrEmpty(entity.Followup_By.Trim()))
                                                                                         //{
                                                        PdfPCell By = new PdfPCell(new Phrase(by, TableFont));
                                                        By.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        By.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        By.Colspan = 2;
                                                        servDetails.AddCell(By);
                                                        //}

                                                        //Program = "Program: " + Set_SP_Program_TextReport(entity.Act_PROG);
                                                        //if (!string.IsNullOrEmpty(entity.Act_PROG.Trim()))
                                                        //{
                                                        //    PdfPCell prog = new PdfPCell(new Phrase(Program, TableFont));
                                                        //    prog.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        //    prog.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        //    prog.Colspan = 2;
                                                        //    servDetails.AddCell(prog);
                                                        //}

                                                        Cost = "Amount Paid: " + entity.Cost;// + ", ";
                                                        if (!string.IsNullOrEmpty(entity.Cost.Trim()))
                                                        {
                                                            phraseCat4.Add(new Chunk(Cost, TblFont));
                                                        }
                                                        else
                                                            phraseCat4.Add(new Chunk("", TblFont));

                                                        if (entity.BundleNo != "")
                                                        {
                                                            Bundle = "Bundle#: " + entity.BundleNo;// + ", ";
                                                            phraseCat4.Add(new Chunk(Bundle, TblFontBold));
                                                        }
                                                        else
                                                            phraseCat4.Add(new Chunk("", TblFontBold));

                                                        if (entity.PaymentNo != "")
                                                        {
                                                            Payment = "Payment#: " + entity.PaymentNo;// + ", ";
                                                            phraseCat4.Add(new Chunk(Payment, TblFontBold1));
                                                        }
                                                        else
                                                            phraseCat4.Add(new Chunk("", TblFontBold1));

                                                        if (entity.Check_No != "")
                                                        {
                                                            Check = "Check#: " + ("0000000000".Substring(0, 10 - entity.Check_No.Trim().Length) + entity.Check_No.Trim());// + ", ";
                                                            phraseCat4.Add(new Chunk(Check, TblFontBold2));
                                                        }
                                                        else
                                                            phraseCat4.Add(new Chunk("", TblFontBold2));

                                                        if (entity.Check_Date != "")
                                                        {
                                                            CheckDte = "Check Date: " + LookupDataAccess.Getdate(entity.Check_Date).ToString();// + ", ";
                                                            phraseCat4.Add(new Chunk(CheckDte, TblFontBold3));
                                                        }
                                                        else
                                                            phraseCat4.Add(new Chunk("Check Date: ", TblFontBold3));

                                                        #endregion

                                                        /* Vendorname = Get_Vendor_Name(entity.Vendor_No);

                                                         CaDate = LookupDataAccess.Getdate(entity.ACT_Date).ToString();

                                                         if (entity.Followup_Comp != "")
                                                         {
                                                             CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                             completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                         }
                                                         else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "R")
                                                         {
                                                             CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                             completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                             completedate.Add(new Chunk("!", TableFontRed));
                                                         }
                                                         else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "Y")
                                                         {
                                                             CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                             completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                             completedate.Add(new Chunk("!", TableFontYellow));
                                                         }


                                                         if (entity.ActSeek_Date != "")
                                                         {
                                                             ServiceReqDte = "Service Requested Date: " + LookupDataAccess.Getdate(entity.ActSeek_Date).ToString() + ", ";
                                                             phrase.Add(new Chunk(ServiceReqDte, TableFont));
                                                         }

                                                         CaseWorker = "Case Worker: " + GetWorkerName(entity.Caseworker) + ", ";
                                                         if (!string.IsNullOrEmpty(entity.Caseworker.Trim()))
                                                             phrase.Add(new Chunk(CaseWorker, TableFont));

                                                         Site = "Site: " + GetSiteName(entity.Site) + ", ";
                                                         if (!string.IsNullOrEmpty(entity.Site.Trim()))
                                                             phrase.Add(new Chunk(Site, TableFont));


                                                         Source = "Source: " + Fill_Sources(entity.CA_Source) + ", ";
                                                         if (!string.IsNullOrEmpty(entity.CA_Source.Trim()))
                                                         {
                                                             phrase.Add(new Chunk(Source, TableFont));
                                                         }

                                                         BillingName = "Billing Name: " + entity.BillngFname + " " + entity.BillngLname + ", ";
                                                         if (!string.IsNullOrEmpty(entity.BillngType.Trim()))
                                                         {
                                                             phrase.Add(new Chunk(BillingName, TableFont));
                                                         }

                                                         Account = "Account#: " + entity.Account + ", ";
                                                         if (!string.IsNullOrEmpty(entity.Account.Trim()))
                                                         {
                                                             phrase.Add(new Chunk(Account, TableFont));
                                                         }

                                                         Fund1 = "Fund: " + GetFundName(entity.Fund1) + ", ";
                                                         if (!string.IsNullOrEmpty(entity.Fund1.Trim()))
                                                         {
                                                             phrase.Add(new Chunk(Fund1, TableFont));
                                                         }

                                                         Budget = "Budget: " + BudgetDesc(entity.BDC_ID) + ", ";
                                                         if (!string.IsNullOrEmpty(entity.BDC_ID.Trim()))
                                                         {
                                                             phrase.Add(new Chunk(Budget, TableFont));
                                                         }

                                                         BenefitReason = "Benefit Reason: " + BenefitReasonDesc(entity.BenefitReason) + ", ";
                                                         if (!string.IsNullOrEmpty(entity.BenefitReason.Trim()))
                                                         {
                                                             phrase.Add(new Chunk(BenefitReason, TableFont));
                                                         }

                                                         Cost = "Amount Paid: " + entity.Cost;// + ", ";
                                                         if (!string.IsNullOrEmpty(entity.Cost.Trim()))
                                                         {
                                                             phraseCat4.Add(new Chunk(Cost, TblFont));
                                                         }
                                                         else
                                                             phraseCat4.Add(new Chunk("", TblFont));

                                                         if (entity.BundleNo != "")
                                                         {
                                                             Bundle = "Bundle#: " + entity.BundleNo;// + ", ";
                                                             phraseCat4.Add(new Chunk(Bundle, TblFontBold));
                                                         }
                                                         else
                                                             phraseCat4.Add(new Chunk("", TblFontBold));

                                                         if (entity.PaymentNo != "")
                                                         {
                                                             Payment = "Payment#: " + entity.PaymentNo;// + ", ";
                                                             phraseCat4.Add(new Chunk(Payment, TblFontBold1));
                                                         }
                                                         else
                                                             phraseCat4.Add(new Chunk("", TblFontBold1));

                                                         if (entity.Check_No != "")
                                                         {
                                                             Check = "Check#: " + ("0000000000".Substring(0, 10 - entity.Check_No.Trim().Length) + entity.Check_No.Trim());// + ", ";
                                                             phraseCat4.Add(new Chunk(Check, TblFontBold2));
                                                         }
                                                         else
                                                             phraseCat4.Add(new Chunk("", TblFontBold2));

                                                         if (entity.Check_Date != "")
                                                         {
                                                             CheckDte = "Check Date: " + LookupDataAccess.Getdate(entity.Check_Date).ToString();// + ", ";
                                                             phraseCat4.Add(new Chunk(CheckDte, TblFontBold3));
                                                         }
                                                         else
                                                             phraseCat4.Add(new Chunk("Check Date: ", TblFontBold3));

                                                         if (entity.Followup_Comp != "")
                                                         {
                                                             CompleteDte = "Complete Date: " + LookupDataAccess.Getdate(entity.Followup_Comp).ToString() + ", ";
                                                             phrase.Add(new Chunk(CompleteDte, TableFont));
                                                         }

                                                         by = "by: " + entity.Followup_By + ", ";
                                                         if (!string.IsNullOrEmpty(entity.Followup_By.Trim()))
                                                         {
                                                             phrase.Add(new Chunk(by, TableFont));
                                                         }

                                                         Program = "Program: " + Set_SP_Program_TextReport(entity.Act_PROG);
                                                         if (!string.IsNullOrEmpty(entity.Act_PROG.Trim()))
                                                         {
                                                             phrase.Add(new Chunk(Program, TableFont));
                                                         }
                                                         */
                                                    }
                                                    //No Category
                                                    else
                                                    {

                                                        CaDate = LookupDataAccess.Getdate(entity.ACT_Date).ToString();

                                                        if (entity.Followup_Comp != "")
                                                        {
                                                            CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                            completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                        }
                                                        else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "R")
                                                        {
                                                            CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                            completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                            completedate.Add(new Chunk("!", TableFontRed));
                                                        }
                                                        else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "Y")
                                                        {
                                                            CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                            completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                            completedate.Add(new Chunk("!", TableFontYellow));
                                                        }

                                                        servDetails.TotalWidth = 240f;
                                                        servDetails.WidthPercentage = 100;
                                                        servDetails.LockedWidth = true;
                                                        float[] serwidths = new float[] { 90f, 150f };
                                                        servDetails.SetWidths(serwidths);
                                                        servDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        servDetails.SpacingAfter = 07f;

                                                        //if (entity.ActSeek_Date != "")
                                                        //{
                                                        ServiceReqDte = "Service Requested Date: " + LookupDataAccess.Getdate(entity.ActSeek_Date).ToString();// + ", ";

                                                        PdfPCell ServReqDte = new PdfPCell(new Phrase(ServiceReqDte, TableFont));
                                                        ServReqDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        ServReqDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        ServReqDte.Colspan = 2;
                                                        servDetails.AddCell(ServReqDte);
                                                        //}

                                                        CaseWorker = "Case Worker: " + GetWorkerName(entity.Caseworker);// + ", ";
                                                                                                                        //if (!string.IsNullOrEmpty(entity.Caseworker.Trim()))
                                                                                                                        //{
                                                        PdfPCell caseWorker = new PdfPCell(new Phrase(CaseWorker, TableFont));
                                                        caseWorker.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        caseWorker.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        caseWorker.Colspan = 2;
                                                        servDetails.AddCell(caseWorker);
                                                        //}

                                                        //if (entity.VendorName != "")
                                                        //{
                                                        Vendorname = "Vendor: " + Get_Vendor_Name(entity.Vendor_No);
                                                        PdfPCell vendor = new PdfPCell(new Phrase(Vendorname, TableFont));
                                                        vendor.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        vendor.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        vendor.Colspan = 2;
                                                        servDetails.AddCell(vendor);
                                                        //phrase.Add(new Chunk(Vendorname, TableFont));
                                                        //}

                                                        Fund1 = "Fund: " + GetFundName(entity.Fund1);// + ", ";
                                                        //if (!string.IsNullOrEmpty(entity.Fund1.Trim()))
                                                        //{
                                                        PdfPCell fund1 = new PdfPCell(new Phrase(Fund1, TableFont));
                                                        fund1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        fund1.Colspan = 2;
                                                        servDetails.AddCell(fund1);
                                                        ;
                                                        //phrase.Add(new Chunk(Fund1, TableFont));
                                                        //}

                                                        UOM1 = "UOM: " + GetUOMName(entity.UOM);// + ", ";
                                                        //if (!string.IsNullOrEmpty(entity.UOM.Trim()))
                                                        //{
                                                        PdfPCell uom = new PdfPCell(new Phrase(UOM1, TableFont));
                                                        uom.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        uom.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        uom.Colspan = 2;
                                                        servDetails.AddCell(uom);
                                                        //phrase.Add(new Chunk(UOM1, TableFont));
                                                        //}

                                                        Amt1 = "Amount: " + entity.Amount;// + ", ";
                                                        //if (!string.IsNullOrEmpty(entity.Amount.Trim()))
                                                        //{
                                                        PdfPCell amt = new PdfPCell(new Phrase(Amt1, TableFont));
                                                        amt.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        amt.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        amt.Colspan = 2;
                                                        servDetails.AddCell(amt);
                                                        //phrase.Add(new Chunk(Amt1, TableFont));
                                                        //}

                                                        Fund2 = "Fund 2: " + GetFundName(entity.Fund2);// + ", ";
                                                                                                       //if (!string.IsNullOrEmpty(entity.Fund2.Trim()))
                                                                                                       //{
                                                        PdfPCell fund2 = new PdfPCell(new Phrase(Fund2, TableFont));
                                                        fund2.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        fund2.Colspan = 2;
                                                        servDetails.AddCell(fund2);
                                                        //phrase.Add(new Chunk(Fund2, TableFont));
                                                        //}

                                                        Fund3 = "Fund 3: " + GetFundName(entity.Fund3);// + ", ";
                                                        //if (!string.IsNullOrEmpty(entity.Fund3.Trim()))
                                                        //{
                                                        PdfPCell fund3 = new PdfPCell(new Phrase(Fund3, TableFont));
                                                        fund3.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        fund3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        fund3.Colspan = 2;
                                                        servDetails.AddCell(fund3);
                                                        //phrase.Add(new Chunk(Fund3, TableFont));
                                                        // }

                                                        //if (entity.Check_No != "")
                                                        //{
                                                        Check = "Check#: " + ("0000000000".Substring(0, 10 - entity.Check_No.Trim().Length) + entity.Check_No.Trim());//+ ", ";
                                                        PdfPCell check = new PdfPCell(new Phrase(Check, TableFont));
                                                        check.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        check.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        check.Colspan = 2;
                                                        servDetails.AddCell(check);
                                                        //phrase.Add(new Chunk(Check, TblFontBold));
                                                        //}

                                                        //if (entity.Check_Date != "")
                                                        //{
                                                        CheckDte = "Check Date: " + LookupDataAccess.Getdate(entity.Check_Date).ToString();// + ", ";
                                                        PdfPCell checkdte = new PdfPCell(new Phrase(CheckDte, TableFont));
                                                        checkdte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        checkdte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        checkdte.Colspan = 2;
                                                        servDetails.AddCell(checkdte);
                                                        //phrase.Add(new Chunk(CheckDte, TblFontBold));
                                                        //}

                                                        //if (entity.Followup_Comp != "")
                                                        //{
                                                        CompleteDte = "Complete Date: " + LookupDataAccess.Getdate(entity.Followup_Comp).ToString();// + ", ";
                                                        PdfPCell cmpdte = new PdfPCell(new Phrase(CompleteDte, TableFont));
                                                        cmpdte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        cmpdte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        cmpdte.Colspan = 2;
                                                        servDetails.AddCell(cmpdte);
                                                        //phrase.Add(new Chunk(CompleteDte, TableFont));
                                                        //}

                                                        by = "by: " + entity.Followup_By;// + ", ";
                                                        //if (!string.IsNullOrEmpty(entity.Followup_By.Trim()))
                                                        //{
                                                        PdfPCell folowupby = new PdfPCell(new Phrase(by, TableFont));
                                                        folowupby.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        folowupby.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        folowupby.Colspan = 2;
                                                        servDetails.AddCell(folowupby);
                                                        //phrase.Add(new Chunk(by, TableFont));
                                                        //}

                                                        Program = "Program: " + Set_SP_Program_TextReport(entity.Act_PROG);
                                                        //if (!string.IsNullOrEmpty(entity.Act_PROG.Trim()))
                                                        //{
                                                        PdfPCell prog = new PdfPCell(new Phrase(Program, TableFont));
                                                        prog.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        prog.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        prog.Colspan = 2;
                                                        servDetails.AddCell(prog);
                                                        //phrase.Add(new Chunk(Program, TableFont));
                                                        //}

                                                        //if (entity.VendorName != "")
                                                        //{
                                                        //    Vendorname = "Vendor: " + Get_Vendor_Name(entity.Vendor_No) + ", ";
                                                        //    phrase.Add(new Chunk(Vendorname, TableFont));
                                                        //}

                                                        //if (entity.ActSeek_Date != "")
                                                        //{
                                                        //    ServiceReqDte = "Service Requested Date: " + LookupDataAccess.Getdate(entity.ActSeek_Date).ToString() + ", ";
                                                        //    phrase.Add(new Chunk(ServiceReqDte, TableFont));
                                                        //}

                                                        //CaseWorker = "Case Worker: " + GetWorkerName(entity.Caseworker) + ", ";
                                                        //if (!string.IsNullOrEmpty(entity.Caseworker.Trim()))
                                                        //    phrase.Add(new Chunk(CaseWorker, TableFont));

                                                        //Site = "Site: " + GetSiteName(entity.Site) + ", ";
                                                        //if (!string.IsNullOrEmpty(entity.Site.Trim()))
                                                        //    phrase.Add(new Chunk(Site, TableFont));

                                                        //Fund1 = "Fund: " + GetFundName(entity.Fund1) + ", ";
                                                        //if (!string.IsNullOrEmpty(entity.Fund1.Trim()))
                                                        //{
                                                        //    phrase.Add(new Chunk(Fund1, TableFont));
                                                        //}

                                                        //Fund2 = "Fund 2: " + GetFundName(entity.Fund2) + ", ";
                                                        //if (!string.IsNullOrEmpty(entity.Fund2.Trim()))
                                                        //{
                                                        //    phrase.Add(new Chunk(Fund2, TableFont));
                                                        //}

                                                        //Fund3 = "Fund 3: " + GetFundName(entity.Fund3) + ", ";
                                                        //if (!string.IsNullOrEmpty(entity.Fund3.Trim()))
                                                        //{
                                                        //    phrase.Add(new Chunk(Fund3, TableFont));
                                                        //}

                                                        //UOM1 = "UOM: " + GetUOMName(entity.UOM) + ", ";
                                                        //if (!string.IsNullOrEmpty(entity.UOM.Trim()))
                                                        //{
                                                        //    phrase.Add(new Chunk(UOM1, TableFont));
                                                        //}



                                                        foreach (FldcntlHieEntity Entity1 in CntlCAEntity)
                                                        {
                                                            bool enabled = false;
                                                            enabled = Entity1.Enab.Equals("Y") ? true : false;
                                                            switch (Entity1.FldCode)
                                                            {
                                                                case Consts.CASE0006.Act_Units:
                                                                    if (enabled)
                                                                    {
                                                                        Unit = "# of Units: " + entity.Units;//+ ", ";
                                                                                                             //if (!string.IsNullOrEmpty(entity.Units.Trim()))
                                                                                                             //{
                                                                                                             // phrase.Add(new Chunk(Unit, TableFont));
                                                                                                             //}
                                                                        PdfPCell unit = new PdfPCell(new Phrase(Unit, TableFont));
                                                                        unit.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                        unit.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                        unit.Colspan = 2;
                                                                        servDetails.AddCell(unit);
                                                                    }
                                                                    break;
                                                                case Consts.CASE0006.Act_Rate:
                                                                    if (enabled)
                                                                    {
                                                                        Rate = "Rate: " + entity.Rate;// + ", ";
                                                                                                      //if (!string.IsNullOrEmpty(entity.Rate.Trim()))
                                                                                                      //{
                                                                                                      //    phrase.Add(new Chunk(Rate, TableFont));
                                                                                                      //}
                                                                        PdfPCell rate = new PdfPCell(new Phrase(Rate, TableFont));
                                                                        rate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                        rate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                        rate.Colspan = 2;
                                                                        servDetails.AddCell(rate);
                                                                    }
                                                                    break;
                                                            }
                                                        }

                                                        //Amt1 = "Amount: " + entity.Amount + ", ";
                                                        //if (!string.IsNullOrEmpty(entity.Amount.Trim()))
                                                        //{
                                                        //    phrase.Add(new Chunk(Amt1, TableFont));
                                                        //}

                                                        //if (entity.Check_No != "")
                                                        //{
                                                        //    Check = "Check#: " + ("0000000000".Substring(0, 10 - entity.Check_No.Trim().Length) + entity.Check_No.Trim()) + ", ";
                                                        //    phrase.Add(new Chunk(Check, TblFontBold));
                                                        //}

                                                        //if (entity.Check_Date != "")
                                                        //{
                                                        //    CheckDte = "Check Date: " + LookupDataAccess.Getdate(entity.Check_Date).ToString() + ", ";
                                                        //    phrase.Add(new Chunk(CheckDte, TblFontBold));
                                                        //}

                                                        //if (entity.Followup_Comp != "")
                                                        //{
                                                        //    CompleteDte = "Complete Date: " + LookupDataAccess.Getdate(entity.Followup_Comp).ToString() + ", ";
                                                        //    phrase.Add(new Chunk(CompleteDte, TableFont));
                                                        //}

                                                        //by = "by: " + entity.Followup_By + ", ";
                                                        //if (!string.IsNullOrEmpty(entity.Followup_By.Trim()))
                                                        //{
                                                        //    phrase.Add(new Chunk(by, TableFont));
                                                        //}

                                                        //Program = "Program: " + Set_SP_Program_TextReport(entity.Act_PROG);
                                                        //if (!string.IsNullOrEmpty(entity.Act_PROG.Trim()))
                                                        //{
                                                        //    phrase.Add(new Chunk(Program, TableFont));
                                                        //}
                                                    }
                                                    if (CategoryCode == "01" || CategoryCode == "02" || CategoryCode == "03" || CategoryCode == "04")
                                                    {
                                                        /*if (CategoryCode == "04")
                                                        {
                                                            string Amtpaid = phraseCat4[0].ToString().Trim() == "" ? "" : phraseCat4[0].ToString();
                                                            string BundleNo = phraseCat4[1].ToString().Trim() == "" ? "" : phraseCat4[1].ToString();
                                                            string PaymentNo = phraseCat4[2].ToString().Trim() == "" ? "" : phraseCat4[2].ToString();
                                                            string CheckNo = phraseCat4[3].ToString().Trim() == "" ? "" : phraseCat4[3].ToString();
                                                            string CheckDate = phraseCat4[4].ToString().Trim() == "" ? "" : phraseCat4[4].ToString();

                                                            PdfPCell VendorName = new PdfPCell(new Phrase(Vendorname + "\n\n" + Amtpaid + "\n\n" + BundleNo + "\n" + PaymentNo + "\n" + CheckNo + "\n" + CheckDate, TableFont));
                                                            VendorName.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            VendorName.Border = iTextSharp.text.Rectangle.BOX;
                                                            table.AddCell(VendorName);
                                                        }
                                                        else
                                                        {
                                                            PdfPCell VendorName = new PdfPCell(new Phrase(Vendorname, TableFont));
                                                            VendorName.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            VendorName.Border = iTextSharp.text.Rectangle.BOX;
                                                            table.AddCell(VendorName);
                                                        }*/

                                                        if (CategoryCode == "04")
                                                        {
                                                            PdfPTable TblVendor = new PdfPTable(1);
                                                            TblVendor.TotalWidth = 150f;
                                                            TblVendor.WidthPercentage = 100;
                                                            TblVendor.LockedWidth = true;
                                                            float[] TblVenwidths = new float[] { 150f };
                                                            TblVendor.SetWidths(TblVenwidths);
                                                            TblVendor.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            TblVendor.SpacingAfter = 07f;

                                                            string Amtpaid = phraseCat4[0].ToString().Trim() == "" ? "" : phraseCat4[0].ToString();
                                                            string BundleNo = phraseCat4[1].ToString().Trim() == "" ? "" : phraseCat4[1].ToString();
                                                            string PaymentNo = phraseCat4[2].ToString().Trim() == "" ? "" : phraseCat4[2].ToString();
                                                            string CheckNo = phraseCat4[3].ToString().Trim() == "" ? "" : phraseCat4[3].ToString();
                                                            string CheckDate = phraseCat4[4].ToString().Trim() == "" ? "" : phraseCat4[4].ToString();

                                                            if (!string.IsNullOrEmpty(Vendorname))
                                                            {
                                                                PdfPCell VendorName = new PdfPCell(new Phrase(Vendorname + "\n\n", TableFont));
                                                                VendorName.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                VendorName.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                TblVendor.AddCell(VendorName);
                                                            }
                                                            else
                                                            {
                                                                PdfPCell VendorName = new PdfPCell(new Phrase(Vendorname, TableFont));
                                                                VendorName.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                VendorName.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                TblVendor.AddCell(VendorName);
                                                            }

                                                            if (!string.IsNullOrEmpty(Amtpaid))
                                                            {
                                                                PdfPCell amtpaid = new PdfPCell(new Phrase(Amtpaid + "\n\n", TableFont));
                                                                amtpaid.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                amtpaid.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                TblVendor.AddCell(amtpaid);
                                                            }
                                                            else
                                                            {
                                                                PdfPCell amtpaid = new PdfPCell(new Phrase(Amtpaid, TableFont));
                                                                amtpaid.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                amtpaid.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                TblVendor.AddCell(amtpaid);
                                                            }

                                                            PdfPCell bundleNo = new PdfPCell(new Phrase(BundleNo, TblFontBold));
                                                            bundleNo.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            bundleNo.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                            TblVendor.AddCell(bundleNo);

                                                            PdfPCell paymentNo = new PdfPCell(new Phrase(PaymentNo, TblFontBold));
                                                            paymentNo.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            paymentNo.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                            TblVendor.AddCell(paymentNo);

                                                            PdfPCell checkNo = new PdfPCell(new Phrase(CheckNo, TblFontBold));
                                                            checkNo.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            checkNo.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                            TblVendor.AddCell(checkNo);

                                                            PdfPCell checkDate = new PdfPCell(new Phrase(CheckDate, TblFontBold));
                                                            checkDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            checkDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                            TblVendor.AddCell(checkDate);

                                                            PdfPCell NestedRow = new PdfPCell(TblVendor);
                                                            NestedRow.Padding = 0f;
                                                            NestedRow.Border = iTextSharp.text.Rectangle.BOX;
                                                            NestedRow.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            table.AddCell(NestedRow);
                                                        }
                                                        else
                                                        {
                                                            PdfPCell VendorName = new PdfPCell(new Phrase(Vendorname, TableFont));
                                                            VendorName.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            VendorName.Border = iTextSharp.text.Rectangle.BOX;
                                                            table.AddCell(VendorName);
                                                        }

                                                        PdfPCell RowDate = new PdfPCell(new Phrase(CaDate, TableFont));
                                                        RowDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        RowDate.Border = iTextSharp.text.Rectangle.BOX;
                                                        table.AddCell(RowDate);

                                                        PdfPCell RowDate_Foolow = new PdfPCell(completedate);
                                                        RowDate_Foolow.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        RowDate_Foolow.Border = iTextSharp.text.Rectangle.BOX;
                                                        table.AddCell(RowDate_Foolow);

                                                        if (CategoryCode == "04")
                                                        {
                                                            PdfPCell NestedCell = new PdfPCell(servDetails);
                                                            NestedCell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            NestedCell.Border = iTextSharp.text.Rectangle.BOX;
                                                            NestedCell.NoWrap = false;
                                                            table.AddCell(NestedCell);
                                                        }
                                                        else
                                                        {
                                                            PdfPCell ServDetails = new PdfPCell(servDetails);
                                                            ServDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            ServDetails.Border = iTextSharp.text.Rectangle.BOX;
                                                            table.AddCell(ServDetails);
                                                        }
                                                    }
                                                    else
                                                    {
                                                        PdfPCell RowDate = new PdfPCell(new Phrase(CaDate, TableFont));
                                                        RowDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        RowDate.Border = iTextSharp.text.Rectangle.BOX;
                                                        table.AddCell(RowDate);

                                                        PdfPCell RowDate_Foolow = new PdfPCell(completedate);
                                                        RowDate_Foolow.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        RowDate_Foolow.Border = iTextSharp.text.Rectangle.BOX;
                                                        table.AddCell(RowDate_Foolow);

                                                        PdfPCell NestedCell = new PdfPCell(servDetails);
                                                        NestedCell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        NestedCell.Border = iTextSharp.text.Rectangle.BOX;
                                                        NestedCell.Colspan = 2;
                                                        NestedCell.NoWrap = false;
                                                        table.AddCell(NestedCell);

                                                        //PdfPCell ServDetails = new PdfPCell(phrase);
                                                        //ServDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        //ServDetails.Colspan = 2;
                                                        //ServDetails.Border = iTextSharp.text.Rectangle.BOX;
                                                        //table.AddCell(ServDetails);
                                                    }

                                                }
                                            }
                                            else
                                            {
                                                PdfPCell VendorName = new PdfPCell(new Phrase("", TableFont));
                                                VendorName.HorizontalAlignment = Element.ALIGN_LEFT;
                                                VendorName.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(VendorName);

                                                PdfPCell RowDate = new PdfPCell(new Phrase("", TableFont));
                                                RowDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                RowDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(RowDate);

                                                PdfPCell RowDate_Foolow = new PdfPCell(new Phrase("", TableFont));
                                                RowDate_Foolow.HorizontalAlignment = Element.ALIGN_LEFT;
                                                RowDate_Foolow.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(RowDate_Foolow);

                                                PdfPCell ServDetails = new PdfPCell(new Phrase("", TableFont));
                                                ServDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                ServDetails.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(ServDetails);
                                            }

                                        }
                                        else
                                        {
                                            PdfPCell topline = new PdfPCell(new Phrase("", TblFontBold));
                                            topline.HorizontalAlignment = Element.ALIGN_LEFT;
                                            topline.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                            topline.FixedHeight = 15f;
                                            topline.Colspan = 4;
                                            table.AddCell(topline);

                                            PdfPCell ServicesDesc = new PdfPCell(new Phrase("Service: ", Sideheading));
                                            ServicesDesc.HorizontalAlignment = Element.ALIGN_LEFT;
                                            ServicesDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(ServicesDesc);

                                            PdfPCell RowDesc = new PdfPCell(new Phrase(CAMSDesc.Trim(), TblFontBold));
                                            RowDesc.HorizontalAlignment = Element.ALIGN_LEFT;
                                            RowDesc.Colspan = 3;
                                            RowDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(RowDesc);

                                            PdfPCell bottomline = new PdfPCell(new Phrase("", TblFontBold));
                                            bottomline.HorizontalAlignment = Element.ALIGN_LEFT;
                                            bottomline.Colspan = 4;
                                            bottomline.Border = iTextSharp.text.Rectangle.TOP_BORDER;
                                            table.AddCell(bottomline);

                                        }
                                    }
                                }
                                else
                                {
                                    if (isoutcome)
                                    {
                                        PdfPCell ServicesHeader = new PdfPCell(new Phrase("", fc1));
                                        ServicesHeader.HorizontalAlignment = Element.ALIGN_CENTER;
                                        ServicesHeader.Colspan = 4;
                                        ServicesHeader.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(ServicesHeader);

                                        ServicesHeader = new PdfPCell(new Phrase("Outcomes", fc1));
                                        ServicesHeader.HorizontalAlignment = Element.ALIGN_CENTER;
                                        ServicesHeader.Colspan = 4;
                                        ServicesHeader.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(ServicesHeader);

                                        isoutcome = false;
                                    }
                                    //string Priv_Cams_Desc = null;
                                    DataSet MSMast = DatabaseLayer.SPAdminDB.Browse_MSMAST(null, dr["sp2_cams_code"].ToString().Trim(), null, null, null);

                                    if (MSMast.Tables[0].Rows.Count > 0)
                                    {
                                        DataRow drMSMast = MSMast.Tables[0].Rows[0];

                                        CAMSDesc = drMSMast["MS_DESC"].ToString();
                                        string MSType = drMSMast["MS_TYPE"].ToString();
                                        string Type_Desc = string.Empty;
                                        //if (MSType == "M")
                                        //    Type_Desc = "Milestone";
                                        //else
                                        Type_Desc = "Outcome";

                                        /*Search_MS_Details.Agency = BaseForm.BaseAgency;
                                        Search_MS_Details.Dept = BaseForm.BaseDept;
                                        Search_MS_Details.Program = BaseForm.BaseProg;
                                        //Search_MS_Details.Year = BaseYear;
                                        Search_MS_Details.Year = Entity.year;                              // Year will be always Four-Spaces in CASEMS
                                        Search_MS_Details.App_no = BaseForm.BaseApplicationNo;
                                        Search_MS_Details.MS_Code = dr["sp2_cams_code"].ToString().Trim();
                                        Search_MS_Details.SPM_Seq = Entity.Seq;

                                        Search_MS_Details.Service_plan = Entity.service_plan;
                                        Search_MS_Details.Branch = Branch.Trim(); Search_MS_Details.Group = dr["sp2_orig_grp"].ToString().Trim();
                                        Search_MS_Details.ID = Search_MS_Details.Date = Search_MS_Details.CaseWorker = Search_MS_Details.Site = null;
                                        Search_MS_Details.Result = Search_MS_Details.OBF = Search_MS_Details.Add_Operator = null;
                                        Search_MS_Details.Lstc_Date = Search_MS_Details.Lsct_Operator = Search_MS_Details.Add_Date = Search_MS_Details.Bulk =
                                        Search_MS_Details.Acty_PROG = Search_MS_Details.Curr_Grp = null;

                                        //SP_MS_Details = _model.SPAdminData.Browse_CASEMS(Search_MS_Details, "Browse");
                                        //SP_MS_Details = SP_MS_Details.OrderByDescending(u => Convert.ToDateTime(u.Date.Trim())).ToList();*/

                                        List<CASEMSEntity> SelOutcomes = SP_MS_Details.FindAll(u => u.MS_Code.Trim() == dr["sp2_cams_code"].ToString().Trim());

                                        if (SelOutcomes.Count > 0)
                                        {

                                            PdfPCell ServicesDesc = new PdfPCell(new Phrase("Outcome: ", Sideheading));
                                            ServicesDesc.HorizontalAlignment = Element.ALIGN_LEFT; ServicesDesc.FixedHeight = 20f;
                                            ServicesDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(ServicesDesc);

                                            PdfPCell RowDesc = new PdfPCell(new Phrase(CAMSDesc.Trim(), TblFontBold));
                                            RowDesc.HorizontalAlignment = Element.ALIGN_LEFT;
                                            RowDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            RowDesc.Colspan = 3; RowDesc.FixedHeight = 20f;
                                            table.AddCell(RowDesc);
                                            Priv_Cams_Desc = CAMSDesc.Trim();

                                            PdfPCell VendorCol = new PdfPCell(new Phrase("Result", TblFontBold));
                                            VendorCol.HorizontalAlignment = Element.ALIGN_LEFT;
                                            VendorCol.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            VendorCol.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                            VendorCol.BorderWidthBottom = 0.7f;
                                            table.AddCell(VendorCol);

                                            PdfPCell ServiceDate = new PdfPCell(new Phrase("Outcome Date", TblFontBold));
                                            ServiceDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                            ServiceDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            ServiceDate.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                            ServiceDate.BorderWidthBottom = 0.7f;
                                            table.AddCell(ServiceDate);

                                            PdfPCell FollowUpDate = new PdfPCell(new Phrase("FollowUp", TblFontBold));
                                            FollowUpDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                            FollowUpDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            FollowUpDate.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                            FollowUpDate.BorderWidthBottom = 0.7f;
                                            table.AddCell(FollowUpDate);

                                            PdfPCell OutcomeDetails = new PdfPCell(new Phrase("Outcome Details", TblFontBold));
                                            OutcomeDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                            OutcomeDetails.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            OutcomeDetails.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                            OutcomeDetails.BorderWidthBottom = 0.7f;
                                            table.AddCell(OutcomeDetails);
                                            Priv_Branch = Branch;
                                            First = false;

                                            if (SelOutcomes.Count > 0)
                                            {
                                                foreach (CASEMSEntity entity in SelOutcomes)
                                                {
                                                    Phrase phrase = new Phrase();
                                                    Phrase completedate = new Phrase();
                                                    PdfPTable outDetails = new PdfPTable(2);
                                                    string strType = CommonFunctions.FollowupIndicatior(entity.MS_FUP_Date);
                                                    CaDate = LookupDataAccess.Getdate(entity.Date).ToString();

                                                    if (entity.MS_Comp_Date != "")
                                                    {
                                                        CaDate_Follow_on = LookupDataAccess.Getdate(entity.MS_FUP_Date).ToString();
                                                        completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                    }
                                                    else if (entity.MS_FUP_Date != "" && entity.MS_Comp_Date == "" && strType == "R")
                                                    {
                                                        CaDate_Follow_on = LookupDataAccess.Getdate(entity.MS_FUP_Date).ToString();
                                                        completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                        completedate.Add(new Chunk("!", TableFontRed));
                                                    }
                                                    else if (entity.MS_FUP_Date != "" && entity.MS_Comp_Date == "" && strType == "Y")
                                                    {
                                                        CaDate_Follow_on = LookupDataAccess.Getdate(entity.MS_FUP_Date).ToString();
                                                        completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                        completedate.Add(new Chunk("!", TableFontYellow));
                                                    }

                                                    outDetails.TotalWidth = 240f;
                                                    outDetails.WidthPercentage = 100;
                                                    outDetails.LockedWidth = true;
                                                    float[] serwidths = new float[] { 90f, 150f };
                                                    outDetails.SetWidths(serwidths);
                                                    outDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    outDetails.SpacingAfter = 07f;

                                                    CaseWorker = "Case Worker: " + GetWorkerName(entity.CaseWorker);// + ", ";
                                                                                                                    //if (!string.IsNullOrEmpty(entity.CaseWorker.Trim()))
                                                                                                                    //{
                                                                                                                    //**phrase.Add(new Chunk(CaseWorker, TableFont));

                                                    PdfPCell wrker = new PdfPCell(new Phrase(CaseWorker, TableFont));
                                                    wrker.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    wrker.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    wrker.Colspan = 2;
                                                    outDetails.AddCell(wrker);
                                                    //}


                                                    Site = "Site: " + GetSiteName(entity.Site);// + ", ";
                                                                                               //if (!string.IsNullOrEmpty(entity.Site.Trim()))
                                                                                               //{
                                                                                               //**phrase.Add(new Chunk(Site, TableFont));

                                                    PdfPCell site = new PdfPCell(new Phrase(Site, TableFont));
                                                    site.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    site.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    site.Colspan = 2;
                                                    outDetails.AddCell(site);
                                                    //}

                                                    //if (entity.MS_Comp_Date != "")
                                                    //{
                                                    CompleteDte = "Complete Date: " + LookupDataAccess.Getdate(entity.MS_Comp_Date).ToString();// + ", ";
                                                                                                                                               //**phrase.Add(new Chunk(CompleteDte, TableFont));

                                                    PdfPCell cmpDte = new PdfPCell(new Phrase(CompleteDte, TableFont));
                                                    cmpDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    cmpDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    cmpDte.Colspan = 2;
                                                    outDetails.AddCell(cmpDte);
                                                    //}

                                                    Program = "Program: " + Set_SP_Program_TextReport(entity.Acty_PROG);
                                                    //if (!string.IsNullOrEmpty(entity.Acty_PROG.Trim()))
                                                    //{
                                                    //**phrase.Add(new Chunk(Program, TableFont));

                                                    PdfPCell progrm = new PdfPCell(new Phrase(Program, TableFont));
                                                    progrm.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    progrm.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    progrm.Colspan = 2;
                                                    outDetails.AddCell(progrm);
                                                    //}

                                                    PdfPCell RowDate_Result = new PdfPCell(new Phrase(MsResultDescription(entity.Result.Trim()), TableFont));
                                                    RowDate_Result.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    RowDate_Result.Border = iTextSharp.text.Rectangle.BOX;
                                                    table.AddCell(RowDate_Result);

                                                    PdfPCell RowDate = new PdfPCell(new Phrase(CaDate, TableFont));
                                                    RowDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    RowDate.Border = iTextSharp.text.Rectangle.BOX;
                                                    table.AddCell(RowDate);

                                                    PdfPCell RowDate_Foolow = new PdfPCell(completedate);
                                                    RowDate_Foolow.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    RowDate_Foolow.Border = iTextSharp.text.Rectangle.BOX;
                                                    table.AddCell(RowDate_Foolow);

                                                    PdfPCell ServDetails = new PdfPCell(outDetails);//(phrase);
                                                    ServDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    ServDetails.Border = iTextSharp.text.Rectangle.BOX;
                                                    table.AddCell(ServDetails);

                                                }
                                            }
                                            else
                                            {
                                                PdfPCell RowDate_Result = new PdfPCell(new Phrase("", TableFont));
                                                RowDate_Result.HorizontalAlignment = Element.ALIGN_LEFT;
                                                RowDate_Result.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(RowDate_Result);

                                                PdfPCell RowDate = new PdfPCell(new Phrase("", TableFont));
                                                RowDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                RowDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(RowDate);

                                                PdfPCell RowDate_Foolow = new PdfPCell(new Phrase("", TableFont));
                                                RowDate_Foolow.HorizontalAlignment = Element.ALIGN_LEFT;
                                                RowDate_Foolow.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(RowDate_Foolow);

                                                OutcomeDetails = new PdfPCell(new Phrase("", TableFont));
                                                OutcomeDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                OutcomeDetails.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(OutcomeDetails);
                                            }
                                        }
                                        else
                                        {
                                            PdfPCell topline = new PdfPCell(new Phrase("", TblFontBold));
                                            topline.HorizontalAlignment = Element.ALIGN_LEFT;
                                            topline.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                            topline.FixedHeight = 15f;
                                            topline.Colspan = 4;
                                            table.AddCell(topline);

                                            PdfPCell ServicesDesc = new PdfPCell(new Phrase("Outcome: ", Sideheading));
                                            ServicesDesc.HorizontalAlignment = Element.ALIGN_LEFT;
                                            ServicesDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(ServicesDesc);

                                            PdfPCell RowDesc = new PdfPCell(new Phrase(CAMSDesc.Trim(), TblFontBold));
                                            RowDesc.HorizontalAlignment = Element.ALIGN_LEFT;
                                            RowDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            RowDesc.Colspan = 3;
                                            table.AddCell(RowDesc);
                                            Priv_Cams_Desc = CAMSDesc.Trim();

                                            PdfPCell bottomline = new PdfPCell(new Phrase("", TblFontBold));
                                            bottomline.HorizontalAlignment = Element.ALIGN_LEFT;
                                            bottomline.Colspan = 4;
                                            bottomline.Border = iTextSharp.text.Rectangle.TOP_BORDER;
                                            table.AddCell(bottomline);
                                        }
                                    }
                                }
                            }
                        }
                        else
                        {
                            First = false;

                            PdfPCell SP_Desc_Header = new PdfPCell(new Phrase("Service Plan: " + SP_Desc.Trim(), fc1));
                            SP_Desc_Header.HorizontalAlignment = Element.ALIGN_CENTER;
                            SP_Desc_Header.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            SP_Desc_Header.Colspan = 4;
                            topTable.AddCell(SP_Desc_Header);

                        }
                        i++;
                    }

                }
                if (topTable.Rows.Count > 0)
                {
                    document.Add(Header);
                    document.Add(topTable);
                    if (table.Rows.Count > 0)
                        document.Add(table);
                }
            }
            else
            {
                PdfContentByte cb = writer.DirectContent;
                cb.BeginText();
                cb.SetFontAndSize(FontFactory.GetFont(FontFactory.TIMES).BaseFont, 15);
                cb.SetColorFill(BaseColor.RED);
                cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, "Services plans are not defined", 300, 650, 0);
                cb.EndText();
            }

            document.Close();
            fs.Close();
            fs.Dispose();
        }


        //private void CaseSpmPdf()
        //{
        //    Random_Filename = null;

        //    PdfName = "S" + BaseForm.BaseApplicationNo.ToString();//form.GetFileName();
        //    PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
        //    try
        //    {
        //        if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
        //        { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
        //    }
        //    catch (Exception ex)
        //    {
        //        CommonFunctions.MessageBoxDisplay("Error");
        //    }


        //    try
        //    {
        //        string Tmpstr = PdfName + ".pdf";
        //        if (File.Exists(Tmpstr))
        //            File.Delete(Tmpstr);
        //    }
        //    catch (Exception ex)
        //    {
        //        int length = 8;
        //        string newFileName = System.Guid.NewGuid().ToString();
        //        newFileName = newFileName.Replace("-", string.Empty);

        //        Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
        //    }

        //    if (!string.IsNullOrEmpty(Random_Filename))
        //        PdfName = Random_Filename;
        //    else
        //        PdfName += ".pdf";

        //    FileStream fs = new FileStream(PdfName, FileMode.Create);

        //    Document document = new Document(PageSize.A4, 25, 25, 30, 30);
        //    PdfWriter writer = PdfWriter.GetInstance(document, fs);
        //    document.Open();

        //    cb = writer.DirectContent;

        //    BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
        //    iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
        //    BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
        //    iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(1, 9, 4);
        //    BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

        //    iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
        //    iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
        //    iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
        //    iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(1, 9, 1);
        //    iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
        //    iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);

        //    PdfPTable SPMTable = new PdfPTable(5);
        //    SPMTable.TotalWidth = 550f;
        //    SPMTable.WidthPercentage = 100;
        //    SPMTable.LockedWidth = true;
        //    float[] widths2 = new float[] { 15f, 70f, 40f, 35f, 20f };
        //    SPMTable.SetWidths(widths2);
        //    SPMTable.HorizontalAlignment = Element.ALIGN_CENTER;

        //    string ProgramName = string.Empty;
        //    if (programEntity != null)
        //        ProgramName = programEntity.HirarchyName;

        //    PdfPCell H1 = new PdfPCell(new Phrase("Hierarchy:" + CASEMSTList[0].ApplAgency + "-" + CASEMSTList[0].ApplDept + "-" + CASEMSTList[0].ApplProgram + " " + CASEMSTList[0].ApplYr + "  " + ProgramName, TblFontBold));
        //    H1.HorizontalAlignment = Element.ALIGN_LEFT;
        //    H1.Colspan = 2;
        //    H1.FixedHeight = 15f;
        //    H1.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    SPMTable.AddCell(H1);

        //    PdfPCell H2 = new PdfPCell(new Phrase("App:" + CASEMSTList[0].ApplNo + "  " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), TblFontBold));
        //    H2.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    H2.Colspan = 3;
        //    H2.FixedHeight = 15f;
        //    H2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    SPMTable.AddCell(H2);

        //    PdfPCell S2 = new PdfPCell(new Phrase("", TblFontBold));
        //    S2.HorizontalAlignment = Element.ALIGN_CENTER;
        //    S2.Colspan = 5;
        //    S2.FixedHeight = 15f;
        //    S2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    SPMTable.AddCell(S2);

        //    PdfPCell Header = new PdfPCell(new Phrase("Service Plans", TblFontBold));
        //    Header.HorizontalAlignment = Element.ALIGN_CENTER;
        //    Header.Colspan = 5;
        //    Header.FixedHeight = 15f;
        //    Header.Border = iTextSharp.text.Rectangle.BOX;
        //    SPMTable.AddCell(Header);

        //    string[] HeaderSeq = { "Code", "Description", "Site", "CaseWorker", "Start Date" };
        //    for (int i = 0; i < HeaderSeq.Length; ++i)
        //    {
        //        PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
        //        cell.HorizontalAlignment = Element.ALIGN_CENTER;
        //        //cell.FixedHeight = 15f;
        //        cell.Border = iTextSharp.text.Rectangle.BOX;
        //        SPMTable.AddCell(cell);
        //    }

        //    bool first = false;
        //    foreach (CASESPMEntity Entity in spmlist)
        //    {
        //        if (first)
        //        {
        //            PdfPCell Header1 = new PdfPCell(new Phrase("Service Plan", TblFontBold));
        //            Header1.HorizontalAlignment = Element.ALIGN_CENTER;
        //            Header1.Colspan = 5;
        //            Header1.FixedHeight = 15f;
        //            Header1.Border = iTextSharp.text.Rectangle.BOX;
        //            SPMTable.AddCell(Header1);

        //            string[] HeaderSeq1 = { "Code", "Description", "Site", "CaseWorker", "Start Date" };
        //            for (int i = 0; i < HeaderSeq1.Length; ++i)
        //            {
        //                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq1[i], TblFontBold));
        //                cell.HorizontalAlignment = Element.ALIGN_CENTER;
        //                //cell.FixedHeight = 15f;
        //                cell.Border = iTextSharp.text.Rectangle.BOX;
        //                SPMTable.AddCell(cell);
        //            }
        //        }


        //        PdfPCell A1 = new PdfPCell(new Phrase(Entity.service_plan, TableFont));
        //        A1.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A1.Border = iTextSharp.text.Rectangle.BOX;
        //        SPMTable.AddCell(A1);

        //        PdfPCell A2 = new PdfPCell(new Phrase(Entity.Sp0_Desc, TableFont));
        //        A2.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A2.Border = iTextSharp.text.Rectangle.BOX;
        //        SPMTable.AddCell(A2);

        //        PdfPCell A3 = new PdfPCell(new Phrase(Entity.Site_Desc, TableFont));
        //        A3.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A3.Border = iTextSharp.text.Rectangle.BOX;
        //        SPMTable.AddCell(A3);

        //        PdfPCell A4 = new PdfPCell(new Phrase(Get_CaseWorker_DESC(Entity.caseworker), TableFont));
        //        A4.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A4.Border = iTextSharp.text.Rectangle.BOX;
        //        SPMTable.AddCell(A4);

        //        PdfPCell A5 = new PdfPCell(new Phrase(LookupDataAccess.Getdate(Entity.startdate.Trim()), TableFont));
        //        A5.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A5.Border = iTextSharp.text.Rectangle.BOX;
        //        SPMTable.AddCell(A5);


        //        if (SPMTable.Rows.Count > 0)
        //        {
        //            document.Add(SPMTable);
        //            SPMTable.DeleteBodyRows();
        //        }
        //        if (actList.Count > 0)
        //        {
        //            SP_Programs_List = _model.lookupDataAccess.Get_SerPlan_Prog_List(BaseForm.UserProfile.UserID, Entity.service_plan, string.Empty);

        //            List<CASEACTEntity> SelActList = actList.FindAll(u => u.Service_plan.Equals(Entity.service_plan) && u.SPM_Seq.Equals(Entity.Seq));
        //            SelActList = SelActList.OrderBy(u => u.Service_plan).ThenBy(u => u.SPM_Seq).ThenBy(u => u.Branch).ThenBy(u => u.Group).ThenBy(u => u.ACT_Code).ToList();

        //            if (SelActList.Count > 0) CASEACTPdf(document, SelActList);

        //            List<CASEMSEntity> SelMSList = MSlist.FindAll(u => u.Service_plan.Equals(Entity.service_plan) && u.SPM_Seq.Equals(Entity.Seq));
        //            SelMSList = SelMSList.OrderBy(u => u.Service_plan).ThenBy(u => u.SPM_Seq).ThenBy(u => u.Branch).ThenBy(u => u.Group).ThenBy(u => u.MS_Code).ToList();

        //            if (SelMSList.Count > 0) CASEMSPdf(document, SelMSList);

        //            if (SelActList.Count > 0 || SelMSList.Count > 0)
        //            {
        //                first = true;
        //            }
        //            else first = false;
        //        }

        //    }

        //    document.Add(SPMTable);

        //    document.Close();
        //    fs.Close();
        //    fs.Dispose();
        //}

        #endregion

        private void CaseSpmPdfAllHiers()
        {
            Random_Filename = null;

            PdfName = "S" + BaseForm.BaseApplicationNo.ToString();//form.GetFileName();
            PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
            try
            {
                if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
            }
            catch (Exception ex)
            {
                CommonFunctions.MessageBoxDisplay("Error");
            }


            try
            {
                string Tmpstr = PdfName + ".pdf";
                if (File.Exists(Tmpstr))
                    File.Delete(Tmpstr);
            }
            catch (Exception ex)
            {
                int length = 8;
                string newFileName = System.Guid.NewGuid().ToString();
                newFileName = newFileName.Replace("-", string.Empty);

                Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
            }

            if (!string.IsNullOrEmpty(Random_Filename))
                PdfName = Random_Filename;
            else
                PdfName += ".pdf";

            FileStream fs = new FileStream(PdfName, FileMode.Create);

            Document document = new Document(PageSize.A4, 25, 25, 30, 30);
            PdfWriter writer = PdfWriter.GetInstance(document, fs);
            document.Open();

            cb = writer.DirectContent;

            BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
            iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
            BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
            iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(bf_times, 9, 4);
            BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

            iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
            //iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
            iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
            //iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(1, 9, 1);
            iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
            iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);

            BaseFont bf_Calibri = BaseFont.CreateFont("c:/windows/fonts/calibri.ttf", BaseFont.WINANSI, BaseFont.EMBEDDED);
            BaseFont bf_Times = BaseFont.CreateFont(BaseFont.TIMES_BOLD, BaseFont.CP1250, false);
            iTextSharp.text.Font fc = new iTextSharp.text.Font(bf_Calibri, 11, 2);
            iTextSharp.text.Font fc1 = new iTextSharp.text.Font(bf_Calibri, 10, 1, new BaseColor(System.Drawing.ColorTranslator.FromHtml("#6499c1")));
            iTextSharp.text.Font Sideheading = new iTextSharp.text.Font(bf_Calibri, 10, 1, new BaseColor(System.Drawing.ColorTranslator.FromHtml("#6499c1")));
            iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_Calibri, 10);
            iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(bf_Calibri, 10, 1, BaseColor.BLACK);
            iTextSharp.text.Font TblFontBold1 = new iTextSharp.text.Font(bf_Calibri, 10.01f, 1, BaseColor.BLACK);
            iTextSharp.text.Font TblFontBold2 = new iTextSharp.text.Font(bf_Calibri, 10.02f, 1, BaseColor.BLACK);
            iTextSharp.text.Font TblFontBold3 = new iTextSharp.text.Font(bf_Calibri, 10.03f, 1, BaseColor.BLACK);
            iTextSharp.text.Font TableFontRed = new iTextSharp.text.Font(bf_Calibri, 10, 0, BaseColor.RED);
            iTextSharp.text.Font TableFontYellow = new iTextSharp.text.Font(bf_Calibri, 10, 0, BaseColor.YELLOW);

            iTextSharp.text.Font TblFont = new iTextSharp.text.Font(bf_Times, 8);
            iTextSharp.text.Font SerOutFont = new iTextSharp.text.Font(bf_Calibri, 11, 1, new BaseColor(System.Drawing.ColorTranslator.FromHtml("#6499c1")));


            PdfPTable SPMTable = new PdfPTable(5);
            SPMTable.TotalWidth = 550f;
            SPMTable.WidthPercentage = 100;
            SPMTable.LockedWidth = true;
            float[] widths2 = new float[] { 15f, 70f, 40f, 35f, 20f };
            SPMTable.SetWidths(widths2);
            SPMTable.HorizontalAlignment = Element.ALIGN_CENTER;

            if (CASEMSTList.Count > 0)
            {

                foreach (CaseMstEntity casemstEntity in CASEMSTList)
                {
                    //programEntity = _model.HierarchyAndPrograms.GetCaseDepadp(casemstEntity.ApplAgency, casemstEntity.ApplDept, casemstEntity.ApplProgram);
                    programEntity = caseHierarchy.Find(u => u.Agency.Equals(casemstEntity.ApplAgency) && u.Dept.Equals(casemstEntity.ApplDept) && u.Prog.Equals(casemstEntity.ApplProgram));

                    DataSet ds = Captain.DatabaseLayer.SPAdminDB.Browse_CASESP1(string.Empty, casemstEntity.ApplAgency, casemstEntity.ApplDept, casemstEntity.ApplProgram, string.Empty);
                    dsSite = Captain.DatabaseLayer.CaseMst.GetSiteByHIE(casemstEntity.ApplAgency, string.Empty, string.Empty);
                    //DataTable dt = new DataTable();
                    if (ds.Tables.Count > 0)
                        dtSP1 = ds.Tables[0];

                    string ProgramName = string.Empty;
                    if (programEntity != null)
                        ProgramName = programEntity.HirarchyName;

                    SelSnp = casesnpList.Find(u => u.App.Equals(casemstEntity.ApplNo) && u.FamilySeq.Equals(casemstEntity.FamilySeq));
                    Fill_CaseWorker(casemstEntity.ApplAgency, casemstEntity.ApplDept, casemstEntity.ApplProgram, casemstEntity.ApplYr);


                    ProgramDefinitionEntity programEntity1 = _model.HierarchyAndPrograms.GetCaseDepadp(casemstEntity.ApplAgency, casemstEntity.ApplDept, casemstEntity.ApplProgram);
                    if (programEntity1 != null)
                        CategoryCode = programEntity1.DepSerpostPAYCAT.Trim();

                    if (string.IsNullOrEmpty(CategoryCode.Trim()))
                    {

                        if (PPC_List.Count > 0)
                        {
                            PPC_List = PPC_List.FindAll(u => u.Ext_1 != "");
                            if (PPC_List.Count > 0)
                            {
                                foreach (Agy_Ext_Entity Entity in PPC_List)
                                {
                                    if (!string.IsNullOrEmpty(Entity.Ext_1.Trim()))
                                    {
                                        if (BaseForm.BaseAgency == Entity.Ext_1.Substring(0, 2))
                                        {
                                            CategoryCode = Entity.Code.Trim();
                                        }
                                    }
                                }
                            }

                        }


                    }


                    List<CASESPMEntity> SelSpmList = spmlist.FindAll(u => u.agency.Equals(casemstEntity.ApplAgency) && u.dept.Equals(casemstEntity.ApplDept) && u.program.Equals(casemstEntity.ApplProgram) && u.year.Trim().Equals(casemstEntity.ApplYr) && u.app_no.Equals(casemstEntity.ApplNo));

                    if (SelSpmList.Count > 0)
                    {
                        /******************************* Head  1 ********************************************/
                        PdfPTable Header = new PdfPTable(2);
                        Header.TotalWidth = 510f;
                        Header.WidthPercentage = 100;
                        Header.LockedWidth = true;
                        float[] Headerwidths = new float[] { 50f, 17f };
                        Header.SetWidths(Headerwidths);
                        Header.HorizontalAlignment = Element.ALIGN_CENTER;
                        Header.SpacingAfter = 07f;

                        PdfPCell AppName = new PdfPCell(new Phrase("Applicant Name: " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), fc1));
                        AppName.HorizontalAlignment = Element.ALIGN_LEFT;
                        AppName.Border = iTextSharp.text.Rectangle.NO_BORDER;
                        Header.AddCell(AppName);

                        PdfPCell Application = new PdfPCell(new Phrase("App#: " + casemstEntity.ApplNo, fc1));
                        Application.HorizontalAlignment = Element.ALIGN_RIGHT;
                        Application.Border = iTextSharp.text.Rectangle.NO_BORDER;
                        Header.AddCell(Application);

                        PdfPCell hIER = new PdfPCell(new Phrase("Intake Hierarchy: " + CASEMSTList[0].ApplAgency + "-" + CASEMSTList[0].ApplDept + "-" + CASEMSTList[0].ApplProgram + " " + CASEMSTList[0].ApplYr + "  " + ProgramName, fc1));
                        hIER.HorizontalAlignment = Element.ALIGN_RIGHT;
                        hIER.Border = iTextSharp.text.Rectangle.NO_BORDER;
                        hIER.Colspan = 2;
                        Header.AddCell(hIER);

                        /***************************************************************************/

                        //PdfPCell H1 = new PdfPCell(new Phrase("Hierarchy:" + casemstEntity.ApplAgency + "-" + casemstEntity.ApplDept + "-" + casemstEntity.ApplProgram + " " + casemstEntity.ApplYr + "  " + ProgramName, TblFontBold));
                        //H1.HorizontalAlignment = Element.ALIGN_LEFT;
                        //H1.Colspan = 2;
                        //H1.FixedHeight = 15f;
                        //H1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                        //SPMTable.AddCell(H1);

                        //PdfPCell H2 = new PdfPCell(new Phrase("App:" + casemstEntity.ApplNo + "  " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), TblFontBold));
                        //H2.HorizontalAlignment = Element.ALIGN_RIGHT;
                        //H2.Colspan = 3;
                        //H2.FixedHeight = 15f;
                        //H2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                        //SPMTable.AddCell(H2);

                        //PdfPCell S2 = new PdfPCell(new Phrase("", TblFontBold));
                        //S2.HorizontalAlignment = Element.ALIGN_CENTER;
                        //S2.Colspan = 5;
                        //S2.FixedHeight = 15f;
                        //S2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                        //SPMTable.AddCell(S2);

                        //PdfPCell Header = new PdfPCell(new Phrase("Service Plans", TblFontBold));
                        //Header.HorizontalAlignment = Element.ALIGN_CENTER;
                        //Header.Colspan = 5;
                        //Header.FixedHeight = 15f;
                        //Header.Border = iTextSharp.text.Rectangle.BOX;
                        //SPMTable.AddCell(Header);

                        //string[] HeaderSeq = { "Code", "Description", "Site", "CaseWorker", "Start Date" };
                        //for (int i = 0; i < HeaderSeq.Length; ++i)
                        //{
                        //    PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                        //    cell.HorizontalAlignment = Element.ALIGN_CENTER;
                        //    //cell.FixedHeight = 15f;
                        //    cell.Border = iTextSharp.text.Rectangle.BOX;
                        //    SPMTable.AddCell(cell);
                        //}

                        PdfPTable topTable = new PdfPTable(4);
                        topTable.TotalWidth = 510f;
                        topTable.WidthPercentage = 100;
                        topTable.LockedWidth = true;
                        float[] widths1 = new float[] { 100f, 10f, 110f, 60f };
                        topTable.SetWidths(widths1);
                        topTable.HorizontalAlignment = Element.ALIGN_CENTER;

                        PdfPTable table = new PdfPTable(4);
                        table.TotalWidth = 515f;
                        table.WidthPercentage = 100;
                        table.LockedWidth = true;
                        float[] widths = new float[] { 50f, 25f, 25f, 90f };
                        table.SetWidths(widths);
                        table.HorizontalAlignment = Element.ALIGN_CENTER;

                        string Year = null;
                        if (!string.IsNullOrEmpty(BaseForm.BaseYear.Trim()))
                            Year = BaseForm.BaseYear;

                        int X_Pos, Y_Pos;

                        DataSet dsSP_CaseSP2 = new DataSet(); DataTable dtSP_CaseSP2 = new DataTable();
                        string CAMSDesc = null; string CaDate = null; string CaDate_Follow_on = null;
                        string SerVicePlan = null, Priv_ServicePlan = null; string SP_Desc = null;
                        bool First = true; string Desc = null; string Branch = null, Priv_Branch = null, SP_Plan_desc = null;

                        string Vendorname = null, Source = null, BillingName = null, Account = null, BenefitReason = null, SupApproval = null, PrePayApproval = null, SentForPay = null, BillPeriod = null,
                        Fund1 = null, Fund2 = null, Fund3 = null, Budget = null,
                        UOM1 = null, UOM2 = null, UOM3 = null,
                        Amt1 = null, Amt2 = null, Amt3 = null, Cost = null, ArrearAmt = null, Total = null, Unit = null, Rate = null,
                        Bundle = null, Payment = null, Check = null, by = null,
                        Site = null, CaseWorker = null, Program = null,
                        CheckDte = null, CompleteDte = null, ServiceReqDte = null, Date1 = null, Date2 = null, DateOn = null;
                        string Service_desc = null;
                        string CAMSType = null; string Priv_Cams_Desc = null;
                        string PrivSource = string.Empty;

                        if (BaseForm.BaseAgencyControlDetails.ServicePlanHiecontrol == "Y")
                        {
                            List<CASESPMEntity> SPM_list = new List<CASESPMEntity>();
                            if (Service_Hierarchies.Count > 0)
                            {
                                foreach (CASESP1Entity SP1e in Service_Hierarchies)
                                {
                                    List<CASESPMEntity> SPMEntity = SelSpmList.FindAll(u => u.service_plan.Trim() == SP1e.Code.Trim());
                                    if (SPMEntity.Count > 0)
                                        SPM_list.AddRange(SPMEntity);
                                }
                            }
                            if (SPM_list.Count > 0) SelSpmList = SPM_list;
                        }

                        bool isFirstRecord = true;
                        bool isCAFirstRecord = true;


                        bool first = false;
                        foreach (CASESPMEntity Entity in SelSpmList)
                        {
                            CASEACTEntity Search_Enty = new CASEACTEntity(true);
                            Search_Enty.Agency = BaseForm.BaseAgency;
                            Search_Enty.Dept = BaseForm.BaseDept;
                            Search_Enty.Program = BaseForm.BaseProg;
                            Search_Enty.Year = Entity.year;                             // Year will be always Four-Spaces in CASEACT
                            Search_Enty.App_no = BaseForm.BaseApplicationNo;
                            Search_Enty.SPM_Seq = Entity.Seq;
                            Search_Enty.Service_plan = Entity.service_plan;

                            List<CASEACTEntity> SP_Activity_Details = _model.SPAdminData.Browse_CASEACT(Search_Enty, "Browse", "PAYMENT");
                            SP_Activity_Details = SP_Activity_Details.OrderByDescending(u => Convert.ToDateTime(u.ACT_Date.Trim())).ToList();

                            CASEMSEntity Search_EntyMS = new CASEMSEntity(true);
                            Search_EntyMS.Agency = BaseForm.BaseAgency;
                            Search_EntyMS.Dept = BaseForm.BaseDept;
                            Search_EntyMS.Program = BaseForm.BaseProg;
                            Search_EntyMS.Year = Entity.year;                              // Year will be always Four-Spaces in CASEMS
                            Search_EntyMS.App_no = BaseForm.BaseApplicationNo;
                            Search_EntyMS.SPM_Seq = Entity.Seq;
                            Search_EntyMS.Service_plan = Entity.service_plan;

                            List<CASEMSEntity> SP_MS_Details = _model.SPAdminData.Browse_CASEMS(Search_EntyMS, "Browse");
                            SP_MS_Details = SP_MS_Details.OrderByDescending(u => Convert.ToDateTime(u.Date.Trim())).ToList();

                            SerVicePlan = Entity.service_plan.ToString().Trim();
                            string Branch_SPM = Entity.sel_branches.ToString().Trim();
                            int length = Entity.sel_branches.Length;
                            DataSet dsSP_Services = DatabaseLayer.SPAdminDB.Browse_CASESP0(SerVicePlan, null, null, null, null, null, null, null, null);
                            DataRow drSP_Services = dsSP_Services.Tables[0].Rows[0];
                            SP_Desc = drSP_Services["sp0_description"].ToString().Trim();

                            //if (SPGrid.Rows.Count > 0)
                            SP_Programs_List = _model.lookupDataAccess.Get_SerPlan_Prog_List(BaseForm.UserProfile.UserID, SerVicePlan, BaseForm.BaseAgencyControlDetails.ServicePlanHiecontrol);


                            //if (SP_Activity_Details.Count > 0 || SP_MS_Details.Count > 0)
                            //{
                            for (int i = 0; i < length;)
                            {
                                // Dataset Caseactdetails = DatabaseLayer.SPAdminDB.Browse_CASEACT();
                                string Temp_Branch = Entity.sel_branches.Substring(i, 1);
                                dsSP_CaseSP2 = DatabaseLayer.SPAdminDB.Browse_CASESP2(SerVicePlan, Temp_Branch, null, null);
                                dtSP_CaseSP2 = dsSP_CaseSP2.Tables[0];

                                Priv_Branch = null; bool isoutcome = false;

                                if (dtSP_CaseSP2.Rows.Count > 0)
                                {
                                    DataView dv = dtSP_CaseSP2.DefaultView;
                                    dv.Sort = "sp2_branch DESC, sp2_type";
                                    dtSP_CaseSP2 = dv.ToTable();

                                    //**** SP Loop Startss ***///

                                    foreach (DataRow dr in dtSP_CaseSP2.Rows)
                                    {
                                        CaDate = null; CaDate_Follow_on = null;
                                        Branch = dr["sp2_branch"].ToString().Trim();
                                        CAMSType = dr["sp2_type"].ToString();


                                        /**************************************** HEADER ******************************************/

                                        if (SerVicePlan == dr["sp2_serviceplan"].ToString() && Branch != Priv_Branch)
                                        {

                                            isFirstRecord = true;
                                            isCAFirstRecord = true;

                                            if (table.Rows.Count > 0)
                                            {
                                                document.Add(Header);
                                                document.Add(topTable);
                                                document.Add(table);

                                                table.DeleteBodyRows();
                                                topTable.DeleteBodyRows();
                                            }


                                            if (!First)
                                                document.NewPage();
                                            Service_desc = drSP_Services["sp0_pbranch_desc"].ToString();
                                            if (!First)
                                            {
                                                if (Branch.Trim() == drSP_Services["sp0_branch1_code"].ToString().Trim())
                                                    Service_desc = drSP_Services["sp0_branch1_desc"].ToString();
                                                else if (Branch.Trim() == drSP_Services["sp0_branch2_code"].ToString().Trim())
                                                    Service_desc = drSP_Services["sp0_branch2_desc"].ToString();
                                                else if (Branch.Trim() == drSP_Services["sp0_branch3_code"].ToString().Trim())
                                                    Service_desc = drSP_Services["sp0_branch3_desc"].ToString();
                                                else if (Branch.Trim() == drSP_Services["sp0_branch4_code"].ToString().Trim())
                                                    Service_desc = drSP_Services["sp0_branch4_desc"].ToString();
                                                else if (Branch.Trim() == drSP_Services["sp0_branch5_code"].ToString().Trim())
                                                    Service_desc = drSP_Services["sp0_branch5_desc"].ToString();
                                            }

                                            if (isFirstRecord)
                                            {
                                                PdfPCell SP_Desc_Header = new PdfPCell(new Phrase("Service Plan: " + SP_Desc.Trim(), fc1));
                                                SP_Desc_Header.HorizontalAlignment = Element.ALIGN_CENTER;
                                                SP_Desc_Header.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                SP_Desc_Header.Colspan = 4;
                                                topTable.AddCell(SP_Desc_Header);

                                                PdfPCell topboarder = new PdfPCell(new Phrase("", TblFontBold));
                                                topboarder.HorizontalAlignment = Element.ALIGN_LEFT;
                                                topboarder.Colspan = 4;
                                                topboarder.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                                topTable.AddCell(topboarder);

                                                PdfPCell SiteDesc = new PdfPCell(new Phrase("Site: " + Entity.Site_Desc, fc1));
                                                SiteDesc.HorizontalAlignment = Element.ALIGN_LEFT;
                                                SiteDesc.Border = iTextSharp.text.Rectangle.LEFT_BORDER;
                                                topTable.AddCell(SiteDesc);

                                                PdfPCell CaseWorkerDesc = new PdfPCell(new Phrase("Case Worker: " + Get_CaseWorker_DESC(Entity.caseworker), fc1));
                                                CaseWorkerDesc.HorizontalAlignment = Element.ALIGN_LEFT;
                                                CaseWorkerDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                CaseWorkerDesc.Colspan = 2;
                                                topTable.AddCell(CaseWorkerDesc);

                                                PdfPCell SP_Desc_Date = new PdfPCell(new Phrase("Start Date: " + LookupDataAccess.Getdate(Entity.startdate.Trim()), fc1));
                                                SP_Desc_Date.HorizontalAlignment = Element.ALIGN_RIGHT;
                                                SP_Desc_Date.Border = iTextSharp.text.Rectangle.RIGHT_BORDER;
                                                topTable.AddCell(SP_Desc_Date);

                                                PdfPCell bottomboarder = new PdfPCell(new Phrase("", TblFontBold));
                                                bottomboarder.HorizontalAlignment = Element.ALIGN_LEFT;
                                                bottomboarder.Colspan = 4;
                                                bottomboarder.Border = iTextSharp.text.Rectangle.TOP_BORDER;
                                                topTable.AddCell(bottomboarder);

                                                PdfPCell ServiceDesc = new PdfPCell(new Phrase("", TblFontBold));
                                                ServiceDesc.HorizontalAlignment = Element.ALIGN_CENTER;
                                                ServiceDesc.Colspan = 4;
                                                ServiceDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                topTable.AddCell(ServiceDesc);

                                                ServiceDesc = new PdfPCell(new Phrase("Branch: " + Service_desc.Trim(), TblFontBold));
                                                ServiceDesc.HorizontalAlignment = Element.ALIGN_CENTER;
                                                ServiceDesc.Colspan = 4;
                                                ServiceDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(ServiceDesc);

                                                PdfPCell ServicesHeader = new PdfPCell(new Phrase("", fc1));
                                                ServicesHeader.HorizontalAlignment = Element.ALIGN_CENTER;
                                                ServicesHeader.Colspan = 4;
                                                ServicesHeader.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(ServicesHeader);

                                                isFirstRecord = false;
                                                isoutcome = true;
                                            }

                                            Priv_Branch = Branch; SerVicePlan = dr["sp2_serviceplan"].ToString();
                                        }

                                        /******************************************************************************************/


                                        /********************************
                                            /// Services Printing Code//////
                                            **********************************/
                                        if (CAMSType == "CA")
                                        {

                                            if (isCAFirstRecord)
                                            {
                                                PdfPCell ServicesHeader1 = new PdfPCell(new Phrase("Services", SerOutFont));
                                                ServicesHeader1.HorizontalAlignment = Element.ALIGN_CENTER;
                                                ServicesHeader1.Colspan = 4;
                                                ServicesHeader1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(ServicesHeader1);

                                                isCAFirstRecord = false;
                                            }


                                            //string Priv_Cams_Desc = null;
                                            DataSet dsCAMAST = DatabaseLayer.SPAdminDB.Browse_CAMAST(null, dr["sp2_cams_code"].ToString().Trim(), null, null);

                                            if (dsCAMAST.Tables[0].Rows.Count > 0)
                                            {
                                                DataRow drCAMAST = dsCAMAST.Tables[0].Rows[0];
                                                CAMSDesc = drCAMAST["CA_DESC"].ToString().Trim();


                                                List<CASEACTEntity> SelService = SP_Activity_Details.FindAll(u => u.ACT_Code.Trim() == dr["sp2_cams_code"].ToString().Trim());

                                                if (SelService.Count > 0)
                                                {
                                                    PdfPCell ServicesDesc = new PdfPCell(new Phrase("Service: ", Sideheading));
                                                    ServicesDesc.HorizontalAlignment = Element.ALIGN_LEFT; ServicesDesc.FixedHeight = 20f;
                                                    ServicesDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    table.AddCell(ServicesDesc);

                                                    PdfPCell RowDesc = new PdfPCell(new Phrase(CAMSDesc.Trim(), TblFontBold));
                                                    RowDesc.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    RowDesc.Colspan = 3; RowDesc.FixedHeight = 20f;
                                                    RowDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    table.AddCell(RowDesc);

                                                    //Header for Service plan
                                                    if (CategoryCode == "01" || CategoryCode == "02" || CategoryCode == "03" || CategoryCode == "04")
                                                    {
                                                        PdfPCell VendorCol = new PdfPCell(new Phrase("Vendor", TblFontBold));
                                                        VendorCol.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        VendorCol.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        VendorCol.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                        VendorCol.BorderWidthBottom = 0.7f;
                                                        table.AddCell(VendorCol);

                                                        PdfPCell ServiceDate = new PdfPCell(new Phrase("Service Date", TblFontBold));
                                                        ServiceDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        ServiceDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        ServiceDate.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                        ServiceDate.BorderWidthBottom = 0.7f;
                                                        table.AddCell(ServiceDate);

                                                        PdfPCell FollowUpDate = new PdfPCell(new Phrase("Follow-Up On", TblFontBold));
                                                        FollowUpDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        FollowUpDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        FollowUpDate.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                        FollowUpDate.BorderWidthBottom = 0.7f;
                                                        table.AddCell(FollowUpDate);

                                                        PdfPCell ServiceDetails = new PdfPCell(new Phrase("Service Details", TblFontBold));
                                                        ServiceDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        ServiceDetails.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        ServiceDetails.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                        ServiceDetails.BorderWidthBottom = 0.7f;
                                                        table.AddCell(ServiceDetails);
                                                        Priv_Branch = Branch;
                                                        First = false;
                                                    }
                                                    else
                                                    {
                                                        PdfPCell ServiceDate = new PdfPCell(new Phrase("Service Date", TblFontBold));
                                                        ServiceDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        ServiceDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        ServiceDate.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                        ServiceDate.BorderWidthBottom = 0.7f;
                                                        table.AddCell(ServiceDate);

                                                        PdfPCell FollowUpDate = new PdfPCell(new Phrase("Follow-Up On", TblFontBold));
                                                        FollowUpDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        FollowUpDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        FollowUpDate.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                        FollowUpDate.BorderWidthBottom = 0.7f;
                                                        table.AddCell(FollowUpDate);

                                                        PdfPCell ServiceDetails = new PdfPCell(new Phrase("Service Details", TblFontBold));
                                                        ServiceDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        ServiceDetails.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        ServiceDetails.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                        ServiceDetails.BorderWidthBottom = 0.7f;
                                                        ServiceDetails.Colspan = 2;
                                                        table.AddCell(ServiceDetails);
                                                        Priv_Branch = Branch;
                                                        First = false;
                                                    }

                                                    if (SelService.Count > 0)
                                                    {
                                                        foreach (CASEACTEntity entity in SelService)
                                                        {
                                                            Phrase phrase = new Phrase();
                                                            Phrase phraseCat4 = new Phrase();
                                                            PdfPTable servDetails = new PdfPTable(2);
                                                            Phrase completedate = new Phrase();
                                                            string strType = CommonFunctions.FollowupIndicatior(entity.Followup_On);
                                                            //Category 1 Service Details  
                                                            if (CategoryCode == "01")
                                                            {
                                                                Vendorname = Get_Vendor_Name(entity.Vendor_No);

                                                                CaDate = LookupDataAccess.Getdate(entity.ACT_Date).ToString();

                                                                if (entity.Followup_Comp != "")
                                                                {
                                                                    CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                    completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                }
                                                                else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "R")
                                                                {
                                                                    CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                    completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                    completedate.Add(new Chunk("!", TableFontRed));
                                                                }
                                                                else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "Y")
                                                                {
                                                                    CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                    completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                    completedate.Add(new Chunk("!", TableFontYellow));
                                                                }

                                                                servDetails.TotalWidth = 240f;
                                                                servDetails.WidthPercentage = 100;
                                                                servDetails.LockedWidth = true;
                                                                float[] serwidths = new float[] { 90f, 150f };
                                                                servDetails.SetWidths(serwidths);
                                                                servDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                servDetails.SpacingAfter = 07f;

                                                                //if (entity.ActSeek_Date != "")
                                                                //{
                                                                ServiceReqDte = "Service Requested Date: " + LookupDataAccess.Getdate(entity.ActSeek_Date).ToString();// + ", ";
                                                                //phrase.Add(new Chunk(ServiceReqDte, TableFont));
                                                                //}
                                                                PdfPCell ServReqDte = new PdfPCell(new Phrase(ServiceReqDte, TableFont));
                                                                ServReqDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                ServReqDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                ServReqDte.Colspan = 2;
                                                                servDetails.AddCell(ServReqDte);

                                                                CaseWorker = "Case Worker: " + GetWorkerName(entity.Caseworker);// + ", ";
                                                                                                                                //if (!string.IsNullOrEmpty(entity.Caseworker.Trim()))
                                                                                                                                // phrase.Add(new Chunk(CaseWorker, TableFont));
                                                                PdfPCell caseWorker = new PdfPCell(new Phrase(CaseWorker, TableFont));
                                                                caseWorker.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                caseWorker.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                caseWorker.Colspan = 2;
                                                                servDetails.AddCell(caseWorker);

                                                                Site = "Site: " + GetSiteName(entity.Site);// + ", ";
                                                                                                           //if (!string.IsNullOrEmpty(entity.Site.Trim()))
                                                                                                           // phrase.Add(new Chunk(Site, TableFont));
                                                                PdfPCell site = new PdfPCell(new Phrase(Site, TableFont));
                                                                site.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                site.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                site.Colspan = 2;
                                                                servDetails.AddCell(site);

                                                                Fund1 = "Fund: " + GetFundName(entity.Fund1);// + ", ";
                                                                                                             //if (!string.IsNullOrEmpty(entity.Fund1.Trim()))
                                                                                                             //{
                                                                                                             //    phrase.Add(new Chunk(Fund1, TableFont));
                                                                                                             //}
                                                                PdfPCell fund1 = new PdfPCell(new Phrase(Fund1, TableFont));
                                                                fund1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                fund1.Colspan = 2;
                                                                servDetails.AddCell(fund1);

                                                                Fund2 = "Fund 2: " + GetFundName(entity.Fund2);// + ", ";
                                                                                                               //if (!string.IsNullOrEmpty(entity.Fund2.Trim()))
                                                                                                               //{
                                                                                                               //    phrase.Add(new Chunk(Fund2, TableFont));
                                                                                                               //}
                                                                PdfPCell fund2 = new PdfPCell(new Phrase(Fund2, TableFont));
                                                                fund2.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                fund2.Colspan = 2;
                                                                servDetails.AddCell(fund2);

                                                                Fund3 = "Fund 3: " + GetFundName(entity.Fund3);// + ", ";
                                                                                                               //if (!string.IsNullOrEmpty(entity.Fund3.Trim()))
                                                                                                               //{
                                                                                                               //    phrase.Add(new Chunk(Fund3, TableFont));
                                                                                                               //}
                                                                PdfPCell fund3 = new PdfPCell(new Phrase(Fund3, TableFont));
                                                                fund3.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                fund3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                fund3.Colspan = 2;
                                                                servDetails.AddCell(fund3);

                                                                UOM1 = "UOM: " + GetUOMName(entity.UOM);// + ", ";
                                                                                                        //if (!string.IsNullOrEmpty(entity.UOM.Trim()))
                                                                                                        //{
                                                                                                        //    phrase.Add(new Chunk(UOM1, TableFont));
                                                                                                        //}
                                                                PdfPCell uom1 = new PdfPCell(new Phrase(UOM1, TableFont));
                                                                uom1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                uom1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                uom1.Colspan = 2;
                                                                servDetails.AddCell(uom1);

                                                                Unit = "# of Units: " + entity.Units;// + ", ";
                                                                                                     //if (!string.IsNullOrEmpty(entity.Units.Trim()))
                                                                                                     //{
                                                                                                     //    phrase.Add(new Chunk(Unit, TableFont));
                                                                                                     //}
                                                                PdfPCell unit = new PdfPCell(new Phrase(Unit, TableFont));
                                                                unit.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                unit.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                unit.Colspan = 2;
                                                                servDetails.AddCell(unit);

                                                                Amt1 = "Amount: " + entity.Amount;//+ ", ";
                                                                                                  //if (!string.IsNullOrEmpty(entity.Amount.Trim()))
                                                                                                  //{
                                                                                                  //    phrase.Add(new Chunk(Amt1, TableFont));
                                                                                                  //}
                                                                PdfPCell amt1 = new PdfPCell(new Phrase(Amt1, TableFont));
                                                                amt1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                amt1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                amt1.Colspan = 2;
                                                                servDetails.AddCell(amt1);

                                                                Rate = "Rate: " + entity.Rate;// + ", ";
                                                                                              //if (!string.IsNullOrEmpty(entity.Rate.Trim()))
                                                                                              //{
                                                                                              //    phrase.Add(new Chunk(Rate, TableFont));
                                                                                              //}
                                                                PdfPCell rate = new PdfPCell(new Phrase(Rate, TableFont));
                                                                rate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                rate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                rate.Colspan = 2;
                                                                servDetails.AddCell(rate);

                                                                //if (entity.Check_No != "")
                                                                //{
                                                                Check = "Check#: " + ("0000000000".Substring(0, 10 - entity.Check_No.Trim().Length) + entity.Check_No.Trim());// + ", ";
                                                                                                                                                                              //phrase.Add(new Chunk(Check, TblFontBold));
                                                                                                                                                                              //}
                                                                PdfPCell chk = new PdfPCell(new Phrase(Check, TableFont));
                                                                chk.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                chk.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                chk.Colspan = 2;
                                                                servDetails.AddCell(chk);

                                                                //if (entity.Check_Date != "")
                                                                //{
                                                                CheckDte = "Check Date: " + LookupDataAccess.Getdate(entity.Check_Date).ToString();// + ", ";
                                                                                                                                                   //phrase.Add(new Chunk(CheckDte, TblFontBold));
                                                                                                                                                   //}
                                                                PdfPCell chkDte = new PdfPCell(new Phrase(CheckDte, TableFont));
                                                                chkDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                chkDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                chkDte.Colspan = 2;
                                                                servDetails.AddCell(chkDte);

                                                                //if (entity.Followup_Comp != "")
                                                                //{
                                                                CompleteDte = "Complete Date: " + LookupDataAccess.Getdate(entity.Followup_Comp).ToString();// + ", ";
                                                                                                                                                            //phrase.Add(new Chunk(CompleteDte, TableFont));
                                                                                                                                                            //}
                                                                PdfPCell cmpDte = new PdfPCell(new Phrase(CompleteDte, TableFont));
                                                                cmpDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                cmpDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                cmpDte.Colspan = 2;
                                                                servDetails.AddCell(cmpDte);

                                                                by = "by: " + entity.Followup_By;// + ", ";
                                                                                                 //if (!string.IsNullOrEmpty(entity.Followup_By.Trim()))
                                                                                                 //{
                                                                                                 //phrase.Add(new Chunk(by, TableFont));
                                                                                                 //}
                                                                PdfPCell bywhom = new PdfPCell(new Phrase(by, TableFont));
                                                                bywhom.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                bywhom.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                bywhom.Colspan = 2;
                                                                servDetails.AddCell(bywhom);

                                                                Program = "Program: " + Set_SP_Program_TextReport(entity.Act_PROG);
                                                                //if (!string.IsNullOrEmpty(entity.Act_PROG.Trim()))
                                                                //{
                                                                //    phrase.Add(new Chunk(Program, TableFont));
                                                                //}
                                                                PdfPCell prog = new PdfPCell(new Phrase(Program, TableFont));
                                                                prog.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                prog.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                prog.Colspan = 2;
                                                                servDetails.AddCell(prog);

                                                            }
                                                            //Category 2 Service Details
                                                            else if (CategoryCode == "02")
                                                            {
                                                                Vendorname = Get_Vendor_Name(entity.Vendor_No);

                                                                CaDate = LookupDataAccess.Getdate(entity.ACT_Date).ToString();

                                                                if (entity.Followup_Comp != "")
                                                                {
                                                                    CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                    completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                }
                                                                else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "R")
                                                                {
                                                                    CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                    completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                    completedate.Add(new Chunk("!", TableFontRed));
                                                                }
                                                                else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "Y")
                                                                {
                                                                    CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                    completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                    completedate.Add(new Chunk("!", TableFontYellow));
                                                                }

                                                                servDetails.TotalWidth = 240f;
                                                                servDetails.WidthPercentage = 100;
                                                                servDetails.LockedWidth = true;
                                                                float[] serwidths = new float[] { 90f, 150f };
                                                                servDetails.SetWidths(serwidths);
                                                                servDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                servDetails.SpacingAfter = 07f;

                                                                //if (entity.ActSeek_Date != "")
                                                                //{
                                                                ServiceReqDte = "Service Requested Date: " + LookupDataAccess.Getdate(entity.ActSeek_Date).ToString();// + ", ";
                                                                                                                                                                      //phrase.Add(new Chunk(ServiceReqDte, TableFont));
                                                                                                                                                                      //}
                                                                PdfPCell ServReqDte = new PdfPCell(new Phrase(ServiceReqDte, TableFont));
                                                                ServReqDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                ServReqDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                ServReqDte.Colspan = 2;
                                                                servDetails.AddCell(ServReqDte);

                                                                CaseWorker = "Case Worker: " + GetWorkerName(entity.Caseworker);// + ", ";
                                                                                                                                //if (!string.IsNullOrEmpty(entity.Caseworker.Trim()))
                                                                                                                                //    phrase.Add(new Chunk(CaseWorker, TableFont));
                                                                PdfPCell caseWorker = new PdfPCell(new Phrase(CaseWorker, TableFont));
                                                                caseWorker.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                caseWorker.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                caseWorker.Colspan = 2;
                                                                servDetails.AddCell(caseWorker);

                                                                Site = "Site: " + GetSiteName(entity.Site);// + ", ";
                                                                                                           //if (!string.IsNullOrEmpty(entity.Site.Trim()))
                                                                                                           //    phrase.Add(new Chunk(Site, TableFont));
                                                                PdfPCell site = new PdfPCell(new Phrase(Site, TableFont));
                                                                site.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                site.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                site.Colspan = 2;
                                                                servDetails.AddCell(site);

                                                                BillPeriod = "Billing Period: " + entity.BillingPeriod;// + ", ";
                                                                                                                       //if (!string.IsNullOrEmpty(entity.BillingPeriod.Trim()))
                                                                                                                       //    phrase.Add(new Chunk(BillPeriod, TableFont));
                                                                PdfPCell billperiod = new PdfPCell(new Phrase(BillPeriod, TableFont));
                                                                billperiod.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                billperiod.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                billperiod.Colspan = 2;
                                                                servDetails.AddCell(billperiod);

                                                                Account = "Account#: " + entity.Account;// + ", ";
                                                                                                        //if (!string.IsNullOrEmpty(entity.Account.Trim()))
                                                                                                        //{
                                                                                                        //    phrase.Add(new Chunk(Account, TableFont));
                                                                                                        //}
                                                                PdfPCell act = new PdfPCell(new Phrase(Account, TableFont));
                                                                act.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                act.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                act.Colspan = 2;
                                                                servDetails.AddCell(act);

                                                                ArrearAmt = "Arrears Amt: " + entity.ArrearsAmt;// + ", ";
                                                                                                                //if (!string.IsNullOrEmpty(entity.ArrearsAmt.Trim()))
                                                                                                                //{
                                                                                                                //    phrase.Add(new Chunk(ArrearAmt, TableFont));
                                                                                                                //}
                                                                PdfPCell arrAmt = new PdfPCell(new Phrase(ArrearAmt, TableFont));
                                                                arrAmt.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                arrAmt.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                arrAmt.Colspan = 2;
                                                                servDetails.AddCell(arrAmt);

                                                                Cost = "Amt Paid: " + entity.Cost;// + ", ";
                                                                                                  //if (!string.IsNullOrEmpty(entity.Cost.Trim()))
                                                                                                  //{
                                                                                                  //    phrase.Add(new Chunk(Cost, TableFont));
                                                                                                  //}
                                                                PdfPCell cost = new PdfPCell(new Phrase(Cost, TableFont));
                                                                cost.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                cost.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                cost.Colspan = 2;
                                                                servDetails.AddCell(cost);

                                                                SupApproval = "Supervisor Approval: " + entity.LVL1Apprval;// + ", ";
                                                                                                                           //if (!string.IsNullOrEmpty(entity.LVL1Apprval.Trim()))
                                                                                                                           //{
                                                                                                                           //    phrase.Add(new Chunk(SupApproval, TableFont));
                                                                                                                           //}
                                                                PdfPCell subaprvl = new PdfPCell(new Phrase(SupApproval, TableFont));
                                                                subaprvl.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                subaprvl.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                subaprvl.Colspan = 2;
                                                                servDetails.AddCell(subaprvl);

                                                                Date1 = "Date: " + entity.LVL1AprrvalDate;// + ", ";
                                                                                                          //if (!string.IsNullOrEmpty(entity.LVL1AprrvalDate.Trim()))
                                                                                                          //{
                                                                                                          //    phrase.Add(new Chunk(Date1, TableFont));
                                                                                                          //}
                                                                PdfPCell dte1 = new PdfPCell(new Phrase(Date1, TableFont));
                                                                dte1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                dte1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                dte1.Colspan = 2;
                                                                servDetails.AddCell(dte1);

                                                                PrePayApproval = "Pre-Payment Approval: " + entity.LVL2Apprval;// + ", ";
                                                                                                                               //if (!string.IsNullOrEmpty(entity.LVL2Apprval.Trim()))
                                                                                                                               //{
                                                                                                                               //    phrase.Add(new Chunk(PrePayApproval, TableFont));
                                                                                                                               //}
                                                                PdfPCell prepay = new PdfPCell(new Phrase(PrePayApproval, TableFont));
                                                                prepay.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                prepay.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                prepay.Colspan = 2;
                                                                servDetails.AddCell(prepay);

                                                                Date2 = "Date: " + entity.LVL2ApprvalDate;//+ ", ";
                                                                                                          //if (!string.IsNullOrEmpty(entity.LVL2ApprvalDate.Trim()))
                                                                                                          //{
                                                                                                          //    phrase.Add(new Chunk(Date2, TableFont));
                                                                                                          //}
                                                                PdfPCell dte2 = new PdfPCell(new Phrase(Date2, TableFont));
                                                                dte2.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                dte2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                dte2.Colspan = 2;
                                                                servDetails.AddCell(dte2);

                                                                SentForPay = "Sent for Payment by User: " + entity.SentPmtUser;// + ", ";
                                                                                                                               //if (!string.IsNullOrEmpty(entity.SentPmtUser.Trim()))
                                                                                                                               //{
                                                                                                                               //    phrase.Add(new Chunk(SentForPay, TableFont));
                                                                                                                               //}
                                                                PdfPCell sentfor = new PdfPCell(new Phrase(SentForPay, TableFont));
                                                                sentfor.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                sentfor.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                sentfor.Colspan = 2;
                                                                servDetails.AddCell(sentfor);

                                                                DateOn = "On: " + entity.SentPmtDate;// + ", ";
                                                                                                     //if (!string.IsNullOrEmpty(entity.SentPmtDate.Trim()))
                                                                                                     //{
                                                                                                     //    phrase.Add(new Chunk(DateOn, TableFont));
                                                                                                     //}
                                                                PdfPCell dteOn = new PdfPCell(new Phrase(DateOn, TableFont));
                                                                dteOn.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                dteOn.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                dteOn.Colspan = 2;
                                                                servDetails.AddCell(dteOn);

                                                                Fund1 = "Fund: " + GetFundName(entity.Fund1);// + ", ";
                                                                                                             //if (!string.IsNullOrEmpty(entity.Fund1.Trim()))
                                                                                                             //{
                                                                                                             //    phrase.Add(new Chunk(Fund1, TableFont));
                                                                                                             //}
                                                                PdfPCell fund1 = new PdfPCell(new Phrase(Fund1, TableFont));
                                                                fund1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                fund1.Colspan = 2;
                                                                servDetails.AddCell(fund1);

                                                                //if (entity.BundleNo != "")
                                                                //{
                                                                Bundle = "Bundle#: " + entity.BundleNo;// + ", ";
                                                                                                       //phrase.Add(new Chunk(Bundle, TblFontBold));
                                                                                                       //}
                                                                PdfPCell bundle = new PdfPCell(new Phrase(Bundle, TableFont));
                                                                bundle.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                bundle.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                bundle.Colspan = 2;
                                                                servDetails.AddCell(bundle);

                                                                //if (entity.Followup_Comp != "")
                                                                //{
                                                                CompleteDte = "Complete Date: " + LookupDataAccess.Getdate(entity.Followup_Comp).ToString();// + ", ";
                                                                                                                                                            //phrase.Add(new Chunk(CompleteDte, TableFont));
                                                                                                                                                            //}
                                                                PdfPCell cmpDte = new PdfPCell(new Phrase(CompleteDte, TableFont));
                                                                cmpDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                cmpDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                cmpDte.Colspan = 2;
                                                                servDetails.AddCell(cmpDte);

                                                                by = "by: " + entity.Followup_By;//+ ", ";
                                                                                                 //if (!string.IsNullOrEmpty(entity.Followup_By.Trim()))
                                                                                                 //{
                                                                                                 //    phrase.Add(new Chunk(by, TableFont));
                                                                                                 //}
                                                                PdfPCell bywhom = new PdfPCell(new Phrase(by, TableFont));
                                                                bywhom.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                bywhom.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                bywhom.Colspan = 2;
                                                                servDetails.AddCell(bywhom);

                                                                Program = "Program: " + Set_SP_Program_TextReport(entity.Act_PROG);
                                                                //if (!string.IsNullOrEmpty(entity.Act_PROG.Trim()))
                                                                //{
                                                                //    phrase.Add(new Chunk(Program, TableFont));
                                                                //}
                                                                PdfPCell prog = new PdfPCell(new Phrase(Program, TableFont));
                                                                prog.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                prog.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                prog.Colspan = 2;
                                                                servDetails.AddCell(prog);

                                                            }
                                                            //Category 3 Service Details
                                                            else if (CategoryCode == "03")
                                                            {
                                                                Vendorname = Get_Vendor_Name(entity.Vendor_No);

                                                                CaDate = LookupDataAccess.Getdate(entity.ACT_Date).ToString();

                                                                if (entity.Followup_Comp != "")
                                                                {
                                                                    CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                    completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                }
                                                                else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "R")
                                                                {
                                                                    CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                    completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                    completedate.Add(new Chunk("!", TableFontRed));
                                                                }
                                                                else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "Y")
                                                                {
                                                                    CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                    completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                    completedate.Add(new Chunk("!", TableFontYellow));
                                                                }

                                                                servDetails.TotalWidth = 240f;
                                                                servDetails.WidthPercentage = 100;
                                                                servDetails.LockedWidth = true;
                                                                float[] serwidths = new float[] { 90f, 150f };
                                                                servDetails.SetWidths(serwidths);
                                                                servDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                servDetails.SpacingAfter = 07f;

                                                                //if (entity.ActSeek_Date != "")
                                                                //{
                                                                ServiceReqDte = "Service Requested Date: " + LookupDataAccess.Getdate(entity.ActSeek_Date).ToString();// + ", ";
                                                                                                                                                                      //**phrase.Add(new Chunk(ServiceReqDte, TableFont));

                                                                PdfPCell ServReqDte = new PdfPCell(new Phrase(ServiceReqDte, TableFont));
                                                                ServReqDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                ServReqDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                ServReqDte.Colspan = 2;
                                                                servDetails.AddCell(ServReqDte);
                                                                //}

                                                                CaseWorker = "Case Worker: " + GetWorkerName(entity.Caseworker);// + ", ";
                                                                                                                                //if (!string.IsNullOrEmpty(entity.Caseworker.Trim()))
                                                                                                                                //{
                                                                                                                                //**phrase.Add(new Chunk(CaseWorker, TableFont));

                                                                PdfPCell caseWorker = new PdfPCell(new Phrase(CaseWorker, TableFont));
                                                                caseWorker.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                caseWorker.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                caseWorker.Colspan = 2;
                                                                servDetails.AddCell(caseWorker);
                                                                //}

                                                                Site = "Site: " + GetSiteName(entity.Site);// + ", ";
                                                                                                           //if (!string.IsNullOrEmpty(entity.Site.Trim()))
                                                                                                           //{
                                                                                                           //**phrase.Add(new Chunk(Site, TableFont));

                                                                PdfPCell site = new PdfPCell(new Phrase(Site, TableFont));
                                                                site.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                site.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                site.Colspan = 2;
                                                                servDetails.AddCell(site);
                                                                //}

                                                                Fund1 = "Fund: " + GetFundName(entity.Fund1);// + ", ";
                                                                                                             //if (!string.IsNullOrEmpty(entity.Fund1.Trim()))
                                                                                                             //{
                                                                                                             //**phrase.Add(new Chunk(Fund1, TableFont));

                                                                PdfPCell fund1 = new PdfPCell(new Phrase(Fund1, TableFont));
                                                                fund1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                fund1.Colspan = 2;
                                                                servDetails.AddCell(fund1);
                                                                //}

                                                                Fund2 = "Fund 2: " + GetFundName(entity.Fund2);// + ", ";
                                                                                                               //if (!string.IsNullOrEmpty(entity.Fund2.Trim()))
                                                                                                               //{
                                                                                                               //**phrase.Add(new Chunk(Fund2, TableFont));

                                                                PdfPCell fund2 = new PdfPCell(new Phrase(Fund2, TableFont));
                                                                fund2.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                fund2.Colspan = 2;
                                                                servDetails.AddCell(fund2);
                                                                //}

                                                                Fund3 = "Fund 3: " + GetFundName(entity.Fund3);// + ", ";
                                                                                                               //if (!string.IsNullOrEmpty(entity.Fund3.Trim()))
                                                                                                               //{
                                                                                                               //**phrase.Add(new Chunk(Fund3, TableFont));

                                                                PdfPCell fund3 = new PdfPCell(new Phrase(Fund3, TableFont));
                                                                fund3.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                fund3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                fund3.Colspan = 2;
                                                                servDetails.AddCell(fund3);
                                                                //}

                                                                UOM1 = "UOM: " + GetUOMName(entity.UOM);// + ", ";
                                                                                                        //if (!string.IsNullOrEmpty(entity.UOM.Trim()))
                                                                                                        //{
                                                                                                        //**phrase.Add(new Chunk(UOM1, TableFont));

                                                                PdfPCell uom1 = new PdfPCell(new Phrase(UOM1, TableFont));
                                                                uom1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                uom1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                uom1.Colspan = 2;
                                                                servDetails.AddCell(uom1);
                                                                //}

                                                                UOM2 = "UOM 2: " + GetUOMName(entity.UOM2);// + ", ";
                                                                                                           //if (!string.IsNullOrEmpty(entity.UOM2.Trim()))
                                                                                                           //{
                                                                                                           //**phrase.Add(new Chunk(UOM2, TableFont));

                                                                PdfPCell uom2 = new PdfPCell(new Phrase(UOM2, TableFont));
                                                                uom2.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                uom2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                uom2.Colspan = 2;
                                                                servDetails.AddCell(uom2);
                                                                // }

                                                                UOM3 = "UOM 3: " + GetUOMName(entity.UOM3);// + ", ";
                                                                                                           //if (!string.IsNullOrEmpty(entity.UOM3.Trim()))
                                                                                                           //{
                                                                                                           //**phrase.Add(new Chunk(UOM3, TableFont));

                                                                PdfPCell uom3 = new PdfPCell(new Phrase(UOM3, TableFont));
                                                                uom3.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                uom3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                uom3.Colspan = 2;
                                                                servDetails.AddCell(uom3);
                                                                //}

                                                                Amt1 = "Amount: " + entity.Amount;// + ", ";
                                                                                                  //if (!string.IsNullOrEmpty(entity.Amount.Trim()))
                                                                                                  //{
                                                                                                  //**phrase.Add(new Chunk(Amt1, TableFont));

                                                                PdfPCell amt1 = new PdfPCell(new Phrase(Amt1, TableFont));
                                                                amt1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                amt1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                amt1.Colspan = 2;
                                                                servDetails.AddCell(amt1);
                                                                //}

                                                                Amt2 = "Amount 2: " + entity.Amount2;// + ", ";
                                                                                                     //if (!string.IsNullOrEmpty(entity.Amount2.Trim()))
                                                                                                     //{
                                                                                                     //**phrase.Add(new Chunk(Amt2, TableFont));

                                                                PdfPCell amt2 = new PdfPCell(new Phrase(Amt2, TableFont));
                                                                amt2.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                amt2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                amt2.Colspan = 2;
                                                                servDetails.AddCell(amt2);
                                                                //}

                                                                Amt3 = "Amount 3: " + entity.Amount3;// + ", ";
                                                                                                     //if (!string.IsNullOrEmpty(entity.Amount3.Trim()))
                                                                                                     //{
                                                                                                     //**phrase.Add(new Chunk(Amt3, TableFont));

                                                                PdfPCell amt3 = new PdfPCell(new Phrase(Amt3, TableFont));
                                                                amt3.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                amt3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                amt3.Colspan = 2;
                                                                servDetails.AddCell(amt3);
                                                                //}

                                                                Total = "Total: " + entity.Cost;// + ", ";
                                                                                                //if (!string.IsNullOrEmpty(entity.Cost.Trim()))
                                                                                                //{
                                                                                                //**phrase.Add(new Chunk(Total, TableFont));

                                                                PdfPCell tot = new PdfPCell(new Phrase(Total, TableFont));
                                                                tot.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                tot.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                tot.Colspan = 2;
                                                                servDetails.AddCell(tot);
                                                                //}

                                                                //if (entity.Check_No != "")
                                                                //{
                                                                Check = "Check#: " + ("0000000000".Substring(0, 10 - entity.Check_No.Trim().Length) + entity.Check_No.Trim());// + ", ";
                                                                                                                                                                              //**phrase.Add(new Chunk(Check, TblFontBold));

                                                                PdfPCell chk = new PdfPCell(new Phrase(Check, TableFont));
                                                                chk.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                chk.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                chk.Colspan = 2;
                                                                servDetails.AddCell(chk);
                                                                //}

                                                                //if (entity.Check_Date != "")
                                                                //{
                                                                CheckDte = "Check Date: " + LookupDataAccess.Getdate(entity.Check_Date).ToString();// + ", ";
                                                                                                                                                   //**phrase.Add(new Chunk(CheckDte, TblFontBold));

                                                                PdfPCell chkDte = new PdfPCell(new Phrase(CheckDte, TableFont));
                                                                chkDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                chkDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                chkDte.Colspan = 2;
                                                                servDetails.AddCell(chkDte);
                                                                //}

                                                                //if (entity.Followup_Comp != "")
                                                                // {
                                                                CompleteDte = "Complete Date: " + LookupDataAccess.Getdate(entity.Followup_Comp).ToString();// + ", ";
                                                                                                                                                            //**phrase.Add(new Chunk(CompleteDte, TableFont));

                                                                PdfPCell cmpDte = new PdfPCell(new Phrase(CompleteDte, TableFont));
                                                                cmpDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                cmpDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                cmpDte.Colspan = 2;
                                                                servDetails.AddCell(cmpDte);
                                                                //}

                                                                by = "by: " + entity.Followup_By;// + ", ";
                                                                                                 //if (!string.IsNullOrEmpty(entity.Followup_By.Trim()))
                                                                                                 //{
                                                                                                 //**phrase.Add(new Chunk(by, TableFont));

                                                                PdfPCell bywhom = new PdfPCell(new Phrase(by, TableFont));
                                                                bywhom.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                bywhom.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                bywhom.Colspan = 2;
                                                                servDetails.AddCell(bywhom);
                                                                //}

                                                                Program = "Program: " + Set_SP_Program_TextReport(entity.Act_PROG);
                                                                //if (!string.IsNullOrEmpty(entity.Act_PROG.Trim()))
                                                                //{
                                                                //**phrase.Add(new Chunk(Program, TableFont));

                                                                PdfPCell prog = new PdfPCell(new Phrase(Program, TableFont));
                                                                prog.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                prog.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                prog.Colspan = 2;
                                                                servDetails.AddCell(prog);
                                                                //}
                                                            }
                                                            //Category 4 Service Details
                                                            else if (CategoryCode == "04")
                                                            {
                                                                #region Nested Table created on 02/02/2024 by Vikash as per CEAP Enhancement document

                                                                Vendorname = Get_Vendor_Name(entity.Vendor_No);

                                                                CaDate = LookupDataAccess.Getdate(entity.ACT_Date).ToString();

                                                                if (entity.Followup_Comp != "")
                                                                {
                                                                    CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                    completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                }
                                                                else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "R")
                                                                {
                                                                    CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                    completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                    completedate.Add(new Chunk("!", TableFontRed));
                                                                }
                                                                else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "Y")
                                                                {
                                                                    CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                    completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                    completedate.Add(new Chunk("!", TableFontYellow));
                                                                }

                                                                servDetails.TotalWidth = 240f;
                                                                servDetails.WidthPercentage = 100;
                                                                servDetails.LockedWidth = true;
                                                                float[] serwidths = new float[] { 90f, 150f };
                                                                servDetails.SetWidths(serwidths);
                                                                servDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                servDetails.SpacingAfter = 07f;

                                                                //if (entity.ActSeek_Date != "")
                                                                //{
                                                                ServiceReqDte = "Service Requested Date: " + LookupDataAccess.Getdate(entity.ActSeek_Date).ToString();// + ", ";

                                                                PdfPCell ServReqDte = new PdfPCell(new Phrase(ServiceReqDte, TableFont));
                                                                ServReqDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                ServReqDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                ServReqDte.Colspan = 2;
                                                                servDetails.AddCell(ServReqDte);
                                                                //}

                                                                CaseWorker = "Case Worker: " + GetWorkerName(entity.Caseworker);// + ", ";
                                                                                                                                //if (!string.IsNullOrEmpty(entity.Caseworker.Trim()))
                                                                                                                                //{
                                                                PdfPCell caseWorker = new PdfPCell(new Phrase(CaseWorker, TableFont));
                                                                caseWorker.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                caseWorker.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                caseWorker.Colspan = 2;
                                                                servDetails.AddCell(caseWorker);
                                                                //}

                                                                //Site = "Site: " + GetSiteName(entity.Site);// + ", ";
                                                                //if (!string.IsNullOrEmpty(entity.Site.Trim()))
                                                                //{
                                                                //    PdfPCell site = new PdfPCell(new Phrase(Site, TableFont));
                                                                //    site.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                //    site.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                //    site.Colspan = 2;
                                                                //    servDetails.AddCell(site);
                                                                //}


                                                                Source = "Source: " + Fill_Sources(entity.CA_Source);// + ", ";
                                                                                                                     //if (!string.IsNullOrEmpty(entity.CA_Source.Trim()))
                                                                                                                     //{
                                                                PdfPCell source = new PdfPCell(new Phrase(Source, TableFont));
                                                                source.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                source.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                source.Colspan = 2;
                                                                servDetails.AddCell(source);
                                                                //}

                                                                BillingName = "Billing Name: " + entity.BillngFname + " " + entity.BillngLname;// + ", ";
                                                                                                                                               //if (!string.IsNullOrEmpty(entity.BillngType.Trim()))
                                                                                                                                               //{
                                                                PdfPCell billingName = new PdfPCell(new Phrase(BillingName, TableFont));
                                                                billingName.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                billingName.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                billingName.Colspan = 2;
                                                                servDetails.AddCell(billingName);
                                                                //}

                                                                Account = "Account#: " + entity.Account;// + ", ";
                                                                                                        // if (!string.IsNullOrEmpty(entity.Account.Trim()))
                                                                                                        // {
                                                                PdfPCell acc = new PdfPCell(new Phrase(Account, TableFont));
                                                                acc.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                acc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                acc.Colspan = 2;
                                                                servDetails.AddCell(acc);
                                                                // }

                                                                //Fund1 = "Fund: " + GetFundName(entity.Fund1);// + ", ";
                                                                //if (!string.IsNullOrEmpty(entity.Fund1.Trim()))
                                                                //{
                                                                //    PdfPCell fund1 = new PdfPCell(new Phrase(Fund1, TableFont));
                                                                //    fund1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                //    fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                //    fund1.Colspan = 2;
                                                                //    servDetails.AddCell(fund1);
                                                                //}

                                                                Budget = "Budget: " + BudgetDesc(entity.BDC_ID);// + ", ";
                                                                                                                //if (!string.IsNullOrEmpty(entity.BDC_ID.Trim()))
                                                                                                                //{
                                                                PdfPCell budget = new PdfPCell(new Phrase(Budget, TableFont));
                                                                budget.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                budget.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                budget.Colspan = 2;
                                                                servDetails.AddCell(budget);
                                                                //}

                                                                BenefitReason = "Benefit Reason: " + BenefitReasonDesc(entity.BenefitReason);// + ", ";
                                                                                                                                             //if (!string.IsNullOrEmpty(entity.BenefitReason.Trim()))
                                                                                                                                             //{
                                                                PdfPCell benfReason = new PdfPCell(new Phrase(BenefitReason, TableFont));
                                                                benfReason.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                benfReason.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                benfReason.Colspan = 2;
                                                                servDetails.AddCell(benfReason);
                                                                //}

                                                                //if (entity.Followup_Comp != "")
                                                                //{
                                                                CompleteDte = "Complete Date: " + LookupDataAccess.Getdate(entity.Followup_Comp).ToString();// + ", ";

                                                                PdfPCell cmpDate = new PdfPCell(new Phrase(CompleteDte, TableFont));
                                                                cmpDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                cmpDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                cmpDate.Colspan = 2;
                                                                servDetails.AddCell(cmpDate);
                                                                //}

                                                                by = "by: " + entity.Followup_By;// + ", ";
                                                                                                 //if (!string.IsNullOrEmpty(entity.Followup_By.Trim()))
                                                                                                 //{
                                                                PdfPCell By = new PdfPCell(new Phrase(by, TableFont));
                                                                By.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                By.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                By.Colspan = 2;
                                                                servDetails.AddCell(By);
                                                                //}

                                                                //Program = "Program: " + Set_SP_Program_TextReport(entity.Act_PROG);
                                                                //if (!string.IsNullOrEmpty(entity.Act_PROG.Trim()))
                                                                //{
                                                                //    PdfPCell prog = new PdfPCell(new Phrase(Program, TableFont));
                                                                //    prog.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                //    prog.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                //    prog.Colspan = 2;
                                                                //    servDetails.AddCell(prog);
                                                                //}

                                                                Cost = "Amount Paid: " + entity.Cost;// + ", ";
                                                                if (!string.IsNullOrEmpty(entity.Cost.Trim()))
                                                                {
                                                                    phraseCat4.Add(new Chunk(Cost, TblFont));
                                                                }
                                                                else
                                                                    phraseCat4.Add(new Chunk("", TblFont));

                                                                if (entity.BundleNo != "")
                                                                {
                                                                    Bundle = "Bundle#: " + entity.BundleNo;// + ", ";
                                                                    phraseCat4.Add(new Chunk(Bundle, TblFontBold));
                                                                }
                                                                else
                                                                    phraseCat4.Add(new Chunk("", TblFontBold));

                                                                if (entity.PaymentNo != "")
                                                                {
                                                                    Payment = "Payment#: " + entity.PaymentNo;// + ", ";
                                                                    phraseCat4.Add(new Chunk(Payment, TblFontBold1));
                                                                }
                                                                else
                                                                    phraseCat4.Add(new Chunk("", TblFontBold1));

                                                                if (entity.Check_No != "")
                                                                {
                                                                    Check = "Check#: " + ("0000000000".Substring(0, 10 - entity.Check_No.Trim().Length) + entity.Check_No.Trim());// + ", ";
                                                                    phraseCat4.Add(new Chunk(Check, TblFontBold2));
                                                                }
                                                                else
                                                                    phraseCat4.Add(new Chunk("", TblFontBold2));

                                                                if (entity.Check_Date != "")
                                                                {
                                                                    CheckDte = "Check Date: " + LookupDataAccess.Getdate(entity.Check_Date).ToString();// + ", ";
                                                                    phraseCat4.Add(new Chunk(CheckDte, TblFontBold3));
                                                                }
                                                                else
                                                                    phraseCat4.Add(new Chunk("Check Date: ", TblFontBold3));

                                                                #endregion

                                                                /* Vendorname = Get_Vendor_Name(entity.Vendor_No);

                                                                 CaDate = LookupDataAccess.Getdate(entity.ACT_Date).ToString();

                                                                 if (entity.Followup_Comp != "")
                                                                 {
                                                                     CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                     completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                 }
                                                                 else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "R")
                                                                 {
                                                                     CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                     completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                     completedate.Add(new Chunk("!", TableFontRed));
                                                                 }
                                                                 else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "Y")
                                                                 {
                                                                     CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                     completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                     completedate.Add(new Chunk("!", TableFontYellow));
                                                                 }


                                                                 if (entity.ActSeek_Date != "")
                                                                 {
                                                                     ServiceReqDte = "Service Requested Date: " + LookupDataAccess.Getdate(entity.ActSeek_Date).ToString() + ", ";
                                                                     phrase.Add(new Chunk(ServiceReqDte, TableFont));
                                                                 }

                                                                 CaseWorker = "Case Worker: " + GetWorkerName(entity.Caseworker) + ", ";
                                                                 if (!string.IsNullOrEmpty(entity.Caseworker.Trim()))
                                                                     phrase.Add(new Chunk(CaseWorker, TableFont));

                                                                 Site = "Site: " + GetSiteName(entity.Site) + ", ";
                                                                 if (!string.IsNullOrEmpty(entity.Site.Trim()))
                                                                     phrase.Add(new Chunk(Site, TableFont));


                                                                 Source = "Source: " + Fill_Sources(entity.CA_Source) + ", ";
                                                                 if (!string.IsNullOrEmpty(entity.CA_Source.Trim()))
                                                                 {
                                                                     phrase.Add(new Chunk(Source, TableFont));
                                                                 }

                                                                 BillingName = "Billing Name: " + entity.BillngFname + " " + entity.BillngLname + ", ";
                                                                 if (!string.IsNullOrEmpty(entity.BillngType.Trim()))
                                                                 {
                                                                     phrase.Add(new Chunk(BillingName, TableFont));
                                                                 }

                                                                 Account = "Account#: " + entity.Account + ", ";
                                                                 if (!string.IsNullOrEmpty(entity.Account.Trim()))
                                                                 {
                                                                     phrase.Add(new Chunk(Account, TableFont));
                                                                 }

                                                                 Fund1 = "Fund: " + GetFundName(entity.Fund1) + ", ";
                                                                 if (!string.IsNullOrEmpty(entity.Fund1.Trim()))
                                                                 {
                                                                     phrase.Add(new Chunk(Fund1, TableFont));
                                                                 }

                                                                 Budget = "Budget: " + BudgetDesc(entity.BDC_ID) + ", ";
                                                                 if (!string.IsNullOrEmpty(entity.BDC_ID.Trim()))
                                                                 {
                                                                     phrase.Add(new Chunk(Budget, TableFont));
                                                                 }

                                                                 BenefitReason = "Benefit Reason: " + BenefitReasonDesc(entity.BenefitReason) + ", ";
                                                                 if (!string.IsNullOrEmpty(entity.BenefitReason.Trim()))
                                                                 {
                                                                     phrase.Add(new Chunk(BenefitReason, TableFont));
                                                                 }

                                                                 Cost = "Amount Paid: " + entity.Cost;// + ", ";
                                                                 if (!string.IsNullOrEmpty(entity.Cost.Trim()))
                                                                 {
                                                                     phraseCat4.Add(new Chunk(Cost, TblFont));
                                                                 }
                                                                 else
                                                                     phraseCat4.Add(new Chunk("", TblFont));

                                                                 if (entity.BundleNo != "")
                                                                 {
                                                                     Bundle = "Bundle#: " + entity.BundleNo;// + ", ";
                                                                     phraseCat4.Add(new Chunk(Bundle, TblFontBold));
                                                                 }
                                                                 else
                                                                     phraseCat4.Add(new Chunk("", TblFontBold));

                                                                 if (entity.PaymentNo != "")
                                                                 {
                                                                     Payment = "Payment#: " + entity.PaymentNo;// + ", ";
                                                                     phraseCat4.Add(new Chunk(Payment, TblFontBold1));
                                                                 }
                                                                 else
                                                                     phraseCat4.Add(new Chunk("", TblFontBold1));

                                                                 if (entity.Check_No != "")
                                                                 {
                                                                     Check = "Check#: " + ("0000000000".Substring(0, 10 - entity.Check_No.Trim().Length) + entity.Check_No.Trim());// + ", ";
                                                                     phraseCat4.Add(new Chunk(Check, TblFontBold2));
                                                                 }
                                                                 else
                                                                     phraseCat4.Add(new Chunk("", TblFontBold2));

                                                                 if (entity.Check_Date != "")
                                                                 {
                                                                     CheckDte = "Check Date: " + LookupDataAccess.Getdate(entity.Check_Date).ToString();// + ", ";
                                                                     phraseCat4.Add(new Chunk(CheckDte, TblFontBold3));
                                                                 }
                                                                 else
                                                                     phraseCat4.Add(new Chunk("Check Date: ", TblFontBold3));

                                                                 if (entity.Followup_Comp != "")
                                                                 {
                                                                     CompleteDte = "Complete Date: " + LookupDataAccess.Getdate(entity.Followup_Comp).ToString() + ", ";
                                                                     phrase.Add(new Chunk(CompleteDte, TableFont));
                                                                 }

                                                                 by = "by: " + entity.Followup_By + ", ";
                                                                 if (!string.IsNullOrEmpty(entity.Followup_By.Trim()))
                                                                 {
                                                                     phrase.Add(new Chunk(by, TableFont));
                                                                 }

                                                                 Program = "Program: " + Set_SP_Program_TextReport(entity.Act_PROG);
                                                                 if (!string.IsNullOrEmpty(entity.Act_PROG.Trim()))
                                                                 {
                                                                     phrase.Add(new Chunk(Program, TableFont));
                                                                 }
                                                                 */
                                                            }
                                                            //No Category
                                                            else
                                                            {

                                                                CaDate = LookupDataAccess.Getdate(entity.ACT_Date).ToString();

                                                                if (entity.Followup_Comp != "")
                                                                {
                                                                    CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                    completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                }
                                                                else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "R")
                                                                {
                                                                    CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                    completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                    completedate.Add(new Chunk("!", TableFontRed));
                                                                }
                                                                else if (entity.Followup_On != "" && entity.Followup_Comp == "" && strType == "Y")
                                                                {
                                                                    CaDate_Follow_on = LookupDataAccess.Getdate(entity.Followup_On).ToString();
                                                                    completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                    completedate.Add(new Chunk("!", TableFontYellow));
                                                                }

                                                                servDetails.TotalWidth = 240f;
                                                                servDetails.WidthPercentage = 100;
                                                                servDetails.LockedWidth = true;
                                                                float[] serwidths = new float[] { 90f, 150f };
                                                                servDetails.SetWidths(serwidths);
                                                                servDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                servDetails.SpacingAfter = 07f;

                                                                //if (entity.ActSeek_Date != "")
                                                                //{
                                                                ServiceReqDte = "Service Requested Date: " + LookupDataAccess.Getdate(entity.ActSeek_Date).ToString();// + ", ";

                                                                PdfPCell ServReqDte = new PdfPCell(new Phrase(ServiceReqDte, TableFont));
                                                                ServReqDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                ServReqDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                ServReqDte.Colspan = 2;
                                                                servDetails.AddCell(ServReqDte);
                                                                //}

                                                                CaseWorker = "Case Worker: " + GetWorkerName(entity.Caseworker);// + ", ";
                                                                                                                                //if (!string.IsNullOrEmpty(entity.Caseworker.Trim()))
                                                                                                                                // {
                                                                PdfPCell caseWorker = new PdfPCell(new Phrase(CaseWorker, TableFont));
                                                                caseWorker.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                caseWorker.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                caseWorker.Colspan = 2;
                                                                servDetails.AddCell(caseWorker);
                                                                //}

                                                                //if (entity.VendorName != "")
                                                                //{
                                                                Vendorname = "Vendor: " + Get_Vendor_Name(entity.Vendor_No);
                                                                PdfPCell vendor = new PdfPCell(new Phrase(Vendorname, TableFont));
                                                                vendor.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                vendor.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                vendor.Colspan = 2;
                                                                servDetails.AddCell(vendor);
                                                                //phrase.Add(new Chunk(Vendorname, TableFont));
                                                                //}

                                                                Fund1 = "Fund: " + GetFundName(entity.Fund1);// + ", ";
                                                                                                             // if (!string.IsNullOrEmpty(entity.Fund1.Trim()))
                                                                                                             //{
                                                                PdfPCell fund1 = new PdfPCell(new Phrase(Fund1, TableFont));
                                                                fund1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                fund1.Colspan = 2;
                                                                servDetails.AddCell(fund1);
                                                                //phrase.Add(new Chunk(Fund1, TableFont));
                                                                //}
                                                                UOM1 = "UOM: " + GetUOMName(entity.UOM);// + ", ";
                                                                                                        //if (!string.IsNullOrEmpty(entity.UOM.Trim()))
                                                                                                        //{
                                                                PdfPCell uom = new PdfPCell(new Phrase(UOM1, TableFont));
                                                                uom.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                uom.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                uom.Colspan = 2;
                                                                servDetails.AddCell(uom);
                                                                //phrase.Add(new Chunk(UOM1, TableFont));
                                                                //}

                                                                Amt1 = "Amount: " + entity.Amount;// + ", ";
                                                                                                  //if (!string.IsNullOrEmpty(entity.Amount.Trim()))
                                                                                                  //{
                                                                PdfPCell amt = new PdfPCell(new Phrase(Amt1, TableFont));
                                                                amt.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                amt.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                amt.Colspan = 2;
                                                                servDetails.AddCell(amt);
                                                                //phrase.Add(new Chunk(Amt1, TableFont));
                                                                //}

                                                                Fund2 = "Fund 2: " + GetFundName(entity.Fund2);// + ", ";
                                                                                                               //if (!string.IsNullOrEmpty(entity.Fund2.Trim()))
                                                                                                               //{
                                                                PdfPCell fund2 = new PdfPCell(new Phrase(Fund2, TableFont));
                                                                fund2.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                fund2.Colspan = 2;
                                                                servDetails.AddCell(fund2);
                                                                //phrase.Add(new Chunk(Fund2, TableFont));
                                                                //}

                                                                Fund3 = "Fund 3: " + GetFundName(entity.Fund3);// + ", ";
                                                                                                               //if (!string.IsNullOrEmpty(entity.Fund3.Trim()))
                                                                                                               //{
                                                                PdfPCell fund3 = new PdfPCell(new Phrase(Fund3, TableFont));
                                                                fund3.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                fund3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                fund3.Colspan = 2;
                                                                servDetails.AddCell(fund3);
                                                                //phrase.Add(new Chunk(Fund3, TableFont));
                                                                //}

                                                                //if (entity.Check_No != "")
                                                                //{
                                                                Check = "Check#: " + ("0000000000".Substring(0, 10 - entity.Check_No.Trim().Length) + entity.Check_No.Trim());// + ", ";
                                                                PdfPCell check = new PdfPCell(new Phrase(Check, TableFont));
                                                                check.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                check.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                check.Colspan = 2;
                                                                servDetails.AddCell(check);
                                                                //phrase.Add(new Chunk(Check, TblFontBold));
                                                                //}

                                                                // if (entity.Check_Date != "")
                                                                //{
                                                                CheckDte = "Check Date: " + LookupDataAccess.Getdate(entity.Check_Date).ToString();// + ", ";
                                                                PdfPCell checkdte = new PdfPCell(new Phrase(CheckDte, TableFont));
                                                                checkdte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                checkdte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                checkdte.Colspan = 2;
                                                                servDetails.AddCell(checkdte);
                                                                //phrase.Add(new Chunk(CheckDte, TblFontBold));
                                                                // }

                                                                // if (entity.Followup_Comp != "")
                                                                //{
                                                                CompleteDte = "Complete Date: " + LookupDataAccess.Getdate(entity.Followup_Comp).ToString();// + ", ";
                                                                PdfPCell cmpdte = new PdfPCell(new Phrase(CompleteDte, TableFont));
                                                                cmpdte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                cmpdte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                cmpdte.Colspan = 2;
                                                                servDetails.AddCell(cmpdte);
                                                                //phrase.Add(new Chunk(CompleteDte, TableFont));
                                                                // }

                                                                by = "by: " + entity.Followup_By;// + ", ";
                                                                                                 //if (!string.IsNullOrEmpty(entity.Followup_By.Trim()))
                                                                                                 //{
                                                                PdfPCell folowupby = new PdfPCell(new Phrase(by, TableFont));
                                                                folowupby.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                folowupby.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                folowupby.Colspan = 2;
                                                                servDetails.AddCell(folowupby);
                                                                //phrase.Add(new Chunk(by, TableFont));
                                                                //}

                                                                Program = "Program: " + Set_SP_Program_TextReport(entity.Act_PROG);
                                                                //if (!string.IsNullOrEmpty(entity.Act_PROG.Trim()))
                                                                //{
                                                                PdfPCell prog = new PdfPCell(new Phrase(Program, TableFont));
                                                                prog.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                prog.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                prog.Colspan = 2;
                                                                servDetails.AddCell(prog);
                                                                //phrase.Add(new Chunk(Program, TableFont));
                                                                //}

                                                                //if (entity.VendorName != "")
                                                                //{
                                                                //    Vendorname = "Vendor: " + Get_Vendor_Name(entity.Vendor_No) + ", ";
                                                                //    phrase.Add(new Chunk(Vendorname, TableFont));
                                                                //}

                                                                //if (entity.ActSeek_Date != "")
                                                                //{
                                                                //    ServiceReqDte = "Service Requested Date: " + LookupDataAccess.Getdate(entity.ActSeek_Date).ToString() + ", ";
                                                                //    phrase.Add(new Chunk(ServiceReqDte, TableFont));
                                                                //}

                                                                //CaseWorker = "Case Worker: " + GetWorkerName(entity.Caseworker) + ", ";
                                                                //if (!string.IsNullOrEmpty(entity.Caseworker.Trim()))
                                                                //    phrase.Add(new Chunk(CaseWorker, TableFont));

                                                                //Site = "Site: " + GetSiteName(entity.Site) + ", ";
                                                                //if (!string.IsNullOrEmpty(entity.Site.Trim()))
                                                                //    phrase.Add(new Chunk(Site, TableFont));

                                                                //Fund1 = "Fund: " + GetFundName(entity.Fund1) + ", ";
                                                                //if (!string.IsNullOrEmpty(entity.Fund1.Trim()))
                                                                //{
                                                                //    phrase.Add(new Chunk(Fund1, TableFont));
                                                                //}

                                                                //Fund2 = "Fund 2: " + GetFundName(entity.Fund2) + ", ";
                                                                //if (!string.IsNullOrEmpty(entity.Fund2.Trim()))
                                                                //{
                                                                //    phrase.Add(new Chunk(Fund2, TableFont));
                                                                //}

                                                                //Fund3 = "Fund 3: " + GetFundName(entity.Fund3) + ", ";
                                                                //if (!string.IsNullOrEmpty(entity.Fund3.Trim()))
                                                                //{
                                                                //    phrase.Add(new Chunk(Fund3, TableFont));
                                                                //}

                                                                //UOM1 = "UOM: " + GetUOMName(entity.UOM) + ", ";
                                                                //if (!string.IsNullOrEmpty(entity.UOM.Trim()))
                                                                //{
                                                                //    phrase.Add(new Chunk(UOM1, TableFont));
                                                                //}



                                                                foreach (FldcntlHieEntity Entity1 in CntlCAEntity)
                                                                {
                                                                    bool enabled = false;
                                                                    enabled = Entity1.Enab.Equals("Y") ? true : false;
                                                                    switch (Entity1.FldCode)
                                                                    {
                                                                        case Consts.CASE0006.Act_Units:
                                                                            if (enabled)
                                                                            {
                                                                                Unit = "# of Units: " + entity.Units;// + ", ";
                                                                                                                     //if (!string.IsNullOrEmpty(entity.Units.Trim()))
                                                                                                                     //{
                                                                                                                     //    phrase.Add(new Chunk(Unit, TableFont));
                                                                                                                     //}
                                                                                PdfPCell unit1 = new PdfPCell(new Phrase(Unit, TableFont));
                                                                                unit1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                                unit1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                                unit1.Colspan = 2;
                                                                                servDetails.AddCell(unit1);
                                                                            }
                                                                            break;
                                                                        case Consts.CASE0006.Act_Rate:
                                                                            if (enabled)
                                                                            {
                                                                                Rate = "Rate: " + entity.Rate;// + ", ";
                                                                                                              //if (!string.IsNullOrEmpty(entity.Rate.Trim()))
                                                                                                              //{
                                                                                                              //    phrase.Add(new Chunk(Rate, TableFont));
                                                                                                              //}
                                                                                PdfPCell rate1 = new PdfPCell(new Phrase(Rate, TableFont));
                                                                                rate1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                                rate1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                                rate1.Colspan = 2;
                                                                                servDetails.AddCell(rate1);
                                                                            }
                                                                            break;
                                                                    }
                                                                }

                                                                //Amt1 = "Amount: " + entity.Amount + ", ";
                                                                //if (!string.IsNullOrEmpty(entity.Amount.Trim()))
                                                                //{
                                                                //    phrase.Add(new Chunk(Amt1, TableFont));
                                                                //}

                                                                //if (entity.Check_No != "")
                                                                //{
                                                                //    Check = "Check#: " + ("0000000000".Substring(0, 10 - entity.Check_No.Trim().Length) + entity.Check_No.Trim()) + ", ";
                                                                //    phrase.Add(new Chunk(Check, TblFontBold));
                                                                //}

                                                                //if (entity.Check_Date != "")
                                                                //{
                                                                //    CheckDte = "Check Date: " + LookupDataAccess.Getdate(entity.Check_Date).ToString() + ", ";
                                                                //    phrase.Add(new Chunk(CheckDte, TblFontBold));
                                                                //}

                                                                //if (entity.Followup_Comp != "")
                                                                //{
                                                                //    CompleteDte = "Complete Date: " + LookupDataAccess.Getdate(entity.Followup_Comp).ToString() + ", ";
                                                                //    phrase.Add(new Chunk(CompleteDte, TableFont));
                                                                //}

                                                                //by = "by: " + entity.Followup_By + ", ";
                                                                //if (!string.IsNullOrEmpty(entity.Followup_By.Trim()))
                                                                //{
                                                                //    phrase.Add(new Chunk(by, TableFont));
                                                                //}

                                                                //Program = "Program: " + Set_SP_Program_TextReport(entity.Act_PROG);
                                                                //if (!string.IsNullOrEmpty(entity.Act_PROG.Trim()))
                                                                //{
                                                                //    phrase.Add(new Chunk(Program, TableFont));
                                                                //}
                                                            }
                                                            if (CategoryCode == "01" || CategoryCode == "02" || CategoryCode == "03" || CategoryCode == "04")
                                                            {
                                                                /*if (CategoryCode == "04")
                                                                {
                                                                    string Amtpaid = phraseCat4[0].ToString().Trim() == "" ? "" : phraseCat4[0].ToString();
                                                                    string BundleNo = phraseCat4[1].ToString().Trim() == "" ? "" : phraseCat4[1].ToString();
                                                                    string PaymentNo = phraseCat4[2].ToString().Trim() == "" ? "" : phraseCat4[2].ToString();
                                                                    string CheckNo = phraseCat4[3].ToString().Trim() == "" ? "" : phraseCat4[3].ToString();
                                                                    string CheckDate = phraseCat4[4].ToString().Trim() == "" ? "" : phraseCat4[4].ToString();

                                                                    PdfPCell VendorName = new PdfPCell(new Phrase(Vendorname + "\n\n" + Amtpaid + "\n\n" + BundleNo + "\n" + PaymentNo + "\n" + CheckNo + "\n" + CheckDate, TableFont));
                                                                    VendorName.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                    VendorName.Border = iTextSharp.text.Rectangle.BOX;
                                                                    table.AddCell(VendorName);
                                                                }
                                                                else
                                                                {
                                                                    PdfPCell VendorName = new PdfPCell(new Phrase(Vendorname, TableFont));
                                                                    VendorName.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                    VendorName.Border = iTextSharp.text.Rectangle.BOX;
                                                                    table.AddCell(VendorName);
                                                                }*/

                                                                if (CategoryCode == "04")
                                                                {
                                                                    PdfPTable TblVendor = new PdfPTable(1);
                                                                    TblVendor.TotalWidth = 150f;
                                                                    TblVendor.WidthPercentage = 100;
                                                                    TblVendor.LockedWidth = true;
                                                                    float[] TblVenwidths = new float[] { 150f };
                                                                    TblVendor.SetWidths(TblVenwidths);
                                                                    TblVendor.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                    TblVendor.SpacingAfter = 07f;

                                                                    string Amtpaid = phraseCat4[0].ToString().Trim() == "" ? "" : phraseCat4[0].ToString();
                                                                    string BundleNo = phraseCat4[1].ToString().Trim() == "" ? "" : phraseCat4[1].ToString();
                                                                    string PaymentNo = phraseCat4[2].ToString().Trim() == "" ? "" : phraseCat4[2].ToString();
                                                                    string CheckNo = phraseCat4[3].ToString().Trim() == "" ? "" : phraseCat4[3].ToString();
                                                                    string CheckDate = phraseCat4[4].ToString().Trim() == "" ? "" : phraseCat4[4].ToString();

                                                                    if (!string.IsNullOrEmpty(Vendorname))
                                                                    {
                                                                        PdfPCell VendorName = new PdfPCell(new Phrase(Vendorname + "\n\n", TableFont));
                                                                        VendorName.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                        VendorName.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                        TblVendor.AddCell(VendorName);
                                                                    }
                                                                    else
                                                                    {
                                                                        PdfPCell VendorName = new PdfPCell(new Phrase(Vendorname, TableFont));
                                                                        VendorName.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                        VendorName.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                        TblVendor.AddCell(VendorName);
                                                                    }

                                                                    if (!string.IsNullOrEmpty(Amtpaid))
                                                                    {
                                                                        PdfPCell amtpaid = new PdfPCell(new Phrase(Amtpaid + "\n\n", TableFont));
                                                                        amtpaid.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                        amtpaid.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                        TblVendor.AddCell(amtpaid);
                                                                    }
                                                                    else
                                                                    {
                                                                        PdfPCell amtpaid = new PdfPCell(new Phrase(Amtpaid, TableFont));
                                                                        amtpaid.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                        amtpaid.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                        TblVendor.AddCell(amtpaid);
                                                                    }

                                                                    PdfPCell bundleNo = new PdfPCell(new Phrase(BundleNo, TblFontBold));
                                                                    bundleNo.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                    bundleNo.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                    TblVendor.AddCell(bundleNo);

                                                                    PdfPCell paymentNo = new PdfPCell(new Phrase(PaymentNo, TblFontBold));
                                                                    paymentNo.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                    paymentNo.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                    TblVendor.AddCell(paymentNo);

                                                                    PdfPCell checkNo = new PdfPCell(new Phrase(CheckNo, TblFontBold));
                                                                    checkNo.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                    checkNo.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                    TblVendor.AddCell(checkNo);

                                                                    PdfPCell checkDate = new PdfPCell(new Phrase(CheckDate, TblFontBold));
                                                                    checkDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                    checkDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                    TblVendor.AddCell(checkDate);

                                                                    PdfPCell NestedRow = new PdfPCell(TblVendor);
                                                                    NestedRow.Padding = 0f;
                                                                    NestedRow.Border = iTextSharp.text.Rectangle.BOX;
                                                                    NestedRow.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                    table.AddCell(NestedRow);
                                                                }
                                                                else
                                                                {
                                                                    PdfPCell VendorName = new PdfPCell(new Phrase(Vendorname, TableFont));
                                                                    VendorName.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                    VendorName.Border = iTextSharp.text.Rectangle.BOX;
                                                                    table.AddCell(VendorName);
                                                                }

                                                                PdfPCell RowDate = new PdfPCell(new Phrase(CaDate, TableFont));
                                                                RowDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                RowDate.Border = iTextSharp.text.Rectangle.BOX;
                                                                table.AddCell(RowDate);

                                                                PdfPCell RowDate_Foolow = new PdfPCell(completedate);
                                                                RowDate_Foolow.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                RowDate_Foolow.Border = iTextSharp.text.Rectangle.BOX;
                                                                table.AddCell(RowDate_Foolow);

                                                                if (CategoryCode == "04")
                                                                {
                                                                    PdfPCell NestedCell = new PdfPCell(servDetails);
                                                                    NestedCell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                    NestedCell.Border = iTextSharp.text.Rectangle.BOX;
                                                                    NestedCell.NoWrap = false;
                                                                    table.AddCell(NestedCell);
                                                                }
                                                                else
                                                                {
                                                                    PdfPCell ServDetails = new PdfPCell(servDetails);
                                                                    ServDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                    ServDetails.Border = iTextSharp.text.Rectangle.BOX;
                                                                    table.AddCell(ServDetails);
                                                                }
                                                            }
                                                            else
                                                            {
                                                                PdfPCell RowDate = new PdfPCell(new Phrase(CaDate, TableFont));
                                                                RowDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                RowDate.Border = iTextSharp.text.Rectangle.BOX;
                                                                table.AddCell(RowDate);

                                                                PdfPCell RowDate_Foolow = new PdfPCell(completedate);
                                                                RowDate_Foolow.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                RowDate_Foolow.Border = iTextSharp.text.Rectangle.BOX;
                                                                table.AddCell(RowDate_Foolow);

                                                                PdfPCell NestedCell = new PdfPCell(servDetails);
                                                                NestedCell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                NestedCell.Border = iTextSharp.text.Rectangle.BOX;
                                                                NestedCell.Colspan = 2;
                                                                NestedCell.NoWrap = false;
                                                                table.AddCell(NestedCell);

                                                                //PdfPCell ServDetails = new PdfPCell(phrase);
                                                                //ServDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                //ServDetails.Colspan = 2;
                                                                //ServDetails.Border = iTextSharp.text.Rectangle.BOX;
                                                                //table.AddCell(ServDetails);
                                                            }

                                                        }
                                                    }
                                                    else
                                                    {
                                                        PdfPCell VendorName = new PdfPCell(new Phrase("", TableFont));
                                                        VendorName.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        VendorName.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        table.AddCell(VendorName);

                                                        PdfPCell RowDate = new PdfPCell(new Phrase("", TableFont));
                                                        RowDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        RowDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        table.AddCell(RowDate);

                                                        PdfPCell RowDate_Foolow = new PdfPCell(new Phrase("", TableFont));
                                                        RowDate_Foolow.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        RowDate_Foolow.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        table.AddCell(RowDate_Foolow);

                                                        PdfPCell ServDetails = new PdfPCell(new Phrase("", TableFont));
                                                        ServDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        ServDetails.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        table.AddCell(ServDetails);
                                                    }

                                                }
                                                else
                                                {
                                                    PdfPCell topline = new PdfPCell(new Phrase("", TblFontBold));
                                                    topline.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    topline.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                                    topline.FixedHeight = 15f;
                                                    topline.Colspan = 4;
                                                    table.AddCell(topline);

                                                    PdfPCell ServicesDesc = new PdfPCell(new Phrase("Service: ", Sideheading));
                                                    ServicesDesc.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    ServicesDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    table.AddCell(ServicesDesc);

                                                    PdfPCell RowDesc = new PdfPCell(new Phrase(CAMSDesc.Trim(), TblFontBold));
                                                    RowDesc.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    RowDesc.Colspan = 3;
                                                    RowDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    table.AddCell(RowDesc);

                                                    PdfPCell bottomline = new PdfPCell(new Phrase("", TblFontBold));
                                                    bottomline.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    bottomline.Colspan = 4;
                                                    bottomline.Border = iTextSharp.text.Rectangle.TOP_BORDER;
                                                    table.AddCell(bottomline);

                                                }
                                            }
                                        }
                                        else
                                        {
                                            if (isoutcome)
                                            {
                                                PdfPCell ServicesHeader = new PdfPCell(new Phrase("", fc1));
                                                ServicesHeader.HorizontalAlignment = Element.ALIGN_CENTER;
                                                ServicesHeader.Colspan = 4;
                                                ServicesHeader.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(ServicesHeader);

                                                ServicesHeader = new PdfPCell(new Phrase("Outcomes", fc1));
                                                ServicesHeader.HorizontalAlignment = Element.ALIGN_CENTER;
                                                ServicesHeader.Colspan = 4;
                                                ServicesHeader.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(ServicesHeader);

                                                isoutcome = false;
                                            }
                                            //string Priv_Cams_Desc = null;
                                            DataSet MSMast = DatabaseLayer.SPAdminDB.Browse_MSMAST(null, dr["sp2_cams_code"].ToString().Trim(), null, null, null);

                                            if (MSMast.Tables[0].Rows.Count > 0)
                                            {
                                                DataRow drMSMast = MSMast.Tables[0].Rows[0];

                                                CAMSDesc = drMSMast["MS_DESC"].ToString();
                                                string MSType = drMSMast["MS_TYPE"].ToString();
                                                string Type_Desc = string.Empty;
                                                //if (MSType == "M")
                                                //    Type_Desc = "Milestone";
                                                //else
                                                Type_Desc = "Outcome";

                                                /*Search_MS_Details.Agency = BaseForm.BaseAgency;
                                                Search_MS_Details.Dept = BaseForm.BaseDept;
                                                Search_MS_Details.Program = BaseForm.BaseProg;
                                                //Search_MS_Details.Year = BaseYear;
                                                Search_MS_Details.Year = Entity.year;                              // Year will be always Four-Spaces in CASEMS
                                                Search_MS_Details.App_no = BaseForm.BaseApplicationNo;
                                                Search_MS_Details.MS_Code = dr["sp2_cams_code"].ToString().Trim();
                                                Search_MS_Details.SPM_Seq = Entity.Seq;

                                                Search_MS_Details.Service_plan = Entity.service_plan;
                                                Search_MS_Details.Branch = Branch.Trim(); Search_MS_Details.Group = dr["sp2_orig_grp"].ToString().Trim();
                                                Search_MS_Details.ID = Search_MS_Details.Date = Search_MS_Details.CaseWorker = Search_MS_Details.Site = null;
                                                Search_MS_Details.Result = Search_MS_Details.OBF = Search_MS_Details.Add_Operator = null;
                                                Search_MS_Details.Lstc_Date = Search_MS_Details.Lsct_Operator = Search_MS_Details.Add_Date = Search_MS_Details.Bulk =
                                                Search_MS_Details.Acty_PROG = Search_MS_Details.Curr_Grp = null;

                                                //SP_MS_Details = _model.SPAdminData.Browse_CASEMS(Search_MS_Details, "Browse");
                                                //SP_MS_Details = SP_MS_Details.OrderByDescending(u => Convert.ToDateTime(u.Date.Trim())).ToList();*/

                                                List<CASEMSEntity> SelOutcomes = SP_MS_Details.FindAll(u => u.MS_Code.Trim() == dr["sp2_cams_code"].ToString().Trim());

                                                if (SelOutcomes.Count > 0)
                                                {

                                                    PdfPCell ServicesDesc = new PdfPCell(new Phrase("Outcome: ", Sideheading));
                                                    ServicesDesc.HorizontalAlignment = Element.ALIGN_LEFT; ServicesDesc.FixedHeight = 20f;
                                                    ServicesDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    table.AddCell(ServicesDesc);

                                                    PdfPCell RowDesc = new PdfPCell(new Phrase(CAMSDesc.Trim(), TblFontBold));
                                                    RowDesc.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    RowDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    RowDesc.Colspan = 3; RowDesc.FixedHeight = 20f;
                                                    table.AddCell(RowDesc);
                                                    Priv_Cams_Desc = CAMSDesc.Trim();

                                                    PdfPCell VendorCol = new PdfPCell(new Phrase("Result", TblFontBold));
                                                    VendorCol.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    VendorCol.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    VendorCol.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                    VendorCol.BorderWidthBottom = 0.7f;
                                                    table.AddCell(VendorCol);

                                                    PdfPCell ServiceDate = new PdfPCell(new Phrase("Outcome Date", TblFontBold));
                                                    ServiceDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    ServiceDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    ServiceDate.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                    ServiceDate.BorderWidthBottom = 0.7f;
                                                    table.AddCell(ServiceDate);

                                                    PdfPCell FollowUpDate = new PdfPCell(new Phrase("FollowUp", TblFontBold));
                                                    FollowUpDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    FollowUpDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    FollowUpDate.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                    FollowUpDate.BorderWidthBottom = 0.7f;
                                                    table.AddCell(FollowUpDate);

                                                    PdfPCell OutcomeDetails = new PdfPCell(new Phrase("Outcome Details", TblFontBold));
                                                    OutcomeDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    OutcomeDetails.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    OutcomeDetails.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#ededed"));
                                                    OutcomeDetails.BorderWidthBottom = 0.7f;
                                                    table.AddCell(OutcomeDetails);
                                                    Priv_Branch = Branch;
                                                    First = false;

                                                    if (SelOutcomes.Count > 0)
                                                    {
                                                        foreach (CASEMSEntity entity in SelOutcomes)
                                                        {
                                                            Phrase phrase = new Phrase();
                                                            Phrase completedate = new Phrase();
                                                            PdfPTable outDetails = new PdfPTable(2);
                                                            string strType = CommonFunctions.FollowupIndicatior(entity.MS_FUP_Date);
                                                            CaDate = LookupDataAccess.Getdate(entity.Date).ToString();

                                                            if (entity.MS_Comp_Date != "")
                                                            {
                                                                CaDate_Follow_on = LookupDataAccess.Getdate(entity.MS_FUP_Date).ToString();
                                                                completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                            }
                                                            else if (entity.MS_FUP_Date != "" && entity.MS_Comp_Date == "" && strType == "R")
                                                            {
                                                                CaDate_Follow_on = LookupDataAccess.Getdate(entity.MS_FUP_Date).ToString();
                                                                completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                completedate.Add(new Chunk("!", TableFontRed));
                                                            }
                                                            else if (entity.MS_FUP_Date != "" && entity.MS_Comp_Date == "" && strType == "Y")
                                                            {
                                                                CaDate_Follow_on = LookupDataAccess.Getdate(entity.MS_FUP_Date).ToString();
                                                                completedate.Add(new Chunk(CaDate_Follow_on, TableFont));
                                                                completedate.Add(new Chunk("!", TableFontYellow));
                                                            }

                                                            outDetails.TotalWidth = 240f;
                                                            outDetails.WidthPercentage = 100;
                                                            outDetails.LockedWidth = true;
                                                            float[] serwidths = new float[] { 90f, 150f };
                                                            outDetails.SetWidths(serwidths);
                                                            outDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            outDetails.SpacingAfter = 07f;

                                                            CaseWorker = "Case Worker: " + GetWorkerName(entity.CaseWorker);// + ", ";
                                                                                                                            //if (!string.IsNullOrEmpty(entity.CaseWorker.Trim()))
                                                                                                                            //{
                                                                                                                            //**phrase.Add(new Chunk(CaseWorker, TableFont));

                                                            PdfPCell wrker = new PdfPCell(new Phrase(CaseWorker, TableFont));
                                                            wrker.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            wrker.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                            wrker.Colspan = 2;
                                                            outDetails.AddCell(wrker);
                                                            //}


                                                            Site = "Site: " + GetSiteName(entity.Site);// + ", ";
                                                                                                       //if (!string.IsNullOrEmpty(entity.Site.Trim()))
                                                                                                       //{
                                                                                                       //**phrase.Add(new Chunk(Site, TableFont));

                                                            PdfPCell site = new PdfPCell(new Phrase(Site, TableFont));
                                                            site.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            site.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                            site.Colspan = 2;
                                                            outDetails.AddCell(site);
                                                            //}

                                                            //if (entity.MS_Comp_Date != "")
                                                            //{
                                                            CompleteDte = "Complete Date: " + LookupDataAccess.Getdate(entity.MS_Comp_Date).ToString();// + ", ";
                                                                                                                                                       //**phrase.Add(new Chunk(CompleteDte, TableFont));

                                                            PdfPCell cmpDte = new PdfPCell(new Phrase(CompleteDte, TableFont));
                                                            cmpDte.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            cmpDte.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                            cmpDte.Colspan = 2;
                                                            outDetails.AddCell(cmpDte);
                                                            //}

                                                            Program = "Program: " + Set_SP_Program_TextReport(entity.Acty_PROG);
                                                            //if (!string.IsNullOrEmpty(entity.Acty_PROG.Trim()))
                                                            //{
                                                            //**phrase.Add(new Chunk(Program, TableFont));

                                                            PdfPCell progrm = new PdfPCell(new Phrase(Program, TableFont));
                                                            progrm.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            progrm.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                            progrm.Colspan = 2;
                                                            outDetails.AddCell(progrm);
                                                            // }

                                                            PdfPCell RowDate_Result = new PdfPCell(new Phrase(MsResultDescription(entity.Result.Trim()), TableFont));
                                                            RowDate_Result.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            RowDate_Result.Border = iTextSharp.text.Rectangle.BOX;
                                                            table.AddCell(RowDate_Result);

                                                            PdfPCell RowDate = new PdfPCell(new Phrase(CaDate, TableFont));
                                                            RowDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            RowDate.Border = iTextSharp.text.Rectangle.BOX;
                                                            table.AddCell(RowDate);

                                                            PdfPCell RowDate_Foolow = new PdfPCell(completedate);
                                                            RowDate_Foolow.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            RowDate_Foolow.Border = iTextSharp.text.Rectangle.BOX;
                                                            table.AddCell(RowDate_Foolow);

                                                            PdfPCell ServDetails = new PdfPCell(outDetails);//(phrase);
                                                            ServDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            ServDetails.Border = iTextSharp.text.Rectangle.BOX;
                                                            table.AddCell(ServDetails);

                                                        }
                                                    }
                                                    else
                                                    {
                                                        PdfPCell RowDate_Result = new PdfPCell(new Phrase("", TableFont));
                                                        RowDate_Result.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        RowDate_Result.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        table.AddCell(RowDate_Result);

                                                        PdfPCell RowDate = new PdfPCell(new Phrase("", TableFont));
                                                        RowDate.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        RowDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        table.AddCell(RowDate);

                                                        PdfPCell RowDate_Foolow = new PdfPCell(new Phrase("", TableFont));
                                                        RowDate_Foolow.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        RowDate_Foolow.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        table.AddCell(RowDate_Foolow);

                                                        OutcomeDetails = new PdfPCell(new Phrase("", TableFont));
                                                        OutcomeDetails.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        OutcomeDetails.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        table.AddCell(OutcomeDetails);
                                                    }
                                                }
                                                else
                                                {
                                                    PdfPCell topline = new PdfPCell(new Phrase("", TblFontBold));
                                                    topline.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    topline.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                                    topline.FixedHeight = 15f;
                                                    topline.Colspan = 4;
                                                    table.AddCell(topline);

                                                    PdfPCell ServicesDesc = new PdfPCell(new Phrase("Outcome: ", Sideheading));
                                                    ServicesDesc.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    ServicesDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    table.AddCell(ServicesDesc);

                                                    PdfPCell RowDesc = new PdfPCell(new Phrase(CAMSDesc.Trim(), TblFontBold));
                                                    RowDesc.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    RowDesc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    RowDesc.Colspan = 3;
                                                    table.AddCell(RowDesc);
                                                    Priv_Cams_Desc = CAMSDesc.Trim();

                                                    PdfPCell bottomline = new PdfPCell(new Phrase("", TblFontBold));
                                                    bottomline.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    bottomline.Colspan = 4;
                                                    bottomline.Border = iTextSharp.text.Rectangle.TOP_BORDER;
                                                    table.AddCell(bottomline);
                                                }
                                            }
                                        }
                                    }
                                }
                                else
                                {
                                    First = false;
                                }
                                i++;
                            }

                        }
                        if (table.Rows.Count > 0)
                        {
                            document.Add(Header);
                            document.Add(topTable);
                            document.Add(table);
                        }

                        if (SPMTable.Rows.Count > 0)
                        {
                            document.NewPage();
                            Header.DeleteBodyRows();
                            topTable.DeleteBodyRows();
                            table.DeleteBodyRows();
                        }
                    }
                }
            }



            //document.Add(SPMTable);

            document.Close();
            fs.Close();
            fs.Dispose();
        }


        //private void CaseSpmPdfAllHiers()
        //{
        //    Random_Filename = null;

        //    PdfName = "S" + BaseForm.BaseApplicationNo.ToString();//form.GetFileName();
        //    PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
        //    try
        //    {
        //        if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
        //        { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
        //    }
        //    catch (Exception ex)
        //    {
        //        CommonFunctions.MessageBoxDisplay("Error");
        //    }


        //    try
        //    {
        //        string Tmpstr = PdfName + ".pdf";
        //        if (File.Exists(Tmpstr))
        //            File.Delete(Tmpstr);
        //    }
        //    catch (Exception ex)
        //    {
        //        int length = 8;
        //        string newFileName = System.Guid.NewGuid().ToString();
        //        newFileName = newFileName.Replace("-", string.Empty);

        //        Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
        //    }

        //    if (!string.IsNullOrEmpty(Random_Filename))
        //        PdfName = Random_Filename;
        //    else
        //        PdfName += ".pdf";

        //    FileStream fs = new FileStream(PdfName, FileMode.Create);

        //    Document document = new Document(PageSize.A4, 25, 25, 30, 30);
        //    PdfWriter writer = PdfWriter.GetInstance(document, fs);
        //    document.Open();

        //    cb = writer.DirectContent;

        //    BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
        //    iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
        //    BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
        //    iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(1, 9, 4);
        //    BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

        //    iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
        //    iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
        //    iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
        //    iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(1, 9, 1);
        //    iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
        //    iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);

        //    PdfPTable SPMTable = new PdfPTable(5);
        //    SPMTable.TotalWidth = 550f;
        //    SPMTable.WidthPercentage = 100;
        //    SPMTable.LockedWidth = true;
        //    float[] widths2 = new float[] { 15f, 70f, 40f, 35f, 20f };
        //    SPMTable.SetWidths(widths2);
        //    SPMTable.HorizontalAlignment = Element.ALIGN_CENTER;

        //    if (CASEMSTList.Count > 0)
        //    {

        //        foreach (CaseMstEntity casemstEntity in CASEMSTList)
        //        {
        //            //programEntity = _model.HierarchyAndPrograms.GetCaseDepadp(casemstEntity.ApplAgency, casemstEntity.ApplDept, casemstEntity.ApplProgram);
        //            programEntity = caseHierarchy.Find(u => u.Agency.Equals(casemstEntity.ApplAgency) && u.Dept.Equals(casemstEntity.ApplDept) && u.Prog.Equals(casemstEntity.ApplProgram));

        //            DataSet ds = Captain.DatabaseLayer.SPAdminDB.Browse_CASESP1(string.Empty, casemstEntity.ApplAgency, casemstEntity.ApplDept, casemstEntity.ApplProgram, string.Empty);
        //            dsSite = Captain.DatabaseLayer.CaseMst.GetSiteByHIE(casemstEntity.ApplAgency, string.Empty, string.Empty);
        //            //DataTable dt = new DataTable();
        //            if (ds.Tables.Count > 0)
        //                dtSP1 = ds.Tables[0];

        //            string ProgramName = string.Empty;
        //            if (programEntity != null)
        //                ProgramName = programEntity.HirarchyName;

        //            SelSnp = casesnpList.Find(u => u.App.Equals(casemstEntity.ApplNo) && u.FamilySeq.Equals(casemstEntity.FamilySeq));
        //            Fill_CaseWorker(casemstEntity.ApplAgency, casemstEntity.ApplDept, casemstEntity.ApplProgram, casemstEntity.ApplYr);

        //            List<CASESPMEntity> SelSpmList = spmlist.FindAll(u => u.agency.Equals(casemstEntity.ApplAgency) && u.dept.Equals(casemstEntity.ApplDept) && u.program.Equals(casemstEntity.ApplProgram) && u.year.Trim().Equals(casemstEntity.ApplYr) && u.app_no.Equals(casemstEntity.ApplNo));

        //            if (SelSpmList.Count > 0)
        //            {
        //                PdfPCell H1 = new PdfPCell(new Phrase("Hierarchy:" + casemstEntity.ApplAgency + "-" + casemstEntity.ApplDept + "-" + casemstEntity.ApplProgram + " " + casemstEntity.ApplYr + "  " + ProgramName, TblFontBold));
        //                H1.HorizontalAlignment = Element.ALIGN_LEFT;
        //                H1.Colspan = 2;
        //                H1.FixedHeight = 15f;
        //                H1.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                SPMTable.AddCell(H1);

        //                PdfPCell H2 = new PdfPCell(new Phrase("App:" + casemstEntity.ApplNo + "  " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), TblFontBold));
        //                H2.HorizontalAlignment = Element.ALIGN_RIGHT;
        //                H2.Colspan = 3;
        //                H2.FixedHeight = 15f;
        //                H2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                SPMTable.AddCell(H2);

        //                PdfPCell S2 = new PdfPCell(new Phrase("", TblFontBold));
        //                S2.HorizontalAlignment = Element.ALIGN_CENTER;
        //                S2.Colspan = 5;
        //                S2.FixedHeight = 15f;
        //                S2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                SPMTable.AddCell(S2);

        //                PdfPCell Header = new PdfPCell(new Phrase("Service Plans", TblFontBold));
        //                Header.HorizontalAlignment = Element.ALIGN_CENTER;
        //                Header.Colspan = 5;
        //                Header.FixedHeight = 15f;
        //                Header.Border = iTextSharp.text.Rectangle.BOX;
        //                SPMTable.AddCell(Header);

        //                string[] HeaderSeq = { "Code", "Description", "Site", "CaseWorker", "Start Date" };
        //                for (int i = 0; i < HeaderSeq.Length; ++i)
        //                {
        //                    PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
        //                    cell.HorizontalAlignment = Element.ALIGN_CENTER;
        //                    //cell.FixedHeight = 15f;
        //                    cell.Border = iTextSharp.text.Rectangle.BOX;
        //                    SPMTable.AddCell(cell);
        //                }


        //                bool first = false;
        //                foreach (CASESPMEntity Entity in SelSpmList)
        //                {
        //                    if (first)
        //                    {
        //                        PdfPCell Header1 = new PdfPCell(new Phrase("Service Plan", TblFontBold));
        //                        Header1.HorizontalAlignment = Element.ALIGN_CENTER;
        //                        Header1.Colspan = 5;
        //                        Header1.FixedHeight = 15f;
        //                        Header1.Border = iTextSharp.text.Rectangle.BOX;
        //                        SPMTable.AddCell(Header1);

        //                        string[] HeaderSeq1 = { "Code", "Description", "Site", "CaseWorker", "Start Date" };
        //                        for (int i = 0; i < HeaderSeq1.Length; ++i)
        //                        {
        //                            PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq1[i], TblFontBold));
        //                            cell.HorizontalAlignment = Element.ALIGN_CENTER;
        //                            //cell.FixedHeight = 15f;
        //                            cell.Border = iTextSharp.text.Rectangle.BOX;
        //                            SPMTable.AddCell(cell);
        //                        }
        //                    }


        //                    PdfPCell A1 = new PdfPCell(new Phrase(Entity.service_plan, TableFont));
        //                    A1.HorizontalAlignment = Element.ALIGN_LEFT;
        //                    A1.Border = iTextSharp.text.Rectangle.BOX;
        //                    SPMTable.AddCell(A1);

        //                    PdfPCell A2 = new PdfPCell(new Phrase(Entity.Sp0_Desc, TableFont));
        //                    A2.HorizontalAlignment = Element.ALIGN_LEFT;
        //                    A2.Border = iTextSharp.text.Rectangle.BOX;
        //                    SPMTable.AddCell(A2);

        //                    PdfPCell A3 = new PdfPCell(new Phrase(Entity.Site_Desc, TableFont));
        //                    A3.HorizontalAlignment = Element.ALIGN_LEFT;
        //                    A3.Border = iTextSharp.text.Rectangle.BOX;
        //                    SPMTable.AddCell(A3);

        //                    PdfPCell A4 = new PdfPCell(new Phrase(Get_CaseWorker_DESC(Entity.caseworker), TableFont));
        //                    A4.HorizontalAlignment = Element.ALIGN_LEFT;
        //                    A4.Border = iTextSharp.text.Rectangle.BOX;
        //                    SPMTable.AddCell(A4);

        //                    PdfPCell A5 = new PdfPCell(new Phrase(LookupDataAccess.Getdate(Entity.startdate.Trim()), TableFont));
        //                    A5.HorizontalAlignment = Element.ALIGN_LEFT;
        //                    A5.Border = iTextSharp.text.Rectangle.BOX;
        //                    SPMTable.AddCell(A5);


        //                    if (SPMTable.Rows.Count > 0)
        //                    {
        //                        document.Add(SPMTable);
        //                        SPMTable.DeleteBodyRows();
        //                    }
        //                    if (actList.Count > 0)
        //                    {
        //                        SP_Programs_List = _model.lookupDataAccess.Get_SerPlan_Prog_List(BaseForm.UserProfile.UserID, Entity.service_plan, string.Empty);

        //                        List<CASEACTEntity> SelActList = actList.FindAll(u => u.Service_plan.Equals(Entity.service_plan) && u.SPM_Seq.Equals(Entity.Seq) && u.Agency.Equals(Entity.agency) && u.Dept.Equals(Entity.dept) && u.Program.Equals(Entity.program) && u.Year.Equals(Entity.year) && u.App_no.Equals(Entity.app_no));
        //                        SelActList = SelActList.OrderBy(u => u.Service_plan).ThenBy(u => u.SPM_Seq).ThenBy(u => u.Branch).ThenBy(u => u.Group).ThenBy(u => u.ACT_Code).ToList();

        //                        if (SelActList.Count > 0) CASEACTPdf(document, SelActList);

        //                        List<CASEMSEntity> SelMSList = MSlist.FindAll(u => u.Service_plan.Equals(Entity.service_plan) && u.SPM_Seq.Equals(Entity.Seq) && u.Agency.Equals(Entity.agency) && u.Dept.Equals(Entity.dept) && u.Program.Equals(Entity.program) && u.Year.Equals(Entity.year) && u.App_no.Equals(Entity.app_no));
        //                        SelMSList = SelMSList.OrderBy(u => u.Service_plan).ThenBy(u => u.SPM_Seq).ThenBy(u => u.Branch).ThenBy(u => u.Group).ThenBy(u => u.MS_Code).ToList();

        //                        if (SelMSList.Count > 0) CASEMSPdf(document, SelMSList);

        //                        if (SelActList.Count > 0 || SelMSList.Count > 0)
        //                        {
        //                            first = true;
        //                        }
        //                        else first = false;
        //                    }
        //                }

        //                //if (SPMTable.Rows.Count > 0)
        //                document.NewPage();
        //            }
        //        }
        //    }



        //    document.Add(SPMTable);

        //    document.Close();
        //    fs.Close();
        //    fs.Dispose();
        //}

        private void CASEACTPdf(Document document, List<CASEACTEntity> SelList)
        {
            BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
            iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
            BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
            iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(bf_times, 9, 4);
            BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

            iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
            iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
            iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
            iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(bf_times, 9, 1);
            iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
            iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);

            PdfPTable ACTTable = new PdfPTable(6);
            ACTTable.TotalWidth = 550f;
            ACTTable.WidthPercentage = 100;
            ACTTable.LockedWidth = true;
            float[] widths2 = new float[] { 50f, 40f, 18f, 30f, 25f, 25f };
            ACTTable.SetWidths(widths2);
            ACTTable.HorizontalAlignment = Element.ALIGN_CENTER;


            PdfPCell Header = new PdfPCell(new Phrase("Services Activities", TblFontBold));
            Header.HorizontalAlignment = Element.ALIGN_LEFT;
            Header.Colspan = 6;
            Header.FixedHeight = 15f;
            Header.Border = iTextSharp.text.Rectangle.BOX;
            ACTTable.AddCell(Header);

            string[] HeaderSeq = { "Branch", "CA Description", "Date", "Site", "CaseWorker", "Program" };
            for (int i = 0; i < HeaderSeq.Length; ++i)
            {
                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                //cell.FixedHeight = 15f;
                cell.Border = iTextSharp.text.Rectangle.BOX;
                ACTTable.AddCell(cell);
            }

            foreach (CASEACTEntity Entity in SelList)
            {
                string BranchDesc = string.Empty;
                if (dtSP1.Rows.Count > 0)
                {
                    foreach (DataRow dr in dtSP1.Rows)
                    {
                        switch (Entity.Branch)
                        {
                            case "P": if (dr["SP0_PBRANCH_CODE"].ToString() == Entity.Branch) BranchDesc = dr["SP0_PBRANCH_DESC"].ToString(); break;
                            case "1": if (dr["SP0_BRANCH1_CODE"].ToString() == Entity.Branch) BranchDesc = dr["SP0_BRANCH1_DESC"].ToString(); break;
                            case "2": if (dr["SP0_BRANCH2_CODE"].ToString() == Entity.Branch) BranchDesc = dr["SP0_BRANCH2_DESC"].ToString(); break;
                            case "3": if (dr["SP0_BRANCH3_CODE"].ToString() == Entity.Branch) BranchDesc = dr["SP0_BRANCH3_DESC"].ToString(); break;
                            case "4": if (dr["SP0_BRANCH4_CODE"].ToString() == Entity.Branch) BranchDesc = dr["SP0_BRANCH4_DESC"].ToString(); break;
                            case "5": if (dr["SP0_BRANCH5_CODE"].ToString() == Entity.Branch) BranchDesc = dr["SP0_BRANCH5_DESC"].ToString(); break;
                        }
                    }
                }

                PdfPCell A1 = new PdfPCell(new Phrase(BranchDesc, TableFont));
                A1.HorizontalAlignment = Element.ALIGN_LEFT;
                A1.Border = iTextSharp.text.Rectangle.BOX;
                ACTTable.AddCell(A1);

                //PdfPCell A2 = new PdfPCell(new Phrase(Entity.Group, TableFont));
                //A2.HorizontalAlignment = Element.ALIGN_LEFT;
                //A2.Border = iTextSharp.text.Rectangle.BOX;
                //ACTTable.AddCell(A2);

                PdfPCell A3 = new PdfPCell(new Phrase(Get_CA_Desc(Entity.ACT_Code.Trim()), TableFont));
                A3.HorizontalAlignment = Element.ALIGN_LEFT;
                A3.Border = iTextSharp.text.Rectangle.BOX;
                ACTTable.AddCell(A3);

                PdfPCell A4 = new PdfPCell(new Phrase(LookupDataAccess.Getdate(Entity.ACT_Date.Trim()), TableFont));
                A4.HorizontalAlignment = Element.ALIGN_LEFT;
                A4.Border = iTextSharp.text.Rectangle.BOX;
                ACTTable.AddCell(A4);

                string SiteDesc = string.Empty;
                if (dsSite.Tables.Count > 0)
                {
                    DataTable Sites_Table = dsSite.Tables[0];
                    if (Sites_Table.Rows.Count > 0)
                    {
                        foreach (DataRow dr in Sites_Table.Rows)
                        {
                            if (Entity.Site.Trim() == dr["SITE_NUMBER"].ToString().Trim())
                            {
                                SiteDesc = dr["SITE_NAME"].ToString().Trim();
                                break;
                            }
                        }
                    }
                }

                PdfPCell A5 = new PdfPCell(new Phrase(SiteDesc, TableFont));
                A5.HorizontalAlignment = Element.ALIGN_LEFT;
                A5.Border = iTextSharp.text.Rectangle.BOX;
                ACTTable.AddCell(A5);

                PdfPCell A6 = new PdfPCell(new Phrase(Get_CaseWorker_DESC(Entity.Caseworker.Trim()), TableFont));
                A6.HorizontalAlignment = Element.ALIGN_LEFT;
                A6.Border = iTextSharp.text.Rectangle.BOX;
                ACTTable.AddCell(A6);

                PdfPCell A7 = new PdfPCell(new Phrase(Set_SP_Program_Text(Entity.Act_PROG.Trim()), TableFont));
                A7.HorizontalAlignment = Element.ALIGN_LEFT;
                A7.Border = iTextSharp.text.Rectangle.BOX;
                ACTTable.AddCell(A7);

            }

            document.Add(ACTTable);


        }

        private void CASEMSPdf(Document document, List<CASEMSEntity> SelList)
        {
            BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
            iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
            BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
            iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(bf_times, 9, 4);
            BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

            iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
            iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
            iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
            iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(bf_times, 9, 1);
            iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
            iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);

            PdfPTable MSTable = new PdfPTable(6);
            MSTable.TotalWidth = 550f;
            MSTable.WidthPercentage = 100;
            MSTable.LockedWidth = true;
            float[] widths2 = new float[] { 50f, 40f, 18f, 30f, 25f, 25f };
            MSTable.SetWidths(widths2);
            MSTable.HorizontalAlignment = Element.ALIGN_CENTER;

            PdfPCell Header = new PdfPCell(new Phrase("Milestones/Outcomes", TblFontBold));
            Header.HorizontalAlignment = Element.ALIGN_LEFT;
            Header.Colspan = 6;
            Header.FixedHeight = 15f;
            Header.Border = iTextSharp.text.Rectangle.BOX;
            MSTable.AddCell(Header);

            string[] HeaderSeq = { "Branch", "MS Description", "Date", "Site", "CaseWorker", "Program" };
            for (int i = 0; i < HeaderSeq.Length; ++i)
            {
                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                //cell.FixedHeight = 15f;
                cell.Border = iTextSharp.text.Rectangle.BOX;
                MSTable.AddCell(cell);
            }

            foreach (CASEMSEntity Entity in SelList)
            {
                string BranchDesc = string.Empty;
                if (dtSP1.Rows.Count > 0)
                {
                    foreach (DataRow dr in dtSP1.Rows)
                    {
                        switch (Entity.Branch)
                        {
                            case "P": if (dr["SP0_PBRANCH_CODE"].ToString() == Entity.Branch) BranchDesc = dr["SP0_PBRANCH_DESC"].ToString(); break;
                            case "1": if (dr["SP0_BRANCH1_CODE"].ToString() == Entity.Branch) BranchDesc = dr["SP0_BRANCH1_DESC"].ToString(); break;
                            case "2": if (dr["SP0_BRANCH2_CODE"].ToString() == Entity.Branch) BranchDesc = dr["SP0_BRANCH2_DESC"].ToString(); break;
                            case "3": if (dr["SP0_BRANCH3_CODE"].ToString() == Entity.Branch) BranchDesc = dr["SP0_BRANCH3_DESC"].ToString(); break;
                            case "4": if (dr["SP0_BRANCH4_CODE"].ToString() == Entity.Branch) BranchDesc = dr["SP0_BRANCH4_DESC"].ToString(); break;
                            case "5": if (dr["SP0_BRANCH5_CODE"].ToString() == Entity.Branch) BranchDesc = dr["SP0_BRANCH5_DESC"].ToString(); break;
                        }
                    }
                }

                PdfPCell A1 = new PdfPCell(new Phrase(BranchDesc, TableFont));
                A1.HorizontalAlignment = Element.ALIGN_LEFT;
                A1.Border = iTextSharp.text.Rectangle.BOX;
                MSTable.AddCell(A1);

                //PdfPCell A2 = new PdfPCell(new Phrase(Entity.Group, TableFont));
                //A2.HorizontalAlignment = Element.ALIGN_LEFT;
                //A2.Border = iTextSharp.text.Rectangle.BOX;
                //MSTable.AddCell(A2);

                PdfPCell A3 = new PdfPCell(new Phrase(Get_MS_Desc(Entity.MS_Code.Trim()), TableFont));
                A3.HorizontalAlignment = Element.ALIGN_LEFT;
                A3.Border = iTextSharp.text.Rectangle.BOX;
                MSTable.AddCell(A3);

                PdfPCell A4 = new PdfPCell(new Phrase(LookupDataAccess.Getdate(Entity.Date.Trim()), TableFont));
                A4.HorizontalAlignment = Element.ALIGN_LEFT;
                A4.Border = iTextSharp.text.Rectangle.BOX;
                MSTable.AddCell(A4);

                string SiteDesc = string.Empty;
                if (dsSite.Tables.Count > 0)
                {
                    DataTable Sites_Table = dsSite.Tables[0];
                    if (Sites_Table.Rows.Count > 0)
                    {
                        foreach (DataRow dr in Sites_Table.Rows)
                        {
                            if (Entity.Site.Trim() == dr["SITE_NUMBER"].ToString().Trim())
                            {
                                SiteDesc = dr["SITE_NAME"].ToString().Trim();
                                break;
                            }
                        }
                    }
                }
                PdfPCell A5 = new PdfPCell(new Phrase(SiteDesc, TableFont));
                A5.HorizontalAlignment = Element.ALIGN_LEFT;
                A5.Border = iTextSharp.text.Rectangle.BOX;
                MSTable.AddCell(A5);

                PdfPCell A6 = new PdfPCell(new Phrase(Get_CaseWorker_DESC(Entity.CaseWorker.Trim()), TableFont));
                A6.HorizontalAlignment = Element.ALIGN_LEFT;
                A6.Border = iTextSharp.text.Rectangle.BOX;
                MSTable.AddCell(A6);

                PdfPCell A7 = new PdfPCell(new Phrase(Set_SP_Program_Text(Entity.Acty_PROG.Trim()), TableFont));
                A7.HorizontalAlignment = Element.ALIGN_LEFT;
                A7.Border = iTextSharp.text.Rectangle.BOX;
                MSTable.AddCell(A7);

            }

            document.Add(MSTable);


        }

        //private void CaseCONTPdf(Document document)
        //{
        //    BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
        //    iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
        //    BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
        //    iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(1, 9, 4);
        //    BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

        //    iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
        //    iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
        //    iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
        //    iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(1, 9, 1);
        //    iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
        //    iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);

        //    PdfPTable ContTable = new PdfPTable(6);
        //    ContTable.TotalWidth = 550f;
        //    ContTable.WidthPercentage = 100;
        //    ContTable.LockedWidth = true;
        //    float[] widths2 = new float[] { 20f, 70f, 15f, 15f, 20f,35f };
        //    ContTable.SetWidths(widths2);
        //    ContTable.HorizontalAlignment = Element.ALIGN_CENTER;

        //    string ProgramName = string.Empty;
        //    if (programEntity != null)
        //        ProgramName = programEntity.AgencyName;

        //    PdfPCell H1 = new PdfPCell(new Phrase("Hierarchy:" + CASEMSTList[0].ApplAgency + "-" + CASEMSTList[0].ApplDept + "-" + CASEMSTList[0].ApplProgram + " " + CASEMSTList[0].ApplYr + "  " + ProgramName, TblFontBold));
        //    H1.HorizontalAlignment = Element.ALIGN_LEFT;
        //    H1.Colspan = 2;
        //    H1.FixedHeight = 15f;
        //    H1.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ContTable.AddCell(H1);

        //    PdfPCell H2 = new PdfPCell(new Phrase("App:" + CASEMSTList[0].ApplNo + "  " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), TblFontBold));
        //    H2.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    H2.Colspan = 4;
        //    H2.FixedHeight = 15f;
        //    H2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ContTable.AddCell(H2);

        //    PdfPCell S2 = new PdfPCell(new Phrase("", TblFontBold));
        //    S2.HorizontalAlignment = Element.ALIGN_CENTER;
        //    S2.Colspan = 6;
        //    S2.FixedHeight = 15f;
        //    S2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ContTable.AddCell(S2);

        //    PdfPCell Header = new PdfPCell(new Phrase("Contact Data", TblFontBold));
        //    Header.HorizontalAlignment = Element.ALIGN_CENTER;
        //    Header.Colspan = 6;
        //    Header.FixedHeight = 15f;
        //    Header.Border = iTextSharp.text.Rectangle.BOX;
        //    ContTable.AddCell(Header);

        //    string[] HeaderSeq = { "Date", "Contact Name", "Where", "Time", "Language","Case Worker" };
        //    for (int i = 0; i < HeaderSeq.Length; ++i)
        //    {
        //        PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
        //        cell.HorizontalAlignment = Element.ALIGN_CENTER;
        //        //cell.FixedHeight = 15f;
        //        cell.Border = iTextSharp.text.Rectangle.BOX;
        //        ContTable.AddCell(cell);
        //    }

        //    foreach (CASECONTEntity Entity in ContList)
        //    {
        //        PdfPCell A1 = new PdfPCell(new Phrase(LookupDataAccess.Getdate(Entity.Cont_Date.Trim()), TableFont));
        //        A1.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A1.Border = iTextSharp.text.Rectangle.BOX;
        //        ContTable.AddCell(A1);

        //        PdfPCell A2 = new PdfPCell(new Phrase(Entity.Contact_Name, TableFont));
        //        A2.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A2.Border = iTextSharp.text.Rectangle.BOX;
        //        ContTable.AddCell(A2);

        //        PdfPCell A3 = new PdfPCell(new Phrase(Entity.How_Where, TableFont));
        //        A3.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A3.Border = iTextSharp.text.Rectangle.BOX;
        //        ContTable.AddCell(A3);

        //        PdfPCell A4 = new PdfPCell(new Phrase(Entity.Duration, TableFont));
        //        A4.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A4.Border = iTextSharp.text.Rectangle.BOX;
        //        ContTable.AddCell(A4);

        //        PdfPCell A5 = new PdfPCell(new Phrase(Get_Language_Desc(Entity.Language), TableFont));
        //        A5.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A5.Border = iTextSharp.text.Rectangle.BOX;
        //        ContTable.AddCell(A5);

        //        PdfPCell A6 = new PdfPCell(new Phrase(Get_CaseWorker_DESC(Entity.CaseWorker), TableFont));
        //        A6.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A6.Border = iTextSharp.text.Rectangle.BOX;
        //        ContTable.AddCell(A6);
        //    }

        //    document.Add(ContTable);

        //}

        private void CaseCONTPdf()
        {
            Random_Filename = null;

            PdfName = "C" + BaseForm.BaseApplicationNo.ToString();//form.GetFileName();
            PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
            try
            {
                if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
            }
            catch (Exception ex)
            {
                CommonFunctions.MessageBoxDisplay("Error");
            }


            try
            {
                string Tmpstr = PdfName + ".pdf";
                if (File.Exists(Tmpstr))
                    File.Delete(Tmpstr);
            }
            catch (Exception ex)
            {
                int length = 8;
                string newFileName = System.Guid.NewGuid().ToString();
                newFileName = newFileName.Replace("-", string.Empty);

                Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
            }

            if (!string.IsNullOrEmpty(Random_Filename))
                PdfName = Random_Filename;
            else
                PdfName += ".pdf";

            FileStream fs = new FileStream(PdfName, FileMode.Create);

            Document document = new Document(PageSize.A4, 25, 25, 30, 30);
            PdfWriter writer = PdfWriter.GetInstance(document, fs);
            document.Open();

            cb = writer.DirectContent;

            BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
            iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
            BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
            iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(bf_times, 9, 4);
            BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

            iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
            iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
            iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
            iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(bf_times, 9, 1);
            iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
            iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);

            BaseFont bf_Calibri = BaseFont.CreateFont("c:/windows/fonts/calibri.ttf", BaseFont.WINANSI, BaseFont.EMBEDDED);
            iTextSharp.text.Font fc1 = new iTextSharp.text.Font(bf_Calibri, 10, 1, new BaseColor(System.Drawing.ColorTranslator.FromHtml("#6499c1")));


            PdfPTable mainHeader = new PdfPTable(2);
            mainHeader.TotalWidth = 510f;
            mainHeader.WidthPercentage = 100;
            mainHeader.LockedWidth = true;
            float[] Headerwidths = new float[] { 50f, 17f };
            mainHeader.SetWidths(Headerwidths);
            mainHeader.HorizontalAlignment = Element.ALIGN_CENTER;
            mainHeader.SpacingAfter = 07f;

            PdfPTable ContTable = new PdfPTable(6);
            ContTable.TotalWidth = 550f;
            ContTable.WidthPercentage = 100;
            ContTable.LockedWidth = true;
            float[] widths2 = new float[] { 20f, 50f/*70f*/, 35f/*15f*/, 15f, 20f, 35f };
            ContTable.SetWidths(widths2);
            ContTable.HorizontalAlignment = Element.ALIGN_CENTER;

            List<CommonEntity> AgyTabs_List = CommonFunctions.AgyTabsFilterCode(BaseForm.BaseAgyTabsEntity, "03340", BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, string.Empty);
            string HowWhere = string.Empty;

            if (chkbAllHier.Checked)
            {
                if (CASEMSTList.Count > 0)
                {
                    foreach (CaseMstEntity MstEntity in CASEMSTList)
                    {
                        //programEntity = _model.HierarchyAndPrograms.GetCaseDepadp(MstEntity.ApplAgency, MstEntity.ApplDept, MstEntity.ApplProgram);
                        programEntity = caseHierarchy.Find(u => u.Agency.Equals(MstEntity.ApplAgency) && u.Dept.Equals(MstEntity.ApplDept) && u.Prog.Equals(MstEntity.ApplProgram));

                        string ProgramName = string.Empty;
                        if (programEntity != null)
                            ProgramName = programEntity.HirarchyName;

                        SelSnp = casesnpList.Find(u => u.App.Equals(MstEntity.ApplNo) && u.FamilySeq.Equals(MstEntity.FamilySeq));
                        Fill_CaseWorker(MstEntity.ApplAgency, MstEntity.ApplDept, MstEntity.ApplProgram, MstEntity.ApplYr);

                        List<CASECONTEntity> SelContList = ContList.FindAll(u => u.Agency.Equals(MstEntity.ApplAgency) && u.Dept.Equals(MstEntity.ApplDept) && u.Program.Equals(MstEntity.ApplProgram) && u.Year.Trim().Equals(MstEntity.ApplYr) && u.App_no.Equals(MstEntity.ApplNo));

                        if (SelContList.Count > 0)
                        {
                            /******************************* Head  1 ********************************************/

                            PdfPCell AppName = new PdfPCell(new Phrase("Applicant Name: " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), fc1));
                            AppName.HorizontalAlignment = Element.ALIGN_LEFT;
                            AppName.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            mainHeader.AddCell(AppName);

                            PdfPCell Application = new PdfPCell(new Phrase("App#: " + MstEntity.ApplNo, fc1));
                            Application.HorizontalAlignment = Element.ALIGN_RIGHT;
                            Application.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            mainHeader.AddCell(Application);

                            //PdfPCell space = new PdfPCell(new Phrase("", fc1));
                            //space.HorizontalAlignment = Element.ALIGN_LEFT;
                            //space.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            //mainHeader.AddCell(space);

                            PdfPCell Hierarchy = new PdfPCell(new Phrase("Intake Hierarchy: " + MstEntity.ApplAgency + "-" + MstEntity.ApplDept + "-" + MstEntity.ApplProgram + " " + MstEntity.ApplYr + "  " + ProgramName, fc1));
                            Hierarchy.HorizontalAlignment = Element.ALIGN_RIGHT;
                            Hierarchy.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            Hierarchy.Colspan = 2;
                            mainHeader.AddCell(Hierarchy);

                            /***************************************************************************/

                            /* PdfPCell H1 = new PdfPCell(new Phrase("Hierarchy:" + MstEntity.ApplAgency + "-" + MstEntity.ApplDept + "-" + MstEntity.ApplProgram + " " + MstEntity.ApplYr + "  " + ProgramName, TblFontBold));
                        H1.HorizontalAlignment = Element.ALIGN_LEFT;
                        H1.Colspan = 2;
                        H1.FixedHeight = 15f;
                        H1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                        ContTable.AddCell(H1);

                        PdfPCell H2 = new PdfPCell(new Phrase("App:" + MstEntity.ApplNo + "  " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), TblFontBold));
                        H2.HorizontalAlignment = Element.ALIGN_RIGHT;
                        H2.Colspan = 4;
                        H2.FixedHeight = 15f;
                        H2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                        ContTable.AddCell(H2);*/

                            PdfPCell S2 = new PdfPCell(new Phrase("", TblFontBold));
                            S2.HorizontalAlignment = Element.ALIGN_CENTER;
                            S2.Colspan = 6;
                            S2.FixedHeight = 15f;
                            S2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            ContTable.AddCell(S2);

                            PdfPCell Header = new PdfPCell(new Phrase("Contact Data", TblFontBold));
                            Header.HorizontalAlignment = Element.ALIGN_CENTER;
                            Header.Colspan = 6;
                            Header.FixedHeight = 15f;
                            Header.Border = iTextSharp.text.Rectangle.BOX;
                            ContTable.AddCell(Header);

                            string[] HeaderSeq = { "Date", "Contact Name", "Where", "Time", "Language", "Case Worker" };
                            for (int i = 0; i < HeaderSeq.Length; ++i)
                            {
                                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                //cell.FixedHeight = 15f;
                                cell.Border = iTextSharp.text.Rectangle.BOX;
                                ContTable.AddCell(cell);
                            }


                            foreach (CASECONTEntity Entity in SelContList)
                            {
                                PdfPCell A1 = new PdfPCell(new Phrase(LookupDataAccess.Getdate(Entity.Cont_Date.Trim()), TableFont));
                                A1.HorizontalAlignment = Element.ALIGN_LEFT;
                                A1.Border = iTextSharp.text.Rectangle.BOX;
                                ContTable.AddCell(A1);

                                PdfPCell A2 = new PdfPCell(new Phrase(Entity.Contact_Name, TableFont));
                                A2.HorizontalAlignment = Element.ALIGN_LEFT;
                                A2.Border = iTextSharp.text.Rectangle.BOX;
                                ContTable.AddCell(A2);

                                if (AgyTabs_List.Count > 0)
                                {
                                    HowWhere = AgyTabs_List.Find(u => u.Code.Equals(Entity.How_Where)).Desc.ToString();
                                }

                                PdfPCell A3 = new PdfPCell(new Phrase(HowWhere, TableFont));
                                A3.HorizontalAlignment = Element.ALIGN_LEFT;
                                A3.Border = iTextSharp.text.Rectangle.BOX;
                                ContTable.AddCell(A3);

                                PdfPCell A4 = new PdfPCell(new Phrase(Entity.Duration, TableFont));
                                A4.HorizontalAlignment = Element.ALIGN_LEFT;
                                A4.Border = iTextSharp.text.Rectangle.BOX;
                                ContTable.AddCell(A4);

                                PdfPCell A5 = new PdfPCell(new Phrase(Get_Language_Desc(Entity.Language), TableFont));
                                A5.HorizontalAlignment = Element.ALIGN_LEFT;
                                A5.Border = iTextSharp.text.Rectangle.BOX;
                                ContTable.AddCell(A5);

                                PdfPCell A6 = new PdfPCell(new Phrase(Get_CaseWorker_DESC(Entity.CaseWorker), TableFont));
                                A6.HorizontalAlignment = Element.ALIGN_LEFT;
                                A6.Border = iTextSharp.text.Rectangle.BOX;
                                ContTable.AddCell(A6);
                            }

                            if (ContTable.Rows.Count > 0)
                            {
                                document.Add(mainHeader);
                                mainHeader.DeleteBodyRows();
                                document.Add(ContTable);
                                ContTable.DeleteBodyRows();
                                document.NewPage();
                            }
                        }

                    }
                }
            }
            else
            {
                string ProgramName = string.Empty;
                if (programEntity != null)
                    ProgramName = programEntity.HirarchyName;

                /******************************* Head  1 ********************************************/

                PdfPCell AppName = new PdfPCell(new Phrase("Applicant Name: " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), fc1));
                AppName.HorizontalAlignment = Element.ALIGN_LEFT;
                AppName.Border = iTextSharp.text.Rectangle.NO_BORDER;
                mainHeader.AddCell(AppName);

                PdfPCell Application = new PdfPCell(new Phrase("App#: " + CASEMSTList[0].ApplNo, fc1));
                Application.HorizontalAlignment = Element.ALIGN_RIGHT;
                Application.Border = iTextSharp.text.Rectangle.NO_BORDER;
                mainHeader.AddCell(Application);

                //PdfPCell space = new PdfPCell(new Phrase("", fc1));
                //space.HorizontalAlignment = Element.ALIGN_LEFT;
                //space.Border = iTextSharp.text.Rectangle.NO_BORDER;
                //mainHeader.AddCell(space);

                PdfPCell Hierarchy = new PdfPCell(new Phrase("Intake Hierarchy: " + CASEMSTList[0].ApplAgency + "-" + CASEMSTList[0].ApplDept + "-" + CASEMSTList[0].ApplProgram + " " + CASEMSTList[0].ApplYr + "  " + ProgramName, fc1));
                Hierarchy.HorizontalAlignment = Element.ALIGN_RIGHT;
                Hierarchy.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Hierarchy.Colspan = 2;
                mainHeader.AddCell(Hierarchy);

                /***************************************************************************/
                /*PdfPCell H1 = new PdfPCell(new Phrase("Hierarchy:" + CASEMSTList[0].ApplAgency + "-" + CASEMSTList[0].ApplDept + "-" + CASEMSTList[0].ApplProgram + " " + CASEMSTList[0].ApplYr + "  " + ProgramName, TblFontBold));
                H1.HorizontalAlignment = Element.ALIGN_LEFT;
                H1.Colspan = 2;
                H1.FixedHeight = 15f;
                H1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                ContTable.AddCell(H1);

                PdfPCell H2 = new PdfPCell(new Phrase("App:" + CASEMSTList[0].ApplNo + "  " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), TblFontBold));
                H2.HorizontalAlignment = Element.ALIGN_RIGHT;
                H2.Colspan = 4;
                H2.FixedHeight = 15f;
                H2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                ContTable.AddCell(H2);*/

                PdfPCell S2 = new PdfPCell(new Phrase("", TblFontBold));
                S2.HorizontalAlignment = Element.ALIGN_CENTER;
                S2.Colspan = 6;
                S2.FixedHeight = 15f;
                S2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                ContTable.AddCell(S2);

                PdfPCell Header = new PdfPCell(new Phrase("Contact Data", TblFontBold));
                Header.HorizontalAlignment = Element.ALIGN_CENTER;
                Header.Colspan = 6;
                Header.FixedHeight = 15f;
                Header.Border = iTextSharp.text.Rectangle.BOX;
                ContTable.AddCell(Header);

                string[] HeaderSeq = { "Date", "Contact Name", "Where", "Time", "Language", "Case Worker" };
                for (int i = 0; i < HeaderSeq.Length; ++i)
                {
                    PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                    cell.HorizontalAlignment = Element.ALIGN_CENTER;
                    //cell.FixedHeight = 15f;
                    cell.Border = iTextSharp.text.Rectangle.BOX;
                    ContTable.AddCell(cell);
                }

                foreach (CASECONTEntity Entity in ContList)
                {
                    PdfPCell A1 = new PdfPCell(new Phrase(LookupDataAccess.Getdate(Entity.Cont_Date.Trim()), TableFont));
                    A1.HorizontalAlignment = Element.ALIGN_LEFT;
                    A1.Border = iTextSharp.text.Rectangle.BOX;
                    ContTable.AddCell(A1);

                    PdfPCell A2 = new PdfPCell(new Phrase(Entity.Contact_Name, TableFont));
                    A2.HorizontalAlignment = Element.ALIGN_LEFT;
                    A2.Border = iTextSharp.text.Rectangle.BOX;
                    ContTable.AddCell(A2);

                    if (AgyTabs_List.Count > 0)
                    {
                        HowWhere = AgyTabs_List.Find(u => u.Code.Equals(Entity.How_Where)).Desc.ToString();
                    }
                    //= AgyTabs_List.Find(u => u.Code.Equals(Entity.How_Where)).ToString();

                    PdfPCell A3 = new PdfPCell(new Phrase(HowWhere, TableFont));
                    A3.HorizontalAlignment = Element.ALIGN_LEFT;
                    A3.Border = iTextSharp.text.Rectangle.BOX;
                    ContTable.AddCell(A3);

                    PdfPCell A4 = new PdfPCell(new Phrase(Entity.Duration, TableFont));
                    A4.HorizontalAlignment = Element.ALIGN_LEFT;
                    A4.Border = iTextSharp.text.Rectangle.BOX;
                    ContTable.AddCell(A4);

                    PdfPCell A5 = new PdfPCell(new Phrase(Get_Language_Desc(Entity.Language), TableFont));
                    A5.HorizontalAlignment = Element.ALIGN_LEFT;
                    A5.Border = iTextSharp.text.Rectangle.BOX;
                    ContTable.AddCell(A5);

                    PdfPCell A6 = new PdfPCell(new Phrase(Get_CaseWorker_DESC(Entity.CaseWorker), TableFont));
                    A6.HorizontalAlignment = Element.ALIGN_LEFT;
                    A6.Border = iTextSharp.text.Rectangle.BOX;
                    ContTable.AddCell(A6);
                }
            }

            if (ContTable.Rows.Count > 0)
            {
                document.Add(mainHeader);
                document.Add(ContTable);
            }

            document.Close();
            fs.Close();
            fs.Dispose();

        }

        //private void ACTREFSPdf(Document document)
        //{
        //    BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
        //    iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
        //    BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
        //    iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(1, 9, 4);
        //    BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

        //    iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
        //    iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
        //    iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
        //    iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(1, 9, 1);
        //    iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
        //    iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);

        //    PdfPTable ActrefTable = new PdfPTable(6);
        //    ActrefTable.TotalWidth = 550f;
        //    ActrefTable.WidthPercentage = 100;
        //    ActrefTable.LockedWidth = true;
        //    float[] widths2 = new float[] { 20f, 30f, 15f, 60f, 30f, 18f };
        //    ActrefTable.SetWidths(widths2);
        //    ActrefTable.HorizontalAlignment = Element.ALIGN_CENTER;

        //    string ProgramName = string.Empty;
        //    if (programEntity != null)
        //        ProgramName = programEntity.AgencyName;

        //    PdfPCell H1 = new PdfPCell(new Phrase("Hierarchy:" + CASEMSTList[0].ApplAgency + "-" + CASEMSTList[0].ApplDept + "-" + CASEMSTList[0].ApplProgram + " " + CASEMSTList[0].ApplYr + "  " + ProgramName, TblFontBold));
        //    H1.HorizontalAlignment = Element.ALIGN_LEFT;
        //    H1.Colspan = 3;
        //    H1.FixedHeight = 15f;
        //    H1.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ActrefTable.AddCell(H1);

        //    PdfPCell H2 = new PdfPCell(new Phrase("App:" + CASEMSTList[0].ApplNo + "  " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), TblFontBold));
        //    H2.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    H2.Colspan = 3;
        //    H2.FixedHeight = 15f;
        //    H2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ActrefTable.AddCell(H2);

        //    PdfPCell S2 = new PdfPCell(new Phrase("", TblFontBold));
        //    S2.HorizontalAlignment = Element.ALIGN_CENTER;
        //    S2.Colspan = 6;
        //    S2.FixedHeight = 15f;
        //    S2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    ActrefTable.AddCell(S2);

        //    PdfPCell Header = new PdfPCell(new Phrase("REFER From/TO", TblFontBold));
        //    Header.HorizontalAlignment = Element.ALIGN_CENTER;
        //    Header.Colspan = 6;
        //    Header.FixedHeight = 15f;
        //    Header.Border = iTextSharp.text.Rectangle.BOX;
        //    ActrefTable.AddCell(Header);

        //    string[] HeaderSeq = { "Date", "Refer From/TO", "Code", "Agency Name", "City", "State" };
        //    for (int i = 0; i < HeaderSeq.Length; ++i)
        //    {
        //        PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
        //        cell.HorizontalAlignment = Element.ALIGN_CENTER;
        //        //cell.FixedHeight = 15f;
        //        cell.Border = iTextSharp.text.Rectangle.BOX;
        //        ActrefTable.AddCell(cell);
        //    }

        //    bool Ref_Exists = false; string AgyName = string.Empty;
        //    foreach (ACTREFSEntity Entity in Actrefslist)
        //    {

        //        Ref_Exists = false;
        //        foreach (CASEREFEntity Entity1 in CASEREFREF_List)
        //        {
        //            if (Entity1.Code == Entity.Code)
        //            {
        //                Ref_Exists = true;

        //                PdfPCell A1 = new PdfPCell(new Phrase(LookupDataAccess.Getdate(Entity.Date.Trim()), TableFont));
        //                A1.HorizontalAlignment = Element.ALIGN_LEFT;
        //                A1.Border = iTextSharp.text.Rectangle.BOX;
        //                ActrefTable.AddCell(A1);

        //                PdfPCell A2 = new PdfPCell(new Phrase(Entity.Type == "T" ? "Referred To" : "Referred From", TableFont));
        //                A2.HorizontalAlignment = Element.ALIGN_LEFT;
        //                A2.Border = iTextSharp.text.Rectangle.BOX;
        //                ActrefTable.AddCell(A2);

        //                PdfPCell A3 = new PdfPCell(new Phrase(Entity1.Code, TableFont));
        //                A3.HorizontalAlignment = Element.ALIGN_LEFT;
        //                A3.Border = iTextSharp.text.Rectangle.BOX;
        //                ActrefTable.AddCell(A3);

        //                PdfPCell A4 = new PdfPCell(new Phrase(Entity1.Name1, TableFont));
        //                A4.HorizontalAlignment = Element.ALIGN_LEFT;
        //                A4.Border = iTextSharp.text.Rectangle.BOX;
        //                ActrefTable.AddCell(A4);

        //                PdfPCell A5 = new PdfPCell(new Phrase(Entity1.City, TableFont));
        //                A5.HorizontalAlignment = Element.ALIGN_LEFT;
        //                A5.Border = iTextSharp.text.Rectangle.BOX;
        //                ActrefTable.AddCell(A5);

        //                PdfPCell A6 = new PdfPCell(new Phrase(Entity1.State, TableFont));
        //                A6.HorizontalAlignment = Element.ALIGN_LEFT;
        //                A6.Border = iTextSharp.text.Rectangle.BOX;
        //                ActrefTable.AddCell(A6);

        //                break;
        //            }
        //        }

        //        if (!Ref_Exists)
        //        {
        //            PdfPCell A1 = new PdfPCell(new Phrase(LookupDataAccess.Getdate(Entity.Date.Trim()), TableFont));
        //            A1.HorizontalAlignment = Element.ALIGN_LEFT;
        //            A1.Border = iTextSharp.text.Rectangle.BOX;
        //            ActrefTable.AddCell(A1);

        //            PdfPCell A2 = new PdfPCell(new Phrase(Entity.Type == "T" ? "Referred To" : "Referred From", TableFont));
        //            A2.HorizontalAlignment = Element.ALIGN_LEFT;
        //            A2.Border = iTextSharp.text.Rectangle.BOX;
        //            ActrefTable.AddCell(A2);

        //            PdfPCell A3 = new PdfPCell(new Phrase(Entity.Code, TableFont));
        //            A3.HorizontalAlignment = Element.ALIGN_LEFT;
        //            A3.Border = iTextSharp.text.Rectangle.BOX;
        //            ActrefTable.AddCell(A3);

        //            PdfPCell A4 = new PdfPCell(new Phrase("Not Defined in 'CASEREF'", TableFont));
        //            A4.HorizontalAlignment = Element.ALIGN_LEFT;
        //            A4.Border = iTextSharp.text.Rectangle.BOX;
        //            ActrefTable.AddCell(A4);

        //            PdfPCell A5 = new PdfPCell(new Phrase("", TableFont));
        //            A5.HorizontalAlignment = Element.ALIGN_LEFT;
        //            A5.Border = iTextSharp.text.Rectangle.BOX;
        //            ActrefTable.AddCell(A5);

        //            PdfPCell A6 = new PdfPCell(new Phrase("", TableFont));
        //            A6.HorizontalAlignment = Element.ALIGN_LEFT;
        //            A6.Border = iTextSharp.text.Rectangle.BOX;
        //            ActrefTable.AddCell(A6);
        //        }
        //    }

        //    document.Add(ActrefTable);

        //}

        private void ACTREFSPdf()
        {
            Random_Filename = null;

            PdfName = "R" + BaseForm.BaseApplicationNo.ToString();//form.GetFileName();
            PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
            try
            {
                if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
            }
            catch (Exception ex)
            {
                CommonFunctions.MessageBoxDisplay("Error");
            }


            try
            {
                string Tmpstr = PdfName + ".pdf";
                if (File.Exists(Tmpstr))
                    File.Delete(Tmpstr);
            }
            catch (Exception ex)
            {
                int length = 8;
                string newFileName = System.Guid.NewGuid().ToString();
                newFileName = newFileName.Replace("-", string.Empty);

                Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
            }

            if (!string.IsNullOrEmpty(Random_Filename))
                PdfName = Random_Filename;
            else
                PdfName += ".pdf";

            FileStream fs = new FileStream(PdfName, FileMode.Create);

            Document document = new Document(PageSize.A4, 25, 25, 30, 30);
            PdfWriter writer = PdfWriter.GetInstance(document, fs);
            document.Open();

            cb = writer.DirectContent;

            BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
            iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
            BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
            iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(bf_times, 9, 4);
            BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

            iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
            iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
            iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
            iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(bf_times, 9, 1);
            iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
            iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);

            PdfPTable ActrefTable = new PdfPTable(6);
            ActrefTable.TotalWidth = 550f;
            ActrefTable.WidthPercentage = 100;
            ActrefTable.LockedWidth = true;
            float[] widths2 = new float[] { 20f, 30f, 15f, 60f, 30f, 18f };
            ActrefTable.SetWidths(widths2);
            ActrefTable.HorizontalAlignment = Element.ALIGN_CENTER;

            if (chkbAllHier.Checked)
            {
                if (CASEMSTList.Count > 0)
                {
                    foreach (CaseMstEntity MstEntity in CASEMSTList)
                    {
                        //programEntity = _model.HierarchyAndPrograms.GetCaseDepadp(MstEntity.ApplAgency, MstEntity.ApplDept, MstEntity.ApplProgram);
                        programEntity = caseHierarchy.Find(u => u.Agency.Equals(MstEntity.ApplAgency) && u.Dept.Equals(MstEntity.ApplDept) && u.Prog.Equals(MstEntity.ApplProgram));

                        string ProgramName = string.Empty;
                        if (programEntity != null)
                            ProgramName = programEntity.HirarchyName;

                        SelSnp = casesnpList.Find(u => u.App.Equals(MstEntity.ApplNo) && u.FamilySeq.Equals(MstEntity.FamilySeq));

                        List<ACTREFSEntity> SelActrefslist = Actrefslist.FindAll(u => u.Agency.Equals(MstEntity.ApplAgency) && u.Dept.Equals(MstEntity.ApplDept) && u.Program.Equals(MstEntity.ApplProgram) && u.Year.Trim().Equals(MstEntity.ApplYr) && u.ApplNo.Equals(MstEntity.ApplNo));

                        if (SelActrefslist.Count > 0)
                        {

                            PdfPCell H1 = new PdfPCell(new Phrase("Hierarchy:" + MstEntity.ApplAgency + "-" + MstEntity.ApplDept + "-" + MstEntity.ApplProgram + " " + MstEntity.ApplYr + "  " + ProgramName, TblFontBold));
                            H1.HorizontalAlignment = Element.ALIGN_LEFT;
                            H1.Colspan = 3;
                            H1.FixedHeight = 15f;
                            H1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            ActrefTable.AddCell(H1);

                            PdfPCell H2 = new PdfPCell(new Phrase("App:" + MstEntity.ApplNo + "  " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), TblFontBold));
                            H2.HorizontalAlignment = Element.ALIGN_RIGHT;
                            H2.Colspan = 3;
                            H2.FixedHeight = 15f;
                            H2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            ActrefTable.AddCell(H2);

                            PdfPCell S2 = new PdfPCell(new Phrase("", TblFontBold));
                            S2.HorizontalAlignment = Element.ALIGN_CENTER;
                            S2.Colspan = 6;
                            S2.FixedHeight = 15f;
                            S2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            ActrefTable.AddCell(S2);

                            PdfPCell Header = new PdfPCell(new Phrase("REFER From/TO", TblFontBold));
                            Header.HorizontalAlignment = Element.ALIGN_CENTER;
                            Header.Colspan = 6;
                            Header.FixedHeight = 15f;
                            Header.Border = iTextSharp.text.Rectangle.BOX;
                            ActrefTable.AddCell(Header);

                            string[] HeaderSeq = { "Date", "Refer From/TO", "Code", "Agency Name", "City", "State" };
                            for (int i = 0; i < HeaderSeq.Length; ++i)
                            {
                                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                //cell.FixedHeight = 15f;
                                cell.Border = iTextSharp.text.Rectangle.BOX;
                                ActrefTable.AddCell(cell);
                            }

                            bool Ref_Exists = false; string AgyName = string.Empty;
                            foreach (ACTREFSEntity Entity in SelActrefslist)
                            {

                                Ref_Exists = false;
                                foreach (CASEREFEntity Entity1 in CASEREFREF_List)
                                {
                                    if (Entity1.Code == Entity.Code)
                                    {
                                        Ref_Exists = true;

                                        PdfPCell A1 = new PdfPCell(new Phrase(LookupDataAccess.Getdate(Entity.Date.Trim()), TableFont));
                                        A1.HorizontalAlignment = Element.ALIGN_LEFT;
                                        A1.Border = iTextSharp.text.Rectangle.BOX;
                                        ActrefTable.AddCell(A1);

                                        PdfPCell A2 = new PdfPCell(new Phrase(Entity.Type == "T" ? "Referred To" : "Referred From", TableFont));
                                        A2.HorizontalAlignment = Element.ALIGN_LEFT;
                                        A2.Border = iTextSharp.text.Rectangle.BOX;
                                        ActrefTable.AddCell(A2);

                                        PdfPCell A3 = new PdfPCell(new Phrase(Entity1.Code, TableFont));
                                        A3.HorizontalAlignment = Element.ALIGN_LEFT;
                                        A3.Border = iTextSharp.text.Rectangle.BOX;
                                        ActrefTable.AddCell(A3);

                                        PdfPCell A4 = new PdfPCell(new Phrase(Entity1.Name1, TableFont));
                                        A4.HorizontalAlignment = Element.ALIGN_LEFT;
                                        A4.Border = iTextSharp.text.Rectangle.BOX;
                                        ActrefTable.AddCell(A4);

                                        PdfPCell A5 = new PdfPCell(new Phrase(Entity1.City, TableFont));
                                        A5.HorizontalAlignment = Element.ALIGN_LEFT;
                                        A5.Border = iTextSharp.text.Rectangle.BOX;
                                        ActrefTable.AddCell(A5);

                                        PdfPCell A6 = new PdfPCell(new Phrase(Entity1.State, TableFont));
                                        A6.HorizontalAlignment = Element.ALIGN_LEFT;
                                        A6.Border = iTextSharp.text.Rectangle.BOX;
                                        ActrefTable.AddCell(A6);

                                        break;
                                    }
                                }

                                if (!Ref_Exists)
                                {
                                    PdfPCell A1 = new PdfPCell(new Phrase(LookupDataAccess.Getdate(Entity.Date.Trim()), TableFont));
                                    A1.HorizontalAlignment = Element.ALIGN_LEFT;
                                    A1.Border = iTextSharp.text.Rectangle.BOX;
                                    ActrefTable.AddCell(A1);

                                    PdfPCell A2 = new PdfPCell(new Phrase(Entity.Type == "T" ? "Referred To" : "Referred From", TableFont));
                                    A2.HorizontalAlignment = Element.ALIGN_LEFT;
                                    A2.Border = iTextSharp.text.Rectangle.BOX;
                                    ActrefTable.AddCell(A2);

                                    PdfPCell A3 = new PdfPCell(new Phrase(Entity.Code, TableFont));
                                    A3.HorizontalAlignment = Element.ALIGN_LEFT;
                                    A3.Border = iTextSharp.text.Rectangle.BOX;
                                    ActrefTable.AddCell(A3);

                                    PdfPCell A4 = new PdfPCell(new Phrase("Not Defined in 'CASEREF'", TableFont));
                                    A4.HorizontalAlignment = Element.ALIGN_LEFT;
                                    A4.Border = iTextSharp.text.Rectangle.BOX;
                                    ActrefTable.AddCell(A4);

                                    PdfPCell A5 = new PdfPCell(new Phrase("", TableFont));
                                    A5.HorizontalAlignment = Element.ALIGN_LEFT;
                                    A5.Border = iTextSharp.text.Rectangle.BOX;
                                    ActrefTable.AddCell(A5);

                                    PdfPCell A6 = new PdfPCell(new Phrase("", TableFont));
                                    A6.HorizontalAlignment = Element.ALIGN_LEFT;
                                    A6.Border = iTextSharp.text.Rectangle.BOX;
                                    ActrefTable.AddCell(A6);
                                }
                            }
                            if (ActrefTable.Rows.Count > 0)
                            {
                                document.Add(ActrefTable);
                                ActrefTable.DeleteBodyRows();
                                document.NewPage();
                            }
                        }
                    }
                }
            }
            else
            {
                string ProgramName = string.Empty;
                if (programEntity != null)
                    ProgramName = programEntity.HirarchyName;

                PdfPCell H1 = new PdfPCell(new Phrase("Hierarchy:" + CASEMSTList[0].ApplAgency + "-" + CASEMSTList[0].ApplDept + "-" + CASEMSTList[0].ApplProgram + " " + CASEMSTList[0].ApplYr + "  " + ProgramName, TblFontBold));
                H1.HorizontalAlignment = Element.ALIGN_LEFT;
                H1.Colspan = 3;
                H1.FixedHeight = 15f;
                H1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                ActrefTable.AddCell(H1);

                PdfPCell H2 = new PdfPCell(new Phrase("App:" + CASEMSTList[0].ApplNo + "  " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), TblFontBold));
                H2.HorizontalAlignment = Element.ALIGN_RIGHT;
                H2.Colspan = 3;
                H2.FixedHeight = 15f;
                H2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                ActrefTable.AddCell(H2);

                PdfPCell S2 = new PdfPCell(new Phrase("", TblFontBold));
                S2.HorizontalAlignment = Element.ALIGN_CENTER;
                S2.Colspan = 6;
                S2.FixedHeight = 15f;
                S2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                ActrefTable.AddCell(S2);

                PdfPCell Header = new PdfPCell(new Phrase("REFER From/TO", TblFontBold));
                Header.HorizontalAlignment = Element.ALIGN_CENTER;
                Header.Colspan = 6;
                Header.FixedHeight = 15f;
                Header.Border = iTextSharp.text.Rectangle.BOX;
                ActrefTable.AddCell(Header);

                string[] HeaderSeq = { "Date", "Refer From/TO", "Code", "Agency Name", "City", "State" };
                for (int i = 0; i < HeaderSeq.Length; ++i)
                {
                    PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                    cell.HorizontalAlignment = Element.ALIGN_CENTER;
                    //cell.FixedHeight = 15f;
                    cell.Border = iTextSharp.text.Rectangle.BOX;
                    ActrefTable.AddCell(cell);
                }

                bool Ref_Exists = false; string AgyName = string.Empty;
                foreach (ACTREFSEntity Entity in Actrefslist)
                {

                    Ref_Exists = false;
                    foreach (CASEREFEntity Entity1 in CASEREFREF_List)
                    {
                        if (Entity1.Code == Entity.Code)
                        {
                            Ref_Exists = true;

                            PdfPCell A1 = new PdfPCell(new Phrase(LookupDataAccess.Getdate(Entity.Date.Trim()), TableFont));
                            A1.HorizontalAlignment = Element.ALIGN_LEFT;
                            A1.Border = iTextSharp.text.Rectangle.BOX;
                            ActrefTable.AddCell(A1);

                            PdfPCell A2 = new PdfPCell(new Phrase(Entity.Type == "T" ? "Referred To" : "Referred From", TableFont));
                            A2.HorizontalAlignment = Element.ALIGN_LEFT;
                            A2.Border = iTextSharp.text.Rectangle.BOX;
                            ActrefTable.AddCell(A2);

                            PdfPCell A3 = new PdfPCell(new Phrase(Entity1.Code, TableFont));
                            A3.HorizontalAlignment = Element.ALIGN_LEFT;
                            A3.Border = iTextSharp.text.Rectangle.BOX;
                            ActrefTable.AddCell(A3);

                            PdfPCell A4 = new PdfPCell(new Phrase(Entity1.Name1, TableFont));
                            A4.HorizontalAlignment = Element.ALIGN_LEFT;
                            A4.Border = iTextSharp.text.Rectangle.BOX;
                            ActrefTable.AddCell(A4);

                            PdfPCell A5 = new PdfPCell(new Phrase(Entity1.City, TableFont));
                            A5.HorizontalAlignment = Element.ALIGN_LEFT;
                            A5.Border = iTextSharp.text.Rectangle.BOX;
                            ActrefTable.AddCell(A5);

                            PdfPCell A6 = new PdfPCell(new Phrase(Entity1.State, TableFont));
                            A6.HorizontalAlignment = Element.ALIGN_LEFT;
                            A6.Border = iTextSharp.text.Rectangle.BOX;
                            ActrefTable.AddCell(A6);

                            break;
                        }
                    }

                    if (!Ref_Exists)
                    {
                        PdfPCell A1 = new PdfPCell(new Phrase(LookupDataAccess.Getdate(Entity.Date.Trim()), TableFont));
                        A1.HorizontalAlignment = Element.ALIGN_LEFT;
                        A1.Border = iTextSharp.text.Rectangle.BOX;
                        ActrefTable.AddCell(A1);

                        PdfPCell A2 = new PdfPCell(new Phrase(Entity.Type == "T" ? "Referred To" : "Referred From", TableFont));
                        A2.HorizontalAlignment = Element.ALIGN_LEFT;
                        A2.Border = iTextSharp.text.Rectangle.BOX;
                        ActrefTable.AddCell(A2);

                        PdfPCell A3 = new PdfPCell(new Phrase(Entity.Code, TableFont));
                        A3.HorizontalAlignment = Element.ALIGN_LEFT;
                        A3.Border = iTextSharp.text.Rectangle.BOX;
                        ActrefTable.AddCell(A3);

                        PdfPCell A4 = new PdfPCell(new Phrase("Not Defined in 'CASEREF'", TableFont));
                        A4.HorizontalAlignment = Element.ALIGN_LEFT;
                        A4.Border = iTextSharp.text.Rectangle.BOX;
                        ActrefTable.AddCell(A4);

                        PdfPCell A5 = new PdfPCell(new Phrase("", TableFont));
                        A5.HorizontalAlignment = Element.ALIGN_LEFT;
                        A5.Border = iTextSharp.text.Rectangle.BOX;
                        ActrefTable.AddCell(A5);

                        PdfPCell A6 = new PdfPCell(new Phrase("", TableFont));
                        A6.HorizontalAlignment = Element.ALIGN_LEFT;
                        A6.Border = iTextSharp.text.Rectangle.BOX;
                        ActrefTable.AddCell(A6);
                    }
                }
            }

            document.Add(ActrefTable);

            document.Close();
            fs.Close();
            fs.Dispose();

        }


        int Page_Height = 800, Page_Width = 580; int Rect_X = 100, Rect_Y = 640; string Change = string.Empty;
        int R_Length = 140, R_Breadth = 450; int R_XV = 0; float R_YV = 0f; int diff = 0;

        //private void MATASMTPdf(Document document)//object sender, FormClosedEventArgs e)
        //{

        //    iTextSharp.text.Image logo = iTextSharp.text.Image.GetInstance(Context.Server.MapPath("~\\Resources\\images\\Logo.JPG"));
        //    logo.BackgroundColor = BaseColor.WHITE;
        //    logo.ScalePercent(50f);
        //    document.Add(logo);

        //    BaseFont bfTimes = BaseFont.CreateFont(BaseFont.TIMES_ROMAN, BaseFont.CP1250, false);

        //    iTextSharp.text.Font fc = new iTextSharp.text.Font(bfTimes, 12, 0);
        //    iTextSharp.text.Font fc1 = new iTextSharp.text.Font(bfTimes, 12, 0, BaseColor.RED);
        //    iTextSharp.text.Font fcGreen = new iTextSharp.text.Font(bfTimes, 12, 0, new BaseColor(0, 153, 0));
        //    iTextSharp.text.Font fcBold = new iTextSharp.text.Font(bfTimes, 12, 1);
        //    float X_Pos, Y_Pos;

        //    string AGY = GvwAppHou.CurrentRow.Cells["Grd_Agy"].Value.ToString();
        //    string Dept = GvwAppHou.CurrentRow.Cells["Grd_Dept"].Value.ToString();
        //    string Prog = GvwAppHou.CurrentRow.Cells["Grd_Prog"].Value.ToString();
        //    string Year = GvwAppHou.CurrentRow.Cells["Grd_Year"].Value.ToString();
        //    string App = GvwAppHou.CurrentRow.Cells["Grd_App"].Value.ToString();
        //    //PdfContentByte cb;
        //    //cb = writer.DirectContent;

        //    ////Casesum Entity list
        //    //List<CaseSumEntity> casesumdetails = new List<CaseSumEntity>();
        //    //casesumdetails = _model.CaseSumData.GetCaseSumDetails(AGY, Dept, Prog, Year, App, string.Empty);
        //    X_Pos = 60; Y_Pos = 680;
        //    bool FirstTime = false;
        //    var Matrix = MATAList.Select(u => u.MatCode).Distinct().ToList();

        //    if (Matrix.Count > 0)
        //    {
        //        foreach (var Matcd in Matrix)
        //        {


        //            //MAtdef Entity list
        //            string FirstAssDate = string.Empty, LastAssDate = string.Empty;
        //            List<MATDEFEntity> matlist = new List<MATDEFEntity>();
        //            MATDEFEntity MatEntity = new MATDEFEntity(true);
        //            MatEntity.Mat_Code = Matcd;
        //            matlist = _model.MatrixScalesData.Browse_MATDEF(MatEntity, "Browse");

        //            // Services list
        //            //List<CASEMSEntity> CaseMSlist = new List<CASEMSEntity>();
        //            //CASEMSEntity MS_Search = new CASEMSEntity(true);
        //            //MS_Search.Agency = BaseForm.BaseAgency; MS_Search.Dept = BaseForm.BaseDept;
        //            //MS_Search.Program = BaseForm.BaseProg; MS_Search.Year = BaseForm.BaseYear;
        //            //MS_Search.App_no = BaseForm.BaseApplicationNo;
        //            //CaseMSlist = _model.SPAdminData.Browse_CASEMS(MS_Search, "Browse");

        //            ////Outcomes List
        //            //List<MSMASTEntity> MSList = new List<MSMASTEntity>();

        //            bool FIRST_Ser = true;
        //            string SP_Desc = string.Empty; string Out_Desc = string.Empty, CaseMS_Date = string.Empty, Goals = string.Empty;


        //            //Benchmarks displayed
        //            List<MATDEFBMEntity> MatBMlist = new List<MATDEFBMEntity>();
        //            MATDEFBMEntity Search_Entity = new MATDEFBMEntity(true);
        //            Search_Entity.MatCode = Matcd;
        //            MatBMlist = _model.MatrixScalesData.Browse_MATDEFBM(Search_Entity, "Browse");
        //            MatBMlist.Reverse();
        //            string[] Bench = new string[6];


        //            List<MATASMTEntity> Matasmtlist = new List<MATASMTEntity>();
        //            Matasmtlist = MATAList.FindAll(u => u.ByPass.Equals("N") && u.MatCode.Equals(Matcd));
        //            //MATASMTEntity Entity_matasmt = new MATASMTEntity(true);
        //            //Entity_matasmt.Agency = AGY; Entity_matasmt.Dept = Dept;
        //            //Entity_matasmt.Program = Prog; Entity_matasmt.Year = Year;
        //            //Entity_matasmt.App = BaseForm.BaseApplicationNo; Entity_matasmt.Type = "S"; Entity_matasmt.ByPass = "N";
        //            //Entity_matasmt.MatCode = Matcd;

        //            MATDEFBMEntity Search1_Entity = new MATDEFBMEntity(true);
        //            Search1_Entity.MatCode = Matcd;
        //            MATADEFBMentity = _model.MatrixScalesData.Browse_MATDEFBM(Search_Entity, "Browse");


        //            //Temp table not displayed on the screen
        //            PdfPTable head = new PdfPTable(1);
        //            head.HorizontalAlignment = Element.ALIGN_CENTER;
        //            head.TotalWidth = 50f;
        //            PdfPCell headcell = new PdfPCell(new Phrase(""));
        //            headcell.HorizontalAlignment = Element.ALIGN_CENTER;
        //            headcell.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //            head.AddCell(headcell);

        //            if (!FirstTime)
        //            {
        //                cb.BeginText();
        //                cb.SetFontAndSize(FontFactory.GetFont(FontFactory.TIMES_ROMAN).BaseFont, 12);
        //                cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, AGY + "-" + Dept + "-" + Prog + " " + Year + " " + App + " " + Lbl_App_Name.Text.Trim(), 550, 780, 0);

        //                cb.EndText();
        //            }
        //            else { document.NewPage(); }
        //            document.Add(head);
        //            //if (casesumdetails.Count > 0)
        //            //{
        //            //    //table For the Referral programmes
        //            //    PdfPTable Table_Programs = new PdfPTable(2);
        //            //    Table_Programs.HorizontalAlignment = 1;
        //            //    Table_Programs.TotalWidth = 300f;
        //            //    Table_Programs.WidthPercentage = 100f;
        //            //    Table_Programs.LockedWidth = true;
        //            //    Table_Programs.SpacingBefore = 10f;

        //            //    PdfPCell Benefits = new PdfPCell(new Phrase("Benefits Portal Results", fcBold));
        //            //    Benefits.HorizontalAlignment = Element.ALIGN_CENTER;
        //            //    Benefits.Colspan = 2;
        //            //    Benefits.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //            //    Table_Programs.AddCell(Benefits);

        //            //    PdfPCell Programs_Header = new PdfPCell(new Phrase("Programs Referred to", fcBold));
        //            //    Programs_Header.HorizontalAlignment = Element.ALIGN_CENTER;
        //            //    Programs_Header.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //            //    Table_Programs.AddCell(Programs_Header);

        //            //    PdfPCell Programs_Header1 = new PdfPCell(new Phrase("Date of Referral", fcBold));
        //            //    Programs_Header1.HorizontalAlignment = Element.ALIGN_CENTER;
        //            //    Programs_Header1.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //            //    Table_Programs.AddCell(Programs_Header1);

        //            //    foreach (CaseSumEntity Entity in casesumdetails)
        //            //    {
        //            //        if (Entity.CaseSumNotInterested == "False")
        //            //        {
        //            //            DataRow drHie;//=new DataRow();
        //            //            DataSet dsHie = DatabaseLayer.AgyTab.GetHierarchyNames(Entity.CaseSumRefHierachy.Substring(0, 2), Entity.CaseSumRefHierachy.Substring(2, 2), Entity.CaseSumRefHierachy.Substring(4, 2));

        //            //            if (dsHie.Tables.Count > 0)
        //            //            {
        //            //                if (dsHie.Tables[0].Rows.Count > 0)
        //            //                {
        //            //                    drHie = dsHie.Tables[0].Rows[0];
        //            //                    PdfPCell Hier = new PdfPCell(new Phrase(drHie["HIE_NAME"].ToString(), fc));
        //            //                    Hier.HorizontalAlignment = Element.ALIGN_LEFT;
        //            //                    Hier.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //            //                    Table_Programs.AddCell(Hier);


        //            //                    PdfPCell ReferDate = new PdfPCell(new Phrase(LookupDataAccess.Getdate(Entity.CaseSumReferDate), fc));
        //            //                    ReferDate.HorizontalAlignment = Element.ALIGN_CENTER;
        //            //                    ReferDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //            //                    Table_Programs.AddCell(ReferDate);
        //            //                }
        //            //            }
        //            //        }
        //            //    }
        //            //    document.Add(Table_Programs);
        //            //}

        //            //Scales assessment displaying first and last dates
        //            if (matlist.Count > 0)
        //            {
        //                PdfPTable Table_Scales = new PdfPTable(4);
        //                Table_Scales.HorizontalAlignment = 1;
        //                Table_Scales.TotalWidth = 550f;
        //                float[] Scale_widths = new float[] { 130f, 60f, 60f, 70f };
        //                Table_Scales.SetWidths(Scale_widths);
        //                Table_Scales.WidthPercentage = 100f;
        //                Table_Scales.LockedWidth = true;
        //                Table_Scales.SpacingBefore = 20f;

        //                string Matdesc = matlist.Find(u => u.Scale_Code.Equals("0")).Desc.ToString();

        //                PdfPCell Mat1 = new PdfPCell(new Phrase("Matrix: "+ Matdesc.ToString(), fcBold));
        //                Mat1.HorizontalAlignment = Element.ALIGN_CENTER;
        //                Mat1.Colspan = 4;
        //                Mat1.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                Table_Scales.AddCell(Mat1);

        //                PdfPCell Life = new PdfPCell(new Phrase("Life Skills Assessments", fcBold));
        //                Life.HorizontalAlignment = Element.ALIGN_CENTER;
        //                Life.Colspan = 4;
        //                Life.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                Table_Scales.AddCell(Life);

        //                PdfPCell Table_Header = new PdfPCell(new Phrase("Scale", fcBold));
        //                Table_Header.HorizontalAlignment = Element.ALIGN_LEFT;
        //                Table_Header.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                Table_Scales.AddCell(Table_Header);

        //                PdfPCell Table_Header1 = new PdfPCell(new Phrase("First Assessment", fcBold));
        //                Table_Header1.HorizontalAlignment = Element.ALIGN_LEFT;
        //                Table_Header1.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                Table_Scales.AddCell(Table_Header1);

        //                PdfPCell Table_Header2 = new PdfPCell(new Phrase("Last Assessment", fcBold));
        //                Table_Header2.HorizontalAlignment = Element.ALIGN_LEFT;
        //                Table_Header2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                Table_Scales.AddCell(Table_Header2);

        //                PdfPCell Table_Header3 = new PdfPCell(new Phrase("Result", fcBold));
        //                Table_Header3.HorizontalAlignment = Element.ALIGN_LEFT;
        //                Table_Header3.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                Table_Scales.AddCell(Table_Header3);
        //                foreach (MATDEFEntity Entity in matlist)
        //                {
        //                    if (Entity.Scale_Code != "0")
        //                    {
        //                        //Entity_matasmt.SclCode = Entity.Scale_Code.Trim();
        //                        string Scl_Name = Entity.Desc.Trim();
        //                        string CalcBm = Entity.Benchmark;
        //                        Matasmtlist = MATAList.FindAll(u => u.MatCode.Equals(Matcd) && u.SclCode.Equals(Entity.Scale_Code) && u.ByPass.Equals("N"));
        //                        if (Matasmtlist.Count > 0)
        //                        {
        //                            string FPoints = string.Empty; string Lpoints = string.Empty; diff = 0; string FBench_Code = string.Empty; string LBench_Code = string.Empty;
        //                            string Fbench = "N/A", Lbench = "N/A"; Change = "N/A";

        //                            FirstAssDate = LookupDataAccess.Getdate(Matasmtlist[0].SSDate);
        //                            if (!string.IsNullOrEmpty(FirstAssDate))
        //                            {
        //                                FPoints = Matasmtlist[0].Points;
        //                                MATDEFBMEntity MatadefrowEntity = MATADEFBMentity.Find(u => Convert.ToInt32(u.Low) <= Convert.ToInt32(Matasmtlist[0].Points) && Convert.ToInt32(Matasmtlist[0].Points) <= Convert.ToInt32(u.High));
        //                                if (MatadefrowEntity != null)
        //                                {
        //                                    if (Matasmtlist[0].RespExcel.Trim() == "Y")
        //                                        Fbench = "No score";
        //                                    else
        //                                        Fbench = MatadefrowEntity.Desc.Trim();
        //                                    FBench_Code = MatadefrowEntity.Code.Trim();
        //                                }
        //                                else
        //                                    Fbench = "N/A";
        //                            }

        //                            LastAssDate = LookupDataAccess.Getdate(Matasmtlist[Matasmtlist.Count - 1].SSDate);
        //                            if (FirstAssDate == LastAssDate)
        //                                LastAssDate = string.Empty;
        //                            if (!string.IsNullOrEmpty(LastAssDate))
        //                            {
        //                                Lpoints = Matasmtlist[Matasmtlist.Count - 1].Points;
        //                                MATDEFBMEntity MatadefLastRowEntity = MATADEFBMentity.Find(u => Convert.ToInt32(u.Low) <= Convert.ToInt32(Matasmtlist[Matasmtlist.Count - 1].Points) && Convert.ToInt32(Matasmtlist[Matasmtlist.Count - 1].Points) <= Convert.ToInt32(u.High));
        //                                if (MatadefLastRowEntity != null)
        //                                {
        //                                    if (Matasmtlist[0].RespExcel.Trim() == "Y")
        //                                        Lbench = "No score";
        //                                    else
        //                                        Lbench = MatadefLastRowEntity.Desc.Trim();
        //                                    LBench_Code = MatadefLastRowEntity.Code.Trim();
        //                                }
        //                                else
        //                                    Lbench = "N/A";

        //                                if (!string.IsNullOrEmpty(FPoints) && !string.IsNullOrEmpty(Lpoints))
        //                                {
        //                                    diff = int.Parse(Lpoints) - int.Parse(FPoints);
        //                                }
        //                                else if (string.IsNullOrEmpty(FPoints) && !string.IsNullOrEmpty(Lpoints))
        //                                    diff = int.Parse(Lpoints);
        //                                else if (!string.IsNullOrEmpty(FPoints) && string.IsNullOrEmpty(Lpoints))
        //                                    diff = int.Parse(FPoints);
        //                                if (diff > 0)
        //                                    Change = "Improvement  " + " +" + diff;
        //                                else if (diff < 0)
        //                                    Change = "Regressed      " + diff;
        //                                else if (diff == 0)
        //                                    Change = "No Change      ";

        //                                if (string.IsNullOrEmpty(FPoints) || string.IsNullOrEmpty(Lpoints))
        //                                    Change = "N/A";
        //                            }
        //                            PdfPCell Scale = new PdfPCell(new Phrase(Scl_Name, fc));
        //                            Scale.HorizontalAlignment = Element.ALIGN_LEFT;
        //                            Scale.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                            Table_Scales.AddCell(Scale);

        //                            if (Fbench == "N/A" || Fbench == "No score")
        //                            {
        //                                PdfPCell FirstAss = new PdfPCell(new Phrase(Fbench, fc));
        //                                FirstAss.HorizontalAlignment = Element.ALIGN_LEFT;
        //                                FirstAss.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                                Table_Scales.AddCell(FirstAss);
        //                            }
        //                            else if (!string.IsNullOrEmpty(FPoints))
        //                            {
        //                                PdfPCell FirstAss = new PdfPCell(new Phrase(Fbench + "(" + FPoints + ")", fc));
        //                                FirstAss.HorizontalAlignment = Element.ALIGN_LEFT;
        //                                FirstAss.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                                Table_Scales.AddCell(FirstAss);
        //                            }
        //                            else
        //                            {
        //                                PdfPCell FirstAss = new PdfPCell(new Phrase(Fbench, fc));
        //                                FirstAss.HorizontalAlignment = Element.ALIGN_LEFT;
        //                                FirstAss.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                                Table_Scales.AddCell(FirstAss);
        //                            }

        //                            if (Lbench == "N/A" || Lbench == "No score")
        //                            {
        //                                PdfPCell FirstAss = new PdfPCell(new Phrase(Lbench, fc));
        //                                FirstAss.HorizontalAlignment = Element.ALIGN_LEFT;
        //                                FirstAss.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                                Table_Scales.AddCell(FirstAss);
        //                            }
        //                            else if (!string.IsNullOrEmpty(Lpoints))
        //                            {
        //                                PdfPCell Lastass = new PdfPCell(new Phrase(Lbench + "(" + Lpoints + ")", fc));
        //                                Lastass.HorizontalAlignment = Element.ALIGN_LEFT;
        //                                Lastass.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                                Table_Scales.AddCell(Lastass);
        //                            }
        //                            else
        //                            {
        //                                PdfPCell Lastass = new PdfPCell(new Phrase(Lbench, fc));
        //                                Lastass.HorizontalAlignment = Element.ALIGN_LEFT;
        //                                Lastass.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                                Table_Scales.AddCell(Lastass);
        //                            }

        //                            if (Change == "Improvement  " + " +" + diff)
        //                            {
        //                                PdfPCell Result = new PdfPCell(new Phrase(Change, fcGreen));
        //                                Result.HorizontalAlignment = Element.ALIGN_LEFT;
        //                                Result.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                                Table_Scales.AddCell(Result);
        //                            }
        //                            else if (Change == "Regressed      " + diff)
        //                            {
        //                                PdfPCell Result = new PdfPCell(new Phrase(Change, fc1));
        //                                Result.HorizontalAlignment = Element.ALIGN_LEFT;
        //                                Result.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                                Table_Scales.AddCell(Result);
        //                            }
        //                            else
        //                            {
        //                                PdfPCell Result = new PdfPCell(new Phrase(Change, fc));
        //                                Result.HorizontalAlignment = Element.ALIGN_LEFT;
        //                                Result.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //                                Table_Scales.AddCell(Result);
        //                            }
        //                        }
        //                    }
        //                }
        //                document.Add(Table_Scales);
        //            }

        //            // Displaying Services for that program
        //            //if (CaseMSlist.Count > 0)
        //            //{
        //            //    DataSet dsResults = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.RESULTS);
        //            //    DataTable dtResults = dsResults.Tables[0];

        //            //    PdfPTable Table_Services = new PdfPTable(3);
        //            //    Table_Services.HorizontalAlignment = PdfContentByte.ALIGN_CENTER;
        //            //    Table_Services.TotalWidth = 550f;
        //            //    float[] widths = new float[] { 30f, 160f, 50f };
        //            //    Table_Services.SetWidths(widths);
        //            //    Table_Services.WidthPercentage = 100f;
        //            //    Table_Services.LockedWidth = true;
        //            //    Table_Services.SpacingBefore = 20f;

        //            //    foreach (CASEMSEntity Entity in CaseMSlist)
        //            //    {
        //            //        Out_Desc = string.Empty; Goals = string.Empty;
        //            //        CaseMS_Date = LookupDataAccess.Getdate(Entity.Date);
        //            //        MSList = _model.SPAdminData.Browse_MSMAST(null, Entity.MS_Code, null, null, null);
        //            //        if (MSList.Count > 0)
        //            //        {
        //            //            if (MSList[0].Type1 == "O")
        //            //            {
        //            //                Out_Desc = MSList[0].Desc.Trim();
        //            //                foreach (DataRow dr in dtResults.Rows)
        //            //                {
        //            //                    if (Entity.Result.Trim() == dr["Code"].ToString().Trim())
        //            //                    {
        //            //                        Goals = dr["LookUpDesc"].ToString().Trim(); break;
        //            //                    }
        //            //                }
        //            //            }
        //            //        }

        //            //        if (!string.IsNullOrEmpty(Out_Desc))
        //            //        {
        //            //            if (FIRST_Ser)
        //            //            {
        //            //                PdfPCell Header_ser = new PdfPCell(new Phrase("Services  Delivered since first visit to the agency", fcBold));
        //            //                Header_ser.HorizontalAlignment = Element.ALIGN_CENTER;
        //            //                Header_ser.Colspan = 4;
        //            //                Header_ser.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //            //                Table_Services.AddCell(Header_ser);

        //            //                PdfPCell Table_Date = new PdfPCell(new Phrase("Date", fcBold));
        //            //                Table_Date.HorizontalAlignment = Element.ALIGN_LEFT;
        //            //                Table_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //            //                Table_Services.AddCell(Table_Date);

        //            //                PdfPCell Table_Outcome = new PdfPCell(new Phrase("Outcome", fcBold));
        //            //                Table_Outcome.HorizontalAlignment = Element.ALIGN_LEFT;
        //            //                Table_Outcome.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //            //                Table_Services.AddCell(Table_Outcome);

        //            //                PdfPCell Table_Result = new PdfPCell(new Phrase("Result", fcBold));
        //            //                Table_Result.HorizontalAlignment = Element.ALIGN_LEFT;
        //            //                Table_Result.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //            //                Table_Services.AddCell(Table_Result);

        //            //                FIRST_Ser = false;
        //            //            }
        //            //            PdfPCell Scale = new PdfPCell(new Phrase(CaseMS_Date, fc));
        //            //            Scale.HorizontalAlignment = Element.ALIGN_LEFT;
        //            //            Scale.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //            //            Table_Services.AddCell(Scale);

        //            //            PdfPCell Data_2 = new PdfPCell(new Phrase(Out_Desc, fc));
        //            //            Data_2.HorizontalAlignment = Element.ALIGN_LEFT;
        //            //            Data_2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //            //            Table_Services.AddCell(Data_2);

        //            //            PdfPCell Data_3 = new PdfPCell(new Phrase(Goals, fc));
        //            //            Data_3.HorizontalAlignment = Element.ALIGN_LEFT;
        //            //            Data_3.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //            //            Table_Services.AddCell(Data_3);
        //            //        }

        //            //    }
        //            //    document.Add(Table_Services);
        //            //}

        //            //draw the Graphs for each Scale
        //            //if (matlist.Count > 0)
        //            //{
        //            //    bool First = true;
        //            //    string FPoints = string.Empty; //string Lpoints = string.Empty;

        //            //    foreach (MATDEFEntity Entity in matlist)
        //            //    {
        //            //        if (Entity.Scale_Code != "0")
        //            //        {
        //            //            string SclCode = Entity.Scale_Code.Trim();
        //            //            string DESC = Entity.Desc.Trim();
        //            //            //Matasmtlist = _model.MatrixScalesData.Browse_MATASMT(Entity_matasmt, "Browse");
        //            //            Matasmtlist = MATAList.FindAll(u => u.MatCode.Equals(Matcd) && u.SclCode.Equals(Entity.Scale_Code) && u.ByPass.Equals("N"));
        //            //            int Scl_Count = Matasmtlist.Count; string[] Dates = new string[Scl_Count];
        //            //            if (Matasmtlist.Count > 0)
        //            //            {
        //            //                int j = 0; string[] Points = new string[Scl_Count]; string[] BenchMarks = new string[Scl_Count]; string[] Resp_Excel_Sw = new string[Scl_Count];
        //            //                for (int c = 0; c < Scl_Count; c++)
        //            //                    Dates[c] = Points[c] = BenchMarks[c] = Resp_Excel_Sw[c] = " ";
        //            //                foreach (MATASMTEntity SMt in Matasmtlist)
        //            //                {
        //            //                    if (j < 11)
        //            //                    {
        //            //                        Dates[j] = LookupDataAccess.GetdatebyYear(SMt.SSDate);
        //            //                        Points[j] = SMt.Points;
        //            //                        Resp_Excel_Sw[j] = SMt.RespExcel.Trim();

        //            //                        MATDEFBMEntity MatadefrowEntity = MATADEFBMentity.Find(u => Convert.ToInt32(u.Low) <= Convert.ToInt32(SMt.Points) && Convert.ToInt32(SMt.Points) <= Convert.ToInt32(u.High));
        //            //                        if (MatadefrowEntity != null)
        //            //                            BenchMarks[j] = MatadefrowEntity.Desc.Trim();
        //            //                        j++;
        //            //                    }
        //            //                }

        //            //                bool IsThere = false;
        //            //                for (int i = 0; i < Points.Length; i++)
        //            //                {
        //            //                    if (Points[i] != " ")
        //            //                    {
        //            //                        string Fbench = string.Empty;
        //            //                        MATDEFBMEntity MatadefrowEntity = MATADEFBMentity.Find(u => Convert.ToInt32(u.Low) <= Convert.ToInt32(Points[i]) && Convert.ToInt32(Points[i]) <= Convert.ToInt32(u.High));
        //            //                        if (MatadefrowEntity != null)
        //            //                        {
        //            //                            IsThere = true; break;
        //            //                        }
        //            //                    }
        //            //                }
        //            //                if (IsThere)
        //            //                {
        //            //                    if (First)
        //            //                    {
        //            //                        document.NewPage();
        //            //                        X_Pos = 60; Y_Pos = 760; R_XV = Rect_X; R_YV = Rect_Y;
        //            //                        cb.BeginText();
        //            //                        iTextSharp.text.Font Bold_Under = new iTextSharp.text.Font(bfTimes, 12, 5);
        //            //                        Paragraph para = new Paragraph(PdfContentByte.ALIGN_CENTER, "Assessments  Completed", Bold_Under);
        //            //                        para.Alignment = Element.ALIGN_CENTER;
        //            //                        document.Add(para);
        //            //                        cb.EndText();
        //            //                        First = false;
        //            //                    }
        //            //                    int len = DESC.Length;
        //            //                    X_Pos = R_XV + 20; Y_Pos = R_YV + 145;
        //            //                    cb.BeginText();
        //            //                    cb.SetFontAndSize(FontFactory.GetFont(FontFactory.TIMES_ROMAN).BaseFont, 12);
        //            //                    cb.SetRGBColorFill(0, 10, 10);
        //            //                    cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, DESC, 300, Y_Pos, 0);

        //            //                    if (MatBMlist.Count > 0)
        //            //                    {
        //            //                        X_Pos = R_XV - 10; Y_Pos = R_YV + 20; int i = 0;
        //            //                        foreach (MATDEFBMEntity BM_Entity in MatBMlist)
        //            //                        {
        //            //                            if (i < 6)
        //            //                            {
        //            //                                Bench[i] = BM_Entity.Desc.Trim();
        //            //                                cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, Bench[i], X_Pos, Y_Pos, 0);
        //            //                                Y_Pos += 20; i++;
        //            //                            }
        //            //                        }
        //            //                    }

        //            //                    X_Pos = R_XV + 10; Y_Pos = R_YV - 10;
        //            //                    for (int i = 0; i < Dates.Length; ++i)
        //            //                    {
        //            //                        cb.SetFontAndSize(FontFactory.GetFont(FontFactory.TIMES_ROMAN).BaseFont, 8);
        //            //                        cb.ShowTextAligned(100, Dates[i], X_Pos, Y_Pos, 0);
        //            //                        X_Pos += 40;
        //            //                    }

        //            //                    cb.RoundRectangle(R_XV, R_YV, R_Breadth, R_Length, 5f);
        //            //                    cb.Stroke();

        //            //                    //PdfShading axial = PdfShading.SimpleAxial(writer, 36, 716, 396,788, BaseColor.ORANGE, BaseColor.BLUE);
        //            //                    ////cb.PaintShading(axial);
        //            //                    //PdfShadingPattern shading = new PdfShadingPattern(axial);
        //            //                    //cb.SetShadingFill(shading);

        //            //                    if (Entity.Scale_Code.Trim() == SclCode.Trim())
        //            //                    {
        //            //                        int Y_Axis = 20; int X_Axis = 20; string date = null;
        //            //                        for (int i = 0; i < Points.Length; i++)
        //            //                        {
        //            //                            if (Points[i] != " ")
        //            //                            {
        //            //                                string Fbench = string.Empty;
        //            //                                MATDEFBMEntity MatadefrowEntity = MATADEFBMentity.Find(u => Convert.ToInt32(u.Low) <= Convert.ToInt32(Points[i]) && Convert.ToInt32(Points[i]) <= Convert.ToInt32(u.High));
        //            //                                if (MatadefrowEntity != null)
        //            //                                    Fbench = MatadefrowEntity.Desc.Trim();
        //            //                                FPoints = Points[i];
        //            //                                date = Dates[i];
        //            //                                if (!string.IsNullOrEmpty(Fbench))
        //            //                                {
        //            //                                    int breadth = 0;
        //            //                                    switch (i)
        //            //                                    {
        //            //                                        case 0: if (date == Dates[0]) breadth = R_XV + 13; break;
        //            //                                        case 1: if (date == Dates[1]) breadth = R_XV + 53; break;
        //            //                                        case 2: if (date == Dates[2]) breadth = R_XV + 93; break;
        //            //                                        case 3: if (date == Dates[3]) breadth = R_XV + 133; break;
        //            //                                        case 4: if (date == Dates[4]) breadth = R_XV + 173; break;
        //            //                                        case 5: if (date == Dates[5]) breadth = R_XV + 213; break;
        //            //                                        case 6: if (date == Dates[6]) breadth = R_XV + 253; break;
        //            //                                        case 7: if (date == Dates[7]) breadth = R_XV + 293; break;
        //            //                                        case 8: if (date == Dates[8]) breadth = R_XV + 333; break;
        //            //                                        case 9: if (date == Dates[9]) breadth = R_XV + 373; break;
        //            //                                        case 10: if (date == Dates[10]) breadth = R_XV + 413; break;
        //            //                                    }

        //            //                                    if ((Bench[0] == Fbench))
        //            //                                    {
        //            //                                        cb.SetColorFill(BaseColor.DARK_GRAY.Brighter());
        //            //                                        cb.Rectangle(breadth + 2, R_YV + 0.5f, X_Axis - 1, Y_Axis + 1);
        //            //                                        cb.Fill();
        //            //                                        cb.SetColorFill(new BaseColor(0, 128, 128));
        //            //                                        cb.Rectangle(breadth, R_YV + 0.5f, X_Axis, Y_Axis);        //InCrisis
        //            //                                        cb.Fill();
        //            //                                        //cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 4, 0);
        //            //                                        cb.SetColorFill(BaseColor.WHITE);
        //            //                                        if (Resp_Excel_Sw[i] == "Y")
        //            //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, "N/A", breadth + 10, R_YV + 11, 0);
        //            //                                        else
        //            //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + 11, 0);
        //            //                                    }
        //            //                                    if ((Bench[1] == Fbench))
        //            //                                    {
        //            //                                        cb.SetColorFill(BaseColor.LIGHT_GRAY.Darker());
        //            //                                        cb.Rectangle(breadth + 2, R_YV + 0.5f, X_Axis - 1, Y_Axis + 21);
        //            //                                        cb.Fill();
        //            //                                        cb.SetColorFill(BaseColor.MAGENTA.Darker());
        //            //                                        cb.Rectangle(breadth, R_YV + 0.5f, X_Axis, Y_Axis + 20);        //Vulnarble
        //            //                                        cb.Fill(); cb.Stroke();
        //            //                                        //cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 24, 0);
        //            //                                        cb.SetColorFill(BaseColor.WHITE);
        //            //                                        if (Resp_Excel_Sw[i] == "Y")
        //            //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, "N/A", breadth + 10, R_YV + 11, 0);
        //            //                                        else
        //            //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 11, 0);
        //            //                                    }
        //            //                                    else if ((Bench[2] == Fbench))
        //            //                                    {
        //            //                                        cb.SetColorFill(BaseColor.LIGHT_GRAY.Darker());
        //            //                                        cb.Rectangle(breadth + 2, R_YV + 0.5f, X_Axis - 1, Y_Axis + 41);
        //            //                                        cb.Fill();

        //            //                                        cb.SetColorFill(new BaseColor(153, 51, 255));
        //            //                                        cb.Rectangle(breadth, R_YV + 0.5f, X_Axis, Y_Axis + 40);        //Safe
        //            //                                        cb.Fill(); cb.Stroke();
        //            //                                        //cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 44, 0);
        //            //                                        cb.SetColorFill(BaseColor.WHITE);
        //            //                                        if (Resp_Excel_Sw[i] == "Y")
        //            //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, "N/A", breadth + 10, R_YV + 11, 0);
        //            //                                        else
        //            //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 31, 0);
        //            //                                    }
        //            //                                    else if ((Bench[3] == Fbench))
        //            //                                    {
        //            //                                        cb.SetColorFill(BaseColor.LIGHT_GRAY.Darker());
        //            //                                        cb.Rectangle(breadth + 2, R_YV + 0.5f, X_Axis - 1, Y_Axis + 61);
        //            //                                        cb.Fill();

        //            //                                        cb.SetColorFill(new BaseColor(255, 140, 0));
        //            //                                        cb.Rectangle(breadth, R_YV + 0.5f, X_Axis, Y_Axis + 60);        //Stable
        //            //                                        cb.Fill(); cb.Stroke();
        //            //                                        //cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 64, 0);
        //            //                                        cb.SetColorFill(BaseColor.WHITE);
        //            //                                        if (Resp_Excel_Sw[i] == "Y")
        //            //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, "N/A", breadth + 10, R_YV + 11, 0);
        //            //                                        else
        //            //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 51, 0);
        //            //                                    }
        //            //                                    else if ((Bench[4] == Fbench))
        //            //                                    {
        //            //                                        cb.SetColorFill(BaseColor.LIGHT_GRAY.Darker());
        //            //                                        cb.Rectangle(breadth + 2, R_YV + 0.5f, X_Axis - 1, Y_Axis + 81);
        //            //                                        cb.Fill();

        //            //                                        cb.SetColorFill(new BaseColor(70, 130, 180));
        //            //                                        cb.Rectangle(breadth, R_YV + 0.5f, X_Axis, Y_Axis + 80);        //Thriving
        //            //                                        cb.Fill(); cb.Stroke();
        //            //                                        //cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 84, 0);
        //            //                                        cb.SetColorFill(BaseColor.WHITE);
        //            //                                        if (Resp_Excel_Sw[i] == "Y")
        //            //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, "N/A", breadth + 10, R_YV + 11, 0);
        //            //                                        else
        //            //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 71, 0);
        //            //                                    }
        //            //                                    else if ((Bench[5] == Fbench))
        //            //                                    {
        //            //                                        cb.SetColorFill(BaseColor.LIGHT_GRAY.Darker());
        //            //                                        cb.Rectangle(breadth + 2, R_YV + 0.5f, X_Axis - 1, Y_Axis + 101);
        //            //                                        cb.Fill();

        //            //                                        cb.SetColorFill(BaseColor.YELLOW.Darker());
        //            //                                        cb.Rectangle(breadth, R_YV + 0.5f, X_Axis, Y_Axis + 100);        //InCrisis
        //            //                                        cb.Fill(); cb.Stroke();
        //            //                                        //cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 104, 0);
        //            //                                        cb.SetColorFill(BaseColor.WHITE);
        //            //                                        if (Resp_Excel_Sw[i] == "Y")
        //            //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, "N/A", breadth + 10, R_YV + 11, 0);
        //            //                                        else
        //            //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 91, 0);
        //            //                                    }
        //            //                                }
        //            //                            }
        //            //                        }
        //            //                    }
        //            //                    cb.EndText();
        //            //                    float Rem_Width = Page_Width - (R_XV + R_Breadth);
        //            //                    float Rem_Height = R_YV;
        //            //                    if (Rem_Width > (R_Breadth + 30))
        //            //                    {
        //            //                        R_XV = R_XV + R_Breadth + 30;
        //            //                    }
        //            //                    else
        //            //                    {
        //            //                        Rem_Height = Page_Height - (Page_Height - R_YV);
        //            //                        if (Rem_Height > (R_Length + 50))
        //            //                        {
        //            //                            R_XV = Rect_X; R_YV = R_YV - (R_Length + 50);
        //            //                        }
        //            //                        else
        //            //                        {
        //            //                            document.NewPage();
        //            //                            R_XV = Rect_X; R_YV = Rect_Y;
        //            //                        }
        //            //                    }
        //            //                }
        //            //            }
        //            //        }

        //            //    }
        //            //}
        //        }
        //    }

        //    //document.Close();
        //    //fs.Close();
        //    //fs.Dispose();
        //    //FrmViewer objfrm = new FrmViewer(PdfName);
        //    ////objfrm.FormClosed += new Form.FormClosedEventHandler(On_Delete_PDF_File);
        //    //objfrm.ShowDialog();
        //}

        private void MATASMTPdf()
        {
            Random_Filename = null;

            PdfName = "M" + BaseForm.BaseApplicationNo.ToString();//form.GetFileName();
            PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
            try
            {
                if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
            }
            catch (Exception ex)
            {
                CommonFunctions.MessageBoxDisplay("Error");
            }


            try
            {
                string Tmpstr = PdfName + ".pdf";
                if (File.Exists(Tmpstr))
                    File.Delete(Tmpstr);
            }
            catch (Exception ex)
            {
                int length = 8;
                string newFileName = System.Guid.NewGuid().ToString();
                newFileName = newFileName.Replace("-", string.Empty);

                Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
            }

            if (!string.IsNullOrEmpty(Random_Filename))
                PdfName = Random_Filename;
            else
                PdfName += ".pdf";

            FileStream fs = new FileStream(PdfName, FileMode.Create);

            Document document = new Document(PageSize.A4, 25, 25, 30, 30);
            PdfWriter writer = PdfWriter.GetInstance(document, fs);
            document.Open();

            cb = writer.DirectContent;


            //iTextSharp.text.Image logo = iTextSharp.text.Image.GetInstance(Context.Server.MapPath("~\\Resources\\images\\Logo.JPG"));
            //logo.BackgroundColor = BaseColor.WHITE;
            //logo.ScalePercent(50f);
            //document.Add(logo);

            BaseFont bfTimes = BaseFont.CreateFont(BaseFont.TIMES_ROMAN, BaseFont.CP1250, false);

            iTextSharp.text.Font fc = new iTextSharp.text.Font(bfTimes, 12, 0);
            iTextSharp.text.Font fc1 = new iTextSharp.text.Font(bfTimes, 12, 0, BaseColor.RED);
            iTextSharp.text.Font fcGreen = new iTextSharp.text.Font(bfTimes, 12, 0, new BaseColor(0, 153, 0));
            iTextSharp.text.Font fcBold = new iTextSharp.text.Font(bfTimes, 12, 1);
            float X_Pos, Y_Pos;

            string AGY = GvwAppHou.SelectedRows[0].Cells["Grd_Agy"].Value.ToString();
            string Dept = GvwAppHou.SelectedRows[0].Cells["Grd_Dept"].Value.ToString();
            string Prog = GvwAppHou.SelectedRows[0].Cells["Grd_Prog"].Value.ToString();
            string Year = GvwAppHou.SelectedRows[0].Cells["Grd_Year"].Value.ToString();
            string App = GvwAppHou.SelectedRows[0].Cells["Grd_App"].Value.ToString();
            //PdfContentByte cb;
            //cb = writer.DirectContent;

            ////Casesum Entity list
            //List<CaseSumEntity> casesumdetails = new List<CaseSumEntity>();
            //casesumdetails = _model.CaseSumData.GetCaseSumDetails(AGY, Dept, Prog, Year, App, string.Empty);
            X_Pos = 60; Y_Pos = 680;
            bool FirstTime = false;
            var Matrix = MATAList.Select(u => u.MatCode).Distinct().ToList();

            if (Matrix.Count > 0)
            {
                foreach (var Matcd in Matrix)
                {
                    //MAtdef Entity list
                    string FirstAssDate = string.Empty, LastAssDate = string.Empty;
                    List<MATDEFEntity> matlist = new List<MATDEFEntity>();
                    MATDEFEntity MatEntity = new MATDEFEntity(true);
                    MatEntity.Mat_Code = Matcd;
                    matlist = _model.MatrixScalesData.Browse_MATDEF(MatEntity, "Browse");

                    // Services list
                    //List<CASEMSEntity> CaseMSlist = new List<CASEMSEntity>();
                    //CASEMSEntity MS_Search = new CASEMSEntity(true);
                    //MS_Search.Agency = BaseForm.BaseAgency; MS_Search.Dept = BaseForm.BaseDept;
                    //MS_Search.Program = BaseForm.BaseProg; MS_Search.Year = BaseForm.BaseYear;
                    //MS_Search.App_no = BaseForm.BaseApplicationNo;
                    //CaseMSlist = _model.SPAdminData.Browse_CASEMS(MS_Search, "Browse");

                    ////Outcomes List
                    //List<MSMASTEntity> MSList = new List<MSMASTEntity>();

                    bool FIRST_Ser = true;
                    string SP_Desc = string.Empty; string Out_Desc = string.Empty, CaseMS_Date = string.Empty, Goals = string.Empty;


                    //Benchmarks displayed
                    List<MATDEFBMEntity> MatBMlist = new List<MATDEFBMEntity>();
                    MATDEFBMEntity Search_Entity = new MATDEFBMEntity(true);
                    Search_Entity.MatCode = Matcd;
                    MatBMlist = _model.MatrixScalesData.Browse_MATDEFBM(Search_Entity, "Browse");
                    MatBMlist.Reverse();
                    string[] Bench = new string[6];


                    List<MATASMTEntity> Matasmtlist = new List<MATASMTEntity>();
                    Matasmtlist = MATAList.FindAll(u => u.ByPass.Equals("N") && u.MatCode.Equals(Matcd));
                    //MATASMTEntity Entity_matasmt = new MATASMTEntity(true);
                    //Entity_matasmt.Agency = AGY; Entity_matasmt.Dept = Dept;
                    //Entity_matasmt.Program = Prog; Entity_matasmt.Year = Year;
                    //Entity_matasmt.App = BaseForm.BaseApplicationNo; Entity_matasmt.Type = "S"; Entity_matasmt.ByPass = "N";
                    //Entity_matasmt.MatCode = Matcd;

                    MATDEFBMEntity Search1_Entity = new MATDEFBMEntity(true);
                    Search1_Entity.MatCode = Matcd;
                    MATADEFBMentity = _model.MatrixScalesData.Browse_MATDEFBM(Search_Entity, "Browse");


                    //Temp table not displayed on the screen
                    PdfPTable head = new PdfPTable(1);
                    head.HorizontalAlignment = Element.ALIGN_CENTER;
                    head.TotalWidth = 50f;
                    PdfPCell headcell = new PdfPCell(new Phrase(""));
                    headcell.HorizontalAlignment = Element.ALIGN_CENTER;
                    headcell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    head.AddCell(headcell);

                    if (!FirstTime)
                    {
                        cb.BeginText();
                        cb.SetFontAndSize(FontFactory.GetFont(FontFactory.TIMES_ROMAN).BaseFont, 12);
                        cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, AGY + "-" + Dept + "-" + Prog + " " + Year + " " + App + " " + Lbl_App_Name.Text.Trim(), 550, 780, 0);

                        cb.EndText();
                    }
                    else { document.NewPage(); }
                    document.Add(head);
                    //if (casesumdetails.Count > 0)
                    //{
                    //    //table For the Referral programmes
                    //    PdfPTable Table_Programs = new PdfPTable(2);
                    //    Table_Programs.HorizontalAlignment = 1;
                    //    Table_Programs.TotalWidth = 300f;
                    //    Table_Programs.WidthPercentage = 100f;
                    //    Table_Programs.LockedWidth = true;
                    //    Table_Programs.SpacingBefore = 10f;

                    //    PdfPCell Benefits = new PdfPCell(new Phrase("Benefits Portal Results", fcBold));
                    //    Benefits.HorizontalAlignment = Element.ALIGN_CENTER;
                    //    Benefits.Colspan = 2;
                    //    Benefits.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    //    Table_Programs.AddCell(Benefits);

                    //    PdfPCell Programs_Header = new PdfPCell(new Phrase("Programs Referred to", fcBold));
                    //    Programs_Header.HorizontalAlignment = Element.ALIGN_CENTER;
                    //    Programs_Header.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    //    Table_Programs.AddCell(Programs_Header);

                    //    PdfPCell Programs_Header1 = new PdfPCell(new Phrase("Date of Referral", fcBold));
                    //    Programs_Header1.HorizontalAlignment = Element.ALIGN_CENTER;
                    //    Programs_Header1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    //    Table_Programs.AddCell(Programs_Header1);

                    //    foreach (CaseSumEntity Entity in casesumdetails)
                    //    {
                    //        if (Entity.CaseSumNotInterested == "False")
                    //        {
                    //            DataRow drHie;//=new DataRow();
                    //            DataSet dsHie = DatabaseLayer.AgyTab.GetHierarchyNames(Entity.CaseSumRefHierachy.Substring(0, 2), Entity.CaseSumRefHierachy.Substring(2, 2), Entity.CaseSumRefHierachy.Substring(4, 2));

                    //            if (dsHie.Tables.Count > 0)
                    //            {
                    //                if (dsHie.Tables[0].Rows.Count > 0)
                    //                {
                    //                    drHie = dsHie.Tables[0].Rows[0];
                    //                    PdfPCell Hier = new PdfPCell(new Phrase(drHie["HIE_NAME"].ToString(), fc));
                    //                    Hier.HorizontalAlignment = Element.ALIGN_LEFT;
                    //                    Hier.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    //                    Table_Programs.AddCell(Hier);


                    //                    PdfPCell ReferDate = new PdfPCell(new Phrase(LookupDataAccess.Getdate(Entity.CaseSumReferDate), fc));
                    //                    ReferDate.HorizontalAlignment = Element.ALIGN_CENTER;
                    //                    ReferDate.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    //                    Table_Programs.AddCell(ReferDate);
                    //                }
                    //            }
                    //        }
                    //    }
                    //    document.Add(Table_Programs);
                    //}

                    //Scales assessment displaying first and last dates
                    if (matlist.Count > 0)
                    {
                        PdfPTable Table_Scales = new PdfPTable(4);
                        Table_Scales.HorizontalAlignment = 1;
                        Table_Scales.TotalWidth = 550f;
                        float[] Scale_widths = new float[] { 130f, 60f, 60f, 70f };
                        Table_Scales.SetWidths(Scale_widths);
                        Table_Scales.WidthPercentage = 100f;
                        Table_Scales.LockedWidth = true;
                        Table_Scales.SpacingBefore = 40f;

                        string Matdesc = matlist.Find(u => u.Scale_Code.Equals("0")).Desc.ToString();

                        PdfPCell Mat1 = new PdfPCell(new Phrase("Matrix: " + Matdesc.ToString(), fcBold));
                        Mat1.HorizontalAlignment = Element.ALIGN_CENTER;
                        Mat1.Colspan = 4;
                        Mat1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                        Table_Scales.AddCell(Mat1);

                        PdfPCell Life = new PdfPCell(new Phrase("Life Skills Assessments", fcBold));
                        Life.HorizontalAlignment = Element.ALIGN_CENTER;
                        Life.Colspan = 4;
                        Life.Border = iTextSharp.text.Rectangle.NO_BORDER;
                        Table_Scales.AddCell(Life);

                        PdfPCell Table_Header = new PdfPCell(new Phrase("Scale", fcBold));
                        Table_Header.HorizontalAlignment = Element.ALIGN_LEFT;
                        Table_Header.Border = iTextSharp.text.Rectangle.NO_BORDER;
                        Table_Scales.AddCell(Table_Header);

                        PdfPCell Table_Header1 = new PdfPCell(new Phrase("First Assessment", fcBold));
                        Table_Header1.HorizontalAlignment = Element.ALIGN_LEFT;
                        Table_Header1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                        Table_Scales.AddCell(Table_Header1);

                        PdfPCell Table_Header2 = new PdfPCell(new Phrase("Last Assessment", fcBold));
                        Table_Header2.HorizontalAlignment = Element.ALIGN_LEFT;
                        Table_Header2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                        Table_Scales.AddCell(Table_Header2);

                        PdfPCell Table_Header3 = new PdfPCell(new Phrase("Result", fcBold));
                        Table_Header3.HorizontalAlignment = Element.ALIGN_LEFT;
                        Table_Header3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                        Table_Scales.AddCell(Table_Header3);
                        foreach (MATDEFEntity Entity in matlist)
                        {
                            if (Entity.Scale_Code != "0")
                            {
                                //Entity_matasmt.SclCode = Entity.Scale_Code.Trim();
                                string Scl_Name = Entity.Desc.Trim();
                                string CalcBm = Entity.Benchmark;
                                Matasmtlist = MATAList.FindAll(u => u.MatCode.Equals(Matcd) && u.SclCode.Equals(Entity.Scale_Code) && u.ByPass.Equals("N"));
                                if (Entity.Assessment_Type == "I")
                                {
                                    if (Matasmtlist.Count > 0)
                                    {
                                        List<MATASMTEntity> MATAsmt_list = Matasmtlist;
                                        var distSeq = MATAsmt_list.Select(u => u.FamSeq).Distinct().ToList();
                                        if (distSeq.Count > 0)
                                        {
                                            foreach (var Famseq in distSeq)
                                            {
                                                MATAsmt_list = Matasmtlist.FindAll(u => u.SclCode.Equals(Entity.Scale_Code.Trim()) && u.FamSeq.Equals(Famseq));

                                                if (MATAsmt_list.Count > 0)
                                                {
                                                    string FPoints = string.Empty; string Lpoints = string.Empty; diff = 0; string FBench_Code = string.Empty; string LBench_Code = string.Empty;
                                                    string Fbench = "N/A", Lbench = "N/A"; Change = "N/A";

                                                    FirstAssDate = LookupDataAccess.Getdate(Matasmtlist[0].SSDate);
                                                    if (!string.IsNullOrEmpty(FirstAssDate))
                                                    {
                                                        FPoints = Matasmtlist[0].Points;
                                                        MATDEFBMEntity MatadefrowEntity = MATADEFBMentity.Find(u => Convert.ToInt32(u.Low) <= Convert.ToInt32(Matasmtlist[0].Points) && Convert.ToInt32(Matasmtlist[0].Points) <= Convert.ToInt32(u.High));
                                                        if (MatadefrowEntity != null)
                                                        {
                                                            if (Matasmtlist[0].RespExcel.Trim() == "Y")
                                                                Fbench = "No score";
                                                            else
                                                                Fbench = MatadefrowEntity.Desc.Trim();
                                                            FBench_Code = MatadefrowEntity.Code.Trim();
                                                        }
                                                        else
                                                            Fbench = "N/A";
                                                    }

                                                    LastAssDate = LookupDataAccess.Getdate(Matasmtlist[Matasmtlist.Count - 1].SSDate);
                                                    if (FirstAssDate == LastAssDate)
                                                        LastAssDate = string.Empty;
                                                    if (!string.IsNullOrEmpty(LastAssDate))
                                                    {
                                                        Lpoints = Matasmtlist[Matasmtlist.Count - 1].Points;
                                                        MATDEFBMEntity MatadefLastRowEntity = MATADEFBMentity.Find(u => Convert.ToInt32(u.Low) <= Convert.ToInt32(Matasmtlist[Matasmtlist.Count - 1].Points) && Convert.ToInt32(Matasmtlist[Matasmtlist.Count - 1].Points) <= Convert.ToInt32(u.High));
                                                        if (MatadefLastRowEntity != null)
                                                        {
                                                            if (Matasmtlist[0].RespExcel.Trim() == "Y")
                                                                Lbench = "No score";
                                                            else
                                                                Lbench = MatadefLastRowEntity.Desc.Trim();
                                                            LBench_Code = MatadefLastRowEntity.Code.Trim();
                                                        }
                                                        else
                                                            Lbench = "N/A";

                                                        if (!string.IsNullOrEmpty(FPoints) && !string.IsNullOrEmpty(Lpoints))
                                                        {
                                                            diff = int.Parse(Lpoints) - int.Parse(FPoints);
                                                        }
                                                        else if (string.IsNullOrEmpty(FPoints) && !string.IsNullOrEmpty(Lpoints))
                                                            diff = int.Parse(Lpoints);
                                                        else if (!string.IsNullOrEmpty(FPoints) && string.IsNullOrEmpty(Lpoints))
                                                            diff = int.Parse(FPoints);
                                                        if (diff > 0)
                                                            Change = "Improvement  " + " +" + diff;
                                                        else if (diff < 0)
                                                            Change = "Regressed      " + diff;
                                                        else if (diff == 0)
                                                            Change = "No Change      ";

                                                        if (string.IsNullOrEmpty(FPoints) || string.IsNullOrEmpty(Lpoints))
                                                            Change = "N/A";
                                                    }

                                                    string strName = string.Empty;
                                                    CaseSnpEntity casesnpName = BaseForm.BaseCaseSnpEntity.Find(u => u.FamilySeq.ToString().Trim() == Famseq);
                                                    if (casesnpName != null)
                                                        strName = LookupDataAccess.GetMemberName(casesnpName.NameixFi, casesnpName.NameixMi, casesnpName.NameixLast, BaseForm.BaseHierarchyCnFormat);


                                                    PdfPCell Scale = new PdfPCell(new Phrase(Scl_Name + " (" + strName + ")", fc));
                                                    Scale.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Scale.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Table_Scales.AddCell(Scale);

                                                    if (Fbench == "N/A" || Fbench == "No score")
                                                    {
                                                        PdfPCell FirstAss = new PdfPCell(new Phrase(Fbench, fc));
                                                        FirstAss.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        FirstAss.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        Table_Scales.AddCell(FirstAss);
                                                    }
                                                    else if (!string.IsNullOrEmpty(FPoints))
                                                    {
                                                        PdfPCell FirstAss = new PdfPCell(new Phrase(Fbench + "(" + FPoints + ")", fc));
                                                        FirstAss.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        FirstAss.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        Table_Scales.AddCell(FirstAss);
                                                    }
                                                    else
                                                    {
                                                        PdfPCell FirstAss = new PdfPCell(new Phrase(Fbench, fc));
                                                        FirstAss.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        FirstAss.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        Table_Scales.AddCell(FirstAss);
                                                    }

                                                    if (Lbench == "N/A" || Lbench == "No score")
                                                    {
                                                        PdfPCell FirstAss = new PdfPCell(new Phrase(Lbench, fc));
                                                        FirstAss.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        FirstAss.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        Table_Scales.AddCell(FirstAss);
                                                    }
                                                    else if (!string.IsNullOrEmpty(Lpoints))
                                                    {
                                                        PdfPCell Lastass = new PdfPCell(new Phrase(Lbench + "(" + Lpoints + ")", fc));
                                                        Lastass.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        Lastass.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        Table_Scales.AddCell(Lastass);
                                                    }
                                                    else
                                                    {
                                                        PdfPCell Lastass = new PdfPCell(new Phrase(Lbench, fc));
                                                        Lastass.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        Lastass.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        Table_Scales.AddCell(Lastass);
                                                    }

                                                    if (Change == "Improvement  " + " +" + diff)
                                                    {
                                                        PdfPCell Result = new PdfPCell(new Phrase(Change, fcGreen));
                                                        Result.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        Result.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        Table_Scales.AddCell(Result);
                                                    }
                                                    else if (Change == "Regressed      " + diff)
                                                    {
                                                        PdfPCell Result = new PdfPCell(new Phrase(Change, fc1));
                                                        Result.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        Result.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        Table_Scales.AddCell(Result);
                                                    }
                                                    else
                                                    {
                                                        PdfPCell Result = new PdfPCell(new Phrase(Change, fc));
                                                        Result.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        Result.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        Table_Scales.AddCell(Result);
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                                else if (Matasmtlist.Count > 0)
                                {
                                    string FPoints = string.Empty; string Lpoints = string.Empty; diff = 0; string FBench_Code = string.Empty; string LBench_Code = string.Empty;
                                    string Fbench = "N/A", Lbench = "N/A"; Change = "N/A";

                                    FirstAssDate = LookupDataAccess.Getdate(Matasmtlist[0].SSDate);
                                    if (!string.IsNullOrEmpty(FirstAssDate))
                                    {
                                        FPoints = Matasmtlist[0].Points;
                                        MATDEFBMEntity MatadefrowEntity = MATADEFBMentity.Find(u => Convert.ToInt32(u.Low) <= Convert.ToInt32(Matasmtlist[0].Points) && Convert.ToInt32(Matasmtlist[0].Points) <= Convert.ToInt32(u.High));
                                        if (MatadefrowEntity != null)
                                        {
                                            if (Matasmtlist[0].RespExcel.Trim() == "Y")
                                                Fbench = "No score";
                                            else
                                                Fbench = MatadefrowEntity.Desc.Trim();
                                            FBench_Code = MatadefrowEntity.Code.Trim();
                                        }
                                        else
                                            Fbench = "N/A";
                                    }

                                    LastAssDate = LookupDataAccess.Getdate(Matasmtlist[Matasmtlist.Count - 1].SSDate);
                                    if (FirstAssDate == LastAssDate)
                                        LastAssDate = string.Empty;
                                    if (!string.IsNullOrEmpty(LastAssDate))
                                    {
                                        Lpoints = Matasmtlist[Matasmtlist.Count - 1].Points;
                                        MATDEFBMEntity MatadefLastRowEntity = MATADEFBMentity.Find(u => Convert.ToInt32(u.Low) <= Convert.ToInt32(Matasmtlist[Matasmtlist.Count - 1].Points) && Convert.ToInt32(Matasmtlist[Matasmtlist.Count - 1].Points) <= Convert.ToInt32(u.High));
                                        if (MatadefLastRowEntity != null)
                                        {
                                            if (Matasmtlist[0].RespExcel.Trim() == "Y")
                                                Lbench = "No score";
                                            else
                                                Lbench = MatadefLastRowEntity.Desc.Trim();
                                            LBench_Code = MatadefLastRowEntity.Code.Trim();
                                        }
                                        else
                                            Lbench = "N/A";

                                        if (!string.IsNullOrEmpty(FPoints) && !string.IsNullOrEmpty(Lpoints))
                                        {
                                            diff = int.Parse(Lpoints) - int.Parse(FPoints);
                                        }
                                        else if (string.IsNullOrEmpty(FPoints) && !string.IsNullOrEmpty(Lpoints))
                                            diff = int.Parse(Lpoints);
                                        else if (!string.IsNullOrEmpty(FPoints) && string.IsNullOrEmpty(Lpoints))
                                            diff = int.Parse(FPoints);
                                        if (diff > 0)
                                            Change = "Improvement  " + " +" + diff;
                                        else if (diff < 0)
                                            Change = "Regressed      " + diff;
                                        else if (diff == 0)
                                            Change = "No Change      ";

                                        if (string.IsNullOrEmpty(FPoints) || string.IsNullOrEmpty(Lpoints))
                                            Change = "N/A";
                                    }
                                    PdfPCell Scale = new PdfPCell(new Phrase(Scl_Name, fc));
                                    Scale.HorizontalAlignment = Element.ALIGN_LEFT;
                                    Scale.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    Table_Scales.AddCell(Scale);

                                    if (Fbench == "N/A" || Fbench == "No score")
                                    {
                                        PdfPCell FirstAss = new PdfPCell(new Phrase(Fbench, fc));
                                        FirstAss.HorizontalAlignment = Element.ALIGN_LEFT;
                                        FirstAss.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Table_Scales.AddCell(FirstAss);
                                    }
                                    else if (!string.IsNullOrEmpty(FPoints))
                                    {
                                        PdfPCell FirstAss = new PdfPCell(new Phrase(Fbench + "(" + FPoints + ")", fc));
                                        FirstAss.HorizontalAlignment = Element.ALIGN_LEFT;
                                        FirstAss.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Table_Scales.AddCell(FirstAss);
                                    }
                                    else
                                    {
                                        PdfPCell FirstAss = new PdfPCell(new Phrase(Fbench, fc));
                                        FirstAss.HorizontalAlignment = Element.ALIGN_LEFT;
                                        FirstAss.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Table_Scales.AddCell(FirstAss);
                                    }

                                    if (Lbench == "N/A" || Lbench == "No score")
                                    {
                                        PdfPCell FirstAss = new PdfPCell(new Phrase(Lbench, fc));
                                        FirstAss.HorizontalAlignment = Element.ALIGN_LEFT;
                                        FirstAss.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Table_Scales.AddCell(FirstAss);
                                    }
                                    else if (!string.IsNullOrEmpty(Lpoints))
                                    {
                                        PdfPCell Lastass = new PdfPCell(new Phrase(Lbench + "(" + Lpoints + ")", fc));
                                        Lastass.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Lastass.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Table_Scales.AddCell(Lastass);
                                    }
                                    else
                                    {
                                        PdfPCell Lastass = new PdfPCell(new Phrase(Lbench, fc));
                                        Lastass.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Lastass.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Table_Scales.AddCell(Lastass);
                                    }

                                    if (Change == "Improvement  " + " +" + diff)
                                    {
                                        PdfPCell Result = new PdfPCell(new Phrase(Change, fcGreen));
                                        Result.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Result.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Table_Scales.AddCell(Result);
                                    }
                                    else if (Change == "Regressed      " + diff)
                                    {
                                        PdfPCell Result = new PdfPCell(new Phrase(Change, fc1));
                                        Result.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Result.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Table_Scales.AddCell(Result);
                                    }
                                    else
                                    {
                                        PdfPCell Result = new PdfPCell(new Phrase(Change, fc));
                                        Result.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Result.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Table_Scales.AddCell(Result);
                                    }
                                }
                            }
                        }
                        document.Add(Table_Scales);
                    }

                    // Displaying Services for that program
                    //if (CaseMSlist.Count > 0)
                    //{
                    //    DataSet dsResults = DatabaseLayer.Lookups.GetLookUpFromAGYTAB(Consts.AgyTab.RESULTS);
                    //    DataTable dtResults = dsResults.Tables[0];

                    //    PdfPTable Table_Services = new PdfPTable(3);
                    //    Table_Services.HorizontalAlignment = PdfContentByte.ALIGN_CENTER;
                    //    Table_Services.TotalWidth = 550f;
                    //    float[] widths = new float[] { 30f, 160f, 50f };
                    //    Table_Services.SetWidths(widths);
                    //    Table_Services.WidthPercentage = 100f;
                    //    Table_Services.LockedWidth = true;
                    //    Table_Services.SpacingBefore = 20f;

                    //    foreach (CASEMSEntity Entity in CaseMSlist)
                    //    {
                    //        Out_Desc = string.Empty; Goals = string.Empty;
                    //        CaseMS_Date = LookupDataAccess.Getdate(Entity.Date);
                    //        MSList = _model.SPAdminData.Browse_MSMAST(null, Entity.MS_Code, null, null, null);
                    //        if (MSList.Count > 0)
                    //        {
                    //            if (MSList[0].Type1 == "O")
                    //            {
                    //                Out_Desc = MSList[0].Desc.Trim();
                    //                foreach (DataRow dr in dtResults.Rows)
                    //                {
                    //                    if (Entity.Result.Trim() == dr["Code"].ToString().Trim())
                    //                    {
                    //                        Goals = dr["LookUpDesc"].ToString().Trim(); break;
                    //                    }
                    //                }
                    //            }
                    //        }

                    //        if (!string.IsNullOrEmpty(Out_Desc))
                    //        {
                    //            if (FIRST_Ser)
                    //            {
                    //                PdfPCell Header_ser = new PdfPCell(new Phrase("Services  Delivered since first visit to the agency", fcBold));
                    //                Header_ser.HorizontalAlignment = Element.ALIGN_CENTER;
                    //                Header_ser.Colspan = 4;
                    //                Header_ser.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    //                Table_Services.AddCell(Header_ser);

                    //                PdfPCell Table_Date = new PdfPCell(new Phrase("Date", fcBold));
                    //                Table_Date.HorizontalAlignment = Element.ALIGN_LEFT;
                    //                Table_Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    //                Table_Services.AddCell(Table_Date);

                    //                PdfPCell Table_Outcome = new PdfPCell(new Phrase("Outcome", fcBold));
                    //                Table_Outcome.HorizontalAlignment = Element.ALIGN_LEFT;
                    //                Table_Outcome.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    //                Table_Services.AddCell(Table_Outcome);

                    //                PdfPCell Table_Result = new PdfPCell(new Phrase("Result", fcBold));
                    //                Table_Result.HorizontalAlignment = Element.ALIGN_LEFT;
                    //                Table_Result.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    //                Table_Services.AddCell(Table_Result);

                    //                FIRST_Ser = false;
                    //            }
                    //            PdfPCell Scale = new PdfPCell(new Phrase(CaseMS_Date, fc));
                    //            Scale.HorizontalAlignment = Element.ALIGN_LEFT;
                    //            Scale.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    //            Table_Services.AddCell(Scale);

                    //            PdfPCell Data_2 = new PdfPCell(new Phrase(Out_Desc, fc));
                    //            Data_2.HorizontalAlignment = Element.ALIGN_LEFT;
                    //            Data_2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    //            Table_Services.AddCell(Data_2);

                    //            PdfPCell Data_3 = new PdfPCell(new Phrase(Goals, fc));
                    //            Data_3.HorizontalAlignment = Element.ALIGN_LEFT;
                    //            Data_3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    //            Table_Services.AddCell(Data_3);
                    //        }

                    //    }
                    //    document.Add(Table_Services);
                    //}

                    //draw the Graphs for each Scale
                    //if (matlist.Count > 0)
                    //{
                    //    bool First = true;
                    //    string FPoints = string.Empty; //string Lpoints = string.Empty;

                    //    foreach (MATDEFEntity Entity in matlist)
                    //    {
                    //        if (Entity.Scale_Code != "0")
                    //        {
                    //            string SclCode = Entity.Scale_Code.Trim();
                    //            string DESC = Entity.Desc.Trim();
                    //            //Matasmtlist = _model.MatrixScalesData.Browse_MATASMT(Entity_matasmt, "Browse");
                    //            Matasmtlist = MATAList.FindAll(u => u.MatCode.Equals(Matcd) && u.SclCode.Equals(Entity.Scale_Code) && u.ByPass.Equals("N"));
                    //            int Scl_Count = Matasmtlist.Count; string[] Dates = new string[Scl_Count];
                    //            if (Matasmtlist.Count > 0)
                    //            {
                    //                int j = 0; string[] Points = new string[Scl_Count]; string[] BenchMarks = new string[Scl_Count]; string[] Resp_Excel_Sw = new string[Scl_Count];
                    //                for (int c = 0; c < Scl_Count; c++)
                    //                    Dates[c] = Points[c] = BenchMarks[c] = Resp_Excel_Sw[c] = " ";
                    //                foreach (MATASMTEntity SMt in Matasmtlist)
                    //                {
                    //                    if (j < 11)
                    //                    {
                    //                        Dates[j] = LookupDataAccess.GetdatebyYear(SMt.SSDate);
                    //                        Points[j] = SMt.Points;
                    //                        Resp_Excel_Sw[j] = SMt.RespExcel.Trim();

                    //                        MATDEFBMEntity MatadefrowEntity = MATADEFBMentity.Find(u => Convert.ToInt32(u.Low) <= Convert.ToInt32(SMt.Points) && Convert.ToInt32(SMt.Points) <= Convert.ToInt32(u.High));
                    //                        if (MatadefrowEntity != null)
                    //                            BenchMarks[j] = MatadefrowEntity.Desc.Trim();
                    //                        j++;
                    //                    }
                    //                }

                    //                bool IsThere = false;
                    //                for (int i = 0; i < Points.Length; i++)
                    //                {
                    //                    if (Points[i] != " ")
                    //                    {
                    //                        string Fbench = string.Empty;
                    //                        MATDEFBMEntity MatadefrowEntity = MATADEFBMentity.Find(u => Convert.ToInt32(u.Low) <= Convert.ToInt32(Points[i]) && Convert.ToInt32(Points[i]) <= Convert.ToInt32(u.High));
                    //                        if (MatadefrowEntity != null)
                    //                        {
                    //                            IsThere = true; break;
                    //                        }
                    //                    }
                    //                }
                    //                if (IsThere)
                    //                {
                    //                    if (First)
                    //                    {
                    //                        document.NewPage();
                    //                        X_Pos = 60; Y_Pos = 760; R_XV = Rect_X; R_YV = Rect_Y;
                    //                        cb.BeginText();
                    //                        iTextSharp.text.Font Bold_Under = new iTextSharp.text.Font(bfTimes, 12, 5);
                    //                        Paragraph para = new Paragraph(PdfContentByte.ALIGN_CENTER, "Assessments  Completed", Bold_Under);
                    //                        para.Alignment = Element.ALIGN_CENTER;
                    //                        document.Add(para);
                    //                        cb.EndText();
                    //                        First = false;
                    //                    }
                    //                    int len = DESC.Length;
                    //                    X_Pos = R_XV + 20; Y_Pos = R_YV + 145;
                    //                    cb.BeginText();
                    //                    cb.SetFontAndSize(FontFactory.GetFont(FontFactory.TIMES_ROMAN).BaseFont, 12);
                    //                    cb.SetRGBColorFill(0, 10, 10);
                    //                    cb.ShowTextAligned(PdfContentByte.ALIGN_CENTER, DESC, 300, Y_Pos, 0);

                    //                    if (MatBMlist.Count > 0)
                    //                    {
                    //                        X_Pos = R_XV - 10; Y_Pos = R_YV + 20; int i = 0;
                    //                        foreach (MATDEFBMEntity BM_Entity in MatBMlist)
                    //                        {
                    //                            if (i < 6)
                    //                            {
                    //                                Bench[i] = BM_Entity.Desc.Trim();
                    //                                cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, Bench[i], X_Pos, Y_Pos, 0);
                    //                                Y_Pos += 20; i++;
                    //                            }
                    //                        }
                    //                    }

                    //                    X_Pos = R_XV + 10; Y_Pos = R_YV - 10;
                    //                    for (int i = 0; i < Dates.Length; ++i)
                    //                    {
                    //                        cb.SetFontAndSize(FontFactory.GetFont(FontFactory.TIMES_ROMAN).BaseFont, 8);
                    //                        cb.ShowTextAligned(100, Dates[i], X_Pos, Y_Pos, 0);
                    //                        X_Pos += 40;
                    //                    }

                    //                    cb.RoundRectangle(R_XV, R_YV, R_Breadth, R_Length, 5f);
                    //                    cb.Stroke();

                    //                    //PdfShading axial = PdfShading.SimpleAxial(writer, 36, 716, 396,788, BaseColor.ORANGE, BaseColor.BLUE);
                    //                    ////cb.PaintShading(axial);
                    //                    //PdfShadingPattern shading = new PdfShadingPattern(axial);
                    //                    //cb.SetShadingFill(shading);

                    //                    if (Entity.Scale_Code.Trim() == SclCode.Trim())
                    //                    {
                    //                        int Y_Axis = 20; int X_Axis = 20; string date = null;
                    //                        for (int i = 0; i < Points.Length; i++)
                    //                        {
                    //                            if (Points[i] != " ")
                    //                            {
                    //                                string Fbench = string.Empty;
                    //                                MATDEFBMEntity MatadefrowEntity = MATADEFBMentity.Find(u => Convert.ToInt32(u.Low) <= Convert.ToInt32(Points[i]) && Convert.ToInt32(Points[i]) <= Convert.ToInt32(u.High));
                    //                                if (MatadefrowEntity != null)
                    //                                    Fbench = MatadefrowEntity.Desc.Trim();
                    //                                FPoints = Points[i];
                    //                                date = Dates[i];
                    //                                if (!string.IsNullOrEmpty(Fbench))
                    //                                {
                    //                                    int breadth = 0;
                    //                                    switch (i)
                    //                                    {
                    //                                        case 0: if (date == Dates[0]) breadth = R_XV + 13; break;
                    //                                        case 1: if (date == Dates[1]) breadth = R_XV + 53; break;
                    //                                        case 2: if (date == Dates[2]) breadth = R_XV + 93; break;
                    //                                        case 3: if (date == Dates[3]) breadth = R_XV + 133; break;
                    //                                        case 4: if (date == Dates[4]) breadth = R_XV + 173; break;
                    //                                        case 5: if (date == Dates[5]) breadth = R_XV + 213; break;
                    //                                        case 6: if (date == Dates[6]) breadth = R_XV + 253; break;
                    //                                        case 7: if (date == Dates[7]) breadth = R_XV + 293; break;
                    //                                        case 8: if (date == Dates[8]) breadth = R_XV + 333; break;
                    //                                        case 9: if (date == Dates[9]) breadth = R_XV + 373; break;
                    //                                        case 10: if (date == Dates[10]) breadth = R_XV + 413; break;
                    //                                    }

                    //                                    if ((Bench[0] == Fbench))
                    //                                    {
                    //                                        cb.SetColorFill(BaseColor.DARK_GRAY.Brighter());
                    //                                        cb.Rectangle(breadth + 2, R_YV + 0.5f, X_Axis - 1, Y_Axis + 1);
                    //                                        cb.Fill();
                    //                                        cb.SetColorFill(new BaseColor(0, 128, 128));
                    //                                        cb.Rectangle(breadth, R_YV + 0.5f, X_Axis, Y_Axis);        //InCrisis
                    //                                        cb.Fill();
                    //                                        //cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 4, 0);
                    //                                        cb.SetColorFill(BaseColor.WHITE);
                    //                                        if (Resp_Excel_Sw[i] == "Y")
                    //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, "N/A", breadth + 10, R_YV + 11, 0);
                    //                                        else
                    //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + 11, 0);
                    //                                    }
                    //                                    if ((Bench[1] == Fbench))
                    //                                    {
                    //                                        cb.SetColorFill(BaseColor.LIGHT_GRAY.Darker());
                    //                                        cb.Rectangle(breadth + 2, R_YV + 0.5f, X_Axis - 1, Y_Axis + 21);
                    //                                        cb.Fill();
                    //                                        cb.SetColorFill(BaseColor.MAGENTA.Darker());
                    //                                        cb.Rectangle(breadth, R_YV + 0.5f, X_Axis, Y_Axis + 20);        //Vulnarble
                    //                                        cb.Fill(); cb.Stroke();
                    //                                        //cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 24, 0);
                    //                                        cb.SetColorFill(BaseColor.WHITE);
                    //                                        if (Resp_Excel_Sw[i] == "Y")
                    //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, "N/A", breadth + 10, R_YV + 11, 0);
                    //                                        else
                    //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 11, 0);
                    //                                    }
                    //                                    else if ((Bench[2] == Fbench))
                    //                                    {
                    //                                        cb.SetColorFill(BaseColor.LIGHT_GRAY.Darker());
                    //                                        cb.Rectangle(breadth + 2, R_YV + 0.5f, X_Axis - 1, Y_Axis + 41);
                    //                                        cb.Fill();

                    //                                        cb.SetColorFill(new BaseColor(153, 51, 255));
                    //                                        cb.Rectangle(breadth, R_YV + 0.5f, X_Axis, Y_Axis + 40);        //Safe
                    //                                        cb.Fill(); cb.Stroke();
                    //                                        //cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 44, 0);
                    //                                        cb.SetColorFill(BaseColor.WHITE);
                    //                                        if (Resp_Excel_Sw[i] == "Y")
                    //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, "N/A", breadth + 10, R_YV + 11, 0);
                    //                                        else
                    //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 31, 0);
                    //                                    }
                    //                                    else if ((Bench[3] == Fbench))
                    //                                    {
                    //                                        cb.SetColorFill(BaseColor.LIGHT_GRAY.Darker());
                    //                                        cb.Rectangle(breadth + 2, R_YV + 0.5f, X_Axis - 1, Y_Axis + 61);
                    //                                        cb.Fill();

                    //                                        cb.SetColorFill(new BaseColor(255, 140, 0));
                    //                                        cb.Rectangle(breadth, R_YV + 0.5f, X_Axis, Y_Axis + 60);        //Stable
                    //                                        cb.Fill(); cb.Stroke();
                    //                                        //cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 64, 0);
                    //                                        cb.SetColorFill(BaseColor.WHITE);
                    //                                        if (Resp_Excel_Sw[i] == "Y")
                    //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, "N/A", breadth + 10, R_YV + 11, 0);
                    //                                        else
                    //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 51, 0);
                    //                                    }
                    //                                    else if ((Bench[4] == Fbench))
                    //                                    {
                    //                                        cb.SetColorFill(BaseColor.LIGHT_GRAY.Darker());
                    //                                        cb.Rectangle(breadth + 2, R_YV + 0.5f, X_Axis - 1, Y_Axis + 81);
                    //                                        cb.Fill();

                    //                                        cb.SetColorFill(new BaseColor(70, 130, 180));
                    //                                        cb.Rectangle(breadth, R_YV + 0.5f, X_Axis, Y_Axis + 80);        //Thriving
                    //                                        cb.Fill(); cb.Stroke();
                    //                                        //cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 84, 0);
                    //                                        cb.SetColorFill(BaseColor.WHITE);
                    //                                        if (Resp_Excel_Sw[i] == "Y")
                    //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, "N/A", breadth + 10, R_YV + 11, 0);
                    //                                        else
                    //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 71, 0);
                    //                                    }
                    //                                    else if ((Bench[5] == Fbench))
                    //                                    {
                    //                                        cb.SetColorFill(BaseColor.LIGHT_GRAY.Darker());
                    //                                        cb.Rectangle(breadth + 2, R_YV + 0.5f, X_Axis - 1, Y_Axis + 101);
                    //                                        cb.Fill();

                    //                                        cb.SetColorFill(BaseColor.YELLOW.Darker());
                    //                                        cb.Rectangle(breadth, R_YV + 0.5f, X_Axis, Y_Axis + 100);        //InCrisis
                    //                                        cb.Fill(); cb.Stroke();
                    //                                        //cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 104, 0);
                    //                                        cb.SetColorFill(BaseColor.WHITE);
                    //                                        if (Resp_Excel_Sw[i] == "Y")
                    //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, "N/A", breadth + 10, R_YV + 11, 0);
                    //                                        else
                    //                                            cb.ShowTextAligned(iTextSharp.text.Rectangle.ALIGN_CENTER, FPoints, breadth + 10, R_YV + Y_Axis + 91, 0);
                    //                                    }
                    //                                }
                    //                            }
                    //                        }
                    //                    }
                    //                    cb.EndText();
                    //                    float Rem_Width = Page_Width - (R_XV + R_Breadth);
                    //                    float Rem_Height = R_YV;
                    //                    if (Rem_Width > (R_Breadth + 30))
                    //                    {
                    //                        R_XV = R_XV + R_Breadth + 30;
                    //                    }
                    //                    else
                    //                    {
                    //                        Rem_Height = Page_Height - (Page_Height - R_YV);
                    //                        if (Rem_Height > (R_Length + 50))
                    //                        {
                    //                            R_XV = Rect_X; R_YV = R_YV - (R_Length + 50);
                    //                        }
                    //                        else
                    //                        {
                    //                            document.NewPage();
                    //                            R_XV = Rect_X; R_YV = Rect_Y;
                    //                        }
                    //                    }
                    //                }
                    //            }
                    //        }

                    //    }
                    //}
                }
            }

            document.Close();
            fs.Close();
            fs.Dispose();
            //FrmViewer objfrm = new FrmViewer(PdfName);
            ////objfrm.FormClosed += new Form.FormClosedEventHandler(On_Delete_PDF_File);
            //objfrm.ShowDialog();
        }

        private void MATASMTPdfAllHier()
        {
            Random_Filename = null;

            PdfName = "M" + BaseForm.BaseApplicationNo.ToString();//form.GetFileName();
            PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
            try
            {
                if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
            }
            catch (Exception ex)
            {
                CommonFunctions.MessageBoxDisplay("Error");
            }


            try
            {
                string Tmpstr = PdfName + ".pdf";
                if (File.Exists(Tmpstr))
                    File.Delete(Tmpstr);
            }
            catch (Exception ex)
            {
                int length = 8;
                string newFileName = System.Guid.NewGuid().ToString();
                newFileName = newFileName.Replace("-", string.Empty);

                Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
            }

            if (!string.IsNullOrEmpty(Random_Filename))
                PdfName = Random_Filename;
            else
                PdfName += ".pdf";

            FileStream fs = new FileStream(PdfName, FileMode.Create);

            Document document = new Document(PageSize.A4, 25, 25, 30, 30);
            PdfWriter writer = PdfWriter.GetInstance(document, fs);
            document.Open();

            cb = writer.DirectContent;




            BaseFont bfTimes = BaseFont.CreateFont(BaseFont.TIMES_ROMAN, BaseFont.CP1250, false);

            iTextSharp.text.Font fc = new iTextSharp.text.Font(bfTimes, 12, 0);
            iTextSharp.text.Font fc1 = new iTextSharp.text.Font(bfTimes, 12, 0, BaseColor.RED);
            iTextSharp.text.Font fcGreen = new iTextSharp.text.Font(bfTimes, 12, 0, new BaseColor(0, 153, 0));
            iTextSharp.text.Font fcBold = new iTextSharp.text.Font(bfTimes, 12, 1);
            float X_Pos, Y_Pos;

            if (CASEMSTList.Count > 0)
            {
                foreach (CaseMstEntity MstEntity in CASEMSTList)
                {
                    string AGY = MstEntity.ApplAgency;
                    string Dept = MstEntity.ApplDept;
                    string Prog = MstEntity.ApplProgram;
                    string Year = MstEntity.ApplYr;
                    string App = MstEntity.ApplNo;


                    List<MATASMTEntity> SelMATAList = MATAList.FindAll(u => u.Agency.Equals(MstEntity.ApplAgency) && u.Dept.Equals(MstEntity.ApplDept) && u.Program.Equals(MstEntity.ApplProgram) && u.Year.Trim().Equals(MstEntity.ApplYr.Trim()) && u.App.Equals(MstEntity.ApplNo));
                    if (SelMATAList.Count > 0)
                    {
                        var Matrix = SelMATAList.Select(u => u.MatCode).Distinct().ToList();

                        X_Pos = 60; Y_Pos = 680;
                        bool FirstTime = false;
                        if (Matrix.Count > 0)
                        {
                            //iTextSharp.text.Image logo = iTextSharp.text.Image.GetInstance(Context.Server.MapPath("~\\Resources\\images\\Logo.JPG"));
                            //logo.BackgroundColor = BaseColor.WHITE;
                            //logo.ScalePercent(50f);
                            //document.Add(logo);

                            foreach (var Matcd in Matrix)
                            {
                                //MAtdef Entity list
                                string FirstAssDate = string.Empty, LastAssDate = string.Empty;
                                List<MATDEFEntity> matlist = new List<MATDEFEntity>();
                                MATDEFEntity MatEntity = new MATDEFEntity(true);
                                MatEntity.Mat_Code = Matcd;
                                matlist = _model.MatrixScalesData.Browse_MATDEF(MatEntity, "Browse");


                                bool FIRST_Ser = true;
                                string SP_Desc = string.Empty; string Out_Desc = string.Empty, CaseMS_Date = string.Empty, Goals = string.Empty;


                                //Benchmarks displayed
                                List<MATDEFBMEntity> MatBMlist = new List<MATDEFBMEntity>();
                                MATDEFBMEntity Search_Entity = new MATDEFBMEntity(true);
                                Search_Entity.MatCode = Matcd;
                                MatBMlist = _model.MatrixScalesData.Browse_MATDEFBM(Search_Entity, "Browse");
                                MatBMlist.Reverse();
                                string[] Bench = new string[6];


                                List<MATASMTEntity> Matasmtlist = new List<MATASMTEntity>();
                                Matasmtlist = SelMATAList.FindAll(u => u.ByPass.Equals("N") && u.MatCode.Equals(Matcd));
                                //MATASMTEntity Entity_matasmt = new MATASMTEntity(true);
                                //Entity_matasmt.Agency = AGY; Entity_matasmt.Dept = Dept;
                                //Entity_matasmt.Program = Prog; Entity_matasmt.Year = Year;
                                //Entity_matasmt.App = BaseForm.BaseApplicationNo; Entity_matasmt.Type = "S"; Entity_matasmt.ByPass = "N";
                                //Entity_matasmt.MatCode = Matcd;

                                MATDEFBMEntity Search1_Entity = new MATDEFBMEntity(true);
                                Search1_Entity.MatCode = Matcd;
                                MATADEFBMentity = _model.MatrixScalesData.Browse_MATDEFBM(Search_Entity, "Browse");


                                //Temp table not displayed on the screen
                                PdfPTable head = new PdfPTable(1);
                                head.HorizontalAlignment = Element.ALIGN_CENTER;
                                head.TotalWidth = 50f;
                                PdfPCell headcell = new PdfPCell(new Phrase(""));
                                headcell.HorizontalAlignment = Element.ALIGN_CENTER;
                                headcell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                head.AddCell(headcell);

                                if (!FirstTime)
                                {
                                    cb.BeginText();
                                    cb.SetFontAndSize(FontFactory.GetFont(FontFactory.TIMES_ROMAN).BaseFont, 12);
                                    cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, AGY + "-" + Dept + "-" + Prog + " " + Year + " " + App + " " + Lbl_App_Name.Text.Trim(), 550, 780, 0);

                                    cb.EndText();
                                }
                                else { document.NewPage(); }
                                document.Add(head);

                                //Scales assessment displaying first and last dates
                                if (matlist.Count > 0)
                                {
                                    PdfPTable Table_Scales = new PdfPTable(4);
                                    Table_Scales.HorizontalAlignment = 1;
                                    Table_Scales.TotalWidth = 550f;
                                    float[] Scale_widths = new float[] { 130f, 60f, 60f, 70f };
                                    Table_Scales.SetWidths(Scale_widths);
                                    Table_Scales.WidthPercentage = 100f;
                                    Table_Scales.LockedWidth = true;
                                    Table_Scales.SpacingBefore = 40f;

                                    string Matdesc = matlist.Find(u => u.Scale_Code.Equals("0")).Desc.ToString();

                                    PdfPCell Mat1 = new PdfPCell(new Phrase("Matrix: " + Matdesc.ToString(), fcBold));
                                    Mat1.HorizontalAlignment = Element.ALIGN_CENTER;
                                    Mat1.Colspan = 4;
                                    Mat1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    Table_Scales.AddCell(Mat1);

                                    PdfPCell Life = new PdfPCell(new Phrase("Life Skills Assessments", fcBold));
                                    Life.HorizontalAlignment = Element.ALIGN_CENTER;
                                    Life.Colspan = 4;
                                    Life.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    Table_Scales.AddCell(Life);

                                    PdfPCell Table_Header = new PdfPCell(new Phrase("Scale", fcBold));
                                    Table_Header.HorizontalAlignment = Element.ALIGN_LEFT;
                                    Table_Header.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    Table_Scales.AddCell(Table_Header);

                                    PdfPCell Table_Header1 = new PdfPCell(new Phrase("First Assessment", fcBold));
                                    Table_Header1.HorizontalAlignment = Element.ALIGN_LEFT;
                                    Table_Header1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    Table_Scales.AddCell(Table_Header1);

                                    PdfPCell Table_Header2 = new PdfPCell(new Phrase("Last Assessment", fcBold));
                                    Table_Header2.HorizontalAlignment = Element.ALIGN_LEFT;
                                    Table_Header2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    Table_Scales.AddCell(Table_Header2);

                                    PdfPCell Table_Header3 = new PdfPCell(new Phrase("Result", fcBold));
                                    Table_Header3.HorizontalAlignment = Element.ALIGN_LEFT;
                                    Table_Header3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    Table_Scales.AddCell(Table_Header3);
                                    foreach (MATDEFEntity Entity in matlist)
                                    {
                                        if (Entity.Scale_Code != "0")
                                        {
                                            //Entity_matasmt.SclCode = Entity.Scale_Code.Trim();
                                            string Scl_Name = Entity.Desc.Trim();
                                            string CalcBm = Entity.Benchmark;
                                            Matasmtlist = SelMATAList.FindAll(u => u.MatCode.Equals(Matcd) && u.SclCode.Equals(Entity.Scale_Code) && u.ByPass.Equals("N"));
                                            if (Matasmtlist.Count > 0)
                                            {
                                                string FPoints = string.Empty; string Lpoints = string.Empty; diff = 0; string FBench_Code = string.Empty; string LBench_Code = string.Empty;
                                                string Fbench = "N/A", Lbench = "N/A"; Change = "N/A";

                                                FirstAssDate = LookupDataAccess.Getdate(Matasmtlist[0].SSDate);
                                                if (!string.IsNullOrEmpty(FirstAssDate))
                                                {
                                                    FPoints = Matasmtlist[0].Points;
                                                    MATDEFBMEntity MatadefrowEntity = MATADEFBMentity.Find(u => Convert.ToInt32(u.Low) <= Convert.ToInt32(Matasmtlist[0].Points) && Convert.ToInt32(Matasmtlist[0].Points) <= Convert.ToInt32(u.High));
                                                    if (MatadefrowEntity != null)
                                                    {
                                                        if (Matasmtlist[0].RespExcel.Trim() == "Y")
                                                            Fbench = "No score";
                                                        else
                                                            Fbench = MatadefrowEntity.Desc.Trim();
                                                        FBench_Code = MatadefrowEntity.Code.Trim();
                                                    }
                                                    else
                                                        Fbench = "N/A";
                                                }

                                                LastAssDate = LookupDataAccess.Getdate(Matasmtlist[Matasmtlist.Count - 1].SSDate);
                                                if (FirstAssDate == LastAssDate)
                                                    LastAssDate = string.Empty;
                                                if (!string.IsNullOrEmpty(LastAssDate))
                                                {
                                                    Lpoints = Matasmtlist[Matasmtlist.Count - 1].Points;
                                                    MATDEFBMEntity MatadefLastRowEntity = MATADEFBMentity.Find(u => Convert.ToInt32(u.Low) <= Convert.ToInt32(Matasmtlist[Matasmtlist.Count - 1].Points) && Convert.ToInt32(Matasmtlist[Matasmtlist.Count - 1].Points) <= Convert.ToInt32(u.High));
                                                    if (MatadefLastRowEntity != null)
                                                    {
                                                        if (Matasmtlist[0].RespExcel.Trim() == "Y")
                                                            Lbench = "No score";
                                                        else
                                                            Lbench = MatadefLastRowEntity.Desc.Trim();
                                                        LBench_Code = MatadefLastRowEntity.Code.Trim();
                                                    }
                                                    else
                                                        Lbench = "N/A";

                                                    if (!string.IsNullOrEmpty(FPoints) && !string.IsNullOrEmpty(Lpoints))
                                                    {
                                                        diff = int.Parse(Lpoints) - int.Parse(FPoints);
                                                    }
                                                    else if (string.IsNullOrEmpty(FPoints) && !string.IsNullOrEmpty(Lpoints))
                                                        diff = int.Parse(Lpoints);
                                                    else if (!string.IsNullOrEmpty(FPoints) && string.IsNullOrEmpty(Lpoints))
                                                        diff = int.Parse(FPoints);
                                                    if (diff > 0)
                                                        Change = "Improvement  " + " +" + diff;
                                                    else if (diff < 0)
                                                        Change = "Regressed      " + diff;
                                                    else if (diff == 0)
                                                        Change = "No Change      ";

                                                    if (string.IsNullOrEmpty(FPoints) || string.IsNullOrEmpty(Lpoints))
                                                        Change = "N/A";
                                                }
                                                PdfPCell Scale = new PdfPCell(new Phrase(Scl_Name, fc));
                                                Scale.HorizontalAlignment = Element.ALIGN_LEFT;
                                                Scale.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                Table_Scales.AddCell(Scale);

                                                if (Fbench == "N/A" || Fbench == "No score")
                                                {
                                                    PdfPCell FirstAss = new PdfPCell(new Phrase(Fbench, fc));
                                                    FirstAss.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    FirstAss.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Table_Scales.AddCell(FirstAss);
                                                }
                                                else if (!string.IsNullOrEmpty(FPoints))
                                                {
                                                    PdfPCell FirstAss = new PdfPCell(new Phrase(Fbench + "(" + FPoints + ")", fc));
                                                    FirstAss.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    FirstAss.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Table_Scales.AddCell(FirstAss);
                                                }
                                                else
                                                {
                                                    PdfPCell FirstAss = new PdfPCell(new Phrase(Fbench, fc));
                                                    FirstAss.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    FirstAss.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Table_Scales.AddCell(FirstAss);
                                                }

                                                if (Lbench == "N/A" || Lbench == "No score")
                                                {
                                                    PdfPCell FirstAss = new PdfPCell(new Phrase(Lbench, fc));
                                                    FirstAss.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    FirstAss.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Table_Scales.AddCell(FirstAss);
                                                }
                                                else if (!string.IsNullOrEmpty(Lpoints))
                                                {
                                                    PdfPCell Lastass = new PdfPCell(new Phrase(Lbench + "(" + Lpoints + ")", fc));
                                                    Lastass.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Lastass.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Table_Scales.AddCell(Lastass);
                                                }
                                                else
                                                {
                                                    PdfPCell Lastass = new PdfPCell(new Phrase(Lbench, fc));
                                                    Lastass.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Lastass.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Table_Scales.AddCell(Lastass);
                                                }

                                                if (Change == "Improvement  " + " +" + diff)
                                                {
                                                    PdfPCell Result = new PdfPCell(new Phrase(Change, fcGreen));
                                                    Result.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Result.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Table_Scales.AddCell(Result);
                                                }
                                                else if (Change == "Regressed      " + diff)
                                                {
                                                    PdfPCell Result = new PdfPCell(new Phrase(Change, fc1));
                                                    Result.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Result.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Table_Scales.AddCell(Result);
                                                }
                                                else
                                                {
                                                    PdfPCell Result = new PdfPCell(new Phrase(Change, fc));
                                                    Result.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Result.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Table_Scales.AddCell(Result);
                                                }
                                            }
                                        }
                                    }
                                    document.Add(Table_Scales);
                                }
                            }
                        }
                    }
                    document.NewPage();
                }
            }



            document.Close();
            fs.Close();
            fs.Dispose();
            //FrmViewer objfrm = new FrmViewer(PdfName);
            ////objfrm.FormClosed += new Form.FormClosedEventHandler(On_Delete_PDF_File);
            //objfrm.ShowDialog();
        }

        //private void LiheapList(Document document)
        //{
        //    BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
        //    iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
        //    BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
        //    iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(1, 9, 4);
        //    BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

        //    iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
        //    iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
        //    iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
        //    iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(1, 9, 1);
        //    iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
        //    iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);

        //    PdfPTable LPBTable1 = new PdfPTable(2);
        //    LPBTable1.TotalWidth = 550f;
        //    LPBTable1.WidthPercentage = 100;
        //    LPBTable1.LockedWidth = true;
        //    float[] Lwidths = new float[] { 50f,50f };
        //    LPBTable1.SetWidths(Lwidths);
        //    LPBTable1.HorizontalAlignment = Element.ALIGN_LEFT;
        //    LPBTable1.SpacingAfter = 10f;

        //    PdfPTable LPBTable = new PdfPTable(4);
        //    LPBTable.TotalWidth = 350f;
        //    LPBTable.WidthPercentage = 100;
        //    LPBTable.LockedWidth = true;
        //    float[] widths2 = new float[] { 15f, 25f, 30f, 30f };
        //    LPBTable.SetWidths(widths2);
        //    LPBTable.HorizontalAlignment = Element.ALIGN_LEFT;

        //    string ProgramName = string.Empty;
        //    if (programEntity != null)
        //        ProgramName = programEntity.AgencyName;

        //    PdfPCell H1 = new PdfPCell(new Phrase("Hierarchy:" + CASEMSTList[0].ApplAgency + "-" + CASEMSTList[0].ApplDept + "-" + CASEMSTList[0].ApplProgram + " " + CASEMSTList[0].ApplYr + "  " + ProgramName, TblFontBold));
        //    H1.HorizontalAlignment = Element.ALIGN_LEFT;
        //    //H1.Colspan = 3;
        //    H1.FixedHeight = 15f;
        //    H1.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    LPBTable1.AddCell(H1);

        //    PdfPCell H2 = new PdfPCell(new Phrase("App:" + CASEMSTList[0].ApplNo + "  " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), TblFontBold));
        //    H2.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    //H2.Colspan = 3;
        //    H2.FixedHeight = 15f;
        //    H2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    LPBTable1.AddCell(H2);

        //    PdfPCell S2 = new PdfPCell(new Phrase("", TblFontBold));
        //    S2.HorizontalAlignment = Element.ALIGN_CENTER;
        //    S2.Colspan = 2;
        //    S2.FixedHeight = 15f;
        //    S2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    LPBTable1.AddCell(S2);

        //    document.Add(LPBTable1);

        //    PdfPCell Header = new PdfPCell(new Phrase("Fuel Assistance Benefit", TblFontBold));
        //    Header.HorizontalAlignment = Element.ALIGN_CENTER;
        //    Header.Colspan = 4;
        //    Header.FixedHeight = 15f;
        //    Header.Border = iTextSharp.text.Rectangle.BOX;
        //    LPBTable.AddCell(Header);

        //    string[] HeaderSeq = { "Type", "Date", "Award Amount", "Balance Amount"};
        //    for (int i = 0; i < HeaderSeq.Length; ++i)
        //    {
        //        PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
        //        cell.HorizontalAlignment = Element.ALIGN_CENTER;
        //        //cell.FixedHeight = 15f;
        //        cell.Border = iTextSharp.text.Rectangle.BOX;
        //        LPBTable.AddCell(cell);
        //    }

        //    string Benefit_Date = " ";
        //    foreach (LIHEAPBEntity Enty in LPBList)
        //    {
        //        Benefit_Date = " ";
        //        if (!string.IsNullOrEmpty(Enty.Award_Date.Trim()))
        //            Benefit_Date = LookupDataAccess.Getdate(Enty.Award_Date);

        //        if (!string.IsNullOrEmpty(Enty.Award_Type.Trim()))
        //        {
        //            if (Enty.Award_Type.Substring(0, 1) != "C" && Enty.Award_Type.Substring(0, 1) != "S")
        //            {
        //                Enty.Remaining = Enty.Award_Amount;
        //                if (!string.IsNullOrEmpty(Enty.Reduce_Elig))
        //                    Enty.Remaining = (decimal.Parse(Enty.Award_Amount) - decimal.Parse(Enty.Reduce_Elig)).ToString();

        //                PdfPCell A1 = new PdfPCell(new Phrase(Enty.Award_Type, TableFont));
        //                A1.HorizontalAlignment = Element.ALIGN_LEFT;
        //                A1.Border = iTextSharp.text.Rectangle.BOX;
        //                LPBTable.AddCell(A1);

        //                PdfPCell A2 = new PdfPCell(new Phrase(Benefit_Date, TableFont));
        //                A2.HorizontalAlignment = Element.ALIGN_LEFT;
        //                A2.Border = iTextSharp.text.Rectangle.BOX;
        //                LPBTable.AddCell(A2);

        //                PdfPCell A3 = new PdfPCell(new Phrase(Enty.Award_Amount, TableFont));
        //                A3.HorizontalAlignment = Element.ALIGN_RIGHT;
        //                A3.Border = iTextSharp.text.Rectangle.BOX;
        //                LPBTable.AddCell(A3);

        //                PdfPCell A4 = new PdfPCell(new Phrase(Enty.Remaining, TableFont));
        //                A4.HorizontalAlignment = Element.ALIGN_RIGHT;
        //                A4.Border = iTextSharp.text.Rectangle.BOX;
        //                LPBTable.AddCell(A4);

        //                //rowIndex = Benefits_Grid.Rows.Add(Enty.Award_Type, Benefit_Date, Enty.Award_Amount, Enty.Remaining);

        //            }
        //            else
        //            {
        //                if (Enty.Award_Amount == "0")
        //                {
        //                    PdfPCell A1 = new PdfPCell(new Phrase(Enty.Award_Type, TableFont));
        //                    A1.HorizontalAlignment = Element.ALIGN_LEFT;
        //                    A1.Border = iTextSharp.text.Rectangle.BOX;
        //                    LPBTable.AddCell(A1);

        //                    PdfPCell A2 = new PdfPCell(new Phrase(Benefit_Date, TableFont));
        //                    A2.HorizontalAlignment = Element.ALIGN_LEFT;
        //                    A2.Border = iTextSharp.text.Rectangle.BOX;
        //                    LPBTable.AddCell(A2);

        //                    PdfPCell A3 = new PdfPCell(new Phrase(Enty.Award_Amount, TableFont));
        //                    A3.HorizontalAlignment = Element.ALIGN_RIGHT;
        //                    A3.Border = iTextSharp.text.Rectangle.BOX;
        //                    LPBTable.AddCell(A3);

        //                    PdfPCell A4 = new PdfPCell(new Phrase("0.00", TableFont));
        //                    A4.HorizontalAlignment = Element.ALIGN_RIGHT;
        //                    A4.Border = iTextSharp.text.Rectangle.BOX;
        //                    LPBTable.AddCell(A4);
        //                }
        //                else
        //                {
        //                    PdfPCell A1 = new PdfPCell(new Phrase(Enty.Award_Type, TableFont));
        //                    A1.HorizontalAlignment = Element.ALIGN_LEFT;
        //                    A1.Border = iTextSharp.text.Rectangle.BOX;
        //                    LPBTable.AddCell(A1);

        //                    PdfPCell A2 = new PdfPCell(new Phrase(Benefit_Date, TableFont));
        //                    A2.HorizontalAlignment = Element.ALIGN_LEFT;
        //                    A2.Border = iTextSharp.text.Rectangle.BOX;
        //                    LPBTable.AddCell(A2);

        //                    PdfPCell A3 = new PdfPCell(new Phrase(Enty.Award_Amount, TableFont));
        //                    A3.HorizontalAlignment = Element.ALIGN_RIGHT;
        //                    A3.Border = iTextSharp.text.Rectangle.BOX;
        //                    LPBTable.AddCell(A3);

        //                    PdfPCell A4 = new PdfPCell(new Phrase(Enty.Remaining, TableFont));
        //                    A4.HorizontalAlignment = Element.ALIGN_RIGHT;
        //                    A4.Border = iTextSharp.text.Rectangle.BOX;
        //                    LPBTable.AddCell(A4);
        //                }
        //            }
        //        }
        //        else
        //        {
        //            if (Enty.Award_Amount == "0")
        //            {
        //                PdfPCell A1 = new PdfPCell(new Phrase(Enty.Award_Type, TableFont));
        //                A1.HorizontalAlignment = Element.ALIGN_LEFT;
        //                A1.Border = iTextSharp.text.Rectangle.BOX;
        //                LPBTable.AddCell(A1);

        //                PdfPCell A2 = new PdfPCell(new Phrase(Benefit_Date, TableFont));
        //                A2.HorizontalAlignment = Element.ALIGN_LEFT;
        //                A2.Border = iTextSharp.text.Rectangle.BOX;
        //                LPBTable.AddCell(A2);

        //                PdfPCell A3 = new PdfPCell(new Phrase(Enty.Award_Amount, TableFont));
        //                A3.HorizontalAlignment = Element.ALIGN_RIGHT;
        //                A3.Border = iTextSharp.text.Rectangle.BOX;
        //                LPBTable.AddCell(A3);

        //                PdfPCell A4 = new PdfPCell(new Phrase("0.00", TableFont));
        //                A4.HorizontalAlignment = Element.ALIGN_RIGHT;
        //                A4.Border = iTextSharp.text.Rectangle.BOX;
        //                LPBTable.AddCell(A4);
        //            }
        //            else
        //            {
        //                PdfPCell A1 = new PdfPCell(new Phrase(Enty.Award_Type, TableFont));
        //                A1.HorizontalAlignment = Element.ALIGN_LEFT;
        //                A1.Border = iTextSharp.text.Rectangle.BOX;
        //                LPBTable.AddCell(A1);

        //                PdfPCell A2 = new PdfPCell(new Phrase(Benefit_Date, TableFont));
        //                A2.HorizontalAlignment = Element.ALIGN_LEFT;
        //                A2.Border = iTextSharp.text.Rectangle.BOX;
        //                LPBTable.AddCell(A2);

        //                PdfPCell A3 = new PdfPCell(new Phrase(Enty.Award_Amount, TableFont));
        //                A3.HorizontalAlignment = Element.ALIGN_RIGHT;
        //                A3.Border = iTextSharp.text.Rectangle.BOX;
        //                LPBTable.AddCell(A3);

        //                PdfPCell A4 = new PdfPCell(new Phrase(Enty.Remaining, TableFont));
        //                A4.HorizontalAlignment = Element.ALIGN_RIGHT;
        //                A4.Border = iTextSharp.text.Rectangle.BOX;
        //                LPBTable.AddCell(A4);
        //            }


        //        }
        //    }

        //    document.Add(LPBTable);

        //    if (PaymentList.Count > 0)
        //    {
        //        Heating_List = _model.lookupDataAccess.Get_HearingSources();

        //        PdfPTable PAYTable = new PdfPTable(8);
        //        PAYTable.TotalWidth = 550f;
        //        PAYTable.WidthPercentage = 100;
        //        PAYTable.LockedWidth = true;
        //        float[] widths = new float[] { 23f, 18f, 8f, 20f,18f,25f,35f,25f };
        //        PAYTable.SetWidths(widths);
        //        PAYTable.HorizontalAlignment = Element.ALIGN_LEFT;
        //        PAYTable.SpacingBefore = 25f;

        //        PdfPCell Header1 = new PdfPCell(new Phrase("Fuel Assistance Authorization/Invoices", TblFontBold));
        //        Header1.HorizontalAlignment = Element.ALIGN_CENTER;
        //        Header1.Colspan = 8;
        //        Header1.FixedHeight = 15f;
        //        Header1.Border = iTextSharp.text.Rectangle.BOX;
        //        PAYTable.AddCell(Header1);

        //        string[] HeaderSeq1 = { "Authorization#", "Date", "BS", "Award Amount", "Pay For", "Worker", "Vendor", "Invoice Amount" };
        //        for (int i = 0; i < HeaderSeq1.Length; ++i)
        //        {
        //            PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq1[i], TblFontBold));
        //            cell.HorizontalAlignment = Element.ALIGN_CENTER;
        //            //cell.FixedHeight = 15f;
        //            cell.Border = iTextSharp.text.Rectangle.BOX;
        //            PAYTable.AddCell(cell);
        //        }


        //        bool Invoice_Exists = false;
        //        string Authr_Date = " ", Invc_SW = "N", SeftyNet_level = string.Empty, Bundle_SW = "N", Check_SW = "N";
        //        decimal Balance_Amount = 0, Priv_Award_Balance = 0, Invc_Dol1_Dol2 = 0;
        //        foreach (PAYMNETEntity Enty in PaymentList)
        //        {
        //            Invoice_Exists = false; Authr_Date = " "; Invc_SW = Bundle_SW = Check_SW = "N";
        //            if (!string.IsNullOrEmpty(Enty.Invc_Date.Trim()))
        //            {
        //                        Invoice_Exists = true;

        //                        if (!string.IsNullOrEmpty(Enty.Amount_Dol1))
        //                            Invc_Dol1_Dol2 = decimal.Parse(Enty.Amount_Dol1.Trim());

        //                        if (!string.IsNullOrEmpty(Enty.Amount_Dol2))
        //                            Invc_Dol1_Dol2 += decimal.Parse(Enty.Amount_Dol2.Trim());

        //                        if (!string.IsNullOrEmpty(Enty.Amount_Dol3))
        //                            Invc_Dol1_Dol2 += decimal.Parse(Enty.Amount_Dol3.Trim());


        //                        //if (decimal.Parse(Enty.Amount_Dol.Trim()) > Invc_Dol1_Dol2)
        //                        //    Alloc_Short_Fall = true;

        //                        if (!string.IsNullOrEmpty(Enty.Batch_NO.Trim()))
        //                            Bundle_SW = "Y";

        //                        if (!string.IsNullOrEmpty(Enty.Check_No.Trim()) && !string.IsNullOrEmpty(Enty.Check_Date.Trim()))
        //                            Check_SW = "Y";

        //                        Invc_SW = "Y";

        //            }


        //            if (!string.IsNullOrEmpty(Enty.Authr_Date.Trim()))
        //                Authr_Date = LookupDataAccess.Getdate(Enty.Authr_Date);

        //            double Authr_Amount = 0;
        //            if (!string.IsNullOrEmpty(Enty.Authr_Amount1))
        //                Authr_Amount += double.Parse(Enty.Authr_Amount1.Trim());
        //            if (!string.IsNullOrEmpty(Enty.Authr_Amount2))
        //                Authr_Amount += double.Parse(Enty.Authr_Amount2.Trim());
        //            if (!string.IsNullOrEmpty(Enty.Authr_Amount3))
        //                Authr_Amount += double.Parse(Enty.Authr_Amount3.Trim());

        //            PdfPCell A1 = new PdfPCell(new Phrase(Enty.Authr_Number, TableFont));
        //            A1.HorizontalAlignment = Element.ALIGN_LEFT;
        //            A1.Border = iTextSharp.text.Rectangle.BOX;
        //            PAYTable.AddCell(A1);

        //            PdfPCell A2 = new PdfPCell(new Phrase(Authr_Date, TableFont));
        //            A2.HorizontalAlignment = Element.ALIGN_LEFT;
        //            A2.Border = iTextSharp.text.Rectangle.BOX;
        //            PAYTable.AddCell(A2);

        //            PdfPCell A3 = new PdfPCell(new Phrase(((Enty.BS == "1" || Enty.BS == "Y") ? "Yes" : "No"), TableFont));
        //            A3.HorizontalAlignment = Element.ALIGN_RIGHT;
        //            A3.Border = iTextSharp.text.Rectangle.BOX;
        //            PAYTable.AddCell(A3);

        //            PdfPCell A4 = new PdfPCell(new Phrase(Authr_Amount.ToString(), TableFont));
        //            A4.HorizontalAlignment = Element.ALIGN_RIGHT;
        //            A4.Border = iTextSharp.text.Rectangle.BOX;
        //            PAYTable.AddCell(A4);

        //            PdfPCell A5 = new PdfPCell(new Phrase(Get_HeatingSource_Desc(Enty.Payment_For), TableFont));
        //            A5.HorizontalAlignment = Element.ALIGN_LEFT;
        //            A5.Border = iTextSharp.text.Rectangle.BOX;
        //            PAYTable.AddCell(A5);

        //            PdfPCell A6 = new PdfPCell(new Phrase(Get_CaseWorker_DESC(Enty.Authr_Caseworker), TableFont));
        //            A6.HorizontalAlignment = Element.ALIGN_LEFT;
        //            A6.Border = iTextSharp.text.Rectangle.BOX;
        //            PAYTable.AddCell(A6);

        //            PdfPCell A7 = new PdfPCell(new Phrase(Get_Vendor_Desc(Enty.Vendor), TableFont));
        //            A7.HorizontalAlignment = Element.ALIGN_LEFT;
        //            A7.Border = iTextSharp.text.Rectangle.BOX;
        //            PAYTable.AddCell(A7);

        //            PdfPCell A8 = new PdfPCell(new Phrase(Invoice_Exists ? Enty.Amount_Dol : " ", TableFont));
        //            A8.HorizontalAlignment = Element.ALIGN_LEFT;
        //            A8.Border = iTextSharp.text.Rectangle.BOX;
        //            PAYTable.AddCell(A8);
        //            //rowIndex = Payments_Grid.Rows.Add(Enty.Authr_Number, Authr_Date, ((Enty.BS == "1" || Enty.BS == "Y") ? "Yes" : "No"), Authr_Amount.ToString(), Get_HeatingSource_Desc(Enty.Payment_For), Enty.Authr_Caseworker, Get_Vendor_Desc(Enty.Vendor), Invoice_Exists ? Img_Tick : Img_Blank, Invoice_Exists ? Enty.Amount_Dol : " ", Invc_SW, Enty.MOR_Differential, Enty.Payment_For, Enty.Batch_NO, (Alloc_Short_Fall ? "Y" : "N"), Bundle_SW, Check_SW, Enty.SDWDC);
        //        }

        //        document.Add(PAYTable);

        //    }

        //}

        private void LiheapList()
        {
            Random_Filename = null;

            PdfName = "L" + BaseForm.BaseApplicationNo.ToString();//form.GetFileName();
            PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
            try
            {
                if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
            }
            catch (Exception ex)
            {
                CommonFunctions.MessageBoxDisplay("Error");
            }


            try
            {
                string Tmpstr = PdfName + ".pdf";
                if (File.Exists(Tmpstr))
                    File.Delete(Tmpstr);
            }
            catch (Exception ex)
            {
                int length = 8;
                string newFileName = System.Guid.NewGuid().ToString();
                newFileName = newFileName.Replace("-", string.Empty);

                Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
            }

            if (!string.IsNullOrEmpty(Random_Filename))
                PdfName = Random_Filename;
            else
                PdfName += ".pdf";

            FileStream fs = new FileStream(PdfName, FileMode.Create);

            Document document = new Document(PageSize.A4, 25, 25, 30, 30);
            PdfWriter writer = PdfWriter.GetInstance(document, fs);
            document.Open();

            cb = writer.DirectContent;

            BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
            iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
            BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
            iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(bf_times, 9, 4);
            BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

            iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
            iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
            iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
            iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(bf_times, 9, 1);
            iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
            iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);

            PdfPTable LPBTable1 = new PdfPTable(2);
            LPBTable1.TotalWidth = 550f;
            LPBTable1.WidthPercentage = 100;
            LPBTable1.LockedWidth = true;
            float[] Lwidths = new float[] { 50f, 50f };
            LPBTable1.SetWidths(Lwidths);
            LPBTable1.HorizontalAlignment = Element.ALIGN_LEFT;
            LPBTable1.SpacingAfter = 10f;

            PdfPTable LPBTable = new PdfPTable(4);
            LPBTable.TotalWidth = 350f;
            LPBTable.WidthPercentage = 100;
            LPBTable.LockedWidth = true;
            float[] widths2 = new float[] { 15f, 25f, 30f, 30f };
            LPBTable.SetWidths(widths2);
            LPBTable.HorizontalAlignment = Element.ALIGN_LEFT;

            string ProgramName = string.Empty;
            if (programEntity != null)
                ProgramName = programEntity.HirarchyName;

            PdfPCell H1 = new PdfPCell(new Phrase("Hierarchy:" + CASEMSTList[0].ApplAgency + "-" + CASEMSTList[0].ApplDept + "-" + CASEMSTList[0].ApplProgram + " " + CASEMSTList[0].ApplYr + "  " + ProgramName, TblFontBold));
            H1.HorizontalAlignment = Element.ALIGN_LEFT;
            //H1.Colspan = 3;
            H1.FixedHeight = 15f;
            H1.Border = iTextSharp.text.Rectangle.NO_BORDER;
            LPBTable1.AddCell(H1);

            PdfPCell H2 = new PdfPCell(new Phrase("App:" + CASEMSTList[0].ApplNo + "  " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), TblFontBold));
            H2.HorizontalAlignment = Element.ALIGN_RIGHT;
            //H2.Colspan = 3;
            H2.FixedHeight = 15f;
            H2.Border = iTextSharp.text.Rectangle.NO_BORDER;
            LPBTable1.AddCell(H2);

            PdfPCell S2 = new PdfPCell(new Phrase("", TblFontBold));
            S2.HorizontalAlignment = Element.ALIGN_CENTER;
            S2.Colspan = 2;
            S2.FixedHeight = 15f;
            S2.Border = iTextSharp.text.Rectangle.NO_BORDER;
            LPBTable1.AddCell(S2);

            document.Add(LPBTable1);

            PdfPCell Header = new PdfPCell(new Phrase("Fuel Assistance Benefit", TblFontBold));
            Header.HorizontalAlignment = Element.ALIGN_CENTER;
            Header.Colspan = 4;
            Header.FixedHeight = 15f;
            Header.Border = iTextSharp.text.Rectangle.BOX;
            LPBTable.AddCell(Header);

            string[] HeaderSeq = { "Type", "Date", "Award Amount", "Balance Amount" };
            for (int i = 0; i < HeaderSeq.Length; ++i)
            {
                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                //cell.FixedHeight = 15f;
                cell.Border = iTextSharp.text.Rectangle.BOX;
                LPBTable.AddCell(cell);
            }

            string Benefit_Date = " ";
            foreach (LIHEAPBEntity Enty in LPBList)
            {
                Benefit_Date = " ";
                if (!string.IsNullOrEmpty(Enty.Award_Date.Trim()))
                    Benefit_Date = LookupDataAccess.Getdate(Enty.Award_Date);

                if (!string.IsNullOrEmpty(Enty.Award_Type.Trim()))
                {
                    if (Enty.Award_Type.Substring(0, 1) != "C" && Enty.Award_Type.Substring(0, 1) != "S")
                    {
                        Enty.Remaining = Enty.Award_Amount;
                        if (!string.IsNullOrEmpty(Enty.Reduce_Elig))
                            Enty.Remaining = (decimal.Parse(Enty.Award_Amount) - decimal.Parse(Enty.Reduce_Elig)).ToString();

                        PdfPCell A1 = new PdfPCell(new Phrase(Enty.Award_Type, TableFont));
                        A1.HorizontalAlignment = Element.ALIGN_LEFT;
                        A1.Border = iTextSharp.text.Rectangle.BOX;
                        LPBTable.AddCell(A1);

                        PdfPCell A2 = new PdfPCell(new Phrase(Benefit_Date, TableFont));
                        A2.HorizontalAlignment = Element.ALIGN_LEFT;
                        A2.Border = iTextSharp.text.Rectangle.BOX;
                        LPBTable.AddCell(A2);

                        PdfPCell A3 = new PdfPCell(new Phrase(Enty.Award_Amount, TableFont));
                        A3.HorizontalAlignment = Element.ALIGN_RIGHT;
                        A3.Border = iTextSharp.text.Rectangle.BOX;
                        LPBTable.AddCell(A3);

                        PdfPCell A4 = new PdfPCell(new Phrase(Enty.Remaining, TableFont));
                        A4.HorizontalAlignment = Element.ALIGN_RIGHT;
                        A4.Border = iTextSharp.text.Rectangle.BOX;
                        LPBTable.AddCell(A4);

                        //rowIndex = Benefits_Grid.Rows.Add(Enty.Award_Type, Benefit_Date, Enty.Award_Amount, Enty.Remaining);

                    }
                    else
                    {
                        if (Enty.Award_Amount == "0")
                        {
                            PdfPCell A1 = new PdfPCell(new Phrase(Enty.Award_Type, TableFont));
                            A1.HorizontalAlignment = Element.ALIGN_LEFT;
                            A1.Border = iTextSharp.text.Rectangle.BOX;
                            LPBTable.AddCell(A1);

                            PdfPCell A2 = new PdfPCell(new Phrase(Benefit_Date, TableFont));
                            A2.HorizontalAlignment = Element.ALIGN_LEFT;
                            A2.Border = iTextSharp.text.Rectangle.BOX;
                            LPBTable.AddCell(A2);

                            PdfPCell A3 = new PdfPCell(new Phrase(Enty.Award_Amount, TableFont));
                            A3.HorizontalAlignment = Element.ALIGN_RIGHT;
                            A3.Border = iTextSharp.text.Rectangle.BOX;
                            LPBTable.AddCell(A3);

                            PdfPCell A4 = new PdfPCell(new Phrase("0.00", TableFont));
                            A4.HorizontalAlignment = Element.ALIGN_RIGHT;
                            A4.Border = iTextSharp.text.Rectangle.BOX;
                            LPBTable.AddCell(A4);
                        }
                        else
                        {
                            PdfPCell A1 = new PdfPCell(new Phrase(Enty.Award_Type, TableFont));
                            A1.HorizontalAlignment = Element.ALIGN_LEFT;
                            A1.Border = iTextSharp.text.Rectangle.BOX;
                            LPBTable.AddCell(A1);

                            PdfPCell A2 = new PdfPCell(new Phrase(Benefit_Date, TableFont));
                            A2.HorizontalAlignment = Element.ALIGN_LEFT;
                            A2.Border = iTextSharp.text.Rectangle.BOX;
                            LPBTable.AddCell(A2);

                            PdfPCell A3 = new PdfPCell(new Phrase(Enty.Award_Amount, TableFont));
                            A3.HorizontalAlignment = Element.ALIGN_RIGHT;
                            A3.Border = iTextSharp.text.Rectangle.BOX;
                            LPBTable.AddCell(A3);

                            PdfPCell A4 = new PdfPCell(new Phrase(Enty.Remaining, TableFont));
                            A4.HorizontalAlignment = Element.ALIGN_RIGHT;
                            A4.Border = iTextSharp.text.Rectangle.BOX;
                            LPBTable.AddCell(A4);
                        }
                    }
                }
                else
                {
                    if (Enty.Award_Amount == "0")
                    {
                        PdfPCell A1 = new PdfPCell(new Phrase(Enty.Award_Type, TableFont));
                        A1.HorizontalAlignment = Element.ALIGN_LEFT;
                        A1.Border = iTextSharp.text.Rectangle.BOX;
                        LPBTable.AddCell(A1);

                        PdfPCell A2 = new PdfPCell(new Phrase(Benefit_Date, TableFont));
                        A2.HorizontalAlignment = Element.ALIGN_LEFT;
                        A2.Border = iTextSharp.text.Rectangle.BOX;
                        LPBTable.AddCell(A2);

                        PdfPCell A3 = new PdfPCell(new Phrase(Enty.Award_Amount, TableFont));
                        A3.HorizontalAlignment = Element.ALIGN_RIGHT;
                        A3.Border = iTextSharp.text.Rectangle.BOX;
                        LPBTable.AddCell(A3);

                        PdfPCell A4 = new PdfPCell(new Phrase("0.00", TableFont));
                        A4.HorizontalAlignment = Element.ALIGN_RIGHT;
                        A4.Border = iTextSharp.text.Rectangle.BOX;
                        LPBTable.AddCell(A4);
                    }
                    else
                    {
                        PdfPCell A1 = new PdfPCell(new Phrase(Enty.Award_Type, TableFont));
                        A1.HorizontalAlignment = Element.ALIGN_LEFT;
                        A1.Border = iTextSharp.text.Rectangle.BOX;
                        LPBTable.AddCell(A1);

                        PdfPCell A2 = new PdfPCell(new Phrase(Benefit_Date, TableFont));
                        A2.HorizontalAlignment = Element.ALIGN_LEFT;
                        A2.Border = iTextSharp.text.Rectangle.BOX;
                        LPBTable.AddCell(A2);

                        PdfPCell A3 = new PdfPCell(new Phrase(Enty.Award_Amount, TableFont));
                        A3.HorizontalAlignment = Element.ALIGN_RIGHT;
                        A3.Border = iTextSharp.text.Rectangle.BOX;
                        LPBTable.AddCell(A3);

                        PdfPCell A4 = new PdfPCell(new Phrase(Enty.Remaining, TableFont));
                        A4.HorizontalAlignment = Element.ALIGN_RIGHT;
                        A4.Border = iTextSharp.text.Rectangle.BOX;
                        LPBTable.AddCell(A4);
                    }


                }
            }

            document.Add(LPBTable);

            if (PaymentList.Count > 0)
            {
                Heating_List = _model.lookupDataAccess.Get_HearingSources();

                PdfPTable PAYTable = new PdfPTable(8);
                PAYTable.TotalWidth = 550f;
                PAYTable.WidthPercentage = 100;
                PAYTable.LockedWidth = true;
                float[] widths = new float[] { 23f, 18f, 8f, 20f, 18f, 25f, 35f, 25f };
                PAYTable.SetWidths(widths);
                PAYTable.HorizontalAlignment = Element.ALIGN_LEFT;
                PAYTable.SpacingBefore = 25f;

                PdfPCell Header1 = new PdfPCell(new Phrase("Fuel Assistance Authorization/Invoices", TblFontBold));
                Header1.HorizontalAlignment = Element.ALIGN_CENTER;
                Header1.Colspan = 8;
                Header1.FixedHeight = 15f;
                Header1.Border = iTextSharp.text.Rectangle.BOX;
                PAYTable.AddCell(Header1);

                string[] HeaderSeq1 = { "Authorization#", "Date", "BS", "Award Amount", "Pay For", "Worker", "Vendor", "Invoice Amount" };
                for (int i = 0; i < HeaderSeq1.Length; ++i)
                {
                    PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq1[i], TblFontBold));
                    cell.HorizontalAlignment = Element.ALIGN_CENTER;
                    //cell.FixedHeight = 15f;
                    cell.Border = iTextSharp.text.Rectangle.BOX;
                    PAYTable.AddCell(cell);
                }


                bool Invoice_Exists = false;
                string Authr_Date = " ", Invc_SW = "N", SeftyNet_level = string.Empty, Bundle_SW = "N", Check_SW = "N";
                decimal Balance_Amount = 0, Priv_Award_Balance = 0, Invc_Dol1_Dol2 = 0;
                foreach (PAYMNETEntity Enty in PaymentList)
                {
                    Invoice_Exists = false; Authr_Date = " "; Invc_SW = Bundle_SW = Check_SW = "N";
                    if (!string.IsNullOrEmpty(Enty.Invc_Date.Trim()))
                    {
                        Invoice_Exists = true;

                        if (!string.IsNullOrEmpty(Enty.Amount_Dol1))
                            Invc_Dol1_Dol2 = decimal.Parse(Enty.Amount_Dol1.Trim());

                        if (!string.IsNullOrEmpty(Enty.Amount_Dol2))
                            Invc_Dol1_Dol2 += decimal.Parse(Enty.Amount_Dol2.Trim());

                        if (!string.IsNullOrEmpty(Enty.Amount_Dol3))
                            Invc_Dol1_Dol2 += decimal.Parse(Enty.Amount_Dol3.Trim());


                        //if (decimal.Parse(Enty.Amount_Dol.Trim()) > Invc_Dol1_Dol2)
                        //    Alloc_Short_Fall = true;

                        if (!string.IsNullOrEmpty(Enty.Batch_NO.Trim()))
                            Bundle_SW = "Y";

                        if (!string.IsNullOrEmpty(Enty.Check_No.Trim()) && !string.IsNullOrEmpty(Enty.Check_Date.Trim()))
                            Check_SW = "Y";

                        Invc_SW = "Y";

                    }


                    if (!string.IsNullOrEmpty(Enty.Authr_Date.Trim()))
                        Authr_Date = LookupDataAccess.Getdate(Enty.Authr_Date);

                    double Authr_Amount = 0;
                    if (!string.IsNullOrEmpty(Enty.Authr_Amount1))
                        Authr_Amount += double.Parse(Enty.Authr_Amount1.Trim());
                    if (!string.IsNullOrEmpty(Enty.Authr_Amount2))
                        Authr_Amount += double.Parse(Enty.Authr_Amount2.Trim());
                    if (!string.IsNullOrEmpty(Enty.Authr_Amount3))
                        Authr_Amount += double.Parse(Enty.Authr_Amount3.Trim());

                    PdfPCell A1 = new PdfPCell(new Phrase(Enty.Authr_Number, TableFont));
                    A1.HorizontalAlignment = Element.ALIGN_LEFT;
                    A1.Border = iTextSharp.text.Rectangle.BOX;
                    PAYTable.AddCell(A1);

                    PdfPCell A2 = new PdfPCell(new Phrase(Authr_Date, TableFont));
                    A2.HorizontalAlignment = Element.ALIGN_LEFT;
                    A2.Border = iTextSharp.text.Rectangle.BOX;
                    PAYTable.AddCell(A2);

                    PdfPCell A3 = new PdfPCell(new Phrase(((Enty.BS == "1" || Enty.BS == "Y") ? "Yes" : "No"), TableFont));
                    A3.HorizontalAlignment = Element.ALIGN_RIGHT;
                    A3.Border = iTextSharp.text.Rectangle.BOX;
                    PAYTable.AddCell(A3);

                    PdfPCell A4 = new PdfPCell(new Phrase(Authr_Amount.ToString(), TableFont));
                    A4.HorizontalAlignment = Element.ALIGN_RIGHT;
                    A4.Border = iTextSharp.text.Rectangle.BOX;
                    PAYTable.AddCell(A4);

                    PdfPCell A5 = new PdfPCell(new Phrase(Get_HeatingSource_Desc(Enty.Payment_For), TableFont));
                    A5.HorizontalAlignment = Element.ALIGN_LEFT;
                    A5.Border = iTextSharp.text.Rectangle.BOX;
                    PAYTable.AddCell(A5);

                    PdfPCell A6 = new PdfPCell(new Phrase(Get_CaseWorker_DESC(Enty.Authr_Caseworker), TableFont));
                    A6.HorizontalAlignment = Element.ALIGN_LEFT;
                    A6.Border = iTextSharp.text.Rectangle.BOX;
                    PAYTable.AddCell(A6);

                    PdfPCell A7 = new PdfPCell(new Phrase(Get_Vendor_Desc(Enty.Vendor), TableFont));
                    A7.HorizontalAlignment = Element.ALIGN_LEFT;
                    A7.Border = iTextSharp.text.Rectangle.BOX;
                    PAYTable.AddCell(A7);

                    PdfPCell A8 = new PdfPCell(new Phrase(Invoice_Exists ? Enty.Amount_Dol : " ", TableFont));
                    A8.HorizontalAlignment = Element.ALIGN_LEFT;
                    A8.Border = iTextSharp.text.Rectangle.BOX;
                    PAYTable.AddCell(A8);
                    //rowIndex = Payments_Grid.Rows.Add(Enty.Authr_Number, Authr_Date, ((Enty.BS == "1" || Enty.BS == "Y") ? "Yes" : "No"), Authr_Amount.ToString(), Get_HeatingSource_Desc(Enty.Payment_For), Enty.Authr_Caseworker, Get_Vendor_Desc(Enty.Vendor), Invoice_Exists ? Img_Tick : Img_Blank, Invoice_Exists ? Enty.Amount_Dol : " ", Invc_SW, Enty.MOR_Differential, Enty.Payment_For, Enty.Batch_NO, (Alloc_Short_Fall ? "Y" : "N"), Bundle_SW, Check_SW, Enty.SDWDC);
                }

                document.Add(PAYTable);

            }

            document.Close();
            fs.Close();
            fs.Dispose();
        }


        //private void EMSRESPdf(Document document)
        //{
        //    BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
        //    iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
        //    BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
        //    iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(1, 9, 4);
        //    BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

        //    iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
        //    iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
        //    iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
        //    iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(1, 9, 1);
        //    iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
        //    iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);

        //    PdfPTable EMSRESTable = new PdfPTable(7);
        //    EMSRESTable.TotalWidth = 550f;
        //    EMSRESTable.WidthPercentage = 100;
        //    EMSRESTable.LockedWidth = true;
        //    float[] widths2 = new float[] { 25f, 35f, 40f, 20f, 18f, 18f,25f };
        //    EMSRESTable.SetWidths(widths2);
        //    EMSRESTable.HorizontalAlignment = Element.ALIGN_CENTER;
        //    //EMSRESTable.HeaderRows = 2;

        //    string ProgramName = string.Empty;
        //    if (programEntity != null)
        //        ProgramName = programEntity.AgencyName;

        //    PdfPCell H1 = new PdfPCell(new Phrase("Hierarchy:" + CASEMSTList[0].ApplAgency + "-" + CASEMSTList[0].ApplDept + "-" + CASEMSTList[0].ApplProgram + " " + CASEMSTList[0].ApplYr + "  " + ProgramName, TblFontBold));
        //    H1.HorizontalAlignment = Element.ALIGN_LEFT;
        //    H1.Colspan = 3;
        //    H1.FixedHeight = 15f;
        //    H1.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    EMSRESTable.AddCell(H1);

        //    PdfPCell H2 = new PdfPCell(new Phrase("App:" + CASEMSTList[0].ApplNo + "  " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), TblFontBold));
        //    H2.HorizontalAlignment = Element.ALIGN_RIGHT;
        //    H2.Colspan = 4;
        //    H2.FixedHeight = 15f;
        //    H2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    EMSRESTable.AddCell(H2);

        //    PdfPCell S2 = new PdfPCell(new Phrase("", TblFontBold));
        //    S2.HorizontalAlignment = Element.ALIGN_CENTER;
        //    S2.Colspan = 7;
        //    S2.FixedHeight = 15f;
        //    S2.Border = iTextSharp.text.Rectangle.NO_BORDER;
        //    EMSRESTable.AddCell(S2);

        //    PdfPCell Header = new PdfPCell(new Phrase("Emergency Services Resources", TblFontBold));
        //    Header.HorizontalAlignment = Element.ALIGN_CENTER;
        //    Header.Colspan = 7;
        //    Header.FixedHeight = 15f;
        //    Header.Border = iTextSharp.text.Rectangle.BOX;
        //    EMSRESTable.AddCell(Header);

        //    string[] HeaderSeq = { "Worker", "Fund Source", "Date Range", "Date", "Amount", "Balance","Status" };
        //    for (int i = 0; i < HeaderSeq.Length; ++i)
        //    {
        //        PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
        //        cell.HorizontalAlignment = Element.ALIGN_CENTER;
        //        //cell.FixedHeight = 15f;
        //        cell.Border = iTextSharp.text.Rectangle.BOX;
        //        EMSRESTable.AddCell(cell);
        //    }
        //    bool first = false;
        //    foreach (EMSRESEntity resdetails in EMSRESList)
        //    {
        //        if (first)
        //        {
        //            PdfPCell S1 = new PdfPCell(new Phrase("", TblFontBold));
        //            S1.HorizontalAlignment = Element.ALIGN_CENTER;
        //            S1.Colspan = 7;
        //            S1.FixedHeight = 15f;
        //            S1.Border = iTextSharp.text.Rectangle.TOP_BORDER + iTextSharp.text.Rectangle.BOTTOM_BORDER;
        //            EMSRESTable.AddCell(S1);

        //            PdfPCell Header2 = new PdfPCell(new Phrase("Emergency Services Resources", TblFontBold));
        //            Header2.HorizontalAlignment = Element.ALIGN_CENTER;
        //            Header2.Colspan = 7;
        //            Header2.FixedHeight = 15f;
        //            Header2.Border = iTextSharp.text.Rectangle.BOX;
        //            EMSRESTable.AddCell(Header2);

        //            string[] HeaderSeq3 = { "Worker", "Fund Source", "Date Range", "Date", "Amount", "Balance", "Status" };
        //            for (int i = 0; i < HeaderSeq3.Length; ++i)
        //            {
        //                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq3[i], TblFontBold));
        //                cell.HorizontalAlignment = Element.ALIGN_CENTER;
        //                //cell.FixedHeight = 15f;
        //                cell.Border = iTextSharp.text.Rectangle.BOX;
        //                EMSRESTable.AddCell(cell);
        //            }
        //        }

        //        resdetails.EMS_Balance = "0.00";
        //        resdetails.EMS_AdultFlag = "N";
        //        if (propfundingsource.Count > 0)
        //        {
        //            CommonEntity commonfunddesc = propfundingsource.Find(u => u.Code == resdetails.EMSRES_FUND);
        //            if (commonfunddesc != null)
        //            {
        //                resdetails.EMS_FundDesc = commonfunddesc.Desc.ToString();
        //                if (commonfunddesc.Extension != "N")
        //                {
        //                    EMSBDCEntity emsbdcentity = propEmsbdc_List.Find(u => u.BDC_FUND == resdetails.EMSRES_FUND && (Convert.ToDateTime(u.BDC_START) <= Convert.ToDateTime(resdetails.EMSRES_DATE) && Convert.ToDateTime(u.BDC_END) >= Convert.ToDateTime(resdetails.EMSRES_DATE)));
        //                    if (emsbdcentity != null)
        //                    {
        //                        resdetails.EMS_DateRange = LookupDataAccess.Getdate(emsbdcentity.BDC_START) + "  " + LookupDataAccess.Getdate(emsbdcentity.BDC_END);
        //                        resdetails.EMS_Balance = emsbdcentity.BDC_BALANCE;
        //                        resdetails.EMS_AdultFlag = emsbdcentity.BDC_AUDIT_FLAG.ToUpper();
        //                        resdetails.EMS_AllowPosting = emsbdcentity.BDC_ALLOW_POSTING.ToUpper();
        //                        resdetails.EMS_Cost_Center = emsbdcentity.BDC_COST_CENTER;
        //                        resdetails.EMS_GL_Account = emsbdcentity.BDC_GL_ACCOUNT;
        //                        resdetails.EMS_Budget_year = emsbdcentity.BDC_BUDGET_YEAR;
        //                        resdetails.EMS_Budget = emsbdcentity.BDC_BUDGET;
        //                        resdetails.EMS_Start = emsbdcentity.BDC_START;
        //                        resdetails.EMS_End = emsbdcentity.BDC_END;
        //                        resdetails.EMS_BDC_DATELSTC = emsbdcentity.BDC_DATE_LSTC;
        //                        resdetails.EMS_BdcIntOrder = emsbdcentity.BDC_INT_ORDER;
        //                        resdetails.EMS_AccountType = emsbdcentity.BDC_ACCOUNT_TYPE;

        //                    }

        //                }
        //                else
        //                {
        //                    resdetails.EMS_NonBudget = commonfunddesc.Code;
        //                }
        //            }
        //        }
        //        if (resdetails.EMSRES_AMOUNT == string.Empty)
        //        {
        //            resdetails.EMS_Balance = "0.00";
        //        }
        //        else
        //        {
        //            resdetails.EMS_Balance = resdetails.EMSRES_AMOUNT;
        //        }

        //        List<EMSCLAPMAEntity> emsclapmalist = propEMSCLAPMAList.FindAll(u => u.CLA_RES_FUND == resdetails.EMSRES_FUND && u.CLA_RES_SEQ == resdetails.EMSRES_SEQ && Convert.ToDateTime(u.CLA_RES_DATE) == Convert.ToDateTime(resdetails.EMSRES_DATE) && ((u.RES_O_AMOUNT != u.RES_N_AMOUNT) || (u.RES_O_CASEWORKER != u.RES_N_CASEWORKER)));

        //        if (emsclapmalist.Count > 0)
        //            resdetails.EMS_Status = "*";

        //        if (resdetails.EMSRES_NPDATE != string.Empty)
        //        {
        //            resdetails.EMS_Post = "Nopost";
        //            resdetails.EMS_Balance = "0.00";
        //        }
        //        else
        //        {
        //            List<EMSCLCPMCEntity> emsclcpmclist = EMSCLCList.FindAll(u => u.CLC_RES_FUND == resdetails.EMSRES_FUND && u.CLC_RES_SEQ == resdetails.EMSRES_SEQ && Convert.ToDateTime(u.CLC_RES_DATE).Date == Convert.ToDateTime(resdetails.EMSRES_DATE).Date);
        //            if (emsclcpmclist.Count > 0)
        //            {
        //                decimal decamount = emsclcpmclist.Sum(u => Convert.ToDecimal(u.PMC_AMOUNT));
        //                decamount = Convert.ToDecimal(resdetails.EMS_Balance) - decamount;
        //                resdetails.EMS_Balance = decamount.ToString();
        //            }
        //        }

        //        PdfPCell A1 = new PdfPCell(new Phrase(Get_CaseWorker_DESC(resdetails.EMSRES_CASEWORKER.Trim()), TableFont));
        //        A1.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A1.Border = iTextSharp.text.Rectangle.BOX;
        //        EMSRESTable.AddCell(A1);

        //        PdfPCell A2 = new PdfPCell(new Phrase(resdetails.EMS_FundDesc, TableFont));
        //        A2.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A2.Border = iTextSharp.text.Rectangle.BOX;
        //        EMSRESTable.AddCell(A2);

        //        PdfPCell A3 = new PdfPCell(new Phrase(resdetails.EMS_DateRange, TableFont));
        //        A3.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A3.Border = iTextSharp.text.Rectangle.BOX;
        //        EMSRESTable.AddCell(A3);

        //        PdfPCell A4 = new PdfPCell(new Phrase(LookupDataAccess.Getdate(resdetails.EMSRES_DATE.Trim()), TableFont));
        //        A4.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A4.Border = iTextSharp.text.Rectangle.BOX;
        //        EMSRESTable.AddCell(A4);

        //        PdfPCell A5 = new PdfPCell(new Phrase(resdetails.EMSRES_AMOUNT, TableFont));
        //        A5.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A5.Border = iTextSharp.text.Rectangle.BOX;
        //        EMSRESTable.AddCell(A5);

        //        PdfPCell A6 = new PdfPCell(new Phrase(resdetails.EMS_Balance, TableFont));
        //        A6.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A6.Border = iTextSharp.text.Rectangle.BOX;
        //        EMSRESTable.AddCell(A6);

        //        PdfPCell A7 = new PdfPCell(new Phrase(resdetails.EMS_Post, TableFont));
        //        A7.HorizontalAlignment = Element.ALIGN_LEFT;
        //        A7.Border = iTextSharp.text.Rectangle.BOX;
        //        EMSRESTable.AddCell(A7);

        //        if (EMSRESTable.Rows.Count > 0)
        //        {
        //            document.Add(EMSRESTable);
        //            EMSRESTable.DeleteBodyRows();
        //        }
        //        if (EMSCLCList.Count > 0)
        //        {
        //            List<EMSCLCPMCEntity> SelClcList = EMSCLCList.FindAll(u => u.CLC_RES_FUND == resdetails.EMSRES_FUND && u.CLC_RES_SEQ == resdetails.EMSRES_SEQ && Convert.ToDateTime(u.CLC_RES_DATE).Date == Convert.ToDateTime(resdetails.EMSRES_DATE).Date);
        //            if (SelClcList.Count > 0)
        //            {
        //                PdfPTable EMSCLCTable = new PdfPTable(6);
        //                EMSCLCTable.TotalWidth = 550f;
        //                EMSCLCTable.WidthPercentage = 100;
        //                EMSCLCTable.LockedWidth = true;
        //                float[] widths = new float[] { 25f, 40f, 20f, 20f, 20f, 25f };
        //                EMSCLCTable.SetWidths(widths);
        //                EMSCLCTable.HorizontalAlignment = Element.ALIGN_CENTER;

        //                PdfPCell Header1 = new PdfPCell(new Phrase("Emergency Services Invoices", TblFontBold));
        //                Header1.HorizontalAlignment = Element.ALIGN_LEFT;
        //                Header1.Colspan = 7;
        //                Header1.FixedHeight = 15f;
        //                Header1.Border = iTextSharp.text.Rectangle.BOX;
        //                EMSCLCTable.AddCell(Header1);

        //                string[] HeaderSeq1 = { "Worker", "Service", "Type", "Amount", "Date", "Worker" };
        //                for (int i = 0; i < HeaderSeq1.Length; ++i)
        //                {
        //                    PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq1[i], TblFontBold));
        //                    cell.HorizontalAlignment = Element.ALIGN_CENTER;
        //                    //cell.FixedHeight = 15f;
        //                    cell.Border = iTextSharp.text.Rectangle.BOX;
        //                    EMSCLCTable.AddCell(cell);
        //                }


        //                string strCamsdesc = string.Empty;
        //                string strPType = string.Empty;
        //                string strInvamt = string.Empty;
        //                string strInvDt = string.Empty;
        //                string strInvwkr = string.Empty;
        //                string strAdjust = string.Empty;

        //                foreach (EMSCLCPMCEntity item in SelClcList)
        //                {
        //                    strAdjust = string.Empty;
        //                    strCamsdesc = string.Empty;
        //                    strPType = string.Empty;
        //                    strInvamt = string.Empty;
        //                    strInvDt = string.Empty;
        //                    strInvwkr = string.Empty;
        //                    //List<EMSCLAPMAEntity> emsclapmalist = propEMSCLAPMAList.FindAll(u => u.CLA_RES_FUND == item.CLC_RES_FUND && u.CLA_RES_SEQ == item.CLC_RES_SEQ && u.CLA_CLC_SEQ == item.CLC_SEQ && Convert.ToDateTime(u.CLA_RES_DATE) == Convert.ToDateTime(emsResentity.EMSRES_DATE));
        //                    if (emsclapmalist.Count > 0)
        //                        strAdjust = "*";
        //                    if (item.PMC_TYPE.ToUpper().Equals("I"))
        //                    {
        //                        strPType = "Invoice";
        //                        strInvamt = item.PMC_INV_AMT.ToString();
        //                        strInvDt = LookupDataAccess.Getdate(item.PMC_INV_DATE);
        //                        strInvwkr = item.PMC_INV_WORKER;

        //                        // newly added 08/11/2015
        //                        if (item.PMC_INV_AMT.ToString().Trim() == string.Empty)
        //                        {
        //                            strInvamt = string.Empty;
        //                            strInvDt = string.Empty;
        //                            strInvwkr = string.Empty;
        //                        }

        //                    }
        //                    else if (item.PMC_TYPE.ToUpper().Equals("A"))
        //                    {
        //                        strPType = "Authorization";
        //                        strInvamt = item.PMC_AUTH_AMT.ToString();
        //                        strInvDt = LookupDataAccess.Getdate(item.PMC_AUTH_DATE);
        //                        strInvwkr = item.PMC_AUTH_WORKER;

        //                        // newly added 08/11/2015
        //                        if (item.PMC_AUTH_AMT.ToString().Trim() == string.Empty && item.PMC_AUTH_LIQUIDATE.ToString() != "Y")
        //                        {
        //                            strInvamt = string.Empty;
        //                            strInvDt = string.Empty;
        //                            strInvwkr = string.Empty;
        //                        }
        //                    }


        //                    if (CAMASTList.Count > 0)
        //                    {
        //                        CAMASTEntity camastentity = CAMASTList.Find(u => u.Code == item.CLC_S_SERVICE_CODE);
        //                        if (camastentity != null)
        //                            strCamsdesc = camastentity.Desc;
        //                    }
        //                    //emsResentity.EMSRES_CASEWORKER

        //                    PdfPCell B1 = new PdfPCell(new Phrase(Get_CaseWorker_DESC(item.CLC_S_CASEWORKER), TableFont));
        //                    B1.HorizontalAlignment = Element.ALIGN_LEFT;
        //                    B1.Border = iTextSharp.text.Rectangle.BOX;
        //                    EMSCLCTable.AddCell(B1);

        //                    PdfPCell B2 = new PdfPCell(new Phrase(strCamsdesc, TableFont));
        //                    B2.HorizontalAlignment = Element.ALIGN_LEFT;
        //                    B2.Border = iTextSharp.text.Rectangle.BOX;
        //                    EMSCLCTable.AddCell(B2);

        //                    PdfPCell B3 = new PdfPCell(new Phrase(strPType, TableFont));
        //                    B3.HorizontalAlignment = Element.ALIGN_LEFT;
        //                    B3.Border = iTextSharp.text.Rectangle.BOX;
        //                    EMSCLCTable.AddCell(B3);

        //                    PdfPCell B4 = new PdfPCell(new Phrase(strInvamt, TableFont));
        //                    B4.HorizontalAlignment = Element.ALIGN_LEFT;
        //                    B4.Border = iTextSharp.text.Rectangle.BOX;
        //                    EMSCLCTable.AddCell(B4);

        //                    PdfPCell B5 = new PdfPCell(new Phrase(strInvDt, TableFont));
        //                    B5.HorizontalAlignment = Element.ALIGN_LEFT;
        //                    B5.Border = iTextSharp.text.Rectangle.BOX;
        //                    EMSCLCTable.AddCell(B5);

        //                    PdfPCell B6 = new PdfPCell(new Phrase(Get_CaseWorker_DESC(strInvwkr), TableFont));
        //                    B6.HorizontalAlignment = Element.ALIGN_LEFT;
        //                    B6.Border = iTextSharp.text.Rectangle.BOX;
        //                    EMSCLCTable.AddCell(B6);
        //                }
        //                document.Add(EMSCLCTable);
        //                first = true;
        //            }
        //            //else first = false;

        //        }
        //    }

        //}

        private void EMSRESPdf()
        {
            Random_Filename = null;

            PdfName = "E" + BaseForm.BaseApplicationNo.ToString();//form.GetFileName();
            PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
            try
            {
                if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
            }
            catch (Exception ex)
            {
                CommonFunctions.MessageBoxDisplay("Error");
            }


            try
            {
                string Tmpstr = PdfName + ".pdf";
                if (File.Exists(Tmpstr))
                    File.Delete(Tmpstr);
            }
            catch (Exception ex)
            {
                int length = 8;
                string newFileName = System.Guid.NewGuid().ToString();
                newFileName = newFileName.Replace("-", string.Empty);

                Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
            }

            if (!string.IsNullOrEmpty(Random_Filename))
                PdfName = Random_Filename;
            else
                PdfName += ".pdf";

            FileStream fs = new FileStream(PdfName, FileMode.Create);

            Document document = new Document(PageSize.A4, 25, 25, 30, 30);
            PdfWriter writer = PdfWriter.GetInstance(document, fs);
            document.Open();

            cb = writer.DirectContent;

            BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
            iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
            BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
            iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(bf_times, 9, 4);
            BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

            iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 9);
            iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
            iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
            iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(bf_times, 9, 1);
            iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
            iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);

            PdfPTable EMSRESTable = new PdfPTable(7);
            EMSRESTable.TotalWidth = 550f;
            EMSRESTable.WidthPercentage = 100;
            EMSRESTable.LockedWidth = true;
            float[] widths2 = new float[] { 25f, 35f, 40f, 20f, 18f, 18f, 25f };
            EMSRESTable.SetWidths(widths2);
            EMSRESTable.HorizontalAlignment = Element.ALIGN_CENTER;
            //EMSRESTable.HeaderRows = 2;

            string ProgramName = string.Empty;
            if (programEntity != null)
                ProgramName = programEntity.HirarchyName;

            PdfPCell H1 = new PdfPCell(new Phrase("Hierarchy:" + CASEMSTList[0].ApplAgency + "-" + CASEMSTList[0].ApplDept + "-" + CASEMSTList[0].ApplProgram + " " + CASEMSTList[0].ApplYr + "  " + ProgramName, TblFontBold));
            H1.HorizontalAlignment = Element.ALIGN_LEFT;
            H1.Colspan = 3;
            H1.FixedHeight = 15f;
            H1.Border = iTextSharp.text.Rectangle.NO_BORDER;
            EMSRESTable.AddCell(H1);

            PdfPCell H2 = new PdfPCell(new Phrase("App:" + CASEMSTList[0].ApplNo + "  " + LookupDataAccess.GetMemberName(SelSnp.NameixFi, SelSnp.NameixMi, SelSnp.NameixLast, BaseForm.BaseHierarchyCnFormat.ToString()), TblFontBold));
            H2.HorizontalAlignment = Element.ALIGN_RIGHT;
            H2.Colspan = 4;
            H2.FixedHeight = 15f;
            H2.Border = iTextSharp.text.Rectangle.NO_BORDER;
            EMSRESTable.AddCell(H2);

            PdfPCell S2 = new PdfPCell(new Phrase("", TblFontBold));
            S2.HorizontalAlignment = Element.ALIGN_CENTER;
            S2.Colspan = 7;
            S2.FixedHeight = 15f;
            S2.Border = iTextSharp.text.Rectangle.NO_BORDER;
            EMSRESTable.AddCell(S2);

            PdfPCell Header = new PdfPCell(new Phrase("Emergency Services Resources", TblFontBold));
            Header.HorizontalAlignment = Element.ALIGN_CENTER;
            Header.Colspan = 7;
            Header.FixedHeight = 15f;
            Header.Border = iTextSharp.text.Rectangle.BOX;
            EMSRESTable.AddCell(Header);

            string[] HeaderSeq = { "Worker", "Fund Source", "Date Range", "Date", "Amount", "Balance", "Status" };
            for (int i = 0; i < HeaderSeq.Length; ++i)
            {
                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                //cell.FixedHeight = 15f;
                cell.Border = iTextSharp.text.Rectangle.BOX;
                EMSRESTable.AddCell(cell);
            }
            bool first = false;
            foreach (EMSRESEntity resdetails in EMSRESList)
            {
                if (first)
                {
                    PdfPCell S1 = new PdfPCell(new Phrase("", TblFontBold));
                    S1.HorizontalAlignment = Element.ALIGN_CENTER;
                    S1.Colspan = 7;
                    S1.FixedHeight = 15f;
                    S1.Border = iTextSharp.text.Rectangle.TOP_BORDER + iTextSharp.text.Rectangle.BOTTOM_BORDER;
                    EMSRESTable.AddCell(S1);

                    PdfPCell Header2 = new PdfPCell(new Phrase("Emergency Services Resources", TblFontBold));
                    Header2.HorizontalAlignment = Element.ALIGN_CENTER;
                    Header2.Colspan = 7;
                    Header2.FixedHeight = 15f;
                    Header2.Border = iTextSharp.text.Rectangle.BOX;
                    EMSRESTable.AddCell(Header2);

                    string[] HeaderSeq3 = { "Worker", "Fund Source", "Date Range", "Date", "Amount", "Balance", "Status" };
                    for (int i = 0; i < HeaderSeq3.Length; ++i)
                    {
                        PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq3[i], TblFontBold));
                        cell.HorizontalAlignment = Element.ALIGN_CENTER;
                        //cell.FixedHeight = 15f;
                        cell.Border = iTextSharp.text.Rectangle.BOX;
                        EMSRESTable.AddCell(cell);
                    }
                }

                resdetails.EMS_Balance = "0.00";
                resdetails.EMS_AdultFlag = "N";
                if (propfundingsource.Count > 0)
                {
                    CommonEntity commonfunddesc = propfundingsource.Find(u => u.Code == resdetails.EMSRES_FUND);
                    if (commonfunddesc != null)
                    {
                        resdetails.EMS_FundDesc = commonfunddesc.Desc.ToString();
                        if (commonfunddesc.Extension != "N")
                        {
                            EMSBDCEntity emsbdcentity = propEmsbdc_List.Find(u => u.BDC_FUND == resdetails.EMSRES_FUND && (Convert.ToDateTime(u.BDC_START) <= Convert.ToDateTime(resdetails.EMSRES_DATE) && Convert.ToDateTime(u.BDC_END) >= Convert.ToDateTime(resdetails.EMSRES_DATE)));
                            if (emsbdcentity != null)
                            {
                                resdetails.EMS_DateRange = LookupDataAccess.Getdate(emsbdcentity.BDC_START) + "  " + LookupDataAccess.Getdate(emsbdcentity.BDC_END);
                                resdetails.EMS_Balance = emsbdcentity.BDC_BALANCE;
                                resdetails.EMS_AdultFlag = emsbdcentity.BDC_AUDIT_FLAG.ToUpper();
                                resdetails.EMS_AllowPosting = emsbdcentity.BDC_ALLOW_POSTING.ToUpper();
                                resdetails.EMS_Cost_Center = emsbdcentity.BDC_COST_CENTER;
                                resdetails.EMS_GL_Account = emsbdcentity.BDC_GL_ACCOUNT;
                                resdetails.EMS_Budget_year = emsbdcentity.BDC_BUDGET_YEAR;
                                resdetails.EMS_Budget = emsbdcentity.BDC_BUDGET;
                                resdetails.EMS_Start = emsbdcentity.BDC_START;
                                resdetails.EMS_End = emsbdcentity.BDC_END;
                                resdetails.EMS_BDC_DATELSTC = emsbdcentity.BDC_DATE_LSTC;
                                resdetails.EMS_BdcIntOrder = emsbdcentity.BDC_INT_ORDER;
                                resdetails.EMS_AccountType = emsbdcentity.BDC_ACCOUNT_TYPE;

                            }

                        }
                        else
                        {
                            resdetails.EMS_NonBudget = commonfunddesc.Code;
                        }
                    }
                }
                if (resdetails.EMSRES_AMOUNT == string.Empty)
                {
                    resdetails.EMS_Balance = "0.00";
                }
                else
                {
                    resdetails.EMS_Balance = resdetails.EMSRES_AMOUNT;
                }

                List<EMSCLAPMAEntity> emsclapmalist = propEMSCLAPMAList.FindAll(u => u.CLA_RES_FUND == resdetails.EMSRES_FUND && u.CLA_RES_SEQ == resdetails.EMSRES_SEQ && Convert.ToDateTime(u.CLA_RES_DATE) == Convert.ToDateTime(resdetails.EMSRES_DATE) && ((u.RES_O_AMOUNT != u.RES_N_AMOUNT) || (u.RES_O_CASEWORKER != u.RES_N_CASEWORKER)));

                if (emsclapmalist.Count > 0)
                    resdetails.EMS_Status = "*";

                if (resdetails.EMSRES_NPDATE != string.Empty)
                {
                    resdetails.EMS_Post = "Nopost";
                    resdetails.EMS_Balance = "0.00";
                }
                else
                {
                    List<EMSCLCPMCEntity> emsclcpmclist = EMSCLCList.FindAll(u => u.CLC_RES_FUND == resdetails.EMSRES_FUND && u.CLC_RES_SEQ == resdetails.EMSRES_SEQ && Convert.ToDateTime(u.CLC_RES_DATE).Date == Convert.ToDateTime(resdetails.EMSRES_DATE).Date);
                    if (emsclcpmclist.Count > 0)
                    {
                        decimal decamount = emsclcpmclist.Sum(u => Convert.ToDecimal(u.PMC_AMOUNT));
                        decamount = Convert.ToDecimal(resdetails.EMS_Balance) - decamount;
                        resdetails.EMS_Balance = decamount.ToString();
                    }
                }

                PdfPCell A1 = new PdfPCell(new Phrase(Get_CaseWorker_DESC(resdetails.EMSRES_CASEWORKER.Trim()), TableFont));
                A1.HorizontalAlignment = Element.ALIGN_LEFT;
                A1.Border = iTextSharp.text.Rectangle.BOX;
                EMSRESTable.AddCell(A1);

                PdfPCell A2 = new PdfPCell(new Phrase(resdetails.EMS_FundDesc, TableFont));
                A2.HorizontalAlignment = Element.ALIGN_LEFT;
                A2.Border = iTextSharp.text.Rectangle.BOX;
                EMSRESTable.AddCell(A2);

                PdfPCell A3 = new PdfPCell(new Phrase(resdetails.EMS_DateRange, TableFont));
                A3.HorizontalAlignment = Element.ALIGN_LEFT;
                A3.Border = iTextSharp.text.Rectangle.BOX;
                EMSRESTable.AddCell(A3);

                PdfPCell A4 = new PdfPCell(new Phrase(LookupDataAccess.Getdate(resdetails.EMSRES_DATE.Trim()), TableFont));
                A4.HorizontalAlignment = Element.ALIGN_LEFT;
                A4.Border = iTextSharp.text.Rectangle.BOX;
                EMSRESTable.AddCell(A4);

                PdfPCell A5 = new PdfPCell(new Phrase(resdetails.EMSRES_AMOUNT, TableFont));
                A5.HorizontalAlignment = Element.ALIGN_LEFT;
                A5.Border = iTextSharp.text.Rectangle.BOX;
                EMSRESTable.AddCell(A5);

                PdfPCell A6 = new PdfPCell(new Phrase(resdetails.EMS_Balance, TableFont));
                A6.HorizontalAlignment = Element.ALIGN_LEFT;
                A6.Border = iTextSharp.text.Rectangle.BOX;
                EMSRESTable.AddCell(A6);

                PdfPCell A7 = new PdfPCell(new Phrase(resdetails.EMS_Post, TableFont));
                A7.HorizontalAlignment = Element.ALIGN_LEFT;
                A7.Border = iTextSharp.text.Rectangle.BOX;
                EMSRESTable.AddCell(A7);

                if (EMSRESTable.Rows.Count > 0)
                {
                    document.Add(EMSRESTable);
                    EMSRESTable.DeleteBodyRows();
                }
                if (EMSCLCList.Count > 0)
                {
                    List<EMSCLCPMCEntity> SelClcList = EMSCLCList.FindAll(u => u.CLC_RES_FUND == resdetails.EMSRES_FUND && u.CLC_RES_SEQ == resdetails.EMSRES_SEQ && Convert.ToDateTime(u.CLC_RES_DATE).Date == Convert.ToDateTime(resdetails.EMSRES_DATE).Date);
                    if (SelClcList.Count > 0)
                    {
                        PdfPTable EMSCLCTable = new PdfPTable(6);
                        EMSCLCTable.TotalWidth = 550f;
                        EMSCLCTable.WidthPercentage = 100;
                        EMSCLCTable.LockedWidth = true;
                        float[] widths = new float[] { 25f, 40f, 20f, 20f, 20f, 25f };
                        EMSCLCTable.SetWidths(widths);
                        EMSCLCTable.HorizontalAlignment = Element.ALIGN_CENTER;

                        PdfPCell Header1 = new PdfPCell(new Phrase("Emergency Services Invoices", TblFontBold));
                        Header1.HorizontalAlignment = Element.ALIGN_LEFT;
                        Header1.Colspan = 7;
                        Header1.FixedHeight = 15f;
                        Header1.Border = iTextSharp.text.Rectangle.BOX;
                        EMSCLCTable.AddCell(Header1);

                        string[] HeaderSeq1 = { "Worker", "Service", "Type", "Amount", "Date", "Worker" };
                        for (int i = 0; i < HeaderSeq1.Length; ++i)
                        {
                            PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq1[i], TblFontBold));
                            cell.HorizontalAlignment = Element.ALIGN_CENTER;
                            //cell.FixedHeight = 15f;
                            cell.Border = iTextSharp.text.Rectangle.BOX;
                            EMSCLCTable.AddCell(cell);
                        }


                        string strCamsdesc = string.Empty;
                        string strPType = string.Empty;
                        string strInvamt = string.Empty;
                        string strInvDt = string.Empty;
                        string strInvwkr = string.Empty;
                        string strAdjust = string.Empty;

                        foreach (EMSCLCPMCEntity item in SelClcList)
                        {
                            strAdjust = string.Empty;
                            strCamsdesc = string.Empty;
                            strPType = string.Empty;
                            strInvamt = string.Empty;
                            strInvDt = string.Empty;
                            strInvwkr = string.Empty;
                            //List<EMSCLAPMAEntity> emsclapmalist = propEMSCLAPMAList.FindAll(u => u.CLA_RES_FUND == item.CLC_RES_FUND && u.CLA_RES_SEQ == item.CLC_RES_SEQ && u.CLA_CLC_SEQ == item.CLC_SEQ && Convert.ToDateTime(u.CLA_RES_DATE) == Convert.ToDateTime(emsResentity.EMSRES_DATE));
                            if (emsclapmalist.Count > 0)
                                strAdjust = "*";
                            if (item.PMC_TYPE.ToUpper().Equals("I"))
                            {
                                strPType = "Invoice";
                                strInvamt = item.PMC_INV_AMT.ToString();
                                strInvDt = LookupDataAccess.Getdate(item.PMC_INV_DATE);
                                strInvwkr = item.PMC_INV_WORKER;

                                // newly added 08/11/2015
                                if (item.PMC_INV_AMT.ToString().Trim() == string.Empty)
                                {
                                    strInvamt = string.Empty;
                                    strInvDt = string.Empty;
                                    strInvwkr = string.Empty;
                                }

                            }
                            else if (item.PMC_TYPE.ToUpper().Equals("A"))
                            {
                                strPType = "Authorization";
                                strInvamt = item.PMC_AUTH_AMT.ToString();
                                strInvDt = LookupDataAccess.Getdate(item.PMC_AUTH_DATE);
                                strInvwkr = item.PMC_AUTH_WORKER;

                                // newly added 08/11/2015
                                if (item.PMC_AUTH_AMT.ToString().Trim() == string.Empty && item.PMC_AUTH_LIQUIDATE.ToString() != "Y")
                                {
                                    strInvamt = string.Empty;
                                    strInvDt = string.Empty;
                                    strInvwkr = string.Empty;
                                }
                            }


                            if (CAMASTList.Count > 0)
                            {
                                CAMASTEntity camastentity = CAMASTList.Find(u => u.Code == item.CLC_S_SERVICE_CODE);
                                if (camastentity != null)
                                    strCamsdesc = camastentity.Desc;
                            }
                            //emsResentity.EMSRES_CASEWORKER

                            PdfPCell B1 = new PdfPCell(new Phrase(Get_CaseWorker_DESC(item.CLC_S_CASEWORKER), TableFont));
                            B1.HorizontalAlignment = Element.ALIGN_LEFT;
                            B1.Border = iTextSharp.text.Rectangle.BOX;
                            EMSCLCTable.AddCell(B1);

                            PdfPCell B2 = new PdfPCell(new Phrase(strCamsdesc, TableFont));
                            B2.HorizontalAlignment = Element.ALIGN_LEFT;
                            B2.Border = iTextSharp.text.Rectangle.BOX;
                            EMSCLCTable.AddCell(B2);

                            PdfPCell B3 = new PdfPCell(new Phrase(strPType, TableFont));
                            B3.HorizontalAlignment = Element.ALIGN_LEFT;
                            B3.Border = iTextSharp.text.Rectangle.BOX;
                            EMSCLCTable.AddCell(B3);

                            PdfPCell B4 = new PdfPCell(new Phrase(strInvamt, TableFont));
                            B4.HorizontalAlignment = Element.ALIGN_LEFT;
                            B4.Border = iTextSharp.text.Rectangle.BOX;
                            EMSCLCTable.AddCell(B4);

                            PdfPCell B5 = new PdfPCell(new Phrase(strInvDt, TableFont));
                            B5.HorizontalAlignment = Element.ALIGN_LEFT;
                            B5.Border = iTextSharp.text.Rectangle.BOX;
                            EMSCLCTable.AddCell(B5);

                            PdfPCell B6 = new PdfPCell(new Phrase(Get_CaseWorker_DESC(strInvwkr), TableFont));
                            B6.HorizontalAlignment = Element.ALIGN_LEFT;
                            B6.Border = iTextSharp.text.Rectangle.BOX;
                            EMSCLCTable.AddCell(B6);
                        }
                        document.Add(EMSCLCTable);
                        first = true;
                    }
                    //else first = false;

                }
            }

            document.Close();
            fs.Close();
            fs.Dispose();

        }

        List<HierarchyEntity> SP_Programs_List = new List<HierarchyEntity>();
        private string Set_SP_Program_Text(string Prog_Code)
        {
            string Tmp_Hierarchy = "";
            string Sel_CAMS_Program = "";

            foreach (HierarchyEntity Ent in SP_Programs_List)
            {
                Tmp_Hierarchy = Ent.Agency.Trim() + Ent.Dept.Trim() + Ent.Prog.Trim();
                if (Prog_Code == Tmp_Hierarchy)
                {
                    //Sel_CAMS_Program = Tmp_Hierarchy + " - " + Ent.HirarchyName.Trim();
                    Sel_CAMS_Program = Ent.HirarchyName.Trim();
                    break;
                }
            }

            return Sel_CAMS_Program;
        }

        List<Captain.Common.Utilities.ListItem> CaseWorker_List = new List<Captain.Common.Utilities.ListItem>();
        private void Fill_CaseWorker(string AGY, string Dept, string Prog, string Year)
        {
            CaseWorker_List.Clear();
            //string AGY = GvwAppHou.CurrentRow.Cells["Grd_Agy"].Value.ToString();
            //string Dept = GvwAppHou.CurrentRow.Cells["Grd_Dept"].Value.ToString();
            //string Prog = GvwAppHou.CurrentRow.Cells["Grd_Prog"].Value.ToString();
            //string Year = GvwAppHou.CurrentRow.Cells["Grd_Year"].Value.ToString();
            //string App = GvwAppHou.CurrentRow.Cells["Grd_App"].Value.ToString();
            //DataSet ds2 = Captain.DatabaseLayer.AgyTab.GetHierarchyNames(MainMenuAgency, MainMenuDept, MainMenuProgram);
            DataSet ds2 = Captain.DatabaseLayer.AgyTab.GetHierarchyNames(AGY, "**", "**");
            string strNameFormat = null, strCwFormat = null;
            if (ds2.Tables[0].Rows.Count > 0)
            {
                strNameFormat = ds2.Tables[0].Rows[0]["HIE_CN_FORMAT"].ToString();
                strCwFormat = ds2.Tables[0].Rows[0]["HIE_CW_FORMAT"].ToString();
            }

            DataSet ds1 = Captain.DatabaseLayer.CaseMst.GetCaseWorker(strCwFormat, AGY, Dept, Prog);
            if (ds1.Tables.Count > 0)
            {
                DataTable dt1 = ds1.Tables[0];
                if (dt1.Rows.Count > 0)
                {
                    foreach (DataRow dr in dt1.Rows)
                        CaseWorker_List.Add(new Captain.Common.Utilities.ListItem(dr["NAME"].ToString().Trim(), dr["PWH_CASEWORKER"].ToString().Trim()));
                }
            }
        }

        private string Get_CaseWorker_DESC(string Worker_Code)
        {
            string DESC = null;
            foreach (Captain.Common.Utilities.ListItem List in CaseWorker_List)
            {
                if (List.Value.ToString().Trim() == Worker_Code.Trim())
                {
                    DESC = List.Text; break;
                }
            }

            return DESC;
        }

        List<CommonEntity> LanguagesList = new List<CommonEntity>();
        private void Fill_Languages_List()
        {
            LanguagesList = _model.lookupDataAccess.GetPrimaryLanguage();
        }

        private string Get_Language_Desc(string LAng_Code)
        {
            string Lang_Desc = null;
            foreach (CommonEntity Entity in LanguagesList)
            {
                if (Entity.Code == LAng_Code)
                {
                    Lang_Desc = Entity.Desc; break;
                }
            }

            return Lang_Desc;
        }

        List<CAMASTEntity> CAMASTList = new List<CAMASTEntity>();
        private void Fill_CAMAST_List()
        {
            CAMASTList = _model.SPAdminData.Browse_CAMAST(null, null, null, null);
        }

        private string Get_CA_Desc(string CACode)
        {
            string CA_Desc = null;
            foreach (CAMASTEntity Entity in CAMASTList)
            {
                if (Entity.Code == CACode)
                {
                    CA_Desc = Entity.Desc; break;
                }
            }

            return CA_Desc;
        }

        List<MSMASTEntity> MSMASTList = new List<MSMASTEntity>();
        private void Fill_MSMAST_List()
        {
            MSMASTList = _model.SPAdminData.Browse_MSMAST(null, null, null, null, null);
        }

        private string Get_MS_Desc(string MSCode)
        {
            string MS_Desc = null;
            foreach (MSMASTEntity Entity in MSMASTList)
            {
                if (Entity.Code == MSCode)
                {
                    MS_Desc = Entity.Desc; break;
                }
            }

            return MS_Desc;
        }



        List<CommonEntity> Heating_List = new List<CommonEntity>();
        private string Get_HeatingSource_Desc(string Heating_Source)
        {
            string Heating_Source_Desc = string.Empty;
            foreach (CommonEntity List in Heating_List)
            {
                if (List.Code == Heating_Source)
                {
                    Heating_Source_Desc = List.Desc;
                    break;
                }
            }
            return Heating_Source_Desc;
        }

        List<CASEVDDEntity> Vendor_Brose_List = new List<CASEVDDEntity>();
        private void Get_Vendor_Brose_List()
        {
            CASEVDDEntity Search_Entity = new CASEVDDEntity(true);
            Vendor_Brose_List = _model.SPAdminData.Browse_CASEVDD(Search_Entity, "Browse");

            if (BaseForm.BaseAgencyControlDetails.AgyVendor == "Y")
                Vendor_Brose_List = Vendor_Brose_List.FindAll(u => u.VDD_Agency == BaseForm.BaseAgency);
        }

        private string Get_Vendor_Desc(string Vendor)
        {
            string Vendor_Name = string.Empty;
            foreach (CASEVDDEntity Ent in Vendor_Brose_List)
            {
                if (Ent.Code == Vendor)
                {
                    Vendor_Name = Ent.Name;
                    break;
                }
            }
            return Vendor_Name;
        }

        int Count = 0;
        private void PbPdf_Click(object sender, EventArgs e)
        {
            if (TotalsGrid.Rows.Count > 0)
            {
                string Selection = string.Empty; Count = 0;
                string Selected = string.Empty;
                foreach (DataGridViewRow dr in TotalsGrid.Rows)
                {
                    //if (dr.Cells["Selected"].Value.ToString() == "Y")
                    //{
                    if (chkbAllHier.Checked == false)
                    {
                        if (dr.Cells["Sno"].Value.ToString() == "0" && int.Parse(dr.Cells["Total"].Value.ToString()) > 0)
                        { Selection += "I "; Count += int.Parse(dr.Cells["Total"].Value.ToString()); }
                    }
                    if ((dr.Cells["Sno"].Value.ToString() == "1" || dr.Cells["Sno"].Value.ToString() == "2" || dr.Cells["Sno"].Value.ToString() == "3") && int.Parse(dr.Cells["Total"].Value.ToString()) > 0)
                    { if (!Selection.Contains("S")) { Selection += "S "; } Count += int.Parse(dr.Cells["Total"].Value.ToString()); }
                    if (dr.Cells["Sno"].Value.ToString() == "4" && int.Parse(dr.Cells["Total"].Value.ToString()) > 0)
                    { Selection += "C "; Count += int.Parse(dr.Cells["Total"].Value.ToString()); }
                    if (dr.Cells["Sno"].Value.ToString() == "5" && int.Parse(dr.Cells["Total"].Value.ToString()) > 0)
                    { Selection += "R "; Count += int.Parse(dr.Cells["Total"].Value.ToString()); }
                    if (dr.Cells["Sno"].Value.ToString() == "6" && int.Parse(dr.Cells["Total"].Value.ToString()) > 0)
                    { Selection += "M "; Count += int.Parse(dr.Cells["Total"].Value.ToString()); }
                    if ((dr.Cells["Sno"].Value.ToString() == "7" || dr.Cells["Sno"].Value.ToString() == "8") && int.Parse(dr.Cells["Total"].Value.ToString()) > 0)
                    { if (!Selection.Contains("L")) { Selection += "L "; } Count += int.Parse(dr.Cells["Total"].Value.ToString()); }
                    if ((dr.Cells["Sno"].Value.ToString() == "9" || dr.Cells["Sno"].Value.ToString() == "10") && int.Parse(dr.Cells["Total"].Value.ToString()) > 0)
                    { if (!Selection.Contains("E")) { Selection += "E "; } Count += int.Parse(dr.Cells["Total"].Value.ToString()); }


                    //}
                }
                //if (string.IsNullOrEmpty(Selection.Trim())) Selection = "A";

                if (AllHieSer_Sw == "N")
                {
                    MessageBox.Show("Service Hierarchies Not defined for this User");
                }
                else
                {

                    On_SaveFormClosed(Selection);
                    //if (Selected == "Y")
                    //{
                    MainMenuDeeperTabs Deepertabs = new MainMenuDeeperTabs(BaseForm, GvwAppHou.SelectedRows[0].Cells["Grd_Agy"].Value.ToString(), GvwAppHou.SelectedRows[0].Cells["Grd_Dept"].Value.ToString(), GvwAppHou.SelectedRows[0].Cells["Grd_Prog"].Value.ToString(), GvwAppHou.SelectedRows[0].Cells["Grd_Year"].Value.ToString(), GvwAppHou.SelectedRows[0].Cells["Grd_App"].Value.ToString(), Selection, Count);
                    Deepertabs.FormClosed += new FormClosedEventHandler(On_Delete_PDF_File);
                    Deepertabs.StartPosition = FormStartPosition.CenterScreen;
                    Deepertabs.ShowDialog();
                    //}
                }
            }
        }

        private void TotalsGrid_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            //if (TotalsGrid.Rows.Count > 0)
            //{
            //    if (e.ColumnIndex == 0)
            //    {
            //        if (TotalsGrid.CurrentRow.Cells["Selected"].Value.ToString() == "Y")
            //        {
            //            TotalsGrid.CurrentRow.Cells["Sel_Img"].Value = Img_Blank;
            //            TotalsGrid.CurrentRow.Cells["Selected"].Value = "N";
            //        }
            //        else
            //        {
            //            TotalsGrid.CurrentRow.Cells["Sel_Img"].Value = Img_Tick;
            //            TotalsGrid.CurrentRow.Cells["Selected"].Value = "Y";
            //        }
            //    }
            //}
        }

        private void chkbAllHier_CheckedChanged(object sender, EventArgs e)
        {
            if (chkbAllHier.Checked)
            {
                Captain.Common.Utilities.ListItem listems = propApplication.Find(u => u.Value.ToString() == "05");
                Captain.Common.Utilities.ListItem listEnergyassisteance = propApplication.Find(u => u.Value.ToString() == "08");

                Btn_CaseNotes.Visible = false;
                ClearEntities();

                string Acr_State = "";
                if (propAgencyControlDetails != null)
                    Acr_State = propAgencyControlDetails.State;

                if (ClientTotal != null)
                {
                    if (ClientTotal.Rows.Count > 0)
                    {
                        foreach (DataRow row in ClientTotal.Rows)
                            Client_Tot_List.Add(new Client_InqTotal_entity(row));
                    }
                }
                if (dtCASEMST != null)
                {
                    if (dtCASEMST.Rows.Count > 0)
                    {
                        foreach (DataRow row in dtCASEMST.Rows)
                            CASEMSTList.Add(new CaseMstEntity(row));
                    }
                }
                if (dtCASESNP != null)
                {
                    if (dtCASESNP.Rows.Count > 0)
                    {
                        foreach (DataRow row in dtCASESNP.Rows)
                            casesnpList.Add(new CaseSnpEntity(row));
                    }
                }
                if (dtcasespm != null)
                {
                    if (dtcasespm.Rows.Count > 0)
                    {
                        foreach (DataRow row in dtcasespm.Rows)
                            spmlist.Add(new CASESPMEntity(row));
                    }
                }
                if (dtcaseact != null)
                {
                    if (dtcaseact.Rows.Count > 0)
                    {
                        foreach (DataRow row in dtcaseact.Rows)
                            actList.Add(new CASEACTEntity(row));

                        actList = actList.FindAll(u => u.Branch != "9");
                    }
                }
                if (dtcasems != null)
                {
                    if (dtcasems.Rows.Count > 0)
                    {
                        foreach (DataRow row in dtcasems.Rows)
                            MSlist.Add(new CASEMSEntity(row));

                        MSlist = MSlist.FindAll(u => u.Branch != "9");
                    }
                }
                if (dtcasecont != null)
                {
                    if (dtcasecont.Rows.Count > 0)
                    {
                        foreach (DataRow row in dtcasecont.Rows)
                            ContList.Add(new CASECONTEntity(row, string.Empty, string.Empty));
                    }
                }
                if (dtactrefs != null)
                {
                    if (dtactrefs.Rows.Count > 0)
                    {
                        foreach (DataRow row in dtactrefs.Rows)
                            Actrefslist.Add(new ACTREFSEntity(row));
                    }
                }
                if (dtmatasmt != null)
                {
                    if (dtmatasmt.Rows.Count > 0)
                    {
                        foreach (DataRow row in dtmatasmt.Rows)
                            MATAList.Add(new MATASMTEntity(row, "Browse"));
                    }
                }
                if (dtliheapb != null)
                {
                    if (dtliheapb.Rows.Count > 0)
                    {
                        foreach (DataRow row in dtliheapb.Rows)
                            LPBList.Add(new LIHEAPBEntity(row));
                    }
                }
                if (dtpayment != null)
                {
                    if (dtpayment.Rows.Count > 0)
                    {
                        foreach (DataRow row in dtpayment.Rows)
                            PaymentList.Add(new PAYMNETEntity(row));
                    }
                }

                if (listems != null)
                {
                    if (dtemsres != null)
                    {
                        if (dtemsres.Rows.Count > 0)
                        {
                            foreach (DataRow row in dtemsres.Rows)
                                EMSRESList.Add(new EMSRESEntity(row));
                        }
                    }
                    if (dtemsclcpmc != null)
                    {
                        if (dtemsclcpmc.Rows.Count > 0)
                        {
                            foreach (DataRow row in dtemsclcpmc.Rows)
                                EMSCLCList.Add(new EMSCLCPMCEntity(row));
                        }
                    }
                }

                if (Client_Tot_List.Count > 0)
                {
                    PbPdf.Visible = true;// Btn_CaseNotes.Visible = true; 
                    TotalsGrid.Rows.Clear();

                    TotalsGrid.Rows.Add("Intake", CASEMSTList.Count.ToString(), "0");
                    foreach (Client_InqTotal_entity ent in Client_Tot_List)
                    {
                        if (ent.Sno.Trim() == "9" || ent.Sno.Trim() == "10") //if (("9, 10").Contains(ent.Sno.Trim()))
                        {
                            if (listems != null)
                                TotalsGrid.Rows.Add(ent.Total_Desc, ent.Total_Cnt, ent.Sno);
                        }
                        else if (ent.Sno.Trim() == "7" || ent.Sno.Trim() == "8")
                        {
                            if (listEnergyassisteance != null)
                                TotalsGrid.Rows.Add(ent.Total_Desc, ent.Total_Cnt, ent.Sno);
                        }
                        else if (ent.Sno.Trim() == "1" || ent.Sno.Trim() == "2" || ent.Sno.Trim() == "3")
                        {
                            if (listems == null)
                                TotalsGrid.Rows.Add(ent.Total_Desc, ent.Total_Cnt, ent.Sno);
                        }
                        else
                            TotalsGrid.Rows.Add(ent.Total_Desc, ent.Total_Cnt, ent.Sno);

                        //if ((Acr_State == "TX" && ent.Sno.Contains("9, 10")))
                        //    TotalsGrid.Rows.Add(ent.Total_Desc, ent.Total_Cnt);
                    }
                }

            }
            else
            {
                //if (GvwAppHou.CurrentRow.Cells["Pdf_Sw"].Value.ToString() == "N") PbPdf.Visible = false; else PbPdf.Visible = true;
                //if (GvwAppHou.CurrentRow.Cells["CNotes_Sw"].Value.ToString() == "N") Btn_CaseNotes.Visible = false; else Btn_CaseNotes.Visible = true;
                if (GvwAppHou.Rows.Count > 0)
                    Fill_Totals_Grid();
            }
        }

        private void On_CaseNotesForm_Closed(List<CaseNotesEntity> casenotes_LIst, PrivilegeEntity Privilege)
        {
            Random_Filename = null;

            PdfName = "CaseNotes_" + GvwAppHou.SelectedRows[0].Cells["Grd_App"].Value.ToString();
            //PdfName = strFolderPath + PdfName;
            PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
            try
            {
                if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
            }
            catch (Exception ex)
            {
                CommonFunctions.MessageBoxDisplay("Error");
            }

            try
            {
                string Tmpstr = PdfName + ".pdf";
                if (File.Exists(Tmpstr))
                    File.Delete(Tmpstr);
            }
            catch (Exception ex)
            {
                int length = 8;
                string newFileName = System.Guid.NewGuid().ToString();
                newFileName = newFileName.Replace("-", string.Empty);

                Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
            }

            if (!string.IsNullOrEmpty(Random_Filename))
                PdfName = Random_Filename;
            else
                PdfName += ".pdf";

            FileStream fs = new FileStream(PdfName, FileMode.Create);

            Document document = new Document();
            document.SetPageSize(iTextSharp.text.PageSize.LETTER.Rotate());
            PdfWriter writer = PdfWriter.GetInstance(document, fs);
            document.Open();
            BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
            iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 16, 3, new iTextSharp.text.BaseColor(0, 0, 102));
            BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
            iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(bf_times, 9, 4);
            BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

            iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 10);
            iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
            iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
            iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(bf_times, 10, 1);
            iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
            iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);
            cb = writer.DirectContent;

            PdfPTable APP_details = new PdfPTable(2);
            APP_details.TotalWidth = 750f;
            APP_details.WidthPercentage = 100;
            APP_details.LockedWidth = true;
            float[] APP_details_Widths = new float[] { 30f, 70f };
            APP_details.SetWidths(APP_details_Widths);
            APP_details.HorizontalAlignment = Element.ALIGN_CENTER;
            APP_details.SpacingBefore = 9f;

            PdfPCell Appl_No = new PdfPCell(new Phrase("App # :" + GvwAppHou.SelectedRows[0].Cells["Grd_App"].Value.ToString(), TblFontBold));
            Appl_No.HorizontalAlignment = PdfPCell.ALIGN_LEFT;
            Appl_No.Border = iTextSharp.text.Rectangle.NO_BORDER;
            APP_details.AddCell(Appl_No);

            PdfPCell App_Name = new PdfPCell(new Phrase("Client Name :" + Lbl_App_Name.Text.Trim(), TblFontBold))
            {
                HorizontalAlignment = PdfPCell.ALIGN_LEFT,
                Border = iTextSharp.text.Rectangle.NO_BORDER
            };
            APP_details.AddCell(App_Name);

            PdfPCell Date = new PdfPCell(new Phrase("", TblFontBold));
            Date.Colspan = 4;
            Date.HorizontalAlignment = PdfPCell.ALIGN_RIGHT;
            Date.Border = iTextSharp.text.Rectangle.NO_BORDER;
            APP_details.AddCell(Date);
            //List<CaseNotesEntity> casenotes_LIst = new List<CaseNotesEntity>();
            //if (BaseForm.BaseYear.Trim() == string.Empty)
            //{
            //    casenotes_LIst = _model.TmsApcndata.BrowseCaseNotes(Privilege.Program.Trim(), propKeyFiedld);//BaseForm.BaseAgency.Trim() + BaseForm.BaseDept.Trim() + BaseForm.BaseProg.Trim() + strYear + BaseForm.BaseApplicationNo.Trim(),
            //}
            //else
            //{
            //    if (propKeyFiedld.Length > 18)
            //        casenotes_LIst = _model.TmsApcndata.BrowseCaseNotes(Privilege.Program.Trim(), propKeyFiedld);
            //    else
            //        casenotes_LIst = _model.TmsApcndata.BrowseCaseNotes(Privilege.Program.Trim(), propAgency.Trim() + propDept.Trim() + propProg.Trim() + strYear + propBaseAppNo.Trim());
            //    //casenotes_LIst = _model.TmsApcndata.BrowseCaseNotes(Privilege.Program.Trim(), BaseForm.BaseAgency.Trim() + BaseForm.BaseDept.Trim() + BaseForm.BaseProg.Trim() + strYear + propBaseAppNo.Trim());
            //}
            string Screen_Name = null;
            DataSet dsScreen = DatabaseLayer.Lookups.GetScreens(Privilege.ModuleCode);
            DataTable dtScreen = dsScreen.Tables[0];
            if (casenotes_LIst.Count > 0)
            {
                foreach (CaseNotesEntity drCasenotes in casenotes_LIst)
                {
                    foreach (DataRow drScreen in dtScreen.Rows)
                    {
                        if (drCasenotes.ScreenName.Trim() == drScreen["CFC_PROGNO"].ToString().Trim())
                        {
                            Screen_Name = drScreen["CFC_DESCRIPTION"].ToString().Trim(); break;
                        }
                    }

                    PdfPCell Screen = new PdfPCell(new Phrase("Screen Name", TblFontBold));
                    Screen.Colspan = 2;
                    Screen.HorizontalAlignment = PdfPCell.ALIGN_LEFT;
                    Screen.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER + iTextSharp.text.Rectangle.TOP_BORDER;
                    APP_details.AddCell(Screen);

                    //PdfPCell Space = new PdfPCell(new Phrase("" , TblFontBold));
                    //Space.HorizontalAlignment = PdfPCell.ALIGN_LEFT;
                    //Space.Border = iTextSharp.text.Rectangle.BOX;
                    //APP_details.AddCell(Space);

                    string CaseNotes_Desc = drCasenotes.Data.Trim();

                    PdfPCell Screen_desc = new PdfPCell(new Phrase(Screen_Name, Times));
                    Screen_desc.HorizontalAlignment = PdfPCell.ALIGN_LEFT;
                    Screen_desc.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    APP_details.AddCell(Screen_desc);

                    PdfPCell Notes = new PdfPCell(new Phrase(CaseNotes_Desc, Times));
                    Notes.HorizontalAlignment = PdfPCell.ALIGN_LEFT;
                    Notes.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    APP_details.AddCell(Notes);

                    PdfPCell Bottam_Border = new PdfPCell(new Phrase("", Times));
                    Bottam_Border.Colspan = 2;
                    Bottam_Border.HorizontalAlignment = PdfPCell.ALIGN_LEFT;
                    Bottam_Border.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                    APP_details.AddCell(Bottam_Border);

                }
            }

            document.Add(APP_details);
            document.Close();
            fs.Close();
            fs.Dispose();
        }

        private void dataGridCaseSnp_SelectionChanged(object sender, EventArgs e)
        {
            Fill_Other_prog_Grid();
        }

        DataTable dtSource = new DataTable();
        private string Fill_Sources(string Source)
        {
            string SourceName = string.Empty;

            //List<Utilities.ListItem> listItem = new List<Utilities.ListItem>();
            //listItem.Add(new Utilities.ListItem("   ", "0"));
            foreach (DataRow dr in dtSource.Rows)
            {
                if (dr["Code"].ToString().Trim() == Source.Trim())
                {
                    SourceName = dr["LookUpDesc"].ToString().Trim();
                    break;
                }

            }

            return SourceName;

        }
        List<CommonEntity> commonReasonlist = new List<CommonEntity>();
        private string BenefitReasonDesc(string Reason)
        {
            string BenReason = string.Empty;

            if (commonReasonlist.Count > 0)
            {
                foreach (CommonEntity reasonlist in commonReasonlist)
                {

                    if (reasonlist.Code == Reason)
                    {
                        BenReason = reasonlist.Desc;
                        break;
                    }

                }
            }

            return BenReason;
        }
        List<CMBDCEntity> Emsbdc_List { get; set; }
        private string BudgetDesc(string Budget)
        {
            string BDesc = string.Empty;
            Emsbdc_List = _model.SPAdminData.GetCMBdcAllData(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, string.Empty, string.Empty, string.Empty);
            if (Emsbdc_List.Count > 0)
            {
                foreach (CMBDCEntity Entity in Emsbdc_List)
                {
                    if (Entity.BDC_ID == Budget)
                    {
                        BDesc = Entity.BDC_DESCRIPTION.Trim();
                        break;
                    }
                }
            }


            return BDesc;
        }

        //List<HierarchyEntity> SP_Programs_List = new List<HierarchyEntity>();
        private string Set_SP_Program_TextReport(string Prog_Code)
        {
            string Tmp_Hierarchy = "";
            string Sel_CAMS_Program = "";

            foreach (HierarchyEntity Ent in SP_Programs_List)
            {
                Tmp_Hierarchy = Ent.Agency.Trim() + Ent.Dept.Trim() + Ent.Prog.Trim();
                if (Prog_Code == Tmp_Hierarchy)
                {
                    Sel_CAMS_Program = Tmp_Hierarchy + " - " + Ent.HirarchyName.Trim();
                    break;
                }
            }

            return Sel_CAMS_Program;
        }

        List<SPCommonEntity> FundingList = new List<SPCommonEntity>();
        private string GetFundName(string FundCode)
        {
            string Fundname = string.Empty;
            FundingList = _model.SPAdminData.Get_AgyRecs_WithFilter("Funding", "A");
            if (FundingList.Count > 0)
            {
                foreach (SPCommonEntity Entity in FundingList)
                {
                    if (Entity.Code == FundCode)
                    {
                        Fundname = Entity.Desc.Trim();
                        break;
                    }
                }
            }
            return Fundname;
        }


        DataTable dtWorker = new DataTable();
        public string GetWorkerName(string Worker)
        {
            string Caseworker = string.Empty;
            if (dtWorker.Rows.Count > 0)
            {
                foreach (DataRow dr in dtWorker.Rows)
                {
                    if (dr["PWH_CASEWORKER"].ToString().Trim() == Worker)
                    {
                        Caseworker = dr["NAME"].ToString().Trim();
                        break;
                    }
                }
            }
            return Caseworker;
        }

        DataTable dtSite = new DataTable();
        public string GetSiteName(string Site)
        {
            string Casesite = string.Empty;
            if (dtSite.Rows.Count > 0)
            {
                foreach (DataRow dr in dtSite.Rows)
                {
                    if (dr["SITE_NUMBER"].ToString().Trim() == Site)
                    {
                        Casesite = dr["SITE_NAME"].ToString().Trim();
                        break;
                    }
                }
            }
            return Casesite;
        }

        List<SPCommonEntity> UOMList = new List<SPCommonEntity>();
        private string GetUOMName(string UOM)
        {
            string UOMName = string.Empty;
            UOMList = _model.SPAdminData.Get_AgyRecs_WithFilter("UOM", "A");
            if (UOMList.Count > 0)
            {
                foreach (SPCommonEntity Entity in UOMList)
                {
                    if (Entity.Code == UOM)
                    {
                        UOMName = Entity.Desc.Trim();
                        break;
                    }
                }
            }
            return UOMName;
        }

        List<CASEVDDEntity> CaseVddlist = new List<CASEVDDEntity>();
        private void Get_Vendor_List()
        {
            CASEVDDEntity Search_Entity = new CASEVDDEntity(true);
            CaseVddlist = _model.SPAdminData.Browse_CASEVDD(Search_Entity, "Browse");
        }
        private string Get_Vendor_Name(string VendorNo)
        {
            string Vend_Name = string.Empty;
            foreach (CASEVDDEntity Entity in CaseVddlist)
            {
                if (Entity.Code == VendorNo)
                {
                    Vend_Name = Entity.Name.Trim(); break;
                }
            }
            return Vend_Name;
        }

        List<SPCommonEntity> propResultsList = new List<SPCommonEntity>();

        public string MsResultDescription(string strid)
        {
            string strresultdesc = string.Empty;
            if (propResultsList.Count > 0)
            {
                try
                {
                    strresultdesc = propResultsList.Find(u => u.Code.Trim() == strid.Trim()).Desc;
                }
                catch (Exception ex)
                {

                }

            }
            return strresultdesc;
        }

        //List<CASEACTEntity> SP_Activity_Details = new List<CASEACTEntity>();
        //private void Get_App_CASEACT_List(string SPCode, string Seq, string SPMYear)
        //{
        //    CASEACTEntity Search_Enty = new CASEACTEntity(true);
        //    Search_Enty.Agency = BaseForm.BaseAgency;
        //    Search_Enty.Dept = BaseForm.BaseDept;
        //    Search_Enty.Program = BaseForm.BaseProg;
        //    Search_Enty.Year = SPMYear;                             // Year will be always Four-Spaces in CASEACT
        //    Search_Enty.App_no = BaseForm.BaseApplicationNo;
        //    Search_Enty.SPM_Seq = Seq;
        //    Search_Enty.Service_plan = SPCode;

        //    SP_Activity_Details = _model.SPAdminData.Browse_CASEACT(Search_Enty, "Browse");

        //    SP_Activity_Details = SP_Activity_Details.OrderByDescending(u => Convert.ToDateTime(u.ACT_Date.Trim())).ToList();

        //}


    }
}