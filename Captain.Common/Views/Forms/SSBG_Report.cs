#region Using

using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;

using Wisej.Web;
using Captain.Common.Views.Controls.Compatibility;
using Captain.Common.Utilities;
using Captain.Common.Views.Forms.Base;
using Captain.Common.Menus;
using Captain.Common.Views.Forms;
using System.Data.SqlClient;
using Captain.Common.Views.Controls;
using Captain.Common.Model.Objects;
using Captain.Common.Model.Data;
using System.Text.RegularExpressions;
using Captain.Common.Views.UserControls;
using System.Xml;
using System.IO;

using iTextSharp;
using iTextSharp.text;
using iTextSharp.text.pdf;
using iTextSharp.text.html.simpleparser;
using System.Globalization;
using XLSExportFile;
using CarlosAg.ExcelXmlWriter;

#endregion

namespace Captain.Common.Views.Forms
{
    public partial class SSBG_Report : Form
    {
        #region private variables

        private ErrorProvider _errorProvider = null;
        private CaptainModel _model = null;
        List<CaseQuestionResult> caseQuestionResult = null;
        List<CaseGroupResult> caseGroupResult = null;
        List<CommonEntity> caseEligStatusList = null;

        #endregion
        public SSBG_Report(BaseForm baseForm, PrivilegeEntity privileges)
        {
            InitializeComponent();
            
            _model = new CaptainModel();
            _errorProvider = new ErrorProvider(this);
            _errorProvider.BlinkRate = 3;
            _errorProvider.BlinkStyle = ErrorBlinkStyle.BlinkIfDifferentError;
            _errorProvider.Icon = null;

            BaseForm = baseForm; Privileges = privileges;
            Agency = BaseForm.BaseAgency; Depart = BaseForm.BaseDept;
            Program = BaseForm.BaseProg; Program_Year = BaseForm.BaseYear;
            Set_Report_Hierarchy(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, BaseForm.BaseYear);
            propReportPath = _model.lookupDataAccess.GetReportPath();

            ListcaseSiteEntity = new List<CaseSiteEntity>();

            txtfrom1.Validator = TextBoxValidation.IntegerValidator;
            txtTo1.Validator = TextBoxValidation.IntegerValidator;
            txtFrom2.Validator = TextBoxValidation.IntegerValidator;
            txtTo2.Validator = TextBoxValidation.IntegerValidator;

            SSBGParamall = _model.CaseSumData.GetSSBGParams(string.Empty, string.Empty, string.Empty);

            this.Text = /*Privileges.Program + " - " +*/ Privileges.PrivilegeName.Trim();

            FillCombo();
        }

        #region properties

        public BaseForm BaseForm { get; set; }
        public PrivilegeEntity Privileges { get; set; }
        public string propReportPath { get; set; }
        public string Agency { get; set; }
        public string Depart { get; set; }
        public string Program { get; set; }
        public string strYear { get; set; }
        public List<MembersEntity> mem_List { get; set; }
        List<CommonEntity> commonfundingsource { get; set; }
        List<CommonEntity> commonCasetypes { get; set; }
        public List<CaseSiteEntity> propCaseSiteEntity { get; set; }
        public List<SSBGPARAMEntity> SSBGParamall { get; set; }
        public List<CaseSiteEntity> propCaseAllSiteEntity { get; set; }
        public List<HierarchyEntity> hierarchyEntity { get; set; }
        public List<CommonEntity> propfundingSource { get; set; }
        public List<SSBGTYPESEntity> SSBGTypesall { get; set; }
        public List<SSBGTYPESEntity> SSBGTypesGroups { get; set; }
        public List<SSBGTYPESEntity> SSBGTypesQues { get; set; }
        public List<SSBGGOALSEntity> SSBGGoalsall { get; set; }
        public List<SSBGSerPlanEntity> SSBGSerPlans { get; set; }
        public List<SSBGAssnsEntity> SSBGCAMS_List { get; set; }
        public List<SSBGMONTHSEntity> SSBGMonths_List { get; set; }

        public List<CaseSiteEntity> ListcaseSiteEntity { get; set; }

        public List<SSBGMONTHSEntity> SELSSBGMonths_List { get; set; }
        
        public List<CaseSnpEntity> caseSnpList { get; set; }
        public List<CaseIncomeEntity> caseIncomeList { get; set; }

        public List<CaseMstEntity> propcasemstAlllist = new List<CaseMstEntity>();
        public List<CaseSnpEntity> propcaseSnpAlllist = new List<CaseSnpEntity>();
        public List<CaseIncomeEntity> PropcaseIncomeList = new List<CaseIncomeEntity>();
        public List<CASESPMEntity> CaseSPMList = new List<CASESPMEntity>();
        public List<CASEACTEntity> SP_Activity_Details = new List<CASEACTEntity>();
        public List<CASEMSEntity> SP_MS_Details = new List<CASEMSEntity>();
        public List<CaseMstEntity> YearcasemstAlllist = new List<CaseMstEntity>();
        public List<CaseSnpEntity> YearcaseSnpAlllist = new List<CaseSnpEntity>();

        public List<CaseMstEntity> propADDCUSTcasemstAlllist = new List<CaseMstEntity>();
        public List<CaseMstEntity> propContcasemstAlllist = new List<CaseMstEntity>();
        public List<CaseMstEntity> propACTcasemstAlllist = new List<CaseMstEntity>();
        public List<CaseMstEntity> propSPMcasemstAlllist = new List<CaseMstEntity>();
        public List<CaseSnpEntity> propADDCUSTcaseSnpAlllist = new List<CaseSnpEntity>();
        public List<CaseSnpEntity> propCONTcaseSnpAlllist = new List<CaseSnpEntity>();
        public List<CaseSnpEntity> propACTcaseSnpAlllist = new List<CaseSnpEntity>();
        public List<CaseSnpEntity> propSPMcaseSnpAlllist = new List<CaseSnpEntity>();

        public List<CaseMstEntity> propDUPContcasemstAlllist = new List<CaseMstEntity>();
        public List<CaseMstEntity> propDUPACTcasemstAlllist = new List<CaseMstEntity>();
        public List<CaseMstEntity> propDUPSPMcasemstAlllist = new List<CaseMstEntity>();
        public List<CaseSnpEntity> propDUPCONTcaseSnpAlllist = new List<CaseSnpEntity>();
        public List<CaseSnpEntity> propDUPACTcaseSnpAlllist = new List<CaseSnpEntity>();
        public List<CaseSnpEntity> propDUPSPMcaseSnpAlllist = new List<CaseSnpEntity>();

        public List<CaseMstEntity> IntakeAppList = new List<CaseMstEntity>();
        public List<CaseMstEntity> CaseContList = new List<CaseMstEntity>();
        public List<CaseMstEntity> CaseactList = new List<CaseMstEntity>();
        public List<CaseMstEntity> Spmlistcnt = new List<CaseMstEntity>();
        public List<CaseMstEntity> CustQueslistcnt = new List<CaseMstEntity>();

        public List<CaseMstEntity> DUPCaseContList = new List<CaseMstEntity>();
        public List<CaseMstEntity> DUPCaseactList = new List<CaseMstEntity>();
        public List<CaseMstEntity> DUPSpmlistcnt = new List<CaseMstEntity>();

        public List<CaseMstEntity> YearIntakeAppList = new List<CaseMstEntity>();
        public List<CaseMstEntity> YearCaseContList = new List<CaseMstEntity>();
        public List<CaseMstEntity> YearCaseactList = new List<CaseMstEntity>();
        public List<CaseMstEntity> YearSpmlistcnt = new List<CaseMstEntity>();
        public List<CaseMstEntity> YearCustQueslistcnt = new List<CaseMstEntity>();

        public List<CaseMstEntity> YearDUPCaseContList = new List<CaseMstEntity>();
        public List<CaseMstEntity> YearDUPCaseactList = new List<CaseMstEntity>();
        public List<CaseMstEntity> YearDUPSpmlistcnt = new List<CaseMstEntity>();

        public List<CASEACTEntity> YEAR_SP_Activity_Details = new List<CASEACTEntity>();
        public List<CASEMSEntity> YEAR_SP_MS_Details = new List<CASEMSEntity>();

        public List<CaseELIGQUESEntity> EligQuestionsData { get; set; }

        public DataTable ByPassTable { get; set; }
        public DataTable AcceptTable { get; set; }

        #endregion

        private void FillCombo()
        {
            string strHierchycode = Agency + Depart + Program;
            List<SSBGPARAMEntity> caseEligGroups = SSBGParamall.FindAll(u => ((u.SSBGAgency + u.SSBGDept + u.SSBGProgram).Equals(strHierchycode)));

            if (caseEligGroups.Count > 0)
            {
                foreach (SSBGPARAMEntity Entity in caseEligGroups)
                {
                    Captain.Common.Utilities.ListItem li = new Captain.Common.Utilities.ListItem(Entity.SSBGDesc, Entity.SSBGSeq);
                    cmbSSBG.Items.Add(li);
                }
                cmbSSBG.SelectedIndex = 0;
            }

            dtpFrom.Value = new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1);
            dtpTo.Value = new DateTime(DateTime.Today.Year, DateTime.Today.Month, DateTime.DaysInMonth(DateTime.Today.Month, DateTime.Today.Month));
            dtpFrom.Checked = dtpTo.Checked = true;

        }

        private void FillDemoCount(SSBGPARAMEntity SelSSBG)
        {
            cmbDemo.Items.Clear();
            if (!string.IsNullOrEmpty(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString()))
            {
                string RepMonths = string.Empty;

                DateTime FrmDate = Convert.ToDateTime(dtpFrom.Text.ToString());
                DateTime ToDate = Convert.ToDateTime(dtpTo.Text.ToString());

                List<string> diffMonths = BuildMothswithYears(FrmDate.Month, ToDate.Month, FrmDate.Year, ToDate.Year);

                //var diffMonths = (dtpTo.Value - dtpFrom.Value).Days / 30;
                if (diffMonths.Count > 1) RepMonths = "(" + diffMonths.Count + " Months)"; else RepMonths = "(" + diffMonths.Count + " Month)";

                string DynamicMonth = string.Empty;
                switch (diffMonths.Count)
                {
                    case 0:
                    case 1: DynamicMonth = "1 Month"; break;
                    case 2: DynamicMonth = "2 Month"; break;
                    case 3: DynamicMonth = "Quarterly"; break;
                    case 4: DynamicMonth = "4 Month"; break;
                    case 5: DynamicMonth = "5 Month"; break;
                    case 6: DynamicMonth = "Half Yearly"; break;
                    case 7: DynamicMonth = "7 Month"; break;
                    case 8: DynamicMonth = "8 Month"; break;
                    case 9: DynamicMonth = "9 Month"; break;
                    case 10: DynamicMonth = "10 Month"; break;
                    case 11: DynamicMonth = "11 Month"; break;
                    case 12: DynamicMonth = "Yearly"; break;
                }

                List<Captain.Common.Utilities.ListItem> ampmlist1 = new List<Captain.Common.Utilities.ListItem>();

                if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1")
                {
                    ampmlist1.Add(new Captain.Common.Utilities.ListItem(SelSSBG.SSBGCntArea1.Trim() + " " + DynamicMonth.Trim(), SelSSBG.SSBGCntArea1_Val.ToString() + "1"));
                    ampmlist1.Add(new Captain.Common.Utilities.ListItem(SelSSBG.SSBGCntArea1.Trim() + " YTD", SelSSBG.SSBGCntArea1_Val.ToString()));
                }
                if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1")
                    ampmlist1.Add(new Captain.Common.Utilities.ListItem(SelSSBG.SSBGCntArea2.Trim(), SelSSBG.SSBGCntArea2_Val.ToString()));
                if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1")
                    ampmlist1.Add(new Captain.Common.Utilities.ListItem(SelSSBG.SSBGCntArea3.Trim(), SelSSBG.SSBGCntArea3_Val.ToString()));
                if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1")
                {
                    ampmlist1.Add(new Captain.Common.Utilities.ListItem(SelSSBG.SSBGCntArea4.Trim() + " " + DynamicMonth.Trim(), SelSSBG.SSBGCntArea4_Val.ToString() + "1"));
                    ampmlist1.Add(new Captain.Common.Utilities.ListItem(SelSSBG.SSBGCntArea4.Trim() + " YTD", SelSSBG.SSBGCntArea4_Val.ToString()));
                }
                if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1")
                {
                    ampmlist1.Add(new Captain.Common.Utilities.ListItem(SelSSBG.SSBGCntArea5.Trim() + " " + DynamicMonth.Trim(), SelSSBG.SSBGCntArea5_Val.ToString() + "1"));
                    ampmlist1.Add(new Captain.Common.Utilities.ListItem(SelSSBG.SSBGCntArea5.Trim() + " YTD", SelSSBG.SSBGCntArea5_Val.ToString()));
                }

                cmbDemo.Items.AddRange(ampmlist1.ToArray());
                cmbDemo.SelectedIndex = 0;
            }
        }

        private void CmbYear_SelectedIndexChanged(object sender, EventArgs e)
        {
            Program_Year = "    ";
            if (!(string.IsNullOrEmpty(((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString())))
                Program_Year = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString();
        }

        string Program_Year;
        private void Set_Report_Hierarchy(string Agy, string Dept, string Prog, string Year)
        {
            Txt_HieDesc.Clear();
            CmbYear.Visible = false;
            Program_Year = "    ";
            Current_Hierarchy = Agy + Dept + Prog;
            Current_Hierarchy_DB = Agy + "-" + Dept + "-" + Prog;

            if (Agy != "**")
            {
                DataSet ds_AGY = Captain.DatabaseLayer.AgyTab.GetHierarchyNames(Agy, "**", "**");
                if (ds_AGY.Tables.Count > 0)
                {
                    if (ds_AGY.Tables[0].Rows.Count > 0)
                        Txt_HieDesc.Text += "AGY : " + Agy + " - " + (ds_AGY.Tables[0].Rows[0]["HIE_NAME"].ToString()).Trim() + "      ";
                }
            }
            else
                Txt_HieDesc.Text += "AGY : ** - All Agencies      ";

            if (Dept != "**")
            {
                DataSet ds_DEPT = Captain.DatabaseLayer.AgyTab.GetHierarchyNames(Agy, Dept, "**");
                if (ds_DEPT.Tables.Count > 0)
                {
                    if (ds_DEPT.Tables[0].Rows.Count > 0)
                        Txt_HieDesc.Text += "DEPT : " + Dept + " - " + (ds_DEPT.Tables[0].Rows[0]["HIE_NAME"].ToString()).Trim() + "      ";
                }
            }
            else
                Txt_HieDesc.Text += "DEPT : ** - All Departments      ";

            if (Prog != "**")
            {
                DataSet ds_PROG = Captain.DatabaseLayer.AgyTab.GetHierarchyNames(Agy, Dept, Prog);
                if (ds_PROG.Tables.Count > 0)
                {
                    if (ds_PROG.Tables[0].Rows.Count > 0)
                        Txt_HieDesc.Text += "PROG : " + Prog + " - " + (ds_PROG.Tables[0].Rows[0]["HIE_NAME"].ToString()).Trim();
                }
            }
            else
                Txt_HieDesc.Text += "PROG : ** - All Programs ";


            if (Agy != "**")
                Get_NameFormat_For_Agencirs(Agy);
            else
                Member_NameFormat = CAseWorkerr_NameFormat = "1";

            if (Agy != "**" && Dept != "**" && Prog != "**")
                FillYearCombo(Agy, Dept, Prog, Year);
            else
                this.Txt_HieDesc.Size = new System.Drawing.Size(900, 25);
        }

        string Member_NameFormat = "1", CAseWorkerr_NameFormat = "1";
        private void Get_NameFormat_For_Agencirs(string Agency)
        {
            DataSet ds = Captain.DatabaseLayer.AgyTab.GetHierarchyNames(Agency, "**", "**");
            if (ds.Tables.Count > 0)
            {
                if (ds.Tables[0].Rows.Count > 0)
                {
                    Member_NameFormat = ds.Tables[0].Rows[0]["HIE_CN_FORMAT"].ToString();
                    CAseWorkerr_NameFormat = ds.Tables[0].Rows[0]["HIE_CW_FORMAT"].ToString();
                }
            }
        }

        string DepYear;
        bool DefHieExist = false;
        private void FillYearCombo(string Agy, string Dept, string Prog, string Year)
        {
            CmbYear.Visible = DefHieExist = false;
            Program_Year = "    ";
            if (!string.IsNullOrEmpty(Year.Trim()))
                DefHieExist = true;

            DataSet ds = Captain.DatabaseLayer.MainMenu.GetCaseDepForHierarchy(Agy, Dept, Prog);
            if (ds.Tables.Count > 0)
            {
                DataTable dt = ds.Tables[0];
                int YearIndex = 0;

                if (dt.Rows.Count > 0)
                {
                    Program_Year = DepYear = dt.Rows[0]["DEP_YEAR"].ToString();
                    if (!(String.IsNullOrEmpty(DepYear.Trim())) && DepYear != null && DepYear != "    ")
                    {
                        int TmpYear = int.Parse(DepYear);
                        int TempCompareYear = 0;
                        string TmpYearStr = null;
                        if (!(String.IsNullOrEmpty(Year)) && Year != null && Year != " " && DefHieExist)
                            TempCompareYear = int.Parse(Year);
                        List<Captain.Common.Utilities.ListItem> listItem = new List<Captain.Common.Utilities.ListItem>();
                        for (int i = 0; i < 10; i++)
                        {
                            TmpYearStr = (TmpYear - i).ToString();
                            listItem.Add(new Captain.Common.Utilities.ListItem(TmpYearStr, i));
                            if (TempCompareYear == (TmpYear - i) && TmpYear != 0 && TempCompareYear != 0)
                                YearIndex = i;
                        }

                        CmbYear.Items.AddRange(listItem.ToArray());

                        CmbYear.Visible = true;

                        if (DefHieExist)
                            CmbYear.SelectedIndex = YearIndex;
                        else
                            CmbYear.SelectedIndex = 0;
                    }
                }
            }

            Agency = Agy; Depart = Dept; Program = Prog; strYear = Year;
            
            if (!string.IsNullOrEmpty(Program_Year.Trim()))
                this.Txt_HieDesc.Size = new System.Drawing.Size(820, 25);
            else
                this.Txt_HieDesc.Size = new System.Drawing.Size(900, 25);
        }

        private bool ValidateForm()
        {
            bool isValid = true;
            SSBGPARAMEntity SelSSBG = SSBGParamall.Find(u => ((u.SSBGSeq).Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString())));

            if (!Ref_From_Date.Checked)
            {
                _errorProvider.SetError(Ref_From_Date, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), "Reference Period 'From' Date".Replace(Consts.Common.Colon, string.Empty)));
                isValid = false;
            }
            else
                _errorProvider.SetError(Ref_From_Date, null);

            if (!Ref_To_Date.Checked)
            {
                _errorProvider.SetError(Ref_To_Date, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), "Reference Period 'To' Date".Replace(Consts.Common.Colon, string.Empty)));
                isValid = false;
            }
            else
            {
                if (Ref_From_Date.Checked)
                    _errorProvider.SetError(Ref_To_Date, null);
            }

            if (Ref_To_Date.Checked && Ref_From_Date.Checked)
            {
                if (Convert.ToDateTime(SelSSBG.SSBGGPFrom.Trim()) > Ref_From_Date.Value || Convert.ToDateTime(SelSSBG.SSBGGPTo.Trim()) < Ref_To_Date.Value)
                {
                    _errorProvider.SetError(Ref_To_Date, string.Format("Reference Period Should be in 'Grant Period Date Range'".Replace(Consts.Common.Colon, string.Empty)));
                    isValid = false;
                }
                else if (Ref_From_Date.Value > Ref_To_Date.Value)
                {
                    _errorProvider.SetError(Ref_To_Date, string.Format("Reference Period 'From Date' should not be prior to 'TO Date'".Replace(Consts.Common.Colon, string.Empty)));
                    isValid = false;
                }
                else
                {
                    _errorProvider.SetError(Ref_To_Date, null);
                }
            }
            else
            {
                if (Ref_To_Date.Checked && Ref_From_Date.Checked)
                    _errorProvider.SetError(Ref_To_Date, null);
            }

            if (dtpFrom.Checked.Equals(false))
            {
                _errorProvider.SetError(dtpFrom, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), lblRepDate.Text.Replace(Consts.Common.Colon, string.Empty)));
                isValid = false;
            }
            else
                _errorProvider.SetError(dtpFrom, null);

            if (dtpTo.Checked.Equals(false))
            {
                _errorProvider.SetError(dtpTo, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), lblRepDate.Text.Replace(Consts.Common.Colon, string.Empty)));
                isValid = false;
            }
            else
                _errorProvider.SetError(dtpTo, null);


            if (dtpFrom.Value.Date > dtpTo.Value.Date)
            {
                _errorProvider.SetError(dtpTo, "Report Period 'From Date' should not be prior to 'TO Date'");
                isValid = false;
            }
            else
            {
                _errorProvider.SetError(dtpTo, null);
            }

            if (Ref_To_Date.Checked && Ref_From_Date.Checked && dtpTo.Checked && dtpFrom.Checked)
            {
                if (Ref_From_Date.Value > dtpFrom.Value || Ref_To_Date.Value < dtpTo.Value)
                {
                    _errorProvider.SetError(dtpTo, string.Format("Report Period Should be in 'Reference Period Date Range'".Replace(Consts.Common.Colon, string.Empty)));
                    isValid = false;
                }
                else
                    _errorProvider.SetError(dtpTo, null);
            }

            if (txtfrom1.Text.Trim() == string.Empty)
            {
                _errorProvider.SetError(txtfrom1, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), lblAge1.Text.Trim() + " " + "From ".Replace(Consts.Common.Colon, string.Empty)));
                isValid = false;
            }
            else
            {
                _errorProvider.SetError(txtfrom1, null);
            }

            if (txtTo1.Text.Trim() == string.Empty)
            {
                _errorProvider.SetError(txtTo1, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), lblAge1.Text.Trim() + " " + "To ".Replace(Consts.Common.Colon, string.Empty)));
                isValid = false;
            }
            else
            {
                _errorProvider.SetError(txtTo1, null);
            }

            if ((txtfrom1.Text.Trim() != string.Empty) && (txtTo1.Text.Trim() != string.Empty))
            {
                if (Convert.ToInt32(txtfrom1.Text) > Convert.ToInt32(txtTo1.Text))
                {
                    _errorProvider.SetError(txtTo1, "Age Range1 From Age May Not Be Greater Than To Age");
                    isValid = false;
                }
                else
                {
                    _errorProvider.SetError(txtTo1, null);
                }
            }

            if (txtFrom2.Text.Trim() == string.Empty)
            {
                _errorProvider.SetError(txtFrom2, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), lblAge2.Text.Trim() + " " + "From ".Replace(Consts.Common.Colon, string.Empty)));
                isValid = false;
            }
            else
            {
                _errorProvider.SetError(txtFrom2, null);
            }

            if (txtTo2.Text.Trim() == string.Empty)
            {
                _errorProvider.SetError(txtTo2, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), lblAge2.Text.Trim() + " " + "To ".Replace(Consts.Common.Colon, string.Empty)));
                isValid = false;
            }
            else
            {
                _errorProvider.SetError(txtTo2, null);
            }

            if ((txtFrom2.Text.Trim() != string.Empty) && (txtTo2.Text.Trim() != string.Empty))
            {
                if (Convert.ToInt32(txtFrom2.Text) > Convert.ToInt32(txtTo2.Text))
                {
                    _errorProvider.SetError(txtTo2, "Age Range2 From Age May Not Be Greater Than To Age");
                    isValid = false;
                }
                else
                {
                    _errorProvider.SetError(txtTo2, null);
                }
            }

            //if(string.IsNullOrEmpty(txtName.Text.Trim()))
            //{
            //    _errorProvider.SetError(txtName, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), lblName.Text.Replace(Consts.Common.Colon, string.Empty)));
            //    isValid = false;
            //}
            //else
            //    _errorProvider.SetError(txtName, null);

            //if (string.IsNullOrEmpty(mskPhone.Text.Trim()))
            //{
            //    _errorProvider.SetError(mskPhone, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), lblPhone.Text.Replace(Consts.Common.Colon, string.Empty)));
            //    isValid = false;
            //}
            //else
            //    _errorProvider.SetError(mskPhone, null);

            //if (string.IsNullOrEmpty(txtEmail.Text.Trim()))
            //{
            //    _errorProvider.SetError(txtEmail, string.Format(Consts.Messages.BlankIsRequired.GetMessage(), lblEmail.Text.Replace(Consts.Common.Colon, string.Empty)));
            //    isValid = false;
            //}
            //else
            //    _errorProvider.SetError(txtEmail, null);

            return (isValid);
        }


        private void btnGeneratePdf_Click(object sender, EventArgs e)
        {
            if (ValidateForm())
            {
                GetData();
                ds.Tables.Clear();
                dsObj.Tables.Clear();

                PdfListForm pdfListForm = new PdfListForm(BaseForm, Privileges, false, propReportPath, "PDF");
                pdfListForm.FormClosed += new FormClosedEventHandler(OnHRANB_Report);//OnExcel_Report
                pdfListForm.StartPosition = FormStartPosition.CenterScreen;
                pdfListForm.ShowDialog();
            }
        }

        string SPList = string.Empty, CAList = string.Empty, MSList = string.Empty;
        private void GetData()
        {

            EligQuestionsData = _model.CaseSumData.GetELIGQUES();
            SSBGTypesall = _model.CaseSumData.GetSSBGTypes();
            SSBGGoalsall = _model.CaseSumData.GetSSBGGoals();

            SSBGTypesGroups = SSBGTypesall.FindAll(u => u.SBGTID.Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString()) && !u.SBGTCodeSeq.Equals("0") && u.SBGTGroupSeq.Equals("0"));

            SSBGTypesQues = _model.CaseSumData.GetSSBGTypesadpgs(string.Empty, string.Empty, string.Empty, string.Empty, string.Empty, string.Empty);
            SSBGTypesQues = SSBGTypesQues.FindAll(u => u.SBGTID.Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString()) && !u.SBGTCodeSeq.Equals("0") && !u.SBGTGroupSeq.Equals("0"));

            SSBGSerPlans = _model.CaseSumData.Browse_SSBGSerplan(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString(), string.Empty, string.Empty, string.Empty);
            SSBGCAMS_List = _model.CaseSumData.Browse_SSBGAssns(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString(), string.Empty, string.Empty, string.Empty, string.Empty);
            SSBGMonths_List = _model.CaseSumData.GetSSBGMonths((Agency == "**" ? string.Empty : Agency), (Depart == "**" ? string.Empty : Depart), (Program == "**" ? string.Empty : Program));


            SSBGPARAMEntity SelSSBG = SSBGParamall.Find(u => ((u.SSBGSeq).Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString())));
            SELSSBGMonths_List = SSBGMonths_List.FindAll(u => ((u.SSBGSeq).Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString())));
            //ByPassTable = CreateTable(); AcceptTable = CreateTable();
            propcasemstAlllist.Clear(); propcaseSnpAlllist.Clear(); PropcaseIncomeList.Clear(); CaseSPMList.Clear(); SP_Activity_Details.Clear(); SP_MS_Details.Clear();
            propContcasemstAlllist.Clear(); propCONTcaseSnpAlllist.Clear(); propACTcasemstAlllist.Clear(); propACTcaseSnpAlllist.Clear();
            propSPMcasemstAlllist.Clear(); propSPMcaseSnpAlllist.Clear();
            propADDCUSTcasemstAlllist.Clear(); propADDCUSTcaseSnpAlllist.Clear(); propDUPContcasemstAlllist.Clear(); 
            propDUPACTcasemstAlllist.Clear(); propDUPSPMcasemstAlllist.Clear();

            string Mst_Site = "**";
            if (Rb_Site_Sel.Checked)
                Mst_Site = Get_Sel_Sites();
            else if (Rb_Site_No.Checked)
                Mst_Site = "NO";

            DataSet ds = Captain.DatabaseLayer.SPAdminDB.GetSSBGEligdata((Agency == "**" ? string.Empty : Agency), (Depart == "**" ? string.Empty : Depart), (Program == "**" ? string.Empty : Program), Program_Year, dtpFrom.Value.ToShortDateString(), dtpTo.Value.ToShortDateString(), ((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString(), Mst_Site);

            if (ds.Tables.Count > 0)
            {
                if (ds.Tables[0].Rows.Count > 0) //INTAKE MST
                {
                    foreach (DataRow row in ds.Tables[0].Rows)
                    {
                        propcasemstAlllist.Add(new CaseMstEntity(row, "SSBG"));
                    }
                }

                if (ds.Tables[1].Rows.Count > 0)        //INTAKE SNP
                {
                    foreach (DataRow row in ds.Tables[1].Rows)
                    {
                        propcaseSnpAlllist.Add(new CaseSnpEntity(row, "SSBG"));
                    }
                }

                //if (ds.Tables[2].Rows.Count > 0)
                //{
                //    foreach (DataRow row in ds.Tables[2].Rows)
                //    {
                //        PropcaseIncomeList.Add(new CaseIncomeEntity(row, "TRIGGERS"));
                //    }
                //}

                if (ds.Tables[2].Rows.Count > 0)        //ADDCUST MST
                {
                    foreach (DataRow row in ds.Tables[2].Rows)
                    {
                        propADDCUSTcasemstAlllist.Add(new CaseMstEntity(row, "SSBGADDCUST"));
                    }
                }

                if (ds.Tables[3].Rows.Count > 0)        //ADDCUST SNP
                {
                    foreach (DataRow row in ds.Tables[3].Rows)
                    {
                        propADDCUSTcaseSnpAlllist.Add(new CaseSnpEntity(row, "SSBG"));
                    }
                }

                if (ds.Tables[4].Rows.Count > 0)        //CASESPM
                {
                    foreach (DataRow row in ds.Tables[4].Rows)
                    {
                        CaseSPMList.Add(new CASESPMEntity(row, "SSBG"));
                    }
                }

                if (ds.Tables[5].Rows.Count > 0)        //CASEACT
                {
                    foreach (DataRow row in ds.Tables[5].Rows)
                    {
                        SP_Activity_Details.Add(new CASEACTEntity(row,string.Empty, "SSBG"));
                    }
                }

                if (ds.Tables[6].Rows.Count > 0)        //CASEMS
                {
                    foreach (DataRow row in ds.Tables[6].Rows)
                    {
                        SP_MS_Details.Add(new CASEMSEntity(row,string.Empty, "SSBG"));
                    }
                }

                if (ds.Tables[7].Rows.Count > 0)        //DUP CASECONT MST
                {
                    foreach (DataRow row in ds.Tables[7].Rows)
                    {
                        propDUPContcasemstAlllist.Add(new CaseMstEntity(row, "SSBG"));
                    }
                }

                //if (ds.Tables[8].Rows.Count > 0)        //DUPCASECONT SNP
                //{
                //    foreach (DataRow row in ds.Tables[8].Rows)
                //    {
                //        propCONTcaseSnpAlllist.Add(new CaseSnpEntity(row, "SSBG"));
                //    }
                //}

                if (ds.Tables[8].Rows.Count > 0)        //CASECONT MST
                {
                    foreach (DataRow row in ds.Tables[8].Rows)
                    {
                        propContcasemstAlllist.Add(new CaseMstEntity(row, "SSBG"));
                    }
                }

                if (ds.Tables[9].Rows.Count > 0)       //CASECONT SNP
                {
                    foreach (DataRow row in ds.Tables[9].Rows)
                    {
                        propCONTcaseSnpAlllist.Add(new CaseSnpEntity(row, "SSBG"));
                    }
                }

                if (ds.Tables[10].Rows.Count > 0)       //DUP CASEACT MST
                {
                    foreach (DataRow row in ds.Tables[10].Rows)
                    {
                        propDUPACTcasemstAlllist.Add(new CaseMstEntity(row, "SSBG"));
                    }
                }

                //if (ds.Tables[12].Rows.Count > 0)
                //{
                //    foreach (DataRow row in ds.Tables[12].Rows)
                //    {
                //        propDUPACTcaseSnpAlllist.Add(new CaseSnpEntity(row, "SSBG"));
                //    }
                //}

                if (ds.Tables[11].Rows.Count > 0)       //CASEACT MST
                {
                    foreach (DataRow row in ds.Tables[11].Rows)
                    {
                        propACTcasemstAlllist.Add(new CaseMstEntity(row, "SSBG"));
                    }
                }

                if (ds.Tables[12].Rows.Count > 0)       //CASEACT SNP
                {
                    foreach (DataRow row in ds.Tables[12].Rows)
                    {
                        propACTcaseSnpAlllist.Add(new CaseSnpEntity(row, "SSBG"));
                    }
                }

                if (ds.Tables[13].Rows.Count > 0)
                {
                    foreach (DataRow row in ds.Tables[13].Rows)         //DUP CASESPM MST
                    {
                        propDUPSPMcasemstAlllist.Add(new CaseMstEntity(row, "SSBG"));
                    }
                }

                //if (ds.Tables[16].Rows.Count > 0)
                //{
                //    foreach (DataRow row in ds.Tables[16].Rows)
                //    {
                //        propDUPSPMcaseSnpAlllist.Add(new CaseSnpEntity(row, "SSBG"));
                //    }
                //}

                if (ds.Tables[14].Rows.Count > 0)       //CASESPM  MST
                {
                    foreach (DataRow row in ds.Tables[14].Rows)
                    {
                        propSPMcasemstAlllist.Add(new CaseMstEntity(row, "SSBG"));
                    }
                }

                if (ds.Tables[15].Rows.Count > 0)       //CASESPM SNP
                {
                    foreach (DataRow row in ds.Tables[15].Rows)
                    {
                        propSPMcaseSnpAlllist.Add(new CaseSnpEntity(row, "SSBG"));
                    }
                }

                //if (ds.Tables[6].Rows.Count > 0)
                //{
                //    foreach (DataRow row in ds.Tables[4].Rows)
                //    {
                //        SP_Activity_Details.Add(new CASEACTEntity(row, "SSBG"));
                //    }
                //}

                //if (ds.Tables[7].Rows.Count > 0)
                //{
                //    foreach (DataRow row in ds.Tables[5].Rows)
                //    {
                //        SP_MS_Details.Add(new CASEMSEntity(row, "SSBG"));
                //    }
                //}
                //if (ds.Tables[6].Rows.Count > 0)
                //{
                //    foreach (DataRow row in ds.Tables[6].Rows)
                //    {
                //        YearcasemstAlllist.Add(new CaseMstEntity(row, "SSBG"));
                //    }
                //}

                //if (ds.Tables[7].Rows.Count > 0)
                //{
                //    foreach (DataRow row in ds.Tables[7].Rows)
                //    {
                //        YearcaseSnpAlllist.Add(new CaseSnpEntity(row, "TRIGGERS"));
                //    }
                //}
            }

        }

        private void btnPdfPreview_Click(object sender, EventArgs e)
        {
            PdfListForm pdfListForm = new PdfListForm(BaseForm, Privileges, true, propReportPath);
            pdfListForm.StartPosition = FormStartPosition.CenterScreen;
            pdfListForm.ShowDialog();
        }

        private void btnSaveParameters_Click(object sender, EventArgs e)
        {
            if (ValidateForm())
            {
                ControlCard_Entity Save_Entity = new ControlCard_Entity(true);
                Save_Entity.Scr_Code = Privileges.Program;
                Save_Entity.UserID = BaseForm.UserID;
                Save_Entity.Card_1 = Get_XML_Format_for_Report_Controls();
                Save_Entity.Card_2 = string.Empty;
                Save_Entity.Card_3 = string.Empty;
                Save_Entity.Module = BaseForm.BusinessModuleID;

                Report_Get_SaveParams_Form Save_Form = new Report_Get_SaveParams_Form(Save_Entity, "Save", BaseForm, Privileges);
                Save_Form.StartPosition = FormStartPosition.CenterScreen;
                Save_Form.ShowDialog();
            }
        }

        private void btnGetParameters_Click(object sender, EventArgs e)
        {
            ControlCard_Entity Save_Entity = new ControlCard_Entity(true);
            Save_Entity.Scr_Code = Privileges.Program;
            Save_Entity.UserID = BaseForm.UserID;
            Save_Entity.Module = BaseForm.BusinessModuleID;
            Report_Get_SaveParams_Form Save_Form = new Report_Get_SaveParams_Form(Save_Entity, "Get");
            Save_Form.FormClosed += new FormClosedEventHandler(Get_Saved_Parameters);
            Save_Form.StartPosition = FormStartPosition.CenterScreen;
            Save_Form.ShowDialog();
        }

        private void Get_Saved_Parameters(object sender, FormClosedEventArgs e)
        {
            Report_Get_SaveParams_Form form = sender as Report_Get_SaveParams_Form;
            string[] Saved_Parameters = new string[2];
            Saved_Parameters[0] = Saved_Parameters[1] = string.Empty;

            if (form.DialogResult == DialogResult.OK)
            {
                DataTable RepCntl_Table = new DataTable();
                Saved_Parameters = form.Get_Adhoc_Saved_Parameters();

                RepCntl_Table = CommonFunctions.Convert_XMLstring_To_Datatable(Saved_Parameters[0]);
                Set_Report_Controls(RepCntl_Table);

            }
        }

        private string Get_XML_Format_for_Report_Controls()
        {
            string Report = ((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString();
            //string Seq = ((Captain.Common.Utilities.ListItem)cmbSeq.SelectedItem).Value.ToString();

            //string strSite = rdoAllSite.Checked == true ? "A" : "M";
            //string strFundSource = string.Empty;
            //string strenrl = string.Empty; string Pick = txtDesc.Text;
            //strenrl = ((Captain.Common.Utilities.ListItem)cmbEntlStat.SelectedItem).Value.ToString();

            //string strBaseAge = rdoTodayDate.Checked ? "T" : "K";
            //string Repeaters = string.Empty;
            //if (rbBoth.Checked) Repeaters = "B"; else if (rbRepeaters.Checked) Repeaters = "R"; else if (rbNonRepeat.Checked) Repeaters = "N";
            //string labels = rbNoLbl.Checked ? "N" : "M";
            //string PrintLbls = rbParent.Checked ? "P" : "C";

            //if (rbFundAll.Checked) strFundSource = "A"; else if (rbFundSel.Checked) strFundSource = "P";
            //string strsiteRoomNames = string.Empty;
            //if (rdoMultipleSites.Checked == true)
            //{
            //    foreach (CaseSiteEntity siteRoom in Sel_REFS_List)
            //    {
            //        if (!strsiteRoomNames.Equals(string.Empty)) strsiteRoomNames += ",";
            //        strsiteRoomNames += siteRoom.SiteNUMBER + siteRoom.SiteROOM + siteRoom.SiteAM_PM;
            //    }
            //}


            //string strFundingCodes = string.Empty;
            //if (rbFundSel.Checked == true)
            //{
            //    foreach (CommonEntity FundingCode in SelFundingList)
            //    {
            //        if (!strFundingCodes.Equals(string.Empty)) strFundingCodes += ",";
            //        strFundingCodes += FundingCode.Code;
            //    }
            //}

            string Mst_Site = "**";
            if (Rb_Site_Sel.Checked)
                Mst_Site = Get_Sel_Sites();
            else if (Rb_Site_No.Checked)
                Mst_Site = "NO";

            StringBuilder str = new StringBuilder();
            str.Append("<Rows>");
            str.Append("<Row AGENCY = \"" + Agency + "\" DEPT = \"" + Depart + "\" PROG = \"" + Program +
                            "\" YEAR = \"" + Program_Year + "\" ReportType = \"" + Report + "\" RefFDate = \"" + Ref_From_Date.Value.Date + "\" RefTDate = \"" + Ref_To_Date.Value.Date +
                             "\" RepFDate = \"" + dtpFrom.Value.Date + "\" RepTDate = \"" + dtpTo.Value.Date + "\" SITE = \"" + Mst_Site +  "\"  />");
            str.Append("</Rows>");

            return str.ToString();
        }

        List<CaseSiteEntity> Site_List = new List<CaseSiteEntity>();
        private void Set_Report_Controls(DataTable Tmp_Table)
        {
            if (Tmp_Table != null && Tmp_Table.Rows.Count > 0)
            {
                DataRow dr = Tmp_Table.Rows[0];

                Set_Report_Hierarchy(dr["AGENCY"].ToString(), dr["DEPT"].ToString(), dr["PROG"].ToString(), dr["YEAR"].ToString());

                CommonFunctions.SetComboBoxValue(cmbSSBG, dr["ReportType"].ToString());

                Ref_From_Date.Value = Convert.ToDateTime(dr["RefFDate"]);
                Ref_To_Date.Value = Convert.ToDateTime(dr["RefTDate"]);
                dtpFrom.Value = Convert.ToDateTime(dr["RepFDate"]);
                dtpTo.Value = Convert.ToDateTime(dr["RepTDate"]);

                Txt_Sel_Site.Clear();
                switch (dr["SITE"].ToString())
                {
                    case "**": Rb_Site_All.Checked = true; break;
                    case "NO": Rb_Site_No.Checked = true; break;
                    default:
                        Rb_Site_Sel.Checked = true; Txt_Sel_Site.Text = dr["SITE"].ToString();
                        Site_List = _model.CaseMstData.GetCaseSite(Current_Hierarchy.Substring(0, 2), Current_Hierarchy.Substring(2, 2), Current_Hierarchy.Substring(4, 2), "SiteHie");
                        ListcaseSiteEntity.Clear();
                        foreach (CaseSiteEntity casesite in Site_List) //Site_List)//ListcaseSiteEntity)
                        {
                            if (Txt_Sel_Site.Text.Contains(casesite.SiteNUMBER))
                                ListcaseSiteEntity.Add(casesite);
                            // Sel_Site_Codes += "'" + casesite.SiteNUMBER + "' ,";
                        }


                        break;
                }

            }
        }

        private void Pb_Search_Hie_Click(object sender, EventArgs e)
        {
            /*HierarchieSelectionFormNew hierarchieSelectionForm = new HierarchieSelectionFormNew(BaseForm, Current_Hierarchy_DB, "Master", "A", "*", "Reports");
             hierarchieSelectionForm.FormClosed += new FormClosedEventHandler(OnHierarchieFormClosed);
             hierarchieSelectionForm.ShowDialog();*/

            HierarchieSelection hierarchieSelectionForm = new HierarchieSelection(BaseForm, Current_Hierarchy_DB, "Master", "A", "*", "Reports", BaseForm.UserID);
            hierarchieSelectionForm.FormClosed += new FormClosedEventHandler(OnHierarchieFormClosed);
            hierarchieSelectionForm.StartPosition = FormStartPosition.CenterScreen;
            hierarchieSelectionForm.ShowDialog();
        }

        string Current_Hierarchy = "******", Current_Hierarchy_DB = "**-**-**";
        private void OnHierarchieFormClosed(object sender, FormClosedEventArgs e)
        {
            HierarchieSelection form = sender as HierarchieSelection;

            if (form.DialogResult == DialogResult.OK)
            {
                List<HierarchyEntity> selectedHierarchies = form.SelectedHierarchies;
                string hierarchy = string.Empty;

                if (selectedHierarchies.Count > 0)
                {
                    foreach (HierarchyEntity row in selectedHierarchies)
                    {
                        hierarchy += (string.IsNullOrEmpty(row.Agency) ? "**" : row.Agency) + (string.IsNullOrEmpty(row.Dept) ? "**" : row.Dept) + (string.IsNullOrEmpty(row.Prog) ? "**" : row.Prog);
                    }
                    //Current_Hierarchy = hierarchy.Substring(0, 2) + "-" + hierarchy.Substring(2, 2) + "-" + hierarchy.Substring(4, 2);

                    Set_Report_Hierarchy(hierarchy.Substring(0, 2), hierarchy.Substring(2, 2), hierarchy.Substring(4, 2), string.Empty);
                    Agency = hierarchy.Substring(0, 2);
                    Depart = hierarchy.Substring(2, 2);
                    Program = hierarchy.Substring(4, 2);

                    FillCombo();

                }

            }
        }

        private void cmbSSBG_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (cmbSSBG.Items.Count > 0)
            {
                SSBGPARAMEntity SelSSBG = SSBGParamall.Find(u => ((u.SSBGSeq).Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString())));

                if (SelSSBG != null)
                {
                    txtDesc.Text = "Grant Period : " + LookupDataAccess.Getdate(SelSSBG.SSBGGPFrom.Trim()) + " To " + LookupDataAccess.Getdate(SelSSBG.SSBGGPTo.Trim()) + "\n" + "Total Budget : " + SelSSBG.SSBGBudget.Trim() + "\n" + "Total Grant Award: " + SelSSBG.SSBGAward.ToString(); ;
                    Ref_From_Date.Value = Convert.ToDateTime(SelSSBG.SSBGGPFrom.Trim()); Ref_To_Date.Value = Convert.ToDateTime(SelSSBG.SSBGGPTo.Trim());

                    FillDemoCount(SelSSBG);
                }
            }
        }

        private DataTable CreateTable(List<SSBGTYPESEntity> SSBGQues)
        {
            try
            {
                DataTable table = new DataTable();

                DataColumn column;

                // Create new DataColumn, set DataType, ColumnName
                // and add to DataTable.    
                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "RowID";
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "Type";
                table.Columns.Add(column);

                // Create second column.
                column = new DataColumn();
                column.DataType = Type.GetType("System.String");
                column.ColumnName = "TypeDesc";
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "AppNo";
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "FamSeq";
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "Name";
                table.Columns.Add(column);

                if (SSBGQues.Count > 0)
                {
                    SSBGQues = SSBGQues.OrderBy(u => u.SBGTQuesCode.Trim()).ToList();
                    foreach (SSBGTYPESEntity item in SSBGQues)
                    {
                        //string QuesName = SSBGTypesQues.Find(u => u.SBGTQuesCode.Equals(item)).EligQuestionDesc.ToString();
                        column = new DataColumn();
                        column.DataType = System.Type.GetType("System.String");
                        column.ColumnName = item.EligQuestionDesc;
                        table.Columns.Add(column);

                        column = new DataColumn();
                        column.DataType = System.Type.GetType("System.String");
                        column.ColumnName = "ByPass" + item.EligQuestionDesc.Replace(' ','_');
                        table.Columns.Add(column);

                        column = new DataColumn();
                        column.DataType = System.Type.GetType("System.String");
                        column.ColumnName = "Yeartodate" + item.EligQuestionDesc.Replace(' ', '_');
                        table.Columns.Add(column);
                    }

                }

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "IntakeDate";
                table.Columns.Add(column);

                column = new DataColumn("ReportPeriod", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                //column.ColumnName = "Report Period";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn("ReferencePeriod", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                //column.ColumnName = "Reference Period";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "ContactDate";
                table.Columns.Add(column);

                column = new DataColumn("ReportPeriod", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "CReportPeriod";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn("ReferencePeriod", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "CReferencePeriod";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "DupContDate";
                table.Columns.Add(column);

                column = new DataColumn("ReportPeriod", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "CDReportPeriod";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn("ReferencePeriod", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "CDReferencePeriod";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "ActDate";
                table.Columns.Add(column);

                column = new DataColumn("ReportPeriod", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "AReportPeriod";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn("ReferencePeriod", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "AReferencePeriod";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "DupActDate";
                table.Columns.Add(column);

                column = new DataColumn("ReportPeriod", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "ADReportPeriod";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn("ReferencePeriod", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "ADReferencePeriod";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "SPMStartDate";
                table.Columns.Add(column);

                column = new DataColumn("ReportPeriod", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "SReportPeriod";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn("ReferencePeriod", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "SReferencePeriod";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "DUPSPMStartDate";
                table.Columns.Add(column);

                column = new DataColumn("ReportPeriod", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "SDReportPeriod";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn("ReferencePeriod", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "SDReferencePeriod";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "QIntakeDate";
                table.Columns.Add(column);

                column = new DataColumn("ReportPeriod", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "QReportPeriod";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn("ReferencePeriod", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "QReferencePeriod";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                return table;
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }
        }

        public DataTable CreationDatatable(List<SSBGAssnsEntity> SSBGSelAssns,List<SSBGSerPlanEntity> SSBGSelSPs,string CountType,string CountType2)
        {
            try
            {
                DataTable table = new DataTable();

                DataColumn column;

                // Create new DataColumn, set DataType, ColumnName
                // and add to DataTable.    

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "GoalCd";
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "ObjCd";
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "Goal";
                table.Columns.Add(column);

                // Create second column.
                column = new DataColumn();
                column.DataType = Type.GetType("System.String");
                column.ColumnName = "Objective";
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = Type.GetType("System.String");
                column.ColumnName = "Type";
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = Type.GetType("System.String");
                column.ColumnName = "Type2";
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "AppNo";
                table.Columns.Add(column);

                //column = new DataColumn();
                //column.DataType = System.Type.GetType("System.String");
                //column.ColumnName = "FamSeq";
                //table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "Name";
                table.Columns.Add(column);

                if (CountType == "S" || CountType == "C" || CountType2 == "S" || CountType2 == "C")
                {
                    if (SSBGSelSPs.Count > 0)
                    {
                        var SelAssns = SSBGSelSPs.Select(u => u.SBSPSerPlan.Trim()).Distinct().ToList();
                        foreach (var item in SelAssns)
                        {
                            //string QuesName = SSBGTypesQues.Find(u => u.SBGTQuesCode.Equals(item)).EligQuestionDesc.ToString();
                            column = new DataColumn();
                            column.DataType = System.Type.GetType("System.String");
                            column.ColumnName = item.ToString();
                            table.Columns.Add(column);

                            column = new DataColumn();
                            //column.DataType = System.Type.GetType("System.String");
                            //column.ColumnName = "ByPass" + item.EligQuestionDesc.Replace(' ', '_');
                            //table.Columns.Add(column);

                            //column = new DataColumn();
                            //column.DataType = System.Type.GetType("System.String");
                            //column.ColumnName = "Yeartodate" + item.EligQuestionDesc.Replace(' ', '_');
                            //table.Columns.Add(column);
                        }
                    }
                }
                else
                {
                    if (SSBGSelAssns.Count > 0)
                    {

                        SSBGSelAssns = SSBGSelAssns.OrderBy(u => u.SBAS_CAMS_Type.Trim()).ThenBy(u => u.SBAS_CAMS_Code.Trim()).ToList();
                        var SelAssns = SSBGSelAssns.Select(u => u.SBAS_CAMS_Code.Trim()).Distinct().ToList();
                        foreach (var item in SelAssns)
                        {
                            //string QuesName = SSBGTypesQues.Find(u => u.SBGTQuesCode.Equals(item)).EligQuestionDesc.ToString();
                            column = new DataColumn();
                            column.DataType = System.Type.GetType("System.String");
                            column.ColumnName = item.ToString();
                            table.Columns.Add(column);

                            column = new DataColumn();
                            //column.DataType = System.Type.GetType("System.String");
                            //column.ColumnName = "ByPass" + item.EligQuestionDesc.Replace(' ', '_');
                            //table.Columns.Add(column);

                            //column = new DataColumn();
                            //column.DataType = System.Type.GetType("System.String");
                            //column.ColumnName = "Yeartodate" + item.EligQuestionDesc.Replace(' ', '_');
                            //table.Columns.Add(column);
                        }

                    }
                }

                column = new DataColumn("Access", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                //column.ColumnName = "Report Period";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn("YeartoDate", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                //column.ColumnName = "Reference Period";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                column = new DataColumn();
                column.DataType = System.Type.GetType("System.String");
                column.ColumnName = "Seek";
                table.Columns.Add(column);

                column = new DataColumn("YeartoDateSeek", typeof(int));
                //column.DataType = System.Type.GetType("System.String");
                //column.ColumnName = "Reference Period";
                column.AllowDBNull = true;
                table.Columns.Add(column);

                


                return table;
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message);
            }

        }

        #region ExcelReportFormat

        string Random_Filename = null; string PdfName = "Pdf File";

        #region Old Excel formats
        //private void OnExcel_Report1(object sender, FormClosedEventArgs e)
        //{
        //    PdfListForm form = sender as PdfListForm;
        //    if (form.DialogResult == DialogResult.OK)
        //    {
        //        string PdfName = "Pdf File";
        //        PdfName = form.GetFileName();
        //        //PdfName = strFolderPath + PdfName;
        //        PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
        //        try
        //        {
        //            if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
        //            { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
        //        }
        //        catch (Exception ex)
        //        {
        //            CommonFunctions.MessageBoxDisplay("Error");
        //        }

        //        try
        //        {
        //            string Tmpstr = PdfName + ".xls";
        //            if (File.Exists(Tmpstr))
        //                File.Delete(Tmpstr);
        //        }
        //        catch (Exception ex)
        //        {
        //            int length = 8;
        //            string newFileName = System.Guid.NewGuid().ToString();
        //            newFileName = newFileName.Replace("-", string.Empty);

        //            Random_Filename = PdfName + newFileName.Substring(0, length) + ".xls";
        //        }

        //        if (!string.IsNullOrEmpty(Random_Filename))
        //            PdfName = Random_Filename;
        //        else
        //            PdfName += ".xls";


        //        Workbook book = new Workbook();

        //        this.GenerateStyles(book.Styles);

        //        Worksheet sheet = book.Worksheets.Add("Sheet1");
        //        sheet.Table.DefaultRowHeight = 14.25F;

        //        //sheet.Table.Columns.Add(new WorksheetColumn(70));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(45));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(50));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(50));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(40));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(50));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(50));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(60));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(40));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(40));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(40));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(55));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(55));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(55));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(55));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(50));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(50));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(50));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(50));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(50));
        //        //sheet.Table.Columns.Add(new WorksheetColumn(50));

        //        sheet.Table.StyleID = "s16";
        //        WorksheetColumn column0 = sheet.Table.Columns.Add();
        //        column0.Width = 88;
        //        column0.StyleID = "s16";
        //        WorksheetColumn column1 = sheet.Table.Columns.Add();
        //        column1.Width = 36;
        //        column1.StyleID = "s16";
        //        WorksheetColumn column2 = sheet.Table.Columns.Add();
        //        column2.Width = 55;
        //        column2.StyleID = "s16";
        //        WorksheetColumn column3 = sheet.Table.Columns.Add();
        //        column3.Width = 60;
        //        column3.StyleID = "s16";
        //        WorksheetColumn column4 = sheet.Table.Columns.Add();
        //        column4.Width = 36;
        //        column4.StyleID = "s16";
        //        //WorksheetColumn column5 = sheet.Table.Columns.Add();
        //        //column5.Width = 0;
        //        //column5.StyleID = "s16";
        //        WorksheetColumn column6 = sheet.Table.Columns.Add();
        //        column6.Width = 49;
        //        column6.StyleID = "s16";
        //        WorksheetColumn column7 = sheet.Table.Columns.Add();
        //        column7.Width = 60;
        //        column7.StyleID = "s16";
        //        WorksheetColumn column8 = sheet.Table.Columns.Add();
        //        column8.Width = 62;
        //        column8.StyleID = "s16";
        //        WorksheetColumn column9 = sheet.Table.Columns.Add();
        //        column9.Width = 33;
        //        column9.StyleID = "s16";
        //        WorksheetColumn column10 = sheet.Table.Columns.Add();
        //        column10.Width = 34;
        //        column10.StyleID = "s16";
        //        WorksheetColumn column11 = sheet.Table.Columns.Add();
        //        column11.Width = 29;
        //        column11.StyleID = "s16";
        //        WorksheetColumn column12 = sheet.Table.Columns.Add();
        //        column12.Width = 32;
        //        column12.StyleID = "s16";
        //        WorksheetColumn column13 = sheet.Table.Columns.Add();
        //        column13.Width = 33;
        //        column13.StyleID = "s16";
        //        WorksheetColumn column14 = sheet.Table.Columns.Add();
        //        column14.Width = 37;
        //        column14.StyleID = "s16";
        //        WorksheetColumn column15 = sheet.Table.Columns.Add();
        //        column15.Width = 39;
        //        column15.StyleID = "s16";
        //        WorksheetColumn column16 = sheet.Table.Columns.Add();
        //        column16.Width = 43;
        //        column16.StyleID = "s16";
        //        WorksheetColumn column17 = sheet.Table.Columns.Add();
        //        column17.Width = 49;
        //        column17.StyleID = "s16";
        //        column17.Span = 1;
        //        WorksheetColumn column18 = sheet.Table.Columns.Add();
        //        column18.Index = 20;
        //        column18.Width = 42;
        //        column18.StyleID = "s16";
        //        WorksheetColumn column19 = sheet.Table.Columns.Add();
        //        column19.Width = 77;
        //        column19.StyleID = "s16";
        //        WorksheetColumn column20 = sheet.Table.Columns.Add();
        //        column20.Width = 47;
        //        column20.StyleID = "s16";
        //        WorksheetColumn column21 = sheet.Table.Columns.Add();
        //        column21.Index = 24;
        //        column21.Width = 60;
        //        column21.StyleID = "s16";



        //        WorksheetStyle style11 = book.Styles.Add("HeaderStyles");
        //        style11.Font.FontName = "Tahoma";
        //        style11.Font.Size = 10;
        //        style11.Interior.Color = "Gray";
        //        style11.Interior.Pattern = StyleInteriorPattern.Solid;
        //        style11.Font.Bold = true;
        //        style11.Alignment.Horizontal = StyleHorizontalAlignment.Center;
        //        style11.Alignment.WrapText = true;

        //        WorksheetStyle style2 = book.Styles.Add("HeaderStyle");
        //        style2.Font.FontName = "Tahoma";
        //        style2.Font.Size = 10;
        //        style2.Font.Bold = true;
        //        style2.Interior.Color = "Gray";
        //        style2.Interior.Pattern = StyleInteriorPattern.Solid;
        //        style2.Alignment.Horizontal = StyleHorizontalAlignment.Left;
        //        style2.Alignment.WrapText = true;

        //        WorksheetStyle style5 = book.Styles.Add("HeaderStyleRight");
        //        style5.Font.FontName = "Tahoma";
        //        style5.Font.Size = 10;
        //        style5.Font.Bold = true;
        //        style5.Interior.Color = "Gray";
        //        style5.Interior.Pattern = StyleInteriorPattern.Solid;
        //        style5.Alignment.Horizontal = StyleHorizontalAlignment.Right;
        //        style5.Alignment.WrapText = true;

        //        WorksheetStyle style1 = book.Styles.Add("Normal");
        //        style1.Font.FontName = "Tahoma";
        //        style1.Font.Size = 10;
        //        style1.Alignment.Horizontal = StyleHorizontalAlignment.Left;
        //        style1.Alignment.WrapText = true;

        //        WorksheetStyle style3 = book.Styles.Add("NormalRight");
        //        style3.Font.FontName = "Tahoma";
        //        style3.Font.Size = 10;
        //        style3.Alignment.Horizontal = StyleHorizontalAlignment.Right;
        //        style3.Alignment.WrapText = true;


        //        //style = book.Styles.Add("Default");
        //        //style.Font.FontName = "Tahoma";
        //        //style.Font.Size = 10;

        //        try
        //        {
        //            string data = string.Empty;
        //            if (cmbSSBG.Items.Count > 0)
        //            {
        //                SSBGPARAMEntity SelSSBG = SSBGParamall.Find(u => ((u.SSBGSeq).Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString())));
        //                List<SSBGTYPESEntity> SelSSBGTypes = SSBGTypesall.FindAll(u => u.SBGTID.Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString()) && u.SBGTCodeSeq.Equals("0"));

        //                if (SelSSBG != null)
        //                {
        //                    WorksheetRow row = sheet.Table.Rows.Add();

        //                    WorksheetCell cell = row.Cells.Add("Social Services Block Grant (SSBG) Case Management", DataType.String, "HeaderStyle");
        //                    cell.MergeAcross = 4;


        //                    string RepMonths = string.Empty;
        //                    var diffMonths = (dtpTo.Value.Month + dtpTo.Value.Year * 12) - (dtpFrom.Value.Month + dtpFrom.Value.Year * 12);
        //                    if (diffMonths > 1) RepMonths = "(" + diffMonths + " Months)"; else RepMonths = "(" + diffMonths + " Month)";

        //                    WorksheetCell cell1 = row.Cells.Add("Reporting Period: " + LookupDataAccess.GetMonthNameDate(dtpFrom.Text.ToString()) + " -" + LookupDataAccess.GetMonthNameDate(dtpTo.Text.ToString()) + "  " + RepMonths, DataType.String, "HeaderStyles");
        //                    cell1.MergeAcross = 5;

        //                    WorksheetCell cell2 = row.Cells.Add("Budget: $" + Convert.ToDouble(SelSSBG.SSBGBudget.Trim()).ToString("N", CultureInfo.InvariantCulture), DataType.String, "HeaderStyle");
        //                    cell2.MergeAcross = 3;

        //                    WorksheetCell cell3 = row.Cells.Add("", DataType.String, "HeaderStyle");
        //                    cell3.MergeAcross = 5;

        //                    row = sheet.Table.Rows.Add();

        //                    WorksheetCell cell4 = row.Cells.Add("", DataType.String, "HeaderStyle");
        //                    cell4.MergeAcross = 4;

        //                    diffMonths = (Convert.ToDateTime(SelSSBG.SSBGGPTo).Month + Convert.ToDateTime(SelSSBG.SSBGGPTo).Year * 12) - (Convert.ToDateTime(SelSSBG.SSBGGPFrom).Month + Convert.ToDateTime(SelSSBG.SSBGGPFrom).Year * 12);
        //                    if (diffMonths > 1) RepMonths = "(" + diffMonths + " Months)"; else RepMonths = "(" + diffMonths + " Month)";
        //                    WorksheetCell cell5 = row.Cells.Add("Grant Period: " + LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPFrom.ToString()) + " -" + LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPTo.ToString()) + "  " + RepMonths, DataType.String, "HeaderStyles");
        //                    cell5.MergeAcross = 5;

        //                    WorksheetCell cell6 = row.Cells.Add("Total Grant Award: $" + Convert.ToDouble(SelSSBG.SSBGAward.Trim()).ToString("N", CultureInfo.InvariantCulture), DataType.String, "HeaderStyle");
        //                    cell6.MergeAcross = 3;

        //                    WorksheetCell cell7 = row.Cells.Add("Date of Reporting: " + DateTime.Now.ToShortDateString(), DataType.String, "HeaderStyle");
        //                    cell7.MergeAcross = 5;

        //                    data = "Program Description:  SSBG Individuals: Service intervention and case management for single individuals with incomes that fall at or below 150% of the federal poverty level. SSBG/TANF Families: indivduals/families with income at or below 200% of the federal poverty level with one child under the age of 18 in their household.";

        //                    row = sheet.Table.Rows.Add();

        //                    WorksheetCell R3Cell = row.Cells.Add(data, DataType.String, "Normal");
        //                    R3Cell.MergeAcross = 20;

        //                    row = sheet.Table.Rows.Add();

        //                    WorksheetCell R4cell = row.Cells.Add("Program Utilization - N = 780", DataType.String, "HeaderStyles");
        //                    R4cell.MergeAcross = 20;

        //                    row = sheet.Table.Rows.Add();

        //                    row.Cells.Add("Type", DataType.String, "Normal");

        //                    WorksheetCell R5Cell = row.Cells.Add("Contract Obligation", DataType.String, "Normal");
        //                    R5Cell.MergeAcross = 1;

        //                    row.Cells.Add("# Served Current Month", DataType.String, "Normal");

        //                    WorksheetCell R5Cell1 = row.Cells.Add("# Served Year to Date", DataType.String, "Normal");
        //                    R5Cell1.MergeAcross = 1;

        //                    row.Cells.Add("% Served to Date", DataType.String, "Normal");

        //                    row.Cells.Add("Obligation Outcomes", DataType.String, "HeaderStyle");

        //                    WorksheetCell R5Cell2 = row.Cells.Add("", DataType.String, "HeaderStyle");
        //                    R5Cell2.MergeAcross = 2;

        //                    WorksheetCell R5Cell3 = row.Cells.Add("# of Service Interventions", DataType.String, "Normal");
        //                    R5Cell3.MergeAcross = 3;

        //                    WorksheetCell R5Cell4 = row.Cells.Add("Unduplicated Number of Customers Engaged in Case Management", DataType.String, "Normal");
        //                    R5Cell4.MergeAcross = 5;

        //                    row = sheet.Table.Rows.Add();

        //                    row.Cells.Add("", DataType.String, "Normal");

        //                    WorksheetCell R6Cell = row.Cells.Add("", DataType.String, "Normal");
        //                    R6Cell.MergeAcross = 1;

        //                    row.Cells.Add("", DataType.String, "Normal");

        //                    WorksheetCell R6Cell1 = row.Cells.Add("", DataType.String, "Normal");
        //                    R6Cell1.MergeAcross = 1;

        //                    row.Cells.Add("", DataType.String, "Normal");

        //                    row.Cells.Add(" = YES", DataType.String, "HeaderStyle");

        //                    WorksheetCell R6Cell2 = row.Cells.Add("", DataType.String, "HeaderStyle");
        //                    R6Cell2.MergeAcross = 2;

        //                    WorksheetCell R6Cell3 = row.Cells.Add("Current Month", DataType.String, "Normal");
        //                    R6Cell3.MergeAcross = 1;

        //                    WorksheetCell R6Cell4 = row.Cells.Add("Year to Date", DataType.String, "Normal");
        //                    R6Cell4.MergeAcross = 1;

        //                    WorksheetCell R6Cell5 = row.Cells.Add("Current Month", DataType.String, "Normal");
        //                    R6Cell5.MergeAcross = 2;

        //                    WorksheetCell R6Cell6 = row.Cells.Add("Year to Date", DataType.String, "Normal");
        //                    R6Cell6.MergeAcross = 2;

        //                    if (SelSSBGTypes.Count > 0)
        //                    {
        //                        float TotCntlOblig = 0;
        //                        foreach (SSBGTYPESEntity Entity in SelSSBGTypes)
        //                        {
        //                            row = sheet.Table.Rows.Add();

        //                            row.Cells.Add(Entity.SBGTDesc, DataType.String, "Normal");

        //                            WorksheetCell R6C1 = row.Cells.Add(Entity.SBGTCntlOblig, DataType.String, "NormalRight");
        //                            R6C1.MergeAcross = 1;

        //                            row.Cells.Add("", DataType.String, "NormalRight");

        //                            WorksheetCell R6C2 = row.Cells.Add("", DataType.String, "NormalRight");
        //                            R6C2.MergeAcross = 1;

        //                            row.Cells.Add("0%", DataType.String, "NormalRight");

        //                            row.Cells.Add("0.00", DataType.String, "HeaderStyleRight");

        //                            WorksheetCell R6C3 = row.Cells.Add("", DataType.String, "HeaderStyleRight");
        //                            R6C3.MergeAcross = 2;

        //                            WorksheetCell R6C4 = row.Cells.Add("", DataType.String, "NormalRight");
        //                            R6C4.MergeAcross = 1;

        //                            WorksheetCell R6C5 = row.Cells.Add("", DataType.String, "NormalRight");
        //                            R6C5.MergeAcross = 1;

        //                            WorksheetCell R6C6 = row.Cells.Add("", DataType.String, "NormalRight");
        //                            R6C6.MergeAcross = 2;

        //                            WorksheetCell R6C7 = row.Cells.Add("", DataType.String, "NormalRight");
        //                            R6C7.MergeAcross = 2;

        //                            TotCntlOblig = int.Parse(Entity.SBGTCntlOblig.Trim());
        //                        }

        //                        row = sheet.Table.Rows.Add();

        //                        row.Cells.Add("Total:", DataType.String, "Normal");

        //                        WorksheetCell R6T1 = row.Cells.Add(TotCntlOblig.ToString(), DataType.String, "Normal");
        //                        R6T1.MergeAcross = 1;

        //                        row.Cells.Add("", DataType.String, "NormalRight");

        //                        WorksheetCell R6T2 = row.Cells.Add("", DataType.String, "NormalRight");
        //                        R6T2.MergeAcross = 1;

        //                        row.Cells.Add("0%", DataType.String, "NormalRight");

        //                        row.Cells.Add("0.00", DataType.String, "HeaderStyleRight");

        //                        WorksheetCell R6T3 = row.Cells.Add("", DataType.String, "HeaderStyleRight");
        //                        R6T3.MergeAcross = 2;

        //                        WorksheetCell R6T4 = row.Cells.Add("0", DataType.String, "NormalRight");
        //                        R6T4.MergeAcross = 1;

        //                        WorksheetCell R6T5 = row.Cells.Add("0", DataType.String, "NormalRight");
        //                        R6T5.MergeAcross = 1;

        //                        WorksheetCell R6T6 = row.Cells.Add("0", DataType.String, "NormalRight");
        //                        R6T6.MergeAcross = 2;

        //                        WorksheetCell R6T7 = row.Cells.Add("0", DataType.String, "NormalRight");
        //                        R6T7.MergeAcross = 2;
        //                    }

        //                    row = sheet.Table.Rows.Add();
        //                    data = "Contractual/Funder Requirements Contractual/Funder Requirements as Outlined in Contract , as of 1 April 2016 for period covering 01 May- 31 May 2016.";
        //                    WorksheetCell RCell = row.Cells.Add(data, DataType.String, "HeaderStyle");
        //                    RCell.MergeAcross = 20;
        //                }
        //            }

        //            FileStream stream = new FileStream(PdfName, FileMode.Create);

        //            book.Save(stream);
        //            stream.Close();

        //        }
        //        catch (Exception ex) { }

        //    }
        //}

        //private void OnExcel_Report(object sender, FormClosedEventArgs e)
        //{
        //    PdfListForm form = sender as PdfListForm;
        //    if (form.DialogResult == DialogResult.OK)
        //    {
        //        string PdfName = "Pdf File";
        //        PdfName = form.GetFileName();
        //        string AuditName = PdfName;
        //        //PdfName = strFolderPath + PdfName;
        //        PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
        //        try
        //        {
        //            if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
        //            { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
        //        }
        //        catch (Exception ex)
        //        {
        //            CommonFunctions.MessageBoxDisplay("Error");
        //        }

        //        try
        //        {
        //            string Tmpstr = PdfName + ".xls";
        //            if (File.Exists(Tmpstr))
        //                File.Delete(Tmpstr);
        //        }
        //        catch (Exception ex)
        //        {
        //            int length = 8;
        //            string newFileName = System.Guid.NewGuid().ToString();
        //            newFileName = newFileName.Replace("-", string.Empty);

        //            Random_Filename = PdfName + newFileName.Substring(0, length) + ".xls";
        //        }

        //        if (!string.IsNullOrEmpty(Random_Filename))
        //            PdfName = Random_Filename;
        //        else
        //            PdfName += ".xls";

        //        TableCnt = 1;
        //        Workbook book = new Workbook();

        //        this.GenerateStyles(book.Styles);

        //        Worksheet sheet = book.Worksheets.Add("Sheet1");
        //        sheet.Table.DefaultRowHeight = 14.25F;

        //        sheet.Table.StyleID = "s16";
        //        WorksheetColumn column0 = sheet.Table.Columns.Add();
        //        column0.Width = 88;
        //        column0.StyleID = "s16";
        //        WorksheetColumn column1 = sheet.Table.Columns.Add();
        //        column1.Width = 36;
        //        column1.StyleID = "s16";
        //        WorksheetColumn column2 = sheet.Table.Columns.Add();
        //        column2.Width = 55;
        //        column2.StyleID = "s16";
        //        WorksheetColumn column3 = sheet.Table.Columns.Add();
        //        column3.Width = 60;
        //        column3.StyleID = "s16";
        //        WorksheetColumn column4 = sheet.Table.Columns.Add();
        //        column4.Width = 36;
        //        column4.StyleID = "s16";
        //        //WorksheetColumn column5 = sheet.Table.Columns.Add();
        //        //column5.Width = 0;
        //        //column5.StyleID = "s16";
        //        WorksheetColumn column6 = sheet.Table.Columns.Add();
        //        column6.Width = 50;
        //        column6.StyleID = "s16";
        //        WorksheetColumn column7 = sheet.Table.Columns.Add();
        //        column7.Width = 60;
        //        column7.StyleID = "s16";
        //        WorksheetColumn column8 = sheet.Table.Columns.Add();
        //        column8.Width = 65;
        //        column8.StyleID = "s16";
        //        WorksheetColumn column9 = sheet.Table.Columns.Add();
        //        column9.Width = 35;
        //        column9.StyleID = "s16";
        //        WorksheetColumn column10 = sheet.Table.Columns.Add();
        //        column10.Width = 35;
        //        column10.StyleID = "s16";
        //        WorksheetColumn column11 = sheet.Table.Columns.Add();
        //        column11.Width = 30;
        //        column11.StyleID = "s16";
        //        WorksheetColumn column12 = sheet.Table.Columns.Add();
        //        column12.Width = 32;
        //        column12.StyleID = "s16";
        //        WorksheetColumn column13 = sheet.Table.Columns.Add();
        //        column13.Width = 33;
        //        column13.StyleID = "s16";
        //        WorksheetColumn column14 = sheet.Table.Columns.Add();
        //        column14.Width = 37;
        //        column14.StyleID = "s16";
        //        WorksheetColumn column15 = sheet.Table.Columns.Add();
        //        column15.Width = 39;
        //        column15.StyleID = "s16";
        //        WorksheetColumn column16 = sheet.Table.Columns.Add();
        //        column16.Width = 45;
        //        column16.StyleID = "s16";
        //        WorksheetColumn column17 = sheet.Table.Columns.Add();
        //        column17.Width = 50;
        //        column17.StyleID = "s16";
        //        column17.Span = 1;
        //        WorksheetColumn column18 = sheet.Table.Columns.Add();
        //        column18.Index = 20;
        //        column18.Width = 42;
        //        column18.StyleID = "s16";
        //        WorksheetColumn column19 = sheet.Table.Columns.Add();
        //        column19.Width = 77;
        //        column19.StyleID = "s16";
        //        WorksheetColumn column20 = sheet.Table.Columns.Add();
        //        column20.Width = 47;
        //        column20.StyleID = "s16";
        //        WorksheetColumn column21 = sheet.Table.Columns.Add();
        //        column21.Index = 24;
        //        column21.Width = 60;
        //        column21.StyleID = "s16";


        //        try
        //        {

        //            string data = string.Empty;
        //            if (cmbSSBG.Items.Count > 0)
        //            {
        //                SSBGPARAMEntity SelSSBG = SSBGParamall.Find(u => ((u.SSBGSeq).Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString())));
        //                List<SSBGTYPESEntity> SelSSBGTypes = SSBGTypesall.FindAll(u => u.SBGTID.Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString()) && u.SBGTCodeSeq.Equals("0"));
        //                List<SSBGGOALSEntity> SSBGGoals = SSBGGoalsall.FindAll(u => u.SBGGID.Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString()));
        //                //List<SSBGAssnsEntity> SSBGCAMS_List = _model.CaseSumData.Browse_SSBGAssns(string.Empty, string.Empty, string.Empty, string.Empty, string.Empty);

        //                //CreationDatatable(SelSSBGTypes);

        //                if (SelSSBG != null)
        //                {
        //                    WorksheetRow row = sheet.Table.Rows.Add();
        //                    row.Height = 47;
        //                    row.AutoFitHeight = false;

        //                    WorksheetCell cell = row.Cells.Add("Social Services Block Grant (SSBG) Case Management", DataType.String, "m106944544");
        //                    cell.MergeAcross = 4;


        //                    string RepMonths = string.Empty;
        //                    var diffMonths = (dtpTo.Value - dtpFrom.Value).Days/30;
        //                    //var diffMonths = (dtpTo.Value.Month + dtpTo.Value.Year * 12) - (dtpFrom.Value.Month + dtpFrom.Value.Year * 12);
        //                    //int diffMonths = Math.Abs(((dtpTo.Value.Year - dtpFrom.Value.Year) * 12) + (dtpTo.Value.Month - dtpFrom.Value.Month));
        //                    if (diffMonths > 1) RepMonths = "(" + diffMonths + " Months)"; else RepMonths = "(" + diffMonths + " Month)";

        //                    WorksheetCell cell1 = row.Cells.Add("Reporting Period: " + LookupDataAccess.GetMonthNameDate(dtpFrom.Text.ToString()) + " -" + LookupDataAccess.GetMonthNameDate(dtpTo.Text.ToString()) + "  " + RepMonths, DataType.String, "m106944584");
        //                    cell1.MergeAcross = 5;

        //                    WorksheetCell cell2 = row.Cells.Add("Budget: $" + Convert.ToDouble(SelSSBG.SSBGBudget.Trim()).ToString("N", CultureInfo.InvariantCulture), DataType.String, "m106944524");
        //                    cell2.MergeAcross = 3;

        //                    WorksheetCell cell3 = row.Cells.Add("", DataType.String, "m106944464");
        //                    cell3.MergeAcross = 5;

        //                    row = sheet.Table.Rows.Add();
        //                    row.Height = 22;
        //                    row.AutoFitHeight = false;

        //                    WorksheetCell cell4 = row.Cells.Add("", DataType.String, "m106944504");
        //                    cell4.MergeAcross = 4;

        //                    diffMonths = (Convert.ToDateTime(SelSSBG.SSBGGPTo) - Convert.ToDateTime(SelSSBG.SSBGGPFrom)).Days / 30;
        //                    //diffMonths = (Convert.ToDateTime(SelSSBG.SSBGGPTo).Month + Convert.ToDateTime(SelSSBG.SSBGGPTo).Year * 12) - (Convert.ToDateTime(SelSSBG.SSBGGPFrom).Month + Convert.ToDateTime(SelSSBG.SSBGGPFrom).Year * 12);
        //                    //diffMonths = Math.Abs(((Convert.ToDateTime(SelSSBG.SSBGGPTo).Year - Convert.ToDateTime(SelSSBG.SSBGGPFrom).Year) * 12) + (Convert.ToDateTime(SelSSBG.SSBGGPTo).Month - Convert.ToDateTime(SelSSBG.SSBGGPFrom).Month));
        //                    if (diffMonths > 1) RepMonths = "(" + diffMonths + " Months)"; else RepMonths = "(" + diffMonths + " Month)";
        //                    WorksheetCell cell5 = row.Cells.Add("Grant Period: " + LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPFrom.ToString()) + " -" + LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPTo.ToString()) + "  " + RepMonths, DataType.String, "m106944564");
        //                    cell5.MergeAcross = 5;

        //                    WorksheetCell cell6 = row.Cells.Add("Total Grant Award: $" + Convert.ToDouble(SelSSBG.SSBGAward.Trim()).ToString("N", CultureInfo.InvariantCulture), DataType.String, "m106944604");
        //                    cell6.MergeAcross = 3;

        //                    WorksheetCell cell7 = row.Cells.Add("Date of Reporting: " + DateTime.Now.ToShortDateString(), DataType.String, "m106944484");
        //                    cell7.MergeAcross = 5;

        //                    data = "Program Description:  SSBG Individuals: Service intervention and case management for single individuals with incomes that fall at or below 150% of the federal poverty level. SSBG/TANF Families: indivduals/families with income at or below 200% of the federal poverty level with one child under the age of 18 in their household.";

        //                    row = sheet.Table.Rows.Add();
        //                    row.Height = 14;

        //                    WorksheetCell R3Cell = row.Cells.Add(data, DataType.String, "m106944144");
        //                    R3Cell.MergeAcross = 20;
        //                    R3Cell.MergeDown = 1;

        //                    row = sheet.Table.Rows.Add();
        //                    row.Height = 9;
        //                    row.AutoFitHeight = false;

        //                    row = sheet.Table.Rows.Add();
        //                    row.Height = 15;

        //                    int SumTot = 0;
        //                    if (SelSSBGTypes.Count > 0)
        //                    {
        //                        SumTot = SelSSBGTypes.Sum(u => Convert.ToInt32(u.SBGTCntlOblig.Trim()));

        //                    }

        //                    WorksheetCell R4cell = row.Cells.Add("Program Utilization - N = "+SumTot, DataType.String, "m106944624");
        //                    R4cell.MergeAcross = 20;

        //                    row = sheet.Table.Rows.Add();
        //                    row.Height = 24;

        //                    row.Cells.Add("Type", DataType.String, "s40");

        //                    WorksheetCell R5Cell = row.Cells.Add("Contract Obligation", DataType.String, "s38");
        //                    R5Cell.MergeAcross = 1;

        //                    row.Cells.Add("# Served Current Month", DataType.String, "s38");

        //                    WorksheetCell R5Cell1 = row.Cells.Add("# Served Year to Date", DataType.String, "s38");
        //                    R5Cell1.MergeAcross = 1;

        //                    row.Cells.Add("% Served to Date", DataType.String, "s38");

        //                    row.Cells.Add("Obligation Outcomes", DataType.String, "s21");

        //                    WorksheetCell R5Cell2 = row.Cells.Add("", DataType.String, "m106944324");
        //                    R5Cell2.MergeAcross = 2;

        //                    WorksheetCell R5Cell3 = row.Cells.Add("# of Service Interventions", DataType.String, "s38");
        //                    R5Cell3.MergeAcross = 3;

        //                    WorksheetCell R5Cell4 = row.Cells.Add("Unduplicated Number of Customers Engaged in Case Management", DataType.String, "s38");
        //                    R5Cell4.MergeAcross = 5;

        //                    row = sheet.Table.Rows.Add();
        //                    row.Height = 22;
        //                    row.AutoFitHeight = false;

        //                    row.Cells.Add("", DataType.String, "s24");

        //                    WorksheetCell R6Cell = row.Cells.Add("", DataType.String, "m106944364");
        //                    R6Cell.MergeAcross = 1;

        //                    row.Cells.Add("", DataType.String, "s27");

        //                    WorksheetCell R6Cell1 = row.Cells.Add("", DataType.String, "m106944384");
        //                    R6Cell1.MergeAcross = 1;

        //                    row.Cells.Add("", DataType.String, "s27");

        //                    row.Cells.Add(" = YES", DataType.String, "s28");

        //                    WorksheetCell R6Cell2 = row.Cells.Add("", DataType.String, "m106944344");
        //                    R6Cell2.MergeAcross = 2;

        //                    WorksheetCell R6Cell3 = row.Cells.Add("Current Month", DataType.String, "s27");
        //                    R6Cell3.MergeAcross = 1;

        //                    WorksheetCell R6Cell4 = row.Cells.Add("Year to Date", DataType.String, "s27");
        //                    R6Cell4.MergeAcross = 1;

        //                    WorksheetCell R6Cell5 = row.Cells.Add("Current Month", DataType.String, "m106944064");
        //                    R6Cell5.MergeAcross = 2;

        //                    WorksheetCell R6Cell6 = row.Cells.Add("Year to Date", DataType.String, "s27");
        //                    R6Cell6.MergeAcross = 2;

        //                    if (SelSSBGTypes.Count > 0)
        //                    {
        //                        float TotCntlOblig = 0; int TotCnt = 0; int TotYearCnt = 0;
        //                        foreach (SSBGTYPESEntity Entity in SelSSBGTypes)
        //                        {
        //                            int YearTodateCnt = 0; int Count = 0;
        //                            if (Entity.SBGT_CNTAREA1_VAL.ToString() == "I")
        //                            {
        //                                YearTodateCnt = YeartoDateProcess(Entity, SelSSBG);

        //                                Count = Process(Entity, SelSSBG);
        //                            }

        //                            row = sheet.Table.Rows.Add();
        //                            row.Height = 22;
        //                            row.AutoFitHeight = false;

        //                            row.Cells.Add(Entity.SBGTDesc, DataType.String, "s26");

        //                            WorksheetCell R6C1 = row.Cells.Add(Entity.SBGTCntlOblig, DataType.Number, "s29");
        //                            R6C1.MergeAcross = 1;

        //                            row.Cells.Add(Count.ToString(), DataType.Number, "s29");

        //                            WorksheetCell R6C2 = row.Cells.Add(YearTodateCnt.ToString(), DataType.Number, "s29");
        //                            R6C2.MergeAcross = 1;

        //                            R6C2= row.Cells.Add("0", DataType.Number, "s30");
        //                            R6C2.Formula = "+RC[-2]/RC[-5]";

        //                            R6C2= row.Cells.Add("0.00", DataType.Number, "s22");
        //                            R6C2.Formula = "=RC[-1]";

        //                            WorksheetCell R6C3 = row.Cells.Add("", DataType.String, "m106944424");
        //                            R6C3.MergeAcross = 2;

        //                            WorksheetCell R6C4 = row.Cells.Add("", DataType.String, "s29");
        //                            R6C4.MergeAcross = 1;

        //                            WorksheetCell R6C5 = row.Cells.Add("", DataType.String, "s29");
        //                            R6C5.MergeAcross = 1;

        //                            WorksheetCell R6C6 = row.Cells.Add("", DataType.String, "m106944084");
        //                            R6C6.MergeAcross = 2;

        //                            WorksheetCell R6C7 = row.Cells.Add("", DataType.String, "s166");
        //                            R6C7.MergeAcross = 2;

        //                            TotCntlOblig += int.Parse(Entity.SBGTCntlOblig.Trim());
        //                            TotCnt += Count; TotYearCnt += YearTodateCnt;
        //                        }

        //                        row = sheet.Table.Rows.Add();
        //                        row.Height = 22;
        //                        row.AutoFitHeight = false;

        //                        row.Cells.Add("Total:", DataType.String, "s25");

        //                        WorksheetCell R6T1 = row.Cells.Add(TotCntlOblig.ToString(), DataType.Number, "s32");
        //                        R6T1.MergeAcross = 1;

        //                        row.Cells.Add(TotCnt.ToString(), DataType.Number, "s32");

        //                        WorksheetCell R6T2 = row.Cells.Add(TotYearCnt.ToString(), DataType.Number, "s32");
        //                        R6T2.MergeAcross = 1;

        //                        R6T2 = row.Cells.Add("0", DataType.Number, "s33");
        //                        R6T2.Formula = "+RC[-2]/RC[-5]";

        //                        R6T2=row.Cells.Add("0.00", DataType.Number, "s23");
        //                        R6T2.Formula = "=RC[-1]";

        //                        WorksheetCell R6T3 = row.Cells.Add("", DataType.String, "m95382656");
        //                        R6T3.MergeAcross = 2;

        //                        WorksheetCell R6T4 = row.Cells.Add("0", DataType.Number, "s32");
        //                        R6T4.MergeAcross = 1;

        //                        WorksheetCell R6T5 = row.Cells.Add("0", DataType.Number, "s32");
        //                        R6T5.MergeAcross = 1;

        //                        WorksheetCell R6T6 = row.Cells.Add("0", DataType.Number, "m106944124");
        //                        R6T6.MergeAcross = 2;

        //                        WorksheetCell R6T7 = row.Cells.Add("0", DataType.Number, "s32");
        //                        R6T7.MergeAcross = 2;
        //                    }

        //                    row = sheet.Table.Rows.Add();
        //                    row.Height = 22;
        //                    row.AutoFitHeight = false;

        //                    data = "Contractual/Funder Requirements Contractual/Funder Requirements as Outlined in Contract , as of "+LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPFrom.ToString())+" for period covering "+LookupDataAccess.GetMonthDate(dtpFrom.Value.ToShortDateString())+"- "+LookupDataAccess.GetMonthNameDate(dtpTo.Value.ToShortDateString());
        //                    WorksheetCell RCell = row.Cells.Add(data, DataType.String, "m106944764");
        //                    RCell.MergeAcross = 18;

        //                    WorksheetCell S1;
        //                    S1 = row.Cells.Add("Have we reached the funder goal ?", DataType.String, "m95382676");
        //                    S1.MergeAcross = 1;
        //                    S1.MergeDown = 1;

        //                    row = sheet.Table.Rows.Add();
        //                    row.Height = 22;
        //                    row.AutoFitHeight = false;

        //                    S1 = row.Cells.Add("Goals - only required in quarterly reports (please use the quarterly report form)", DataType.String, "m106944744");
        //                    S1.MergeAcross = 14;

        //                    S1 = row.Cells.Add(LookupDataAccess.GetMonthNameDate(dtpFrom.Value.ToShortDateString()) + " - " + LookupDataAccess.GetMonthNameDate(dtpTo.Value.ToShortDateString()), DataType.String, "s181");
        //                    S1.MergeAcross = 3;
        //                    DataTable dtObj = new DataTable(); int ObjCnt = 1;
        //                    if (SSBGGoals.Count > 0)
        //                    {
        //                        bool IsFirst = false; string GoalDesc = string.Empty;
        //                        foreach (SSBGGOALSEntity GEntity in SSBGGoals)
        //                        {
        //                            if (GEntity.SBGGSeq.Trim() == "0")
        //                            {
        //                                row = sheet.Table.Rows.Add();
        //                                row.Height = 27;
        //                                row.AutoFitHeight = false;

        //                                GoalDesc = GEntity.SBGGDesc.Trim();
        //                                S1 = row.Cells.Add(GEntity.SBGGDesc.Trim(), DataType.String, "m106944864");
        //                                S1.MergeAcross = 14;

        //                                if (!IsFirst)
        //                                {
        //                                    S1 = row.Cells.Add(" # Seeking Service", DataType.String, "s41");
        //                                    S1 = row.Cells.Add("# Accessed Service", DataType.String, "s41");
        //                                    S1 = row.Cells.Add("# Year to Date", DataType.String, "s42");
        //                                    S1 = row.Cells.Add("Year to Date %", DataType.String, "s43");

        //                                    S1 = row.Cells.Add("= YES", DataType.String, "m95382696");
        //                                    S1.MergeAcross = 1;

        //                                    IsFirst = true;
        //                                }
        //                                else
        //                                {


        //                                    S1 = row.Cells.Add("", DataType.String, "s44");
        //                                    S1 = row.Cells.Add("", DataType.String, "s44");
        //                                    S1 = row.Cells.Add("", DataType.String, "s45");
        //                                    S1 = row.Cells.Add("#DIV/0!", DataType.String, "s46");
        //                                    S1.Data.Type = DataType.Error;

        //                                    S1 = row.Cells.Add("", DataType.String, "m95382716");
        //                                    S1.MergeAcross = 1;
        //                                }
        //                            }
        //                            else
        //                            {
        //                                List<SSBGAssnsEntity> SSBGSelAssns = SSBGCAMS_List.FindAll(u => u.SBASGoal.Equals(GEntity.SBGGCode) && u.SBASOBJ.Equals(GEntity.SBGGSeq));
        //                                List<SSBGAssnsEntity> SelCAs = SSBGSelAssns.FindAll(u => u.SBAS_CAMS_Type.Equals("CA"));
        //                                List<SSBGAssnsEntity> SelMSs = SSBGSelAssns.FindAll(u => u.SBAS_CAMS_Type.Equals("MS"));

        //                                dtObj= CreationDatatable(SSBGSelAssns);
        //                                List<CASEACTEntity> selCaseact = new List<CASEACTEntity>();
        //                                List<Captain.Common.Utilities.ListItem> SelLists = new List<Utilities.ListItem>();

        //                                var CAResult = (from a in SP_Activity_Details join s in SelCAs on a.ACT_Code equals s.SBAS_CAMS_Code  select a).ToList();
        //                                var MSResult = (from a in SP_MS_Details join s in SelMSs on a.MS_Code equals s.SBAS_CAMS_Code select a).ToList();

        //                                if (CAResult.Count > 0)
        //                                {
        //                                    var SApps = CAResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
        //                                    var SMSApps = MSResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
        //                                    if (SMSApps.Count > 0)
        //                                        SApps.AddRange(SMSApps);
        //                                    SApps = SApps.OrderBy(u => u.App_no).ToList();
        //                                    string Privapp = string.Empty; DataRow dr = dtObj.NewRow(); bool Isfirst = false;
        //                                    foreach (var Entity in SApps)
        //                                    {

        //                                        if (Privapp != Entity.App_no)
        //                                        {
        //                                            if (Isfirst)
        //                                            {
        //                                                dtObj.Rows.Add(dr);
        //                                                dr = dtObj.NewRow();
        //                                            }

        //                                            dr.SetField("Goal", GoalDesc);
        //                                            dr.SetField("Objective", GEntity.SBGGDesc.Trim());
        //                                            dr.SetField("Type", GEntity.SBGGCountType.Trim());
        //                                            dr.SetField("AppNo", Entity.App_no);
        //                                            CASEACTEntity MstEntity = SP_Activity_Details.Find(u => u.App_no.Equals(Entity.App_no.Trim()));
        //                                            string AppName = string.Empty;
        //                                            if (MstEntity != null)
        //                                                AppName = LookupDataAccess.GetMemberName(MstEntity.FirstName.Trim(), MstEntity.MiddleName.Trim(), MstEntity.LastName.Trim(), BaseForm.BaseHierarchyCnFormat);
        //                                            else
        //                                            {
        //                                                CASEMSEntity MsEntity = SP_MS_Details.Find(u => u.App_no.Equals(Entity.App_no.Trim()));
        //                                                if (MsEntity != null)
        //                                                    AppName = LookupDataAccess.GetMemberName(MsEntity.FirstName.Trim(), MsEntity.MiddleName.Trim(), MsEntity.LastName.Trim(), BaseForm.BaseHierarchyCnFormat);
        //                                            }
        //                                            dr.SetField("Name", AppName);
        //                                            string ActDate = string.Empty;
        //                                            if(CAResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code)).Count>0)
        //                                                ActDate = CAResult.Find(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code)).ACT_Date.Trim();
        //                                            if (string.IsNullOrEmpty(ActDate.Trim()))
        //                                            {
        //                                                if(MSResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code)).Count>0)
        //                                                    ActDate = MSResult.Find(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code)).Date.Trim();
        //                                            }
        //                                            dr.SetField(Entity.ACT_Code.Trim(), LookupDataAccess.Getdate(ActDate.Trim()));
        //                                            Isfirst = true;
        //                                        }
        //                                        else
        //                                        {
        //                                            string ActDate = string.Empty;
        //                                            if (CAResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code)).Count > 0)
        //                                                ActDate = CAResult.Find(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code)).ACT_Date.Trim();
        //                                            if (string.IsNullOrEmpty(ActDate.Trim()))
        //                                            {
        //                                                if (MSResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code)).Count > 0)
        //                                                    ActDate = MSResult.Find(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code)).Date.Trim();
        //                                            }
        //                                            dr.SetField(Entity.ACT_Code.Trim(), LookupDataAccess.Getdate(ActDate.Trim()));
        //                                        }

        //                                        Privapp = Entity.App_no;
        //                                    }
        //                                    if(dr!=null)
        //                                        dtObj.Rows.Add(dr);
        //                                }

        //                                var CASEEKResult = CAResult.FindAll(u => !(u.ActSeek_Date.Trim().Equals("")));
        //                                var CAAccessResult = CAResult.FindAll(u => Convert.ToDateTime(u.ACT_Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= dtpTo.Value);
        //                                if (CASEEKResult.Count > 0)
        //                                    CASEEKResult = CASEEKResult.FindAll(u => Convert.ToDateTime(u.ActSeek_Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.ActSeek_Date.Trim()) <= dtpTo.Value);

        //                                var MSSEEKResult = MSResult.FindAll(u => !(u.Seek_Date.Trim().Equals("")));
        //                                var MSAccessResult = MSResult.FindAll(u => Convert.ToDateTime(u.Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.Date.Trim()) <= dtpTo.Value);
        //                                if (MSSEEKResult.Count > 0)
        //                                    MSSEEKResult = MSSEEKResult.FindAll(u => Convert.ToDateTime(u.Seek_Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.Seek_Date.Trim()) <= dtpTo.Value);

        //                                //var YEARCAResult = (from a in YEAR_SP_Activity_Details join s in SelCAs on a.ACT_Code equals s.SBAS_CAMS_Code select a).ToList();
        //                                //var YEARMSResult = (from a in YEAR_SP_MS_Details join s in SelMSs on a.MS_Code equals s.SBAS_CAMS_Code select a).ToList();

        //                                string SeekCount = string.Empty; string AccessCount = string.Empty; string YrdtCnt = string.Empty; string YrdtSeekCnt = string.Empty;
        //                                if (GEntity.SBGGCountType == "S" || GEntity.Type2 == "S")
        //                                {
        //                                    string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;

        //                                    var YearSpmrecs = CaseSPMList.FindAll(u => !(u.startdate.Trim().Equals("")));
        //                                    if(YearSpmrecs.Count>0)
        //                                        YearSpmrecs = YearSpmrecs.FindAll(u => Convert.ToDateTime(u.startdate.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.startdate.Trim()) <= Ref_To_Date.Value);
        //                                    var Spmrecs = CaseSPMList.FindAll(u => !(u.startdate.Trim().Equals("")));
        //                                    if(Spmrecs.Count>0)
        //                                        Spmrecs = Spmrecs.FindAll(u => Convert.ToDateTime(u.startdate.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.startdate.Trim()) <= dtpTo.Value);

        //                                    if (GEntity.SBGGCountType == "S")
        //                                    {
        //                                        var YrcountApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        YearAccess = YrcountApps.Select(u => u.AppNo.Trim()).Distinct().Count();

        //                                        var countApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        Access = countApps.Select(u => u.AppNo.Trim()).Distinct().Count();
        //                                    }

        //                                    if (GEntity.Type2 == "S")
        //                                    {
        //                                        var YrcountApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        YearSeek = YrcountApps.Select(u => u.AppNo.Trim()).Distinct().Count();

        //                                        var countApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        Seek = countApps.Select(u => u.AppNo.Trim()).Distinct().Count();
        //                                    } if (Seek > 0) SeekCount = Seek.ToString(); if (Access > 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();

        //                                    //var SpmCARecs = (from b in YearSpmrecs join t in CAResult on b.app_no equals t.App_no select t).ToList();
        //                                    //var SpmMSRecs = (from b in YearSpmrecs join t in MSResult on b.app_no equals t.App_no select t).ToList();

        //                                    //var CASResult = (from a in SP_Activity_Details join s in SelCAs on a.ACT_Code equals s.SBAS_CAMS_Code select a).ToList();
        //                                    //var MSSResult = (from a in SP_MS_Details join s in SelMSs on a.MS_Code equals s.SBAS_CAMS_Code select a).ToList();
        //                                }

        //                                if (GEntity.SBGGCountType == "C" || GEntity.Type2 == "C")
        //                                {
        //                                    string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;
        //                                    var YearSpmrecs = CaseSPMList.FindAll(u => !(u.compdate.Trim().Equals("")));
        //                                    if (YearSpmrecs.Count > 0)
        //                                        YearSpmrecs = YearSpmrecs.FindAll(u => Convert.ToDateTime(u.compdate.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.compdate.Trim()) <= Ref_To_Date.Value);
        //                                    var Spmrecs = CaseSPMList.FindAll(u => !(u.compdate.Trim().Equals("")));
        //                                    if (Spmrecs.Count > 0)
        //                                        Spmrecs = Spmrecs.FindAll(u => Convert.ToDateTime(u.compdate.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.compdate.Trim()) <= dtpTo.Value);

        //                                    if (GEntity.SBGGCountType == "C")
        //                                    {
        //                                        var YrcountApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        YearAccess = YrcountApps.Select(u => u.AppNo.Trim()).Distinct().Count();

        //                                        var countApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        Access = countApps.Select(u => u.AppNo.Trim()).Distinct().Count();
        //                                    }

        //                                    if (GEntity.Type2 == "C")
        //                                    {
        //                                        var YrcountApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        YearSeek = YrcountApps.Select(u => u.AppNo.Trim()).Distinct().Count();

        //                                        var countApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        Seek = countApps.Select(u => u.AppNo.Trim()).Distinct().Count();
        //                                    } if (Seek > 0) SeekCount = Seek.ToString(); if (Access > 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();

        //                                    //var SpmCARecs = (from b in YearSpmrecs join t in CAResult on b.app_no equals t.App_no select t).ToList();
        //                                    //var SpmMSRecs = (from b in YearSpmrecs join t in MSResult on b.app_no equals t.App_no select t).ToList();

        //                                    //var CASResult = (from a in SP_Activity_Details join s in SelCAs on a.ACT_Code equals s.SBAS_CAMS_Code select a).ToList();
        //                                    //var MSSResult = (from a in SP_MS_Details join s in SelMSs on a.MS_Code equals s.SBAS_CAMS_Code select a).ToList();
        //                                }

        //                                if (GEntity.SBGGCountType == "A" || GEntity.Type2=="A") 
        //                                {
        //                                    string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;
        //                                    if (GEntity.Type2 == "A")
        //                                    {
        //                                        var SApps = CASEEKResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
        //                                        var SMSApps = MSSEEKResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
        //                                        if (SMSApps.Count > 0)
        //                                            SApps.AddRange(SMSApps);

        //                                        var countApps = SApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();

        //                                        var YearSKrecs = CAResult.FindAll(u => Convert.ToDateTime(u.ActSeek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ActSeek_Date.Trim()) <= Ref_To_Date.Value);
        //                                        var YearSKApps = YearSKrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
        //                                        var YearSKMSrecs = MSResult.FindAll(u => Convert.ToDateTime(u.Seek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Seek_Date.Trim()) <= Ref_To_Date.Value);
        //                                        var YearSKMSApps = YearSKMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
        //                                        if (YearSKMSApps.Count > 0)
        //                                            YearSKApps.AddRange(YearSKMSApps);

        //                                        var YearSKcountApps = YearSKApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        YearSeek = YearSKcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count)).Count;

        //                                        Seek = countApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count)).Count;

        //                                        if (countApps.Count > 0)
        //                                        {
        //                                            var SelSeekApp = countApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count));
        //                                            if (dtObj.Rows.Count > 0)
        //                                            {
        //                                                int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
        //                                                foreach (DataRow row1 in dtObj.Rows)
        //                                                {
        //                                                    if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    { row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; }
        //                                                }
        //                                            }
        //                                        }

        //                                    }
        //                                    if (GEntity.SBGGCountType == "A")
        //                                    {
        //                                        var AApps = CAAccessResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
        //                                        var AMSApps = MSAccessResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
        //                                        if (AMSApps.Count > 0)
        //                                            AApps.AddRange(AMSApps);

        //                                        var AcountApps = AApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        Access = AcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count)).Count;

        //                                        var Yearrecs = CAResult.FindAll(u => Convert.ToDateTime(u.ACT_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= Ref_To_Date.Value);
        //                                        var YearSApps = Yearrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
        //                                        var YearMSrecs = MSResult.FindAll(u => Convert.ToDateTime(u.Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Date.Trim()) <= Ref_To_Date.Value);
        //                                        var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
        //                                        if (YearSMSApps.Count > 0)
        //                                            YearSApps.AddRange(YearSMSApps);

        //                                        var YearcountApps = YearSApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        YearAccess = YearcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count)).Count;

        //                                        if (AcountApps.Count > 0 || YearcountApps.Count > 0)
        //                                        {
        //                                            //var SelSeekApp = countApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count));
        //                                            var SelAccessApp = AcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count));
        //                                            var SelYearApp = YearcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count));
        //                                            if (dtObj.Rows.Count > 0)
        //                                            {
        //                                                int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
        //                                                foreach (DataRow row1 in dtObj.Rows)
        //                                                {
        //                                                    //if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    //{ row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; }
        //                                                    if (SelAccessApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    { row1.SetField("Access", rowCountAccess + 1); rowCountAccess++; }
        //                                                    if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    { row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; }
        //                                                }
        //                                            }
        //                                        }
        //                                    }

        //                                    if (Seek > 0) SeekCount = Seek.ToString(); if (Access > 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();
        //                                }

        //                                if (GEntity.SBGGCountType == "N" || GEntity.Type2 == "N")
        //                                {
        //                                    string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;
        //                                    if (GEntity.Type2 == "N")
        //                                    {
        //                                        var SApps = CASEEKResult.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
        //                                        var SMSApps = MSSEEKResult.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
        //                                        if (SMSApps.Count > 0)
        //                                            SApps.AddRange(SMSApps);

        //                                        //var countApps = SApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();

        //                                        Seek = SApps.Select(u => u.App_no.Trim()).Distinct().Count();
        //                                        //countApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count)).Count.ToString();

        //                                        var Yearrecs = CAResult.FindAll(u => Convert.ToDateTime(u.ActSeek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ActSeek_Date.Trim()) <= Ref_To_Date.Value);

        //                                        var YearMSrecs = MSResult.FindAll(u => Convert.ToDateTime(u.Seek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Seek_Date.Trim()) <= Ref_To_Date.Value);

        //                                        var YearSApps = Yearrecs.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
        //                                        var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
        //                                        if (YearSMSApps.Count > 0)
        //                                            YearSApps.AddRange(YearSMSApps);

        //                                        YearSeek = YearSApps.Select(u => u.App_no.Trim()).Distinct().Count();

        //                                        if (SApps.Count > 0 )
        //                                        {
        //                                            var SelSeekApp = SApps.Select(u => u.App_no.Trim()).Distinct().ToList();
        //                                            //var SelAccessApp = AApps.Select(u => u.App_no.Trim()).Distinct().ToList();
        //                                            //var SelYearApp = YearSApps.Select(u => u.App_no.Trim()).Distinct().ToList();
        //                                            if (dtObj.Rows.Count > 0)
        //                                            {
        //                                                int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
        //                                                foreach (DataRow row1 in dtObj.Rows)
        //                                                {
        //                                                    foreach (var App in SelSeekApp)
        //                                                    {
        //                                                        if (App == row1["AppNo"].ToString())
        //                                                        {
        //                                                            row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; break;
        //                                                        }
        //                                                    }

        //                                                    //if (SelAccessApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    //    row1.SetField("Access", rowCountAccess++);
        //                                                    //if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    //    row1.SetField("YeartoDate", rowCountYear++);
        //                                                }
        //                                            }
        //                                        }
        //                                    }
        //                                    if (GEntity.SBGGCountType == "N")
        //                                    {
        //                                        var AApps = CAAccessResult.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
        //                                        var AMSApps = MSAccessResult.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
        //                                        if (AMSApps.Count > 0)
        //                                            AApps.AddRange(AMSApps);

        //                                        //var AcountApps = SApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                         Access = AApps.Select(u => u.App_no.Trim()).Distinct().Count();


        //                                        var Yearrecs = CAResult.FindAll(u => Convert.ToDateTime(u.ACT_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= Ref_To_Date.Value);

        //                                        var YearMSrecs = MSResult.FindAll(u => Convert.ToDateTime(u.Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Date.Trim()) <= Ref_To_Date.Value);

        //                                        var YearSApps = Yearrecs.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
        //                                        var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
        //                                        if (YearSMSApps.Count > 0)
        //                                            YearSApps.AddRange(YearSMSApps);

        //                                        YearAccess = YearSApps.Select(u => u.App_no.Trim()).Distinct().Count();

        //                                        if (AApps.Count > 0 || YearSApps.Count > 0)
        //                                        {
        //                                            //var SelSeekApp = SApps.Select(u => u.App_no.Trim()).Distinct().ToList();
        //                                            var SelAccessApp = AApps.Select(u => u.App_no.Trim()).Distinct().ToList();
        //                                            var SelYearApp = YearSApps.Select(u => u.App_no.Trim()).Distinct().ToList();
        //                                            if (dtObj.Rows.Count > 0)
        //                                            {
        //                                                int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
        //                                                foreach (DataRow row1 in dtObj.Rows)
        //                                                {
        //                                                    //foreach (var App in SelSeekApp)
        //                                                    //{
        //                                                    //    if (App == row1["AppNo"].ToString())
        //                                                    //    {
        //                                                    //        row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; break;
        //                                                    //    }
        //                                                    //}
        //                                                    foreach (var App in SelAccessApp)
        //                                                    {
        //                                                        if (App == row1["AppNo"].ToString())
        //                                                        {
        //                                                            row1.SetField("Access", rowCountAccess + 1); rowCountAccess++; break;
        //                                                        }
        //                                                    }
        //                                                    foreach (var App in SelYearApp)
        //                                                    {
        //                                                        if (App == row1["AppNo"].ToString())
        //                                                        {
        //                                                            row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; break;
        //                                                        }
        //                                                    }
        //                                                    //if (SelAccessApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    //    row1.SetField("Access", rowCountAccess++);
        //                                                    //if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    //    row1.SetField("YeartoDate", rowCountYear++);
        //                                                }
        //                                            }
        //                                        }
        //                                    }

        //                                    if (Seek != 0) SeekCount = Seek.ToString(); if (Access != 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();
        //                                }

        //                                if (GEntity.SBGGCountType == "1" || GEntity.Type2 == "1")
        //                                {
        //                                    string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;
        //                                    if (GEntity.Type2 == "1")
        //                                    {
        //                                        var SApps = CASEEKResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
        //                                        var SMSApps = MSSEEKResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
        //                                        if (SMSApps.Count > 0)
        //                                            SApps.AddRange(SMSApps);

        //                                        var countApps = SApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();

        //                                        Seek = countApps.FindAll(u => u.Count < 3 && u.Count > 1).Count;

        //                                        var Yearrecs = CAResult.FindAll(u => Convert.ToDateTime(u.ActSeek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ActSeek_Date.Trim()) <= Ref_To_Date.Value);

        //                                        var YearMSrecs = MSResult.FindAll(u => Convert.ToDateTime(u.Seek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Seek_Date.Trim()) <= Ref_To_Date.Value);

        //                                        var YearSApps = Yearrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
        //                                        var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
        //                                        if (YearSMSApps.Count > 0)
        //                                            YearSApps.AddRange(YearSMSApps);

        //                                        var YearcountApps = YearSApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        YearSeek = YearcountApps.FindAll(u => u.Count < 3 && u.Count > 1).Count;

        //                                        if (SApps.Count > 0 )
        //                                        {
        //                                            var SelSeekApp = countApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
        //                                            //var SelAccessApp = AcountApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
        //                                            //var SelYearApp = YearcountApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
        //                                            if (dtObj.Rows.Count > 0)
        //                                            {
        //                                                int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
        //                                                foreach (DataRow row1 in dtObj.Rows)
        //                                                {
        //                                                    if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    {
        //                                                        row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++;
        //                                                    }
        //                                                }
        //                                            }
        //                                        }
        //                                    }

        //                                    if (GEntity.SBGGCountType == "1")
        //                                    {
        //                                        var AApps = CAAccessResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
        //                                        var AMSApps = MSAccessResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
        //                                        if (AMSApps.Count > 0)
        //                                            AApps.AddRange(AMSApps);

        //                                        var AcountApps = AApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        Access = AcountApps.FindAll(u => u.Count < 3 && u.Count > 1).Count;

        //                                        var Yearrecs = CAResult.FindAll(u => Convert.ToDateTime(u.ACT_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= Ref_To_Date.Value);

        //                                        var YearMSrecs = MSResult.FindAll(u => Convert.ToDateTime(u.Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Date.Trim()) <= Ref_To_Date.Value);

        //                                        var YearSApps = Yearrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
        //                                        var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
        //                                        if (YearSMSApps.Count > 0)
        //                                            YearSApps.AddRange(YearSMSApps);

        //                                        var YearcountApps = YearSApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        YearAccess = YearcountApps.FindAll(u => u.Count < 3 && u.Count > 1).Count;

        //                                        if (AApps.Count > 0 || YearSApps.Count > 0)
        //                                        {
        //                                            //var SelSeekApp = countApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
        //                                            var SelAccessApp = AcountApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
        //                                            var SelYearApp = YearcountApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
        //                                            if (dtObj.Rows.Count > 0)
        //                                            {
        //                                                int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
        //                                                foreach (DataRow row1 in dtObj.Rows)
        //                                                {
        //                                                    //if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    //{
        //                                                    //    row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++;
        //                                                    //}
        //                                                    if (SelAccessApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    { row1.SetField("Access", rowCountAccess + 1); rowCountAccess++; }
        //                                                    if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    { row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; }

        //                                                }
        //                                            }
        //                                        }
        //                                    }

        //                                    if (Seek != 0) SeekCount = Seek.ToString(); if (Access != 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();
        //                                }

        //                                if (GEntity.SBGGCountType == "2" || GEntity.Type2 == "2")
        //                                {
        //                                    string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;
        //                                    if (GEntity.Type2 == "2")
        //                                    {
        //                                        var SApps = CASEEKResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
        //                                        var SMSApps = MSSEEKResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
        //                                        if (SMSApps.Count > 0)
        //                                            SApps.AddRange(SMSApps);

        //                                        var countApps = SApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();

        //                                        Seek = countApps.FindAll(u => u.Count > 2).Count;

        //                                        var Yearrecs = CAResult.FindAll(u => Convert.ToDateTime(u.ActSeek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ActSeek_Date.Trim()) <= Ref_To_Date.Value);

        //                                        var YearMSrecs = MSResult.FindAll(u => Convert.ToDateTime(u.Seek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Seek_Date.Trim()) <= Ref_To_Date.Value);

        //                                        var YearSApps = Yearrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
        //                                        var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
        //                                        if (YearSMSApps.Count > 0)
        //                                            YearSApps.AddRange(YearSMSApps);

        //                                        var YearcountApps = YearSApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        YearSeek = YearcountApps.FindAll(u => u.Count > 2).Count;

        //                                        if (SApps.Count > 0)
        //                                        {
        //                                            var SelSeekApp = countApps.FindAll(u => u.Count > 2).ToList();
        //                                            //var SelAccessApp = AcountApps.FindAll(u => u.Count > 2).ToList();
        //                                            //var SelYearApp = YearcountApps.FindAll(u => u.Count > 2).ToList();
        //                                            if (dtObj.Rows.Count > 0)
        //                                            {
        //                                                int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
        //                                                foreach (DataRow row1 in dtObj.Rows)
        //                                                {
        //                                                    if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    { row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; }
        //                                                    //if (SelAccessApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    //{ row1.SetField("Access", rowCountAccess + 1); rowCountAccess++; }
        //                                                    //if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    //{ row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; }
        //                                                }
        //                                            }
        //                                        }

        //                                    }
        //                                    if (GEntity.SBGGCountType == "2")
        //                                    {
        //                                        var AApps = CAAccessResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
        //                                        var AMSApps = MSAccessResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
        //                                        if (AMSApps.Count > 0)
        //                                            AApps.AddRange(AMSApps);

        //                                        var AcountApps = AApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        Access = AcountApps.FindAll(u => u.Count > 2).Count;

        //                                        var Yearrecs = CAResult.FindAll(u => Convert.ToDateTime(u.ACT_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= Ref_To_Date.Value);

        //                                        var YearMSrecs = MSResult.FindAll(u => Convert.ToDateTime(u.Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Date.Trim()) <= Ref_To_Date.Value);

        //                                        var YearSApps = Yearrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
        //                                        var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
        //                                        if (YearSMSApps.Count > 0)
        //                                            YearSApps.AddRange(YearSMSApps);

        //                                        var YearcountApps = YearSApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
        //                                        YearAccess = YearcountApps.FindAll(u => u.Count > 2).Count;

        //                                        if (AApps.Count > 0 || YearSApps.Count > 0)
        //                                        {
        //                                            //var SelSeekApp = countApps.FindAll(u => u.Count > 2).ToList();
        //                                            var SelAccessApp = AcountApps.FindAll(u => u.Count > 2).ToList();
        //                                            var SelYearApp = YearcountApps.FindAll(u => u.Count > 2).ToList();
        //                                            if (dtObj.Rows.Count > 0)
        //                                            {
        //                                                int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
        //                                                foreach (DataRow row1 in dtObj.Rows)
        //                                                {
        //                                                    //if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    //{ row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; }
        //                                                    if (SelAccessApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    { row1.SetField("Access", rowCountAccess + 1); rowCountAccess++; }
        //                                                    if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
        //                                                    { row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; }
        //                                                }
        //                                            }
        //                                        }
        //                                    }
        //                                    if (Seek != 0) SeekCount = Seek.ToString(); if (Access != 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();
        //                                }

        //                                row = sheet.Table.Rows.Add();
        //                                row.Height = 22;
        //                                row.AutoFitHeight = false;

        //                                S1 = row.Cells.Add(GEntity.SBGGDesc.Trim(), DataType.String, "m106944884");
        //                                S1.MergeAcross = 14;

        //                                S1 = row.Cells.Add(SeekCount, DataType.Number, "s44");
        //                                S1 = row.Cells.Add(AccessCount, DataType.Number, "s44");
        //                                S1 = row.Cells.Add(YrdtSeekCnt, DataType.Number, "s45");
        //                                S1 = row.Cells.Add(YrdtCnt, DataType.Number, "s45");
        //                                if (!string.IsNullOrEmpty(SeekCount.Trim()))
        //                                {
        //                                    S1 = row.Cells.Add("0", DataType.Number, "s45");
        //                                    //S1.Data.Type = DataType.Error;
        //                                    S1.Formula = "+RC[-2]/RC[-3]";
        //                                }
        //                                else
        //                                {
        //                                    S1 = row.Cells.Add("#DIV/0!", DataType.String, "s46");
        //                                    S1.Data.Type = DataType.Error;
        //                                    //S1.Formula = "+RC[-2]/RC[-1]";
        //                                }

        //                                //S1 = row.Cells.Add("", DataType.String, "m95382716");
        //                                //S1.MergeAcross = 1;

        //                                if (dtObj.Rows.Count > 0)
        //                                {
        //                                    DatasetFillingObjectives(ObjCnt, dtObj);
        //                                    ObjCnt++;
        //                                }
        //                            }
        //                            //DatasetFillingObjectives(GoalCnt, dtObj);
        //                        }
        //                    }

        //                    row= sheet.Table.Rows.Add();
        //                    row.Height = 44;
        //                    row.AutoFitHeight = false;

        //                    S1 = row.Cells.Add("Comments:", DataType.String, "m106945024");
        //                    S1.MergeAcross = 20;



        //                }

        //            }
        //            //if (ds.Tables.Count > 0)
        //            //{
        //            //    this.GenerateWorksheetReport(book.Worksheets);
        //            //    this.GenerateWorksheetBypassReport(book.Worksheets);
        //            //}


        //            FileStream stream = new FileStream(PdfName, FileMode.Create);

        //            book.Save(stream);
        //            stream.Close();

        //            if (ds.Tables.Count > 0)
        //            {
        //                PrintAuditReportIntakes(AuditName);
        //            }
        //            if (dsObj.Tables.Count > 0)
        //            {
        //                PrintAuditReportObjective(AuditName,SSBGCAMS_List);
        //            }
        //        }
        //        catch (Exception ex) { }

        //    }
        //}

        #endregion

        private void OnHRANB_Report(object sender, FormClosedEventArgs e)
        {
            PdfListForm form = sender as PdfListForm;
            if (form.DialogResult == DialogResult.OK)
            {
                string PdfName = "Pdf File";
                PdfName = form.GetFileName();
                string AuditName = PdfName;
                //PdfName = strFolderPath + PdfName;
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                try
                {
                    if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                    { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
                }
                catch (Exception ex)
                {
                    AlertBox.Show("Error", MessageBoxIcon.Error);
                }

                try
                {
                    string Tmpstr = PdfName + ".xls";
                    if (File.Exists(Tmpstr))
                        File.Delete(Tmpstr);
                }
                catch (Exception ex)
                {
                    int length = 8;
                    string newFileName = System.Guid.NewGuid().ToString();
                    newFileName = newFileName.Replace("-", string.Empty);

                    Random_Filename = PdfName + newFileName.Substring(0, length) + ".xls";
                }

                if (!string.IsNullOrEmpty(Random_Filename))
                    PdfName = Random_Filename;
                else
                    PdfName += ".xls";

                TableCnt = 1;
                Workbook book = new Workbook();

                Worksheet sheet;
                WorksheetRow row;



                #region HeaderSheet

                WorksheetStyle s2986 = book.Styles.Add("s2986");
                s2986.Font.FontName = "Tahoma";
                s2986.Font.Size = 11;
                s2986.Font.Color = "#000000";

                WorksheetStyle style11 = book.Styles.Add("HeaderStyles");
                style11.Font.FontName = "Tahoma";
                style11.Font.Size = 10;
                style11.Interior.Color = "Gray";
                style11.Interior.Pattern = StyleInteriorPattern.Solid;
                style11.Font.Bold = true;
                style11.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style11.Alignment.WrapText = true;
                style11.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle Header1 = book.Styles.Add("HeaderColor");
                Header1.Font.FontName = "Tahoma";
                Header1.Font.Size = 10;
                Header1.Interior.Color = "#9999FF";
                Header1.Interior.Pattern = StyleInteriorPattern.Solid;
                Header1.Font.Bold = true;
                Header1.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                Header1.Alignment.WrapText = true;
                Header1.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                Header1.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                Header1.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                Header1.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle style2 = book.Styles.Add("HeaderStyle");
                style2.Font.FontName = "Tahoma";
                style2.Font.Size = 10;
                style2.Font.Bold = true;
                style2.Interior.Color = "Gray";
                style2.Interior.Pattern = StyleInteriorPattern.Solid;
                style2.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style2.Alignment.WrapText = true;
                style2.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle Header2 = book.Styles.Add("FontWhite");
                Header2.Font.FontName = "Tahoma";
                Header2.Font.Size = 10;
                Header2.Font.Bold = true;
                Header2.Font.Color = "White";
                Header2.Interior.Color = "Gray";
                Header2.Interior.Pattern = StyleInteriorPattern.Solid;
                Header2.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                Header2.Alignment.WrapText = true;
                Header2.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                Header2.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                Header2.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                Header2.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle style5 = book.Styles.Add("HeaderStyleRight");
                style5.Font.FontName = "Tahoma";
                style5.Font.Size = 10;
                style5.Font.Bold = true;
                style5.Interior.Color = "Gray";
                style5.Interior.Pattern = StyleInteriorPattern.Solid;
                style5.Alignment.Horizontal = StyleHorizontalAlignment.Right;
                style5.Alignment.WrapText = true;

                WorksheetStyle style1 = book.Styles.Add("Normal");
                style1.Font.FontName = "Tahoma";
                style1.Font.Size = 10;
                style1.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style1.Alignment.WrapText = true;

                WorksheetStyle style3 = book.Styles.Add("NormalRight");
                style3.Font.FontName = "Tahoma";
                style3.Font.Size = 10;
                style3.Alignment.Horizontal = StyleHorizontalAlignment.Right;
                style3.Alignment.WrapText = true;

                WorksheetStyle style4 = book.Styles.Add("NormalCenter");
                style4.Font.FontName = "Tahoma";
                style4.Font.Size = 10;
                style4.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style4.Alignment.WrapText = true;

                WorksheetStyle style8 = book.Styles.Add("CenterGreen");
                style8.Font.FontName = "Tahoma";
                style8.Interior.Color = "Green";
                style8.Interior.Pattern = StyleInteriorPattern.Solid;
                style8.Font.Size = 10;
                style8.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style8.Alignment.WrapText = true;

                WorksheetStyle style9 = book.Styles.Add("CenterRed");
                style9.Font.FontName = "Tahoma";
                style9.Interior.Color = "Red";
                style9.Interior.Pattern = StyleInteriorPattern.Solid;
                style9.Font.Size = 10;
                style9.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style9.Alignment.WrapText = true;

                WorksheetStyle style10 = book.Styles.Add("RightGreen");
                style10.Font.FontName = "Tahoma";
                style10.Interior.Color = "Green";
                style10.Interior.Pattern = StyleInteriorPattern.Solid;
                style10.Font.Size = 10;
                style10.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style10.Alignment.WrapText = true;

                WorksheetStyle style12 = book.Styles.Add("RightRed");
                style12.Font.FontName = "Tahoma";
                style12.Interior.Color = "Red";
                style12.Interior.Pattern = StyleInteriorPattern.Solid;
                style12.Font.Size = 10;
                style12.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style12.Alignment.WrapText = true;

                WorksheetStyle style13 = book.Styles.Add("NormalGreen");
                style13.Font.FontName = "Tahoma";
                style13.Interior.Color = "Green";
                style13.Interior.Pattern = StyleInteriorPattern.Solid;
                style13.Font.Size = 10;
                style13.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style13.Alignment.WrapText = true;

                WorksheetStyle style14 = book.Styles.Add("NormalRed");
                style14.Font.FontName = "Tahoma";
                style14.Interior.Color = "Red";
                style14.Interior.Pattern = StyleInteriorPattern.Solid;
                style14.Font.Size = 10;
                style14.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style14.Alignment.WrapText = true;

                WorksheetStyle style15 = book.Styles.Add("NormalBold");
                style15.Font.FontName = "Tahoma";
                style15.Font.Size = 12;
                style15.Font.Bold = true;
                style15.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style15.Alignment.WrapText = true;

                WorksheetStyle style16 = book.Styles.Add("NormalGray");
                style16.Font.FontName = "Tahoma";
                style16.Interior.Color = "Gray";
                style16.Interior.Pattern = StyleInteriorPattern.Solid;
                style16.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style16.Font.Size = 12;
                style16.Font.Bold = true;
                style16.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style16.Alignment.WrapText = true;


                sheet = book.Worksheets.Add("Parameters");

                sheet.Table.Columns.Add(new WorksheetColumn(50));
                sheet.Table.Columns.Add(new WorksheetColumn(200));
                sheet.Table.Columns.Add(new WorksheetColumn(250));
                //sheet.Table.Columns.Add(new WorksheetColumn(130));
                //sheet.Table.Columns.Add(new WorksheetColumn(130));
                //sheet.Table.Columns.Add(new WorksheetColumn(130));
                //sheet.Table.Columns.Add(new WorksheetColumn(130));

                row = sheet.Table.Rows.Add();
                row = sheet.Table.Rows.Add();
                row = sheet.Table.Rows.Add();
                WorksheetCell H1 = row.Cells.Add("", DataType.String, "NormalBold");
                H1 = row.Cells.Add(Privileges.Program + " - " + Privileges.PrivilegeName, DataType.String, "NormalGray");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "NormalBold");
                H1 = row.Cells.Add("Run By : " + LookupDataAccess.GetMemberName(BaseForm.UserProfile.FirstName.Trim(), BaseForm.UserProfile.MI.Trim(), BaseForm.UserProfile.LastName.Trim(), "3"), DataType.String, "Normal");
                H1 = row.Cells.Add("Date : " + DateTime.Now.ToString(), DataType.String, "NormalRight");
                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "NormalBold");
                H1 = row.Cells.Add("Selected Report Parameters", DataType.String, "NormalGray");
                H1.MergeAcross = 1;

                string Agy = "Agency : All"; string Dept = "Dept : All"; string Prg = "Program : All"; string Header_year = string.Empty;
                if (Agency != "**") Agy = "Agency : " + Agency;
                if (Depart != "**") Dept = "Dept : " + Depart;
                if (Program != "**") Prg = "Program : " + Program;
                if (CmbYear.Visible == true)
                    Header_year = "Year : " + ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString();

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add(Txt_HieDesc.Text.Trim() + "     " + Header_year, DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add("SSBG Selection :" + ((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Text.ToString().Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
               //** H1 = row.Cells.Add(lblReferenceperiodate.Text + "  " + lblreferenceFrom.Text.Trim() + ":" + Ref_From_Date.Text + "    " + lblReferenceTo.Text.Trim() + ":" + Ref_To_Date.Text.Trim(), DataType.String, "Normal");
                H1 = row.Cells.Add(lblReferenceperiodate.Text /*+ "  " + lblreferenceFrom.Text.Trim()*/ + ": " + Ref_From_Date.Text + "    " + lblReferenceTo.Text.Trim() + ": " + Ref_To_Date.Text.Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                //**H1 = row.Cells.Add(lblRepDate.Text + "  " + lblRepFrom.Text.Trim() + ":" + dtpFrom.Text + "    " + label6.Text.Trim() + ":" + dtpTo.Text.Trim(), DataType.String, "Normal");
                H1 = row.Cells.Add(lblRepDate.Text /*+ "  " + lblRepFrom.Text.Trim()*/ + ": " + dtpFrom.Text + "    " + label6.Text.Trim() + ": " + dtpTo.Text.Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add(lblDemCount.Text.Trim() + " : " + ((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Text.ToString().Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add(lblAge1.Text.Trim() + " : " + txtfrom1.Text.Trim() + " - " + txtTo1.Text.Trim() + "    " + lblAge2.Text.Trim() + " : " + txtFrom2.Text.Trim() + " - " + txtTo2.Text.Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                string Audit = string.Empty;
                if (rbGreen.Checked) Audit = rbGreen.Text.Trim();
                else if (rbGred.Checked) Audit = rbGred.Text.Trim();

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add(label1.Text.Trim() + " : " + Audit, DataType.String, "Normal");
                H1.MergeAcross = 1;

                #endregion


                this.GenerateStyles(book.Styles);

                #region

                #endregion
                sheet = book.Worksheets.Add("STATISTICAL SUMMARY");
                sheet.Table.DefaultRowHeight = 14.25F;

                sheet.Table.StyleID = "s16";
                WorksheetColumn column0 = sheet.Table.Columns.Add();
                column0.Width = 88;
                column0.StyleID = "s16";
                WorksheetColumn column1 = sheet.Table.Columns.Add();
                column1.Width = 60;
                column1.StyleID = "s16";
                WorksheetColumn column2 = sheet.Table.Columns.Add();
                column2.Width = 60;
                column2.StyleID = "s16";
                WorksheetColumn column3 = sheet.Table.Columns.Add();
                column3.Width = 60;
                column3.StyleID = "s16";
                WorksheetColumn column4 = sheet.Table.Columns.Add();
                column4.Width = 60;
                column4.StyleID = "s16";
                //WorksheetColumn column5 = sheet.Table.Columns.Add();
                //column5.Width = 0;
                //column5.StyleID = "s16";
                WorksheetColumn column6 = sheet.Table.Columns.Add();
                column6.Width = 60;
                column6.StyleID = "s16";
                WorksheetColumn column7 = sheet.Table.Columns.Add();
                column7.Width = 60;
                column7.StyleID = "s16";
                WorksheetColumn column8 = sheet.Table.Columns.Add();
                column8.Width = 60;
                column8.StyleID = "s16";
                WorksheetColumn column9 = sheet.Table.Columns.Add();
                column9.Width = 60;
                column9.StyleID = "s16";
                WorksheetColumn column10 = sheet.Table.Columns.Add();
                column10.Width = 60;
                column10.StyleID = "s16";
                WorksheetColumn column11 = sheet.Table.Columns.Add();
                column11.Width = 60;
                column11.StyleID = "s16";
                WorksheetColumn column12 = sheet.Table.Columns.Add();
                column12.Width = 60;
                column12.StyleID = "s16";
                WorksheetColumn column13 = sheet.Table.Columns.Add();
                column13.Width = 60;
                column13.StyleID = "s16";
                WorksheetColumn column14 = sheet.Table.Columns.Add();
                column14.Width = 60;
                column14.StyleID = "s16";
                //WorksheetColumn column14 = sheet.Table.Columns.Add();
                //column14.Width = 60;
                //column14.StyleID = "s16";
                //WorksheetColumn column15 = sheet.Table.Columns.Add();
                //column15.Width = 39;
                //column15.StyleID = "s16";
                //WorksheetColumn column16 = sheet.Table.Columns.Add();
                //column16.Width = 45;
                //column16.StyleID = "s16";
                //WorksheetColumn column17 = sheet.Table.Columns.Add();
                //column17.Width = 50;
                //column17.StyleID = "s16";
                //column17.Span = 1;
                //WorksheetColumn column18 = sheet.Table.Columns.Add();
                //column18.Index = 20;
                //column18.Width = 42;
                //column18.StyleID = "s16";
                //WorksheetColumn column19 = sheet.Table.Columns.Add();
                //column19.Width = 77;
                //column19.StyleID = "s16";
                //WorksheetColumn column20 = sheet.Table.Columns.Add();
                //column20.Width = 47;
                //column20.StyleID = "s16";
                //WorksheetColumn column21 = sheet.Table.Columns.Add();
                //column21.Index = 24;
                //column21.Width = 60;
                //column21.StyleID = "s16";
                SSBGPARAMEntity SelSSBG = new SSBGPARAMEntity();

                try
                {

                    string data = string.Empty;
                    if (cmbSSBG.Items.Count > 0)
                    {
                        SelSSBG = SSBGParamall.Find(u => ((u.SSBGSeq).Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString())));
                        List<SSBGTYPESEntity> SelSSBGTypes = SSBGTypesall.FindAll(u => u.SBGTID.Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString()) && u.SBGTCodeSeq.Equals("0"));
                        List<SSBGGOALSEntity> SSBGGoals = SSBGGoalsall.FindAll(u => u.SBGGID.Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString()));

                        //List<SSBGAssnsEntity> SSBGCAMS_List = _model.CaseSumData.Browse_SSBGAssns(string.Empty, string.Empty, string.Empty, string.Empty, string.Empty);

                        //CreationDatatable(SelSSBGTypes);

                        if (SelSSBG != null)
                        {
                            row = sheet.Table.Rows.Add();
                            row.Height = 47;
                            row.AutoFitHeight = false;

                            WorksheetCell cell = row.Cells.Add("Social Services Block Grant (SSBG) Case Management", DataType.String, "m2021335956856");
                            cell.MergeAcross = 3;



                            string RepMonths = string.Empty;
                            List<string> diffMonths = BuildMothswithYears(dtpFrom.Value.Month, dtpTo.Value.Month, dtpFrom.Value.Year, dtpTo.Value.Year);
                            //var diffMonths = (dtpTo.Value - dtpFrom.Value).Days / 30;
                            //var diffMonths = (dtpTo.Value.Month + dtpTo.Value.Year * 12) - (dtpFrom.Value.Month + dtpFrom.Value.Year * 12);
                            //int diffMonths = Math.Abs(((dtpTo.Value.Year - dtpFrom.Value.Year) * 12) + (dtpTo.Value.Month - dtpFrom.Value.Month));
                            if (diffMonths.Count > 1) RepMonths = "(" + diffMonths.Count + " Months)"; else RepMonths = "(" + diffMonths.Count + " Month)";

                            WorksheetCell cell1 = row.Cells.Add("Reporting Period: " + LookupDataAccess.GetMonthNameDate(dtpFrom.Text.ToString()) + " -" + LookupDataAccess.GetMonthNameDate(dtpTo.Text.ToString()) + "  " + RepMonths, DataType.String, "m2021335956856");
                            cell1.MergeAcross = 4;

                            //WorksheetCell cell2 = row.Cells.Add("Budget: $" + Convert.ToDouble(SelSSBG.SSBGBudget.Trim()).ToString("N", CultureInfo.InvariantCulture), DataType.String, "m106944524");
                            WorksheetCell cell2 = row.Cells.Add("Date of Reporting: " + DateTime.Now.ToShortDateString(), DataType.String, "m2021335956856");
                            cell2.MergeAcross = 3;

                            //WorksheetCell cell3 = row.Cells.Add("", DataType.String, "m106944464");
                            //cell3.MergeAcross = 5;

                            row = sheet.Table.Rows.Add();
                            row.Height = 22;
                            row.AutoFitHeight = false;

                            WorksheetCell cell4 = row.Cells.Add("Agency Name: " + BaseForm.BaseAgencyControlDetails.AgyName.Trim(), DataType.String, "m2021335956856");//m106944504
                            cell4.MergeAcross = 3;

                            List<string> GrntMonths = BuildMothswithYears(Convert.ToDateTime(SelSSBG.SSBGGPFrom).Month, Convert.ToDateTime(SelSSBG.SSBGGPTo).Month, Convert.ToDateTime(SelSSBG.SSBGGPFrom).Year, Convert.ToDateTime(SelSSBG.SSBGGPTo).Year);

                            //var GrntMonths = (Convert.ToDateTime(SelSSBG.SSBGGPTo) - Convert.ToDateTime(SelSSBG.SSBGGPFrom)).Days / 30;
                            //diffMonths = (Convert.ToDateTime(SelSSBG.SSBGGPTo).Month + Convert.ToDateTime(SelSSBG.SSBGGPTo).Year * 12) - (Convert.ToDateTime(SelSSBG.SSBGGPFrom).Month + Convert.ToDateTime(SelSSBG.SSBGGPFrom).Year * 12);
                            //diffMonths = Math.Abs(((Convert.ToDateTime(SelSSBG.SSBGGPTo).Year - Convert.ToDateTime(SelSSBG.SSBGGPFrom).Year) * 12) + (Convert.ToDateTime(SelSSBG.SSBGGPTo).Month - Convert.ToDateTime(SelSSBG.SSBGGPFrom).Month));
                            if (GrntMonths.Count > 1) RepMonths = "(" + GrntMonths.Count + " Months)"; else RepMonths = "(" + GrntMonths.Count + " Month)";
                            WorksheetCell cell5 = row.Cells.Add("Grant Period: " + LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPFrom.ToString()) + " -" + LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPTo.ToString()) + "  " + RepMonths, DataType.String, "m2021335956856");
                            cell5.MergeAcross = 4;

                            //WorksheetCell cell6 = row.Cells.Add("Total Grant Award: $" + Convert.ToDouble(SelSSBG.SSBGAward.Trim()).ToString("N", CultureInfo.InvariantCulture), DataType.String, "m106944604");
                            WorksheetCell cell6 = row.Cells.Add("Completed by: ", DataType.String, "m2021335956856");
                            cell6.MergeAcross = 3;

                            ////WorksheetCell cell7 = row.Cells.Add("Date of Reporting: " + DateTime.Now.ToShortDateString(), DataType.String, "m106944484");
                            //WorksheetCell cell7 = row.Cells.Add(" " , DataType.String, "m106944484");
                            //cell7.MergeAcross = 5;

                            data = SelSSBG.SSBGProgDesc.Trim();
                            if (string.IsNullOrEmpty(data.Trim()))
                                data = "Program Description:  SSBG Individuals: Service intervention and case management for single individuals with incomes that fall at or below 150% of the federal poverty level. SSBG/TANF Families: indivduals/families with income at or below 200% of the federal poverty level with one child under the age of 18 in their household.";

                            row = sheet.Table.Rows.Add();
                            row.Height = 14;

                            WorksheetCell R3Cell = row.Cells.Add(data, DataType.String, "m106944144");
                            R3Cell.MergeAcross = 12;
                            R3Cell.MergeDown = 1;

                            row = sheet.Table.Rows.Add();
                            row.Height = 9;
                            row.AutoFitHeight = false;

                            row = sheet.Table.Rows.Add();
                            row.Height = 15;

                            int SumTot = 0;
                            if (SELSSBGMonths_List.Count > 0)
                            {
                                SumTot = SELSSBGMonths_List.Sum(u => Convert.ToInt32(u.CntlOblig.Trim()));

                            }

                            WorksheetCell R4cell = row.Cells.Add("Number of clients to serve each year = " + SumTot, DataType.String, "m2021335962548");
                            R4cell.MergeAcross = 12;

                            row = sheet.Table.Rows.Add();
                            row.Height = 28;

                            WorksheetCell R4cell1 = row.Cells.Add("Type", DataType.String, "m2021335962568");
                            R4cell1.MergeDown = 1;

                            WorksheetCell R4cell2 = row.Cells.Add("Contracted Number * Quarterly Target rounded", DataType.String, "m2021335962588");
                            R4cell2.MergeAcross = 1;

                            if (string.IsNullOrEmpty(SelSSBG.SSBGCntArea1.Trim())) SelSSBG.SSBGCntArea1 = "Counting Category 1";
                            WorksheetCell R4cell3 = row.Cells.Add(SelSSBG.SSBGCntArea1.Trim(), DataType.String, "m2021335962608");
                            R4cell3.MergeAcross = 3;

                            if (string.IsNullOrEmpty(SelSSBG.SSBGCntArea2.Trim())) SelSSBG.SSBGCntArea2 = "Counting Category 2";
                            WorksheetCell R4cell4 = row.Cells.Add(SelSSBG.SSBGCntArea2.Trim(), DataType.String, "m2021335962608");
                            R4cell4.MergeDown = 1;
                            //R4cell4.MergeAcross = 1;

                            if (string.IsNullOrEmpty(SelSSBG.SSBGCntArea3.Trim())) SelSSBG.SSBGCntArea3 = "Counting Category 3";
                            R4cell4 = row.Cells.Add(SelSSBG.SSBGCntArea3.Trim(), DataType.String, "m2021335962608");
                            R4cell4.MergeDown = 1;

                            if (string.IsNullOrEmpty(SelSSBG.SSBGCntArea4.Trim())) SelSSBG.SSBGCntArea4 = "Counting Category 4";//"Number of Appointments(do not include cancelled)";
                            WorksheetCell R4cell5 = row.Cells.Add(SelSSBG.SSBGCntArea4.Trim(), DataType.String, "m2021335962608");
                            R4cell5.MergeAcross = 1;

                            if (string.IsNullOrEmpty(SelSSBG.SSBGCntArea5.Trim())) SelSSBG.SSBGCntArea5 = "Counting Category 5";
                            WorksheetCell R4cell6 = row.Cells.Add(SelSSBG.SSBGCntArea5.Trim(), DataType.String, "m2021335962608");
                            R4cell6.MergeAcross = 1;

                            row = sheet.Table.Rows.Add();
                            row.Height = 22;
                            row.AutoFitHeight = false;

                            WorksheetCell R5Cell = row.Cells.Add("Yearly Obligation", DataType.String, "m2021335962608");
                            R5Cell.Index = 2;


                            //R5Cells1.MergeAcross = 1;

                            string DynamicMonth = string.Empty;
                            switch (diffMonths.Count)
                            {
                                case 0:
                                case 1: DynamicMonth = "1 Month"; break;
                                case 2: DynamicMonth = "2 Month"; break;
                                case 3: DynamicMonth = "Quarterly"; break;
                                case 4: DynamicMonth = "4 Month"; break;
                                case 5: DynamicMonth = "5 Month"; break;
                                case 6: DynamicMonth = "Half Yearly"; break;
                                case 7: DynamicMonth = "7 Month"; break;
                                case 8: DynamicMonth = "8 Month"; break;
                                case 9: DynamicMonth = "9 Month"; break;
                                case 10: DynamicMonth = "10 Month"; break;
                                case 11: DynamicMonth = "11 Month"; break;
                                case 12: DynamicMonth = "Yearly"; break;
                            }

                            WorksheetCell R5Cells1 = row.Cells.Add(DynamicMonth + " Obligation", DataType.String, "m2021335962608");

                            row.Cells.Add(DynamicMonth, DataType.String, "m2021335962608");
                            row.Cells.Add("% " + DynamicMonth, DataType.String, "m2021335962608");
                            row.Cells.Add("Year to Date", DataType.String, "m2021335962608");
                            row.Cells.Add("% to Date", DataType.String, "m2021335962608");

                            //row.Cells.Add("Served", DataType.String, "s38");
                            //row.Cells.Add("Left Program", DataType.String, "s38");

                            WorksheetCell R5Cell11 = row.Cells.Add(DynamicMonth, DataType.String, "m2021335962608");
                            R5Cell11.Index = 10;

                            row.Cells.Add("Year to Date", DataType.String, "m2021335962608");

                            row.Cells.Add(DynamicMonth, DataType.String, "m2021335962608");
                            row.Cells.Add("Year to Date", DataType.String, "m2021335962608");


                            if (SelSSBGTypes.Count > 0)
                            {
                                DemoCounts = new SSBGDemoEntity(true); SNPDemoGraphList = new List<CaseSnpEntity>();
                                int TotCntlOblig = 0; int[] TotCnt = new int[5]; int[] TotYearCnt = new int[5]; int TotMnthCntoblig = 0;
                                int[] IntCnt = new int[5], yrIntCnt = new int[5], contcnt = new int[5], yrcontcnt = new int[5], actcnt = new int[5], yractcnt = new int[5], spmcnt = new int[5], yrspmcnt = new int[5], QuesCnt = new int[5], YrQuesCnt = new int[5];
                                foreach (SSBGTYPESEntity Entity in SelSSBGTypes)
                                {
                                    EmptyEnties(); ExcelCount = 0;
                                    List<SSBGMONTHSEntity> MonthsEntity = SELSSBGMonths_List.FindAll(u => u.SSBGCode.Equals(Entity.SBGTCode));
                                    int SBGTYearCnt = 0, SBGTQCnt = 0;
                                    if (MonthsEntity.Count > 0)
                                    {
                                        SBGTYearCnt = MonthsEntity.Sum(u => Convert.ToInt32(u.CntlOblig.Trim()));

                                        int j = 0; int YearVal = dtpFrom.Value.Year, Mnthval = dtpFrom.Value.Month;
                                        if (diffMonths.Count == 0)
                                        {
                                            foreach (SSBGMONTHSEntity MEntity in MonthsEntity)
                                            {
                                                if (Mnthval.ToString() == MEntity.Month.ToString() && YearVal.ToString() == MEntity.SSBGYearValue.ToString())
                                                {
                                                    SBGTQCnt = SBGTQCnt + int.Parse(MEntity.CntlOblig.Trim());

                                                    break;
                                                }
                                            }
                                            //int.Parse(MonthsEntity.Find(u => u.Month.ToString().Equals(Mnthval.ToString().Trim()) && u.SSBGYearValue.ToString().Equals(YearVal)).CntlOblig.ToString());
                                        }
                                        else
                                        {
                                            for (int i = 0; i < diffMonths.Count; i++)
                                            {
                                                //Mnthval = Mnthval + j;
                                                if (Mnthval > 12) { j = 0; Mnthval = 1; YearVal = YearVal + 1; }
                                                foreach (SSBGMONTHSEntity MEntity in MonthsEntity)
                                                {
                                                    if (Mnthval.ToString() == MEntity.Month.ToString() && YearVal.ToString() == MEntity.SSBGYearValue.ToString())
                                                    {
                                                        SBGTQCnt = SBGTQCnt + int.Parse(MEntity.CntlOblig.Trim());

                                                        break;
                                                    }
                                                }
                                                //j++;
                                                Mnthval++;
                                            }
                                        }
                                    }

                                    List<SSBGTYPESEntity> SSBGCritQuestions = SSBGTypesQues.FindAll(u => (u.SBGTID.Equals(Entity.SBGTID) && u.SBGTCode.Equals(Entity.SBGTCode) && (!u.SBGTGroupSeq.Equals("0"))));
                                    dt = CreateTable(SSBGCritQuestions);
                                    switch (SelSSBG.SSBGCntArea1_Val.ToString())
                                    {
                                        case "I":
                                            int YearTodateCnt = YeartoDateProcess(Entity, SSBGCritQuestions);
                                            int Count = Process(Entity, SSBGCritQuestions);
                                            IntCnt[0] = Count; yrIntCnt[0] = YearTodateCnt; break;
                                        case "A":
                                        case "B":
                                            yrIntCnt[0] = ACTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea1_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[0] = ACTProcess(Entity, SelSSBG.SSBGCntArea1_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "C":
                                        case "D":
                                            yrIntCnt[0] = CONTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea1_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[0] = CONTProcess(Entity, SelSSBG.SSBGCntArea1_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "S":
                                        case "T":
                                            yrIntCnt[0] = SPMYeartoDateProcess(Entity, SelSSBG.SSBGCntArea1_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[0] = SPMProcess(Entity, SelSSBG.SSBGCntArea1_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "Q":
                                            yrIntCnt[0] = CustQuesYeartoDateProcess(Entity, SelSSBG.SSBGCntArea1_Val.ToString(), SelSSBG.SSBGCust1, SSBGCritQuestions);
                                            IntCnt[0] = CUSTQuesProcess(Entity, SelSSBG.SSBGCntArea1_Val.ToString(), SelSSBG.SSBGCust1, SSBGCritQuestions); break;
                                        default:
                                            yrIntCnt[0] = YeartoDateProcess(Entity, SSBGCritQuestions);
                                            IntCnt[0] = Process(Entity, SSBGCritQuestions);
                                            break;
                                    }

                                    switch (SelSSBG.SSBGCntArea2_Val.ToString())
                                    {
                                        case "I":
                                            int YearTodateCnt = YeartoDateProcess(Entity, SSBGCritQuestions);
                                            int Count = Process(Entity, SSBGCritQuestions);
                                            IntCnt[1] = Count; yrIntCnt[1] = YearTodateCnt; break;
                                        case "A":
                                        case "B":
                                            yrIntCnt[1] = ACTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea2_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[1] = ACTProcess(Entity, SelSSBG.SSBGCntArea2_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "C":
                                        case "D":
                                            yrIntCnt[1] = CONTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea2_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[1] = CONTProcess(Entity, SelSSBG.SSBGCntArea2_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "S":
                                        case "T":
                                            yrIntCnt[1] = SPMYeartoDateProcess(Entity, SelSSBG.SSBGCntArea2_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[1] = SPMProcess(Entity, SelSSBG.SSBGCntArea2_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "Q":
                                            yrIntCnt[1] = CustQuesYeartoDateProcess(Entity, SelSSBG.SSBGCntArea2_Val.ToString(), SelSSBG.SSBGCust2, SSBGCritQuestions);
                                            IntCnt[1] = CUSTQuesProcess(Entity, SelSSBG.SSBGCntArea2_Val.ToString(), SelSSBG.SSBGCust2, SSBGCritQuestions); break;
                                    }

                                    switch (SelSSBG.SSBGCntArea3_Val.ToString())
                                    {
                                        case "I":
                                            int YearTodateCnt = YeartoDateProcess(Entity, SSBGCritQuestions);
                                            int Count = Process(Entity, SSBGCritQuestions);
                                            IntCnt[2] = Count; yrIntCnt[2] = YearTodateCnt; break;
                                        case "A":
                                        case "B":
                                            yrIntCnt[2] = ACTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea3_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[2] = ACTProcess(Entity, SelSSBG.SSBGCntArea3_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "C":
                                        case "D":
                                            yrIntCnt[2] = CONTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea3_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[2] = CONTProcess(Entity, SelSSBG.SSBGCntArea3_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "S":
                                        case "T":
                                            yrIntCnt[2] = SPMYeartoDateProcess(Entity, SelSSBG.SSBGCntArea3_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[2] = SPMProcess(Entity, SelSSBG.SSBGCntArea3_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "Q":
                                            yrIntCnt[2] = CustQuesYeartoDateProcess(Entity, SelSSBG.SSBGCntArea3_Val.ToString(), SelSSBG.SSBGCust3, SSBGCritQuestions);
                                            IntCnt[2] = CUSTQuesProcess(Entity, SelSSBG.SSBGCntArea3_Val.ToString(), SelSSBG.SSBGCust3, SSBGCritQuestions); break;
                                    }

                                    switch (SelSSBG.SSBGCntArea4_Val.ToString())
                                    {
                                        case "I":
                                            int YearTodateCnt = YeartoDateProcess(Entity, SSBGCritQuestions);
                                            int Count = Process(Entity, SSBGCritQuestions);
                                            IntCnt[3] = Count; yrIntCnt[3] = YearTodateCnt; break;
                                        case "A":
                                        case "B":
                                            yrIntCnt[3] = ACTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[3] = ACTProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "C":
                                        case "D":
                                            yrIntCnt[3] = CONTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[3] = CONTProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "S":
                                        case "T":
                                            yrIntCnt[3] = SPMYeartoDateProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[3] = SPMProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "Q":
                                            yrIntCnt[3] = CustQuesYeartoDateProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SelSSBG.SSBGCust4, SSBGCritQuestions);
                                            IntCnt[3] = CUSTQuesProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SelSSBG.SSBGCust4, SSBGCritQuestions); break;
                                    }

                                    switch (SelSSBG.SSBGCntArea5_Val.ToString())
                                    {
                                        case "I":
                                            int YearTodateCnt = YeartoDateProcess(Entity, SSBGCritQuestions);
                                            int Count = Process(Entity, SSBGCritQuestions);
                                            IntCnt[4] = Count; yrIntCnt[4] = YearTodateCnt; break;
                                        case "A":
                                        case "B":
                                            yrIntCnt[4] = ACTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea5_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[4] = ACTProcess(Entity, SelSSBG.SSBGCntArea5_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "C":
                                        case "D":
                                            yrIntCnt[4] = CONTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea5_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[4] = CONTProcess(Entity, SelSSBG.SSBGCntArea5_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "S":
                                        case "T":
                                            yrIntCnt[4] = SPMYeartoDateProcess(Entity, SelSSBG.SSBGCntArea5_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[4] = SPMProcess(Entity, SelSSBG.SSBGCntArea5_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "Q":
                                            yrIntCnt[4] = CustQuesYeartoDateProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SelSSBG.SSBGCust5, SSBGCritQuestions);
                                            IntCnt[4] = CUSTQuesProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SelSSBG.SSBGCust5, SSBGCritQuestions); break;
                                    }

                                    DatasetFilling(TableCnt, dt);
                                    TableCnt++;

                                    row = sheet.Table.Rows.Add();
                                    row.Height = 22;
                                    row.AutoFitHeight = false;

                                    row.Cells.Add(Entity.SBGTDesc, DataType.String, "s26");

                                    WorksheetCell R6C1 = row.Cells.Add(SBGTYearCnt.ToString(), DataType.Number, "s29");
                                    //R6C1.MergeAcross = 1;

                                    row.Cells.Add(SBGTQCnt.ToString(), DataType.Number, "s29");

                                    switch (SelSSBG.SSBGCntArea1_Val.ToString())
                                    {
                                        case "I": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        case "C":
                                        case "D": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        case "A":
                                        case "B": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        case "S":
                                        case "T": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        case "Q": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        default: if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                    }


                                    R6C1 = row.Cells.Add("0", DataType.Number, "s30");
                                    R6C1.Formula = "+RC[-1]/RC[-2]";

                                    switch (SelSSBG.SSBGCntArea1_Val.ToString())
                                    {
                                        case "I": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        case "C":
                                        case "D": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        case "A":
                                        case "B": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        case "S":
                                        case "T": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        case "Q": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        default: if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                    }

                                    //WorksheetCell R6C2 = row.Cells.Add(YearTodateCnt.ToString(), DataType.Number, "s29");
                                    //R6C2.MergeAcross = 1;

                                    R6C1 = row.Cells.Add("0", DataType.Number, "s30");
                                    R6C1.Formula = "+RC[-1]/RC[-5]";

                                    switch (SelSSBG.SSBGCntArea2_Val.ToString())
                                    {
                                        case "I": if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1") row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "m106944324"); break;
                                        case "C":
                                        case "D": if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1") row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "m106944324"); break;
                                        case "A":
                                        case "B": if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1") row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "m106944324"); break;
                                        case "S":
                                        case "T": if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1") row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "m106944324"); break;
                                        case "Q": if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1") row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "m106944324"); break;
                                        default: if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1") row.Cells.Add("", DataType.Number, "s29"); else row.Cells.Add("", DataType.Number, "m106944324"); break;
                                    }

                                    //R6C1 = row.Cells.Add("0", DataType.Number, "s29");
                                    //R6C2.Formula = "=RC[-1]";

                                    switch (SelSSBG.SSBGCntArea3_Val.ToString())
                                    {
                                        case "I": if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1") row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "m106944324"); break;
                                        case "C":
                                        case "D": if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1") row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "m106944324"); break;
                                        case "A":
                                        case "B": if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1") row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "m106944324"); break;
                                        case "S":
                                        case "T": if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1") row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "m106944324"); break;
                                        case "Q": if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1") row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "m106944324"); break;
                                        default: if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1") row.Cells.Add("", DataType.Number, "s29"); else row.Cells.Add("", DataType.Number, "m106944324"); break;
                                    }

                                    //R6C1 = row.Cells.Add("0", DataType.Number, "s29");

                                    //WorksheetCell R6C3 = row.Cells.Add("", DataType.String, "m106944424");
                                    //R6C3.MergeAcross = 2;

                                    switch (SelSSBG.SSBGCntArea4_Val.ToString())
                                    {
                                        case "I": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        case "C":
                                        case "D": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        case "A":
                                        case "B": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        case "S":
                                        case "T": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        case "Q": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        default: if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add("", DataType.String, "s29"); else row.Cells.Add("", DataType.Number, "m106944324"); break;
                                    }

                                    //WorksheetCell R6C4 = row.Cells.Add("", DataType.String, "s29");
                                    ////R6C4.MergeAcross = 1;

                                    switch (SelSSBG.SSBGCntArea4_Val.ToString())
                                    {
                                        case "I": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        case "C":
                                        case "D": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        case "A":
                                        case "B": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        case "S":
                                        case "T": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        case "Q": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        default: if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add("", DataType.String, "s29"); else row.Cells.Add("", DataType.String, "m106944324"); break;
                                    }

                                    //WorksheetCell R6C5 = row.Cells.Add("", DataType.String, "s29");
                                    ////R6C5.MergeAcross = 1;

                                    switch (SelSSBG.SSBGCntArea5_Val.ToString())
                                    {
                                        case "I": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        case "C":
                                        case "D": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        case "A":
                                        case "B": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        case "S":
                                        case "T": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        case "Q": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        default: if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add("", DataType.String, "s29"); else row.Cells.Add("", DataType.Number, "m106944324"); break;
                                    }

                                    switch (SelSSBG.SSBGCntArea5_Val.ToString())
                                    {
                                        case "I": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        case "C":
                                        case "D": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        case "A":
                                        case "B": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        case "S":
                                        case "T": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        case "Q": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        default: if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add("", DataType.String, "s29"); else row.Cells.Add("", DataType.String, "m106944324"); break;
                                    }

                                    //R6C1 = row.Cells.Add("0", DataType.Number, "s29");
                                    ////R6C2.Formula = "=RC[-1]";

                                    //R6C1 = row.Cells.Add("0", DataType.Number, "s29");

                                    //WorksheetCell R6C6 = row.Cells.Add("", DataType.String, "m106944084");
                                    //R6C6.MergeAcross = 2;

                                    //WorksheetCell R6C7 = row.Cells.Add("", DataType.String, "s166");
                                    //R6C7.MergeAcross = 2;

                                    TotCntlOblig += SBGTYearCnt; TotMnthCntoblig += SBGTQCnt;
                                    TotCnt[0] += IntCnt[0]; TotYearCnt[0] += yrIntCnt[0]; TotCnt[1] += IntCnt[1]; TotYearCnt[1] += yrIntCnt[1];
                                    TotCnt[2] += IntCnt[2]; TotYearCnt[2] += yrIntCnt[2]; TotCnt[3] += IntCnt[3]; TotYearCnt[3] += yrIntCnt[3];
                                    TotCnt[4] += IntCnt[4]; TotYearCnt[4] += yrIntCnt[4];
                                }

                                row = sheet.Table.Rows.Add();
                                row.Height = 22;
                                row.AutoFitHeight = false;

                                row.Cells.Add("Total:", DataType.String, "s25");

                                WorksheetCell R6T1 = row.Cells.Add(TotCntlOblig.ToString(), DataType.Number, "s32");
                                //R6T1.MergeAcross = 1;


                                row.Cells.Add(TotMnthCntoblig.ToString(), DataType.Number, "s32");
                                row.Cells.Add(TotCnt[0].ToString(), DataType.Number, "s32");

                                R6T1 = row.Cells.Add("0", DataType.Number, "s33");
                                R6T1.Formula = "+RC[-1]/RC[-2]";

                                WorksheetCell R6T2 = row.Cells.Add(TotYearCnt[0].ToString(), DataType.Number, "s32");
                                //R6T2.MergeAcross = 1;

                                R6T2 = row.Cells.Add("0", DataType.Number, "s33");
                                R6T2.Formula = "+RC[-1]/RC[-5]";

                                R6T2 = row.Cells.Add(TotCnt[1].ToString(), DataType.Number, "s32");
                                //R6T2.Formula = "=RC[-1]";

                                row.Cells.Add(TotCnt[2].ToString(), DataType.Number, "s32");

                                //WorksheetCell R6T3 = row.Cells.Add("", DataType.String, "m95382656");
                                //R6T3.MergeAcross = 2;

                                WorksheetCell R6T4 = row.Cells.Add(TotCnt[3].ToString(), DataType.Number, "s32");
                                //R6T4.MergeAcross = 1;

                                WorksheetCell R6T5 = row.Cells.Add(TotYearCnt[3].ToString(), DataType.Number, "s32");
                                //R6T5.MergeAcross = 1;

                                //WorksheetCell R6T6 = row.Cells.Add("0", DataType.Number, "m106944124");
                                //R6T6.MergeAcross = 2;

                                WorksheetCell R6T7 = row.Cells.Add(TotCnt[4].ToString(), DataType.Number, "s32");
                                //R6T7.MergeAcross = 2;
                                row.Cells.Add(TotYearCnt[4].ToString(), DataType.Number, "s32");
                            }

                            row = sheet.Table.Rows.Add();
                            row.Height = 15;
                            row.AutoFitHeight = false;

                            WorksheetCell RCell43 = row.Cells.Add("Demographics", DataType.String, "m2021335962548");
                            RCell43.MergeAcross = 12;

                            row = sheet.Table.Rows.Add();
                            row.Height = 22;
                            row.AutoFitHeight = false;

                            WorksheetCell A1;
                            A1 = row.Cells.Add("Age", DataType.String, "m2021335962608");
                            A1.MergeAcross = 2;

                            A1 = row.Cells.Add("Race", DataType.String, "m2021335962608");
                            A1.MergeAcross = 6;

                            A1 = row.Cells.Add("Ethnicity", DataType.String, "m2021335962608");
                            A1.MergeAcross = 1;

                            A1 = row.Cells.Add("Sex", DataType.String, "m2021335962608");
                            A1.MergeAcross = 1;

                            row = sheet.Table.Rows.Add();
                            row.Height = 33;
                            row.AutoFitHeight = false;

                            string Agerng1 = string.Empty, Agerng2 = string.Empty;
                            if (txtTo1.Text.Trim() == "999") Agerng1 = "+"; else Agerng1 = "-" + txtTo1.Text.Trim();
                            if (txtTo2.Text.Trim() == "999") Agerng2 = "+"; else Agerng2 = "-" + txtTo2.Text.Trim();

                            row.Cells.Add(txtfrom1.Text.Trim() + Agerng1, DataType.String, "m2021335962608"); // "18-59"
                            row.Cells.Add(txtFrom2.Text.Trim() + Agerng2, DataType.String, "m2021335962608");//"60+"
                            row.Cells.Add("Adults Unknown Age", DataType.String, "m2021335962608");
                            row.Cells.Add("American Indian or Alaska Native", DataType.String, "m2021335962608");
                            row.Cells.Add("Black or African American", DataType.String, "m2021335962608");
                            row.Cells.Add("White", DataType.String, "m2021335962608");
                            row.Cells.Add("Asian", DataType.String, "m2021335962608");
                            row.Cells.Add("Native Hawalian & Pacific Islander", DataType.String, "m2021335962608");
                            row.Cells.Add("Other", DataType.String, "m2021335962608");
                            row.Cells.Add("Multi-Race", DataType.String, "m2021335962608");
                            row.Cells.Add("Hispanic, Latino or Spanish", DataType.String, "m2021335962608");
                            row.Cells.Add("Non-Hispanic, Latino or Spanish", DataType.String, "m2021335962608");
                            row.Cells.Add("Male", DataType.String, "m2021335962608");
                            row.Cells.Add("Female", DataType.String, "m2021335962608");

                            //row.Cells.Add(txtfrom1.Text.Trim() + Agerng1, DataType.String, "s40"); // "18-59"
                            //row.Cells.Add(txtFrom2.Text.Trim() + Agerng2, DataType.String, "s40");//"60+"
                            //row.Cells.Add("Adults Unknown Age", DataType.String, "s40");
                            //row.Cells.Add("Black or African American", DataType.String, "s40");
                            //row.Cells.Add("White", DataType.String, "s40");
                            //row.Cells.Add("Asian", DataType.String, "s40");
                            //row.Cells.Add("Native Hawalian & Pacific Islander", DataType.String, "s40");
                            //row.Cells.Add("Other", DataType.String, "s40");
                            //row.Cells.Add("Multi-Race", DataType.String, "s40");
                            //row.Cells.Add("Hispanic, Latino or Spanish", DataType.String, "s40");
                            //row.Cells.Add("Non-Hispanic, Latino or Spanish", DataType.String, "s40");
                            //row.Cells.Add("Male", DataType.String, "s40");
                            //row.Cells.Add("Female", DataType.String, "s40");

                            row = sheet.Table.Rows.Add();
                            row.Height = 22;
                            row.AutoFitHeight = false;

                            row.Cells.Add(DemoCounts.SSBG18to59, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBG60Plus, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGAdults, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGAmerican, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGBlack, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGWhite, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGAsian, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGNative, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGOther, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGMultiRace, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGHispanic, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGNonHispanic, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGMale, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGFemale, DataType.Number, "s29");

                            row = sheet.Table.Rows.Add();
                            row.Height = 22;
                            row.AutoFitHeight = false;

                            A1 = row.Cells.Add((Convert.ToInt32(DemoCounts.SSBG18to59) + Convert.ToInt32(DemoCounts.SSBG60Plus) + Convert.ToInt32(DemoCounts.SSBGAdults)).ToString(), DataType.Number, "m2021335933752");
                            A1.MergeAcross = 2;

                            A1 = row.Cells.Add((Convert.ToInt32(DemoCounts.SSBGAsian) + Convert.ToInt32(DemoCounts.SSBGAmerican) + Convert.ToInt32(DemoCounts.SSBGBlack) + Convert.ToInt32(DemoCounts.SSBGMultiRace) + Convert.ToInt32(DemoCounts.SSBGNative) + Convert.ToInt32(DemoCounts.SSBGOther) + Convert.ToInt32(DemoCounts.SSBGWhite)).ToString(), DataType.Number, "m2021335933752");
                            A1.MergeAcross = 6;

                            A1 = row.Cells.Add((Convert.ToInt32(DemoCounts.SSBGHispanic) + Convert.ToInt32(DemoCounts.SSBGNonHispanic)).ToString(), DataType.Number, "m2021335933752");
                            A1.MergeAcross = 1;

                            A1 = row.Cells.Add((Convert.ToInt32(DemoCounts.SSBGMale) + Convert.ToInt32(DemoCounts.SSBGFemale)).ToString(), DataType.Number, "m2021335933752");
                            A1.MergeAcross = 1;

                            row = sheet.Table.Rows.Add();
                            row.Height = 22;
                            row.AutoFitHeight = false;

                            data = "Contractual/Funder Requirements Contractual/Funder Requirements as Outlined in Contract , as of " + LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPFrom.ToString()) + " for period covering " + LookupDataAccess.GetMonthDate(dtpFrom.Value.ToShortDateString()) + "- " + LookupDataAccess.GetMonthNameDate(dtpTo.Value.ToShortDateString());
                            WorksheetCell RCell = row.Cells.Add(data, DataType.String, "m2021335962548");
                            RCell.MergeAcross = 12;

                            WorksheetCell S1;
                            //S1 = row.Cells.Add("Have we reached the funder goal ?", DataType.String, "m95382676");
                            ////S1.MergeAcross = 1;
                            //S1.MergeDown = 1;

                            row = sheet.Table.Rows.Add();
                            row.Height = 22;
                            row.AutoFitHeight = false;

                            S1 = row.Cells.Add("Goals - only required in quarterly reports (please use the quarterly report form)", DataType.String, "m2021335962548");
                            S1.MergeAcross = 7;

                            S1 = row.Cells.Add(LookupDataAccess.GetMonthNameDate(dtpFrom.Value.ToShortDateString()) + " - " + LookupDataAccess.GetMonthNameDate(dtpTo.Value.ToShortDateString()), DataType.String, "m2021335962548");//"s181"
                            S1.MergeAcross = 4;
                            DataTable dtObj = new DataTable(); int ObjCnt = 1;
                            if (SSBGGoals.Count > 0)
                            {
                                bool IsFirst = false; string GoalDesc = string.Empty; string SBGGCountType = string.Empty, Type2 = string.Empty;
                                foreach (SSBGGOALSEntity GEntity in SSBGGoals)
                                {
                                    if (GEntity.SBGGSeq.Trim() == "0")
                                    {
                                        row = sheet.Table.Rows.Add();
                                        row.Height = 27;
                                        row.AutoFitHeight = false;

                                        GoalDesc = GEntity.SBGGDesc.Trim();
                                        SBGGCountType = GEntity.SBGGCountType.Trim();Type2 = GEntity.Type2.Trim();
                                        S1 = row.Cells.Add(GEntity.SBGGDesc.Trim(), DataType.String, "m2021335933336");
                                        S1.MergeAcross = 7;

                                        if (!IsFirst)
                                        {
                                            S1 = row.Cells.Add(DynamicMonth + " # Seeking Objective", DataType.String, "m2021335933336");
                                            S1 = row.Cells.Add("YTD # Seeking Objective ", DataType.String, "m2021335933336");
                                            S1 = row.Cells.Add(DynamicMonth + "# Obtained Objective", DataType.String, "m2021335933336");
                                            S1 = row.Cells.Add("YTD # Obtained Objective ", DataType.String, "m2021335933336");
                                            S1 = row.Cells.Add("Year to Date %", DataType.String, "m2021335933336");

                                            //S1 = row.Cells.Add("= YES", DataType.String, "m95382696");
                                            //S1.MergeAcross = 1;

                                            //IsFirst = true;
                                        }
                                        else
                                        {


                                            S1 = row.Cells.Add("", DataType.String, "s44");
                                            S1 = row.Cells.Add("", DataType.String, "s44");
                                            S1 = row.Cells.Add("", DataType.String, "s45");
                                            S1 = row.Cells.Add("", DataType.String, "s45");
                                            S1 = row.Cells.Add("0", DataType.String, "s46");
                                            //S1.Data.Type = DataType.Error;

                                            //S1 = row.Cells.Add("", DataType.String, "m95382716");

                                        }
                                    }
                                    else
                                    {
                                        List<SSBGSerPlanEntity> SSBGSelSerPlan = SSBGSerPlans.FindAll(u => u.SBSPGoal.Equals(GEntity.SBGGCode) && u.SBSPOBJ.Equals(GEntity.SBGGSeq));
                                        List<SSBGAssnsEntity> SSBGSelAssns = SSBGCAMS_List.FindAll(u => u.SBASGoal.Equals(GEntity.SBGGCode) && u.SBASOBJ.Equals(GEntity.SBGGSeq));
                                        List<SSBGAssnsEntity> SelCAs = SSBGSelAssns.FindAll(u => u.SBAS_CAMS_Type.Equals("CA"));
                                        List<SSBGAssnsEntity> SelMSs = SSBGSelAssns.FindAll(u => u.SBAS_CAMS_Type.Equals("MS"));

                                        dtObj = CreationDatatable(SSBGSelAssns, SSBGSelSerPlan, SBGGCountType, Type2);
                                        List<CASEACTEntity> selCaseact = new List<CASEACTEntity>();
                                        List<Captain.Common.Utilities.ListItem> SelLists = new List<Utilities.ListItem>();

                                        var SPMResult = (from a in CaseSPMList join s in SSBGSelSerPlan on a.service_plan equals s.SBSPSerPlan select a).ToList();
                                        var CAResult = (from a in SP_Activity_Details join s in SelCAs on a.ACT_Code equals s.SBAS_CAMS_Code select a).ToList();
                                        var MSResult = (from a in SP_MS_Details join s in SelMSs on a.MS_Code equals s.SBAS_CAMS_Code select a).ToList();

                                        if (SBGGCountType == "S" || SBGGCountType == "C" || Type2 == "S" || Type2 == "C")
                                        {
                                            if (SPMResult.Count > 0)
                                            {
                                                var Apps = SPMResult.GroupBy(n => new { n.app_no, n.service_plan }).Select(g => new { App_no = g.Key.app_no, g.Key.service_plan }).ToList();
                                            string Privapp = string.Empty; DataRow dr = dtObj.NewRow(); bool Isfirst = false;
                                                foreach (var Entity in Apps)
                                                {

                                                    if (Privapp != Entity.App_no)
                                                    {
                                                        if (Isfirst)
                                                        {
                                                            dtObj.Rows.Add(dr);
                                                            dr = dtObj.NewRow();
                                                        }
                                                        dr.SetField("GoalCd", GEntity.SBGGCode);
                                                        dr.SetField("ObjCd", GEntity.SBGGSeq.Trim());
                                                        dr.SetField("Goal", GoalDesc);
                                                        dr.SetField("Objective", GEntity.SBGGDesc.Trim());
                                                        dr.SetField("Type", SBGGCountType.Trim());
                                                        dr.SetField("Type2", Type2.Trim());
                                                        dr.SetField("AppNo", Entity.App_no);
                                                        CASESPMEntity MstEntity = CaseSPMList.Find(u => u.app_no.Equals(Entity.App_no.Trim()));
                                                        string AppName = string.Empty;
                                                        if (MstEntity != null)
                                                            AppName = LookupDataAccess.GetMemberName(MstEntity.FirstName.Trim(), MstEntity.MiddleName.Trim(), MstEntity.LastName.Trim(), BaseForm.BaseHierarchyCnFormat);

                                                        dr.SetField("Name", AppName);

                                                        string SPMStrtDt = string.Empty, SPMCmpltdDt = string.Empty;
                                                        if (SPMResult.FindAll(u => u.app_no.Equals(Entity.App_no) && u.service_plan.Equals(Entity.service_plan)).Count > 0)
                                                        {
                                                            if (SPMResult.FindAll(u => u.app_no.Equals(Entity.App_no) && u.service_plan.Equals(Entity.service_plan) && Convert.ToDateTime(u.startdate.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.startdate.Trim()) <= dtpTo.Value).Count > 0)
                                                                SPMStrtDt = SPMResult.Find(u => u.app_no.Equals(Entity.App_no) && u.service_plan.Equals(Entity.service_plan) && Convert.ToDateTime(u.startdate.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.startdate.Trim()) <= dtpTo.Value).startdate.Trim();
                                                            else if (SPMResult.FindAll(u => u.app_no.Equals(Entity.App_no) && u.service_plan.Equals(Entity.service_plan) && Convert.ToDateTime(u.startdate.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.startdate.Trim()) <= Ref_To_Date.Value).Count > 0)
                                                                SPMStrtDt = SPMResult.Find(u => u.app_no.Equals(Entity.App_no) && u.service_plan.Equals(Entity.service_plan) && Convert.ToDateTime(u.startdate.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.startdate.Trim()) <= Ref_To_Date.Value).startdate.Trim();
                                                            else
                                                                SPMStrtDt = SPMResult.Find(u => u.app_no.Equals(Entity.App_no) && u.service_plan.Equals(Entity.service_plan)).startdate.Trim();

                                                            if (!string.IsNullOrEmpty(SPMStrtDt.Trim())) SPMStrtDt = "S-" + LookupDataAccess.Getdate(SPMStrtDt.Trim());

                                                            if (SPMResult.FindAll(u => u.app_no.Equals(Entity.App_no) && u.service_plan.Equals(Entity.service_plan) && u.compdate.Trim() != "").Count > 0)
                                                            {
                                                                List<CASESPMEntity> SelSPMResult = SPMResult.FindAll(u => u.app_no.Equals(Entity.App_no) && u.service_plan.Equals(Entity.service_plan) && u.compdate.Trim() != "");

                                                                if (SelSPMResult.FindAll(u => u.app_no.Equals(Entity.App_no) && u.service_plan.Equals(Entity.service_plan) && Convert.ToDateTime(u.compdate.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.compdate.Trim()) <= dtpTo.Value).Count > 0)
                                                                    SPMCmpltdDt = SelSPMResult.Find(u => u.app_no.Equals(Entity.App_no) && u.service_plan.Equals(Entity.service_plan) && Convert.ToDateTime(u.compdate.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.compdate.Trim()) <= dtpTo.Value).compdate.Trim();
                                                                else if (SelSPMResult.FindAll(u => u.app_no.Equals(Entity.App_no) && u.service_plan.Equals(Entity.service_plan) && Convert.ToDateTime(u.compdate.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.compdate.Trim()) <= Ref_To_Date.Value).Count > 0)
                                                                    SPMCmpltdDt = SelSPMResult.Find(u => u.app_no.Equals(Entity.App_no) && u.service_plan.Equals(Entity.service_plan) && Convert.ToDateTime(u.compdate.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.compdate.Trim()) <= Ref_To_Date.Value).compdate.Trim();
                                                                else
                                                                    SPMCmpltdDt = SPMResult.Find(u => u.app_no.Equals(Entity.App_no) && u.service_plan.Equals(Entity.service_plan)).compdate.Trim();
                                                            }
                                                            
                                                            if (!string.IsNullOrEmpty(SPMCmpltdDt.Trim())) { if (!string.IsNullOrEmpty(SPMStrtDt.Trim())) SPMCmpltdDt = ", C-" + LookupDataAccess.Getdate(SPMCmpltdDt.Trim()); else SPMCmpltdDt = "C-" + LookupDataAccess.Getdate(SPMCmpltdDt.Trim()); }
                                                        }

                                                        if ((SBGGCountType == "S" && Type2 == "C") || (SBGGCountType == "C" && Type2 == "S"))
                                                            dr.SetField(Entity.service_plan.Trim(), SPMStrtDt + SPMCmpltdDt);
                                                        else if ((SBGGCountType == "S" && Type2 == "S") || (SBGGCountType == "S" && Type2 == "") || (SBGGCountType == "" && Type2 == "S"))
                                                            dr.SetField(Entity.service_plan.Trim(), SPMStrtDt);
                                                        else if ((SBGGCountType == "C" && Type2 == "C") || (SBGGCountType == "C" && Type2 == "") || (SBGGCountType == "C" && Type2 == ""))
                                                            dr.SetField(Entity.service_plan.Trim(), SPMCmpltdDt);
                                                        else if (SBGGCountType == "S" || Type2 == "S")
                                                            dr.SetField(Entity.service_plan.Trim(), SPMStrtDt);
                                                        else if (SBGGCountType == "C" || Type2 == "C")
                                                            dr.SetField(Entity.service_plan.Trim(), SPMCmpltdDt);

                                                        Isfirst = true;

                                                    }
                                                    Privapp = Entity.App_no;
                                                }
                                                if (dr != null)
                                                    dtObj.Rows.Add(dr);
                                            }
                                        }
                                        else
                                        {
                                            if (CAResult.Count > 0 || MSResult.Count > 0)
                                            {
                                                var SApps = CAResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var SMSApps = MSResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (SMSApps.Count > 0)
                                                    SApps.AddRange(SMSApps);
                                                SApps = SApps.OrderBy(u => u.App_no).ToList();
                                                string Privapp = string.Empty; DataRow dr = dtObj.NewRow(); bool Isfirst = false;
                                                foreach (var Entity in SApps)
                                                {

                                                    if (Privapp != Entity.App_no)
                                                    {
                                                        if (Isfirst)
                                                        {
                                                            dtObj.Rows.Add(dr);
                                                            dr = dtObj.NewRow();
                                                        }
                                                        dr.SetField("GoalCd", GEntity.SBGGCode);
                                                        dr.SetField("ObjCd", GEntity.SBGGSeq.Trim());
                                                        dr.SetField("Goal", GoalDesc);
                                                        dr.SetField("Objective", GEntity.SBGGDesc.Trim());
                                                        dr.SetField("Type", SBGGCountType.Trim());
                                                        dr.SetField("Type2", Type2.Trim());
                                                        dr.SetField("AppNo", Entity.App_no);
                                                        CASEACTEntity MstEntity = SP_Activity_Details.Find(u => u.App_no.Equals(Entity.App_no.Trim()));
                                                        string AppName = string.Empty;
                                                        if (MstEntity != null)
                                                            AppName = LookupDataAccess.GetMemberName(MstEntity.FirstName.Trim(), MstEntity.MiddleName.Trim(), MstEntity.LastName.Trim(), BaseForm.BaseHierarchyCnFormat);
                                                        else
                                                        {
                                                            CASEMSEntity MsEntity = SP_MS_Details.Find(u => u.App_no.Equals(Entity.App_no.Trim()));
                                                            if (MsEntity != null)
                                                                AppName = LookupDataAccess.GetMemberName(MsEntity.FirstName.Trim(), MsEntity.MiddleName.Trim(), MsEntity.LastName.Trim(), BaseForm.BaseHierarchyCnFormat);
                                                        }
                                                        dr.SetField("Name", AppName);
                                                        string ActDate = string.Empty;
                                                        if (CAResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code)).Count > 0)
                                                        {
                                                            if (CAResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code) && Convert.ToDateTime(u.ACT_Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= dtpTo.Value).Count > 0)
                                                                ActDate = CAResult.Find(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code) && Convert.ToDateTime(u.ACT_Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= dtpTo.Value).ACT_Date.Trim();
                                                            else if (CAResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code) && Convert.ToDateTime(u.ACT_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= Ref_To_Date.Value).Count > 0)
                                                                ActDate = CAResult.Find(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code) && Convert.ToDateTime(u.ACT_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= Ref_To_Date.Value).ACT_Date.Trim();
                                                            else
                                                                ActDate = CAResult.Find(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code)).ACT_Date.Trim();
                                                        }
                                                        if (string.IsNullOrEmpty(ActDate.Trim()))
                                                        {
                                                            if (MSResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code)).Count > 0)
                                                            {
                                                                if (MSResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code) && Convert.ToDateTime(u.Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.Date.Trim()) <= dtpTo.Value).Count > 0)
                                                                    ActDate = MSResult.Find(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code) && Convert.ToDateTime(u.Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.Date.Trim()) <= dtpTo.Value).Date.Trim();
                                                                else if (MSResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code) && Convert.ToDateTime(u.Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Date.Trim()) <= Ref_To_Date.Value).Count > 0)
                                                                    ActDate = MSResult.Find(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code) && Convert.ToDateTime(u.Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Date.Trim()) <= Ref_To_Date.Value).Date.Trim();
                                                                else
                                                                    ActDate = MSResult.Find(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code)).Date.Trim();

                                                                //ActDate = MSResult.Find(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code)).Date.Trim();
                                                            }
                                                        }
                                                        dr.SetField(Entity.ACT_Code.Trim(), LookupDataAccess.Getdate(ActDate.Trim()));
                                                        Isfirst = true;
                                                    }
                                                    else
                                                    {
                                                        string ActDate = string.Empty;
                                                        if (CAResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code)).Count > 0)
                                                        {
                                                            if (CAResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code) && Convert.ToDateTime(u.ACT_Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= dtpTo.Value).Count > 0)
                                                                ActDate = CAResult.Find(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code) && Convert.ToDateTime(u.ACT_Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= dtpTo.Value).ACT_Date.Trim();
                                                            else if (CAResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code) && Convert.ToDateTime(u.ACT_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= Ref_To_Date.Value).Count > 0)
                                                                ActDate = CAResult.Find(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code) && Convert.ToDateTime(u.ACT_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= Ref_To_Date.Value).ACT_Date.Trim();
                                                            else
                                                                ActDate = CAResult.Find(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code)).ACT_Date.Trim();

                                                            //ActDate = CAResult.Find(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code)).ACT_Date.Trim();
                                                        }
                                                    
                                                        if (string.IsNullOrEmpty(ActDate.Trim()))
                                                        {
                                                            if (MSResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code)).Count > 0)
                                                            {
                                                                if (MSResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code) && Convert.ToDateTime(u.Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.Date.Trim()) <= dtpTo.Value).Count > 0)
                                                                    ActDate = MSResult.Find(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code) && Convert.ToDateTime(u.Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.Date.Trim()) <= dtpTo.Value).Date.Trim();
                                                                else if (MSResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code) && Convert.ToDateTime(u.Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Date.Trim()) <= Ref_To_Date.Value).Count > 0)
                                                                    ActDate = MSResult.Find(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code) && Convert.ToDateTime(u.Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Date.Trim()) <= Ref_To_Date.Value).Date.Trim();
                                                                else
                                                                    ActDate = MSResult.Find(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code)).Date.Trim();

                                                                //ActDate = MSResult.Find(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code)).Date.Trim();
                                                            }
                                                        }
                                                        dr.SetField(Entity.ACT_Code.Trim(), LookupDataAccess.Getdate(ActDate.Trim()));
                                                    }

                                                    Privapp = Entity.App_no;
                                                }
                                                if (dr != null)
                                                    dtObj.Rows.Add(dr);
                                            }
                                        }

                                        var CASEEKResult = CAResult.FindAll(u => !(u.ActSeek_Date.Trim().Equals("")));
                                        var CAAccessResult = CAResult.FindAll(u => Convert.ToDateTime(u.ACT_Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= dtpTo.Value);
                                        if (CASEEKResult.Count > 0)
                                            CASEEKResult = CASEEKResult.FindAll(u => Convert.ToDateTime(u.ActSeek_Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.ActSeek_Date.Trim()) <= dtpTo.Value);

                                        var MSSEEKResult = MSResult.FindAll(u => !(u.Seek_Date.Trim().Equals("")));
                                        var MSAccessResult = MSResult.FindAll(u => Convert.ToDateTime(u.Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.Date.Trim()) <= dtpTo.Value);
                                        if (MSSEEKResult.Count > 0)
                                            MSSEEKResult = MSSEEKResult.FindAll(u => Convert.ToDateTime(u.Seek_Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.Seek_Date.Trim()) <= dtpTo.Value);

                                        //var YEARCAResult = (from a in YEAR_SP_Activity_Details join s in SelCAs on a.ACT_Code equals s.SBAS_CAMS_Code select a).ToList();
                                        //var YEARMSResult = (from a in YEAR_SP_MS_Details join s in SelMSs on a.MS_Code equals s.SBAS_CAMS_Code select a).ToList();

                                        string SeekCount = string.Empty; string AccessCount = string.Empty; string YrdtCnt = string.Empty; string YrdtSeekCnt = string.Empty;
                                        if (SBGGCountType == "S" || Type2 == "S")
                                        {
                                            string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;


                                            var YearSpmrecs = SPMResult.FindAll(u => !(u.startdate.Trim().Equals("")));
                                            if (YearSpmrecs.Count > 0)
                                                YearSpmrecs = YearSpmrecs.FindAll(u => Convert.ToDateTime(u.startdate.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.startdate.Trim()) <= Ref_To_Date.Value);
                                            var Spmrecs = SPMResult.FindAll(u => !(u.startdate.Trim().Equals("")));
                                            if (Spmrecs.Count > 0)
                                                Spmrecs = Spmrecs.FindAll(u => Convert.ToDateTime(u.startdate.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.startdate.Trim()) <= dtpTo.Value);

                                            if (SBGGCountType == "S")
                                            {
                                                var YrcountApps = YearSpmrecs.GroupBy(n => new { n.app_no, n.service_plan }).Select(g => new { App_no = g.Key.app_no, g.Key.service_plan }).ToList();
                                                //= YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearSeek = YrcountApps.Select(u => u.App_no.Trim()).Distinct().Count();

                                                var countApps = Spmrecs.GroupBy(n => new { n.app_no, n.service_plan }).Select(g => new { App_no = g.Key.app_no, g.Key.service_plan }).ToList();
                                                //var countApps = Spmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                Seek = countApps.Select(u => u.App_no.Trim()).Distinct().Count();

                                                if (countApps.Count > 0 || YrcountApps.Count > 0)
                                                {
                                                    var SelAccessApp = countApps.Select(u => u.App_no.Trim()).Distinct().ToList();
                                                    var SelYearApp = YrcountApps.Select(u => u.App_no.Trim()).Distinct().ToList();
                                                    if (dtObj.Rows.Count > 0)
                                                    {
                                                        int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                        foreach (DataRow row1 in dtObj.Rows)
                                                        {
                                                            foreach (var App in SelAccessApp)
                                                            {
                                                                if (App == row1["AppNo"].ToString())
                                                                {
                                                                    row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; break;
                                                                }
                                                            }

                                                            foreach (var App in SelYearApp)
                                                            {
                                                                if (App == row1["AppNo"].ToString())
                                                                {
                                                                    row1.SetField("YeartoDateSeek", rowCountYear + 1); rowCountYear++; break;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            if (Type2 == "S")
                                            {
                                                var YrcountApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearSeek = YrcountApps.Select(u => u.AppNo.Trim()).Distinct().Count();

                                                var countApps = Spmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                Seek = countApps.Select(u => u.AppNo.Trim()).Distinct().Count();

                                                if (countApps.Count > 0 || YrcountApps.Count > 0)
                                                {
                                                    var SelAccessApp = countApps.Select(u => u.AppNo.Trim()).Distinct().ToList();
                                                    var SelYearApp = YrcountApps.Select(u => u.AppNo.Trim()).Distinct().ToList();
                                                    if (dtObj.Rows.Count > 0)
                                                    {
                                                        int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                        foreach (DataRow row1 in dtObj.Rows)
                                                        {
                                                            foreach (var App in SelAccessApp)
                                                            {
                                                                if (App == row1["AppNo"].ToString())
                                                                {
                                                                    row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; break;
                                                                }
                                                            }

                                                            foreach (var App in SelYearApp)
                                                            {
                                                                if (App == row1["AppNo"].ToString())
                                                                {
                                                                    row1.SetField("YeartoDateSeek", rowCountYear + 1); rowCountYear++; break;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                            if (Seek > 0) SeekCount = Seek.ToString(); if (Access > 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();

                                            //var SpmCARecs = (from b in YearSpmrecs join t in CAResult on b.app_no equals t.App_no select t).ToList();
                                            //var SpmMSRecs = (from b in YearSpmrecs join t in MSResult on b.app_no equals t.App_no select t).ToList();

                                            //var CASResult = (from a in SP_Activity_Details join s in SelCAs on a.ACT_Code equals s.SBAS_CAMS_Code select a).ToList();
                                            //var MSSResult = (from a in SP_MS_Details join s in SelMSs on a.MS_Code equals s.SBAS_CAMS_Code select a).ToList();
                                        }

                                        if (SBGGCountType == "C" || Type2 == "C")
                                        {
                                            string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;
                                            var YearSpmrecs = SPMResult.FindAll(u => !(u.compdate.Trim().Equals("")));
                                            if (YearSpmrecs.Count > 0)
                                                YearSpmrecs = YearSpmrecs.FindAll(u => Convert.ToDateTime(u.compdate.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.compdate.Trim()) <= Ref_To_Date.Value);
                                            var Spmrecs = SPMResult.FindAll(u => !(u.compdate.Trim().Equals("")));
                                            if (Spmrecs.Count > 0)
                                                Spmrecs = Spmrecs.FindAll(u => Convert.ToDateTime(u.compdate.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.compdate.Trim()) <= dtpTo.Value);

                                            if (SBGGCountType == "C")
                                            {
                                                var YrcountApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearAccess = YrcountApps.Select(u => u.AppNo.Trim()).Distinct().Count();

                                                var countApps = Spmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                Access = countApps.Select(u => u.AppNo.Trim()).Distinct().Count();

                                                if (countApps.Count > 0 || YrcountApps.Count > 0)
                                                {
                                                    var SelAccessApp = countApps.Select(u => u.AppNo.Trim()).Distinct().ToList();
                                                    var SelYearApp = YrcountApps.Select(u => u.AppNo.Trim()).Distinct().ToList();
                                                    if (dtObj.Rows.Count > 0)
                                                    {
                                                        int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                        foreach (DataRow row1 in dtObj.Rows)
                                                        {
                                                            foreach (var App in SelAccessApp)
                                                            {
                                                                if (App == row1["AppNo"].ToString())
                                                                {
                                                                    row1.SetField("Access", rowCountSeek + 1); rowCountSeek++; break;
                                                                }
                                                            }

                                                            foreach (var App in SelYearApp)
                                                            {
                                                                if (App == row1["AppNo"].ToString())
                                                                {
                                                                    row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; break;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }

                                            }

                                            if (Type2 == "C")
                                            {
                                                var YrcountApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearAccess = YrcountApps.Select(u => u.AppNo.Trim()).Distinct().Count();

                                                var countApps = Spmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                Access = countApps.Select(u => u.AppNo.Trim()).Distinct().Count();

                                                if (countApps.Count > 0 || YrcountApps.Count > 0)
                                                {
                                                    var SelSeekApp = countApps.Select(u => u.AppNo.Trim()).Distinct().ToList();
                                                    var SelYearApp = YrcountApps.Select(u => u.AppNo.Trim()).Distinct().ToList();
                                                    if (dtObj.Rows.Count > 0)
                                                    {
                                                        int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                        foreach (DataRow row1 in dtObj.Rows)
                                                        {
                                                            foreach (var App in SelSeekApp)
                                                            {
                                                                if (App == row1["AppNo"].ToString())
                                                                {
                                                                    row1.SetField("Access", rowCountSeek + 1); rowCountSeek++; break;
                                                                }
                                                            }

                                                            foreach (var App in SelYearApp)
                                                            {
                                                                if (App == row1["AppNo"].ToString())
                                                                {
                                                                    row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; break;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }


                                            }
                                            if (Seek > 0) SeekCount = Seek.ToString(); if (Access > 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();

                                            //var SpmCARecs = (from b in YearSpmrecs join t in CAResult on b.app_no equals t.App_no select t).ToList();
                                            //var SpmMSRecs = (from b in YearSpmrecs join t in MSResult on b.app_no equals t.App_no select t).ToList();

                                            //var CASResult = (from a in SP_Activity_Details join s in SelCAs on a.ACT_Code equals s.SBAS_CAMS_Code select a).ToList();
                                            //var MSSResult = (from a in SP_MS_Details join s in SelMSs on a.MS_Code equals s.SBAS_CAMS_Code select a).ToList();
                                        }

                                        if (SBGGCountType == "A" || Type2 == "A")
                                        {
                                            string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;
                                            if (Type2 == "A")
                                            {
                                                var SApps = CASEEKResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var SMSApps = MSSEEKResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (SMSApps.Count > 0)
                                                    SApps.AddRange(SMSApps);

                                                var countApps = SApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();

                                                var YrCASEEKResult = CAResult.FindAll(u => !(u.ActSeek_Date.Trim().Equals("")));
                                                var YearSKrecs = YrCASEEKResult.FindAll(u => Convert.ToDateTime(u.ActSeek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ActSeek_Date.Trim()) <= Ref_To_Date.Value);
                                                var YearSKApps = YearSKrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var YrMSSEEKResult = MSResult.FindAll(u => !(u.Seek_Date.Trim().Equals("")));
                                                var YearSKMSrecs = YrMSSEEKResult.FindAll(u => Convert.ToDateTime(u.Seek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Seek_Date.Trim()) <= Ref_To_Date.Value);
                                                var YearSKMSApps = YearSKMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (YearSKMSApps.Count > 0)
                                                    YearSKApps.AddRange(YearSKMSApps);

                                                var YearSKcountApps = YearSKApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearSeek = YearSKcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count)).Count;

                                                Seek = countApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count)).Count;

                                                if (countApps.Count > 0)
                                                {
                                                    if ((GEntity.SBGGCountType == "C" || GEntity.Type2 == "C") || (GEntity.SBGGCountType == "S" || GEntity.Type2 == "S"))
                                                    {
                                                    }
                                                    else
                                                    {
                                                        var SelSeekApp = countApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count));
                                                        var SelYearApp = YearSKcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count));
                                                        if (dtObj.Rows.Count > 0)
                                                        {
                                                            int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                            foreach (DataRow row1 in dtObj.Rows)
                                                            {
                                                                if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; }
                                                                if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("YeartoDateSeek", rowCountYear + 1); rowCountYear++; }
                                                            }
                                                        }
                                                    }
                                                }

                                            }
                                            if (SBGGCountType == "A")
                                            {
                                                var AApps = CAAccessResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var AMSApps = MSAccessResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (AMSApps.Count > 0)
                                                    AApps.AddRange(AMSApps);

                                                var AcountApps = AApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                Access = AcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count)).Count;

                                                var YrCASEEKResult = CAResult.FindAll(u => !(u.ACT_Date.Trim().Equals("")));
                                                var Yearrecs = YrCASEEKResult.FindAll(u => Convert.ToDateTime(u.ACT_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= Ref_To_Date.Value);
                                                var YearSApps = Yearrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var YrMSSEEKResult = MSResult.FindAll(u => !(u.Date.Trim().Equals("")));
                                                var YearMSrecs = YrMSSEEKResult.FindAll(u => Convert.ToDateTime(u.Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Date.Trim()) <= Ref_To_Date.Value);
                                                var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (YearSMSApps.Count > 0)
                                                    YearSApps.AddRange(YearSMSApps);

                                                var YearcountApps = YearSApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearAccess = YearcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count)).Count;

                                                if (AcountApps.Count > 0 || YearcountApps.Count > 0)
                                                {
                                                    if ((GEntity.SBGGCountType == "C" || GEntity.Type2 == "C") || (GEntity.SBGGCountType == "S" || GEntity.Type2 == "S"))
                                                    {
                                                    }
                                                    else
                                                    {
                                                        //var SelSeekApp = countApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count));
                                                        var SelAccessApp = AcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count));
                                                        var SelYearApp = YearcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count));
                                                        if (dtObj.Rows.Count > 0)
                                                        {
                                                            int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                            foreach (DataRow row1 in dtObj.Rows)
                                                            {
                                                                //if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                //{ row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; }
                                                                if (SelAccessApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("Access", rowCountAccess + 1); rowCountAccess++; }
                                                                if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; }
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            if (Seek > 0) SeekCount = Seek.ToString(); if (Access > 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();
                                        }

                                        if (SBGGCountType == "N" || Type2 == "N")
                                        {
                                            string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;
                                            if (GEntity.Type2 == "N")
                                            {
                                                var SApps = CASEEKResult.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                var SMSApps = MSSEEKResult.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                if (SMSApps.Count > 0)
                                                    SApps.AddRange(SMSApps);

                                                //var countApps = SApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();

                                                Seek = SApps.Select(u => u.App_no.Trim()).Distinct().Count();
                                                //countApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count)).Count.ToString();

                                                var YrCASEEKResult = CAResult.FindAll(u => !(u.ActSeek_Date.Trim().Equals("")));
                                                var Yearrecs = YrCASEEKResult.FindAll(u => Convert.ToDateTime(u.ActSeek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ActSeek_Date.Trim()) <= Ref_To_Date.Value);

                                                var YrMSSEEKResult = MSResult.FindAll(u => !(u.Seek_Date.Trim().Equals("")));
                                                var YearMSrecs = YrMSSEEKResult.FindAll(u => Convert.ToDateTime(u.Seek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Seek_Date.Trim()) <= Ref_To_Date.Value);

                                                var YearSApps = Yearrecs.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                if (YearSMSApps.Count > 0)
                                                    YearSApps.AddRange(YearSMSApps);

                                                YearSeek = YearSApps.Select(u => u.App_no.Trim()).Distinct().Count();

                                                if (SApps.Count > 0)
                                                {
                                                    if ((SBGGCountType == "C" || Type2 == "C") || (SBGGCountType == "S" || Type2 == "S"))
                                                    {
                                                    }
                                                    else
                                                    {
                                                        var SelSeekApp = SApps.Select(u => u.App_no.Trim()).Distinct().ToList();
                                                        //var SelAccessApp = AApps.Select(u => u.App_no.Trim()).Distinct().ToList();
                                                        var SelYearApp = YearSApps.Select(u => u.App_no.Trim()).Distinct().ToList();
                                                        if (dtObj.Rows.Count > 0)
                                                        {
                                                            int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                            foreach (DataRow row1 in dtObj.Rows)
                                                            {
                                                                foreach (var App in SelSeekApp)
                                                                {
                                                                    if (App == row1["AppNo"].ToString())
                                                                    {
                                                                        row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; break;
                                                                    }
                                                                }

                                                                foreach (var App in SelYearApp)
                                                                {
                                                                    if (App == row1["AppNo"].ToString())
                                                                    {
                                                                        row1.SetField("YeartoDateSeek", rowCountYear + 1); rowCountYear++; break;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                            if (SBGGCountType == "N")
                                            {
                                                var AApps = CAAccessResult.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                var AMSApps = MSAccessResult.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                if (AMSApps.Count > 0)
                                                    AApps.AddRange(AMSApps);

                                                //var AcountApps = SApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                Access = AApps.Select(u => u.App_no.Trim()).Distinct().Count();

                                                var YrCASEEKResult = CAResult.FindAll(u => !(u.ACT_Date.Trim().Equals("")));
                                                var Yearrecs = YrCASEEKResult.FindAll(u => Convert.ToDateTime(u.ACT_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= Ref_To_Date.Value);

                                                var YrMSSEEKResult = MSResult.FindAll(u => !(u.Date.Trim().Equals("")));
                                                var YearMSrecs = YrMSSEEKResult.FindAll(u => Convert.ToDateTime(u.Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Date.Trim()) <= Ref_To_Date.Value);

                                                var YearSApps = Yearrecs.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                if (YearSMSApps.Count > 0)
                                                    YearSApps.AddRange(YearSMSApps);

                                                YearAccess = YearSApps.Select(u => u.App_no.Trim()).Distinct().Count();

                                                if (AApps.Count > 0 || YearSApps.Count > 0)
                                                {
                                                    if ((SBGGCountType == "C" || Type2 == "C") || (SBGGCountType == "S" || Type2 == "S"))
                                                    {
                                                    }
                                                    else
                                                    {
                                                        //var SelSeekApp = SApps.Select(u => u.App_no.Trim()).Distinct().ToList();
                                                        var SelAccessApp = AApps.Select(u => u.App_no.Trim()).Distinct().ToList();
                                                        var SelYearApp = YearSApps.Select(u => u.App_no.Trim()).Distinct().ToList();
                                                        if (dtObj.Rows.Count > 0)
                                                        {
                                                            int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                            foreach (DataRow row1 in dtObj.Rows)
                                                            {
                                                                //foreach (var App in SelSeekApp)
                                                                //{
                                                                //    if (App == row1["AppNo"].ToString())
                                                                //    {
                                                                //        row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; break;
                                                                //    }
                                                                //}
                                                                foreach (var App in SelAccessApp)
                                                                {
                                                                    if (App == row1["AppNo"].ToString())
                                                                    {
                                                                        row1.SetField("Access", rowCountAccess + 1); rowCountAccess++; break;
                                                                    }
                                                                }
                                                                foreach (var App in SelYearApp)
                                                                {
                                                                    if (App == row1["AppNo"].ToString())
                                                                    {
                                                                        row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; break;
                                                                    }
                                                                }
                                                                //if (SelAccessApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                //    row1.SetField("Access", rowCountAccess++);
                                                                //if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                //    row1.SetField("YeartoDate", rowCountYear++);
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            if (Seek != 0) SeekCount = Seek.ToString(); if (Access != 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();
                                        }

                                        if (SBGGCountType == "1" || Type2 == "1")
                                        {
                                            string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;
                                            if (Type2 == "1")
                                            {
                                                var SApps = CASEEKResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                var SMSApps = MSSEEKResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                if (SMSApps.Count > 0)
                                                    SApps.AddRange(SMSApps);

                                                var countApps = SApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();

                                                Seek = countApps.FindAll(u => u.Count < 3 && u.Count > 1).Count;

                                                var YrCASEEKResult = CAResult.FindAll(u => !(u.ActSeek_Date.Trim().Equals("")));
                                                var Yearrecs = YrCASEEKResult.FindAll(u => Convert.ToDateTime(u.ActSeek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ActSeek_Date.Trim()) <= Ref_To_Date.Value);

                                                var YrMSSEEKResult = MSResult.FindAll(u => !(u.Seek_Date.Trim().Equals("")));
                                                var YearMSrecs = YrMSSEEKResult.FindAll(u => Convert.ToDateTime(u.Seek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Seek_Date.Trim()) <= Ref_To_Date.Value);

                                                var YearSApps = Yearrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (YearSMSApps.Count > 0)
                                                    YearSApps.AddRange(YearSMSApps);

                                                var YearcountApps = YearSApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearSeek = YearcountApps.FindAll(u => u.Count < 3 && u.Count > 1).Count;

                                                if (SApps.Count > 0)
                                                {
                                                    if ((SBGGCountType == "C" || Type2 == "C") || (SBGGCountType == "S" || Type2 == "S"))
                                                    {
                                                    }
                                                    else
                                                    {
                                                        var SelSeekApp = countApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
                                                        //var SelAccessApp = AcountApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
                                                        var SelYearApp = YearcountApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
                                                        if (dtObj.Rows.Count > 0)
                                                        {
                                                            int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                            foreach (DataRow row1 in dtObj.Rows)
                                                            {
                                                                if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                {
                                                                    row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++;
                                                                }
                                                                if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("YeartoDateSeek", rowCountYear + 1); rowCountYear++; }
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            if (SBGGCountType == "1")
                                            {
                                                var AApps = CAAccessResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                var AMSApps = MSAccessResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                if (AMSApps.Count > 0)
                                                    AApps.AddRange(AMSApps);

                                                var AcountApps = AApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                Access = AcountApps.FindAll(u => u.Count < 3 && u.Count > 1).Count;

                                                var YrCASEEKResult = CAResult.FindAll(u => !(u.ACT_Date.Trim().Equals("")));
                                                var Yearrecs = YrCASEEKResult.FindAll(u => Convert.ToDateTime(u.ACT_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= Ref_To_Date.Value);

                                                var YrMSSEEKResult = MSResult.FindAll(u => !(u.Date.Trim().Equals("")));
                                                var YearMSrecs = YrMSSEEKResult.FindAll(u => Convert.ToDateTime(u.Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Date.Trim()) <= Ref_To_Date.Value);

                                                var YearSApps = Yearrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (YearSMSApps.Count > 0)
                                                    YearSApps.AddRange(YearSMSApps);

                                                var YearcountApps = YearSApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearAccess = YearcountApps.FindAll(u => u.Count < 3 && u.Count > 1).Count;

                                                if (AApps.Count > 0 || YearSApps.Count > 0)
                                                {
                                                    if ((GEntity.SBGGCountType == "C" || GEntity.Type2 == "C") || (GEntity.SBGGCountType == "S" || GEntity.Type2 == "S"))
                                                    {
                                                    }
                                                    else
                                                    {
                                                        //var SelSeekApp = countApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
                                                        var SelAccessApp = AcountApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
                                                        var SelYearApp = YearcountApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
                                                        if (dtObj.Rows.Count > 0)
                                                        {
                                                            int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                            foreach (DataRow row1 in dtObj.Rows)
                                                            {
                                                                //if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                //{
                                                                //    row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++;
                                                                //}
                                                                if (SelAccessApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("Access", rowCountAccess + 1); rowCountAccess++; }
                                                                if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; }

                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            if (Seek != 0) SeekCount = Seek.ToString(); if (Access != 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();
                                        }

                                        if (SBGGCountType == "2" || Type2 == "2")
                                        {
                                            string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;
                                            if (Type2 == "2")
                                            {
                                                var SApps = CASEEKResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                var SMSApps = MSSEEKResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                if (SMSApps.Count > 0)
                                                    SApps.AddRange(SMSApps);

                                                var countApps = SApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();

                                                Seek = countApps.FindAll(u => u.Count > 2).Count;

                                                var YrCASEEKResult = CAResult.FindAll(u => !(u.ActSeek_Date.Trim().Equals("")));
                                                var Yearrecs = YrCASEEKResult.FindAll(u => Convert.ToDateTime(u.ActSeek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ActSeek_Date.Trim()) <= Ref_To_Date.Value);

                                                var YrMSSEEKResult = MSResult.FindAll(u => !(u.Seek_Date.Trim().Equals("")));
                                                var YearMSrecs = YrMSSEEKResult.FindAll(u => Convert.ToDateTime(u.Seek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Seek_Date.Trim()) <= Ref_To_Date.Value);

                                                var YearSApps = Yearrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (YearSMSApps.Count > 0)
                                                    YearSApps.AddRange(YearSMSApps);

                                                var YearcountApps = YearSApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearSeek = YearcountApps.FindAll(u => u.Count > 2).Count;

                                                if (SApps.Count > 0)
                                                {
                                                    if ((SBGGCountType == "C" || Type2 == "C") || (SBGGCountType == "S" || Type2 == "S"))
                                                    {
                                                    }
                                                    else
                                                    {
                                                        var SelSeekApp = countApps.FindAll(u => u.Count > 2).ToList();
                                                        //var SelAccessApp = AcountApps.FindAll(u => u.Count > 2).ToList();
                                                        var SelYearApp = YearcountApps.FindAll(u => u.Count > 2).ToList();
                                                        if (dtObj.Rows.Count > 0)
                                                        {
                                                            int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                            foreach (DataRow row1 in dtObj.Rows)
                                                            {
                                                                if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; }
                                                                //if (SelAccessApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                //{ row1.SetField("Access", rowCountAccess + 1); rowCountAccess++; }
                                                                if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("YeartoDateSeek", rowCountYear + 1); rowCountYear++; }
                                                            }
                                                        }
                                                    }
                                                }

                                            }
                                            if (SBGGCountType == "2")
                                            {
                                                var AApps = CAAccessResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                var AMSApps = MSAccessResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                if (AMSApps.Count > 0)
                                                    AApps.AddRange(AMSApps);

                                                var AcountApps = AApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                Access = AcountApps.FindAll(u => u.Count > 2).Count;

                                                var YrCASEEKResult = CAResult.FindAll(u => !(u.ACT_Date.Trim().Equals("")));
                                                var Yearrecs = YrCASEEKResult.FindAll(u => Convert.ToDateTime(u.ACT_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= Ref_To_Date.Value);

                                                var YrMSSEEKResult = MSResult.FindAll(u => !(u.Date.Trim().Equals("")));
                                                var YearMSrecs = YrMSSEEKResult.FindAll(u => Convert.ToDateTime(u.Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Date.Trim()) <= Ref_To_Date.Value);

                                                var YearSApps = Yearrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (YearSMSApps.Count > 0)
                                                    YearSApps.AddRange(YearSMSApps);

                                                var YearcountApps = YearSApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearAccess = YearcountApps.FindAll(u => u.Count > 2).Count;

                                                if (AApps.Count > 0 || YearSApps.Count > 0)
                                                {
                                                    if ((GEntity.SBGGCountType == "C" || GEntity.Type2 == "C") || (GEntity.SBGGCountType == "S" || GEntity.Type2 == "S"))
                                                    {
                                                    }
                                                    else
                                                    {
                                                        //var SelSeekApp = countApps.FindAll(u => u.Count > 2).ToList();
                                                        var SelAccessApp = AcountApps.FindAll(u => u.Count > 2).ToList();
                                                        var SelYearApp = YearcountApps.FindAll(u => u.Count > 2).ToList();
                                                        if (dtObj.Rows.Count > 0)
                                                        {
                                                            int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                            foreach (DataRow row1 in dtObj.Rows)
                                                            {
                                                                //if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                //{ row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; }
                                                                if (SelAccessApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("Access", rowCountAccess + 1); rowCountAccess++; }
                                                                if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                            if (Seek != 0) SeekCount = Seek.ToString(); if (Access != 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();
                                        }

                                        row = sheet.Table.Rows.Add();
                                        row.Height = 22;
                                        row.AutoFitHeight = false;

                                        S1 = row.Cells.Add(GEntity.SBGGDesc.Trim(), DataType.String, "m2021335933356");
                                        S1.MergeAcross = 7;

                                        S1 = row.Cells.Add(SeekCount, DataType.Number, "s80");
                                        S1 = row.Cells.Add(YrdtSeekCnt, DataType.Number, "s81");
                                        S1 = row.Cells.Add(AccessCount, DataType.Number, "s80");
                                        S1 = row.Cells.Add(YrdtCnt, DataType.Number, "s81");
                                        if (!string.IsNullOrEmpty(YrdtSeekCnt.Trim()))
                                        {
                                            S1 = row.Cells.Add("0", DataType.Number, "s82");
                                            //S1.Data.Type = DataType.Error;
                                            S1.Formula = "+RC[-1]/RC[-3]";
                                        }
                                        else
                                        {
                                            S1 = row.Cells.Add("0", DataType.String, "s82");
                                            //S1.Data.Type = DataType.Error;
                                            ////S1.Formula = "+RC[-2]/RC[-1]";
                                        }

                                        //S1 = row.Cells.Add("", DataType.String, "m95382716");
                                        ////S1.MergeAcross = 1;

                                        if (dtObj.Rows.Count > 0)
                                        {
                                            DatasetFillingObjectives(ObjCnt, dtObj);
                                            ObjCnt++;
                                        }
                                    }
                                    //DatasetFillingObjectives(GoalCnt, dtObj);
                                }
                            }

                            row = sheet.Table.Rows.Add();
                            row.Height = 44;
                            row.AutoFitHeight = false;

                            S1 = row.Cells.Add("Comments:", DataType.String, "m106945024");
                            S1.MergeAcross = 12;



                        }

                    }
                    //if (ds.Tables.Count > 0)
                    //{
                    //    this.GenerateWorksheetReport(book.Worksheets);
                    //    this.GenerateWorksheetBypassReport(book.Worksheets);
                    //}


                    FileStream stream = new FileStream(PdfName, FileMode.Create);

                    book.Save(stream);
                    stream.Close();

                    if (ds.Tables.Count > 0)
                    {
                        PrintHRANBAuditReportIntakes(AuditName, SelSSBG);
                        //PrintAuditReportIntakes(AuditName);
                    }
                    if (dsObj.Tables.Count > 0)
                    {
                        PrintHRANBAuditReportObjective(AuditName, SSBGCAMS_List);
                    }

                    AlertBox.Show("Report Generated Successfully");
                }
                catch (Exception ex) { }

            }
        }

        private void OnHRANB_Report1(object sender, FormClosedEventArgs e)
        {
            PdfListForm form = sender as PdfListForm;
            if (form.DialogResult == DialogResult.OK)
            {
                string PdfName = "Pdf File";
                PdfName = form.GetFileName();
                string AuditName = PdfName;
                //PdfName = strFolderPath + PdfName;
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                try
                {
                    if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                    { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
                }
                catch (Exception ex)
                {
                    AlertBox.Show("Error", MessageBoxIcon.Error);
                }

                try
                {
                    string Tmpstr = PdfName + ".xls";
                    if (File.Exists(Tmpstr))
                        File.Delete(Tmpstr);
                }
                catch (Exception ex)
                {
                    int length = 8;
                    string newFileName = System.Guid.NewGuid().ToString();
                    newFileName = newFileName.Replace("-", string.Empty);

                    Random_Filename = PdfName + newFileName.Substring(0, length) + ".xls";
                }

                if (!string.IsNullOrEmpty(Random_Filename))
                    PdfName = Random_Filename;
                else
                    PdfName += ".xls";

                TableCnt = 1;
                Workbook book = new Workbook();

                Worksheet sheet;
                WorksheetRow row;

                

                #region HeaderSheet

                WorksheetStyle s2986 = book.Styles.Add("s2986");
                s2986.Font.FontName = "Tahoma";
                s2986.Font.Size = 11;
                s2986.Font.Color = "#000000";

                WorksheetStyle style11 = book.Styles.Add("HeaderStyles");
                style11.Font.FontName = "Tahoma";
                style11.Font.Size = 10;
                style11.Interior.Color = "Gray";
                style11.Interior.Pattern = StyleInteriorPattern.Solid;
                style11.Font.Bold = true;
                style11.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style11.Alignment.WrapText = true;
                style11.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle Header1 = book.Styles.Add("HeaderColor");
                Header1.Font.FontName = "Tahoma";
                Header1.Font.Size = 10;
                Header1.Interior.Color = "#9999FF";
                Header1.Interior.Pattern = StyleInteriorPattern.Solid;
                Header1.Font.Bold = true;
                Header1.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                Header1.Alignment.WrapText = true;
                Header1.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                Header1.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                Header1.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                Header1.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle style2 = book.Styles.Add("HeaderStyle");
                style2.Font.FontName = "Tahoma";
                style2.Font.Size = 10;
                style2.Font.Bold = true;
                style2.Interior.Color = "Gray";
                style2.Interior.Pattern = StyleInteriorPattern.Solid;
                style2.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style2.Alignment.WrapText = true;
                style2.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle Header2 = book.Styles.Add("FontWhite");
                Header2.Font.FontName = "Tahoma";
                Header2.Font.Size = 10;
                Header2.Font.Bold = true;
                Header2.Font.Color = "White";
                Header2.Interior.Color = "Gray";
                Header2.Interior.Pattern = StyleInteriorPattern.Solid;
                Header2.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                Header2.Alignment.WrapText = true;
                Header2.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                Header2.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                Header2.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                Header2.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle style5 = book.Styles.Add("HeaderStyleRight");
                style5.Font.FontName = "Tahoma";
                style5.Font.Size = 10;
                style5.Font.Bold = true;
                style5.Interior.Color = "Gray";
                style5.Interior.Pattern = StyleInteriorPattern.Solid;
                style5.Alignment.Horizontal = StyleHorizontalAlignment.Right;
                style5.Alignment.WrapText = true;

                WorksheetStyle style1 = book.Styles.Add("Normal");
                style1.Font.FontName = "Tahoma";
                style1.Font.Size = 10;
                style1.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style1.Alignment.WrapText = true;

                WorksheetStyle style3 = book.Styles.Add("NormalRight");
                style3.Font.FontName = "Tahoma";
                style3.Font.Size = 10;
                style3.Alignment.Horizontal = StyleHorizontalAlignment.Right;
                style3.Alignment.WrapText = true;

                WorksheetStyle style4 = book.Styles.Add("NormalCenter");
                style4.Font.FontName = "Tahoma";
                style4.Font.Size = 10;
                style4.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style4.Alignment.WrapText = true;

                WorksheetStyle style8 = book.Styles.Add("CenterGreen");
                style8.Font.FontName = "Tahoma";
                style8.Interior.Color = "Green";
                style8.Interior.Pattern = StyleInteriorPattern.Solid;
                style8.Font.Size = 10;
                style8.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style8.Alignment.WrapText = true;

                WorksheetStyle style9 = book.Styles.Add("CenterRed");
                style9.Font.FontName = "Tahoma";
                style9.Interior.Color = "Red";
                style9.Interior.Pattern = StyleInteriorPattern.Solid;
                style9.Font.Size = 10;
                style9.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style9.Alignment.WrapText = true;

                WorksheetStyle style10 = book.Styles.Add("RightGreen");
                style10.Font.FontName = "Tahoma";
                style10.Interior.Color = "Green";
                style10.Interior.Pattern = StyleInteriorPattern.Solid;
                style10.Font.Size = 10;
                style10.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style10.Alignment.WrapText = true;

                WorksheetStyle style12 = book.Styles.Add("RightRed");
                style12.Font.FontName = "Tahoma";
                style12.Interior.Color = "Red";
                style12.Interior.Pattern = StyleInteriorPattern.Solid;
                style12.Font.Size = 10;
                style12.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style12.Alignment.WrapText = true;

                WorksheetStyle style13 = book.Styles.Add("NormalGreen");
                style13.Font.FontName = "Tahoma";
                style13.Interior.Color = "Green";
                style13.Interior.Pattern = StyleInteriorPattern.Solid;
                style13.Font.Size = 10;
                style13.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style13.Alignment.WrapText = true;

                WorksheetStyle style14 = book.Styles.Add("NormalRed");
                style14.Font.FontName = "Tahoma";
                style14.Interior.Color = "Red";
                style14.Interior.Pattern = StyleInteriorPattern.Solid;
                style14.Font.Size = 10;
                style14.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style14.Alignment.WrapText = true;

                WorksheetStyle style15 = book.Styles.Add("NormalBold");
                style15.Font.FontName = "Tahoma";
                style15.Font.Size = 12;
                style15.Font.Bold = true;
                style15.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style15.Alignment.WrapText = true;

                WorksheetStyle style16 = book.Styles.Add("NormalGray");
                style16.Font.FontName = "Tahoma";
                style16.Interior.Color = "Gray";
                style16.Interior.Pattern = StyleInteriorPattern.Solid;
                style16.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style16.Font.Size = 12;
                style16.Font.Bold = true;
                style16.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style16.Alignment.WrapText = true;


                sheet = book.Worksheets.Add("Parameters");

                sheet.Table.Columns.Add(new WorksheetColumn(50));
                sheet.Table.Columns.Add(new WorksheetColumn(200));
                sheet.Table.Columns.Add(new WorksheetColumn(250));
                //sheet.Table.Columns.Add(new WorksheetColumn(130));
                //sheet.Table.Columns.Add(new WorksheetColumn(130));
                //sheet.Table.Columns.Add(new WorksheetColumn(130));
                //sheet.Table.Columns.Add(new WorksheetColumn(130));

                row = sheet.Table.Rows.Add();
                row = sheet.Table.Rows.Add();
                row = sheet.Table.Rows.Add();
                WorksheetCell H1 = row.Cells.Add("", DataType.String, "NormalBold");
                H1 = row.Cells.Add(Privileges.Program + " - " + Privileges.PrivilegeName, DataType.String, "NormalGray");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "NormalBold");
                H1 = row.Cells.Add("Run By : " + LookupDataAccess.GetMemberName(BaseForm.UserProfile.FirstName.Trim(), BaseForm.UserProfile.MI.Trim(), BaseForm.UserProfile.LastName.Trim(), "3"), DataType.String, "Normal");
                H1 = row.Cells.Add("Date : " + DateTime.Now.ToString(), DataType.String, "NormalRight");
                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "NormalBold");
                H1 = row.Cells.Add("Selected Report Parameters", DataType.String, "NormalGray");
                H1.MergeAcross = 1;

                string Agy = "Agency : All"; string Dept = "Dept : All"; string Prg = "Program : All"; string Header_year = string.Empty;
                if (Agency != "**") Agy = "Agency : " + Agency;
                if (Depart != "**") Dept = "Dept : " + Depart;
                if (Program != "**") Prg = "Program : " + Program;
                if (CmbYear.Visible == true)
                    Header_year = "Year : " + ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString();

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add(Txt_HieDesc.Text.Trim() + "     " + Header_year, DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add("SSBG Selection :" + ((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Text.ToString().Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                //**H1 = row.Cells.Add(lblReferenceperiodate.Text + "  " + lblreferenceFrom.Text.Trim() + ":" + Ref_From_Date.Text + "    " + lblReferenceTo.Text.Trim() + ":" + Ref_To_Date.Text.Trim(), DataType.String, "Normal");
                H1 = row.Cells.Add(lblReferenceperiodate.Text /*+ "  " + lblreferenceFrom.Text.Trim()*/ + ": " + Ref_From_Date.Text + "    " + lblReferenceTo.Text.Trim() + ": " + Ref_To_Date.Text.Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                //**H1 = row.Cells.Add(lblRepDate.Text + "  " + lblRepFrom.Text.Trim() + ":" + dtpFrom.Text + "    " + label6.Text.Trim() + ":" + dtpTo.Text.Trim(), DataType.String, "Normal");
                H1 = row.Cells.Add(lblRepDate.Text /*+ "  " + lblRepFrom.Text.Trim()*/ + ": " + dtpFrom.Text + "    " + label6.Text.Trim() + ": " + dtpTo.Text.Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add(lblDemCount.Text.Trim() + " : " + ((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Text.ToString().Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add(lblAge1.Text.Trim() + " : " + txtfrom1.Text.Trim() + " - " + txtTo1.Text.Trim() + "    " + lblAge2.Text.Trim() + " : " + txtFrom2.Text.Trim() + " - " + txtTo2.Text.Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                string Audit = string.Empty;
                if (rbGreen.Checked) Audit = rbGreen.Text.Trim();
                else if (rbGred.Checked) Audit = rbGred.Text.Trim();

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add(label1.Text.Trim() + " : " + Audit, DataType.String, "Normal");
                H1.MergeAcross = 1;

                #endregion


                this.GenerateStyles(book.Styles);

                #region

                #endregion
                sheet = book.Worksheets.Add("STATISTICAL SUMMARY");
                sheet.Table.DefaultRowHeight = 14.25F;

                sheet.Table.StyleID = "s16";
                WorksheetColumn column0 = sheet.Table.Columns.Add();
                column0.Width = 88;
                column0.StyleID = "s16";
                WorksheetColumn column1 = sheet.Table.Columns.Add();
                column1.Width = 60;
                column1.StyleID = "s16";
                WorksheetColumn column2 = sheet.Table.Columns.Add();
                column2.Width = 60;
                column2.StyleID = "s16";
                WorksheetColumn column3 = sheet.Table.Columns.Add();
                column3.Width = 60;
                column3.StyleID = "s16";
                WorksheetColumn column4 = sheet.Table.Columns.Add();
                column4.Width = 60;
                column4.StyleID = "s16";
                //WorksheetColumn column5 = sheet.Table.Columns.Add();
                //column5.Width = 0;
                //column5.StyleID = "s16";
                WorksheetColumn column6 = sheet.Table.Columns.Add();
                column6.Width = 60;
                column6.StyleID = "s16";
                WorksheetColumn column7 = sheet.Table.Columns.Add();
                column7.Width = 60;
                column7.StyleID = "s16";
                WorksheetColumn column8 = sheet.Table.Columns.Add();
                column8.Width = 60;
                column8.StyleID = "s16";
                WorksheetColumn column9 = sheet.Table.Columns.Add();
                column9.Width = 60;
                column9.StyleID = "s16";
                WorksheetColumn column10 = sheet.Table.Columns.Add();
                column10.Width = 60;
                column10.StyleID = "s16";
                WorksheetColumn column11 = sheet.Table.Columns.Add();
                column11.Width = 60;
                column11.StyleID = "s16";
                WorksheetColumn column12 = sheet.Table.Columns.Add();
                column12.Width = 60;
                column12.StyleID = "s16";
                WorksheetColumn column13 = sheet.Table.Columns.Add();
                column13.Width = 60;
                column13.StyleID = "s16";
                //WorksheetColumn column14 = sheet.Table.Columns.Add();
                //column14.Width = 60;
                //column14.StyleID = "s16";
                //WorksheetColumn column15 = sheet.Table.Columns.Add();
                //column15.Width = 39;
                //column15.StyleID = "s16";
                //WorksheetColumn column16 = sheet.Table.Columns.Add();
                //column16.Width = 45;
                //column16.StyleID = "s16";
                //WorksheetColumn column17 = sheet.Table.Columns.Add();
                //column17.Width = 50;
                //column17.StyleID = "s16";
                //column17.Span = 1;
                //WorksheetColumn column18 = sheet.Table.Columns.Add();
                //column18.Index = 20;
                //column18.Width = 42;
                //column18.StyleID = "s16";
                //WorksheetColumn column19 = sheet.Table.Columns.Add();
                //column19.Width = 77;
                //column19.StyleID = "s16";
                //WorksheetColumn column20 = sheet.Table.Columns.Add();
                //column20.Width = 47;
                //column20.StyleID = "s16";
                //WorksheetColumn column21 = sheet.Table.Columns.Add();
                //column21.Index = 24;
                //column21.Width = 60;
                //column21.StyleID = "s16";
                SSBGPARAMEntity SelSSBG = new SSBGPARAMEntity();

                try
                {

                    string data = string.Empty;
                    if (cmbSSBG.Items.Count > 0)
                    {
                        SelSSBG = SSBGParamall.Find(u => ((u.SSBGSeq).Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString())));
                        List<SSBGTYPESEntity> SelSSBGTypes = SSBGTypesall.FindAll(u => u.SBGTID.Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString()) && u.SBGTCodeSeq.Equals("0"));
                        List<SSBGGOALSEntity> SSBGGoals = SSBGGoalsall.FindAll(u => u.SBGGID.Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString()));
                        
                        //List<SSBGAssnsEntity> SSBGCAMS_List = _model.CaseSumData.Browse_SSBGAssns(string.Empty, string.Empty, string.Empty, string.Empty, string.Empty);

                        //CreationDatatable(SelSSBGTypes);

                        if (SelSSBG != null)
                        {
                            row = sheet.Table.Rows.Add();
                            row.Height = 47;
                            row.AutoFitHeight = false;

                            WorksheetCell cell = row.Cells.Add("Social Services Block Grant (SSBG) Case Management", DataType.String, "m106944544");
                            cell.MergeAcross = 3;
                            


                            string RepMonths = string.Empty;

                            List<string> diffMonths = BuildMothswithYears(dtpFrom.Value.Month, dtpTo.Value.Month, dtpFrom.Value.Year, dtpTo.Value.Year);

                            //var diffMonths = (dtpTo.Value - dtpFrom.Value).Days / 30;
                            //var diffMonths = (dtpTo.Value.Month + dtpTo.Value.Year * 12) - (dtpFrom.Value.Month + dtpFrom.Value.Year * 12);
                            //int diffMonths = Math.Abs(((dtpTo.Value.Year - dtpFrom.Value.Year) * 12) + (dtpTo.Value.Month - dtpFrom.Value.Month));
                            if (diffMonths.Count > 1) RepMonths = "(" + diffMonths.Count + " Months)"; else RepMonths = "(" + diffMonths.Count + " Month)";

                            WorksheetCell cell1 = row.Cells.Add("Reporting Period: " + LookupDataAccess.GetMonthNameDate(dtpFrom.Text.ToString()) + " -" + LookupDataAccess.GetMonthNameDate(dtpTo.Text.ToString()) + "  " + RepMonths, DataType.String, "m106944584");
                            cell1.MergeAcross = 4;

                            //WorksheetCell cell2 = row.Cells.Add("Budget: $" + Convert.ToDouble(SelSSBG.SSBGBudget.Trim()).ToString("N", CultureInfo.InvariantCulture), DataType.String, "m106944524");
                            WorksheetCell cell2 = row.Cells.Add("Date of Reporting: " + DateTime.Now.ToShortDateString(), DataType.String, "m106944484");
                            cell2.MergeAcross = 3;

                            //WorksheetCell cell3 = row.Cells.Add("", DataType.String, "m106944464");
                            //cell3.MergeAcross = 5;

                            row = sheet.Table.Rows.Add();
                            row.Height = 22;
                            row.AutoFitHeight = false;

                            WorksheetCell cell4 = row.Cells.Add("Agency Name: " + BaseForm.BaseAgencyControlDetails.AgyName.Trim(), DataType.String, "m106944544");//m106944504
                            cell4.MergeAcross = 3;

                            List<string> GrntMonths = BuildMothswithYears(Convert.ToDateTime(SelSSBG.SSBGGPFrom).Month, Convert.ToDateTime(SelSSBG.SSBGGPTo).Month, Convert.ToDateTime(SelSSBG.SSBGGPFrom).Year, Convert.ToDateTime(SelSSBG.SSBGGPTo).Year);

                            ///var GrntMonths = (Convert.ToDateTime(SelSSBG.SSBGGPTo) - Convert.ToDateTime(SelSSBG.SSBGGPFrom)).Days / 30;
                            //diffMonths = (Convert.ToDateTime(SelSSBG.SSBGGPTo).Month + Convert.ToDateTime(SelSSBG.SSBGGPTo).Year * 12) - (Convert.ToDateTime(SelSSBG.SSBGGPFrom).Month + Convert.ToDateTime(SelSSBG.SSBGGPFrom).Year * 12);
                            //diffMonths = Math.Abs(((Convert.ToDateTime(SelSSBG.SSBGGPTo).Year - Convert.ToDateTime(SelSSBG.SSBGGPFrom).Year) * 12) + (Convert.ToDateTime(SelSSBG.SSBGGPTo).Month - Convert.ToDateTime(SelSSBG.SSBGGPFrom).Month));
                            if (GrntMonths.Count > 1) RepMonths = "(" + GrntMonths.Count + " Months)"; else RepMonths = "(" + GrntMonths.Count + " Month)";
                            WorksheetCell cell5 = row.Cells.Add("Grant Period: " + LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPFrom.ToString()) + " -" + LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPTo.ToString()) + "  " + RepMonths, DataType.String, "m106944564");
                            cell5.MergeAcross = 4;

                            //WorksheetCell cell6 = row.Cells.Add("Total Grant Award: $" + Convert.ToDouble(SelSSBG.SSBGAward.Trim()).ToString("N", CultureInfo.InvariantCulture), DataType.String, "m106944604");
                            WorksheetCell cell6 = row.Cells.Add("Completed by: " , DataType.String, "m106944604");
                            cell6.MergeAcross = 3;

                            ////WorksheetCell cell7 = row.Cells.Add("Date of Reporting: " + DateTime.Now.ToShortDateString(), DataType.String, "m106944484");
                            //WorksheetCell cell7 = row.Cells.Add(" " , DataType.String, "m106944484");
                            //cell7.MergeAcross = 5;

                            data = SelSSBG.SSBGProgDesc.Trim();
                            if(string.IsNullOrEmpty(data.Trim()))
                                data = "Program Description:  SSBG Individuals: Service intervention and case management for single individuals with incomes that fall at or below 150% of the federal poverty level. SSBG/TANF Families: indivduals/families with income at or below 200% of the federal poverty level with one child under the age of 18 in their household.";

                            row = sheet.Table.Rows.Add();
                            row.Height = 14;

                            WorksheetCell R3Cell = row.Cells.Add(data, DataType.String, "m106944144");
                            R3Cell.MergeAcross = 12;
                            R3Cell.MergeDown = 1;

                            row = sheet.Table.Rows.Add();
                            row.Height = 9;
                            row.AutoFitHeight = false;

                            row = sheet.Table.Rows.Add();
                            row.Height = 15;

                            int SumTot = 0;
                            if (SELSSBGMonths_List.Count > 0)
                            {
                                SumTot = SELSSBGMonths_List.Sum(u => Convert.ToInt32(u.CntlOblig.Trim()));

                            }

                            WorksheetCell R4cell = row.Cells.Add("Number of clients to serve each year = " + SumTot, DataType.String, "m106944624");
                            R4cell.MergeAcross = 12;

                            row = sheet.Table.Rows.Add();
                            row.Height = 24;

                            WorksheetCell R4cell1 = row.Cells.Add("Type", DataType.String, "s40");
                            R4cell1.MergeDown = 1;

                            WorksheetCell R4cell2 = row.Cells.Add("Contracted Number * Quarterly Target rounded", DataType.String, "s40");
                            R4cell2.MergeAcross = 1;

                            if (string.IsNullOrEmpty(SelSSBG.SSBGCntArea1.Trim())) SelSSBG.SSBGCntArea1 = "Counting Category 1";
                            WorksheetCell R4cell3 = row.Cells.Add(SelSSBG.SSBGCntArea1.Trim(), DataType.String, "s40");
                            R4cell3.MergeAcross = 3;

                            if (string.IsNullOrEmpty(SelSSBG.SSBGCntArea2.Trim())) SelSSBG.SSBGCntArea2 = "Counting Category 2";
                            WorksheetCell R4cell4 = row.Cells.Add(SelSSBG.SSBGCntArea2.Trim(), DataType.String, "s40");
                            R4cell4.MergeDown = 1;
                            //R4cell4.MergeAcross = 1;

                            if (string.IsNullOrEmpty(SelSSBG.SSBGCntArea3.Trim())) SelSSBG.SSBGCntArea3 = "Counting Category 3";
                            R4cell4 = row.Cells.Add(SelSSBG.SSBGCntArea3.Trim(), DataType.String, "s40");
                            R4cell4.MergeDown = 1;

                            if (string.IsNullOrEmpty(SelSSBG.SSBGCntArea4.Trim())) SelSSBG.SSBGCntArea4 = "Counting Category 4";//"Number of Appointments(do not include cancelled)";
                            WorksheetCell R4cell5 = row.Cells.Add(SelSSBG.SSBGCntArea4.Trim(), DataType.String, "m106944324");
                            R4cell5.MergeAcross = 1;

                            if (string.IsNullOrEmpty(SelSSBG.SSBGCntArea5.Trim())) SelSSBG.SSBGCntArea5 = "Counting Category 5";
                            WorksheetCell R4cell6 = row.Cells.Add(SelSSBG.SSBGCntArea5.Trim(), DataType.String, "s40");
                            R4cell6.MergeAcross = 1;

                            row = sheet.Table.Rows.Add();
                            row.Height = 22;
                            row.AutoFitHeight = false;

                            WorksheetCell R5Cell = row.Cells.Add("Yearly Obligation", DataType.String, "s38");
                            R5Cell.Index = 2;

                           
                            //R5Cells1.MergeAcross = 1;

                            string DynamicMonth = string.Empty;
                            switch (diffMonths.Count)
                            {
                                case 0:
                                case 1: DynamicMonth = "1 Month"; break;
                                case 2: DynamicMonth = "2 Month"; break;
                                case 3: DynamicMonth = "Quarterly"; break;
                                case 4: DynamicMonth = "4 Month"; break;
                                case 5: DynamicMonth = "5 Month"; break;
                                case 6: DynamicMonth = "Half Yearly"; break;
                                case 7: DynamicMonth = "7 Month"; break;
                                case 8: DynamicMonth = "8 Month"; break;
                                case 9: DynamicMonth = "9 Month"; break;
                                case 10: DynamicMonth = "10 Month"; break;
                                case 11: DynamicMonth = "11 Month"; break;
                                case 12: DynamicMonth = "Yearly"; break;
                            }

                            WorksheetCell R5Cells1 = row.Cells.Add(DynamicMonth+" Obligation", DataType.String, "s38");

                            row.Cells.Add(DynamicMonth, DataType.String, "s38");
                            row.Cells.Add("% " + DynamicMonth, DataType.String, "s38");
                            row.Cells.Add("Year to Date", DataType.String, "s38");
                            row.Cells.Add("% to Date", DataType.String, "s38");

                            //row.Cells.Add("Served", DataType.String, "s38");
                            //row.Cells.Add("Left Program", DataType.String, "s38");

                            WorksheetCell R5Cell11= row.Cells.Add(DynamicMonth, DataType.String, "m106944324");
                            R5Cell11.Index = 10;

                            row.Cells.Add("Year to Date", DataType.String, "m106944324");

                            row.Cells.Add(DynamicMonth, DataType.String, "s38");
                            row.Cells.Add("Year to Date", DataType.String, "s38");

                            
                            if (SelSSBGTypes.Count > 0)
                            {
                                DemoCounts = new SSBGDemoEntity(true); SNPDemoGraphList = new List<CaseSnpEntity>();
                                int TotCntlOblig = 0; int[] TotCnt = new int[5]; int[] TotYearCnt = new int[5]; int TotMnthCntoblig = 0;
                                int[] IntCnt = new int[5], yrIntCnt = new int[5], contcnt = new int[5], yrcontcnt = new int[5], actcnt = new int[5], yractcnt = new int[5], spmcnt = new int[5], yrspmcnt = new int[5],QuesCnt=new int[5],YrQuesCnt=new int[5];
                                foreach (SSBGTYPESEntity Entity in SelSSBGTypes)
                                {
                                    EmptyEnties(); ExcelCount = 0;
                                    List<SSBGMONTHSEntity> MonthsEntity = SELSSBGMonths_List.FindAll(u => u.SSBGCode.Equals(Entity.SBGTCode));
                                    int SBGTYearCnt = 0, SBGTQCnt = 0;
                                    if (MonthsEntity.Count > 0)
                                    {
                                        SBGTYearCnt = MonthsEntity.Sum(u => Convert.ToInt32(u.CntlOblig.Trim()));

                                        int j = 0; int YearVal = dtpFrom.Value.Year, Mnthval = dtpFrom.Value.Month;
                                        if (diffMonths.Count == 0)
                                        {
                                            foreach (SSBGMONTHSEntity MEntity in MonthsEntity)
                                            {
                                                if (Mnthval.ToString() == MEntity.Month.ToString() && YearVal.ToString() == MEntity.SSBGYearValue.ToString())
                                                {
                                                    SBGTQCnt = SBGTQCnt + int.Parse(MEntity.CntlOblig.Trim());

                                                    break;
                                                }
                                            }
                                            //int.Parse(MonthsEntity.Find(u => u.Month.ToString().Equals(Mnthval.ToString().Trim()) && u.SSBGYearValue.ToString().Equals(YearVal)).CntlOblig.ToString());
                                        }
                                        else
                                        {
                                            for (int i = 0; i < diffMonths.Count; i++)
                                            {
                                                //Mnthval = Mnthval + j;
                                                if (Mnthval > 12) { j = 0; Mnthval = 1; YearVal = YearVal + 1; }
                                                foreach (SSBGMONTHSEntity MEntity in MonthsEntity)
                                                {
                                                    if (Mnthval.ToString() == MEntity.Month.ToString() && YearVal.ToString() == MEntity.SSBGYearValue.ToString())
                                                    {
                                                        SBGTQCnt = SBGTQCnt + int.Parse(MEntity.CntlOblig.Trim());

                                                        break;
                                                    }
                                                }
                                                //j++;
                                                Mnthval++;
                                            }
                                        }
                                    }
                                   
                                    List<SSBGTYPESEntity> SSBGCritQuestions = SSBGTypesQues.FindAll(u => (u.SBGTID.Equals(Entity.SBGTID) && u.SBGTCode.Equals(Entity.SBGTCode) && (!u.SBGTGroupSeq.Equals("0"))));
                                    dt = CreateTable(SSBGCritQuestions);
                                    switch (SelSSBG.SSBGCntArea1_Val.ToString())
                                    {
                                        case "I": int YearTodateCnt = YeartoDateProcess(Entity, SSBGCritQuestions);
                                            int Count = Process(Entity, SSBGCritQuestions);
                                                  IntCnt[0] = Count;yrIntCnt[0]=YearTodateCnt; break;
                                        case "A":
                                        case "B": yrIntCnt[0] = ACTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea1_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[0] = ACTProcess(Entity, SelSSBG.SSBGCntArea1_Val.ToString(), SSBGCritQuestions);
                                                   break;
                                        case "C":
                                        case "D": yrIntCnt[0] = CONTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea1_Val.ToString(), SSBGCritQuestions);
                                                   IntCnt[0] = CONTProcess(Entity, SelSSBG.SSBGCntArea1_Val.ToString(), SSBGCritQuestions);
                                                   break;
                                        case "S":
                                        case "T": yrIntCnt[0] = SPMYeartoDateProcess(Entity, SelSSBG.SSBGCntArea1_Val.ToString(), SSBGCritQuestions);
                                                   IntCnt[0] = SPMProcess(Entity, SelSSBG.SSBGCntArea1_Val.ToString(), SSBGCritQuestions);
                                                   break;
                                        case "Q": yrIntCnt[0] = CustQuesYeartoDateProcess(Entity, SelSSBG.SSBGCntArea1_Val.ToString(), SelSSBG.SSBGCust1, SSBGCritQuestions);
                                                   IntCnt[0] = CUSTQuesProcess(Entity, SelSSBG.SSBGCntArea1_Val.ToString(),SelSSBG.SSBGCust1,SSBGCritQuestions); break;
                                        default: yrIntCnt[0] = YeartoDateProcess(Entity, SSBGCritQuestions);
                                            IntCnt[0] = Process(Entity, SSBGCritQuestions);
                                                   break;
                                    }

                                    switch (SelSSBG.SSBGCntArea2_Val.ToString())
                                    {
                                        case "I": int YearTodateCnt = YeartoDateProcess(Entity, SSBGCritQuestions);
                                            int Count = Process(Entity, SSBGCritQuestions);
                                            IntCnt[1] = Count; yrIntCnt[1] = YearTodateCnt; break;
                                        case "A":
                                        case "B": yrIntCnt[1] = ACTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea2_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[1] = ACTProcess(Entity, SelSSBG.SSBGCntArea2_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "C":
                                        case "D": yrIntCnt[1] = CONTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea2_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[1] = CONTProcess(Entity, SelSSBG.SSBGCntArea2_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "S":
                                        case "T": yrIntCnt[1] = SPMYeartoDateProcess(Entity, SelSSBG.SSBGCntArea2_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[1] = SPMProcess(Entity, SelSSBG.SSBGCntArea2_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "Q": yrIntCnt[1] = CustQuesYeartoDateProcess(Entity, SelSSBG.SSBGCntArea2_Val.ToString(), SelSSBG.SSBGCust2, SSBGCritQuestions);
                                            IntCnt[1] = CUSTQuesProcess(Entity, SelSSBG.SSBGCntArea2_Val.ToString(),SelSSBG.SSBGCust2,SSBGCritQuestions); break;
                                    }

                                    switch (SelSSBG.SSBGCntArea3_Val.ToString())
                                    {
                                        case "I": int YearTodateCnt = YeartoDateProcess(Entity, SSBGCritQuestions);
                                            int Count = Process(Entity, SSBGCritQuestions);
                                            IntCnt[2] = Count; yrIntCnt[2] = YearTodateCnt; break;
                                        case "A":
                                        case "B": yrIntCnt[2] = ACTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea3_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[2] = ACTProcess(Entity, SelSSBG.SSBGCntArea3_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "C":
                                        case "D": yrIntCnt[2] = CONTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea3_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[2] = CONTProcess(Entity, SelSSBG.SSBGCntArea3_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "S":
                                        case "T": yrIntCnt[2] = SPMYeartoDateProcess(Entity, SelSSBG.SSBGCntArea3_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[2] = SPMProcess(Entity, SelSSBG.SSBGCntArea3_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "Q": yrIntCnt[2] = CustQuesYeartoDateProcess(Entity, SelSSBG.SSBGCntArea3_Val.ToString(), SelSSBG.SSBGCust3, SSBGCritQuestions);
                                            IntCnt[2] = CUSTQuesProcess(Entity, SelSSBG.SSBGCntArea3_Val.ToString(),SelSSBG.SSBGCust3,SSBGCritQuestions); break;
                                    }

                                    switch (SelSSBG.SSBGCntArea4_Val.ToString())
                                    {
                                        case "I": int YearTodateCnt = YeartoDateProcess(Entity, SSBGCritQuestions);
                                            int Count = Process(Entity, SSBGCritQuestions);
                                            IntCnt[3] = Count; yrIntCnt[3] = YearTodateCnt; break;
                                        case "A":
                                        case "B": yrIntCnt[3] = ACTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[3] = ACTProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "C":
                                        case "D": yrIntCnt[3] = CONTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[3] = CONTProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "S":
                                        case "T": yrIntCnt[3] = SPMYeartoDateProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[3] = SPMProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "Q": yrIntCnt[3] = CustQuesYeartoDateProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SelSSBG.SSBGCust4, SSBGCritQuestions);
                                            IntCnt[3] = CUSTQuesProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(),SelSSBG.SSBGCust4,SSBGCritQuestions); break;
                                    }

                                    switch (SelSSBG.SSBGCntArea5_Val.ToString())
                                    {
                                        case "I": int YearTodateCnt = YeartoDateProcess(Entity, SSBGCritQuestions);
                                            int Count = Process(Entity, SSBGCritQuestions);
                                            IntCnt[4] = Count; yrIntCnt[4] = YearTodateCnt; break;
                                        case "A":
                                        case "B": yrIntCnt[4] = ACTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea5_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[4] = ACTProcess(Entity, SelSSBG.SSBGCntArea5_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "C":
                                        case "D": yrIntCnt[4] = CONTYeartoDateProcess(Entity, SelSSBG.SSBGCntArea5_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[4] = CONTProcess(Entity, SelSSBG.SSBGCntArea5_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "S":
                                        case "T": yrIntCnt[4] = SPMYeartoDateProcess(Entity, SelSSBG.SSBGCntArea5_Val.ToString(), SSBGCritQuestions);
                                            IntCnt[4] = SPMProcess(Entity, SelSSBG.SSBGCntArea5_Val.ToString(), SSBGCritQuestions);
                                            break;
                                        case "Q": yrIntCnt[4] = CustQuesYeartoDateProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(), SelSSBG.SSBGCust5, SSBGCritQuestions);
                                            IntCnt[4] = CUSTQuesProcess(Entity, SelSSBG.SSBGCntArea4_Val.ToString(),SelSSBG.SSBGCust5,SSBGCritQuestions); break;
                                    }

                                    DatasetFilling(TableCnt, dt);
                                    TableCnt++;

                                    row = sheet.Table.Rows.Add();
                                    row.Height = 22;
                                    row.AutoFitHeight = false;

                                    row.Cells.Add(Entity.SBGTDesc, DataType.String, "s26");

                                    WorksheetCell R6C1 = row.Cells.Add(SBGTYearCnt.ToString(), DataType.Number, "s29");
                                    //R6C1.MergeAcross = 1;

                                    row.Cells.Add(SBGTQCnt.ToString(), DataType.Number, "s29");

                                    switch (SelSSBG.SSBGCntArea1_Val.ToString())
                                    {
                                        case "I": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        case "C":
                                        case "D": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        case "A":
                                        case "B": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        case "S":
                                        case "T": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        case "Q": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        default: if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                    }
                                    

                                    R6C1 = row.Cells.Add("0", DataType.Number, "s30");
                                    R6C1.Formula = "+RC[-1]/RC[-2]";

                                    switch (SelSSBG.SSBGCntArea1_Val.ToString())
                                    {
                                        case "I": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        case "C":
                                        case "D": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        case "A":
                                        case "B": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        case "S":
                                        case "T": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        case "Q": if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                        default: if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[0].ToString(), DataType.Number, "m106944324"); break;
                                    }

                                    //WorksheetCell R6C2 = row.Cells.Add(YearTodateCnt.ToString(), DataType.Number, "s29");
                                    //R6C2.MergeAcross = 1;

                                    R6C1 = row.Cells.Add("0", DataType.Number, "s30");
                                    R6C1.Formula = "+RC[-1]/RC[-5]";

                                    switch (SelSSBG.SSBGCntArea2_Val.ToString())
                                    {
                                        case "I": if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1") row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "m106944324"); break;
                                        case "C":
                                        case "D": if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1") row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "m106944324"); break;
                                        case "A":
                                        case "B": if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1") row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "m106944324"); break;
                                        case "S":
                                        case "T": if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1") row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "m106944324"); break;
                                        case "Q": if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1") row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[1].ToString(), DataType.Number, "m106944324"); break;
                                        default: if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1")  row.Cells.Add("", DataType.Number, "s29");  else row.Cells.Add("", DataType.Number, "m106944324"); break;
                                    }

                                    //R6C1 = row.Cells.Add("0", DataType.Number, "s29");
                                    //R6C2.Formula = "=RC[-1]";

                                    switch (SelSSBG.SSBGCntArea3_Val.ToString())
                                    {
                                        case "I": if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1") row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "m106944324"); break;
                                        case "C":
                                        case "D": if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1") row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "m106944324"); break;
                                        case "A":
                                        case "B": if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1") row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "m106944324"); break;
                                        case "S":
                                        case "T": if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1") row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "m106944324"); break;
                                        case "Q": if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1") row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[2].ToString(), DataType.Number, "m106944324"); break;
                                        default: if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1") row.Cells.Add("", DataType.Number, "s29"); else row.Cells.Add("", DataType.Number, "m106944324"); break;
                                    }

                                    //R6C1 = row.Cells.Add("0", DataType.Number, "s29");

                                    //WorksheetCell R6C3 = row.Cells.Add("", DataType.String, "m106944424");
                                    //R6C3.MergeAcross = 2;

                                    switch (SelSSBG.SSBGCntArea4_Val.ToString())
                                    {
                                        case "I": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        case "C":
                                        case "D": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        case "A":
                                        case "B": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        case "S":
                                        case "T": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        case "Q": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        default: if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add("", DataType.String, "s29"); else row.Cells.Add("", DataType.Number, "m106944324"); break;
                                    }

                                    //WorksheetCell R6C4 = row.Cells.Add("", DataType.String, "s29");
                                    ////R6C4.MergeAcross = 1;

                                    switch (SelSSBG.SSBGCntArea4_Val.ToString())
                                    {
                                        case "I": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        case "C":
                                        case "D": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        case "A":
                                        case "B": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        case "S":
                                        case "T": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        case "Q": if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[3].ToString(), DataType.Number, "m106944324"); break;
                                        default: if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1") row.Cells.Add("", DataType.String, "s29"); else row.Cells.Add("", DataType.String, "m106944324"); break;
                                    }

                                    //WorksheetCell R6C5 = row.Cells.Add("", DataType.String, "s29");
                                    ////R6C5.MergeAcross = 1;

                                    switch (SelSSBG.SSBGCntArea5_Val.ToString())
                                    {
                                        case "I": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        case "C":
                                        case "D": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        case "A":
                                        case "B": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        case "S":
                                        case "T": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        case "Q": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(IntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        default: if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add("", DataType.String, "s29"); else row.Cells.Add("", DataType.Number, "m106944324"); break;
                                    }

                                    switch (SelSSBG.SSBGCntArea5_Val.ToString())
                                    {
                                        case "I": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        case "C":
                                        case "D": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        case "A":
                                        case "B": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        case "S":
                                        case "T": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        case "Q": if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "s29"); else row.Cells.Add(yrIntCnt[4].ToString(), DataType.Number, "m106944324"); break;
                                        default: if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1") row.Cells.Add("", DataType.String, "s29"); else row.Cells.Add("", DataType.String, "m106944324"); break;
                                    }

                                    //R6C1 = row.Cells.Add("0", DataType.Number, "s29");
                                    ////R6C2.Formula = "=RC[-1]";

                                    //R6C1 = row.Cells.Add("0", DataType.Number, "s29");

                                    //WorksheetCell R6C6 = row.Cells.Add("", DataType.String, "m106944084");
                                    //R6C6.MergeAcross = 2;

                                    //WorksheetCell R6C7 = row.Cells.Add("", DataType.String, "s166");
                                    //R6C7.MergeAcross = 2;

                                    TotCntlOblig += SBGTYearCnt; TotMnthCntoblig += SBGTQCnt;
                                    TotCnt[0] += IntCnt[0]; TotYearCnt[0] += yrIntCnt[0]; TotCnt[1] += IntCnt[1]; TotYearCnt[1] += yrIntCnt[1];
                                    TotCnt[2] += IntCnt[2]; TotYearCnt[2] += yrIntCnt[2]; TotCnt[3] += IntCnt[3]; TotYearCnt[3] += yrIntCnt[3];
                                    TotCnt[4] += IntCnt[4]; TotYearCnt[4] += yrIntCnt[4];
                                }

                                row = sheet.Table.Rows.Add();
                                row.Height = 22;
                                row.AutoFitHeight = false;

                                row.Cells.Add("Total:", DataType.String, "s25");

                                WorksheetCell R6T1 = row.Cells.Add(TotCntlOblig.ToString(), DataType.Number, "s32");
                                //R6T1.MergeAcross = 1;


                                row.Cells.Add(TotMnthCntoblig.ToString(), DataType.Number, "s32");
                                row.Cells.Add(TotCnt[0].ToString(), DataType.Number, "s32");

                                R6T1 = row.Cells.Add("0", DataType.Number, "s33");
                                R6T1.Formula = "+RC[-1]/RC[-2]";

                                WorksheetCell R6T2 = row.Cells.Add(TotYearCnt[0].ToString(), DataType.Number, "s32");
                                //R6T2.MergeAcross = 1;

                                R6T2 = row.Cells.Add("0", DataType.Number, "s33");
                                R6T2.Formula = "+RC[-1]/RC[-5]";

                                R6T2 = row.Cells.Add(TotCnt[1].ToString(), DataType.Number, "s32");
                                //R6T2.Formula = "=RC[-1]";

                                row.Cells.Add(TotCnt[2].ToString(), DataType.Number, "s32");

                                //WorksheetCell R6T3 = row.Cells.Add("", DataType.String, "m95382656");
                                //R6T3.MergeAcross = 2;

                                WorksheetCell R6T4 = row.Cells.Add(TotCnt[3].ToString(), DataType.Number, "s32");
                                //R6T4.MergeAcross = 1;

                                WorksheetCell R6T5 = row.Cells.Add(TotYearCnt[3].ToString(), DataType.Number, "s32");
                                //R6T5.MergeAcross = 1;

                                //WorksheetCell R6T6 = row.Cells.Add("0", DataType.Number, "m106944124");
                                //R6T6.MergeAcross = 2;

                                WorksheetCell R6T7 = row.Cells.Add(TotCnt[4].ToString(), DataType.Number, "s32");
                                //R6T7.MergeAcross = 2;
                                row.Cells.Add(TotYearCnt[4].ToString(), DataType.Number, "s32");
                            }

                            row = sheet.Table.Rows.Add();
                            row.Height = 15;
                            row.AutoFitHeight = false;

                            WorksheetCell RCell43 = row.Cells.Add("Demographics", DataType.String, "m106944624");
                            RCell43.MergeAcross = 12;

                            row = sheet.Table.Rows.Add();
                            row.Height = 22;
                            row.AutoFitHeight = false;

                            WorksheetCell A1;
                            A1 = row.Cells.Add("Age", DataType.String, "s40");
                            A1.MergeAcross = 2;

                            A1 = row.Cells.Add("Race", DataType.String, "s40");
                            A1.MergeAcross = 6;

                            A1 = row.Cells.Add("Ethnicity", DataType.String, "s40");
                            A1.MergeAcross = 1;

                            A1 = row.Cells.Add("Sex", DataType.String, "s40");
                            A1.MergeAcross = 1;

                            row = sheet.Table.Rows.Add();
                            row.Height = 33;
                            row.AutoFitHeight = false;

                            string Agerng1 = string.Empty, Agerng2 = string.Empty;
                            if (txtTo1.Text.Trim() == "999") Agerng1 = "+"; else Agerng1 = "-" + txtTo1.Text.Trim();
                            if (txtTo2.Text.Trim() == "999") Agerng2 = "+"; else Agerng2 = "-" + txtTo2.Text.Trim();

                            row.Cells.Add(txtfrom1.Text.Trim() + Agerng1, DataType.String, "s40"); // "18-59"
                            row.Cells.Add(txtFrom2.Text.Trim() + Agerng2, DataType.String, "s40");//"60+"
                            row.Cells.Add("Adults Unknown Age", DataType.String, "s40");
                            row.Cells.Add("American Indian or Alaska Native", DataType.String, "s40");
                            row.Cells.Add("Black or African American", DataType.String, "s40");
                            row.Cells.Add("White", DataType.String, "s40");
                            row.Cells.Add("Asian", DataType.String, "s40");
                            row.Cells.Add("Native Hawalian & Pacific Islander", DataType.String, "s40");
                            row.Cells.Add("Other", DataType.String, "s40");
                            row.Cells.Add("Multi-Race", DataType.String, "s40");
                            row.Cells.Add("Hispanic, Latino or Spanish", DataType.String, "s40");
                            row.Cells.Add("Non-Hispanic, Latino or Spanish", DataType.String, "s40");
                            row.Cells.Add("Male", DataType.String, "s40");
                            row.Cells.Add("Female", DataType.String, "s40");

                            row = sheet.Table.Rows.Add();
                            row.Height = 22;
                            row.AutoFitHeight = false;

                            row.Cells.Add(DemoCounts.SSBG18to59, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBG60Plus, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGAdults, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGAmerican, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGBlack, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGWhite, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGAsian, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGNative, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGOther, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGMultiRace, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGHispanic, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGNonHispanic, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGMale, DataType.Number, "s29");
                            row.Cells.Add(DemoCounts.SSBGFemale, DataType.Number, "s29");

                            row = sheet.Table.Rows.Add();
                            row.Height = 22;
                            row.AutoFitHeight = false;

                            A1 = row.Cells.Add((Convert.ToInt32(DemoCounts.SSBG18to59)+Convert.ToInt32(DemoCounts.SSBG60Plus)+Convert.ToInt32(DemoCounts.SSBGAdults)).ToString(), DataType.Number, "s40");
                            A1.MergeAcross = 2;

                            A1 = row.Cells.Add((Convert.ToInt32(DemoCounts.SSBGAsian) + Convert.ToInt32(DemoCounts.SSBGAmerican) + Convert.ToInt32(DemoCounts.SSBGBlack)+Convert.ToInt32(DemoCounts.SSBGMultiRace)+Convert.ToInt32(DemoCounts.SSBGNative)+Convert.ToInt32(DemoCounts.SSBGOther)+Convert.ToInt32(DemoCounts.SSBGWhite)).ToString(), DataType.Number, "s40");
                            A1.MergeAcross = 6;

                            A1 = row.Cells.Add((Convert.ToInt32(DemoCounts.SSBGHispanic)+Convert.ToInt32(DemoCounts.SSBGNonHispanic)).ToString(), DataType.Number, "s40");
                            A1.MergeAcross = 1;

                            A1 = row.Cells.Add((Convert.ToInt32(DemoCounts.SSBGMale)+Convert.ToInt32(DemoCounts.SSBGFemale)).ToString(), DataType.Number, "s40");
                            A1.MergeAcross = 1;

                            row = sheet.Table.Rows.Add();
                            row.Height = 22;
                            row.AutoFitHeight = false;

                            data = "Contractual/Funder Requirements Contractual/Funder Requirements as Outlined in Contract , as of " + LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPFrom.ToString()) + " for period covering " + LookupDataAccess.GetMonthDate(dtpFrom.Value.ToShortDateString()) + "- " + LookupDataAccess.GetMonthNameDate(dtpTo.Value.ToShortDateString());
                            WorksheetCell RCell = row.Cells.Add(data, DataType.String, "m106944764");
                            RCell.MergeAcross = 12;

                            WorksheetCell S1;
                            //S1 = row.Cells.Add("Have we reached the funder goal ?", DataType.String, "m95382676");
                            ////S1.MergeAcross = 1;
                            //S1.MergeDown = 1;

                            row = sheet.Table.Rows.Add();
                            row.Height = 22; 
                            row.AutoFitHeight = false;

                            S1 = row.Cells.Add("Goals - only required in quarterly reports (please use the quarterly report form)", DataType.String, "m106944744");
                            S1.MergeAcross = 7;

                            S1 = row.Cells.Add(LookupDataAccess.GetMonthNameDate(dtpFrom.Value.ToShortDateString()) + " - " + LookupDataAccess.GetMonthNameDate(dtpTo.Value.ToShortDateString()), DataType.String, "s181");
                            S1.MergeAcross = 4;
                            DataTable dtObj = new DataTable(); int ObjCnt = 1;
                            if (SSBGGoals.Count > 0)
                            {
                                bool IsFirst = false; string GoalDesc = string.Empty;
                                foreach (SSBGGOALSEntity GEntity in SSBGGoals)
                                {
                                    if (GEntity.SBGGSeq.Trim() == "0")
                                    {
                                        row = sheet.Table.Rows.Add();
                                        row.Height = 27;
                                        row.AutoFitHeight = false;

                                        GoalDesc = GEntity.SBGGDesc.Trim();
                                        S1 = row.Cells.Add(GEntity.SBGGDesc.Trim(), DataType.String, "m106944864");
                                        S1.MergeAcross = 7;

                                        if (!IsFirst)
                                        {
                                            S1 = row.Cells.Add(DynamicMonth + " # Seeking Objective", DataType.String, "s41");
                                            S1 = row.Cells.Add(DynamicMonth + "# Obtained Objective", DataType.String, "s41");
                                            S1 = row.Cells.Add("YTD # Seeking Objective ", DataType.String, "s42");
                                            S1 = row.Cells.Add("YTD # Obtained Objective ", DataType.String, "s42");
                                            S1 = row.Cells.Add("Year to Date %", DataType.String, "s43");

                                            //S1 = row.Cells.Add("= YES", DataType.String, "m95382696");
                                            //S1.MergeAcross = 1;

                                            IsFirst = true;
                                        }
                                        else
                                        {


                                            S1 = row.Cells.Add("", DataType.String, "s44");
                                            S1 = row.Cells.Add("", DataType.String, "s44");
                                            S1 = row.Cells.Add("", DataType.String, "s45");
                                            S1 = row.Cells.Add("", DataType.String, "s45");
                                            S1 = row.Cells.Add("#DIV/0!", DataType.String, "s46");
                                            S1.Data.Type = DataType.Error;

                                            //S1 = row.Cells.Add("", DataType.String, "m95382716");
                                            
                                        }
                                    }
                                    else
                                    {
                                        List<SSBGSerPlanEntity> SSBGSelSerPlan = SSBGSerPlans.FindAll(u => u.SBSPGoal.Equals(GEntity.SBGGCode) && u.SBSPOBJ.Equals(GEntity.SBGGSeq));
                                        List<SSBGAssnsEntity> SSBGSelAssns = SSBGCAMS_List.FindAll(u => u.SBASGoal.Equals(GEntity.SBGGCode) && u.SBASOBJ.Equals(GEntity.SBGGSeq));
                                        List<SSBGAssnsEntity> SelCAs = SSBGSelAssns.FindAll(u => u.SBAS_CAMS_Type.Equals("CA"));
                                        List<SSBGAssnsEntity> SelMSs = SSBGSelAssns.FindAll(u => u.SBAS_CAMS_Type.Equals("MS"));

                                        dtObj = CreationDatatable(SSBGSelAssns, SSBGSelSerPlan,GEntity.SBGGCountType,GEntity.Type2);
                                        List<CASEACTEntity> selCaseact = new List<CASEACTEntity>();
                                        List<Captain.Common.Utilities.ListItem> SelLists = new List<Utilities.ListItem>();

                                        var SPMResult = (from a in CaseSPMList join s in SSBGSelSerPlan on a.service_plan equals s.SBSPSerPlan select a).ToList();
                                        var CAResult = (from a in SP_Activity_Details join s in SelCAs on a.ACT_Code equals s.SBAS_CAMS_Code select a).ToList();
                                        var MSResult = (from a in SP_MS_Details join s in SelMSs on a.MS_Code equals s.SBAS_CAMS_Code select a).ToList();

                                        if (GEntity.SBGGCountType == "S" || GEntity.SBGGCountType == "C" || GEntity.Type2 == "S" || GEntity.Type2 == "C")
                                        {
                                            if (SPMResult.Count > 0)
                                            {
                                                var Apps = SPMResult.GroupBy(n => new { n.app_no, n.service_plan }).Select(g => new { App_no = g.Key.app_no, g.Key.service_plan }).ToList();
                                                string Privapp = string.Empty; DataRow dr = dtObj.NewRow(); bool Isfirst = false;
                                                foreach (var Entity in Apps)
                                                {

                                                    if (Privapp != Entity.App_no)
                                                    {
                                                        if (Isfirst)
                                                        {
                                                            dtObj.Rows.Add(dr);
                                                            dr = dtObj.NewRow();
                                                        }
                                                        dr.SetField("GoalCd", GEntity.SBGGCode);
                                                        dr.SetField("ObjCd", GEntity.SBGGSeq.Trim());
                                                        dr.SetField("Goal", GoalDesc);
                                                        dr.SetField("Objective", GEntity.SBGGDesc.Trim());
                                                        dr.SetField("Type", GEntity.SBGGCountType.Trim());
                                                        dr.SetField("Type2", GEntity.Type2.Trim());
                                                        dr.SetField("AppNo", Entity.App_no);
                                                        CASESPMEntity MstEntity = CaseSPMList.Find(u => u.app_no.Equals(Entity.App_no.Trim()));
                                                        string AppName = string.Empty;
                                                        if (MstEntity != null)
                                                            AppName = LookupDataAccess.GetMemberName(MstEntity.FirstName.Trim(), MstEntity.MiddleName.Trim(), MstEntity.LastName.Trim(), BaseForm.BaseHierarchyCnFormat);

                                                        dr.SetField("Name", AppName);

                                                        string SPMStrtDt = string.Empty, SPMCmpltdDt = string.Empty;
                                                        if (SPMResult.FindAll(u => u.app_no.Equals(Entity.App_no) && u.service_plan.Equals(Entity.service_plan)).Count > 0)
                                                        {
                                                            SPMStrtDt = SPMResult.Find(u => u.app_no.Equals(Entity.App_no) && u.service_plan.Equals(Entity.service_plan)).startdate.Trim();
                                                            if (!string.IsNullOrEmpty(SPMStrtDt.Trim())) SPMStrtDt = "S-" + LookupDataAccess.Getdate(SPMStrtDt.Trim());
                                                            SPMCmpltdDt = SPMResult.Find(u => u.app_no.Equals(Entity.App_no) && u.service_plan.Equals(Entity.service_plan)).compdate.Trim();
                                                            if (!string.IsNullOrEmpty(SPMCmpltdDt.Trim())) { if (!string.IsNullOrEmpty(SPMStrtDt.Trim())) SPMCmpltdDt = ", C-" + LookupDataAccess.Getdate(SPMCmpltdDt.Trim()); else SPMCmpltdDt = "C-" + LookupDataAccess.Getdate(SPMCmpltdDt.Trim()); }
                                                        }

                                                        if ((GEntity.SBGGCountType == "S" && GEntity.Type2 == "C") || (GEntity.SBGGCountType == "C" && GEntity.Type2 == "S"))
                                                            dr.SetField(Entity.service_plan.Trim(), SPMStrtDt + SPMCmpltdDt);
                                                        else if ((GEntity.SBGGCountType == "S" && GEntity.Type2 == "S") || (GEntity.SBGGCountType == "S" && GEntity.Type2 == "") || (GEntity.SBGGCountType == "" && GEntity.Type2 == "S"))
                                                            dr.SetField(Entity.service_plan.Trim(), SPMStrtDt);
                                                        else if ((GEntity.SBGGCountType == "C" && GEntity.Type2 == "C") || (GEntity.SBGGCountType == "C" && GEntity.Type2 == "") || (GEntity.SBGGCountType == "C" && GEntity.Type2 == ""))
                                                            dr.SetField(Entity.service_plan.Trim(), SPMCmpltdDt);
                                                        else if (GEntity.SBGGCountType == "S" || GEntity.Type2 == "S")
                                                            dr.SetField(Entity.service_plan.Trim(), SPMStrtDt);
                                                        else if (GEntity.SBGGCountType == "C" || GEntity.Type2 == "C")
                                                            dr.SetField(Entity.service_plan.Trim(), SPMCmpltdDt);

                                                        Isfirst = true;

                                                    }
                                                    Privapp = Entity.App_no;
                                                }
                                                if (dr != null)
                                                    dtObj.Rows.Add(dr);
                                            }
                                        }
                                        else
                                        {
                                            if (CAResult.Count > 0 || MSResult.Count > 0)
                                            {
                                                var SApps = CAResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var SMSApps = MSResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (SMSApps.Count > 0)
                                                    SApps.AddRange(SMSApps);
                                                SApps = SApps.OrderBy(u => u.App_no).ToList();
                                                string Privapp = string.Empty; DataRow dr = dtObj.NewRow(); bool Isfirst = false;
                                                foreach (var Entity in SApps)
                                                {

                                                    if (Privapp != Entity.App_no)
                                                    {
                                                        if (Isfirst)
                                                        {
                                                            dtObj.Rows.Add(dr);
                                                            dr = dtObj.NewRow();
                                                        }
                                                        dr.SetField("GoalCd", GEntity.SBGGCode);
                                                        dr.SetField("ObjCd", GEntity.SBGGSeq.Trim());
                                                        dr.SetField("Goal", GoalDesc);
                                                        dr.SetField("Objective", GEntity.SBGGDesc.Trim());
                                                        dr.SetField("Type", GEntity.SBGGCountType.Trim());
                                                        dr.SetField("Type2", GEntity.Type2.Trim());
                                                        dr.SetField("AppNo", Entity.App_no);
                                                        CASEACTEntity MstEntity = SP_Activity_Details.Find(u => u.App_no.Equals(Entity.App_no.Trim()));
                                                        string AppName = string.Empty;
                                                        if (MstEntity != null)
                                                            AppName = LookupDataAccess.GetMemberName(MstEntity.FirstName.Trim(), MstEntity.MiddleName.Trim(), MstEntity.LastName.Trim(), BaseForm.BaseHierarchyCnFormat);
                                                        else
                                                        {
                                                            CASEMSEntity MsEntity = SP_MS_Details.Find(u => u.App_no.Equals(Entity.App_no.Trim()));
                                                            if (MsEntity != null)
                                                                AppName = LookupDataAccess.GetMemberName(MsEntity.FirstName.Trim(), MsEntity.MiddleName.Trim(), MsEntity.LastName.Trim(), BaseForm.BaseHierarchyCnFormat);
                                                        }
                                                        dr.SetField("Name", AppName);
                                                        string ActDate = string.Empty;
                                                        if (CAResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code)).Count > 0)
                                                            ActDate = CAResult.Find(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code)).ACT_Date.Trim();
                                                        if (string.IsNullOrEmpty(ActDate.Trim()))
                                                        {
                                                            if (MSResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code)).Count > 0)
                                                                ActDate = MSResult.Find(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code)).Date.Trim();
                                                        }
                                                        dr.SetField(Entity.ACT_Code.Trim(), LookupDataAccess.Getdate(ActDate.Trim()));
                                                        Isfirst = true;
                                                    }
                                                    else
                                                    {
                                                        string ActDate = string.Empty;
                                                        if (CAResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code)).Count > 0)
                                                            ActDate = CAResult.Find(u => u.App_no.Equals(Entity.App_no) && u.ACT_Code.Equals(Entity.ACT_Code)).ACT_Date.Trim();
                                                        if (string.IsNullOrEmpty(ActDate.Trim()))
                                                        {
                                                            if (MSResult.FindAll(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code)).Count > 0)
                                                                ActDate = MSResult.Find(u => u.App_no.Equals(Entity.App_no) && u.MS_Code.Equals(Entity.ACT_Code)).Date.Trim();
                                                        }
                                                        dr.SetField(Entity.ACT_Code.Trim(), LookupDataAccess.Getdate(ActDate.Trim()));
                                                    }

                                                    Privapp = Entity.App_no;
                                                }
                                                if (dr != null)
                                                    dtObj.Rows.Add(dr);
                                            }
                                        }

                                        var CASEEKResult = CAResult.FindAll(u => !(u.ActSeek_Date.Trim().Equals("")));
                                        var CAAccessResult = CAResult.FindAll(u => Convert.ToDateTime(u.ACT_Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= dtpTo.Value);
                                        if (CASEEKResult.Count > 0)
                                            CASEEKResult = CASEEKResult.FindAll(u => Convert.ToDateTime(u.ActSeek_Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.ActSeek_Date.Trim()) <= dtpTo.Value);

                                        var MSSEEKResult = MSResult.FindAll(u => !(u.Seek_Date.Trim().Equals("")));
                                        var MSAccessResult = MSResult.FindAll(u => Convert.ToDateTime(u.Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.Date.Trim()) <= dtpTo.Value);
                                        if (MSSEEKResult.Count > 0)
                                            MSSEEKResult = MSSEEKResult.FindAll(u => Convert.ToDateTime(u.Seek_Date.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.Seek_Date.Trim()) <= dtpTo.Value);

                                        //var YEARCAResult = (from a in YEAR_SP_Activity_Details join s in SelCAs on a.ACT_Code equals s.SBAS_CAMS_Code select a).ToList();
                                        //var YEARMSResult = (from a in YEAR_SP_MS_Details join s in SelMSs on a.MS_Code equals s.SBAS_CAMS_Code select a).ToList();

                                        string SeekCount = string.Empty; string AccessCount = string.Empty; string YrdtCnt = string.Empty; string YrdtSeekCnt = string.Empty;
                                        if (GEntity.SBGGCountType == "S" || GEntity.Type2 == "S")
                                        {
                                            string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;


                                            var YearSpmrecs = SPMResult.FindAll(u => !(u.startdate.Trim().Equals("")));
                                            if (YearSpmrecs.Count > 0)
                                                YearSpmrecs = YearSpmrecs.FindAll(u => Convert.ToDateTime(u.startdate.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.startdate.Trim()) <= Ref_To_Date.Value);
                                            var Spmrecs = SPMResult.FindAll(u => !(u.startdate.Trim().Equals("")));
                                            if (Spmrecs.Count > 0)
                                                Spmrecs = Spmrecs.FindAll(u => Convert.ToDateTime(u.startdate.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.startdate.Trim()) <= dtpTo.Value);

                                            if (GEntity.SBGGCountType == "S")
                                            {
                                                var YrcountApps = YearSpmrecs.GroupBy(n => new { n.app_no, n.service_plan }).Select(g => new { App_no = g.Key.app_no, g.Key.service_plan }).ToList();
                                                 //= YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearAccess = YrcountApps.Select(u => u.App_no.Trim()).Distinct().Count();
                                              
                                                var countApps= Spmrecs.GroupBy(n => new { n.app_no, n.service_plan }).Select(g => new { App_no = g.Key.app_no, g.Key.service_plan }).ToList();
                                                //var countApps = Spmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                Access = countApps.Select(u => u.App_no.Trim()).Distinct().Count();

                                                if (countApps.Count > 0 || YrcountApps.Count > 0)
                                                {
                                                    var SelAccessApp = countApps.Select(u => u.App_no.Trim()).Distinct().ToList();
                                                    var SelYearApp = YrcountApps.Select(u => u.App_no.Trim()).Distinct().ToList();
                                                    if (dtObj.Rows.Count > 0)
                                                    {
                                                        int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                        foreach (DataRow row1 in dtObj.Rows)
                                                        {
                                                            foreach (var App in SelAccessApp)
                                                            {
                                                                if (App == row1["AppNo"].ToString())
                                                                {
                                                                    row1.SetField("Access", rowCountSeek + 1); rowCountSeek++; break;
                                                                }
                                                            }

                                                            foreach (var App in SelYearApp)
                                                            {
                                                                if (App == row1["AppNo"].ToString())
                                                                {
                                                                    row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; break;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            if (GEntity.Type2 == "S")
                                            {
                                                var YrcountApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearSeek = YrcountApps.Select(u => u.AppNo.Trim()).Distinct().Count();

                                                var countApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                Seek = countApps.Select(u => u.AppNo.Trim()).Distinct().Count();

                                                if (countApps.Count > 0 || YrcountApps.Count > 0)
                                                {
                                                    var SelAccessApp = countApps.Select(u => u.AppNo.Trim()).Distinct().ToList();
                                                    var SelYearApp = YrcountApps.Select(u => u.AppNo.Trim()).Distinct().ToList();
                                                    if (dtObj.Rows.Count > 0)
                                                    {
                                                        int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                        foreach (DataRow row1 in dtObj.Rows)
                                                        {
                                                            foreach (var App in SelAccessApp)
                                                            {
                                                                if (App == row1["AppNo"].ToString())
                                                                {
                                                                    row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; break;
                                                                }
                                                            }

                                                            foreach (var App in SelYearApp)
                                                            {
                                                                if (App == row1["AppNo"].ToString())
                                                                {
                                                                    row1.SetField("YeartoDateSeek", rowCountYear + 1); rowCountYear++; break;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            } 
                                            if (Seek > 0) SeekCount = Seek.ToString(); if (Access > 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();

                                            //var SpmCARecs = (from b in YearSpmrecs join t in CAResult on b.app_no equals t.App_no select t).ToList();
                                            //var SpmMSRecs = (from b in YearSpmrecs join t in MSResult on b.app_no equals t.App_no select t).ToList();

                                            //var CASResult = (from a in SP_Activity_Details join s in SelCAs on a.ACT_Code equals s.SBAS_CAMS_Code select a).ToList();
                                            //var MSSResult = (from a in SP_MS_Details join s in SelMSs on a.MS_Code equals s.SBAS_CAMS_Code select a).ToList();
                                        }

                                        if (GEntity.SBGGCountType == "C" || GEntity.Type2 == "C")
                                        {
                                            string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;
                                            var YearSpmrecs = SPMResult.FindAll(u => !(u.compdate.Trim().Equals("")));
                                            if (YearSpmrecs.Count > 0)
                                                YearSpmrecs = YearSpmrecs.FindAll(u => Convert.ToDateTime(u.compdate.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.compdate.Trim()) <= Ref_To_Date.Value);
                                            var Spmrecs = SPMResult.FindAll(u => !(u.compdate.Trim().Equals("")));
                                            if (Spmrecs.Count > 0)
                                                Spmrecs = Spmrecs.FindAll(u => Convert.ToDateTime(u.compdate.Trim()) >= dtpFrom.Value && Convert.ToDateTime(u.compdate.Trim()) <= dtpTo.Value);

                                            if (GEntity.SBGGCountType == "C")
                                            {
                                                var YrcountApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearAccess = YrcountApps.Select(u => u.AppNo.Trim()).Distinct().Count();

                                                var countApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                Access = countApps.Select(u => u.AppNo.Trim()).Distinct().Count();

                                                if (countApps.Count > 0 || YrcountApps.Count > 0)
                                                {
                                                    var SelAccessApp = countApps.Select(u => u.AppNo.Trim()).Distinct().ToList();
                                                    var SelYearApp = YrcountApps.Select(u => u.AppNo.Trim()).Distinct().ToList();
                                                    if (dtObj.Rows.Count > 0)
                                                    {
                                                        int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                        foreach (DataRow row1 in dtObj.Rows)
                                                        {
                                                            foreach (var App in SelAccessApp)
                                                            {
                                                                if (App == row1["AppNo"].ToString())
                                                                {
                                                                    row1.SetField("Access", rowCountSeek + 1); rowCountSeek++; break;
                                                                }
                                                            }

                                                            foreach (var App in SelYearApp)
                                                            {
                                                                if (App == row1["AppNo"].ToString())
                                                                {
                                                                    row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; break;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }

                                            }

                                            if (GEntity.Type2 == "C")
                                            {
                                                var YrcountApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearSeek = YrcountApps.Select(u => u.AppNo.Trim()).Distinct().Count();

                                                var countApps = YearSpmrecs.GroupBy(n => n.app_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                Seek = countApps.Select(u => u.AppNo.Trim()).Distinct().Count();

                                                if (countApps.Count > 0 || YrcountApps.Count>0)
                                                {
                                                    var SelSeekApp = countApps.Select(u => u.AppNo.Trim()).Distinct().ToList();
                                                    var SelYearApp = YrcountApps.Select(u => u.AppNo.Trim()).Distinct().ToList();
                                                    if (dtObj.Rows.Count > 0)
                                                    {
                                                        int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                        foreach (DataRow row1 in dtObj.Rows)
                                                        {
                                                            foreach (var App in SelSeekApp)
                                                            {
                                                                if (App == row1["AppNo"].ToString())
                                                                {
                                                                    row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; break;
                                                                }
                                                            }

                                                            foreach (var App in SelYearApp)
                                                            {
                                                                if (App == row1["AppNo"].ToString())
                                                                {
                                                                    row1.SetField("YeartoDateSeek", rowCountYear + 1); rowCountYear++; break;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }


                                            } 
                                            if (Seek > 0) SeekCount = Seek.ToString(); if (Access > 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();

                                            //var SpmCARecs = (from b in YearSpmrecs join t in CAResult on b.app_no equals t.App_no select t).ToList();
                                            //var SpmMSRecs = (from b in YearSpmrecs join t in MSResult on b.app_no equals t.App_no select t).ToList();

                                            //var CASResult = (from a in SP_Activity_Details join s in SelCAs on a.ACT_Code equals s.SBAS_CAMS_Code select a).ToList();
                                            //var MSSResult = (from a in SP_MS_Details join s in SelMSs on a.MS_Code equals s.SBAS_CAMS_Code select a).ToList();
                                        }

                                        if (GEntity.SBGGCountType == "A" || GEntity.Type2 == "A")
                                        {
                                            string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;
                                            if (GEntity.Type2 == "A")
                                            {
                                                var SApps = CASEEKResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var SMSApps = MSSEEKResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (SMSApps.Count > 0)
                                                    SApps.AddRange(SMSApps);

                                                var countApps = SApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();

                                                var YrCASEEKResult = CAResult.FindAll(u => !(u.ActSeek_Date.Trim().Equals("")));
                                                var YearSKrecs = YrCASEEKResult.FindAll(u => Convert.ToDateTime(u.ActSeek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ActSeek_Date.Trim()) <= Ref_To_Date.Value);
                                                var YearSKApps = YearSKrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var YrMSSEEKResult = MSResult.FindAll(u => !(u.Seek_Date.Trim().Equals("")));
                                                var YearSKMSrecs = YrMSSEEKResult.FindAll(u => Convert.ToDateTime(u.Seek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Seek_Date.Trim()) <= Ref_To_Date.Value);
                                                var YearSKMSApps = YearSKMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (YearSKMSApps.Count > 0)
                                                    YearSKApps.AddRange(YearSKMSApps);

                                                var YearSKcountApps = YearSKApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearSeek = YearSKcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count)).Count;

                                                Seek = countApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count)).Count;

                                                if (countApps.Count > 0)
                                                {
                                                    if ((GEntity.SBGGCountType == "C" || GEntity.Type2 == "C") || (GEntity.SBGGCountType == "S" || GEntity.Type2 == "S"))
                                                    {
                                                    }
                                                    else
                                                    {
                                                        var SelSeekApp = countApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count));
                                                        var SelYearApp = YearSKcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count));
                                                        if (dtObj.Rows.Count > 0)
                                                        {
                                                            int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                            foreach (DataRow row1 in dtObj.Rows)
                                                            {
                                                                if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; }
                                                                if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("YeartoDateSeek", rowCountYear + 1); rowCountYear++; }
                                                            }
                                                        }
                                                    }
                                                }

                                            }
                                            if (GEntity.SBGGCountType == "A")
                                            {
                                                var AApps = CAAccessResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var AMSApps = MSAccessResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (AMSApps.Count > 0)
                                                    AApps.AddRange(AMSApps);

                                                var AcountApps = AApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                Access = AcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count)).Count;

                                                var YrCASEEKResult = CAResult.FindAll(u => !(u.ACT_Date.Trim().Equals("")));
                                                var Yearrecs = YrCASEEKResult.FindAll(u => Convert.ToDateTime(u.ACT_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= Ref_To_Date.Value);
                                                var YearSApps = Yearrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var YrMSSEEKResult = MSResult.FindAll(u => !(u.Date.Trim().Equals("")));
                                                var YearMSrecs = YrMSSEEKResult.FindAll(u => Convert.ToDateTime(u.Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Date.Trim()) <= Ref_To_Date.Value);
                                                var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (YearSMSApps.Count > 0)
                                                    YearSApps.AddRange(YearSMSApps);

                                                var YearcountApps = YearSApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearAccess = YearcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count)).Count;

                                                if (AcountApps.Count > 0 || YearcountApps.Count > 0)
                                                {
                                                    if ((GEntity.SBGGCountType == "C" || GEntity.Type2 == "C") || (GEntity.SBGGCountType == "S" || GEntity.Type2 == "S"))
                                                    {
                                                    }
                                                    else
                                                    {
                                                        //var SelSeekApp = countApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count));
                                                        var SelAccessApp = AcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count));
                                                        var SelYearApp = YearcountApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count));
                                                        if (dtObj.Rows.Count > 0)
                                                        {
                                                            int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                            foreach (DataRow row1 in dtObj.Rows)
                                                            {
                                                                //if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                //{ row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; }
                                                                if (SelAccessApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("Access", rowCountAccess + 1); rowCountAccess++; }
                                                                if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; }
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            if (Seek > 0) SeekCount = Seek.ToString(); if (Access > 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();
                                        }

                                        if (GEntity.SBGGCountType == "N" || GEntity.Type2 == "N")
                                        {
                                            string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;
                                            if (GEntity.Type2 == "N")
                                            {
                                                var SApps = CASEEKResult.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                var SMSApps = MSSEEKResult.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                if (SMSApps.Count > 0)
                                                    SApps.AddRange(SMSApps);

                                                //var countApps = SApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();

                                                Seek = SApps.Select(u => u.App_no.Trim()).Distinct().Count();
                                                //countApps.FindAll(u => u.Count.Equals(SSBGSelAssns.Count)).Count.ToString();

                                                var YrCASEEKResult = CAResult.FindAll(u => !(u.ActSeek_Date.Trim().Equals("")));
                                                var Yearrecs = YrCASEEKResult.FindAll(u => Convert.ToDateTime(u.ActSeek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ActSeek_Date.Trim()) <= Ref_To_Date.Value);

                                                var YrMSSEEKResult = MSResult.FindAll(u => !(u.Seek_Date.Trim().Equals("")));
                                                var YearMSrecs = YrMSSEEKResult.FindAll(u => Convert.ToDateTime(u.Seek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Seek_Date.Trim()) <= Ref_To_Date.Value);

                                                var YearSApps = Yearrecs.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                if (YearSMSApps.Count > 0)
                                                    YearSApps.AddRange(YearSMSApps);

                                                YearSeek = YearSApps.Select(u => u.App_no.Trim()).Distinct().Count();

                                                if (SApps.Count > 0)
                                                {
                                                    if ((GEntity.SBGGCountType == "C" || GEntity.Type2 == "C") || (GEntity.SBGGCountType == "S" || GEntity.Type2 == "S"))
                                                    {
                                                    }
                                                    else
                                                    {
                                                        var SelSeekApp = SApps.Select(u => u.App_no.Trim()).Distinct().ToList();
                                                        //var SelAccessApp = AApps.Select(u => u.App_no.Trim()).Distinct().ToList();
                                                        var SelYearApp = YearSApps.Select(u => u.App_no.Trim()).Distinct().ToList();
                                                        if (dtObj.Rows.Count > 0)
                                                        {
                                                            int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                            foreach (DataRow row1 in dtObj.Rows)
                                                            {
                                                                foreach (var App in SelSeekApp)
                                                                {
                                                                    if (App == row1["AppNo"].ToString())
                                                                    {
                                                                        row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; break;
                                                                    }
                                                                }

                                                                foreach (var App in SelYearApp)
                                                                {
                                                                    if (App == row1["AppNo"].ToString())
                                                                    {
                                                                        row1.SetField("YeartoDateSeek", rowCountYear + 1); rowCountYear++; break;
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                            if (GEntity.SBGGCountType == "N")
                                            {
                                                var AApps = CAAccessResult.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                var AMSApps = MSAccessResult.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                if (AMSApps.Count > 0)
                                                    AApps.AddRange(AMSApps);

                                                //var AcountApps = SApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                Access = AApps.Select(u => u.App_no.Trim()).Distinct().Count();

                                                var YrCASEEKResult = CAResult.FindAll(u => !(u.ACT_Date.Trim().Equals("")));
                                                var Yearrecs = YrCASEEKResult.FindAll(u => Convert.ToDateTime(u.ACT_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= Ref_To_Date.Value);

                                                var YrMSSEEKResult = MSResult.FindAll(u => !(u.Date.Trim().Equals("")));
                                                var YearMSrecs = YrMSSEEKResult.FindAll(u => Convert.ToDateTime(u.Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Date.Trim()) <= Ref_To_Date.Value);

                                                var YearSApps = Yearrecs.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                if (YearSMSApps.Count > 0)
                                                    YearSApps.AddRange(YearSMSApps);

                                                YearAccess = YearSApps.Select(u => u.App_no.Trim()).Distinct().Count();

                                                if (AApps.Count > 0 || YearSApps.Count > 0)
                                                {
                                                    if ((GEntity.SBGGCountType == "C" || GEntity.Type2 == "C") || (GEntity.SBGGCountType == "S" || GEntity.Type2 == "S"))
                                                    {
                                                    }
                                                    else
                                                    {
                                                        //var SelSeekApp = SApps.Select(u => u.App_no.Trim()).Distinct().ToList();
                                                        var SelAccessApp = AApps.Select(u => u.App_no.Trim()).Distinct().ToList();
                                                        var SelYearApp = YearSApps.Select(u => u.App_no.Trim()).Distinct().ToList();
                                                        if (dtObj.Rows.Count > 0)
                                                        {
                                                            int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                            foreach (DataRow row1 in dtObj.Rows)
                                                            {
                                                                //foreach (var App in SelSeekApp)
                                                                //{
                                                                //    if (App == row1["AppNo"].ToString())
                                                                //    {
                                                                //        row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; break;
                                                                //    }
                                                                //}
                                                                foreach (var App in SelAccessApp)
                                                                {
                                                                    if (App == row1["AppNo"].ToString())
                                                                    {
                                                                        row1.SetField("Access", rowCountAccess + 1); rowCountAccess++; break;
                                                                    }
                                                                }
                                                                foreach (var App in SelYearApp)
                                                                {
                                                                    if (App == row1["AppNo"].ToString())
                                                                    {
                                                                        row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; break;
                                                                    }
                                                                }
                                                                //if (SelAccessApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                //    row1.SetField("Access", rowCountAccess++);
                                                                //if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                //    row1.SetField("YeartoDate", rowCountYear++);
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            if (Seek != 0) SeekCount = Seek.ToString(); if (Access != 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();
                                        }

                                        if (GEntity.SBGGCountType == "1" || GEntity.Type2 == "1")
                                        {
                                            string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;
                                            if (GEntity.Type2 == "1")
                                            {
                                                var SApps = CASEEKResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                var SMSApps = MSSEEKResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                if (SMSApps.Count > 0)
                                                    SApps.AddRange(SMSApps);

                                                var countApps = SApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();

                                                Seek = countApps.FindAll(u => u.Count < 3 && u.Count > 1).Count;

                                                var YrCASEEKResult = CAResult.FindAll(u => !(u.ActSeek_Date.Trim().Equals("")));
                                                var Yearrecs = YrCASEEKResult.FindAll(u => Convert.ToDateTime(u.ActSeek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ActSeek_Date.Trim()) <= Ref_To_Date.Value);

                                                var YrMSSEEKResult = MSResult.FindAll(u => !(u.Seek_Date.Trim().Equals("")));
                                                var YearMSrecs = YrMSSEEKResult.FindAll(u => Convert.ToDateTime(u.Seek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Seek_Date.Trim()) <= Ref_To_Date.Value);

                                                var YearSApps = Yearrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (YearSMSApps.Count > 0)
                                                    YearSApps.AddRange(YearSMSApps);

                                                var YearcountApps = YearSApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearSeek = YearcountApps.FindAll(u => u.Count < 3 && u.Count > 1).Count;

                                                if (SApps.Count > 0)
                                                {
                                                    if ((GEntity.SBGGCountType == "C" || GEntity.Type2 == "C") || (GEntity.SBGGCountType == "S" || GEntity.Type2 == "S"))
                                                    {
                                                    }
                                                    else
                                                    {
                                                        var SelSeekApp = countApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
                                                        //var SelAccessApp = AcountApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
                                                        var SelYearApp = YearcountApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
                                                        if (dtObj.Rows.Count > 0)
                                                        {
                                                            int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                            foreach (DataRow row1 in dtObj.Rows)
                                                            {
                                                                if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                {
                                                                    row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++;
                                                                }
                                                                if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("YeartoDateSeek", rowCountYear + 1); rowCountYear++; }
                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            if (GEntity.SBGGCountType == "1")
                                            {
                                                var AApps = CAAccessResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                var AMSApps = MSAccessResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                if (AMSApps.Count > 0)
                                                    AApps.AddRange(AMSApps);

                                                var AcountApps = AApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                Access = AcountApps.FindAll(u => u.Count < 3 && u.Count > 1).Count;

                                                var YrCASEEKResult = CAResult.FindAll(u => !(u.ACT_Date.Trim().Equals("")));
                                                var Yearrecs = YrCASEEKResult.FindAll(u => Convert.ToDateTime(u.ACT_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= Ref_To_Date.Value);

                                                var YrMSSEEKResult = MSResult.FindAll(u => !(u.Date.Trim().Equals("")));
                                                var YearMSrecs = YrMSSEEKResult.FindAll(u => Convert.ToDateTime(u.Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Date.Trim()) <= Ref_To_Date.Value);

                                                var YearSApps = Yearrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (YearSMSApps.Count > 0)
                                                    YearSApps.AddRange(YearSMSApps);

                                                var YearcountApps = YearSApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearAccess = YearcountApps.FindAll(u => u.Count < 3 && u.Count > 1).Count;

                                                if (AApps.Count > 0 || YearSApps.Count > 0)
                                                {
                                                    if ((GEntity.SBGGCountType == "C" || GEntity.Type2 == "C") || (GEntity.SBGGCountType == "S" || GEntity.Type2 == "S"))
                                                    {
                                                    }
                                                    else
                                                    {
                                                        //var SelSeekApp = countApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
                                                        var SelAccessApp = AcountApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
                                                        var SelYearApp = YearcountApps.FindAll(u => u.Count < 3 && u.Count > 1).ToList();
                                                        if (dtObj.Rows.Count > 0)
                                                        {
                                                            int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                            foreach (DataRow row1 in dtObj.Rows)
                                                            {
                                                                //if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                //{
                                                                //    row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++;
                                                                //}
                                                                if (SelAccessApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("Access", rowCountAccess + 1); rowCountAccess++; }
                                                                if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; }

                                                            }
                                                        }
                                                    }
                                                }
                                            }

                                            if (Seek != 0) SeekCount = Seek.ToString(); if (Access != 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();
                                        }

                                        if (GEntity.SBGGCountType == "2" || GEntity.Type2 == "2")
                                        {
                                            string Appno = string.Empty; int Seek = 0; int Access = 0; int YearAccess = 0; int YearSeek = 0;
                                            if (GEntity.Type2 == "2")
                                            {
                                                var SApps = CASEEKResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                var SMSApps = MSSEEKResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                if (SMSApps.Count > 0)
                                                    SApps.AddRange(SMSApps);

                                                var countApps = SApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();

                                                Seek = countApps.FindAll(u => u.Count > 2).Count;

                                                var YrCASEEKResult = CAResult.FindAll(u => !(u.ActSeek_Date.Trim().Equals("")));
                                                var Yearrecs = YrCASEEKResult.FindAll(u => Convert.ToDateTime(u.ActSeek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ActSeek_Date.Trim()) <= Ref_To_Date.Value);

                                                var YrMSSEEKResult = MSResult.FindAll(u => !(u.Seek_Date.Trim().Equals("")));
                                                var YearMSrecs = YrMSSEEKResult.FindAll(u => Convert.ToDateTime(u.Seek_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Seek_Date.Trim()) <= Ref_To_Date.Value);

                                                var YearSApps = Yearrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (YearSMSApps.Count > 0)
                                                    YearSApps.AddRange(YearSMSApps);

                                                var YearcountApps = YearSApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearSeek = YearcountApps.FindAll(u => u.Count > 2).Count;

                                                if (SApps.Count > 0)
                                                {
                                                    if ((GEntity.SBGGCountType == "C" || GEntity.Type2 == "C") || (GEntity.SBGGCountType == "S" || GEntity.Type2 == "S"))
                                                    {
                                                    }
                                                    else
                                                    {
                                                        var SelSeekApp = countApps.FindAll(u => u.Count > 2).ToList();
                                                        //var SelAccessApp = AcountApps.FindAll(u => u.Count > 2).ToList();
                                                        var SelYearApp = YearcountApps.FindAll(u => u.Count > 2).ToList();
                                                        if (dtObj.Rows.Count > 0)
                                                        {
                                                            int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                            foreach (DataRow row1 in dtObj.Rows)
                                                            {
                                                                if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; }
                                                                //if (SelAccessApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                //{ row1.SetField("Access", rowCountAccess + 1); rowCountAccess++; }
                                                                if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("YeartoDateSeek", rowCountYear + 1); rowCountYear++; }
                                                            }
                                                        }
                                                    }
                                                }

                                            }
                                            if (GEntity.SBGGCountType == "2")
                                            {
                                                var AApps = CAAccessResult.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                var AMSApps = MSAccessResult.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no }).ToList();
                                                if (AMSApps.Count > 0)
                                                    AApps.AddRange(AMSApps);

                                                var AcountApps = AApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                Access = AcountApps.FindAll(u => u.Count > 2).Count;

                                                var YrCASEEKResult = CAResult.FindAll(u => !(u.ACT_Date.Trim().Equals("")));
                                                var Yearrecs = YrCASEEKResult.FindAll(u => Convert.ToDateTime(u.ACT_Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.ACT_Date.Trim()) <= Ref_To_Date.Value);

                                                var YrMSSEEKResult = MSResult.FindAll(u => !(u.Date.Trim().Equals("")));
                                                var YearMSrecs = YrMSSEEKResult.FindAll(u => Convert.ToDateTime(u.Date.Trim()) >= Ref_From_Date.Value && Convert.ToDateTime(u.Date.Trim()) <= Ref_To_Date.Value);

                                                var YearSApps = Yearrecs.GroupBy(n => new { n.App_no, n.ACT_Code }).Select(g => new { App_no = g.Key.App_no, g.Key.ACT_Code }).ToList();
                                                var YearSMSApps = YearMSrecs.GroupBy(n => new { n.App_no, n.MS_Code }).Select(g => new { App_no = g.Key.App_no, ACT_Code = g.Key.MS_Code }).ToList();
                                                if (YearSMSApps.Count > 0)
                                                    YearSApps.AddRange(YearSMSApps);

                                                var YearcountApps = YearSApps.GroupBy(n => n.App_no).Select(g => new { AppNo = g.Key, Count = g.Count() }).ToList();
                                                YearAccess = YearcountApps.FindAll(u => u.Count > 2).Count;

                                                if (AApps.Count > 0 || YearSApps.Count > 0)
                                                {
                                                    if ((GEntity.SBGGCountType == "C" || GEntity.Type2 == "C") || (GEntity.SBGGCountType == "S" || GEntity.Type2 == "S"))
                                                    {
                                                    }
                                                    else
                                                    {
                                                        //var SelSeekApp = countApps.FindAll(u => u.Count > 2).ToList();
                                                        var SelAccessApp = AcountApps.FindAll(u => u.Count > 2).ToList();
                                                        var SelYearApp = YearcountApps.FindAll(u => u.Count > 2).ToList();
                                                        if (dtObj.Rows.Count > 0)
                                                        {
                                                            int rowCountSeek = 0, rowCountAccess = 0, rowCountYear = 0;
                                                            foreach (DataRow row1 in dtObj.Rows)
                                                            {
                                                                //if (SelSeekApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                //{ row1.SetField("Seek", rowCountSeek + 1); rowCountSeek++; }
                                                                if (SelAccessApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("Access", rowCountAccess + 1); rowCountAccess++; }
                                                                if (SelYearApp.FindAll(u => u.AppNo.Equals(row1["AppNo"].ToString())).Count > 0)
                                                                { row1.SetField("YeartoDate", rowCountYear + 1); rowCountYear++; }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                            if (Seek != 0) SeekCount = Seek.ToString(); if (Access != 0) AccessCount = Access.ToString(); if (YearAccess > 0) YrdtCnt = YearAccess.ToString(); if (YearSeek > 0) YrdtSeekCnt = YearSeek.ToString();
                                        }

                                        row = sheet.Table.Rows.Add();
                                        row.Height = 22;
                                        row.AutoFitHeight = false;

                                        S1 = row.Cells.Add(GEntity.SBGGDesc.Trim(), DataType.String, "m106944884");
                                        S1.MergeAcross = 7;

                                        S1 = row.Cells.Add(SeekCount, DataType.Number, "s44");
                                        S1 = row.Cells.Add(AccessCount, DataType.Number, "s44");
                                        S1 = row.Cells.Add(YrdtSeekCnt, DataType.Number, "s45");
                                        S1 = row.Cells.Add(YrdtCnt, DataType.Number, "s45");
                                        if (!string.IsNullOrEmpty(SeekCount.Trim()))
                                        {
                                            S1 = row.Cells.Add("0", DataType.Number, "s45");
                                            //S1.Data.Type = DataType.Error;
                                            S1.Formula = "+RC[-2]/RC[-3]";
                                        }
                                        else
                                        {
                                            S1 = row.Cells.Add("#DIV/0!", DataType.String, "s46");
                                            S1.Data.Type = DataType.Error;
                                            //S1.Formula = "+RC[-2]/RC[-1]";
                                        }

                                        //S1 = row.Cells.Add("", DataType.String, "m95382716");
                                        ////S1.MergeAcross = 1;

                                        if (dtObj.Rows.Count > 0)
                                        {
                                            DatasetFillingObjectives(ObjCnt, dtObj);
                                            ObjCnt++;
                                        }
                                    }
                                    //DatasetFillingObjectives(GoalCnt, dtObj);
                                }
                            }

                            row = sheet.Table.Rows.Add();
                            row.Height = 44;
                            row.AutoFitHeight = false;

                            S1 = row.Cells.Add("Comments:", DataType.String, "m106945024");
                            S1.MergeAcross = 12;



                        }

                    }
                    //if (ds.Tables.Count > 0)
                    //{
                    //    this.GenerateWorksheetReport(book.Worksheets);
                    //    this.GenerateWorksheetBypassReport(book.Worksheets);
                    //}


                    FileStream stream = new FileStream(PdfName, FileMode.Create);

                    book.Save(stream);
                    stream.Close();

                    if (ds.Tables.Count > 0)
                    {
                        PrintHRANBAuditReportIntakes(AuditName, SelSSBG);
                        //PrintAuditReportIntakes(AuditName);
                    }
                    if (dsObj.Tables.Count > 0)
                    {
                        PrintHRANBAuditReportObjective(AuditName, SSBGCAMS_List);
                    }
                }
                catch (Exception ex) { }

            }
        }

        private void GenerateWorksheetReport(WorksheetCollection sheets)
        {
            if (ds.Tables.Count > 0)
            {
                SSBGPARAMEntity SelSSBG = SSBGParamall.Find(u => ((u.SSBGSeq).Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString())));
                List<SSBGTYPESEntity> SSBGCritQuestions = SSBGTypesQues.FindAll(u => (u.SBGTID.Equals(SelSSBG.SSBGSeq) && (!u.SBGTGroupSeq.Equals("0"))));
                Worksheet sheet = sheets.Add("Detailed Report");

                if (ds.Tables.Count > 0)
                {
                    bool First = true;
                    for (int x = 0; x < ds.Tables.Count; x++)
                    {
                        if (ds.Tables[x].Rows.Count > 0)
                        {
                            DataTable dt = new DataTable();
                            List<SSBGTYPESEntity> SSBGQues = SSBGCritQuestions.FindAll(u => u.SBGTCode.Equals(ds.Tables[x].Rows[0]["Type"].ToString()));
                            SSBGQues = SSBGQues.OrderBy(u => u.SBGTQuesCode.Trim()).ToList();
                            if (SSBGQues.Count > 0)
                            {
                                string[] ItemQues = new string[SSBGQues.Count];
                                string[] QuesDesc = new string[SSBGQues.Count];
                                int i = 0;
                                foreach (SSBGTYPESEntity item in SSBGQues)
                                {
                                    QuesDesc[i] = item.EligQuestionDesc.Trim();
                                    ItemQues[i] = "ByPass" + item.EligQuestionDesc.Trim().Replace(' ', '_');
                                    i++;
                                }

                                if (SSBGQues.Count == 1) { DataView dv = new DataView(ds.Tables[x]); dv.RowFilter = ItemQues[0] + "='Y'"; dt = dv.ToTable(); }
                                if (SSBGQues.Count == 2) { DataView dv = new DataView(ds.Tables[x]); dv.RowFilter = ItemQues[0] + "='Y' AND " + ItemQues[1] + "='Y'"; dt = dv.ToTable(); }
                                if (SSBGQues.Count == 3) { DataView dv = new DataView(ds.Tables[x]); dv.RowFilter = ItemQues[0] + "='Y' AND " + ItemQues[1] + "='Y' AND " + ItemQues[2] + "='Y'"; dt = dv.ToTable(); }
                                if (SSBGQues.Count == 4) { DataView dv = new DataView(ds.Tables[x]); dv.RowFilter = ItemQues[0] + "='Y' AND " + ItemQues[1] + "='Y' AND " + ItemQues[2] + "='Y' AND " + ItemQues[3] + "='Y'"; dt = dv.ToTable(); }

                                if (dt.Rows.Count > 0)
                                {
                                    //Worksheet sheet = book.Worksheets.Add("Detailed Report");
                                    sheet.Table.DefaultRowHeight = 14.25F;

                                    sheet.Table.StyleID = "s16";
                                    WorksheetColumn column0 = sheet.Table.Columns.Add();
                                    column0.Width = 88;
                                    column0.StyleID = "s16";
                                    WorksheetColumn column1 = sheet.Table.Columns.Add();
                                    column1.Width = 200;
                                    column1.StyleID = "s16";

                                    for (int j = 0; j < SSBGQues.Count; j++)
                                    {
                                        WorksheetColumn column = sheet.Table.Columns.Add();
                                        column.Width = 75;
                                        column.StyleID = "s16";
                                    }

                                    //WorksheetColumn column2 = sheet.Table.Columns.Add();
                                    //column2.Width = 55;
                                    //column2.StyleID = "s16";
                                    //WorksheetColumn column3 = sheet.Table.Columns.Add();
                                    //column3.Width = 60;
                                    //column3.StyleID = "s16";
                                    //WorksheetColumn column4 = sheet.Table.Columns.Add();
                                    //column4.Width = 36;
                                    //column4.StyleID = "s16";
                                    ////WorksheetColumn column5 = sheet.Table.Columns.Add();
                                    ////column5.Width = 0;
                                    ////column5.StyleID = "s16";
                                    //WorksheetColumn column6 = sheet.Table.Columns.Add();
                                    //column6.Width = 50;
                                    //column6.StyleID = "s16";
                                    //WorksheetColumn column7 = sheet.Table.Columns.Add();
                                    //column7.Width = 60;
                                    //column7.StyleID = "s16";
                                    //WorksheetColumn column8 = sheet.Table.Columns.Add();
                                    //column8.Width = 65;
                                    //column8.StyleID = "s16";
                                    //WorksheetColumn column9 = sheet.Table.Columns.Add();
                                    //column9.Width = 35;
                                    //column9.StyleID = "s16";
                                    
                                    WorksheetRow row = sheet.Table.Rows.Add();
                                    
                                    WorksheetCell cell;
                                    

                                    if (First)
                                    {
                                        row.Height = 25;
                                        row.AutoFitHeight = false;

                                        cell = row.Cells.Add(SelSSBG.SSBGDesc.Trim(), DataType.String, "Header");
                                        cell.MergeAcross = (2 + SSBGQues.Count) - 1;

                                        First = false;
                                    }

                                    row = sheet.Table.Rows.Add();
                                    cell = row.Cells.Add("Type :" + dt.Rows[0]["TypeDesc"].ToString(), DataType.String, "TypeHeader");
                                    cell.MergeAcross = (2 + SSBGQues.Count) - 1;

                                    row = sheet.Table.Rows.Add();
                                    cell = row.Cells.Add("App No", DataType.String, "Header");
                                    cell = row.Cells.Add("Name", DataType.String, "Header");
                                    if (SSBGQues.Count == 1) { cell = row.Cells.Add(QuesDesc[0].ToString(), DataType.String, "Header"); }
                                    if (SSBGQues.Count == 2) { cell = row.Cells.Add(QuesDesc[0].ToString(), DataType.String, "Header"); cell = row.Cells.Add(QuesDesc[1].ToString(), DataType.String, "Header"); }
                                    if (SSBGQues.Count == 3) { cell = row.Cells.Add(QuesDesc[0].ToString(), DataType.String, "Header"); cell = row.Cells.Add(QuesDesc[1].ToString(), DataType.String, "Header"); cell = row.Cells.Add(QuesDesc[2].ToString(), DataType.String, "Header"); }
                                    if (SSBGQues.Count == 4) { cell = row.Cells.Add(QuesDesc[0].ToString(), DataType.String, "Header"); cell = row.Cells.Add(QuesDesc[1].ToString(), DataType.String, "Header"); cell = row.Cells.Add(QuesDesc[2].ToString(), DataType.String, "Header"); cell = row.Cells.Add(QuesDesc[3].ToString(), DataType.String, "Header"); }


                                    foreach (DataRow dr in dt.Rows)
                                    {
                                        row = sheet.Table.Rows.Add();

                                        cell = row.Cells.Add(dr["AppNo"].ToString(), DataType.String, "s26");
                                        cell = row.Cells.Add(dr["Name"].ToString(), DataType.String, "s26");

                                        if (SSBGQues.Count == 1) { cell = row.Cells.Add(dr[QuesDesc[0]].ToString(), DataType.String, "s26"); }
                                        if (SSBGQues.Count == 2) { cell = row.Cells.Add(dr[QuesDesc[0]].ToString(), DataType.String, "s26"); cell = row.Cells.Add(dr[QuesDesc[1]].ToString(), DataType.String, "s26"); }
                                        if (SSBGQues.Count == 3) { cell = row.Cells.Add(dr[QuesDesc[0]].ToString(), DataType.String, "s26"); cell = row.Cells.Add(dr[QuesDesc[1]].ToString(), DataType.String, "s26"); cell = row.Cells.Add(dr[QuesDesc[2]].ToString(), DataType.String, "s26"); }
                                        if (SSBGQues.Count == 4) { cell = row.Cells.Add(dr[QuesDesc[0]].ToString(), DataType.String, "s26"); cell = row.Cells.Add(dr[QuesDesc[1]].ToString(), DataType.String, "s26"); cell = row.Cells.Add(dr[QuesDesc[2]].ToString(), DataType.String, "s26"); cell = row.Cells.Add(dr[QuesDesc[3]].ToString(), DataType.String, "s26"); }

                                    }

                                    //row = sheet.Table.Rows.Add();
                                    //row = sheet.Table.Rows.Add();
                                    //row = sheet.Table.Rows.Add();
                                    //row = sheet.Table.Rows.Add();
                                }


                            }
                        }
                    }


                }

            }
        }

        private void GenerateWorksheetBypassReport(WorksheetCollection sheets)
        {
            if (ds.Tables.Count > 0)
            {
                SSBGPARAMEntity SelSSBG = SSBGParamall.Find(u => ((u.SSBGSeq).Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString())));
                List<SSBGTYPESEntity> SSBGCritQuestions = SSBGTypesQues.FindAll(u => (u.SBGTID.Equals(SelSSBG.SSBGSeq) && (!u.SBGTGroupSeq.Equals("0"))));
                Worksheet sheet = sheets.Add("Bypass Report");

                if (ds.Tables.Count > 0)
                {
                    bool First = true;
                    for (int x = 0; x < ds.Tables.Count; x++)
                    {
                        if (ds.Tables[x].Rows.Count > 0)
                        {
                            DataTable dt = new DataTable();
                            List<SSBGTYPESEntity> SSBGQues = SSBGCritQuestions.FindAll(u => u.SBGTCode.Equals(ds.Tables[x].Rows[0]["Type"].ToString()));
                            SSBGQues = SSBGQues.OrderBy(u => u.SBGTQuesCode.Trim()).ToList();
                            if (SSBGQues.Count > 0)
                            {
                                string[] ItemQues = new string[SSBGQues.Count];
                                string[] QuesDesc = new string[SSBGQues.Count];
                                int i = 0;
                                foreach (SSBGTYPESEntity item in SSBGQues)
                                {
                                    QuesDesc[i] = item.EligQuestionDesc.Trim();
                                    ItemQues[i] = "ByPass" + item.EligQuestionDesc.Trim().Replace(' ', '_');
                                    i++;
                                }

                                if (SSBGQues.Count == 1) { DataView dv = new DataView(ds.Tables[x]); dv.RowFilter = ItemQues[0] + "='N'"; dt = dv.ToTable(); }
                                if (SSBGQues.Count == 2) { DataView dv = new DataView(ds.Tables[x]); dv.RowFilter = ItemQues[0] + "='N' OR " + ItemQues[1] + "='N'"; dt = dv.ToTable(); }
                                if (SSBGQues.Count == 3) { DataView dv = new DataView(ds.Tables[x]); dv.RowFilter = ItemQues[0] + "='N' OR " + ItemQues[1] + "='N' OR " + ItemQues[2] + "='N'"; dt = dv.ToTable(); }
                                if (SSBGQues.Count == 4) { DataView dv = new DataView(ds.Tables[x]); dv.RowFilter = ItemQues[0] + "='N' OR " + ItemQues[1] + "='N' OR " + ItemQues[2] + "='N' OR " + ItemQues[3] + "='Y'"; dt = dv.ToTable(); }

                                if (dt.Rows.Count > 0)
                                {
                                    //Worksheet sheet = book.Worksheets.Add("Detailed Report");
                                    sheet.Table.DefaultRowHeight = 14.25F;

                                    sheet.Table.StyleID = "s16";
                                    WorksheetColumn column0 = sheet.Table.Columns.Add();
                                    column0.Width = 88;
                                    column0.StyleID = "s16";
                                    WorksheetColumn column1 = sheet.Table.Columns.Add();
                                    column1.Width = 200;
                                    column1.StyleID = "s16";

                                    for (int j = 0; j < SSBGQues.Count; j++)
                                    {
                                        WorksheetColumn column = sheet.Table.Columns.Add();
                                        column.Width = 75;
                                        column.StyleID = "s16";
                                    }

                                    //WorksheetColumn column2 = sheet.Table.Columns.Add();
                                    //column2.Width = 55;
                                    //column2.StyleID = "s16";
                                    //WorksheetColumn column3 = sheet.Table.Columns.Add();
                                    //column3.Width = 60;
                                    //column3.StyleID = "s16";
                                    //WorksheetColumn column4 = sheet.Table.Columns.Add();
                                    //column4.Width = 36;
                                    //column4.StyleID = "s16";
                                    ////WorksheetColumn column5 = sheet.Table.Columns.Add();
                                    ////column5.Width = 0;
                                    ////column5.StyleID = "s16";
                                    //WorksheetColumn column6 = sheet.Table.Columns.Add();
                                    //column6.Width = 50;
                                    //column6.StyleID = "s16";
                                    //WorksheetColumn column7 = sheet.Table.Columns.Add();
                                    //column7.Width = 60;
                                    //column7.StyleID = "s16";
                                    //WorksheetColumn column8 = sheet.Table.Columns.Add();
                                    //column8.Width = 65;
                                    //column8.StyleID = "s16";
                                    //WorksheetColumn column9 = sheet.Table.Columns.Add();
                                    //column9.Width = 35;
                                    //column9.StyleID = "s16";
                                    WorksheetRow row = sheet.Table.Rows.Add();
                                    

                                    WorksheetCell cell;


                                    if (First)
                                    {
                                        row.Height = 25;
                                        row.AutoFitHeight = false;

                                        cell = row.Cells.Add(SelSSBG.SSBGDesc.Trim(), DataType.String, "Header");
                                        cell.MergeAcross = (2 + SSBGQues.Count) - 1;

                                        First = false;
                                    }

                                    row = sheet.Table.Rows.Add();
                                    cell = row.Cells.Add("Type :" + dt.Rows[0]["TypeDesc"].ToString(), DataType.String, "TypeHeader");
                                    cell.MergeAcross = (2 + SSBGQues.Count) - 1;

                                    row = sheet.Table.Rows.Add();
                                    cell = row.Cells.Add("App No", DataType.String, "Header");
                                    cell = row.Cells.Add("Name", DataType.String, "Header");
                                    if (SSBGQues.Count == 1) { cell = row.Cells.Add(QuesDesc[0].ToString(), DataType.String, "Header"); }
                                    if (SSBGQues.Count == 2) { cell = row.Cells.Add(QuesDesc[0].ToString(), DataType.String, "Header"); cell = row.Cells.Add(QuesDesc[1].ToString(), DataType.String, "Header"); }
                                    if (SSBGQues.Count == 3) { cell = row.Cells.Add(QuesDesc[0].ToString(), DataType.String, "Header"); cell = row.Cells.Add(QuesDesc[1].ToString(), DataType.String, "Header"); cell = row.Cells.Add(QuesDesc[2].ToString(), DataType.String, "Header"); }
                                    if (SSBGQues.Count == 4) { cell = row.Cells.Add(QuesDesc[0].ToString(), DataType.String, "Header"); cell = row.Cells.Add(QuesDesc[1].ToString(), DataType.String, "Header"); cell = row.Cells.Add(QuesDesc[2].ToString(), DataType.String, "Header"); cell = row.Cells.Add(QuesDesc[3].ToString(), DataType.String, "Header"); }


                                    foreach (DataRow dr in dt.Rows)
                                    {
                                        row = sheet.Table.Rows.Add();

                                        cell = row.Cells.Add(dr["AppNo"].ToString(), DataType.String, "s26");
                                        cell = row.Cells.Add(dr["Name"].ToString(), DataType.String, "s26");

                                        if (SSBGQues.Count == 1) { cell = row.Cells.Add(dr[QuesDesc[0]].ToString(), DataType.String, "s26"); }
                                        if (SSBGQues.Count == 2) { cell = row.Cells.Add(dr[QuesDesc[0]].ToString(), DataType.String, "s26"); cell = row.Cells.Add(dr[QuesDesc[1]].ToString(), DataType.String, "s26"); }
                                        if (SSBGQues.Count == 3) { cell = row.Cells.Add(dr[QuesDesc[0]].ToString(), DataType.String, "s26"); cell = row.Cells.Add(dr[QuesDesc[1]].ToString(), DataType.String, "s26"); cell = row.Cells.Add(dr[QuesDesc[2]].ToString(), DataType.String, "s26"); }
                                        if (SSBGQues.Count == 4) { cell = row.Cells.Add(dr[QuesDesc[0]].ToString(), DataType.String, "s26"); cell = row.Cells.Add(dr[QuesDesc[1]].ToString(), DataType.String, "s26"); cell = row.Cells.Add(dr[QuesDesc[2]].ToString(), DataType.String, "s26"); cell = row.Cells.Add(dr[QuesDesc[3]].ToString(), DataType.String, "s26"); }

                                    }

                                    row = sheet.Table.Rows.Add();
                                    row = sheet.Table.Rows.Add();
                                    row = sheet.Table.Rows.Add();
                                    //row = sheet.Table.Rows.Add();
                                }


                            }
                        }
                    }


                }

            }
        }


        private void GenerateStyles(WorksheetStyleCollection styles)
        {
            // -----------------------------------------------
            //  Default
            // -----------------------------------------------
            WorksheetStyle Default = styles.Add("Default");
            Default.Name = "Normal";
            Default.Font.FontName = "Calibri";
            Default.Font.Size = 11;
            Default.Font.Color = "#000000";
            Default.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  Header
            // -----------------------------------------------
            WorksheetStyle Header = styles.Add("Header");
            Header.Font.Bold = true;
            Header.Font.FontName = "Tahoma";
            Header.Font.Size = 8;
            Header.Font.Color = "#333333";
            //m106944584.Interior.Color = "#D8D8D8";
            //m106944584.Interior.Pattern = StyleInteriorPattern.Solid;
            Header.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            Header.Alignment.Vertical = StyleVerticalAlignment.Center;
            Header.Alignment.WrapText = true;
            Header.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            Header.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            Header.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            Header.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  TypeHeader
            // -----------------------------------------------
            WorksheetStyle TypeHeader = styles.Add("TypeHeader");
            TypeHeader.Font.Bold = true;
            TypeHeader.Font.FontName = "Tahoma";
            TypeHeader.Font.Size = 8;
            TypeHeader.Font.Color = "#333333";
            //TypeHeader.Interior.Color = "#D8D8D8";
            //TypeHeader.Interior.Pattern = StyleInteriorPattern.Solid;
            TypeHeader.Alignment.Vertical = StyleVerticalAlignment.Center;
            TypeHeader.Alignment.WrapText = true;
            TypeHeader.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            TypeHeader.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            TypeHeader.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            TypeHeader.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106945024
            // -----------------------------------------------
            WorksheetStyle m106945024 = styles.Add("m106945024");
            m106945024.Font.FontName = "Tahoma";
            m106945024.Font.Size = 8;
            m106945024.Font.Color = "#000000";
            m106945024.Interior.Color = "#FFFFFF";
            m106945024.Interior.Pattern = StyleInteriorPattern.Solid;
            m106945024.Alignment.Vertical = StyleVerticalAlignment.Top;
            m106945024.Alignment.WrapText = true;
            m106945024.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106945024.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106945024.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106945024.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106945044
            // -----------------------------------------------
            WorksheetStyle m106945044 = styles.Add("m106945044");
            m106945044.Font.FontName = "Tahoma";
            m106945044.Font.Size = 8;
            m106945044.Font.Color = "#333333";
            m106945044.Interior.Color = "#A5A5A5";
            m106945044.Interior.Pattern = StyleInteriorPattern.Solid;
            m106945044.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106945044.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106945044.Alignment.WrapText = true;
            m106945044.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m106945044.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106945044.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106945044.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            m106945044.NumberFormat = "Fixed";
            // -----------------------------------------------
            //  m106945064
            // -----------------------------------------------
            WorksheetStyle m106945064 = styles.Add("m106945064");
            m106945064.Font.FontName = "Tahoma";
            m106945064.Font.Size = 11;
            m106945064.Font.Color = "#0000FF";
            m106945064.Interior.Color = "#A5A5A5";
            m106945064.Interior.Pattern = StyleInteriorPattern.Solid;
            m106945064.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106945064.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106945064.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m106945064.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106945064.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106945064.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            m106945064.NumberFormat = "Fixed";
            // -----------------------------------------------
            //  m106945084
            // -----------------------------------------------
            WorksheetStyle m106945084 = styles.Add("m106945084");
            m106945084.Font.FontName = "Tahoma";
            m106945084.Font.Size = 8;
            m106945084.Font.Color = "#333333";
            m106945084.Interior.Color = "#A5A5A5";
            m106945084.Interior.Pattern = StyleInteriorPattern.Solid;
            m106945084.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106945084.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106945084.Alignment.WrapText = true;
            m106945084.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m106945084.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106945084.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106945084.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            m106945084.NumberFormat = "Fixed";
            // -----------------------------------------------
            //  m106945104
            // -----------------------------------------------
            WorksheetStyle m106945104 = styles.Add("m106945104");
            m106945104.Font.FontName = "Tahoma";
            m106945104.Font.Size = 8;
            m106945104.Font.Color = "#333333";
            m106945104.Interior.Color = "#A5A5A5";
            m106945104.Interior.Pattern = StyleInteriorPattern.Solid;
            m106945104.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106945104.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106945104.Alignment.WrapText = true;
            m106945104.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m106945104.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106945104.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106945104.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            m106945104.NumberFormat = "Fixed";
            // -----------------------------------------------
            //  m106945124
            // -----------------------------------------------
            WorksheetStyle m106945124 = styles.Add("m106945124");
            m106945124.Font.FontName = "Tahoma";
            m106945124.Font.Size = 8;
            m106945124.Font.Color = "#333333";
            m106945124.Interior.Color = "#A5A5A5";
            m106945124.Interior.Pattern = StyleInteriorPattern.Solid;
            m106945124.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106945124.Alignment.WrapText = true;
            m106945124.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106945124.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106945124.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  m106945144
            // -----------------------------------------------
            WorksheetStyle m106945144 = styles.Add("m106945144");
            m106945144.Font.FontName = "Tahoma";
            m106945144.Font.Size = 8;
            m106945144.Font.Color = "#333333";
            m106945144.Interior.Color = "#A5A5A5";
            m106945144.Interior.Pattern = StyleInteriorPattern.Solid;
            m106945144.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106945144.Alignment.WrapText = true;
            m106945144.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m106945144.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106945144.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            m106945144.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  m106945164
            // -----------------------------------------------
            WorksheetStyle m106945164 = styles.Add("m106945164");
            m106945164.Font.FontName = "Tahoma";
            m106945164.Font.Size = 8;
            m106945164.Font.Color = "#333333";
            m106945164.Interior.Color = "#A5A5A5";
            m106945164.Interior.Pattern = StyleInteriorPattern.Solid;
            m106945164.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106945164.Alignment.WrapText = true;
            m106945164.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m106945164.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106945164.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            m106945164.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  m106945184
            // -----------------------------------------------
            WorksheetStyle m106945184 = styles.Add("m106945184");
            m106945184.Font.Bold = true;
            m106945184.Font.FontName = "Tahoma";
            m106945184.Font.Size = 8;
            m106945184.Font.Color = "#333333";
            m106945184.Interior.Color = "#A5A5A5";
            m106945184.Interior.Pattern = StyleInteriorPattern.Solid;
            m106945184.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            m106945184.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106945184.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m106945184.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106945184.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  m106945204
            // -----------------------------------------------
            WorksheetStyle m106945204 = styles.Add("m106945204");
            m106945204.Font.FontName = "Tahoma";
            m106945204.Font.Size = 8;
            m106945204.Font.Color = "#333333";
            m106945204.Interior.Color = "#A5A5A5";
            m106945204.Interior.Pattern = StyleInteriorPattern.Solid;
            m106945204.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106945204.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m106945204.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106945204.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            m106945204.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  m106945224
            // -----------------------------------------------
            WorksheetStyle m106945224 = styles.Add("m106945224");
            m106945224.Font.FontName = "Tahoma";
            m106945224.Font.Size = 8;
            m106945224.Font.Color = "#333333";
            m106945224.Interior.Color = "#A5A5A5";
            m106945224.Interior.Pattern = StyleInteriorPattern.Solid;
            m106945224.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106945224.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m106945224.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106945224.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            m106945224.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  m106944704
            // -----------------------------------------------
            WorksheetStyle m106944704 = styles.Add("m106944704");
            m106944704.Font.FontName = "Tahoma";
            m106944704.Font.Size = 8;
            m106944704.Font.Color = "#333333";
            m106944704.Interior.Color = "#A5A5A5";
            m106944704.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944704.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106944704.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944704.Alignment.WrapText = true;
            m106944704.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m106944704.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944704.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944704.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            m106944704.NumberFormat = "Fixed";
            // -----------------------------------------------
            //  m106944744
            // -----------------------------------------------
            WorksheetStyle m106944744 = styles.Add("m106944744");
            m106944744.Font.Bold = true;
            m106944744.Font.FontName = "Tahoma";
            m106944744.Font.Size = 8;
            m106944744.Font.Color = "#333333";
            m106944744.Interior.Color = "#D9D9D9";
            m106944744.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944744.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106944744.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944744.Alignment.WrapText = true;
            m106944744.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944744.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944744.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944744.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944764
            // -----------------------------------------------
            WorksheetStyle m106944764 = styles.Add("m106944764");
            m106944764.Font.Bold = true;
            m106944764.Font.FontName = "Tahoma";
            m106944764.Font.Size = 8;
            m106944764.Font.Color = "#333333";
            m106944764.Interior.Color = "#D9D9D9";
            m106944764.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944764.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            m106944764.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944764.Alignment.WrapText = true;
            m106944764.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944764.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944764.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944764.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944864
            // -----------------------------------------------
            WorksheetStyle m106944864 = styles.Add("m106944864");
            m106944864.Font.Bold = true;
            m106944864.Font.FontName = "Tahoma";
            m106944864.Font.Size = 8;
            m106944864.Font.Color = "#333333";
            m106944864.Interior.Color = "#A5A5A5";
            m106944864.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944864.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            m106944864.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944864.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m106944864.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944864.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            m106944864.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944884
            // -----------------------------------------------
            WorksheetStyle m106944884 = styles.Add("m106944884");
            m106944884.Font.FontName = "Tahoma";
            m106944884.Font.Size = 8;
            m106944884.Font.Color = "#333333";
            m106944884.Interior.Color = "#A5A5A5";
            m106944884.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944884.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944884.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m106944884.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944884.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            m106944884.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  m106944904
            // -----------------------------------------------
            WorksheetStyle m106944904 = styles.Add("m106944904");
            m106944904.Font.FontName = "Tahoma";
            m106944904.Font.Size = 8;
            m106944904.Font.Color = "#333333";
            m106944904.Interior.Color = "#A5A5A5";
            m106944904.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944904.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944904.Alignment.WrapText = true;
            m106944904.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m106944904.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944904.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            m106944904.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  m106944924
            // -----------------------------------------------
            WorksheetStyle m106944924 = styles.Add("m106944924");
            m106944924.Font.FontName = "Tahoma";
            m106944924.Font.Size = 8;
            m106944924.Font.Color = "#333333";
            m106944924.Interior.Color = "#A5A5A5";
            m106944924.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944924.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944924.Alignment.WrapText = true;
            m106944924.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m106944924.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944924.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            m106944924.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  m106944944
            // -----------------------------------------------
            WorksheetStyle m106944944 = styles.Add("m106944944");
            m106944944.Font.FontName = "Tahoma";
            m106944944.Font.Size = 8;
            m106944944.Font.Color = "#333333";
            m106944944.Interior.Color = "#A5A5A5";
            m106944944.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944944.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944944.Alignment.WrapText = true;
            m106944944.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m106944944.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944944.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            m106944944.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  m95382656
            // -----------------------------------------------
            WorksheetStyle m95382656 = styles.Add("m95382656");
            m95382656.Font.Bold = true;
            m95382656.Font.FontName = "Tahoma";
            m95382656.Font.Color = "#000000";
            m95382656.Interior.Color = "#D8D8D8";
            m95382656.Interior.Pattern = StyleInteriorPattern.Solid;
            m95382656.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m95382656.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            m95382656.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m95382656.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m95382656.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m95382656.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m95382676
            // -----------------------------------------------
            WorksheetStyle m95382676 = styles.Add("m95382676");
            m95382676.Font.FontName = "Tahoma";
            m95382676.Font.Size = 9;
            m95382676.Font.Color = "#000000";
            m95382676.Interior.Color = "#D8D8D8";
            m95382676.Interior.Pattern = StyleInteriorPattern.Solid;
            m95382676.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m95382676.Alignment.Vertical = StyleVerticalAlignment.Center;
            m95382676.Alignment.WrapText = true;
            m95382676.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m95382676.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m95382676.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m95382676.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m95382696
            // -----------------------------------------------
            WorksheetStyle m95382696 = styles.Add("m95382696");
            m95382696.Font.Bold = true;
            m95382696.Font.FontName = "Tahoma";
            m95382696.Font.Size = 8;
            m95382696.Font.Color = "#333333";
            m95382696.Interior.Color = "#A5A5A5";
            m95382696.Interior.Pattern = StyleInteriorPattern.Solid;
            m95382696.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m95382696.Alignment.Vertical = StyleVerticalAlignment.Center;
            m95382696.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m95382696.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m95382696.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m95382696.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            m95382696.NumberFormat = "@";
            // -----------------------------------------------
            //  m95382716
            // -----------------------------------------------
            WorksheetStyle m95382716 = styles.Add("m95382716");
            m95382716.Font.FontName = "Tahoma";
            m95382716.Font.Size = 8;
            m95382716.Font.Color = "#333333";
            m95382716.Interior.Color = "#A5A5A5";
            m95382716.Interior.Pattern = StyleInteriorPattern.Solid;
            m95382716.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m95382716.Alignment.Vertical = StyleVerticalAlignment.Center;
            m95382716.Alignment.WrapText = true;
            m95382716.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m95382716.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m95382716.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m95382716.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            m95382716.NumberFormat = "Fixed";
            // -----------------------------------------------
            //  m95382736
            // -----------------------------------------------
            WorksheetStyle m95382736 = styles.Add("m95382736");
            m95382736.Font.FontName = "Tahoma";
            m95382736.Font.Size = 8;
            m95382736.Font.Color = "#333333";
            m95382736.Interior.Color = "#A5A5A5";
            m95382736.Interior.Pattern = StyleInteriorPattern.Solid;
            m95382736.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m95382736.Alignment.Vertical = StyleVerticalAlignment.Center;
            m95382736.Alignment.WrapText = true;
            m95382736.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            m95382736.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m95382736.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m95382736.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            m95382736.NumberFormat = "Fixed";
            // -----------------------------------------------
            //  m95383076
            // -----------------------------------------------
            WorksheetStyle m95383076 = styles.Add("m95383076");
            m95383076.Font.FontName = "Tahoma";
            m95383076.Font.Size = 9;
            m95383076.Font.Color = "#000000";
            m95383076.Interior.Color = "#D8D8D8";
            m95383076.Interior.Pattern = StyleInteriorPattern.Solid;
            m95383076.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m95383076.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            m95383076.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m95383076.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m95383076.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m95383076.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944384
            // -----------------------------------------------
            WorksheetStyle m106944384 = styles.Add("m106944384");
            m106944384.Font.FontName = "Tahoma";
            m106944384.Font.Size = 9;
            m106944384.Font.Color = "#000000";
            m106944384.Interior.Color = "#FFFFFF";
            m106944384.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944384.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106944384.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            m106944384.Alignment.WrapText = true;
            m106944384.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944384.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944384.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944384.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944424
            // -----------------------------------------------
            WorksheetStyle m106944424 = styles.Add("m106944424");
            m106944424.Font.FontName = "Tahoma";
            m106944424.Font.Size = 9;
            m106944424.Font.Color = "#000000";
            m106944424.Interior.Color = "#D8D8D8";
            m106944424.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944424.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106944424.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            m106944424.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944424.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944424.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944424.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944464
            // -----------------------------------------------
            WorksheetStyle m106944464 = styles.Add("m106944464");
            m106944464.Font.Bold = true;
            m106944464.Font.FontName = "Tahoma";
            m106944464.Font.Size = 8;
            m106944464.Font.Color = "#333333";
            m106944464.Interior.Color = "#D8D8D8";
            m106944464.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944464.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            m106944464.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944464.Alignment.WrapText = true;
            m106944464.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944464.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944464.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944484
            // -----------------------------------------------
            WorksheetStyle m106944484 = styles.Add("m106944484");
            m106944484.Font.Bold = true;
            m106944484.Font.FontName = "Tahoma";
            m106944484.Font.Size = 8;
            m106944484.Font.Color = "#333333";
            m106944484.Interior.Color = "#D8D8D8";
            m106944484.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944484.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            m106944484.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944484.Alignment.WrapText = true;
            m106944484.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944484.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944484.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944504
            // -----------------------------------------------
            WorksheetStyle m106944504 = styles.Add("m106944504");
            m106944504.Font.Bold = true;
            m106944504.Font.FontName = "Tahoma";
            m106944504.Font.Size = 8;
            m106944504.Font.Color = "#333333";
            m106944504.Interior.Color = "#D8D8D8";
            m106944504.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944504.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            m106944504.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944504.Alignment.WrapText = true;
            m106944504.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944504.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944504.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944504.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944524
            // -----------------------------------------------
            WorksheetStyle m106944524 = styles.Add("m106944524");
            m106944524.Font.Bold = true;
            m106944524.Font.FontName = "Tahoma";
            m106944524.Font.Size = 8;
            m106944524.Font.Color = "#333333";
            m106944524.Interior.Color = "#D8D8D8";
            m106944524.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944524.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            m106944524.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944524.Alignment.WrapText = true;
            m106944524.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944524.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944524.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944524.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944544
            // -----------------------------------------------
            WorksheetStyle m106944544 = styles.Add("m106944544");
            m106944544.Font.Bold = true;
            m106944544.Font.FontName = "Tahoma";
            m106944544.Font.Size = 8;
            m106944544.Font.Color = "#333333";
            m106944544.Interior.Color = "#D8D8D8";
            m106944544.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944544.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944544.Alignment.WrapText = true;
            m106944544.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944544.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944544.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944544.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944564
            // -----------------------------------------------
            WorksheetStyle m106944564 = styles.Add("m106944564");
            m106944564.Font.Bold = true;
            m106944564.Font.FontName = "Tahoma";
            m106944564.Font.Size = 8;
            m106944564.Font.Color = "#333333";
            m106944564.Interior.Color = "#D8D8D8";
            m106944564.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944564.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106944564.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944564.Alignment.WrapText = true;
            m106944564.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944564.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944564.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944564.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944584
            // -----------------------------------------------
            WorksheetStyle m106944584 = styles.Add("m106944584");
            m106944584.Font.Bold = true;
            m106944584.Font.FontName = "Tahoma";
            m106944584.Font.Size = 8;
            m106944584.Font.Color = "#333333";
            m106944584.Interior.Color = "#D8D8D8";
            m106944584.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944584.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106944584.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944584.Alignment.WrapText = true;
            m106944584.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944584.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944584.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944584.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944604
            // -----------------------------------------------
            WorksheetStyle m106944604 = styles.Add("m106944604");
            m106944604.Font.Bold = true;
            m106944604.Font.FontName = "Tahoma";
            m106944604.Font.Size = 8;
            m106944604.Font.Color = "#333333";
            m106944604.Interior.Color = "#D8D8D8";
            m106944604.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944604.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            m106944604.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944604.Alignment.WrapText = true;
            m106944604.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944604.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944604.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944604.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944624
            // -----------------------------------------------
            WorksheetStyle m106944624 = styles.Add("m106944624");
            m106944624.Font.Bold = true;
            m106944624.Font.FontName = "Tahoma";
            m106944624.Font.Size = 8;
            m106944624.Font.Color = "#333333";
            m106944624.Interior.Color = "#E0E0E0";
            m106944624.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944624.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106944624.Alignment.Vertical = StyleVerticalAlignment.Center;
            m106944624.Alignment.WrapText = true;
            m106944624.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944624.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944624.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944064
            // -----------------------------------------------
            WorksheetStyle m106944064 = styles.Add("m106944064");
            m106944064.Font.FontName = "Tahoma";
            m106944064.Font.Size = 9;
            m106944064.Font.Color = "#000000";
            m106944064.Interior.Color = "#FFFFFF";
            m106944064.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944064.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106944064.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            m106944064.Alignment.WrapText = true;
            m106944064.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944064.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944064.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944064.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944084
            // -----------------------------------------------
            WorksheetStyle m106944084 = styles.Add("m106944084");
            m106944084.Font.FontName = "Tahoma";
            m106944084.Font.Size = 9;
            m106944084.Font.Color = "#000000";
            m106944084.Interior.Color = "#FFFFFF";
            m106944084.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944084.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106944084.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            m106944084.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944084.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944084.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944084.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            m106944084.NumberFormat = "#,##0";
            // -----------------------------------------------
            //  m106944104
            // -----------------------------------------------
            WorksheetStyle m106944104 = styles.Add("m106944104");
            m106944104.Font.FontName = "Tahoma";
            m106944104.Font.Size = 9;
            m106944104.Font.Color = "#000000";
            m106944104.Interior.Color = "#FFFFFF";
            m106944104.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944104.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106944104.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            m106944104.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944104.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944104.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944104.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            m106944104.NumberFormat = "#,##0";
            // -----------------------------------------------
            //  m106944124
            // -----------------------------------------------
            WorksheetStyle m106944124 = styles.Add("m106944124");
            m106944124.Font.Bold = true;
            m106944124.Font.FontName = "Tahoma";
            m106944124.Font.Color = "#000000";
            m106944124.Interior.Color = "#FFFFFF";
            m106944124.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944124.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            m106944124.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            m106944124.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944124.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944124.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944124.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            m106944124.NumberFormat = "#,##0";
            // -----------------------------------------------
            //  m106944144
            // -----------------------------------------------
            WorksheetStyle m106944144 = styles.Add("m106944144");
            m106944144.Font.FontName = "Tahoma";
            m106944144.Font.Size = 8;
            m106944144.Font.Color = "#333333";
            m106944144.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            m106944144.Alignment.Vertical = StyleVerticalAlignment.Top;
            m106944144.Alignment.WrapText = true;
            m106944144.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944144.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944144.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944144.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944324
            // -----------------------------------------------
            WorksheetStyle m106944324 = styles.Add("m106944324");
            m106944324.Font.FontName = "Tahoma";
            m106944324.Font.Size = 8;
            m106944324.Font.Color = "#000000";
            m106944324.Interior.Color = "#D8D8D8";
            m106944324.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944324.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106944324.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            m106944324.Alignment.WrapText = true;
            m106944324.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944324.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944324.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944324.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944344
            // -----------------------------------------------
            WorksheetStyle m106944344 = styles.Add("m106944344");
            m106944344.Font.FontName = "Tahoma";
            m106944344.Font.Size = 8;
            m106944344.Font.Color = "#000000";
            m106944344.Interior.Color = "#D8D8D8";
            m106944344.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944344.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106944344.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            m106944344.Alignment.WrapText = true;
            m106944344.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944344.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944344.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944344.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m106944364
            // -----------------------------------------------
            WorksheetStyle m106944364 = styles.Add("m106944364");
            m106944364.Font.FontName = "Tahoma";
            m106944364.Font.Size = 9;
            m106944364.Font.Color = "#000000";
            m106944364.Interior.Color = "#FFFFFF";
            m106944364.Interior.Pattern = StyleInteriorPattern.Solid;
            m106944364.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m106944364.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            m106944364.Alignment.WrapText = true;
            m106944364.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m106944364.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m106944364.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m106944364.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m2021335956816
            // -----------------------------------------------
            WorksheetStyle m2021335956816 = styles.Add("m2021335956816");
            m2021335956816.Font.Bold = true;
            m2021335956816.Font.FontName = "Tahoma";
            m2021335956816.Font.Size = 14;
            m2021335956816.Font.Color = "#333333";
            m2021335956816.Interior.Color = "#DDEBF7";
            m2021335956816.Interior.Pattern = StyleInteriorPattern.Solid;
            m2021335956816.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            m2021335956816.Alignment.Vertical = StyleVerticalAlignment.Center;
            m2021335956816.Alignment.WrapText = true;
            m2021335956816.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m2021335956816.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m2021335956816.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m2021335956816.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m2021335956856
            // -----------------------------------------------
            WorksheetStyle m2021335956856 = styles.Add("m2021335956856");
            m2021335956856.Font.Bold = true;
            m2021335956856.Font.FontName = "Tahoma";
            m2021335956856.Font.Size = 8;
            m2021335956856.Font.Color = "#333333";
            m2021335956856.Interior.Color = "#DDEBF7";
            m2021335956856.Interior.Pattern = StyleInteriorPattern.Solid;
            m2021335956856.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            m2021335956856.Alignment.Vertical = StyleVerticalAlignment.Center;
            m2021335956856.Alignment.WrapText = true;
            m2021335956856.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m2021335956856.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m2021335956856.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m2021335956856.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m2021335962548
            // -----------------------------------------------
            WorksheetStyle m2021335962548 = styles.Add("m2021335962548");
            m2021335962548.Font.Bold = true;
            m2021335962548.Font.FontName = "Tahoma";
            m2021335962548.Font.Size = 8;
            m2021335962548.Font.Color = "#333333";
            m2021335962548.Interior.Color = "#DDEBF7";
            m2021335962548.Interior.Pattern = StyleInteriorPattern.Solid;
            m2021335962548.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m2021335962548.Alignment.Vertical = StyleVerticalAlignment.Center;
            m2021335962548.Alignment.WrapText = true;
            m2021335962548.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m2021335962548.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m2021335962548.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m2021335962548.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m2021335962568
            // -----------------------------------------------
            WorksheetStyle m2021335962568 = styles.Add("m2021335962568");
            m2021335962568.Font.FontName = "Tahoma";
            m2021335962568.Font.Size = 8;
            m2021335962568.Font.Color = "#333333";
            m2021335962568.Interior.Color = "#FFFF66";
            m2021335962568.Interior.Pattern = StyleInteriorPattern.Solid;
            m2021335962568.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m2021335962568.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            m2021335962568.Alignment.WrapText = true;
            m2021335962568.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m2021335962568.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m2021335962568.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m2021335962588
            // -----------------------------------------------
            WorksheetStyle m2021335962588 = styles.Add("m2021335962588");
            m2021335962588.Font.FontName = "Tahoma";
            m2021335962588.Font.Size = 8;
            m2021335962588.Font.Color = "#000000";
            m2021335962588.Interior.Color = "#FFFF66";
            m2021335962588.Interior.Pattern = StyleInteriorPattern.Solid;
            m2021335962588.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m2021335962588.Alignment.Vertical = StyleVerticalAlignment.Center;
            m2021335962588.Alignment.WrapText = true;
            m2021335962588.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m2021335962588.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m2021335962588.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m2021335962588.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m2021335962608
            // -----------------------------------------------
            WorksheetStyle m2021335962608 = styles.Add("m2021335962608");
            m2021335962608.Font.FontName = "Tahoma";
            m2021335962608.Font.Size = 8;
            m2021335962608.Font.Color = "#000000";
            m2021335962608.Interior.Color = "#FFFF66";
            m2021335962608.Interior.Pattern = StyleInteriorPattern.Solid;
            m2021335962608.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m2021335962608.Alignment.Vertical = StyleVerticalAlignment.Center;
            m2021335962608.Alignment.WrapText = true;
            m2021335962608.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m2021335962608.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m2021335962608.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m2021335962648
            // -----------------------------------------------
            WorksheetStyle m2021335962648 = styles.Add("m2021335962648");
            m2021335962648.Font.FontName = "Tahoma";
            m2021335962648.Font.Size = 8;
            m2021335962648.Font.Color = "#000000";
            m2021335962648.Interior.Color = "#FFFF66";
            m2021335962648.Interior.Pattern = StyleInteriorPattern.Solid;
            m2021335962648.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m2021335962648.Alignment.Vertical = StyleVerticalAlignment.Center;
            m2021335962648.Alignment.WrapText = true;
            m2021335962648.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m2021335962648.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m2021335962648.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m2021335962648.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m2021335962668
            // -----------------------------------------------
            WorksheetStyle m2021335962668 = styles.Add("m2021335962668");
            m2021335962668.Font.FontName = "Tahoma";
            m2021335962668.Font.Size = 8;
            m2021335962668.Font.Color = "#000000";
            m2021335962668.Interior.Color = "#FFFF66";
            m2021335962668.Interior.Pattern = StyleInteriorPattern.Solid;
            m2021335962668.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m2021335962668.Alignment.Vertical = StyleVerticalAlignment.Center;
            m2021335962668.Alignment.WrapText = true;
            m2021335962668.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m2021335962668.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m2021335962668.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m2021335962668.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m2021335933336
            // -----------------------------------------------
            WorksheetStyle m2021335933336 = styles.Add("m2021335933336");
            m2021335933336.Font.Bold = true;
            m2021335933336.Alignment.WrapText = true;
            m2021335933336.Font.FontName = "Tahoma";
            m2021335933336.Font.Size = 8;
            m2021335933336.Font.Color = "#333333";
            m2021335933336.Interior.Color = "#FFFF66";
            m2021335933336.Interior.Pattern = StyleInteriorPattern.Solid;
            m2021335933336.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m2021335933336.Alignment.Vertical = StyleVerticalAlignment.Center;
            m2021335933336.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m2021335933336.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m2021335933336.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m2021335933336.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m2021335933752
            // -----------------------------------------------
            WorksheetStyle m2021335933752 = styles.Add("m2021335933752");
            m2021335933752.Font.Bold = true;
            m2021335933752.Font.FontName = "Tahoma";
            m2021335933752.Font.Size = 8;
            m2021335933752.Font.Color = "#000000";
            m2021335933752.Interior.Color = "#FFFFFF";
            m2021335933752.Interior.Pattern = StyleInteriorPattern.Solid;
            m2021335933752.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m2021335933752.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            m2021335933752.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m2021335933752.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m2021335933752.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m2021335933752.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            m2021335933752.NumberFormat = "#,##0";
            // -----------------------------------------------
            //  m2021335933356
            // -----------------------------------------------
            WorksheetStyle m2021335933356 = styles.Add("m2021335933356");
            m2021335933356.Font.FontName = "Tahoma";
            m2021335933356.Font.Size = 8;
            m2021335933356.Font.Color = "#333333";
            m2021335933356.Interior.Color = "#FFFFFF";
            m2021335933356.Interior.Pattern = StyleInteriorPattern.Solid;
            m2021335933356.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            m2021335933356.Alignment.Vertical = StyleVerticalAlignment.Center;
            m2021335933356.Alignment.WrapText = true;
            m2021335933356.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m2021335933356.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m2021335933356.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m2021335933356.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);




            // -----------------------------------------------
            //  s16
            // -----------------------------------------------
            WorksheetStyle s16 = styles.Add("s16");
            s16.Font.FontName = "Tahoma";
            s16.Font.Size = 11;
            s16.Font.Color = "#000000";
            // -----------------------------------------------
            //  s17
            // -----------------------------------------------
            WorksheetStyle s17 = styles.Add("s17");
            s17.Font.FontName = "Tahoma";
            s17.Font.Size = 8;
            s17.Font.Color = "#000000";
            s17.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s17.Alignment.WrapText = true;
            // -----------------------------------------------
            //  s18
            // -----------------------------------------------
            WorksheetStyle s18 = styles.Add("s18");
            s18.Font.FontName = "Tahoma";
            s18.Font.Size = 9;
            s18.Font.Color = "#000000";
            s18.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s18.Alignment.WrapText = true;
            // -----------------------------------------------
            //  s19
            // -----------------------------------------------
            WorksheetStyle s19 = styles.Add("s19");
            s19.Font.FontName = "Tahoma";
            s19.Font.Size = 9;
            s19.Font.Color = "#000000";
            // -----------------------------------------------
            //  s20
            // -----------------------------------------------
            WorksheetStyle s20 = styles.Add("s20");
            s20.Font.FontName = "Tahoma";
            s20.Font.Size = 8;
            s20.Font.Color = "#333333";
            s20.Interior.Color = "#FFFFFF";
            s20.Interior.Pattern = StyleInteriorPattern.Solid;
            s20.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s20.Alignment.Vertical = StyleVerticalAlignment.Center;
            s20.Alignment.WrapText = true;
            s20.NumberFormat = "Fixed";
            // -----------------------------------------------
            //  s21
            // -----------------------------------------------
            WorksheetStyle s21 = styles.Add("s21");
            s21.Font.Bold = true;
            s21.Font.FontName = "Tahoma";
            s21.Font.Size = 8;
            s21.Font.Color = "#333333";
            s21.Interior.Color = "#D9D9D9";
            s21.Interior.Pattern = StyleInteriorPattern.Solid;
            s21.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s21.Alignment.Vertical = StyleVerticalAlignment.Center;
            s21.Alignment.WrapText = true;
            s21.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s21.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s21.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s21.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  s22
            // -----------------------------------------------
            WorksheetStyle s22 = styles.Add("s22");
            s22.Font.FontName = "Tahoma";
            s22.Font.Size = 9;
            s22.Font.Color = "#000000";
            s22.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s22.Alignment.Vertical = StyleVerticalAlignment.Center;
            s22.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s22.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s22.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s22.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            s22.NumberFormat = "Fixed";
            // -----------------------------------------------
            //  s23
            // -----------------------------------------------
            WorksheetStyle s23 = styles.Add("s23");
            s23.Font.Bold = true;
            s23.Font.FontName = "Tahoma";
            s23.Font.Color = "#000000";
            s23.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s23.Alignment.Vertical = StyleVerticalAlignment.Center;
            s23.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s23.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s23.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s23.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            s23.NumberFormat = "Fixed";
            // -----------------------------------------------
            //  s24
            // -----------------------------------------------
            WorksheetStyle s24 = styles.Add("s24");
            s24.Font.FontName = "Tahoma";
            s24.Font.Size = 9;
            s24.Font.Color = "#333333";
            s24.Interior.Color = "#FFFFFF";
            s24.Interior.Pattern = StyleInteriorPattern.Solid;
            s24.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s24.Alignment.Vertical = StyleVerticalAlignment.Center;
            s24.Alignment.WrapText = true;
            s24.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s24.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s24.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s24.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  s25
            // -----------------------------------------------
            WorksheetStyle s25 = styles.Add("s25");
            s25.Font.Bold = true;
            s25.Font.FontName = "Tahoma";
            s25.Font.Color = "#333333";
            s25.Interior.Color = "#FFFFFF";
            s25.Interior.Pattern = StyleInteriorPattern.Solid;
            s25.Alignment.Vertical = StyleVerticalAlignment.Center;
            s25.Alignment.WrapText = true;
            s25.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s25.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s25.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s25.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  s26
            // -----------------------------------------------
            WorksheetStyle s26 = styles.Add("s26");
            s26.Font.FontName = "Tahoma";
            s26.Font.Size = 9;
            s26.Font.Color = "#333333";
            s26.Interior.Color = "#FFFFFF";
            s26.Interior.Pattern = StyleInteriorPattern.Solid;
            s26.Alignment.Vertical = StyleVerticalAlignment.Center;
            s26.Alignment.WrapText = true;
            s26.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s26.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s26.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s26.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  s27
            // -----------------------------------------------
            WorksheetStyle s27 = styles.Add("s27");
            s27.Font.FontName = "Tahoma";
            s27.Font.Size = 9;
            s27.Font.Color = "#000000";
            s27.Interior.Color = "#FFFFFF";
            s27.Interior.Pattern = StyleInteriorPattern.Solid;
            s27.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s27.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s27.Alignment.WrapText = true;
            s27.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s27.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s27.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s27.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  s28
            // -----------------------------------------------
            WorksheetStyle s28 = styles.Add("s28");
            s28.Font.Bold = true;
            s28.Font.FontName = "Tahoma";
            s28.Font.Size = 8;
            s28.Font.Color = "#333333";
            s28.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s28.Alignment.Vertical = StyleVerticalAlignment.Center;
            s28.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s28.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s28.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s28.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            s28.NumberFormat = "@";
            // -----------------------------------------------
            //  s29
            // -----------------------------------------------
            WorksheetStyle s29 = styles.Add("s29");
            s29.Font.FontName = "Tahoma";
            s29.Font.Size = 9;
            s29.Font.Color = "#000000";
            s29.Interior.Color = "#FFFFFF";
            s29.Interior.Pattern = StyleInteriorPattern.Solid;
            s29.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s29.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s29.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s29.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s29.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s29.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            s29.NumberFormat = "#,##0";
            // -----------------------------------------------
            //  s30
            // -----------------------------------------------
            WorksheetStyle s30 = styles.Add("s30");
            s30.Font.FontName = "Tahoma";
            s30.Font.Size = 9;
            s30.Font.Color = "#000000";
            s30.Interior.Color = "#FFFFFF";
            s30.Interior.Pattern = StyleInteriorPattern.Solid;
            s30.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s30.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s30.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s30.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s30.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s30.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            s30.NumberFormat = "0%";
            // -----------------------------------------------
            //  s31
            // -----------------------------------------------
            WorksheetStyle s31 = styles.Add("s31");
            s31.Font.Italic = true;
            s31.Font.FontName = "Tahoma";
            s31.Font.Color = "#000000";
            s31.Alignment.Vertical = StyleVerticalAlignment.Center;
            // -----------------------------------------------
            //  s32
            // -----------------------------------------------
            WorksheetStyle s32 = styles.Add("s32");
            s32.Font.Bold = true;
            s32.Font.FontName = "Tahoma";
            s32.Font.Color = "#000000";
            s32.Interior.Color = "#FFFFFF";
            s32.Interior.Pattern = StyleInteriorPattern.Solid;
            s32.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s32.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s32.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s32.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s32.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            s32.NumberFormat = "#,##0";
            // -----------------------------------------------
            //  s33
            // -----------------------------------------------
            WorksheetStyle s33 = styles.Add("s33");
            s33.Font.Bold = true;
            s33.Font.FontName = "Tahoma";
            s33.Font.Color = "#000000";
            s33.Interior.Color = "#FFFFFF";
            s33.Interior.Pattern = StyleInteriorPattern.Solid;
            s33.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s33.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s33.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s33.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s33.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            s33.NumberFormat = "0%";
            // -----------------------------------------------
            //  s34
            // -----------------------------------------------
            WorksheetStyle s34 = styles.Add("s34");
            s34.Font.FontName = "Tahoma";
            s34.Font.Size = 11;
            s34.Font.Color = "#000000";
            // -----------------------------------------------
            //  s35
            // -----------------------------------------------
            WorksheetStyle s35 = styles.Add("s35");
            s35.Font.FontName = "Tahoma";
            s35.Font.Size = 11;
            s35.Font.Color = "#000000";
            s35.NumberFormat = "0%";
            // -----------------------------------------------
            //  s36
            // -----------------------------------------------
            WorksheetStyle s36 = styles.Add("s36");
            s36.Font.FontName = "Tahoma";
            s36.Font.Size = 11;
            s36.Font.Color = "#0000FF";
            s36.NumberFormat = "0%";
            // -----------------------------------------------
            //  s37
            // -----------------------------------------------
            WorksheetStyle s37 = styles.Add("s37");
            s37.Font.FontName = "Tahoma";
            s37.Font.Size = 11;
            s37.Font.Color = "#000000";
            s37.NumberFormat = "0";
            // -----------------------------------------------
            //  s38
            // -----------------------------------------------
            WorksheetStyle s38 = styles.Add("s38");
            s38.Font.FontName = "Tahoma";
            s38.Font.Size = 8;
            s38.Font.Color = "#000000";
            s38.Interior.Color = "#FFFFFF";
            s38.Interior.Pattern = StyleInteriorPattern.Solid;
            s38.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s38.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s38.Alignment.WrapText = true;
            s38.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s38.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s38.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s38.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  s39
            // -----------------------------------------------
            WorksheetStyle s39 = styles.Add("s39");
            s39.Font.FontName = "Tahoma";
            s39.Font.Size = 11;
            s39.Font.Color = "#000000";
            s39.NumberFormat = "Fixed";
            // -----------------------------------------------
            //  s40
            // -----------------------------------------------
            WorksheetStyle s40 = styles.Add("s40");
            s40.Font.FontName = "Tahoma";
            s40.Font.Size = 8;
            s40.Font.Color = "#333333";
            s40.Interior.Color = "#FFFFFF";
            s40.Interior.Pattern = StyleInteriorPattern.Solid;
            s40.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s40.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s40.Alignment.WrapText = true;
            s40.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s40.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s40.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s40.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  s41
            // -----------------------------------------------
            WorksheetStyle s41 = styles.Add("s41");
            s41.Font.Bold = true;
            s41.Font.FontName = "Tahoma";
            s41.Font.Size = 8;
            s41.Font.Color = "#333333";
            s41.Interior.Color = "#A5A5A5";
            s41.Interior.Pattern = StyleInteriorPattern.Solid;
            s41.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s41.Alignment.Vertical = StyleVerticalAlignment.Center;
            s41.Alignment.WrapText = true;
            s41.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s41.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s41.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s42
            // -----------------------------------------------
            WorksheetStyle s42 = styles.Add("s42");
            s42.Font.Bold = true;
            s42.Font.FontName = "Tahoma";
            s42.Font.Size = 8;
            s42.Font.Color = "#333333";
            s42.Interior.Color = "#A5A5A5";
            s42.Interior.Pattern = StyleInteriorPattern.Solid;
            s42.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s42.Alignment.Vertical = StyleVerticalAlignment.Center;
            s42.Alignment.WrapText = true;
            s42.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s42.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s43
            // -----------------------------------------------
            WorksheetStyle s43 = styles.Add("s43");
            s43.Font.Bold = true;
            s43.Font.FontName = "Tahoma";
            s43.Font.Size = 8;
            s43.Font.Color = "#333333";
            s43.Interior.Color = "#A5A5A5";
            s43.Interior.Pattern = StyleInteriorPattern.Solid;
            s43.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s43.Alignment.Vertical = StyleVerticalAlignment.Center;
            s43.Alignment.WrapText = true;
            s43.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s43.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s43.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            s43.NumberFormat = "0";
            // -----------------------------------------------
            //  s44
            // -----------------------------------------------
            WorksheetStyle s44 = styles.Add("s44");
            s44.Font.FontName = "Tahoma";
            s44.Font.Color = "#000000";
            s44.Interior.Color = "#A5A5A5";
            s44.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s44.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s44.Interior.Pattern = StyleInteriorPattern.Solid;
            s44.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s44.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s44.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s44.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s45
            // -----------------------------------------------
            WorksheetStyle s45 = styles.Add("s45");
            s45.Font.FontName = "Tahoma";
            s45.Font.Color = "#000000";
            s45.Interior.Color = "#A5A5A5";
            s45.Interior.Pattern = StyleInteriorPattern.Solid;
            s45.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s45.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s45.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s46
            // -----------------------------------------------
            WorksheetStyle s46 = styles.Add("s46");
            s46.Font.FontName = "Tahoma";
            s46.Font.Color = "#0000FF";
            s46.Interior.Color = "#A5A5A5";
            s46.Interior.Pattern = StyleInteriorPattern.Solid;
            s46.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s46.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s46.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            s46.NumberFormat = "0%";
            // -----------------------------------------------
            //  s47
            // -----------------------------------------------
            WorksheetStyle s47 = styles.Add("s47");
            s47.Font.FontName = "Tahoma";
            s47.Font.Size = 8;
            s47.Font.Color = "#333333";
            s47.Interior.Color = "#A5A5A5";
            s47.Interior.Pattern = StyleInteriorPattern.Solid;
            s47.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s47.Alignment.Vertical = StyleVerticalAlignment.Center;
            s47.Alignment.WrapText = true;
            s47.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s47.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s47.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            s47.NumberFormat = "Fixed";
            // -----------------------------------------------
            //  s48
            // -----------------------------------------------
            WorksheetStyle s48 = styles.Add("s48");
            s48.Font.FontName = "Tahoma";
            s48.Font.Size = 8;
            s48.Font.Color = "#333333";
            s48.Interior.Color = "#A5A5A5";
            s48.Interior.Pattern = StyleInteriorPattern.Solid;
            s48.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s48.Alignment.Vertical = StyleVerticalAlignment.Center;
            s48.Alignment.WrapText = true;
            s48.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s48.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s48.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            s48.NumberFormat = "Fixed";
            // -----------------------------------------------
            //  s80
            // -----------------------------------------------
            WorksheetStyle s80 = styles.Add("s80");
            s80.Font.FontName = "Tahoma";
            s80.Font.Color = "#000000";
            s80.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s80.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s80.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s80.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s80.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s80.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  s81
            // -----------------------------------------------
            WorksheetStyle s81 = styles.Add("s81");
            s81.Font.FontName = "Tahoma";
            s81.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s81.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s81.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s81.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s81.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s81.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  s82
            // -----------------------------------------------
            WorksheetStyle s82 = styles.Add("s82");
            s82.Font.FontName = "Tahoma";
            s82.Font.Color = "#0000FF";
            s82.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s82.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s82.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s82.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s82.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s82.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            s82.NumberFormat = "0%";

            // -----------------------------------------------
            //  s166
            // -----------------------------------------------
            WorksheetStyle s166 = styles.Add("s166");
            s166.Font.FontName = "Tahoma";
            s166.Font.Size = 9;
            s166.Font.Color = "#000000";
            s166.Interior.Color = "#FFFFFF";
            s166.Interior.Pattern = StyleInteriorPattern.Solid;
            s166.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s166.Alignment.WrapText = true;
            s166.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s166.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s166.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s166.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            s166.NumberFormat = "#,##0";
            // -----------------------------------------------
            //  s181
            // -----------------------------------------------
            WorksheetStyle s181 = styles.Add("s181");
            s181.Font.Bold = true;
            s181.Font.FontName = "Tahoma";
            s181.Font.Size = 8;
            s181.Font.Color = "#333333";
            s181.Interior.Color = "#D9D9D9";
            s181.Interior.Pattern = StyleInteriorPattern.Solid;
            s181.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s181.Alignment.Vertical = StyleVerticalAlignment.Center;
            s181.Alignment.WrapText = true;
            s181.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s181.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s181.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
        }

        private void GenerateWorksheetJune2016(WorksheetCollection sheets)
        {
            Worksheet sheet = sheets.Add("June2016");
            sheet.Names.Add(new WorksheetNamedRange("Print_Area", "=\'June 2016\'!R1C1:R24C22", false));
            sheet.Names.Add(new WorksheetNamedRange("Print_Titles", "=\'June 2016\'!R1", false));
            sheet.Table.DefaultRowHeight = 14.25F;
            sheet.Table.ExpandedColumnCount = 31;
            sheet.Table.ExpandedRowCount = 37;
            sheet.Table.FullColumns = 1;
            sheet.Table.FullRows = 1;
            sheet.Table.StyleID = "s16";
            WorksheetColumn column0 = sheet.Table.Columns.Add();
            column0.Width = 88;
            column0.StyleID = "s16";
            WorksheetColumn column1 = sheet.Table.Columns.Add();
            column1.Width = 36;
            column1.StyleID = "s16";
            WorksheetColumn column2 = sheet.Table.Columns.Add();
            column2.Width = 55;
            column2.StyleID = "s16";
            WorksheetColumn column3 = sheet.Table.Columns.Add();
            column3.Width = 60;
            column3.StyleID = "s16";
            WorksheetColumn column4 = sheet.Table.Columns.Add();
            column4.Width = 36;
            column4.StyleID = "s16";
            WorksheetColumn column5 = sheet.Table.Columns.Add();
            column5.Width = 0;
            column5.StyleID = "s16";
            WorksheetColumn column6 = sheet.Table.Columns.Add();
            column6.Width = 49;
            column6.StyleID = "s16";
            WorksheetColumn column7 = sheet.Table.Columns.Add();
            column7.Width = 60;
            column7.StyleID = "s16";
            WorksheetColumn column8 = sheet.Table.Columns.Add();
            column8.Width = 62;
            column8.StyleID = "s16";
            WorksheetColumn column9 = sheet.Table.Columns.Add();
            column9.Width = 33;
            column9.StyleID = "s16";
            WorksheetColumn column10 = sheet.Table.Columns.Add();
            column10.Width = 34;
            column10.StyleID = "s16";
            WorksheetColumn column11 = sheet.Table.Columns.Add();
            column11.Width = 29;
            column11.StyleID = "s16";
            WorksheetColumn column12 = sheet.Table.Columns.Add();
            column12.Width = 32;
            column12.StyleID = "s16";
            WorksheetColumn column13 = sheet.Table.Columns.Add();
            column13.Width = 33;
            column13.StyleID = "s16";
            WorksheetColumn column14 = sheet.Table.Columns.Add();
            column14.Width = 37;
            column14.StyleID = "s16";
            WorksheetColumn column15 = sheet.Table.Columns.Add();
            column15.Width = 39;
            column15.StyleID = "s16";
            WorksheetColumn column16 = sheet.Table.Columns.Add();
            column16.Width = 43;
            column16.StyleID = "s16";
            WorksheetColumn column17 = sheet.Table.Columns.Add();
            column17.Width = 49;
            column17.StyleID = "s16";
            column17.Span = 1;
            WorksheetColumn column18 = sheet.Table.Columns.Add();
            column18.Index = 20;
            column18.Width = 42;
            column18.StyleID = "s16";
            WorksheetColumn column19 = sheet.Table.Columns.Add();
            column19.Width = 77;
            column19.StyleID = "s16";
            WorksheetColumn column20 = sheet.Table.Columns.Add();
            column20.Width = 47;
            column20.StyleID = "s16";
            WorksheetColumn column21 = sheet.Table.Columns.Add();
            column21.Index = 24;
            column21.Width = 60;
            column21.StyleID = "s16";
            // -----------------------------------------------
            WorksheetRow Row0 = sheet.Table.Rows.Add();
            Row0.Height = 47;
            Row0.AutoFitHeight = false;
            WorksheetCell cell;
            cell = Row0.Cells.Add();
            cell.StyleID = "m106944544";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Social Services Block Grant (SSBG) Case Management         ";
            cell.MergeAcross = 5;
            cell.NamedCell.Add("Print_Titles");
            cell.NamedCell.Add("Print_Area");
            cell = Row0.Cells.Add();
            cell.StyleID = "m106944584";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Reporting Period: 01 June 2016 -June 30 2016  (1 Month)";
            cell.MergeAcross = 5;
            cell.NamedCell.Add("Print_Titles");
            cell.NamedCell.Add("Print_Area");
            cell = Row0.Cells.Add();
            cell.StyleID = "m106944524";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "2016 Budget: $119,695";
            cell.MergeAcross = 3;
            cell.NamedCell.Add("Print_Titles");
            cell.NamedCell.Add("Print_Area");
            cell = Row0.Cells.Add();
            cell.StyleID = "m106944464";
            cell.MergeAcross = 5;
            cell.NamedCell.Add("Print_Titles");
            cell.NamedCell.Add("Print_Area");
            // -----------------------------------------------
            WorksheetRow Row1 = sheet.Table.Rows.Add();
            Row1.Height = 22;
            Row1.AutoFitHeight = false;
            cell = Row1.Cells.Add();
            cell.StyleID = "m106944504";
            cell.Data.Type = DataType.String;
            cell.MergeAcross = 5;
            cell.NamedCell.Add("Print_Area");
            cell = Row1.Cells.Add();
            cell.StyleID = "m106944564";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Grant Period: 01 April 2016  30 September  2018  (30 Months)";
            cell.MergeAcross = 5;
            cell.NamedCell.Add("Print_Area");
            cell = Row1.Cells.Add();
            cell.StyleID = "m106944604";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Total Grant Award:  $422,561";
            cell.MergeAcross = 3;
            cell.NamedCell.Add("Print_Area");
            cell = Row1.Cells.Add();
            cell.StyleID = "m106944484";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Date of Reporting: ";
            cell.MergeAcross = 5;
            cell.NamedCell.Add("Print_Area");
            // -----------------------------------------------
            WorksheetRow Row2 = sheet.Table.Rows.Add();
            Row2.Height = 12;
            Row2.AutoFitHeight = false;
            cell = Row2.Cells.Add();
            cell.StyleID = "m106944144";
            cell.Data.Type = DataType.String;
            cell.Data.Text = @"Program Description:  SSBG Individuals: Service intervention and case management for single individuals with incomes that fall at or below 150% of the federal poverty level. SSBG/TANF Families: indivduals/families with income at or below 200% of the federal poverty level with one child under the age of 18 in their household.";
            cell.MergeAcross = 21;
            cell.MergeDown = 1;
            cell.NamedCell.Add("Print_Area");
            // -----------------------------------------------
            WorksheetRow Row3 = sheet.Table.Rows.Add();
            Row3.Height = 9;
            Row3.AutoFitHeight = false;
            // -----------------------------------------------
            WorksheetRow Row4 = sheet.Table.Rows.Add();
            Row4.Height = 15;
            cell = Row4.Cells.Add();
            cell.StyleID = "m106944624";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Program Utilization - N = 780";
            cell.MergeAcross = 21;
            cell.NamedCell.Add("Print_Area");
            // -----------------------------------------------
            WorksheetRow Row5 = sheet.Table.Rows.Add();
            Row5.Height = 21;
            cell = Row5.Cells.Add();
            cell.StyleID = "s40";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Type";
            cell.NamedCell.Add("Print_Area");
            cell = Row5.Cells.Add();
            cell.StyleID = "s38";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Yearly Contract Obligation";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row5.Cells.Add();
            cell.StyleID = "s38";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "# Served Current Month";
            cell.NamedCell.Add("Print_Area");
            cell = Row5.Cells.Add();
            cell.StyleID = "s38";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "# Served Year to Date";
            cell.MergeAcross = 2;
            cell.NamedCell.Add("Print_Area");
            cell = Row5.Cells.Add();
            cell.StyleID = "s38";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "% Served to Date";
            cell.NamedCell.Add("Print_Area");
            cell = Row5.Cells.Add();
            cell.StyleID = "s21";
            cell.Data.Type = DataType.String;
            cell.Data.Text = " Obligation Outcomes";
            cell.NamedCell.Add("Print_Area");
            cell = Row5.Cells.Add();
            cell.StyleID = "m106944324";
            cell.MergeAcross = 2;
            cell.NamedCell.Add("Print_Area");
            cell = Row5.Cells.Add();
            cell.StyleID = "s38";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "# of Service Interventions";
            cell.MergeAcross = 3;
            cell.NamedCell.Add("Print_Area");
            cell = Row5.Cells.Add();
            cell.StyleID = "s38";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Unduplicated Number of Customers Engaged in Case Management";
            cell.MergeAcross = 5;
            cell.NamedCell.Add("Print_Area");
            cell = Row5.Cells.Add();
            cell.StyleID = "s18";
            cell = Row5.Cells.Add();
            cell.StyleID = "s18";
            // -----------------------------------------------
            WorksheetRow Row6 = sheet.Table.Rows.Add();
            Row6.Height = 22;
            Row6.AutoFitHeight = false;
            cell = Row6.Cells.Add();
            cell.StyleID = "s24";
            cell.NamedCell.Add("Print_Area");
            cell = Row6.Cells.Add();
            cell.StyleID = "m106944364";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row6.Cells.Add();
            cell.StyleID = "s27";
            cell.NamedCell.Add("Print_Area");
            cell = Row6.Cells.Add();
            cell.StyleID = "m106944384";
            cell.MergeAcross = 2;
            cell.NamedCell.Add("Print_Area");
            cell = Row6.Cells.Add();
            cell.StyleID = "s27";
            cell.NamedCell.Add("Print_Area");
            cell = Row6.Cells.Add();
            cell.StyleID = "s28";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "= YES";
            cell.NamedCell.Add("Print_Area");
            cell = Row6.Cells.Add();
            cell.StyleID = "m106944344";
            cell.MergeAcross = 2;
            cell.NamedCell.Add("Print_Area");
            cell = Row6.Cells.Add();
            cell.StyleID = "s27";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Current Month";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row6.Cells.Add();
            cell.StyleID = "s27";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Year to Date";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row6.Cells.Add();
            cell.StyleID = "m106944064";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Current Month";
            cell.MergeAcross = 2;
            cell.NamedCell.Add("Print_Area");
            cell = Row6.Cells.Add();
            cell.StyleID = "s27";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Year to Date";
            cell.MergeAcross = 2;
            cell.NamedCell.Add("Print_Area");
            cell = Row6.Cells.Add();
            cell.StyleID = "s18";
            cell = Row6.Cells.Add();
            cell.StyleID = "s18";
            // -----------------------------------------------
            WorksheetRow Row7 = sheet.Table.Rows.Add();
            Row7.Height = 22;
            Row7.AutoFitHeight = false;
            cell = Row7.Cells.Add();
            cell.StyleID = "s26";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "SSBG Individuals";
            cell.NamedCell.Add("Print_Area");
            cell = Row7.Cells.Add();
            cell.StyleID = "s29";
            cell.Data.Type = DataType.Number;
            cell.Data.Text = "558";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row7.Cells.Add();
            cell.StyleID = "s29";
            cell.NamedCell.Add("Print_Area");
            cell = Row7.Cells.Add();
            cell.StyleID = "s29";
            cell.MergeAcross = 2;
            cell.NamedCell.Add("Print_Area");
            cell = Row7.Cells.Add();
            cell.StyleID = "s30";
            cell.Data.Type = DataType.Number;
            cell.Data.Text = "0";
            cell.Formula = "=+RC[-3]/RC[-6]";
            cell.NamedCell.Add("Print_Area");
            cell = Row7.Cells.Add();
            cell.StyleID = "s22";
            cell.Data.Type = DataType.Number;
            cell.Data.Text = "0";
            cell.Formula = "=RC[-1]";
            cell.NamedCell.Add("Print_Area");
            cell = Row7.Cells.Add();
            cell.StyleID = "m106944424";
            cell.MergeAcross = 2;
            cell.NamedCell.Add("Print_Area");
            cell = Row7.Cells.Add();
            cell.StyleID = "s29";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row7.Cells.Add();
            cell.StyleID = "s29";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row7.Cells.Add();
            cell.StyleID = "m106944084";
            cell.MergeAcross = 2;
            cell.NamedCell.Add("Print_Area");
            cell = Row7.Cells.Add();
            cell.StyleID = "s166";
            cell.MergeAcross = 2;
            cell.NamedCell.Add("Print_Area");
            cell = Row7.Cells.Add();
            cell.StyleID = "s31";
            cell.Index = 24;
            // -----------------------------------------------
            WorksheetRow Row8 = sheet.Table.Rows.Add();
            Row8.Height = 22;
            Row8.AutoFitHeight = false;
            cell = Row8.Cells.Add();
            cell.StyleID = "s26";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "SSBG/TANF Families";
            cell.NamedCell.Add("Print_Area");
            cell = Row8.Cells.Add();
            cell.StyleID = "s29";
            cell.Data.Type = DataType.Number;
            cell.Data.Text = "222";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row8.Cells.Add();
            cell.StyleID = "s29";
            cell.NamedCell.Add("Print_Area");
            cell = Row8.Cells.Add();
            cell.StyleID = "s29";
            cell.MergeAcross = 2;
            cell.NamedCell.Add("Print_Area");
            cell = Row8.Cells.Add();
            cell.StyleID = "s30";
            cell.Data.Type = DataType.Number;
            cell.Data.Text = "0";
            cell.Formula = "=+RC[-3]/RC[-6]";
            cell.NamedCell.Add("Print_Area");
            cell = Row8.Cells.Add();
            cell.StyleID = "s22";
            cell.Data.Type = DataType.Number;
            cell.Data.Text = "0";
            cell.Formula = "=RC[-1]";
            cell.NamedCell.Add("Print_Area");
            cell = Row8.Cells.Add();
            cell.StyleID = "m95383076";
            cell.MergeAcross = 2;
            cell.NamedCell.Add("Print_Area");
            cell = Row8.Cells.Add();
            cell.StyleID = "s29";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row8.Cells.Add();
            cell.StyleID = "s29";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row8.Cells.Add();
            cell.StyleID = "m106944104";
            cell.MergeAcross = 2;
            cell.NamedCell.Add("Print_Area");
            cell = Row8.Cells.Add();
            cell.StyleID = "s166";
            cell.MergeAcross = 2;
            cell.NamedCell.Add("Print_Area");
            cell = Row8.Cells.Add();
            cell.StyleID = "s31";
            cell.Index = 24;
            // -----------------------------------------------
            WorksheetRow Row9 = sheet.Table.Rows.Add();
            Row9.Height = 22;
            Row9.AutoFitHeight = false;
            cell = Row9.Cells.Add();
            cell.StyleID = "s25";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Total:";
            cell.NamedCell.Add("Print_Area");
            cell = Row9.Cells.Add();
            cell.StyleID = "s32";
            cell.Data.Type = DataType.Number;
            cell.Data.Text = "780";
            cell.MergeAcross = 1;
            cell.Formula = "=SUM(R[-2]C:R[-1]C[1])";
            cell.NamedCell.Add("Print_Area");
            cell = Row9.Cells.Add();
            cell.StyleID = "s32";
            cell.Data.Type = DataType.Number;
            cell.Data.Text = "0";
            cell.Formula = "=SUM(R[-2]C:R[-1]C)";
            cell.NamedCell.Add("Print_Area");
            cell = Row9.Cells.Add();
            cell.StyleID = "s32";
            cell.Data.Type = DataType.Number;
            cell.Data.Text = "0";
            cell.MergeAcross = 2;
            cell.Formula = "=SUM(R[-2]C:R[-1]C[2])";
            cell.NamedCell.Add("Print_Area");
            cell = Row9.Cells.Add();
            cell.StyleID = "s33";
            cell.Data.Type = DataType.Number;
            cell.Data.Text = "0";
            cell.Formula = "=+RC[-3]/RC[-6]";
            cell.NamedCell.Add("Print_Area");
            cell = Row9.Cells.Add();
            cell.StyleID = "s23";
            cell.Data.Type = DataType.Number;
            cell.Data.Text = "0";
            cell.Formula = "=RC[-1]";
            cell.NamedCell.Add("Print_Area");
            cell = Row9.Cells.Add();
            cell.StyleID = "m95382656";
            cell.MergeAcross = 2;
            cell.NamedCell.Add("Print_Area");
            cell = Row9.Cells.Add();
            cell.StyleID = "s32";
            cell.Data.Type = DataType.Number;
            cell.Data.Text = "0";
            cell.MergeAcross = 1;
            cell.Formula = "=SUM(R[-2]C:R[-1]C[1])";
            cell.NamedCell.Add("Print_Area");
            cell = Row9.Cells.Add();
            cell.StyleID = "s32";
            cell.Data.Type = DataType.Number;
            cell.Data.Text = "0";
            cell.MergeAcross = 1;
            cell.Formula = "=SUM(R[-2]C:R[-1]C)";
            cell.NamedCell.Add("Print_Area");
            cell = Row9.Cells.Add();
            cell.StyleID = "m106944124";
            cell.Data.Type = DataType.Number;
            cell.Data.Text = "0";
            cell.MergeAcross = 2;
            cell.Formula = "=SUM(R[-2]C:R[-1]C)";
            cell.NamedCell.Add("Print_Area");
            cell = Row9.Cells.Add();
            cell.StyleID = "s32";
            cell.Data.Type = DataType.Number;
            cell.Data.Text = "0";
            cell.MergeAcross = 2;
            cell.Formula = "=SUM(R[-2]C:R[-1]C)";
            cell.NamedCell.Add("Print_Area");
            cell = Row9.Cells.Add();
            cell.StyleID = "s31";
            cell.Index = 24;
            // -----------------------------------------------
            WorksheetRow Row10 = sheet.Table.Rows.Add();
            Row10.Height = 22;
            Row10.AutoFitHeight = false;
            cell = Row10.Cells.Add();
            cell.StyleID = "m106944764";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Contractual/Funder Requirements Contractual/Funder Requirements as Outlined in Co" +
                "ntract , as of 1 April 2016 for period covering 01June - 30 June 2016.";
            cell.MergeAcross = 19;
            cell.NamedCell.Add("Print_Area");
            cell = Row10.Cells.Add();
            cell.StyleID = "m95382676";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Have we reached the funder goal ?";
            cell.MergeAcross = 1;
            cell.MergeDown = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row10.Cells.Add();
            cell.StyleID = "s31";
            cell.Index = 24;
            // -----------------------------------------------
            WorksheetRow Row11 = sheet.Table.Rows.Add();
            Row11.Height = 22;
            Row11.AutoFitHeight = false;
            cell = Row11.Cells.Add();
            cell.StyleID = "m106944744";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Goals - only required in quarterly reports (please use the quarterly report form)" +
                "";
            cell.MergeAcross = 15;
            cell.NamedCell.Add("Print_Area");
            cell = Row11.Cells.Add();
            cell.StyleID = "s181";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "01 June 2016 - 30 June 2016";
            cell.MergeAcross = 3;
            cell.NamedCell.Add("Print_Area");
            cell = Row11.Cells.Add();
            cell.StyleID = "s31";
            cell.Index = 24;
            // -----------------------------------------------
            WorksheetRow Row12 = sheet.Table.Rows.Add();
            Row12.Height = 27;
            Row12.AutoFitHeight = false;
            cell = Row12.Cells.Add();
            cell.StyleID = "m106944864";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Goal 1: 1. Clients have basic needs satisfied to sustain adequate life-functions." +
                "";
            cell.MergeAcross = 15;
            cell.NamedCell.Add("Print_Area");
            cell = Row12.Cells.Add();
            cell.StyleID = "s41";
            cell.Data.Type = DataType.String;
            cell.Data.Text = " # Seeking Service";
            cell.NamedCell.Add("Print_Area");
            cell = Row12.Cells.Add();
            cell.StyleID = "s41";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "# Accessed Service";
            cell.NamedCell.Add("Print_Area");
            cell = Row12.Cells.Add();
            cell.StyleID = "s42";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "# Year to Date";
            cell.NamedCell.Add("Print_Area");
            cell = Row12.Cells.Add();
            cell.StyleID = "s43";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Year to Date %";
            cell.NamedCell.Add("Print_Area");
            cell = Row12.Cells.Add();
            cell.StyleID = "m95382696";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "= YES";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row12.Cells.Add();
            cell.StyleID = "s31";
            cell.Index = 24;
            // -----------------------------------------------
            WorksheetRow Row13 = sheet.Table.Rows.Add();
            Row13.Height = 22;
            Row13.AutoFitHeight = false;
            cell = Row13.Cells.Add();
            cell.StyleID = "m106944884";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Objective 1: At least 65% of the clients seeking housing assistance in the Progra" +
                "m have obtained housing or maintained existing housing, annually.";
            cell.MergeAcross = 15;
            cell.NamedCell.Add("Print_Area");
            cell = Row13.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row13.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row13.Cells.Add();
            cell.StyleID = "s45";
            cell.NamedCell.Add("Print_Area");
            cell = Row13.Cells.Add();
            cell.StyleID = "s46";
            cell.Data.Type = DataType.Error;
            cell.Data.Text = "#DIV/0!";
            cell.Formula = "=+RC[-2]/RC[-3]";
            cell.NamedCell.Add("Print_Area");
            cell = Row13.Cells.Add();
            cell.StyleID = "m95382716";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row13.Cells.Add();
            cell.StyleID = "s31";
            cell.Index = 24;
            cell = Row13.Cells.Add();
            cell.StyleID = "s34";
            // -----------------------------------------------
            WorksheetRow Row14 = sheet.Table.Rows.Add();
            Row14.Height = 22;
            Row14.AutoFitHeight = false;
            cell = Row14.Cells.Add();
            cell.StyleID = "m106944904";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Objective 2: At least 85% of the clients seeking basic needs assistance in the Pr" +
                "ogram have successfully obtained food, clothing, fuel assistance, shelter and ot" +
                "her basic needs, annually.";
            cell.MergeAcross = 15;
            cell.NamedCell.Add("Print_Area");
            cell = Row14.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row14.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row14.Cells.Add();
            cell.StyleID = "s45";
            cell.NamedCell.Add("Print_Area");
            cell = Row14.Cells.Add();
            cell.StyleID = "s46";
            cell.Data.Type = DataType.Error;
            cell.Data.Text = "#DIV/0!";
            cell.Formula = "=+RC[-2]/RC[-3]";
            cell.NamedCell.Add("Print_Area");
            cell = Row14.Cells.Add();
            cell.StyleID = "m95382736";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row14.Cells.Add();
            cell.StyleID = "s31";
            cell.Index = 24;
            // -----------------------------------------------
            WorksheetRow Row15 = sheet.Table.Rows.Add();
            Row15.Height = 22;
            Row15.AutoFitHeight = false;
            cell = Row15.Cells.Add();
            cell.StyleID = "m106944924";
            cell.Data.Type = DataType.String;
            cell.Data.Text = @"Objective 3: At least 50 % of the clients seeking treatment in the Program participated in appropriate treatment plans to improve their overall life-functions or to resolve personal conflicts (e.g. family and/or individual problem, mental health, substance abuse, disability, etc.), annually.";
            cell.MergeAcross = 15;
            cell.NamedCell.Add("Print_Area");
            cell = Row15.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row15.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row15.Cells.Add();
            cell.StyleID = "s45";
            cell.NamedCell.Add("Print_Area");
            cell = Row15.Cells.Add();
            cell.StyleID = "s46";
            cell.Data.Type = DataType.Error;
            cell.Data.Text = "#DIV/0!";
            cell.Formula = "=+RC[-2]/RC[-3]";
            cell.NamedCell.Add("Print_Area");
            cell = Row15.Cells.Add();
            cell.StyleID = "s47";
            cell.NamedCell.Add("Print_Area");
            cell = Row15.Cells.Add();
            cell.StyleID = "s48";
            cell.NamedCell.Add("Print_Area");
            cell = Row15.Cells.Add();
            cell.StyleID = "s35";
            cell = Row15.Cells.Add();
            cell.StyleID = "s31";
            cell = Row15.Cells.Add();
            cell.StyleID = "s34";
            cell = Row15.Cells.Add();
            cell.StyleID = "s36";
            cell = Row15.Cells.Add();
            cell.StyleID = "s20";
            cell = Row15.Cells.Add();
            cell.StyleID = "s35";
            cell.Index = 31;
            // -----------------------------------------------
            WorksheetRow Row16 = sheet.Table.Rows.Add();
            Row16.Height = 22;
            Row16.AutoFitHeight = false;
            cell = Row16.Cells.Add();
            cell.StyleID = "m106944944";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Objective 4: At least 80% of the clients seeking public assistance in the Program" +
                " who are deemed eligible for public assistance benefits (cash, medical or both) " +
                "received eligible benefits, annually.";
            cell.MergeAcross = 15;
            cell.NamedCell.Add("Print_Area");
            cell = Row16.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row16.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row16.Cells.Add();
            cell.StyleID = "s45";
            cell.NamedCell.Add("Print_Area");
            cell = Row16.Cells.Add();
            cell.StyleID = "s46";
            cell.Data.Type = DataType.Error;
            cell.Data.Text = "#DIV/0!";
            cell.Formula = "=+RC[-2]/RC[-3]";
            cell.NamedCell.Add("Print_Area");
            cell = Row16.Cells.Add();
            cell.StyleID = "m106944704";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row16.Cells.Add();
            cell.StyleID = "s35";
            cell = Row16.Cells.Add();
            cell.StyleID = "s31";
            cell = Row16.Cells.Add();
            cell.StyleID = "s37";
            cell = Row16.Cells.Add();
            cell.StyleID = "s37";
            cell = Row16.Cells.Add();
            cell.StyleID = "s35";
            cell = Row16.Cells.Add();
            cell.StyleID = "s35";
            cell.Index = 31;
            // -----------------------------------------------
            WorksheetRow Row17 = sheet.Table.Rows.Add();
            Row17.Height = 22;
            Row17.AutoFitHeight = false;
            cell = Row17.Cells.Add();
            cell.StyleID = "m106945164";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Objective 5: At least 70% of the clients in the Program seeking and in need of me" +
                "dical services were referred and subsequently received appropriate medical care," +
                " annually.";
            cell.MergeAcross = 15;
            cell.NamedCell.Add("Print_Area");
            cell = Row17.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row17.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row17.Cells.Add();
            cell.StyleID = "s45";
            cell.NamedCell.Add("Print_Area");
            cell = Row17.Cells.Add();
            cell.StyleID = "s46";
            cell.Data.Type = DataType.Error;
            cell.Data.Text = "#DIV/0!";
            cell.Formula = "=+RC[-2]/RC[-3]";
            cell.NamedCell.Add("Print_Area");
            cell = Row17.Cells.Add();
            cell.StyleID = "m106945044";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row17.Cells.Add();
            cell.StyleID = "s35";
            cell = Row17.Cells.Add();
            cell.StyleID = "s31";
            cell = Row17.Cells.Add();
            cell.StyleID = "s37";
            cell = Row17.Cells.Add();
            cell.StyleID = "s37";
            cell = Row17.Cells.Add();
            cell.StyleID = "s35";
            cell = Row17.Cells.Add();
            cell.StyleID = "s35";
            cell.Index = 31;
            // -----------------------------------------------
            WorksheetRow Row18 = sheet.Table.Rows.Add();
            Row18.Height = 22;
            Row18.AutoFitHeight = false;
            cell = Row18.Cells.Add();
            cell.StyleID = "m106945184";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Goal2: 2. Clients have obtained employment facilitating economic self-sufficiency" +
                ".";
            cell.MergeAcross = 15;
            cell.NamedCell.Add("Print_Area");
            cell = Row18.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row18.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row18.Cells.Add();
            cell.StyleID = "s45";
            cell.NamedCell.Add("Print_Area");
            cell = Row18.Cells.Add();
            cell.StyleID = "s46";
            cell.Data.Type = DataType.Error;
            cell.Data.Text = "#DIV/0!";
            cell.Formula = "=+RC[-2]/RC[-3]";
            cell.NamedCell.Add("Print_Area");
            cell = Row18.Cells.Add();
            cell.StyleID = "m106945064";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row18.Cells.Add();
            cell.StyleID = "s35";
            cell = Row18.Cells.Add();
            cell.StyleID = "s31";
            cell = Row18.Cells.Add();
            cell.StyleID = "s37";
            cell = Row18.Cells.Add();
            cell.StyleID = "s37";
            cell = Row18.Cells.Add();
            cell.StyleID = "s35";
            cell = Row18.Cells.Add();
            cell.StyleID = "s35";
            cell.Index = 31;
            // -----------------------------------------------
            WorksheetRow Row19 = sheet.Table.Rows.Add();
            Row19.Height = 22;
            Row19.AutoFitHeight = false;
            cell = Row19.Cells.Add();
            cell.StyleID = "m106945204";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Objective 1: At least 50% of those clients in the Program seeking employment have" +
                " obtained employment, annually.";
            cell.MergeAcross = 15;
            cell.NamedCell.Add("Print_Area");
            cell = Row19.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row19.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row19.Cells.Add();
            cell.StyleID = "s45";
            cell.NamedCell.Add("Print_Area");
            cell = Row19.Cells.Add();
            cell.StyleID = "s46";
            cell.Data.Type = DataType.Error;
            cell.Data.Text = "#DIV/0!";
            cell.Formula = "=+RC[-2]/RC[-3]";
            cell.NamedCell.Add("Print_Area");
            cell = Row19.Cells.Add();
            cell.StyleID = "m106945084";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row19.Cells.Add();
            cell.StyleID = "s35";
            cell = Row19.Cells.Add();
            cell.StyleID = "s31";
            cell = Row19.Cells.Add();
            cell.StyleID = "s37";
            cell = Row19.Cells.Add();
            cell.StyleID = "s37";
            cell = Row19.Cells.Add();
            cell.StyleID = "s35";
            cell = Row19.Cells.Add();
            cell.StyleID = "s35";
            cell.Index = 31;
            // -----------------------------------------------
            WorksheetRow Row20 = sheet.Table.Rows.Add();
            Row20.Height = 22;
            Row20.AutoFitHeight = false;
            cell = Row20.Cells.Add();
            cell.StyleID = "m106945224";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Objective 2: At least 70% of those clients in the Program seeking employment obta" +
                "ined skills/competencies required for employment.";
            cell.MergeAcross = 15;
            cell.NamedCell.Add("Print_Area");
            cell = Row20.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row20.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row20.Cells.Add();
            cell.StyleID = "s45";
            cell.NamedCell.Add("Print_Area");
            cell = Row20.Cells.Add();
            cell.StyleID = "s46";
            cell.Data.Type = DataType.Error;
            cell.Data.Text = "#DIV/0!";
            cell.Formula = "=+RC[-2]/RC[-3]";
            cell.NamedCell.Add("Print_Area");
            cell = Row20.Cells.Add();
            cell.StyleID = "s47";
            cell.NamedCell.Add("Print_Area");
            cell = Row20.Cells.Add();
            cell.StyleID = "s48";
            cell.NamedCell.Add("Print_Area");
            cell = Row20.Cells.Add();
            cell.StyleID = "s35";
            cell = Row20.Cells.Add();
            cell.StyleID = "s31";
            cell = Row20.Cells.Add();
            cell.StyleID = "s37";
            cell = Row20.Cells.Add();
            cell.StyleID = "s37";
            cell = Row20.Cells.Add();
            cell.StyleID = "s35";
            cell = Row20.Cells.Add();
            cell.StyleID = "s35";
            cell.Index = 31;
            // -----------------------------------------------
            WorksheetRow Row21 = sheet.Table.Rows.Add();
            Row21.Height = 22;
            Row21.AutoFitHeight = false;
            cell = Row21.Cells.Add();
            cell.StyleID = "m106945144";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Objective 3:  At least 65% of those clients in the Program, who have obtained emp" +
                "loyment, maintained such for at least ninety working days.";
            cell.MergeAcross = 15;
            cell.NamedCell.Add("Print_Area");
            cell = Row21.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row21.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row21.Cells.Add();
            cell.StyleID = "s45";
            cell.NamedCell.Add("Print_Area");
            cell = Row21.Cells.Add();
            cell.StyleID = "s46";
            cell.Data.Type = DataType.Error;
            cell.Data.Text = "#DIV/0!";
            cell.Formula = "=+RC[-2]/RC[-3]";
            cell.NamedCell.Add("Print_Area");
            cell = Row21.Cells.Add();
            cell.StyleID = "m106945104";
            cell.MergeAcross = 1;
            cell.NamedCell.Add("Print_Area");
            cell = Row21.Cells.Add();
            cell.StyleID = "s35";
            cell = Row21.Cells.Add();
            cell.StyleID = "s31";
            cell = Row21.Cells.Add();
            cell.StyleID = "s37";
            cell = Row21.Cells.Add();
            cell.StyleID = "s37";
            cell = Row21.Cells.Add();
            cell.StyleID = "s35";
            cell = Row21.Cells.Add();
            cell.StyleID = "s35";
            cell.Index = 31;
            // -----------------------------------------------
            WorksheetRow Row22 = sheet.Table.Rows.Add();
            Row22.Height = 22;
            Row22.AutoFitHeight = false;
            cell = Row22.Cells.Add();
            cell.StyleID = "m106945124";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Objective 4: At least 50% of those clients in the Program seeking an improved emp" +
                "loyment situation have obtained a job earning what the client, in their service " +
                "plan, has deemed a satisfactory income to meet the client\'s financial needs.";
            cell.MergeAcross = 15;
            cell.NamedCell.Add("Print_Area");
            cell = Row22.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row22.Cells.Add();
            cell.StyleID = "s44";
            cell.NamedCell.Add("Print_Area");
            cell = Row22.Cells.Add();
            cell.StyleID = "s45";
            cell.NamedCell.Add("Print_Area");
            cell = Row22.Cells.Add();
            cell.StyleID = "s46";
            cell.Data.Type = DataType.Error;
            cell.Data.Text = "#DIV/0!";
            cell.Formula = "=+RC[-2]/RC[-3]";
            cell.NamedCell.Add("Print_Area");
            cell = Row22.Cells.Add();
            cell.StyleID = "s47";
            cell.NamedCell.Add("Print_Area");
            cell = Row22.Cells.Add();
            cell.StyleID = "s48";
            cell.NamedCell.Add("Print_Area");
            cell = Row22.Cells.Add();
            cell.StyleID = "s35";
            cell = Row22.Cells.Add();
            cell.StyleID = "s31";
            cell = Row22.Cells.Add();
            cell.StyleID = "s37";
            cell = Row22.Cells.Add();
            cell.StyleID = "s37";
            cell = Row22.Cells.Add();
            cell.StyleID = "s35";
            cell = Row22.Cells.Add();
            cell.StyleID = "s35";
            cell.Index = 31;
            // -----------------------------------------------
            WorksheetRow Row23 = sheet.Table.Rows.Add();
            Row23.Height = 44;
            Row23.AutoFitHeight = false;
            cell = Row23.Cells.Add();
            cell.StyleID = "m106945024";
            cell.Data.Type = DataType.String;
            cell.Data.Text = "Comments:";
            cell.MergeAcross = 21;
            cell.NamedCell.Add("Print_Area");
            cell = Row23.Cells.Add();
            cell.StyleID = "s35";
            cell = Row23.Cells.Add();
            cell.StyleID = "s31";
            cell = Row23.Cells.Add();
            cell.StyleID = "s37";
            cell = Row23.Cells.Add();
            cell.StyleID = "s37";
            cell = Row23.Cells.Add();
            cell.StyleID = "s35";
            cell = Row23.Cells.Add();
            cell.StyleID = "s35";
            cell.Index = 31;
            // -----------------------------------------------
            WorksheetRow Row24 = sheet.Table.Rows.Add();
            Row24.Height = 12;
            Row24.AutoFitHeight = false;
            // -----------------------------------------------
            WorksheetRow Row25 = sheet.Table.Rows.Add();
            Row25.Height = 35;
            Row25.AutoFitHeight = false;
            // -----------------------------------------------
            WorksheetRow Row26 = sheet.Table.Rows.Add();
            Row26.Height = 27;
            Row26.AutoFitHeight = false;
            // -----------------------------------------------
            WorksheetRow Row27 = sheet.Table.Rows.Add();
            Row27.Index = 37;
            cell = Row27.Cells.Add();
            cell.StyleID = "s39";
            cell.Index = 3;
            // -----------------------------------------------
            //  Options
            // -----------------------------------------------
            sheet.Options.Selected = true;
            sheet.Options.ProtectObjects = false;
            sheet.Options.ProtectScenarios = false;
            sheet.Options.PageSetup.Layout.Orientation = CarlosAg.ExcelXmlWriter.Orientation.Landscape;
            sheet.Options.PageSetup.Header.Margin = 0.3F;
            sheet.Options.PageSetup.Footer.Margin = 0.3F;
            sheet.Options.PageSetup.PageMargins.Bottom = 0.5F;
            sheet.Options.PageSetup.PageMargins.Left = 0.5F;
            sheet.Options.PageSetup.PageMargins.Right = 0.5F;
            sheet.Options.PageSetup.PageMargins.Top = 0.5F;
            sheet.Options.Print.PaperSizeIndex = 5;
            sheet.Options.Print.HorizontalResolution = -3;
            sheet.Options.Print.Scale = 90;
            sheet.Options.Print.ValidPrinterInfo = true;
        }

        private void PrintAuditReportIntakes(string PdfName)
        {
            if (ds.Tables.Count > 0)
            {
                PdfName = PdfName + "_Audit.xls";
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                Workbook book = new Workbook();

                WorksheetStyle s16 = book.Styles.Add("s16");
                s16.Font.FontName = "Tahoma";
                s16.Font.Size = 11;
                s16.Font.Color = "#000000";

                WorksheetStyle style11 = book.Styles.Add("HeaderStyles");
                style11.Font.FontName = "Tahoma";
                style11.Font.Size = 10;
                style11.Interior.Color = "Gray";
                style11.Interior.Pattern = StyleInteriorPattern.Solid;
                style11.Font.Bold = true;
                style11.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style11.Alignment.WrapText = true;
                style11.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle style2 = book.Styles.Add("HeaderStyle");
                style2.Font.FontName = "Tahoma";
                style2.Font.Size = 10;
                style2.Font.Bold = true;
                style2.Interior.Color = "Gray";
                style2.Interior.Pattern = StyleInteriorPattern.Solid;
                style2.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style2.Alignment.WrapText = true;
                style2.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle style5 = book.Styles.Add("HeaderStyleRight");
                style5.Font.FontName = "Tahoma";
                style5.Font.Size = 10;
                style5.Font.Bold = true;
                style5.Interior.Color = "Gray";
                style5.Interior.Pattern = StyleInteriorPattern.Solid;
                style5.Alignment.Horizontal = StyleHorizontalAlignment.Right;
                style5.Alignment.WrapText = true;

                WorksheetStyle style1 = book.Styles.Add("Normal");
                style1.Font.FontName = "Tahoma";
                style1.Font.Size = 10;
                style1.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style1.Alignment.WrapText = true;

                WorksheetStyle style3 = book.Styles.Add("NormalRight");
                style3.Font.FontName = "Tahoma";
                style3.Font.Size = 10;
                style3.Alignment.Horizontal = StyleHorizontalAlignment.Right;
                style3.Alignment.WrapText = true;

                WorksheetStyle style4 = book.Styles.Add("NormalCenter");
                style4.Font.FontName = "Tahoma";
                style4.Font.Size = 10;
                style4.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style4.Alignment.WrapText = true;

                WorksheetStyle style8 = book.Styles.Add("CenterGreen");
                style8.Font.FontName = "Tahoma";
                style8.Interior.Color = "Green";
                style8.Interior.Pattern = StyleInteriorPattern.Solid;
                style8.Font.Size = 10;
                style8.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style8.Alignment.WrapText = true;

                WorksheetStyle style9 = book.Styles.Add("CenterRed");
                style9.Font.FontName = "Tahoma";
                style9.Interior.Color = "Red";
                style9.Interior.Pattern = StyleInteriorPattern.Solid;
                style9.Font.Size = 10;
                style9.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style9.Alignment.WrapText = true;

                WorksheetStyle style10 = book.Styles.Add("RightGreen");
                style10.Font.FontName = "Tahoma";
                style10.Interior.Color = "Green";
                style10.Interior.Pattern = StyleInteriorPattern.Solid;
                style10.Font.Size = 10;
                style10.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style10.Alignment.WrapText = true;

                WorksheetStyle style12 = book.Styles.Add("RightRed");
                style12.Font.FontName = "Tahoma";
                style12.Interior.Color = "Red";
                style12.Interior.Pattern = StyleInteriorPattern.Solid;
                style12.Font.Size = 10;
                style12.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style12.Alignment.WrapText = true;

                WorksheetStyle style13 = book.Styles.Add("NormalGreen");
                style13.Font.FontName = "Tahoma";
                style13.Interior.Color = "Green";
                style13.Interior.Pattern = StyleInteriorPattern.Solid;
                style13.Font.Size = 10;
                style13.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style13.Alignment.WrapText = true;

                WorksheetStyle style14 = book.Styles.Add("NormalRed");
                style14.Font.FontName = "Tahoma";
                style14.Interior.Color = "Red";
                style14.Interior.Pattern = StyleInteriorPattern.Solid;
                style14.Font.Size = 10;
                style14.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style14.Alignment.WrapText = true;

                WorksheetStyle s94 = book.Styles.Add("s94");
                s94.Font.Bold = true;
                s94.Font.FontName = "Tahoma";
                s94.Interior.Color = "#808080";
                s94.Interior.Pattern = StyleInteriorPattern.Solid;
                s94.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                s94.Alignment.Vertical = StyleVerticalAlignment.Bottom;
                s94.Alignment.WrapText = true;
                s94.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                s94.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                s94.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                Worksheet sheet;
                for (int j = 0; j < ds.Tables.Count; j++)
                {
                    if (ds.Tables[j].Rows.Count > 0)
                    {
                        int YeartodtColmns=0;
                        string TypeDesc = ds.Tables[j].Rows[0]["TypeDesc"].ToString().Trim();
                        sheet = book.Worksheets.Add(ds.Tables[j].Rows[0]["TypeDesc"].ToString());
                        //sheet.Table.DefaultRowHeight = 14.25F;
                        DataTable dt1 = ds.Tables[j];
                        DataTable T1 = dt1.Copy();
                        T1.Columns.Remove("Type");
                        T1.Columns.Remove("TypeDesc");
                        T1.Columns.Remove("FamSeq");
                        foreach (DataColumn dc in dt1.Columns)
                        {
                            string ColName = string.Empty;
                            if (dc.ColumnName.Contains("ByPass")) T1.Columns.Remove(dc.ColumnName);
                            else if (dc.ColumnName.Contains("Yeartodate")) YeartodtColmns++; //T1.Columns.Remove(dc.ColumnName);
                        }

                        int Columns = T1.Columns.Count - YeartodtColmns;//ds.Tables[0].Columns.Count - 3;

                        if (Columns > 0)
                        {
                            WorksheetColumn column;
                            sheet.Table.StyleID = "s16";
                            for (int c = 0; c < Columns; c++)
                            {
                                column = sheet.Table.Columns.Add();
                                if (c == 0) column.Width = 88;
                                else if (c == 1) column.Width = 150;
                                else column.Width = 70;
                            }   
                            
                            //WorksheetColumn column0 = sheet.Table.Columns.Add();
                            //column0.Width = 88;
                            ////column0.StyleID = "Header";
                            //WorksheetColumn column1 = sheet.Table.Columns.Add();
                            //column1.Width = 150;
                            ////column1.StyleID = "Header";
                            //WorksheetColumn column2 = sheet.Table.Columns.Add();
                            //column2.Width = 55;
                            ////column2.StyleID = "Header";
                            //WorksheetColumn column3 = sheet.Table.Columns.Add();
                            //column3.Width = 60;
                            ////column3.StyleID = "Header";
                            //WorksheetColumn column4 = sheet.Table.Columns.Add();
                            //column4.Width = 36;
                            ////column4.StyleID = "Header";
                            //WorksheetColumn column5 = sheet.Table.Columns.Add();
                            //column5.Width = 55;
                            ////column5.StyleID = "Header";
                            //WorksheetColumn column6 = sheet.Table.Columns.Add();
                            //column6.Width = 60;
                            ////column6.StyleID = "Header";
                            //WorksheetColumn column7 = sheet.Table.Columns.Add();
                            //column7.Width = 36;
                            ////column7.StyleID = "Header";
                        }

                        WorksheetRow row = sheet.Table.Rows.Add();
                        row.Height = 47;
                        row.AutoFitHeight = false;

                        //string Data = "SSBG Selection : " + ((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Text.Trim() + " \n" + lblReferenceperiodate.Text.Trim() + " : " + Ref_From_Date.Text + "-" + Ref_To_Date.Text + " \n" + lblRepDate.Text.Trim() + " : " + dtpFrom.Text + "-" + dtpTo.Text.Trim();
                        //WorksheetCell cell = row.Cells.Add(Data, DataType.String, "s94");
                        //cell.MergeAcross = Columns - 1;

                        //row = sheet.Table.Rows.Add();
                        WorksheetCell cell1 = row.Cells.Add(TypeDesc, DataType.String, "HeaderStyles");
                        cell1.MergeAcross = Columns-1;

                        //int dcCount = 0;
                        row = sheet.Table.Rows.Add();
                        foreach (DataColumn dc in T1.Columns)
                        {
                            string ColName = string.Empty;
                            //if (dc.ColumnName.Contains("ByPass")) ColName = "Report Period";
                            //else if (dc.ColumnName.Contains("Yeartodate")) ColName = "Reference Period";
                            //else 
                            
                                ColName = dc.ColumnName.Trim();
                            WorksheetCell S1;
                            if (!dc.ColumnName.Contains("Yeartodate"))
                                S1 = row.Cells.Add(ColName, DataType.String, "HeaderStyle");

                        }

                        foreach (DataRow dr in T1.Rows)
                        {
                            row = sheet.Table.Rows.Add();
                            WorksheetCell S1;
                            for (int i = 0; i < Columns + YeartodtColmns; i++)
                            {
                                if (i == 0 || i == 1)
                                    S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "Normal");
                                else if (string.IsNullOrEmpty(dr[i].ToString().Trim()))//else if(dr[i].ToString()=="Y" || dr[i].ToString()=="N")
                                {
                                    if (i < Columns + YeartodtColmns)
                                    {
                                        if (T1.Columns[i].ColumnName.Contains("Period"))
                                        {
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "NormalCenter");
                                        }
                                        else if (T1.Columns[i + 1].ColumnName.Contains("Yeartodate"))
                                        {
                                            if (dr[i + 1].ToString() == "Y")
                                                S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "CenterGreen");
                                            else if (dr[i + 1].ToString() == "N")
                                                S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "CenterRed");
                                        }
                                        else if (!T1.Columns[i].ColumnName.Contains("Yeartodate"))
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "NormalCenter");
                                    }
                                }
                                else if (CommonFunctions.IsNumeric(dr[i].ToString()))
                                {
                                    if (i < Columns + YeartodtColmns)
                                    {
                                        if (T1.Columns[i].ColumnName.Contains("Period"))
                                        {
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "NormalRight");
                                        }
                                        else if (T1.Columns[i + 1].ColumnName.Contains("Yeartodate"))
                                        {
                                            if (dr[i + 1].ToString() == "Y")
                                                S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "RightGreen");
                                            else if (dr[i + 1].ToString() == "N")
                                                S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "RightRed");
                                        }
                                        else if (!T1.Columns[i].ColumnName.Contains("Yeartodate"))
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "NormalRight");
                                    }
                                }
                                else if (!CommonFunctions.IsNumeric(dr[i].ToString()))
                                {
                                    if (i < Columns + YeartodtColmns)
                                    {
                                        if (T1.Columns[i].ColumnName.Contains("Period"))
                                        {
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "Normal");
                                        }
                                        else if (T1.Columns[i + 1].ColumnName.Contains("Yeartodate"))
                                        {
                                            if (dr[i + 1].ToString() == "Y")
                                                S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "NormalGreen");
                                            else if (dr[i + 1].ToString() == "N")
                                                S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "NormalRed");
                                        }
                                        else if (!T1.Columns[i].ColumnName.Contains("Yeartodate"))
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "Normal");
                                    }
                                }
                            }
                            
                            //WorksheetCell S1 = row.Cells.Add(dr[2].ToString());
                            //S1 = row.Cells.Add(dr[3].ToString());
                            //S1 = row.Cells.Add(dr[4].ToString());
                            //S1 = row.Cells.Add(dr[5].ToString());
                            //S1 = row.Cells.Add(dr[6].ToString());
                            //S1 = row.Cells.Add(dr[7].ToString());
                            //S1 = row.Cells.Add(dr[8].ToString());

                        }
                        T1.Clear();
                    }
                }
                

                FileStream stream = new FileStream(PdfName, FileMode.Create);

                book.Save(stream);
                stream.Close();
            }
        }

        private void PrintHRANBAuditReportIntakes(string PdfName,SSBGPARAMEntity SelSSBG)
        {
            if (ds.Tables.Count > 0)
            {
                PdfName = PdfName + "_Audit.xls";
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                Workbook book = new Workbook();

                WorksheetStyle s16 = book.Styles.Add("s16");
                s16.Font.FontName = "Tahoma";
                s16.Font.Size = 11;
                s16.Font.Color = "#000000";

                WorksheetStyle style11 = book.Styles.Add("HeaderStyles");
                style11.Font.FontName = "Tahoma";
                style11.Font.Size = 10;
                style11.Interior.Color = "Gray";
                style11.Interior.Pattern = StyleInteriorPattern.Solid;
                style11.Font.Bold = true;
                style11.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style11.Alignment.WrapText = true;
                style11.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle style2 = book.Styles.Add("HeaderStyle");
                style2.Font.FontName = "Tahoma";
                style2.Font.Size = 10;
                style2.Font.Bold = true;
                style2.Interior.Color = "Gray";
                style2.Interior.Pattern = StyleInteriorPattern.Solid;
                style2.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style2.Alignment.WrapText = true;
                style2.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle style5 = book.Styles.Add("HeaderStyleRight");
                style5.Font.FontName = "Tahoma";
                style5.Font.Size = 10;
                style5.Font.Bold = true;
                style5.Interior.Color = "Gray";
                style5.Interior.Pattern = StyleInteriorPattern.Solid;
                style5.Alignment.Horizontal = StyleHorizontalAlignment.Right;
                style5.Alignment.WrapText = true;

                WorksheetStyle style1 = book.Styles.Add("Normal");
                style1.Font.FontName = "Tahoma";
                style1.Font.Size = 10;
                style1.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style1.Alignment.WrapText = true;

                WorksheetStyle style3 = book.Styles.Add("NormalRight");
                style3.Font.FontName = "Tahoma";
                style3.Font.Size = 10;
                style3.Alignment.Horizontal = StyleHorizontalAlignment.Right;
                style3.Alignment.WrapText = true;

                WorksheetStyle style4 = book.Styles.Add("NormalCenter");
                style4.Font.FontName = "Tahoma";
                style4.Font.Size = 10;
                style4.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style4.Alignment.WrapText = true;

                WorksheetStyle style8 = book.Styles.Add("CenterGreen");
                style8.Font.FontName = "Tahoma";
                style8.Interior.Color = "Green";
                style8.Interior.Pattern = StyleInteriorPattern.Solid;
                style8.Font.Size = 10;
                style8.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style8.Alignment.WrapText = true;

                WorksheetStyle style9 = book.Styles.Add("CenterRed");
                style9.Font.FontName = "Tahoma";
                style9.Interior.Color = "Red";
                style9.Interior.Pattern = StyleInteriorPattern.Solid;
                style9.Font.Size = 10;
                style9.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style9.Alignment.WrapText = true;

                WorksheetStyle style10 = book.Styles.Add("RightGreen");
                style10.Font.FontName = "Tahoma";
                style10.Interior.Color = "Green";
                style10.Interior.Pattern = StyleInteriorPattern.Solid;
                style10.Font.Size = 10;
                style10.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style10.Alignment.WrapText = true;

                WorksheetStyle style12 = book.Styles.Add("RightRed");
                style12.Font.FontName = "Tahoma";
                style12.Interior.Color = "Red";
                style12.Interior.Pattern = StyleInteriorPattern.Solid;
                style12.Font.Size = 10;
                style12.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style12.Alignment.WrapText = true;

                WorksheetStyle style13 = book.Styles.Add("NormalGreen");
                style13.Font.FontName = "Tahoma";
                style13.Interior.Color = "Green";
                style13.Interior.Pattern = StyleInteriorPattern.Solid;
                style13.Font.Size = 10;
                style13.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style13.Alignment.WrapText = true;

                WorksheetStyle style14 = book.Styles.Add("NormalRed");
                style14.Font.FontName = "Tahoma";
                style14.Interior.Color = "Red";
                style14.Interior.Pattern = StyleInteriorPattern.Solid;
                style14.Font.Size = 10;
                style14.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style14.Alignment.WrapText = true;

                WorksheetStyle style15 = book.Styles.Add("NormalBold");
                style15.Font.FontName = "Tahoma";
                style15.Font.Size = 12;
                style15.Font.Bold = true;
                style15.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style15.Alignment.WrapText = true;

                WorksheetStyle style33 = book.Styles.Add("NormalRightBold");
                style33.Font.FontName = "Tahoma";
                style33.Font.Size = 10;
                style33.Font.Bold = true;
                style33.Alignment.Horizontal = StyleHorizontalAlignment.Right;
                style33.Alignment.WrapText = true;

                WorksheetStyle style34 = book.Styles.Add("NormalLeftBold");
                style34.Font.FontName = "Tahoma";
                style34.Font.Size = 10;
                style34.Font.Bold = true;
                style34.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style34.Alignment.WrapText = true;

                WorksheetStyle style16 = book.Styles.Add("NormalGray");
                style16.Font.FontName = "Tahoma";
                style16.Interior.Color = "Gray";
                style16.Interior.Pattern = StyleInteriorPattern.Solid;
                style16.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style16.Font.Size = 12;
                style16.Font.Bold = true;
                style16.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style16.Alignment.WrapText = true;

                WorksheetStyle s94 = book.Styles.Add("s94");
                s94.Font.Bold = true;
                s94.Font.FontName = "Tahoma";
                s94.Interior.Color = "#808080";
                s94.Interior.Pattern = StyleInteriorPattern.Solid;
                s94.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                s94.Alignment.Vertical = StyleVerticalAlignment.Bottom;
                s94.Alignment.WrapText = true;
                s94.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                s94.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                s94.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);


                // -----------------------------------------------
                //  m2606487017296
                // -----------------------------------------------
                WorksheetStyle m2606487017296 = book.Styles.Add("m2606487017296");
                m2606487017296.Font.Bold = true;
                m2606487017296.Font.FontName = "Tahoma";
                m2606487017296.Font.Size = 8;
                m2606487017296.Font.Color = "#333333";
                m2606487017296.Interior.Color = "#DDEBF7";
                m2606487017296.Interior.Pattern = StyleInteriorPattern.Solid;
                m2606487017296.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                m2606487017296.Alignment.Vertical = StyleVerticalAlignment.Center;
                m2606487017296.Alignment.WrapText = true;
                m2606487017296.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
                m2606487017296.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
                m2606487017296.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
                // -----------------------------------------------
                //  s122
                // -----------------------------------------------
                WorksheetStyle s122 = book.Styles.Add("s122");
                s122.Font.Bold = true;
                s122.Font.FontName = "Tahoma";
                s122.Font.Size = 8;
                s122.Font.Color = "#333333";
                s122.Interior.Color = "#DDEBF7";
                s122.Interior.Pattern = StyleInteriorPattern.Solid;
                s122.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                s122.Alignment.Vertical = StyleVerticalAlignment.Center;
                s122.Alignment.WrapText = true;
                s122.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
                // -----------------------------------------------
                //  s134
                // -----------------------------------------------
                WorksheetStyle s134 = book.Styles.Add("s134");
                s134.Font.Bold = true;
                s134.Font.FontName = "Tahoma";
                s134.Font.Size = 8;
                s134.Font.Color = "#333333";
                s134.Interior.Color = "#DDEBF7";
                s134.Interior.Pattern = StyleInteriorPattern.Solid;
                s134.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                s134.Alignment.Vertical = StyleVerticalAlignment.Center;
                s134.Alignment.WrapText = true;
                s134.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
                s134.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
                s134.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
                s134.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
                // -----------------------------------------------
                //  s169
                // -----------------------------------------------
                WorksheetStyle s169 = book.Styles.Add("s169");
                s169.Font.Bold = true;
                s169.Font.FontName = "Tahoma";
                s169.Interior.Color = "#FFFF00";
                s169.Interior.Pattern = StyleInteriorPattern.Solid;
                s169.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                s169.Alignment.Vertical = StyleVerticalAlignment.Bottom;
                s169.Alignment.WrapText = true;
                s169.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                s169.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                s169.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                s169.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
                // -----------------------------------------------
                //  s180
                // -----------------------------------------------
                WorksheetStyle s180 = book.Styles.Add("s180");
                s180.Font.Bold = true;
                s180.Font.FontName = "Tahoma";
                s180.Font.Size = 10;
                s180.Font.Color = "#333333";
                s180.Interior.Color = "#DDEBF7";
                s180.Interior.Pattern = StyleInteriorPattern.Solid;
                s180.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                s180.Alignment.Vertical = StyleVerticalAlignment.Top;
                s180.Alignment.WrapText = true;
                s180.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
                s180.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
                // -----------------------------------------------
                //  s224
                // -----------------------------------------------
                WorksheetStyle s224 = book.Styles.Add("s224");
                s224.Font.Bold = true;
                s224.Font.FontName = "Tahoma";
                s224.Font.Size = 10;
                s224.Font.Color = "#333333";
                s224.Interior.Color = "#DDEBF7";
                s224.Interior.Pattern = StyleInteriorPattern.Solid;
                s224.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                s224.Alignment.Vertical = StyleVerticalAlignment.Bottom;
                s224.Alignment.WrapText = true;
                s224.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
                s224.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
                // -----------------------------------------------
                //  m2606487520128
                // -----------------------------------------------
                WorksheetStyle m2606487520128 = book.Styles.Add("m2606487520128");
                m2606487520128.Font.Bold = true;
                m2606487520128.Font.FontName = "Tahoma";
                m2606487520128.Font.Size = 8;
                m2606487520128.Font.Color = "#333333";
                m2606487520128.Interior.Color = "#DDEBF7";
                m2606487520128.Interior.Pattern = StyleInteriorPattern.Solid;
                m2606487520128.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                m2606487520128.Alignment.Vertical = StyleVerticalAlignment.Center;
                m2606487520128.Alignment.WrapText = true;
                m2606487520128.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
                m2606487520128.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
                m2606487520128.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
                // -----------------------------------------------
                //  m2606487520228
                // -----------------------------------------------
                WorksheetStyle m2606487520228 = book.Styles.Add("m2606487520228");
                m2606487520228.Font.Bold = true;
                m2606487520228.Font.FontName = "Tahoma";
                m2606487520228.Interior.Color = "#FFFFFF";
                m2606487520228.Interior.Pattern = StyleInteriorPattern.Solid;
                m2606487520228.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                m2606487520228.Alignment.Vertical = StyleVerticalAlignment.Bottom;
                m2606487520228.Alignment.WrapText = true;
                m2606487520228.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                m2606487520228.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                m2606487520228.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
                // -----------------------------------------------
                //  m2606527900444
                // -----------------------------------------------
                WorksheetStyle m2606527900444 = book.Styles.Add("m2606527900444");
                m2606527900444.Font.Bold = true;
                m2606527900444.Font.FontName = "Tahoma";
                m2606527900444.Font.Size = 10;
                m2606527900444.Font.Color = "#333333";
                m2606527900444.Interior.Color = "#DDEBF7";
                m2606527900444.Interior.Pattern = StyleInteriorPattern.Solid;
                m2606527900444.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                m2606527900444.Alignment.Vertical = StyleVerticalAlignment.Top;
                m2606527900444.Alignment.WrapText = true;
                m2606527900444.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
                m2606527900444.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
                m2606527900444.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
                // -----------------------------------------------
                //  m2606527900384
                // -----------------------------------------------
                WorksheetStyle m2606527900384 = book.Styles.Add("m2606527900384");
                m2606527900384.Font.Bold = true;
                m2606527900384.Font.FontName = "Tahoma";
                m2606527900384.Interior.Color = "#FFFF00";
                m2606527900384.Interior.Pattern = StyleInteriorPattern.Solid;
                m2606527900384.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                m2606527900384.Alignment.Vertical = StyleVerticalAlignment.Bottom;
                m2606527900384.Alignment.WrapText = true;
                m2606527900384.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                m2606527900384.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                // -----------------------------------------------
                //  m2606487520208
                // -----------------------------------------------
                WorksheetStyle m2606487520208 = book.Styles.Add("m2606487520208");
                m2606487520208.Font.Bold = true;
                m2606487520208.Font.FontName = "Tahoma";
                m2606487520208.Font.Size = 10;
                m2606487520208.Font.Color = "#333333";
                m2606487520208.Interior.Color = "#DDEBF7";
                m2606487520208.Interior.Pattern = StyleInteriorPattern.Solid;
                m2606487520208.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                m2606487520208.Alignment.Vertical = StyleVerticalAlignment.Bottom;
                m2606487520208.Alignment.WrapText = true;
                m2606487520208.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
                m2606487520208.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
                m2606487520208.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);

                Worksheet sheet;
                WorksheetColumn column;
                WorksheetRow row;

                #region HeaderSheet
                sheet = book.Worksheets.Add("Parameters");

                sheet.Table.Columns.Add(new WorksheetColumn(50));
                sheet.Table.Columns.Add(new WorksheetColumn(200));
                sheet.Table.Columns.Add(new WorksheetColumn(250));
                //sheet.Table.Columns.Add(new WorksheetColumn(130));
                //sheet.Table.Columns.Add(new WorksheetColumn(130));
                //sheet.Table.Columns.Add(new WorksheetColumn(130));
                //sheet.Table.Columns.Add(new WorksheetColumn(130));

                row = sheet.Table.Rows.Add();
                row = sheet.Table.Rows.Add();
                row = sheet.Table.Rows.Add();
                WorksheetCell H1 = row.Cells.Add("", DataType.String, "NormalBold");
                H1 = row.Cells.Add(Privileges.Program + " - " + Privileges.PrivilegeName, DataType.String, "NormalGray");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "NormalBold");
                H1 = row.Cells.Add("Run By : " + LookupDataAccess.GetMemberName(BaseForm.UserProfile.FirstName.Trim(), BaseForm.UserProfile.MI.Trim(), BaseForm.UserProfile.LastName.Trim(), "3"), DataType.String, "Normal");
                H1 = row.Cells.Add("Date : " + DateTime.Now.ToString(), DataType.String, "NormalRight");
                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "NormalBold");
                H1 = row.Cells.Add("Selected Report Parameters", DataType.String, "NormalGray");
                H1.MergeAcross = 1;

                string Agy = "Agency : All"; string Dept = "Dept : All"; string Prg = "Program : All"; string Header_year = string.Empty;
                if (Agency != "**") Agy = "Agency : " + Agency;
                if (Depart != "**") Dept = "Dept : " + Depart;
                if (Program != "**") Prg = "Program : " + Program;
                if (CmbYear.Visible == true)
                    Header_year = "Year : " + ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString();

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add(Txt_HieDesc.Text.Trim() + "     " + Header_year, DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add("SSBG Selection :" + ((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Text.ToString().Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                //**H1 = row.Cells.Add(lblReferenceperiodate.Text + "  " + lblreferenceFrom.Text.Trim() + ":" + Ref_From_Date.Text + "    " + lblReferenceTo.Text.Trim() + ":" + Ref_To_Date.Text.Trim(), DataType.String, "Normal");
                H1 = row.Cells.Add(lblReferenceperiodate.Text /*+ "  " + lblreferenceFrom.Text.Trim()*/ + ": " + Ref_From_Date.Text + "    " + lblReferenceTo.Text.Trim() + ": " + Ref_To_Date.Text.Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                //**H1 = row.Cells.Add(lblRepDate.Text + "  " + lblRepFrom.Text.Trim() + ":" + dtpFrom.Text + "    " + label6.Text.Trim() + ":" + dtpTo.Text.Trim(), DataType.String, "Normal");
                H1 = row.Cells.Add(lblRepDate.Text /*+ "  " + lblRepFrom.Text.Trim()*/ + ": " + dtpFrom.Text + "    " + label6.Text.Trim() + ": " + dtpTo.Text.Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add(lblDemCount.Text.Trim() + " : " + ((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Text.ToString().Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add(lblAge1.Text.Trim() + " : " + txtfrom1.Text.Trim() + " - " + txtTo1.Text.Trim() + "    " + lblAge2.Text.Trim() + " : " + txtFrom2.Text.Trim() + " - " + txtTo2.Text.Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                string Audit = string.Empty;
                if (rbGreen.Checked) Audit = rbGreen.Text.Trim();
                else if (rbGred.Checked) Audit = rbGred.Text.Trim();

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add(label1.Text.Trim() + " : " + Audit, DataType.String, "Normal");
                H1.MergeAcross = 1;

                #endregion

                #region AuditReport

                for (int j = 0; j < ds.Tables.Count; j++)
                {
                    if (ds.Tables[j].Rows.Count > 0)
                    {
                        int YeartodtColmns = 0;
                        string TypeDesc = ds.Tables[j].Rows[0]["TypeDesc"].ToString().Trim();
                        sheet = book.Worksheets.Add(ds.Tables[j].Rows[0]["TypeDesc"].ToString());
                        //sheet.Table.DefaultRowHeight = 14.25F;
                        DataTable dt1 = ds.Tables[j];
                        DataTable T1 = dt1.Copy();
                        T1.Columns.Remove("RowID");
                        T1.Columns.Remove("Type");
                        T1.Columns.Remove("TypeDesc");
                        T1.Columns.Remove("FamSeq");
                        foreach (DataColumn dc in dt1.Columns)
                        {
                            string ColName = string.Empty;
                            if (dc.ColumnName.Contains("ByPass")) T1.Columns.Remove(dc.ColumnName);
                            else if (dc.ColumnName.Contains("Yeartodate")) YeartodtColmns++; //T1.Columns.Remove(dc.ColumnName);
                        }

                        int Columns = T1.Columns.Count - YeartodtColmns;//ds.Tables[0].Columns.Count - 3;
                        int C = 0;
                        if (Columns > 0)
                        {

                            sheet.Table.StyleID = "s16";
                            //for (int c = 0; c < Columns; c++)
                            //{
                            //    column = sheet.Table.Columns.Add();
                            //    if (c == 0) column.Width = 88;
                            //    else if (c == 1) column.Width = 150;
                            //    else column.Width = 70;
                            //}


                            foreach (DataColumn dc in T1.Columns)
                            {
                                if (dc.ColumnName.Contains("IntakeDate"))
                                    break;
                                else if (!dc.ColumnName.Contains("Yeartodate"))
                                {
                                    column = sheet.Table.Columns.Add();
                                    if (C == 0) column.Width = 88;
                                    else if (C == 1) column.Width = 150;
                                    else column.Width = 80;
                                }
                                C++;
                            }

                            Columns = C - YeartodtColmns;

                            if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1")
                            {
                                column = sheet.Table.Columns.Add();
                                column.Width = 80;
                                column = sheet.Table.Columns.Add();
                                column.Width = 80;
                                if (SelSSBG.SSBGCntArea1_Val.ToString() == "I" || SelSSBG.SSBGCntArea1_Val.ToString() == "A" || SelSSBG.SSBGCntArea1_Val.ToString() == "B" || SelSSBG.SSBGCntArea1_Val.ToString() == "S" || SelSSBG.SSBGCntArea1_Val.ToString() == "T")
                                {
                                    column = sheet.Table.Columns.Add();
                                    column.Width = 80;
                                    C = C + 3;
                                }
                                else C = C + 2;
                            }
                            if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1")
                            {
                                column = sheet.Table.Columns.Add();
                                column.Width = 80;
                                column = sheet.Table.Columns.Add();
                                column.Width = 80;
                                if (SelSSBG.SSBGCntArea2_Val.ToString() == "I" || SelSSBG.SSBGCntArea2_Val.ToString() == "A" || SelSSBG.SSBGCntArea2_Val.ToString() == "B" || SelSSBG.SSBGCntArea2_Val.ToString() == "S" || SelSSBG.SSBGCntArea2_Val.ToString() == "T")
                                {
                                    column = sheet.Table.Columns.Add();
                                    column.Width = 80;
                                    C = C + 3;
                                }
                                else C = C + 2;
                                ////column = sheet.Table.Columns.Add();
                                ////column.Width = 70;
                                ////column = sheet.Table.Columns.Add();
                                ////column.Width = 70;
                                //C = C + 1;
                            }
                            if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1")
                            {
                                column = sheet.Table.Columns.Add();
                                column.Width = 80;
                                column = sheet.Table.Columns.Add();
                                column.Width = 80;
                                if (SelSSBG.SSBGCntArea3_Val.ToString() == "I" || SelSSBG.SSBGCntArea3_Val.ToString() == "A" || SelSSBG.SSBGCntArea3_Val.ToString() == "B" || SelSSBG.SSBGCntArea3_Val.ToString() == "S" || SelSSBG.SSBGCntArea3_Val.ToString() == "T")
                                {
                                    column = sheet.Table.Columns.Add();
                                    column.Width = 80;
                                    C = C + 3;
                                }
                                else C = C + 2;
                                ////column = sheet.Table.Columns.Add();
                                ////column.Width = 70;
                                ////column = sheet.Table.Columns.Add();
                                ////column.Width = 70;
                                //C = C + 1;
                            }
                            if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1")
                            {
                                column = sheet.Table.Columns.Add();
                                column.Width = 80;
                                column = sheet.Table.Columns.Add();
                                column.Width = 80;
                                if (SelSSBG.SSBGCntArea4_Val.ToString() == "I" || SelSSBG.SSBGCntArea4_Val.ToString() == "A" || SelSSBG.SSBGCntArea4_Val.ToString() == "B" || SelSSBG.SSBGCntArea4_Val.ToString() == "S" || SelSSBG.SSBGCntArea4_Val.ToString() == "T")
                                {
                                    column = sheet.Table.Columns.Add();
                                    column.Width = 80;
                                    C = C + 3;
                                }
                                else C = C + 2;
                                //C = C + 3;
                            }
                            if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1")
                            {
                                column = sheet.Table.Columns.Add();
                                column.Width = 80;
                                column = sheet.Table.Columns.Add();
                                column.Width = 80;
                                if (SelSSBG.SSBGCntArea3_Val.ToString() == "I" || SelSSBG.SSBGCntArea5_Val.ToString() == "A" || SelSSBG.SSBGCntArea5_Val.ToString() == "B" || SelSSBG.SSBGCntArea5_Val.ToString() == "S" || SelSSBG.SSBGCntArea5_Val.ToString() == "T")
                                {
                                    column = sheet.Table.Columns.Add();
                                    column.Width = 80;
                                    C = C + 3;
                                }
                                else C = C + 2;
                                //C = C + 3;
                            }

                            //WorksheetColumn column0 = sheet.Table.Columns.Add();
                            //column0.Width = 88;
                            ////column0.StyleID = "Header";
                            //WorksheetColumn column1 = sheet.Table.Columns.Add();
                            //column1.Width = 150;
                            ////column1.StyleID = "Header";
                            //WorksheetColumn column2 = sheet.Table.Columns.Add();
                            //column2.Width = 55;
                            ////column2.StyleID = "Header";
                            //WorksheetColumn column3 = sheet.Table.Columns.Add();
                            //column3.Width = 60;
                            ////column3.StyleID = "Header";
                            //WorksheetColumn column4 = sheet.Table.Columns.Add();
                            //column4.Width = 36;
                            ////column4.StyleID = "Header";
                            //WorksheetColumn column5 = sheet.Table.Columns.Add();
                            //column5.Width = 55;
                            ////column5.StyleID = "Header";
                            //WorksheetColumn column6 = sheet.Table.Columns.Add();
                            //column6.Width = 60;
                            ////column6.StyleID = "Header";
                            //WorksheetColumn column7 = sheet.Table.Columns.Add();
                            //column7.Width = 36;
                            ////column7.StyleID = "Header";
                        }

                        DataView dv = new DataView(T1);
                        dv.Sort = "AppNo";
                        T1 = dv.ToTable();

                        string RepMonths = string.Empty;

                        List<string> diffMonths = BuildMothswithYears(dtpFrom.Value.Month,dtpTo.Value.Month, dtpFrom.Value.Year, dtpTo.Value.Year);

                        //var diffMonths = (dtpTo.Value - dtpFrom.Value).Days / 30;
                        //var diffMonths = (dtpTo.Value.Month + dtpTo.Value.Year * 12) - (dtpFrom.Value.Month + dtpFrom.Value.Year * 12);
                        //int diffMonths = Math.Abs(((dtpTo.Value.Year - dtpFrom.Value.Year) * 12) + (dtpTo.Value.Month - dtpFrom.Value.Month));
                        if (diffMonths.Count > 1) RepMonths = "(" + diffMonths.Count + " Months)"; else RepMonths = "(" + diffMonths.Count + " Month)";

                        string DynamicMonth = string.Empty;
                        switch (diffMonths.Count)
                        {
                            case 0:
                            case 1: DynamicMonth = "1 Month"; break;
                            case 2: DynamicMonth = "2 Month"; break;
                            case 3: DynamicMonth = "Quarterly"; break;
                            case 4: DynamicMonth = "4 Month"; break;
                            case 5: DynamicMonth = "5 Month"; break;
                            case 6: DynamicMonth = "Half Yearly"; break;
                            case 7: DynamicMonth = "7 Month"; break;
                            case 8: DynamicMonth = "8 Month"; break;
                            case 9: DynamicMonth = "9 Month"; break;
                            case 10: DynamicMonth = "10 Month"; break;
                            case 11: DynamicMonth = "11 Month"; break;
                            case 12: DynamicMonth = "Yearly"; break;
                        }

                        WorksheetRow Row0 = sheet.Table.Rows.Add();
                        Row0.Height = 34;
                        Row0.AutoFitHeight = false;
                        WorksheetCell cell;
                        cell = Row0.Cells.Add();
                        cell.StyleID = "m2606487017296";
                        cell.Data.Type = DataType.String;
                        cell.Data.Text = "Social Services Block Grant (SSBG) Case Management";
                        cell.MergeAcross = 2;
                        cell = Row0.Cells.Add();
                        cell.StyleID = "s122";
                        cell.Data.Type = DataType.String;
                        cell.Data.Text = "Reporting Period: " + LookupDataAccess.GetMonthNameDate(dtpFrom.Text.ToString()) + " -" + LookupDataAccess.GetMonthNameDate(dtpTo.Text.ToString()) + "  " + RepMonths;
                        cell.MergeAcross = 2;
                        cell = Row0.Cells.Add();
                        cell.StyleID = "m2606487520128";
                        cell.Data.Type = DataType.String;
                        cell.Data.Text = "Date of Reporting: " + DateTime.Now.ToShortDateString();
                        cell.MergeAcross = 1;
                        // -----------------------------------------------

                        //SSBGPARAMEntity SelSSBG = new SSBGPARAMEntity();
                        //SelSSBG = SSBGParamall.Find(u => ((u.SSBGSeq).Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString())));

                        List<string> GrntMonths = BuildMothswithYears(Convert.ToDateTime(SelSSBG.SSBGGPFrom).Month, Convert.ToDateTime(SelSSBG.SSBGGPTo).Month, Convert.ToDateTime(SelSSBG.SSBGGPFrom).Year, Convert.ToDateTime(SelSSBG.SSBGGPTo).Year);

                        //var GrntMonths = (Convert.ToDateTime(SelSSBG.SSBGGPTo) - Convert.ToDateTime(SelSSBG.SSBGGPFrom)).Days / 30;
                        if (GrntMonths.Count > 1) RepMonths = "(" + GrntMonths.Count + " Months)"; else RepMonths = "(" + GrntMonths.Count + " Month)";

                        WorksheetRow Row1 = sheet.Table.Rows.Add();
                        Row1.Height = 34;
                        Row1.AutoFitHeight = false;
                        cell = Row1.Cells.Add();
                        cell.StyleID = "s134";
                        cell.Data.Type = DataType.String;
                        cell.Data.Text = "Agency Name: " + BaseForm.BaseAgencyControlDetails.AgyName.Trim();
                        cell.MergeAcross = 2;
                        cell = Row1.Cells.Add();
                        cell.StyleID = "s134";
                        cell.Data.Type = DataType.String;
                        cell.Data.Text = "Grant Period: " + LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPFrom.ToString()) + " -" + LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPTo.ToString()) + "  " + RepMonths;
                        cell.MergeAcross = 2;
                        cell = Row1.Cells.Add();
                        cell.StyleID = "s134";
                        cell.Data.Type = DataType.String;
                        cell.Data.Text = "Completed by: ";
                        cell.MergeAcross = 1;


                        row = sheet.Table.Rows.Add();
                        row.Height = 47;
                        row.AutoFitHeight = false;

                        //string Data = "SSBG Selection : " + ((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Text.Trim() + " \n" + lblReferenceperiodate.Text.Trim() + " : " + Ref_From_Date.Text + "-" + Ref_To_Date.Text + " \n" + lblRepDate.Text.Trim() + " : " + dtpFrom.Text + "-" + dtpTo.Text.Trim();
                        //WorksheetCell cell = row.Cells.Add(Data, DataType.String, "s94");
                        //cell.MergeAcross = Columns - 1;

                        //row = sheet.Table.Rows.Add();
                        //WorksheetCell cell1 = row.Cells.Add(TypeDesc, DataType.String, "HeaderStyles");
                        WorksheetCell cell1 = row.Cells.Add(TypeDesc, DataType.String, "m2606527900384");
                        cell1.MergeAcross = C-1;

                        row = sheet.Table.Rows.Add();
                        row.Height = 25;
                        row.AutoFitHeight = false;

                        for (int i = 0; i < Columns; i++)
                        {
                            cell1 = row.Cells.Add("", DataType.String, "m2606527900384");
                        }

                        if (SelSSBG.SSBGCntArea1_Chk.Trim() == "1")
                        {
                            cell1 = row.Cells.Add(SelSSBG.SSBGCntArea1.Trim(), DataType.String, "m2606527900384");
                            cell1.MergeAcross = 2;
                        }

                        if (SelSSBG.SSBGCntArea2_Chk.Trim() == "1")
                        {
                            cell1 = row.Cells.Add(SelSSBG.SSBGCntArea2.Trim(), DataType.String, "m2606527900384");
                            cell1.MergeAcross = 1;
                        }

                        if (SelSSBG.SSBGCntArea3_Chk.Trim() == "1")
                        {
                            cell1 = row.Cells.Add(SelSSBG.SSBGCntArea3.Trim(), DataType.String, "m2606527900384");
                            cell1.MergeAcross = 1;
                        }

                        if (SelSSBG.SSBGCntArea4_Chk.Trim() == "1")
                        {
                            cell1 = row.Cells.Add(SelSSBG.SSBGCntArea4.Trim(), DataType.String, "m2606527900384");
                            cell1.MergeAcross = 2;
                        }

                        if (SelSSBG.SSBGCntArea5_Chk.Trim() == "1")
                        {
                            cell1 = row.Cells.Add(SelSSBG.SSBGCntArea5.Trim(), DataType.String, "m2606527900384");
                            cell1.MergeAcross = 2;
                        }

                        List<SSBGTYPESEntity> SSBGQues = SSBGTypesQues.FindAll(u => (u.SBGTID.Equals(SelSSBG.SSBGSeq) && u.SBGTCode.Equals(dt1.Rows[0]["Type"].ToString()) && (!u.SBGTGroupSeq.Equals("0"))));
                        //int dcCount = 0;
                        int ColIndex = 0;
                        row = sheet.Table.Rows.Add();
                        foreach (DataColumn dc in T1.Columns)
                        {
                            string ColName = string.Empty;
                            //if (dc.ColumnName.Contains("ByPass")) ColName = "Report Period";
                            //else if (dc.ColumnName.Contains("Yeartodate")) ColName = "Reference Period";
                            //else 

                            ColName = dc.ColumnName.Trim();
                            WorksheetCell S1;
                            if (dc.ColumnName.Contains("IntakeDate"))
                                break;
                            if (!dc.ColumnName.Contains("Yeartodate"))
                            {

                                if (SSBGQues.Count > 0)
                                {
                                    SSBGQues = SSBGQues.OrderBy(u => u.SBGTQuesCode.Trim()).ToList();
                                    foreach (SSBGTYPESEntity item in SSBGQues)
                                    {
                                        string Equal = string.Empty; string Gthan = string.Empty, Lthan = string.Empty;
                                        if (item.EligQuestionDesc.Trim() == ColName.Trim())
                                        {
                                            ColName = ColName + " (" + item.SBGT_Name.Trim() + ")";

                                            //if (item.SBGTRespType.Trim() == "N")
                                            //{
                                            //    if (!string.IsNullOrEmpty(item.SBGTNumEqual.ToString().Trim()))
                                            //        Equal = item.SBGTNumEqual.ToString().Trim();
                                            //    if (!string.IsNullOrEmpty(item.SBGTNumGThan.ToString().Trim()))
                                            //        Gthan = item.SBGTNumGThan.ToString().Trim();
                                            //    if (!string.IsNullOrEmpty(item.SBGTNumLThan.ToString().Trim()))
                                            //        Lthan = item.SBGTNumLThan.ToString().Trim();

                                            //    if((!string.IsNullOrEmpty(Lthan) && string.IsNullOrEmpty(Gthan) && string.IsNullOrEmpty(Equal)))
                                            //        ColName=ColName+" 0-"+Lthan.Trim();

                                            //    if ((!string.IsNullOrEmpty(Lthan) && string.IsNullOrEmpty(Gthan) && !string.IsNullOrEmpty(Equal)))
                                            //        ColName = ColName + " 0-" + Lthan.Trim();

                                            //    if ((string.IsNullOrEmpty(Lthan) && !string.IsNullOrEmpty(Gthan) && !string.IsNullOrEmpty(Equal)))
                                            //        ColName = ColName + " " + Gthan.Trim() + "+";

                                            //    if ((!string.IsNullOrEmpty(Lthan) && !string.IsNullOrEmpty(Gthan) && string.IsNullOrEmpty(Equal)))
                                            //        ColName = ColName + " " + Lthan.Trim()+"-"+Gthan.Trim();

                                            //    if ((string.IsNullOrEmpty(Lthan) && !string.IsNullOrEmpty(Gthan) && string.IsNullOrEmpty(Equal)))
                                            //        ColName = ColName + " " + Gthan.Trim()+"+";

                                            //}
                                            break;

                                        }
                                    }

                                }
                                S1 = row.Cells.Add(ColName, DataType.String, "s169");
                            }
                            ColIndex++;
                        }

                        WorksheetCell COL1;
                        if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1")
                        {
                            switch (SelSSBG.SSBGCntArea1_Val.Trim())
                            {
                                case "I": COL1 = row.Cells.Add("Intake Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    row.Cells.Add("Reference Period", DataType.String, "s169"); break;
                                case "Q": COL1 = row.Cells.Add("Intake Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    row.Cells.Add("Reference Period", DataType.String, "s169"); break;
                                case "A":
                                case "B": COL1 = row.Cells.Add("Act Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    row.Cells.Add("Reference Period", DataType.String, "s169"); break;
                                case "C":
                                case "D": COL1 = row.Cells.Add("Contact Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    row.Cells.Add("Reference Period", DataType.String, "s169"); break;
                                case "S":
                                case "T": COL1 = row.Cells.Add("SPM Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    row.Cells.Add("Reference Period", DataType.String, "s169"); break;
                            }
                        }
                        if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1")
                        {
                            switch (SelSSBG.SSBGCntArea2_Val.Trim())
                            {
                                case "I": COL1 = row.Cells.Add("Intake Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    //row.Cells.Add("Reference Period", DataType.String, "HeaderStyle"); 
                                    break;
                                case "Q": COL1 = row.Cells.Add("Intake Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    //row.Cells.Add("Reference Period", DataType.String, "HeaderStyle");
                                    break;
                                case "A":
                                case "B": COL1 = row.Cells.Add("Act Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    //row.Cells.Add("Reference Period", DataType.String, "HeaderStyle");
                                    break;
                                case "C":
                                case "D": COL1 = row.Cells.Add("Contact Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    //row.Cells.Add("Reference Period", DataType.String, "HeaderStyle"); 
                                    break;
                                case "S":
                                case "T": COL1 = row.Cells.Add("SPM Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    //row.Cells.Add("Reference Period", DataType.String, "HeaderStyle"); 
                                    break;

                            }
                        }
                        if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1")
                        {
                            switch (SelSSBG.SSBGCntArea3_Val.Trim())
                            {
                                case "I": COL1 = row.Cells.Add("Intake Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    //row.Cells.Add("Reference Period", DataType.String, "HeaderStyle"); 
                                    break;
                                case "Q": COL1 = row.Cells.Add("Intake Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    //row.Cells.Add("Reference Period", DataType.String, "HeaderStyle"); 
                                    break;
                                case "A":
                                case "B": COL1 = row.Cells.Add("Act Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    //row.Cells.Add("Reference Period", DataType.String, "HeaderStyle"); 
                                    break;
                                case "C":
                                case "D": COL1 = row.Cells.Add("Contact Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    //row.Cells.Add("Reference Period", DataType.String, "HeaderStyle");
                                    break;
                                case "S":
                                case "T": COL1 = row.Cells.Add("SPM Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    //row.Cells.Add("Reference Period", DataType.String, "HeaderStyle");
                                    break;

                            }
                        }
                        if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1")
                        {
                            switch (SelSSBG.SSBGCntArea4_Val.Trim())
                            {
                                case "I": COL1 = row.Cells.Add("Intake Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    row.Cells.Add("Reference Period", DataType.String, "s169"); break;
                                case "Q": COL1 = row.Cells.Add("Intake Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    row.Cells.Add("Reference Period", DataType.String, "s169"); break;
                                case "A":
                                case "B": COL1 = row.Cells.Add("Act Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    row.Cells.Add("Reference Period", DataType.String, "s169"); break;
                                case "C":
                                case "D": COL1 = row.Cells.Add("Contact Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    row.Cells.Add("Reference Period", DataType.String, "s169"); break;
                                case "S":
                                case "T": COL1 = row.Cells.Add("SPM Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    row.Cells.Add("Reference Period", DataType.String, "s169"); break;

                            }
                        }
                        if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1")
                        {
                            switch (SelSSBG.SSBGCntArea5_Val.Trim())
                            {
                                case "I": COL1 = row.Cells.Add("Intake Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    row.Cells.Add("Reference Period", DataType.String, "s169"); break;
                                case "Q": COL1 = row.Cells.Add("Intake Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    row.Cells.Add("Reference Period", DataType.String, "s169"); break;
                                case "A":
                                case "B": COL1 = row.Cells.Add("Act Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    row.Cells.Add("Reference Period", DataType.String, "s169"); break;
                                case "C":
                                case "D": COL1 = row.Cells.Add("Contact Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    row.Cells.Add("Reference Period", DataType.String, "s169"); break;
                                case "S":
                                case "T": COL1 = row.Cells.Add("SPM Date", DataType.String, "s169");
                                    row.Cells.Add("Report Period", DataType.String, "s169");
                                    row.Cells.Add("Reference Period", DataType.String, "s169"); break;

                            }
                        }

                        if (rbGreen.Checked)
                        {
                            DataView dvg = new DataView(T1);
                            dvg.RowFilter = "YeartodateAge='Y' AND YeartodateFederal_OMB='Y'";
                            T1 = dvg.ToTable();
                        }

                        foreach (DataRow dr in T1.Rows)
                        {
                            row = sheet.Table.Rows.Add();
                            WorksheetCell S1;
                            for (int i = 0; i < C; i++)
                            {
                                if (i == 0 || i == 1)
                                    S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "Normal");
                                else if (string.IsNullOrEmpty(dr[i].ToString().Trim()))//else if(dr[i].ToString()=="Y" || dr[i].ToString()=="N")
                                {
                                    //if (i < T1.Columns.Count)
                                    //{
                                    //if (T1.Columns[i].ColumnName.Contains("ReportPeriod"))
                                    //{
                                    //    if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea1_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea2_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea3_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea4_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea5_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //        }
                                    //    }
                                    //}
                                    //else if (T1.Columns[i].ColumnName.Contains("ReferencePeriod"))
                                    //{
                                    //    if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea1_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea2_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea3_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea4_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea5_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalCenter"); break;
                                    //        }
                                    //    }
                                    //}
                                    if (T1.Columns[i + 1].ColumnName.Contains("Yeartodate"))
                                    {
                                        if (dr[i + 1].ToString() == "Y")
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "CenterGreen");
                                        else if (dr[i + 1].ToString() == "N")
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "CenterRed");
                                    }
                                    else if (!T1.Columns[i].ColumnName.Contains("Yeartodate"))
                                    {
                                        if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1")
                                        {
                                            switch (SelSSBG.SSBGCntArea1_Val.Trim())
                                            {
                                                case "A": S1 = row.Cells.Add(dr["ActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["AReportPeriod"].ToString().Trim())) row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["AReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "B": S1 = row.Cells.Add(dr["DupActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ADReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ADReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "C": S1 = row.Cells.Add(dr["ContactDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "D": S1 = row.Cells.Add(dr["DupContDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "I": S1 = row.Cells.Add(dr["IntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "Q": S1 = row.Cells.Add(dr["QIntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["QReportPeriod"].ToString().Trim())) row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["QReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "S": S1 = row.Cells.Add(dr["SPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "T": S1 = row.Cells.Add(dr["DUPSPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                            }
                                        }
                                        if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1")
                                        {
                                            switch (SelSSBG.SSBGCntArea2_Val.Trim())
                                            {
                                                case "A": S1 = row.Cells.Add(dr["ActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["AReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.Number, "NormalRight"); 
                                                    break;
                                                case "B": S1 = row.Cells.Add(dr["DupActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ADReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "C": S1 = row.Cells.Add(dr["ContactDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.Number, "NormalRight"); 
                                                    break;
                                                case "D": S1 = row.Cells.Add(dr["DupContDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CDReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "I": S1 = row.Cells.Add(dr["IntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "Q": S1 = row.Cells.Add(dr["QIntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["QReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "S": S1 = row.Cells.Add(dr["SPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "T": S1 = row.Cells.Add(dr["DUPSPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SDReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                            }
                                        }
                                        if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1")
                                        {
                                            switch (SelSSBG.SSBGCntArea3_Val.Trim())
                                            {
                                                case "A": S1 = row.Cells.Add(dr["ActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["AReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.Number, "NormalRight"); 
                                                    break;
                                                case "B": S1 = row.Cells.Add(dr["DupActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ADReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "C": S1 = row.Cells.Add(dr["ContactDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.Number, "NormalRight"); 
                                                    break;
                                                case "D": S1 = row.Cells.Add(dr["DupContDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CDReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "I": S1 = row.Cells.Add(dr["IntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "Q": S1 = row.Cells.Add(dr["QIntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["QReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "S": S1 = row.Cells.Add(dr["SPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "T": S1 = row.Cells.Add(dr["DUPSPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SDReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                            }
                                        }
                                        if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1")
                                        {
                                            switch (SelSSBG.SSBGCntArea4_Val.Trim())
                                            {
                                                case "A": S1 = row.Cells.Add(dr["ActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["AReportPeriod"].ToString().Trim())) row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["AReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "B": S1 = row.Cells.Add(dr["DupActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ADReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ADReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "C": S1 = row.Cells.Add(dr["ContactDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "D": S1 = row.Cells.Add(dr["DupContDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "I": S1 = row.Cells.Add(dr["IntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "Q": S1 = row.Cells.Add(dr["QIntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["QReportPeriod"].ToString().Trim())) row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["QReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "S": S1 = row.Cells.Add(dr["SPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "T": S1 = row.Cells.Add(dr["DUPSPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                            }
                                        }
                                        if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1")
                                        {
                                            switch (SelSSBG.SSBGCntArea5_Val.Trim())
                                            {
                                                case "A": S1 = row.Cells.Add(dr["ActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["AReportPeriod"].ToString().Trim())) row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["AReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "B": S1 = row.Cells.Add(dr["DupActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ADReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ADReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "C": S1 = row.Cells.Add(dr["ContactDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "D": S1 = row.Cells.Add(dr["DupContDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "I": S1 = row.Cells.Add(dr["IntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "Q": S1 = row.Cells.Add(dr["QIntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["QReportPeriod"].ToString().Trim())) row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["QReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "S": S1 = row.Cells.Add(dr["SPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "T": S1 = row.Cells.Add(dr["DUPSPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                            }
                                        }
                                        i = C;
                                    }

                                    //}
                                }
                                else if (CommonFunctions.IsNumeric(dr[i].ToString()))
                                {
                                    //if (i < T1.Columns.Count)
                                    //{
                                    //if (T1.Columns[i].ColumnName.Contains("Period"))
                                    //{
                                    //    S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "NormalRight");
                                    //}
                                    //if (T1.Columns[i].ColumnName.Contains("ReportPeriod"))
                                    //{
                                    //    if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea1_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea2_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea3_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea4_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea5_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //        }
                                    //    }
                                    //}
                                    //else if (T1.Columns[i].ColumnName.Contains("ReferencePeriod"))
                                    //{
                                    //    if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea1_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea2_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea3_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea4_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea5_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                    //        }
                                    //    }
                                    //}
                                    if (T1.Columns[i + 1].ColumnName.Contains("Yeartodate"))
                                    {
                                        if (dr[i + 1].ToString() == "Y")
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "RightGreen");
                                        else if (dr[i + 1].ToString() == "N")
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "RightRed");
                                    }
                                    else if (!T1.Columns[i].ColumnName.Contains("Yeartodate"))
                                    {
                                        if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1")
                                        {
                                            switch (SelSSBG.SSBGCntArea1_Val.Trim())
                                            {
                                                case "A": S1 = row.Cells.Add(dr["ActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["AReportPeriod"].ToString().Trim())) row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["AReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "B": S1 = row.Cells.Add(dr["DupActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ADReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ADReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "C": S1 = row.Cells.Add(dr["ContactDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "D": S1 = row.Cells.Add(dr["DupContDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "I": S1 = row.Cells.Add(dr["IntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "Q": S1 = row.Cells.Add(dr["QIntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["QReportPeriod"].ToString().Trim())) row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["QReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "S": S1 = row.Cells.Add(dr["SPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "T": S1 = row.Cells.Add(dr["DUPSPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                            }
                                        }
                                        if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1")
                                        {
                                            switch (SelSSBG.SSBGCntArea2_Val.Trim())
                                            {
                                                case "A": S1 = row.Cells.Add(dr["ActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["AReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.Number, "NormalRight"); 
                                                    break;
                                                case "B": S1 = row.Cells.Add(dr["DupActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ADReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "C": S1 = row.Cells.Add(dr["ContactDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.Number, "NormalRight"); 
                                                    break;
                                                case "D": S1 = row.Cells.Add(dr["DupContDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CDReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "I": S1 = row.Cells.Add(dr["IntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "Q": S1 = row.Cells.Add(dr["QIntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["QReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "S": S1 = row.Cells.Add(dr["SPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "T": S1 = row.Cells.Add(dr["DUPSPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SDReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                            }
                                        }
                                        if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1")
                                        {
                                            switch (SelSSBG.SSBGCntArea3_Val.Trim())
                                            {
                                                case "A": S1 = row.Cells.Add(dr["ActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["AReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.Number, "NormalRight"); 
                                                    break;
                                                case "B": S1 = row.Cells.Add(dr["DupActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ADReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "C": S1 = row.Cells.Add(dr["ContactDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.Number, "NormalRight"); 
                                                    break;
                                                case "D": S1 = row.Cells.Add(dr["DupContDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CDReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "I": S1 = row.Cells.Add(dr["IntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "Q": S1 = row.Cells.Add(dr["QIntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["QReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "S": S1 = row.Cells.Add(dr["SPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "T": S1 = row.Cells.Add(dr["DUPSPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SDReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                            }
                                        }
                                        if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1")
                                        {
                                            switch (SelSSBG.SSBGCntArea4_Val.Trim())
                                            {
                                                case "A": S1 = row.Cells.Add(dr["ActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["AReportPeriod"].ToString().Trim())) row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["AReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "B": S1 = row.Cells.Add(dr["DupActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ADReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ADReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "C": S1 = row.Cells.Add(dr["ContactDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "D": S1 = row.Cells.Add(dr["DupContDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "I": S1 = row.Cells.Add(dr["IntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "Q": S1 = row.Cells.Add(dr["QIntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["QReportPeriod"].ToString().Trim())) row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["QReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "S": S1 = row.Cells.Add(dr["SPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "T": S1 = row.Cells.Add(dr["DUPSPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                            }
                                        }
                                        if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1")
                                        {
                                            switch (SelSSBG.SSBGCntArea5_Val.Trim())
                                            {
                                                case "A": S1 = row.Cells.Add(dr["ActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["AReportPeriod"].ToString().Trim())) row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["AReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "B": S1 = row.Cells.Add(dr["DupActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ADReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ADReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "C": S1 = row.Cells.Add(dr["ContactDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "D": S1 = row.Cells.Add(dr["DupContDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "I": S1 = row.Cells.Add(dr["IntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "Q": S1 = row.Cells.Add(dr["QIntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["QReportPeriod"].ToString().Trim())) row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["QReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "S": S1 = row.Cells.Add(dr["SPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "T": S1 = row.Cells.Add(dr["DUPSPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                            }
                                        }
                                        i = C;
                                    }
                                    //}
                                }
                                else if (!CommonFunctions.IsNumeric(dr[i].ToString()))
                                {
                                    //if (i < T1.Columns.Count)
                                    //{
                                    //if (T1.Columns[i].ColumnName.Contains("Period"))
                                    //{
                                    //    S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "Normal");
                                    //}
                                    //if (T1.Columns[i].ColumnName.Contains("ReportPeriod"))
                                    //{
                                    //    if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea1_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea2_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea3_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea4_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea5_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "Normal"); break;
                                    //        }
                                    //    }
                                    //}
                                    //else if (T1.Columns[i].ColumnName.Contains("ReferencePeriod"))
                                    //{
                                    //    if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea1_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea2_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea3_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea4_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //        }
                                    //    }
                                    //    if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1")
                                    //    {
                                    //        switch (SelSSBG.SSBGCntArea5_Val.Trim())
                                    //        {
                                    //            case "A": S1 = row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "B": S1 = row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "C": S1 = row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "D": S1 = row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "I": S1 = row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "Q": S1 = row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "S": S1 = row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //            case "T": S1 = row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "Normal"); break;
                                    //        }
                                    //    }
                                    //}
                                    if (T1.Columns[i + 1].ColumnName.Contains("Yeartodate"))
                                    {
                                        if (dr[i + 1].ToString() == "Y")
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "NormalGreen");
                                        else if (dr[i + 1].ToString() == "N")
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "NormalRed");
                                    }
                                    else if (!T1.Columns[i].ColumnName.Contains("Yeartodate"))
                                    {
                                        if (SelSSBG.SSBGCntArea1_Chk.ToString() == "1")
                                        {
                                            switch (SelSSBG.SSBGCntArea1_Val.Trim())
                                            {
                                                case "A": S1 = row.Cells.Add(dr["ActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["AReportPeriod"].ToString().Trim())) row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["AReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "B": S1 = row.Cells.Add(dr["DupActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ADReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ADReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "C": S1 = row.Cells.Add(dr["ContactDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "D": S1 = row.Cells.Add(dr["DupContDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "I": S1 = row.Cells.Add(dr["IntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "Q": S1 = row.Cells.Add(dr["QIntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["QReportPeriod"].ToString().Trim())) row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["QReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "S": S1 = row.Cells.Add(dr["SPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "T": S1 = row.Cells.Add(dr["DUPSPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                            }
                                        }
                                        if (SelSSBG.SSBGCntArea2_Chk.ToString() == "1")
                                        {
                                            switch (SelSSBG.SSBGCntArea2_Val.Trim())
                                            {
                                                case "A": S1 = row.Cells.Add(dr["ActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["AReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.Number, "NormalRight"); 
                                                    break;
                                                case "B": S1 = row.Cells.Add(dr["DupActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ADReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "C": S1 = row.Cells.Add(dr["ContactDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.Number, "NormalRight"); 
                                                    break;
                                                case "D": S1 = row.Cells.Add(dr["DupContDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CDReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "I": S1 = row.Cells.Add(dr["IntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "Q": S1 = row.Cells.Add(dr["QIntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["QReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "S": S1 = row.Cells.Add(dr["SPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "T": S1 = row.Cells.Add(dr["DUPSPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SDReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                            }
                                        }
                                        if (SelSSBG.SSBGCntArea3_Chk.ToString() == "1")
                                        {
                                            switch (SelSSBG.SSBGCntArea3_Val.Trim())
                                            {
                                                case "A": S1 = row.Cells.Add(dr["ActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["AReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.Number, "NormalRight"); 
                                                    break;
                                                case "B": S1 = row.Cells.Add(dr["DupActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ADReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "C": S1 = row.Cells.Add(dr["ContactDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.Number, "NormalRight"); 
                                                    break;
                                                case "D": S1 = row.Cells.Add(dr["DupContDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CDReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "I": S1 = row.Cells.Add(dr["IntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    // row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "Q": S1 = row.Cells.Add(dr["QIntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["QReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "S": S1 = row.Cells.Add(dr["SPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                                case "T": S1 = row.Cells.Add(dr["DUPSPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SDReportPeriod"].ToString().Trim()))
                                                        row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    //row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    break;
                                            }
                                        }
                                        if (SelSSBG.SSBGCntArea4_Chk.ToString() == "1")
                                        {
                                            switch (SelSSBG.SSBGCntArea4_Val.Trim())
                                            {
                                                case "A": S1 = row.Cells.Add(dr["ActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["AReportPeriod"].ToString().Trim())) row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["AReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "B": S1 = row.Cells.Add(dr["DupActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ADReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ADReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "C": S1 = row.Cells.Add(dr["ContactDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "D": S1 = row.Cells.Add(dr["DupContDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "I": S1 = row.Cells.Add(dr["IntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "Q": S1 = row.Cells.Add(dr["QIntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["QReportPeriod"].ToString().Trim())) row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["QReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "S": S1 = row.Cells.Add(dr["SPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "T": S1 = row.Cells.Add(dr["DUPSPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                            }
                                        }
                                        if (SelSSBG.SSBGCntArea5_Chk.ToString() == "1")
                                        {
                                            switch (SelSSBG.SSBGCntArea5_Val.Trim())
                                            {
                                                case "A": S1 = row.Cells.Add(dr["ActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["AReportPeriod"].ToString().Trim())) row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["AReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["AReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "B": S1 = row.Cells.Add(dr["DupActDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ADReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ADReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ADReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "C": S1 = row.Cells.Add(dr["ContactDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "D": S1 = row.Cells.Add(dr["DupContDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["CDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["CDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["CDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "I": S1 = row.Cells.Add(dr["IntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["ReportPeriod"].ToString().Trim())) row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["ReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["ReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "Q": S1 = row.Cells.Add(dr["QIntakeDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["QReportPeriod"].ToString().Trim())) row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["QReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["QReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "S": S1 = row.Cells.Add(dr["SPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                                case "T": S1 = row.Cells.Add(dr["DUPSPMStartDate"].ToString(), DataType.String, "NormalCenter");
                                                    if (!string.IsNullOrEmpty(dr["SDReportPeriod"].ToString().Trim())) row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReportPeriod"].ToString(), DataType.String, "NormalRight");
                                                    if (!string.IsNullOrEmpty(dr["SDReferencePeriod"].ToString().Trim())) row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.Number, "NormalRight");
                                                    else row.Cells.Add(dr["SDReferencePeriod"].ToString(), DataType.String, "NormalRight"); break;
                                            }
                                        }
                                        i = C;
                                    }
                                    //}
                                }
                            }

                            //WorksheetCell S1 = row.Cells.Add(dr[2].ToString());
                            //S1 = row.Cells.Add(dr[3].ToString());
                            //S1 = row.Cells.Add(dr[4].ToString());
                            //S1 = row.Cells.Add(dr[5].ToString());
                            //S1 = row.Cells.Add(dr[6].ToString());
                            //S1 = row.Cells.Add(dr[7].ToString());
                            //S1 = row.Cells.Add(dr[8].ToString());

                        }
                        T1.Clear();

                        // -----------------------------------------------
                        //  Options
                        // -----------------------------------------------
                        sheet.Options.Selected = true;
                        sheet.Options.FreezePanes = true;
                        sheet.Options.SplitHorizontal = 5;
                        sheet.Options.TopRowBottomPane = 5;
                        sheet.Options.ActivePane = 2;
                        sheet.Options.ProtectObjects = false;
                        sheet.Options.ProtectScenarios = false;

                    }
                }

                #endregion


                #region Demographics
                if (SNPDemoGraphList.Count > 0)
                {
                    sheet = book.Worksheets.Add("Demographics");

                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(150));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));
                    sheet.Table.Columns.Add(new WorksheetColumn(70));


                    string RepMonths = string.Empty;

                    List<string> diffMonths = BuildMothswithYears(dtpFrom.Value.Month, dtpTo.Value.Month, dtpFrom.Value.Year, dtpTo.Value.Year);

                    //var diffMonths = (dtpTo.Value - dtpFrom.Value).Days / 30;
                    //var diffMonths = (dtpTo.Value.Month + dtpTo.Value.Year * 12) - (dtpFrom.Value.Month + dtpFrom.Value.Year * 12);
                    //int diffMonths = Math.Abs(((dtpTo.Value.Year - dtpFrom.Value.Year) * 12) + (dtpTo.Value.Month - dtpFrom.Value.Month));
                    if (diffMonths.Count > 1) RepMonths = "(" + diffMonths.Count + " Months)"; else RepMonths = "(" + diffMonths.Count + " Month)";

                    string DynamicMonth = string.Empty;
                    switch (diffMonths.Count)
                    {
                        case 0:
                        case 1: DynamicMonth = "1 Month"; break;
                        case 2: DynamicMonth = "2 Month"; break;
                        case 3: DynamicMonth = "Quarterly"; break;
                        case 4: DynamicMonth = "4 Month"; break;
                        case 5: DynamicMonth = "5 Month"; break;
                        case 6: DynamicMonth = "Half Yearly"; break;
                        case 7: DynamicMonth = "7 Month"; break;
                        case 8: DynamicMonth = "8 Month"; break;
                        case 9: DynamicMonth = "9 Month"; break;
                        case 10: DynamicMonth = "10 Month"; break;
                        case 11: DynamicMonth = "11 Month"; break;
                        case 12: DynamicMonth = "Yearly"; break;
                    }

                    WorksheetCell cell;

                    WorksheetRow Row0 = sheet.Table.Rows.Add();
                    Row0.Height = 34;
                    Row0.AutoFitHeight = false;
                    
                    cell = Row0.Cells.Add();
                    cell.StyleID = "m2606487017296";
                    cell.Data.Type = DataType.String;
                    cell.Data.Text = "Social Services Block Grant (SSBG) Case Management";
                    cell.MergeAcross = 2;
                    cell = Row0.Cells.Add();
                    cell.StyleID = "s122";
                    cell.Data.Type = DataType.String;
                    cell.Data.Text = "Reporting Period: " + LookupDataAccess.GetMonthNameDate(dtpFrom.Text.ToString()) + " -" + LookupDataAccess.GetMonthNameDate(dtpTo.Text.ToString()) + "  " + RepMonths;
                    cell.MergeAcross = 2;
                    cell = Row0.Cells.Add();
                    cell.StyleID = "m2606487520128";
                    cell.Data.Type = DataType.String;
                    cell.Data.Text = "Date of Reporting: " + DateTime.Now.ToShortDateString();
                    cell.MergeAcross = 1;


                    List<string> GrntMonths = BuildMothswithYears(Convert.ToDateTime(SelSSBG.SSBGGPFrom).Month, Convert.ToDateTime(SelSSBG.SSBGGPTo).Month, Convert.ToDateTime(SelSSBG.SSBGGPFrom).Year, Convert.ToDateTime(SelSSBG.SSBGGPTo).Year);
                    if (GrntMonths.Count > 1) RepMonths = "(" + GrntMonths.Count + " Months)"; else RepMonths = "(" + GrntMonths.Count + " Month)";

                    WorksheetRow Row1 = sheet.Table.Rows.Add();
                    Row1.Height = 34;
                    Row1.AutoFitHeight = false;
                    cell = Row1.Cells.Add();
                    cell.StyleID = "s134";
                    cell.Data.Type = DataType.String;
                    cell.Data.Text = "Agency Name: " + BaseForm.BaseAgencyControlDetails.AgyName.Trim();
                    cell.MergeAcross = 2;
                    cell = Row1.Cells.Add();
                    cell.StyleID = "s134";
                    cell.Data.Type = DataType.String;
                    cell.Data.Text = "Grant Period: " + LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPFrom.ToString()) + " -" + LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPTo.ToString()) + "  " + RepMonths;
                    cell.MergeAcross = 2;
                    cell = Row1.Cells.Add();
                    cell.StyleID = "s134";
                    cell.Data.Type = DataType.String;
                    cell.Data.Text = "Completed by: ";
                    cell.MergeAcross = 1;

                    row = sheet.Table.Rows.Add();
                    row.Height = 47;
                    row.AutoFitHeight = false;

                    cell = row.Cells.Add("", DataType.String, "m2606527900384");
                    cell.MergeAcross = 1;

                    cell = row.Cells.Add("Age", DataType.String, "m2606527900384");
                    cell.MergeAcross = 3;

                    cell = row.Cells.Add("Race", DataType.String, "m2606527900384");
                    cell.MergeAcross = 7;

                    cell = row.Cells.Add("Ethnicity", DataType.String, "m2606527900384");
                    cell.MergeAcross = 2;

                    cell = row.Cells.Add("Sex", DataType.String, "m2606527900384");
                    cell.MergeAcross = 2;

                    row = sheet.Table.Rows.Add();

                    row.Cells.Add("App No", DataType.String, "s169");
                    row.Cells.Add("Name", DataType.String, "s169");
                    row.Cells.Add("Age", DataType.String, "s169");

                    string Agerng1 = string.Empty, Agerng2 = string.Empty;
                    if (txtTo1.Text.Trim() == "999") Agerng1 = "+"; else Agerng1 = "-" + txtTo1.Text.Trim();
                    if (txtTo2.Text.Trim() == "999") Agerng2 = "+"; else Agerng2 = "-" + txtTo2.Text.Trim();
                    row.Cells.Add(txtfrom1.Text.Trim() + Agerng1, DataType.String, "s169"); // "18-59"
                    row.Cells.Add(txtFrom2.Text.Trim() + Agerng2, DataType.String, "s169");

                    row.Cells.Add("Adults Unknown Age", DataType.String, "s169");
                    row.Cells.Add("Race", DataType.String, "s169");
                    row.Cells.Add("American Indian or Alaska Native", DataType.String, "s169");
                    row.Cells.Add("Black or African American", DataType.String, "s169");
                    row.Cells.Add("White", DataType.String, "s169");
                    row.Cells.Add("Asian", DataType.String, "s169");
                    row.Cells.Add("Native Hawalian & Pacific Islander", DataType.String, "s169");
                    row.Cells.Add("Other", DataType.String, "s169");
                    row.Cells.Add("Multi-Race", DataType.String, "s169");
                    row.Cells.Add("Ethnicity", DataType.String, "s169");
                    row.Cells.Add("Hispanic, Latino or Spanish", DataType.String, "s169");
                    row.Cells.Add("Non-Hispanic, Latino or Spanish", DataType.String, "s169");
                    row.Cells.Add("Sex", DataType.String, "s169");
                    row.Cells.Add("Male", DataType.String, "s169");
                    row.Cells.Add("Female", DataType.String, "s169");

                    foreach (CaseSnpEntity Entity in SNPDemoGraphList)
                    {
                        row = sheet.Table.Rows.Add();

                        row.Cells.Add(Entity.App, DataType.String, "Normal");
                        row.Cells.Add(LookupDataAccess.GetMemberName(Entity.NameixFi, Entity.NameixMi, Entity.NameixLast, BaseForm.BaseHierarchyCnFormat), DataType.String, "Normal");
                        row.Cells.Add(Entity.Age, DataType.String, "Normal");
                        if (!string.IsNullOrEmpty(Entity.Age.Trim()))
                        {
                            if (Convert.ToInt32(Entity.Age.Trim()) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(Entity.Age.Trim()) <= Convert.ToInt32(txtTo1.Text.Trim()))
                                row.Cells.Add("Y", DataType.String, "Normal");
                            else row.Cells.Add("N", DataType.String, "Normal");
                        }
                        else row.Cells.Add("N", DataType.String, "Normal");

                        if (!string.IsNullOrEmpty(Entity.Age.Trim()))
                        {
                            if (Convert.ToInt32(Entity.Age.Trim()) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(Entity.Age.Trim()) <= Convert.ToInt32(txtTo2.Text.Trim()))
                                row.Cells.Add("Y", DataType.String, "Normal");
                            else row.Cells.Add("N", DataType.String, "Normal");
                        }
                        else row.Cells.Add("N", DataType.String, "Normal");

                        if (Entity.DobNa == "1")
                            row.Cells.Add("Y", DataType.String, "Normal");
                        else row.Cells.Add("N", DataType.String, "Normal");

                        row.Cells.Add(Entity.Race, DataType.String, "Normal");
                        if (Entity.Race == "01")
                            row.Cells.Add("Y", DataType.String, "Normal");
                        else row.Cells.Add("N", DataType.String, "Normal");
                        if (Entity.Race == "03")
                            row.Cells.Add("Y", DataType.String, "Normal");
                        else row.Cells.Add("N", DataType.String, "Normal");

                        if (Entity.Race == "05")
                            row.Cells.Add("Y", DataType.String, "Normal");
                        else row.Cells.Add("N", DataType.String, "Normal");

                        if (Entity.Race == "02")
                            row.Cells.Add("Y", DataType.String, "Normal");
                        else row.Cells.Add("N", DataType.String, "Normal");

                        if (Entity.Race == "04")
                            row.Cells.Add("Y", DataType.String, "Normal");
                        else row.Cells.Add("N", DataType.String, "Normal");

                        if (Entity.Race == "06")
                            row.Cells.Add("Y", DataType.String, "Normal");
                        else row.Cells.Add("N", DataType.String, "Normal");

                        if (Entity.Race == "07")
                            row.Cells.Add("Y", DataType.String, "Normal");
                        else row.Cells.Add("N", DataType.String, "Normal");

                        row.Cells.Add(Entity.Ethnic, DataType.String, "Normal");
                        if (Entity.Ethnic == "01")
                            row.Cells.Add("Y", DataType.String, "Normal");
                        else row.Cells.Add("N", DataType.String, "Normal");

                        if (Entity.Ethnic == "02")
                            row.Cells.Add("Y", DataType.String, "Normal");
                        else row.Cells.Add("N", DataType.String, "Normal");

                        row.Cells.Add(Entity.Sex, DataType.String, "Normal");
                        if (Entity.Sex == "M")
                            row.Cells.Add("Y", DataType.String, "Normal");
                        else row.Cells.Add("N", DataType.String, "Normal");

                        if (Entity.Sex == "F")
                            row.Cells.Add("Y", DataType.String, "Normal");
                        else row.Cells.Add("N", DataType.String, "Normal");


                    }

                    row = sheet.Table.Rows.Add();
                    row = sheet.Table.Rows.Add();

                    row.Cells.Add("", DataType.String, "Normal");
                    row.Cells.Add("Totals", DataType.String, "NormalLeftBold");
                    row.Cells.Add(SNPDemoGraphList.Count.ToString(), DataType.Number, "NormalRightBold");
                    if (!string.IsNullOrEmpty(txtfrom1.Text.Trim()) || !string.IsNullOrEmpty(txtTo1.Text.Trim()))
                    {
                        int count = SNPDemoGraphList.FindAll(u => Convert.ToInt32(u.Age.Trim()) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age.Trim()) <= Convert.ToInt32(txtTo1.Text.Trim())).Count;
                        row.Cells.Add(count.ToString(), DataType.Number, "NormalRightBold");

                    }
                    else row.Cells.Add("", DataType.String, "NormalRightBold");

                    if (!string.IsNullOrEmpty(txtFrom2.Text.Trim()) || !string.IsNullOrEmpty(txtTo2.Text.Trim()))
                    {
                        int count = SNPDemoGraphList.FindAll(u => Convert.ToInt32(u.Age.Trim()) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age.Trim()) <= Convert.ToInt32(txtTo2.Text.Trim())).Count;
                        row.Cells.Add(count.ToString(), DataType.Number, "NormalRightBold");
                    }
                    else row.Cells.Add("", DataType.String, "NormalRightBold");

                    int DobNacnt = SNPDemoGraphList.FindAll(u => u.DobNa == "1").Count;
                    row.Cells.Add(DobNacnt.ToString(), DataType.Number, "NormalRightBold");

                    int Racecnt = SNPDemoGraphList.FindAll(u => (u.Race == "03" || u.Race == "01" || u.Race == "05" || u.Race == "02" || u.Race == "04" || u.Race == "06" || u.Race == "07")).Count;
                    row.Cells.Add(Racecnt.ToString(), DataType.Number, "NormalRightBold");

                    int Race01cnt = SNPDemoGraphList.FindAll(u => u.Race == "01").Count;
                    row.Cells.Add(Race01cnt.ToString(), DataType.Number, "NormalRightBold");

                    int Race03cnt = SNPDemoGraphList.FindAll(u => u.Race == "03").Count;
                    row.Cells.Add(Race03cnt.ToString(), DataType.Number, "NormalRightBold");
                    
                    int Race05cnt = SNPDemoGraphList.FindAll(u => u.Race == "05").Count;
                    row.Cells.Add(Race05cnt.ToString(), DataType.Number, "NormalRightBold");

                    int Race02cnt = SNPDemoGraphList.FindAll(u => u.Race == "02").Count;
                    row.Cells.Add(Race02cnt.ToString(), DataType.Number, "NormalRightBold");

                    int Race04cnt = SNPDemoGraphList.FindAll(u => u.Race == "04").Count;
                    row.Cells.Add(Race04cnt.ToString(), DataType.Number, "NormalRightBold");

                    int Race06cnt = SNPDemoGraphList.FindAll(u => u.Race == "06").Count;
                    row.Cells.Add(Race06cnt.ToString(), DataType.Number, "NormalRightBold");

                    int Race07cnt = SNPDemoGraphList.FindAll(u => u.Race == "07").Count;
                    row.Cells.Add(Race07cnt.ToString(), DataType.Number, "NormalRightBold");

                    int Ethniccnt = SNPDemoGraphList.FindAll(u => (u.Ethnic == "01" || u.Ethnic=="02")).Count;
                    row.Cells.Add(Ethniccnt.ToString(), DataType.Number, "NormalRightBold");

                    int Ethnic01cnt = SNPDemoGraphList.FindAll(u => u.Ethnic == "01").Count;
                    row.Cells.Add(Ethnic01cnt.ToString(), DataType.Number, "NormalRightBold");

                    int Ethnic02cnt = SNPDemoGraphList.FindAll(u => u.Ethnic == "02").Count;
                    row.Cells.Add(Ethnic02cnt.ToString(), DataType.Number, "NormalRightBold");

                    int Gendercnt = SNPDemoGraphList.FindAll(u => (u.Sex == "M" || u.Sex=="F")).Count;
                    row.Cells.Add(Gendercnt.ToString(), DataType.Number, "NormalRightBold");

                    int Malecnt = SNPDemoGraphList.FindAll(u => u.Sex == "M").Count;
                    row.Cells.Add(Malecnt.ToString(), DataType.Number, "NormalRightBold");

                    int FeMalecnt = SNPDemoGraphList.FindAll(u => u.Sex == "F").Count;
                    row.Cells.Add(FeMalecnt.ToString(), DataType.Number, "NormalRightBold");


                    sheet.Options.Selected = true;
                    sheet.Options.FreezePanes = true;
                    sheet.Options.SplitHorizontal = 4;
                    sheet.Options.TopRowBottomPane = 4;
                    sheet.Options.ActivePane = 2;
                    sheet.Options.ProtectObjects = false;
                    sheet.Options.ProtectScenarios = false;

                }
                #endregion

                FileStream stream = new FileStream(PdfName, FileMode.Create);

                book.Save(stream);
                stream.Close();
            }
        }

        private void PrintHRANBAuditReportObjective(string PdfName, List<SSBGAssnsEntity> SSBGCAMS_List)
        {
            if (ds.Tables.Count > 0)
            {
                PdfName = PdfName + "_AuditGoals.xls";
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                Workbook book = new Workbook();

                WorksheetStyle s16 = book.Styles.Add("s16");
                s16.Font.FontName = "Tahoma";
                s16.Font.Size = 11;
                s16.Font.Color = "#000000";

                WorksheetStyle style11 = book.Styles.Add("HeaderStyles");
                style11.Font.FontName = "Tahoma";
                style11.Font.Size = 10;
                style11.Interior.Color = "Gray";
                style11.Interior.Pattern = StyleInteriorPattern.Solid;
                style11.Font.Bold = true;
                style11.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style11.Alignment.WrapText = true;
                style11.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle Header1 = book.Styles.Add("HeaderColor");
                Header1.Font.FontName = "Tahoma";
                Header1.Font.Size = 10;
                Header1.Interior.Color = "#9999FF";
                Header1.Interior.Pattern = StyleInteriorPattern.Solid;
                Header1.Font.Bold = true;
                Header1.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                Header1.Alignment.WrapText = true;
                Header1.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                Header1.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                Header1.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                Header1.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle style2 = book.Styles.Add("HeaderStyle");
                style2.Font.FontName = "Tahoma";
                style2.Font.Size = 10;
                style2.Font.Bold = true;
                style2.Interior.Color = "Gray";
                style2.Interior.Pattern = StyleInteriorPattern.Solid;
                style2.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style2.Alignment.WrapText = true;
                style2.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle Header2 = book.Styles.Add("FontWhite");
                Header2.Font.FontName = "Tahoma";
                Header2.Font.Size = 10;
                Header2.Font.Bold = true;
                Header2.Font.Color = "White";
                Header2.Interior.Color = "Gray";
                Header2.Interior.Pattern = StyleInteriorPattern.Solid;
                Header2.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                Header2.Alignment.WrapText = true;
                Header2.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                Header2.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                Header2.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                Header2.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle style5 = book.Styles.Add("HeaderStyleRight");
                style5.Font.FontName = "Tahoma";
                style5.Font.Size = 10;
                style5.Font.Bold = true;
                style5.Interior.Color = "Gray";
                style5.Interior.Pattern = StyleInteriorPattern.Solid;
                style5.Alignment.Horizontal = StyleHorizontalAlignment.Right;
                style5.Alignment.WrapText = true;

                WorksheetStyle style1 = book.Styles.Add("Normal");
                style1.Font.FontName = "Tahoma";
                style1.Font.Size = 10;
                style1.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style1.Alignment.WrapText = true;

                WorksheetStyle style3 = book.Styles.Add("NormalRight");
                style3.Font.FontName = "Tahoma";
                style3.Font.Size = 10;
                style3.Alignment.Horizontal = StyleHorizontalAlignment.Right;
                style3.Alignment.WrapText = true;

                WorksheetStyle style4 = book.Styles.Add("NormalCenter");
                style4.Font.FontName = "Tahoma";
                style4.Font.Size = 10;
                style4.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style4.Alignment.WrapText = true;

                WorksheetStyle style8 = book.Styles.Add("CenterGreen");
                style8.Font.FontName = "Tahoma";
                style8.Interior.Color = "Green";
                style8.Interior.Pattern = StyleInteriorPattern.Solid;
                style8.Font.Size = 10;
                style8.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style8.Alignment.WrapText = true;

                WorksheetStyle style9 = book.Styles.Add("CenterRed");
                style9.Font.FontName = "Tahoma";
                style9.Interior.Color = "Red";
                style9.Interior.Pattern = StyleInteriorPattern.Solid;
                style9.Font.Size = 10;
                style9.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style9.Alignment.WrapText = true;

                WorksheetStyle style10 = book.Styles.Add("RightGreen");
                style10.Font.FontName = "Tahoma";
                style10.Interior.Color = "Green";
                style10.Interior.Pattern = StyleInteriorPattern.Solid;
                style10.Font.Size = 10;
                style10.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style10.Alignment.WrapText = true;

                WorksheetStyle style12 = book.Styles.Add("RightRed");
                style12.Font.FontName = "Tahoma";
                style12.Interior.Color = "Red";
                style12.Interior.Pattern = StyleInteriorPattern.Solid;
                style12.Font.Size = 10;
                style12.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style12.Alignment.WrapText = true;

                WorksheetStyle style13 = book.Styles.Add("NormalGreen");
                style13.Font.FontName = "Tahoma";
                style13.Interior.Color = "Green";
                style13.Interior.Pattern = StyleInteriorPattern.Solid;
                style13.Font.Size = 10;
                style13.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style13.Alignment.WrapText = true;

                WorksheetStyle style14 = book.Styles.Add("NormalRed");
                style14.Font.FontName = "Tahoma";
                style14.Interior.Color = "Red";
                style14.Interior.Pattern = StyleInteriorPattern.Solid;
                style14.Font.Size = 10;
                style14.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style14.Alignment.WrapText = true;

                WorksheetStyle style15 = book.Styles.Add("NormalBold");
                style15.Font.FontName = "Tahoma";
                style15.Font.Size = 12;
                style15.Font.Bold = true;
                style15.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style15.Alignment.WrapText = true;

                WorksheetStyle style16 = book.Styles.Add("NormalGray");
                style16.Font.FontName = "Tahoma";
                style16.Interior.Color = "Gray";
                style16.Interior.Pattern = StyleInteriorPattern.Solid;
                style16.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style16.Font.Size = 12;
                style16.Font.Bold = true;
                style16.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style16.Alignment.WrapText = true;

                // -----------------------------------------------
                //  m2606487017296
                // -----------------------------------------------
                WorksheetStyle m2606487017296 = book.Styles.Add("m2606487017296");
                m2606487017296.Font.Bold = true;
                m2606487017296.Font.FontName = "Tahoma";
                m2606487017296.Font.Size = 8;
                m2606487017296.Font.Color = "#333333";
                m2606487017296.Interior.Color = "#DDEBF7";
                m2606487017296.Interior.Pattern = StyleInteriorPattern.Solid;
                m2606487017296.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                m2606487017296.Alignment.Vertical = StyleVerticalAlignment.Center;
                m2606487017296.Alignment.WrapText = true;
                m2606487017296.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
                m2606487017296.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
                m2606487017296.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
                // -----------------------------------------------
                //  s122
                // -----------------------------------------------
                WorksheetStyle s122 = book.Styles.Add("s122");
                s122.Font.Bold = true;
                s122.Font.FontName = "Tahoma";
                s122.Font.Size = 8;
                s122.Font.Color = "#333333";
                s122.Interior.Color = "#DDEBF7";
                s122.Interior.Pattern = StyleInteriorPattern.Solid;
                s122.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                s122.Alignment.Vertical = StyleVerticalAlignment.Center;
                s122.Alignment.WrapText = true;
                s122.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
                // -----------------------------------------------
                //  s134
                // -----------------------------------------------
                WorksheetStyle s134 = book.Styles.Add("s134");
                s134.Font.Bold = true;
                s134.Font.FontName = "Tahoma";
                s134.Font.Size = 8;
                s134.Font.Color = "#333333";
                s134.Interior.Color = "#DDEBF7";
                s134.Interior.Pattern = StyleInteriorPattern.Solid;
                s134.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                s134.Alignment.Vertical = StyleVerticalAlignment.Center;
                s134.Alignment.WrapText = true;
                s134.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
                s134.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
                s134.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
                s134.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
                // -----------------------------------------------
                //  s169
                // -----------------------------------------------
                WorksheetStyle s169 = book.Styles.Add("s169");
                s169.Font.Bold = true;
                s169.Font.FontName = "Tahoma";
                s169.Interior.Color = "#FFFF00";
                s169.Interior.Pattern = StyleInteriorPattern.Solid;
                s169.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                s169.Alignment.Vertical = StyleVerticalAlignment.Bottom;
                s169.Alignment.WrapText = true;
                s169.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                s169.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                s169.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                s169.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
                // -----------------------------------------------
                //  s180
                // -----------------------------------------------
                WorksheetStyle s180 = book.Styles.Add("s180");
                s180.Font.Bold = true;
                s180.Font.FontName = "Tahoma";
                s180.Font.Size = 10;
                s180.Font.Color = "#333333";
                s180.Interior.Color = "#DDEBF7";
                s180.Interior.Pattern = StyleInteriorPattern.Solid;
                s180.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                s180.Alignment.Vertical = StyleVerticalAlignment.Top;
                s180.Alignment.WrapText = true;
                s180.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
                s180.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
                // -----------------------------------------------
                //  s224
                // -----------------------------------------------
                WorksheetStyle s224 = book.Styles.Add("s224");
                s224.Font.Bold = true;
                s224.Font.FontName = "Tahoma";
                s224.Font.Size = 10;
                s224.Font.Color = "#333333";
                s224.Interior.Color = "#DDEBF7";
                s224.Interior.Pattern = StyleInteriorPattern.Solid;
                s224.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                s224.Alignment.Vertical = StyleVerticalAlignment.Bottom;
                s224.Alignment.WrapText = true;
                s224.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
                s224.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
                // -----------------------------------------------
                //  m2606487520128
                // -----------------------------------------------
                WorksheetStyle m2606487520128 = book.Styles.Add("m2606487520128");
                m2606487520128.Font.Bold = true;
                m2606487520128.Font.FontName = "Tahoma";
                m2606487520128.Font.Size = 8;
                m2606487520128.Font.Color = "#333333";
                m2606487520128.Interior.Color = "#DDEBF7";
                m2606487520128.Interior.Pattern = StyleInteriorPattern.Solid;
                m2606487520128.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                m2606487520128.Alignment.Vertical = StyleVerticalAlignment.Center;
                m2606487520128.Alignment.WrapText = true;
                m2606487520128.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
                m2606487520128.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
                m2606487520128.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
                // -----------------------------------------------
                //  m2606487520228
                // -----------------------------------------------
                WorksheetStyle m2606487520228 = book.Styles.Add("m2606487520228");
                m2606487520228.Font.Bold = true;
                m2606487520228.Font.FontName = "Tahoma";
                m2606487520228.Interior.Color = "#FFFFFF";
                m2606487520228.Interior.Pattern = StyleInteriorPattern.Solid;
                m2606487520228.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                m2606487520228.Alignment.Vertical = StyleVerticalAlignment.Bottom;
                m2606487520228.Alignment.WrapText = true;
                m2606487520228.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                m2606487520228.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                m2606487520228.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
                // -----------------------------------------------
                //  m2606527900444
                // -----------------------------------------------
                WorksheetStyle m2606527900444 = book.Styles.Add("m2606527900444");
                m2606527900444.Font.Bold = true;
                m2606527900444.Font.FontName = "Tahoma";
                m2606527900444.Font.Size = 10;
                m2606527900444.Font.Color = "#333333";
                m2606527900444.Interior.Color = "#DDEBF7";
                m2606527900444.Interior.Pattern = StyleInteriorPattern.Solid;
                m2606527900444.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                m2606527900444.Alignment.Vertical = StyleVerticalAlignment.Top;
                m2606527900444.Alignment.WrapText = true;
                m2606527900444.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
                m2606527900444.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
                m2606527900444.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
                // -----------------------------------------------
                //  m2606527900384
                // -----------------------------------------------
                WorksheetStyle m2606527900384 = book.Styles.Add("m2606527900384");
                m2606527900384.Font.Bold = true;
                m2606527900384.Font.FontName = "Tahoma";
                m2606527900384.Interior.Color = "#FFFF00";
                m2606527900384.Interior.Pattern = StyleInteriorPattern.Solid;
                m2606527900384.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                m2606527900384.Alignment.Vertical = StyleVerticalAlignment.Bottom;
                m2606527900384.Alignment.WrapText = true;
                m2606527900384.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                m2606527900384.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                // -----------------------------------------------
                //  m2606487520208
                // -----------------------------------------------
                WorksheetStyle m2606487520208 = book.Styles.Add("m2606487520208");
                m2606487520208.Font.Bold = true;
                m2606487520208.Font.FontName = "Tahoma";
                m2606487520208.Font.Size = 10;
                m2606487520208.Font.Color = "#333333";
                m2606487520208.Interior.Color = "#DDEBF7";
                m2606487520208.Interior.Pattern = StyleInteriorPattern.Solid;
                m2606487520208.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                m2606487520208.Alignment.Vertical = StyleVerticalAlignment.Bottom;
                m2606487520208.Alignment.WrapText = true;
                m2606487520208.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
                m2606487520208.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
                m2606487520208.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);

                Worksheet sheet;
                WorksheetColumn column;
                WorksheetRow row;

                #region HeaderSheet
                sheet = book.Worksheets.Add("Parameters");

                sheet.Table.Columns.Add(new WorksheetColumn(50));
                sheet.Table.Columns.Add(new WorksheetColumn(200));
                sheet.Table.Columns.Add(new WorksheetColumn(250));
                //sheet.Table.Columns.Add(new WorksheetColumn(130));
                //sheet.Table.Columns.Add(new WorksheetColumn(130));
                //sheet.Table.Columns.Add(new WorksheetColumn(130));
                //sheet.Table.Columns.Add(new WorksheetColumn(130));

                row = sheet.Table.Rows.Add();
                row = sheet.Table.Rows.Add();
                row = sheet.Table.Rows.Add();
                WorksheetCell H1 = row.Cells.Add("", DataType.String, "NormalBold");
                H1 = row.Cells.Add(Privileges.Program + " - " + Privileges.PrivilegeName, DataType.String, "NormalGray");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "NormalBold");
                H1 = row.Cells.Add("Run By : " + LookupDataAccess.GetMemberName(BaseForm.UserProfile.FirstName.Trim(), BaseForm.UserProfile.MI.Trim(), BaseForm.UserProfile.LastName.Trim(), "3"), DataType.String, "Normal");
                H1 = row.Cells.Add("Date : " + DateTime.Now.ToString(), DataType.String, "NormalRight");
                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "NormalBold");
                H1 = row.Cells.Add("Selected Report Parameters", DataType.String, "NormalGray");
                H1.MergeAcross = 1;

                string Agy = "Agency : All"; string Dept = "Dept : All"; string Prg = "Program : All"; string Header_year = string.Empty;
                if (Agency != "**") Agy = "Agency : " + Agency;
                if (Depart != "**") Dept = "Dept : " + Depart;
                if (Program != "**") Prg = "Program : " + Program;
                if (CmbYear.Visible == true)
                    Header_year = "Year : " + ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString();

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add(Txt_HieDesc.Text.Trim() + "     " + Header_year, DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add("SSBG Selection :" + ((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Text.ToString().Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                //**H1 = row.Cells.Add(lblReferenceperiodate.Text + "  " + lblreferenceFrom.Text.Trim() + ":" + Ref_From_Date.Text+"    "+lblReferenceTo.Text.Trim()+":"+Ref_To_Date.Text.Trim(), DataType.String, "Normal");
                H1 = row.Cells.Add(lblReferenceperiodate.Text /*+ "  " + lblreferenceFrom.Text.Trim()*/ + ": " + Ref_From_Date.Text + "    " + lblReferenceTo.Text.Trim() + ": " + Ref_To_Date.Text.Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                //**H1 = row.Cells.Add(lblRepDate.Text + "  " + lblRepFrom.Text.Trim() + ":" + dtpFrom.Text + "    " + label6.Text.Trim() + ":" + dtpTo.Text.Trim(), DataType.String, "Normal");
                H1 = row.Cells.Add(lblRepDate.Text /*+ "  " + lblRepFrom.Text.Trim()*/ + ": " + dtpFrom.Text + "    " + label6.Text.Trim() + ": " + dtpTo.Text.Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add(lblDemCount.Text.Trim()+" : " + ((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Text.ToString().Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add(lblAge1.Text.Trim() + " : " + txtfrom1.Text.Trim()+" - "+txtTo1.Text.Trim() + "    " +lblAge2.Text.Trim() + " : " + txtFrom2.Text.Trim() + " - " + txtTo2.Text.Trim(), DataType.String, "Normal");
                H1.MergeAcross = 1;

                string Audit = string.Empty;
                if (rbGreen.Checked) Audit = rbGreen.Text.Trim();
                else if (rbGred.Checked) Audit = rbGred.Text.Trim();

                row = sheet.Table.Rows.Add();
                H1 = row.Cells.Add("", DataType.String, "Normal");
                H1 = row.Cells.Add(label1.Text.Trim() + " : " + Audit, DataType.String, "Normal");
                H1.MergeAcross = 1;

                #endregion





                for (int j = 0; j < dsObj.Tables.Count; j++)
                {
                    if (dsObj.Tables[j].Rows.Count > 0)
                    {
                        //int YeartodtColmns = 0;
                        string GoalCd = dsObj.Tables[j].Rows[0]["GoalCd"].ToString().Trim();
                        string ObjCd = dsObj.Tables[j].Rows[0]["ObjCd"].ToString().Trim();
                        string GoalDesc = dsObj.Tables[j].Rows[0]["Goal"].ToString().Trim();
                        string ObjDesc = dsObj.Tables[j].Rows[0]["Objective"].ToString().Trim();
                        string CountType = string.Empty, CountType2 = string.Empty;
                        if (dsObj.Tables[j].Rows[0]["Type"].ToString().Trim() == "A") CountType = "All CA MS completed";
                        else if (dsObj.Tables[j].Rows[0]["Type"].ToString().Trim() == "N") CountType = "Any one CA MS";
                        else if (dsObj.Tables[j].Rows[0]["Type"].ToString().Trim() == "1") CountType = "Greater than 1 CA MS";
                        else if (dsObj.Tables[j].Rows[0]["Type"].ToString().Trim() == "2") CountType = "Greater than 2";
                        else if (dsObj.Tables[j].Rows[0]["Type"].ToString().Trim() == "S") CountType = "Service Plan Start Date";
                        else if (dsObj.Tables[j].Rows[0]["Type"].ToString().Trim() == "C") CountType = "Actual Completion Date";

                        if (dsObj.Tables[j].Rows[0]["Type2"].ToString().Trim() == "A") CountType2 = "All CA MS completed";
                        else if (dsObj.Tables[j].Rows[0]["Type2"].ToString().Trim() == "N") CountType2 = "Any one CA MS";
                        else if (dsObj.Tables[j].Rows[0]["Type2"].ToString().Trim() == "1") CountType2 = "Greater than 1 CA MS";
                        else if (dsObj.Tables[j].Rows[0]["Type2"].ToString().Trim() == "2") CountType2 = "Greater than 2";
                        else if (dsObj.Tables[j].Rows[0]["Type2"].ToString().Trim() == "S") CountType2 = "Service Plan Start Date";
                        else if (dsObj.Tables[j].Rows[0]["Type2"].ToString().Trim() == "C") CountType2 = "Actual Completion Date";

                        sheet = book.Worksheets.Add(GoalCd+"-"+ObjCd.ToString());
                        //sheet.Table.DefaultRowHeight = 14.25F;
                        DataTable dt1 = dsObj.Tables[j];
                        DataTable T1 = dt1.Copy();
                        T1.Columns.Remove("GoalCd");
                        T1.Columns.Remove("ObjCd");
                        T1.Columns.Remove("Goal");
                        T1.Columns.Remove("Objective");
                        T1.Columns.Remove("Type");
                        T1.Columns.Remove("Type2");
                        int SplCol = 0; int colcnt = 0;
                        foreach (DataColumn dc in T1.Columns)
                        {
                            if (dc.ColumnName.Equals("Access")) colcnt = SplCol;
                            SplCol++;
                        }

                        int Columns = T1.Columns.Count;//ds.Tables[0].Columns.Count - 3;

                        if (Columns > 0)
                        {
                            
                            sheet.Table.StyleID = "s16";
                            for (int c = 0; c < Columns; c++)
                            {
                                column = sheet.Table.Columns.Add();
                                if (c == 0) column.Width = 88;
                                else if (c == 1) column.Width = 150;
                                else if (c >= colcnt) column.Width = 88;
                                else column.Width = 200;
                            }
                        }

                        string RepMonths = string.Empty;

                        List<string> diffMonths = BuildMothswithYears(dtpFrom.Value.Month, dtpTo.Value.Month, dtpFrom.Value.Year, dtpTo.Value.Year);

                        //var diffMonths = (dtpTo.Value - dtpFrom.Value).Days / 30;
                        //var diffMonths = (dtpTo.Value.Month + dtpTo.Value.Year * 12) - (dtpFrom.Value.Month + dtpFrom.Value.Year * 12);
                        //int diffMonths = Math.Abs(((dtpTo.Value.Year - dtpFrom.Value.Year) * 12) + (dtpTo.Value.Month - dtpFrom.Value.Month));
                        if (diffMonths.Count > 1) RepMonths = "(" + diffMonths.Count + " Months)"; else RepMonths = "(" + diffMonths.Count + " Month)";

                        string DynamicMonth = string.Empty;
                        switch (diffMonths.Count)
                        {
                            case 0:
                            case 1: DynamicMonth = "1 Month"; break;
                            case 2: DynamicMonth = "2 Month"; break;
                            case 3: DynamicMonth = "Quarterly"; break;
                            case 4: DynamicMonth = "4 Month"; break;
                            case 5: DynamicMonth = "5 Month"; break;
                            case 6: DynamicMonth = "Half Yearly"; break;
                            case 7: DynamicMonth = "7 Month"; break;
                            case 8: DynamicMonth = "8 Month"; break;
                            case 9: DynamicMonth = "9 Month"; break;
                            case 10: DynamicMonth = "10 Month"; break;
                            case 11: DynamicMonth = "11 Month"; break;
                            case 12: DynamicMonth = "Yearly"; break;
                        }


                        WorksheetRow Row0 = sheet.Table.Rows.Add();
                        Row0.Height = 34;
                        Row0.AutoFitHeight = false;
                        WorksheetCell cell;
                        cell = Row0.Cells.Add();
                        cell.StyleID = "m2606487017296";
                        cell.Data.Type = DataType.String;
                        cell.Data.Text = "Social Services Block Grant (SSBG) Case Management";
                        cell.MergeAcross = 2;
                        cell = Row0.Cells.Add();
                        cell.StyleID = "s122";
                        cell.Data.Type = DataType.String;
                        cell.Data.Text = "Reporting Period: " + LookupDataAccess.GetMonthNameDate(dtpFrom.Text.ToString()) + " -" + LookupDataAccess.GetMonthNameDate(dtpTo.Text.ToString()) + "  " + RepMonths;
                        cell.MergeAcross = 2;
                        cell = Row0.Cells.Add();
                        cell.StyleID = "m2606487520128";
                        cell.Data.Type = DataType.String;
                        cell.Data.Text = "Date of Reporting: " + DateTime.Now.ToShortDateString();
                        cell.MergeAcross = 1;
                        // -----------------------------------------------

                        SSBGPARAMEntity SelSSBG = new SSBGPARAMEntity();
                        SelSSBG = SSBGParamall.Find(u => ((u.SSBGSeq).Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString())));

                        List<string> GrntMonths = BuildMothswithYears(Convert.ToDateTime(SelSSBG.SSBGGPFrom).Month, Convert.ToDateTime(SelSSBG.SSBGGPTo).Month, Convert.ToDateTime(SelSSBG.SSBGGPFrom).Year, Convert.ToDateTime(SelSSBG.SSBGGPTo).Year);
                        //var GrntMonths = (Convert.ToDateTime(SelSSBG.SSBGGPTo) - Convert.ToDateTime(SelSSBG.SSBGGPFrom)).Days / 30;
                        if (GrntMonths.Count > 1) RepMonths = "(" + GrntMonths.Count + " Months)"; else RepMonths = "(" + GrntMonths.Count + " Month)";

                        WorksheetRow Row1 = sheet.Table.Rows.Add();
                        Row1.Height = 34;
                        Row1.AutoFitHeight = false;
                        cell = Row1.Cells.Add();
                        cell.StyleID = "s134";
                        cell.Data.Type = DataType.String;
                        cell.Data.Text = "Agency Name: " + BaseForm.BaseAgencyControlDetails.AgyName.Trim();
                        cell.MergeAcross = 2;
                        cell = Row1.Cells.Add();
                        cell.StyleID = "s134";
                        cell.Data.Type = DataType.String;
                        cell.Data.Text = "Grant Period: " + LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPFrom.ToString()) + " -" + LookupDataAccess.GetMonthNameDate(SelSSBG.SSBGGPTo.ToString()) + "  " + RepMonths;
                        cell.MergeAcross = 2;
                        cell = Row1.Cells.Add();
                        cell.StyleID = "s134";
                        cell.Data.Type = DataType.String;
                        cell.Data.Text = "Completed by: ";
                        cell.MergeAcross = 1;
                        
                        row = sheet.Table.Rows.Add();
                        row.Height = 35;
                        row.AutoFitHeight = false;

                        cell = row.Cells.Add(GoalDesc, DataType.String, "m2606527900384");
                        cell.MergeAcross = Columns - 1;

                        row = sheet.Table.Rows.Add();
                        row.Height = 60;
                        row.AutoFitHeight = false;

                        cell = row.Cells.Add(ObjDesc, DataType.String, "m2606487520228");
                        cell.MergeAcross = Columns - 5;
                        //cell.MergeDown = 1;

                        //if (CountType == "Service Plan Master Date") CountType = "Service Plan Start Date";
                        //if (CountType2 == "Service Plan Master Date") CountType2 = "Service Plan Start Date";
                        //if (CountType == "Service Plan Master Complete Date") CountType = "Actual Complete Date";
                        //if (CountType2 == "Service Plan Master Complete Date") CountType2 = "Actual Complete Date";

                        cell = row.Cells.Add(CountType, DataType.String, "s180");
                        cell.MergeAcross = 1;
                        cell = row.Cells.Add(CountType2, DataType.String, "m2606527900444");
                        cell.MergeAcross = 1;

                        // -----------------------------------------------
                        row = sheet.Table.Rows.Add();
                        //row.Height = 27;
                        row.AutoFitHeight = false;

                        cell = row.Cells.Add("", DataType.String, "m2606487520228");
                        cell.MergeAcross = Columns - 5; 



                        cell = row.Cells.Add();
                        cell.StyleID = "s224";
                        cell.Data.Type = DataType.String;
                        if (CountType == "Service Plan Start Date") cell.Data.Text = "Seeking Objective";
                        else if (CountType == "Actual Completion Date") cell.Data.Text = "Obtained Objective";
                        else cell.Data.Text = "Obtained Objective";
                        //cell.Index = 4;
                        cell.MergeAcross = 1;
                        cell = row.Cells.Add();
                        cell.StyleID = "m2606487520208";
                        cell.Data.Type = DataType.String;
                        if (CountType2 == "Service Plan Start Date") cell.Data.Text = "Seeking Objective";
                        else if (CountType2 == "Actual Completion Date") cell.Data.Text = "Obtained Objective";
                        else cell.Data.Text = "Seeking Objective";
                        cell.MergeAcross = 1;

                        //int dcCount = 0;
                        row = sheet.Table.Rows.Add();

                        foreach (DataColumn dc in T1.Columns)
                        {
                            string ColName = string.Empty;
                            //if (dc.ColumnName.Contains("ByPass")) ColName = "Report Period";
                            //else if (dc.ColumnName.Contains("Yeartodate")) ColName = "Reference Period";
                            //else 
                            string CAMS = string.Empty;
                            if (SSBGCAMS_List.FindAll(u => u.SBAS_CAMS_Code.Equals(dc.ColumnName.Trim())).Count > 0)
                            {
                                SSBGAssnsEntity SelCAMS = SSBGCAMS_List.Find(u => u.SBAS_CAMS_Code.Equals(dc.ColumnName.Trim()));
                                if (SelCAMS != null)
                                    ColName = SelCAMS.CAMS_DESC.Trim() + " (" + SelCAMS.SBAS_CAMS_Type.Trim() + ")";
                                //ColName = SSBGCAMS_List.Find(u => u.SBAS_CAMS_Code.Equals(dc.ColumnName.Trim())).CAMS_DESC.Trim();
                            }
                            if (dsObj.Tables[j].Rows[0]["Type"].ToString().Trim() == "S" || dsObj.Tables[j].Rows[0]["Type"].ToString().Trim() == "C")
                            {
                                if (SSBGSerPlans.FindAll(u => u.SBSPSerPlan.Equals(dc.ColumnName.Trim())).Count > 0)
                                {
                                    SSBGSerPlanEntity SelSP = SSBGSerPlans.Find(u => u.SBSPSerPlan.Equals(dc.ColumnName.Trim()));
                                    if (SelSP != null)
                                        ColName = SelSP.SBSPSPName.Trim();
                                }
                            }

                            if (string.IsNullOrEmpty(ColName.Trim()))
                                ColName = dc.ColumnName.Trim();

                            //if (ColName == "Seek") ColName = dc.ColumnName.Trim() + " (" + dtpFrom.Text.ToString() + " - " + dtpTo.Text.ToString() + ")";
                            //if (ColName == "Access") ColName = dc.ColumnName.Trim() + " (" + dtpFrom.Text.ToString() + " - " + dtpTo.Text.ToString() + ")";
                            //if (ColName == "YeartoDate") ColName = dc.ColumnName.Trim() + " (" + Ref_From_Date.Text.ToString() + " - " + Ref_To_Date.Text.ToString() + ")";

                            if (ColName == "Access") ColName = DynamicMonth+ " #";
                            if (ColName.Contains("YeartoDate")) ColName =  "YTD #";
                            if (ColName == "Seek") ColName = DynamicMonth + " #";
                            //if (ColName == "YeartoDate") ColName = "YTD #";

                            WorksheetCell S1;
                            //if(CAMS=="MS")
                            //    S1 = row.Cells.Add(ColName, DataType.String, "FontWhite");
                            //else
                            S1 = row.Cells.Add(ColName, DataType.String, "s169");

                        }

                        if (rbGreen.Checked)
                        {
                            DataView dvg = new DataView(T1);
                            dvg.RowFilter = "CONVERT(Isnull(Seek,''), System.String) <> '' OR CONVERT(Isnull(Access,''), System.String) <> '' OR CONVERT(Isnull(YeartoDate,''), System.String) <> '' OR CONVERT(Isnull(YeartoDateSeek,''), System.String) <> ''";
                            //dvg.RowFilter = "Seek!='' OR Access!='' OR YeartoDate!='' OR YeartoDateSeek!=''";
                            T1 = dvg.ToTable();
                        }

                        if(CountType== "Service Plan Start Date" )
                            ProcessDataTable(T1, CountType, CountType2);


                        foreach (DataRow dr in T1.Rows)
                        {
                            row = sheet.Table.Rows.Add();
                            WorksheetCell S1;
                            for (int i = 0; i < Columns; i++)
                            {
                                if (i == 0 || i == 1)
                                    S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "Normal");
                                else if (string.IsNullOrEmpty(dr[i].ToString().Trim()))
                                {
                                    if (T1.Columns[i].ColumnName.Equals("Seek") || T1.Columns[i].ColumnName.Equals("Access") || T1.Columns[i].ColumnName.Equals("YeartoDate") || T1.Columns[i].ColumnName.Equals("YeartoDateSeek"))
                                        S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "NormalCenter");
                                    else
                                        S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "NormalRed");
                                }
                                else if (CommonFunctions.IsNumeric(dr[i].ToString()))
                                {
                                    if (!string.IsNullOrEmpty(dr[i].ToString()))
                                    {
                                        if (T1.Columns[i].ColumnName.Equals("Seek") || T1.Columns[i].ColumnName.Equals("Access") || T1.Columns[i].ColumnName.Equals("YeartoDate") || T1.Columns[i].ColumnName.Equals("YeartoDateSeek"))
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "NormalRight");
                                        else
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "RightGreen");
                                    }
                                    else
                                    {
                                        if (T1.Columns[i].ColumnName.Equals("Seek") || T1.Columns[i].ColumnName.Equals("Access") || T1.Columns[i].ColumnName.Equals("YeartoDate") || T1.Columns[i].ColumnName.Equals("YeartoDateSeek"))
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "NormalRight");
                                        else
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "RightRed");
                                    }

                                }
                                else if (!CommonFunctions.IsNumeric(dr[i].ToString()))
                                {
                                    if (!string.IsNullOrEmpty(dr[i].ToString()))
                                    {
                                        if (T1.Columns[i].ColumnName.Equals("Seek") || T1.Columns[i].ColumnName.Equals("Access") || T1.Columns[i].ColumnName.Equals("YeartoDate") || T1.Columns[i].ColumnName.Equals("YeartoDateSeek"))
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "Normal");
                                        else
                                        {
                                            if (!string.IsNullOrEmpty(dr["Seek"].ToString()) || !string.IsNullOrEmpty(dr["Access"].ToString()) || !string.IsNullOrEmpty(dr["YeartoDate"].ToString()) || !string.IsNullOrEmpty(dr["YeartoDateSeek"].ToString()))
                                                S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "NormalGreen");
                                            else
                                                S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "NormalRed");
                                        }
                                    }
                                    else
                                    {
                                        if (T1.Columns[i].ColumnName.Equals("Seek") || T1.Columns[i].ColumnName.Equals("Access") || T1.Columns[i].ColumnName.Equals("YeartoDate") || T1.Columns[i].ColumnName.Equals("YeartoDateSeek"))
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "Normal");
                                        else
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "NormalRed");
                                    }
                                }
                            }

                        }
                        T1.Clear();

                        sheet.Options.Selected = true;
                        sheet.Options.FreezePanes = true;
                        sheet.Options.SplitHorizontal = 6;
                        sheet.Options.TopRowBottomPane = 6;
                        sheet.Options.ActivePane = 2;
                        sheet.Options.ProtectObjects = false;
                        sheet.Options.ProtectScenarios = false;
                    }
                }


                FileStream stream = new FileStream(PdfName, FileMode.Create);

                book.Save(stream);
                stream.Close();
            }
        }

        private void ProcessDataTable(DataTable dt,string Type1,string Type2)
        {
            //foreach(DataColumn column in dt.Columns)
            //{

            //}
            //Setting Column Orders
            for (int i = 0; i < dt.Columns.Count; i++)
            {
                //if (i == 0) dt.Columns["AppNo"].SetOrdinal(0);
                //if (i == 1) dt.Columns["Name"].SetOrdinal(1);
                //if (i == 2) dt.Columns[i].SetOrdinal(2);
                if(dt.Columns[i].ColumnName != "Access")
                    dt.Columns[i].SetOrdinal(i);
                if (dt.Columns[i].ColumnName=="Access")
                {
                    if (Type1 == "Service Plan Start Date")
                    {
                        dt.Columns["Seek"].SetOrdinal(i);
                        dt.Columns["YeartoDateSeek"].SetOrdinal(i+1);
                        dt.Columns["Access"].SetOrdinal(i+2);
                        dt.Columns["YeartoDate"].SetOrdinal(i+3);
                        break;
                    }
                    else
                    {
                        dt.Columns["Access"].SetOrdinal(i);
                        dt.Columns["YeartoDate"].SetOrdinal(i+1);
                        dt.Columns["Seek"].SetOrdinal(i+2);
                        dt.Columns["YeartoDateSeek"].SetOrdinal(i+3);
                        break;
                    }
                }

                //if(Type1== "Service Plan Start Date")
                //{
                //    dt.Columns["Seek"].SetOrdinal(3);
                //    dt.Columns["YeartoDateSeek"].SetOrdinal(4);
                //    dt.Columns["Access"].SetOrdinal(5);
                //    dt.Columns["YeartoDate"].SetOrdinal(6);
                //}
                //else
                //{
                //    dt.Columns["Access"].SetOrdinal(3);
                //    dt.Columns["YeartoDate"].SetOrdinal(4);
                //    dt.Columns["Seek"].SetOrdinal(5);
                //    dt.Columns["YeartoDateSeek"].SetOrdinal(6);
                //}
                

            }

           
        }

        private void PrintAuditReportObjective(string PdfName, List<SSBGAssnsEntity> SSBGCAMS_List)
        {
            if (ds.Tables.Count > 0)
            {
                PdfName = PdfName + "_AuditGoals.xls";
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                Workbook book = new Workbook();

                WorksheetStyle s16 = book.Styles.Add("s16");
                s16.Font.FontName = "Tahoma";
                s16.Font.Size = 11;
                s16.Font.Color = "#000000";

                WorksheetStyle style11 = book.Styles.Add("HeaderStyles");
                style11.Font.FontName = "Tahoma";
                style11.Font.Size = 10;
                style11.Interior.Color = "Gray";
                style11.Interior.Pattern = StyleInteriorPattern.Solid;
                style11.Font.Bold = true;
                style11.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style11.Alignment.WrapText = true;
                style11.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                style11.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle Header1 = book.Styles.Add("HeaderColor");
                Header1.Font.FontName = "Tahoma";
                Header1.Font.Size = 10;
                Header1.Interior.Color = "#9999FF";
                Header1.Interior.Pattern = StyleInteriorPattern.Solid;
                Header1.Font.Bold = true;
                Header1.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                Header1.Alignment.WrapText = true;
                Header1.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                Header1.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                Header1.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                Header1.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle style2 = book.Styles.Add("HeaderStyle");
                style2.Font.FontName = "Tahoma";
                style2.Font.Size = 10;
                style2.Font.Bold = true;
                style2.Interior.Color = "Gray";
                style2.Interior.Pattern = StyleInteriorPattern.Solid;
                style2.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style2.Alignment.WrapText = true;
                style2.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                style2.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle Header2 = book.Styles.Add("FontWhite");
                Header2.Font.FontName = "Tahoma";
                Header2.Font.Size = 10;
                Header2.Font.Bold = true;
                Header2.Font.Color = "White";
                Header2.Interior.Color = "Gray";
                Header2.Interior.Pattern = StyleInteriorPattern.Solid;
                Header2.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                Header2.Alignment.WrapText = true;
                Header2.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
                Header2.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
                Header2.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
                Header2.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);

                WorksheetStyle style5 = book.Styles.Add("HeaderStyleRight");
                style5.Font.FontName = "Tahoma";
                style5.Font.Size = 10;
                style5.Font.Bold = true;
                style5.Interior.Color = "Gray";
                style5.Interior.Pattern = StyleInteriorPattern.Solid;
                style5.Alignment.Horizontal = StyleHorizontalAlignment.Right;
                style5.Alignment.WrapText = true;

                WorksheetStyle style1 = book.Styles.Add("Normal");
                style1.Font.FontName = "Tahoma";
                style1.Font.Size = 10;
                style1.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style1.Alignment.WrapText = true;

                WorksheetStyle style3 = book.Styles.Add("NormalRight");
                style3.Font.FontName = "Tahoma";
                style3.Font.Size = 10;
                style3.Alignment.Horizontal = StyleHorizontalAlignment.Right;
                style3.Alignment.WrapText = true;

                WorksheetStyle style4 = book.Styles.Add("NormalCenter");
                style4.Font.FontName = "Tahoma";
                style4.Font.Size = 10;
                style4.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style4.Alignment.WrapText = true;

                WorksheetStyle style8 = book.Styles.Add("CenterGreen");
                style8.Font.FontName = "Tahoma";
                style8.Interior.Color = "Green";
                style8.Interior.Pattern = StyleInteriorPattern.Solid;
                style8.Font.Size = 10;
                style8.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style8.Alignment.WrapText = true;

                WorksheetStyle style9 = book.Styles.Add("CenterRed");
                style9.Font.FontName = "Tahoma";
                style9.Interior.Color = "Red";
                style9.Interior.Pattern = StyleInteriorPattern.Solid;
                style9.Font.Size = 10;
                style9.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style9.Alignment.WrapText = true;

                WorksheetStyle style10 = book.Styles.Add("RightGreen");
                style10.Font.FontName = "Tahoma";
                style10.Interior.Color = "Green";
                style10.Interior.Pattern = StyleInteriorPattern.Solid;
                style10.Font.Size = 10;
                style10.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style10.Alignment.WrapText = true;

                WorksheetStyle style12 = book.Styles.Add("RightRed");
                style12.Font.FontName = "Tahoma";
                style12.Interior.Color = "Red";
                style12.Interior.Pattern = StyleInteriorPattern.Solid;
                style12.Font.Size = 10;
                style12.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style12.Alignment.WrapText = true;

                WorksheetStyle style13 = book.Styles.Add("NormalGreen");
                style13.Font.FontName = "Tahoma";
                style13.Interior.Color = "Green";
                style13.Interior.Pattern = StyleInteriorPattern.Solid;
                style13.Font.Size = 10;
                style13.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style13.Alignment.WrapText = true;

                WorksheetStyle style14 = book.Styles.Add("NormalRed");
                style14.Font.FontName = "Tahoma";
                style14.Interior.Color = "Red";
                style14.Interior.Pattern = StyleInteriorPattern.Solid;
                style14.Font.Size = 10;
                style14.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style14.Alignment.WrapText = true;

                Worksheet sheet;
                for (int j = 0; j < dsObj.Tables.Count; j++)
                {
                    if (dsObj.Tables[j].Rows.Count > 0)
                    {
                        //int YeartodtColmns = 0;
                        string GoalDesc = dsObj.Tables[j].Rows[0]["Goal"].ToString().Trim();
                        string ObjDesc = dsObj.Tables[j].Rows[0]["Objective"].ToString().Trim();
                        string CountType = string.Empty;
                        if (dsObj.Tables[j].Rows[0]["Type"].ToString().Trim() == "A") CountType = "All CA MS completed";
                        else if (dsObj.Tables[j].Rows[0]["Type"].ToString().Trim() == "N") CountType = "Any one CA MS";
                        else if (dsObj.Tables[j].Rows[0]["Type"].ToString().Trim() == "1") CountType = "Greater than 1 CA MS";
                        else if (dsObj.Tables[j].Rows[0]["Type"].ToString().Trim() == "2") CountType = "Greater than 2";
                        else if (dsObj.Tables[j].Rows[0]["Type"].ToString().Trim() == "S") CountType = "Service Plan Start Date";
                        else if (dsObj.Tables[j].Rows[0]["Type"].ToString().Trim() == "C") CountType = "Actual Completion Date";
                
                        sheet = book.Worksheets.Add(j.ToString());
                        //sheet.Table.DefaultRowHeight = 14.25F;
                        DataTable dt1 = dsObj.Tables[j];
                        DataTable T1 = dt1.Copy();
                        T1.Columns.Remove("Goal");
                        T1.Columns.Remove("Objective");
                        T1.Columns.Remove("Type");
                        int SplCol = 0; int colcnt = 0;
                        foreach (DataColumn dc in T1.Columns)
                        {
                            if (dc.ColumnName.Equals("Seek")) colcnt=SplCol;
                            SplCol++;
                        }

                        int Columns = T1.Columns.Count;//ds.Tables[0].Columns.Count - 3;

                        if (Columns > 0)
                        {
                            WorksheetColumn column;
                            sheet.Table.StyleID = "s16";
                            for (int c = 0; c < Columns; c++)
                            {
                                column = sheet.Table.Columns.Add();
                                if (c == 0) column.Width = 88;
                                else if (c == 1) column.Width = 150;
                                else if (c >= colcnt) column.Width = 88;
                                else column.Width = 200;
                            }
                        }

                        WorksheetRow row = sheet.Table.Rows.Add();
                        row.Height = 35;
                        row.AutoFitHeight = false;

                        WorksheetCell cell = row.Cells.Add(GoalDesc, DataType.String, "HeaderStyles");
                        cell.MergeAcross = Columns - 1;

                        row = sheet.Table.Rows.Add();
                        row.Height = 35;
                        row.AutoFitHeight = false;

                        cell = row.Cells.Add(ObjDesc, DataType.String, "HeaderStyles");
                        cell.MergeAcross = Columns - 2;

                        cell = row.Cells.Add(CountType, DataType.String, "HeaderColor");

                        //int dcCount = 0;
                        row = sheet.Table.Rows.Add();
                        foreach (DataColumn dc in T1.Columns)
                        {
                            string ColName = string.Empty;
                            //if (dc.ColumnName.Contains("ByPass")) ColName = "Report Period";
                            //else if (dc.ColumnName.Contains("Yeartodate")) ColName = "Reference Period";
                            //else 
                            string CAMS = string.Empty;
                            if (SSBGCAMS_List.FindAll(u => u.SBAS_CAMS_Code.Equals(dc.ColumnName.Trim())).Count > 0)
                            {
                                SSBGAssnsEntity SelCAMS = SSBGCAMS_List.Find(u => u.SBAS_CAMS_Code.Equals(dc.ColumnName.Trim()));
                                if (SelCAMS != null)
                                    ColName = SelCAMS.CAMS_DESC.Trim() + " (" + SelCAMS.SBAS_CAMS_Type.Trim() + ")";
                                //ColName = SSBGCAMS_List.Find(u => u.SBAS_CAMS_Code.Equals(dc.ColumnName.Trim())).CAMS_DESC.Trim();
                            }

                            if(string.IsNullOrEmpty(ColName.Trim()))
                                ColName = dc.ColumnName.Trim();

                            //if (ColName == "Seek") ColName = dc.ColumnName.Trim() + " (" + dtpFrom.Text.ToString() + " - " + dtpTo.Text.ToString() + ")";
                            //if (ColName == "Access") ColName = dc.ColumnName.Trim() + " (" + dtpFrom.Text.ToString() + " - " + dtpTo.Text.ToString() + ")";
                            //if (ColName == "YeartoDate") ColName = dc.ColumnName.Trim() + " (" + Ref_From_Date.Text.ToString() + " - " + Ref_To_Date.Text.ToString() + ")";

                            WorksheetCell S1;
                            //if(CAMS=="MS")
                            //    S1 = row.Cells.Add(ColName, DataType.String, "FontWhite");
                            //else
                                S1 = row.Cells.Add(ColName, DataType.String, "HeaderStyle");

                        }

                        foreach (DataRow dr in T1.Rows)
                        {
                            row = sheet.Table.Rows.Add();
                            WorksheetCell S1;
                            for (int i = 0; i < Columns; i++)
                            {
                                if (i == 0 || i == 1)
                                    S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "Normal");
                                else if (string.IsNullOrEmpty(dr[i].ToString().Trim()))
                                {
                                    if (T1.Columns[i].ColumnName.Equals("Seek") || T1.Columns[i].ColumnName.Equals("Access") || T1.Columns[i].ColumnName.Equals("YeartoDate"))
                                        S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "NormalCenter");
                                    else
                                        S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "NormalRed");
                                }
                                else if (CommonFunctions.IsNumeric(dr[i].ToString()))
                                {
                                    if (!string.IsNullOrEmpty(dr[i].ToString()))
                                    {
                                        if (T1.Columns[i].ColumnName.Equals("Seek") || T1.Columns[i].ColumnName.Equals("Access") || T1.Columns[i].ColumnName.Equals("YeartoDate"))
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "NormalRight");
                                        else
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "RightGreen");
                                    }
                                    else
                                    {
                                        if (T1.Columns[i].ColumnName.Equals("Seek") || T1.Columns[i].ColumnName.Equals("Access") || T1.Columns[i].ColumnName.Equals("YeartoDate"))
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "NormalRight");
                                        else
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "RightRed");
                                    }

                                }
                                else if (!CommonFunctions.IsNumeric(dr[i].ToString()))
                                {
                                    if (!string.IsNullOrEmpty(dr[i].ToString()))
                                    {
                                        if (T1.Columns[i].ColumnName.Equals("Seek") || T1.Columns[i].ColumnName.Equals("Access") || T1.Columns[i].ColumnName.Equals("YeartoDate"))
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "Normal");
                                        else
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "NormalGreen");
                                    }
                                    else
                                    {
                                        if (T1.Columns[i].ColumnName.Equals("Seek") || T1.Columns[i].ColumnName.Equals("Access") || T1.Columns[i].ColumnName.Equals("YeartoDate"))
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.Number, "Normal");
                                        else
                                            S1 = row.Cells.Add(dr[i].ToString(), DataType.String, "NormalRed");
                                    }
                                }
                            }

                        }
                        T1.Clear();
                    }
                }


                FileStream stream = new FileStream(PdfName, FileMode.Create);

                book.Save(stream);
                stream.Close();
            }
        }


        #endregion

        private void EmptyEnties()
        {
            IntakeAppList = new List<CaseMstEntity>();
            CaseContList = new List<CaseMstEntity>();
            CaseactList = new List<CaseMstEntity>();
            Spmlistcnt = new List<CaseMstEntity>();
            DUPCaseContList = new List<CaseMstEntity>();
            DUPCaseactList = new List<CaseMstEntity>();
            DUPSpmlistcnt = new List<CaseMstEntity>();
            CustQueslistcnt = new List<CaseMstEntity>();
            
            YearIntakeAppList = new List<CaseMstEntity>();
            YearCaseContList = new List<CaseMstEntity>();
            YearCaseactList = new List<CaseMstEntity>();
            YearSpmlistcnt = new List<CaseMstEntity>();
            YearDUPCaseContList = new List<CaseMstEntity>();
            YearDUPCaseactList = new List<CaseMstEntity>();
            YearDUPSpmlistcnt = new List<CaseMstEntity>();
            YearCustQueslistcnt = new List<CaseMstEntity>();
        }

        List<CaseMstEntity> CasemstList = new List<CaseMstEntity>();
        string Responces = string.Empty; int TableCnt = 1; string FamilySeqs = string.Empty;
        private int Process(SSBGTYPESEntity SEntity, List<SSBGTYPESEntity> SSBGCritQuestions)
        {
            int IsCount = 0;

            //propcasemstAlllist = propcasemstAlllist.FindAll(u => Convert.ToDateTime(u.IntakeDate) >= Convert.ToDateTime(dtpFrom.Value.ToShortDateString()) && Convert.ToDateTime(u.IntakeDate) <= Convert.ToDateTime(dtpTo.Value.ToShortDateString()));
            if (propcasemstAlllist.Count > 0)
            {
                int Count = 0; //string Responces = string.Empty; 
                //List<SSBGTYPESEntity> SSBGCritQuestions = SSBGTypesQues.FindAll(u => (u.SBGTID.Equals(SEntity.SBGTID) && u.SBGTCode.Equals(SEntity.SBGTCode) && (!u.SBGTGroupSeq.Equals("0"))));
                //DataTable dt = CreateTable(SSBGCritQuestions);
                //var DistinctQues = SSBGCritQuestions.Select(u => u.EligQuesFldName.Trim()).Distinct().ToList();
                bool IsFirst = true;
                foreach (CaseMstEntity Entity in propcasemstAlllist)
                {
                    string Result = string.Empty; Responces = string.Empty; FamilySeqs = string.Empty;
                    CasemstList = propcasemstAlllist.FindAll(u => u.ApplNo.Equals(Entity.ApplNo) && u.ApplAgency.Equals(Entity.ApplAgency) && u.ApplDept.Equals(Entity.ApplDept) && u.ApplProgram.Equals(Entity.ApplProgram) && u.ApplYr.Equals(Entity.ApplYr) && (Convert.ToDateTime(u.IntakeDate)>=dtpFrom.Value && Convert.ToDateTime(u.IntakeDate)<=dtpTo.Value));
                    if (CasemstList.Count>0)
                    {
                        caseSnpList = propcaseSnpAlllist.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Trim().Equals(Entity.ApplYr.Trim())); //_model.CaseMstData.GetCaseSnpDetails(Entity.ApplAgency, Entity.ApplDept, Entity.ApplProgram, Entity.ApplYr, Entity.ApplNo);
                        //caseIncomeList = PropcaseIncomeList.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Equals(Entity.ApplYr));

                        //FillTableValues(SSBGCritQuestions, SEntity, dt);
                        if (IntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || CaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || Spmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                        {
                            Result = "Y";
                            var AppList = new List<CaseMstEntity>();
                            if (IntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                                AppList = IntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                            else if (Spmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                                AppList = Spmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                            else if (CaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                                AppList = CaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                            Responces = AppList[0].HeatIncRent.Trim();
                            if (SEntity.SBGTMemAccess.ToString() == "I")
                                FamilySeqs = AppList[0].HeatIncRentDesc.Trim();
                        }
                        else Result = GetEligibilityStatus(SEntity, dt,"B");

                        if (Result == "Y")
                        {
                            if (SEntity.SBGTMemAccess.ToString() == "I")
                            {
                                //string[] Resp = Responces.Split(',');
                                //Resp = Resp.Where(val => val != "").ToArray();
                                if (!string.IsNullOrEmpty(Responces.Trim()))
                                {
                                    IsCount = IsCount + Convert.ToInt32(Responces);
                                    CasemstList[0].HeatIncRent = Responces;
                                    CasemstList[0].HeatIncRentDesc = FamilySeqs;
                                }

                                if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                                {
                                    string[] famseqs = FamilySeqs.Split(',');
                                    if (famseqs.Length > 0)
                                    {
                                        int maxID = 0;
                                        for (int i = 0; i < famseqs.Length; i++)
                                        {
                                            if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                            {
                                                if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == "I1")
                                                    CountDemographics(caseSnpList, famseqs[i]);

                                                if (IsFirst)
                                                { IsFirst = false; }
                                                else
                                                {
                                                    DataRow[] dr = dt.Select("ReportPeriod = MAX([ReportPeriod])");
                                                    if (dr != null)
                                                    {
                                                        maxID = int.Parse(dr[0]["ReportPeriod"].ToString());
                                                    }
                                                }
                                                DataRow dr1 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                                if (dr1 != null)
                                                    dr1.SetField("ReportPeriod", (maxID + 1).ToString());
                                            }
                                        }
                                    }
                                }
                            }
                            else if (SEntity.SBGTMemAccess.ToString() == "F")
                            {
                                if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                                {
                                    string[] famseqs = FamilySeqs.Split(',');
                                    if (famseqs.Length > 0)
                                    {
                                        for (int i = 0; i < famseqs.Length; i++)
                                        {
                                            if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                            {
                                                if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == "I1")
                                                    CountDemographics(caseSnpList, famseqs[i]);
                                            }
                                        }
                                    }
                                }

                                IsCount++;
                                int maxID = 0;
                                if (IsFirst)
                                { IsFirst = false; }
                                else
                                {
                                    DataRow[] dr = dt.Select("ReportPeriod = MAX([ReportPeriod])");
                                    if (dr != null)
                                    {
                                        maxID = int.Parse(dr[0]["ReportPeriod"].ToString());
                                    }
                                }
                                DataRow dr1 = dt.Select("AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                if (dr1 != null)
                                    dr1.SetField("ReportPeriod", (maxID + 1).ToString());
                            }

                            IntakeAppList.Add(CasemstList[0]);
                        }
                        
                    }
                    Count++;
                }

                //DatasetFilling(TableCnt, dt);
                //TableCnt++;
                
            }

            return IsCount;
        }

        private int CONTProcess(SSBGTYPESEntity SEntity, string Type, List<SSBGTYPESEntity> SSBGCritQuestions)
        {
            int IsCount = 0;

            List<CaseMstEntity> MSTCasecontLIst = new List<CaseMstEntity>();

            if (Type == "C") MSTCasecontLIst = propContcasemstAlllist; else if (Type == "D") MSTCasecontLIst = propDUPContcasemstAlllist;

            //propcasemstAlllist = propcasemstAlllist.FindAll(u => Convert.ToDateTime(u.IntakeDate) >= Convert.ToDateTime(dtpFrom.Value.ToShortDateString()) && Convert.ToDateTime(u.IntakeDate) <= Convert.ToDateTime(dtpTo.Value.ToShortDateString()));
            if (MSTCasecontLIst.Count > 0)
            {
                int Count = 0; //string Responces = string.Empty; 
                //List<SSBGTYPESEntity> SSBGCritQuestions = SSBGTypesQues.FindAll(u => (u.SBGTID.Equals(SEntity.SBGTID) && u.SBGTCode.Equals(SEntity.SBGTCode) && (!u.SBGTGroupSeq.Equals("0"))));
                //DataTable dt = CreateTable(SSBGCritQuestions);
                //var DistinctQues = SSBGCritQuestions.Select(u => u.EligQuesFldName.Trim()).Distinct().ToList();
                bool IsFirst = true;
                foreach (CaseMstEntity Entity in MSTCasecontLIst)
                {
                    string Result = string.Empty; Responces = string.Empty; FamilySeqs = string.Empty;
                    CasemstList = MSTCasecontLIst.FindAll(u => u.ApplNo.Equals(Entity.ApplNo) && u.ApplAgency.Equals(Entity.ApplAgency) && u.ApplDept.Equals(Entity.ApplDept) && u.ApplProgram.Equals(Entity.ApplProgram) && u.ApplYr.Equals(Entity.ApplYr) && (Convert.ToDateTime(u.IntakeDate) >= dtpFrom.Value && Convert.ToDateTime(u.IntakeDate) <= dtpTo.Value));
                    
                    if (CasemstList.Count > 0)
                    {
                        caseSnpList = propCONTcaseSnpAlllist.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Trim().Equals(Entity.ApplYr.Trim())); //_model.CaseMstData.GetCaseSnpDetails(Entity.ApplAgency, Entity.ApplDept, Entity.ApplProgram, Entity.ApplYr, Entity.ApplNo);
                        //caseIncomeList = PropcaseIncomeList.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Equals(Entity.ApplYr));

                        //FillTableValues(SSBGCritQuestions, SEntity, dt);
                        if (IntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || CaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || Spmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                        {
                            Result = "Y";
                            var AppList = new List<CaseMstEntity>();
                            if (IntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                                AppList = IntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                            else if (Spmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                                AppList = Spmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                            else if (CaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                                AppList = CaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                            Responces = AppList[0].HeatIncRent.Trim();
                            if (SEntity.SBGTMemAccess.ToString() == "I")
                                FamilySeqs = AppList[0].HeatIncRentDesc.Trim();
                        }
                        else
                            Result = GetEligibilityStatus(SEntity, dt, "B");

                        if (Result == "Y")
                        {
                            

                            if (SEntity.SBGTMemAccess.ToString() == "I")
                            {
                                //string[] Resp = Responces.Split(',');
                                //Resp = Resp.Where(val => val != "").ToArray();
                                if (!string.IsNullOrEmpty(Responces.Trim()))
                                {
                                    IsCount = IsCount + Convert.ToInt32(Responces);
                                    CasemstList[0].HeatIncRent = Responces;
                                    CasemstList[0].HeatIncRentDesc = FamilySeqs;
                                }

                                if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                                {
                                    string[] famseqs = FamilySeqs.Split(',');
                                    if (famseqs.Length > 0)
                                    {
                                        int maxID = 0;
                                        for (int i = 0; i < famseqs.Length; i++)
                                        {
                                            if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                            {
                                                if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type + "1")
                                                    CountDemographics(caseSnpList, CasemstList[0].FamilySeq.Trim());
                                                if (IsFirst)
                                                { IsFirst = false; }
                                                else
                                                {
                                                    if (Type == "C")
                                                    {
                                                        DataRow[] dr = dt.Select("CReportPeriod = MAX([CReportPeriod])");
                                                        if (dr != null)
                                                        {
                                                            maxID = int.Parse(dr[0]["CReportPeriod"].ToString());
                                                        }
                                                    }
                                                    else if (Type == "D")
                                                    {
                                                        DataRow[] dr = dt.Select("CDReportPeriod = MAX([CDReportPeriod])");
                                                        if (dr != null)
                                                        {
                                                            maxID = int.Parse(dr[0]["CDReportPeriod"].ToString());
                                                        }
                                                    }
                                                }
                                                if (Type == "C")
                                                {
                                                    DataRow dr1 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                                    if (dr1 != null)
                                                        dr1.SetField("CReportPeriod", (maxID + 1).ToString());
                                                }
                                                else if (Type == "D")
                                                {
                                                    DataRow dr1 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                                    if (dr1 != null)
                                                        dr1.SetField("CDReportPeriod", (maxID + 1).ToString());
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                            else if (SEntity.SBGTMemAccess.ToString() == "F")
                            {
                                IsCount++;
                                if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                                {
                                    string[] famseqs = FamilySeqs.Split(',');
                                    if (famseqs.Length > 0)
                                    {
                                        for (int i = 0; i < famseqs.Length; i++)
                                        {
                                            if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                            {
                                                if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type + "1")
                                                    CountDemographics(caseSnpList, famseqs[i]);
                                            }
                                        }
                                    }
                                }


                                int maxID = 0;
                                if (IsFirst)
                                { IsFirst = false; }
                                else
                                {
                                    if (Type == "C")
                                    {
                                        DataRow[] dr = dt.Select("CReportPeriod = MAX([CReportPeriod])");
                                        if (dr != null)
                                        {
                                            maxID = int.Parse(dr[0]["CReportPeriod"].ToString());
                                        }
                                    }
                                    else if (Type == "D")
                                    {
                                        DataRow[] dr = dt.Select("CDReportPeriod = MAX([CDReportPeriod])");
                                        if (dr != null)
                                        {
                                            maxID = int.Parse(dr[0]["CDReportPeriod"].ToString());
                                        }
                                    }
                                }
                                if (Type == "C")
                                {
                                    DataRow dr1 = dt.Select("AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                    if (dr1 != null)
                                        dr1.SetField("CReportPeriod", (maxID + 1).ToString());
                                }
                                else if (Type == "D")
                                {
                                    DataRow dr1 = dt.Select("AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                    if (dr1 != null)
                                        dr1.SetField("CDReportPeriod", (maxID + 1).ToString());
                                }
                            }


                            if(Type=="C") CaseContList.Add(CasemstList[0]);
                            if (Type == "D") DUPCaseContList.Add(CasemstList[0]);
                        }

                    }
                    Count++;
                }
                //DatasetFilling(TableCnt, dt);
                //TableCnt++;

            }

            return IsCount;
        }

        private int ACTProcess(SSBGTYPESEntity SEntity, string Type, List<SSBGTYPESEntity> SSBGCritQuestions)
        {
            int IsCount = 0;

            List<CaseMstEntity> MSTActlist = new List<CaseMstEntity>();
            if (Type == "A") MSTActlist = propACTcasemstAlllist; if (Type == "B") MSTActlist = propDUPACTcasemstAlllist;

            //propcasemstAlllist = propcasemstAlllist.FindAll(u => Convert.ToDateTime(u.IntakeDate) >= Convert.ToDateTime(dtpFrom.Value.ToShortDateString()) && Convert.ToDateTime(u.IntakeDate) <= Convert.ToDateTime(dtpTo.Value.ToShortDateString()));
            if (MSTActlist.Count > 0)
            {
                int Count = 0; //string Responces = string.Empty; 
                //List<SSBGTYPESEntity> SSBGCritQuestions = SSBGTypesQues.FindAll(u => (u.SBGTID.Equals(SEntity.SBGTID) && u.SBGTCode.Equals(SEntity.SBGTCode) && (!u.SBGTGroupSeq.Equals("0"))));
                //DataTable dt = CreateTable(SSBGCritQuestions);
                //var DistinctQues = SSBGCritQuestions.Select(u => u.EligQuesFldName.Trim()).Distinct().ToList();
                bool IsFirst = true;
                foreach (CaseMstEntity Entity in MSTActlist)
                {
                    string Result = string.Empty; Responces = string.Empty; FamilySeqs = string.Empty;

                    CasemstList = MSTActlist.FindAll(u => u.ApplNo.Equals(Entity.ApplNo) && u.ApplAgency.Equals(Entity.ApplAgency) && u.ApplDept.Equals(Entity.ApplDept) && u.ApplProgram.Equals(Entity.ApplProgram) && u.ApplYr.Equals(Entity.ApplYr) && (Convert.ToDateTime(u.IntakeDate) == Convert.ToDateTime(Entity.IntakeDate)));

                    if(CasemstList.Count>0)
                        CasemstList = CasemstList.FindAll(u => u.ApplNo.Equals(Entity.ApplNo) && u.ApplAgency.Equals(Entity.ApplAgency) && u.ApplDept.Equals(Entity.ApplDept) && u.ApplProgram.Equals(Entity.ApplProgram) && u.ApplYr.Equals(Entity.ApplYr) && (Convert.ToDateTime(u.IntakeDate) >= dtpFrom.Value && Convert.ToDateTime(u.IntakeDate) <= dtpTo.Value));

                    if (CasemstList.Count > 0)
                    {
                        caseSnpList = propACTcaseSnpAlllist.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Trim().Equals(Entity.ApplYr.Trim())); //_model.CaseMstData.GetCaseSnpDetails(Entity.ApplAgency, Entity.ApplDept, Entity.ApplProgram, Entity.ApplYr, Entity.ApplNo);
                        //caseIncomeList = PropcaseIncomeList.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Equals(Entity.ApplYr));

                        //FillTableValues(SSBGCritQuestions, SEntity, dt);
                        if (IntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || CaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || Spmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                        {
                            Result = "Y";
                            var AppList = new List<CaseMstEntity>();
                            if (IntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                                AppList = IntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                            else if (Spmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                                AppList = Spmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                            else if (CaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                                AppList = CaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                            Responces = AppList[0].HeatIncRent.Trim();
                            if (SEntity.SBGTMemAccess.ToString() == "I")
                                FamilySeqs = AppList[0].HeatIncRentDesc.Trim();
                        }
                        else
                            Result = GetEligibilityStatus(SEntity, dt, "B");

                        if (Result == "Y")
                        {
                            

                            if (SEntity.SBGTMemAccess.ToString() == "I")
                            {
                                //string[] Resp = Responces.Split(',');
                                //Resp = Resp.Where(val => val != "").ToArray();
                                if (!string.IsNullOrEmpty(Responces.Trim()))
                                {
                                    IsCount = IsCount + 1; //Convert.ToInt32(Responces);
                                    CasemstList[0].HeatIncRent = Responces;
                                    CasemstList[0].HeatIncRentDesc = FamilySeqs;
                                }

                                if (!string.IsNullOrEmpty(CasemstList[0].FamilySeq.Trim()))
                                {
                                    int maxID = 0;
                                    if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type + "1")
                                        CountDemographics(caseSnpList, CasemstList[0].FamilySeq.Trim());

                                    if (IsFirst)
                                    { IsFirst = false; }
                                    else
                                    {
                                        if (Type == "A")
                                        {
                                            DataRow[] dr = dt.Select("AReportPeriod = MAX([AReportPeriod])");
                                            if (dr != null)
                                            {
                                                maxID = int.Parse(dr[0]["AReportPeriod"].ToString());
                                            }
                                        }
                                        else if (Type == "B")
                                        {
                                            DataRow[] dr = dt.Select("ADReportPeriod = MAX([ADReportPeriod])");
                                            if (dr != null)
                                            {
                                                maxID = int.Parse(dr[0]["ADReportPeriod"].ToString());
                                            }
                                        }
                                    }
                                    if (Type == "A")
                                    {
                                        DataRow dr1 = dt.Select("FamSeq=" + "'" + CasemstList[0].FamilySeq + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                        if (dr1 != null)
                                            dr1.SetField("AReportPeriod", (maxID + 1).ToString());
                                    }
                                    else if (Type == "B")
                                    {
                                        DataTable dtMulti = new DataTable();
                                        DataView dv = new DataView(dt);
                                        dv.RowFilter = "Type=" + "'" + SEntity.SBGTCode + "' AND AppNo=" + "'" + CasemstList[0].ApplNo + "'";
                                        dtMulti = dv.ToTable();

                                        if (dtMulti.Rows.Count > 1)
                                        {
                                            foreach(DataRow dr9 in dt.Rows)
                                            {
                                                if(dr9["Type"].ToString()== SEntity.SBGTCode && dr9["FamSeq"].ToString()== CasemstList[0].FamilySeq && dr9["AppNo"].ToString()== Entity.ApplNo && dr9["DupActDate"].ToString()== LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()))
                                                {
                                                    if (string.IsNullOrEmpty(dr9["ADReportPeriod"].ToString().Trim()))
                                                    { dr9.SetField("ADReportPeriod", (maxID + 1).ToString()); break; }
                                                }
                                            }

                                            //DataRow dr1 = dt.Select("FamSeq=" + "'" + CasemstList[0].FamilySeq + "' AND AppNo=" + "'" + Entity.ApplNo + "' AND DupActDate=" + "'" + LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()) + "'").FirstOrDefault();
                                            //if (dr1 != null)
                                            //{
                                            //    if (string.IsNullOrEmpty(dr1["ADReportPeriod"].ToString().Trim()))
                                            //        dr1.SetField("ADReportPeriod", (maxID + 1).ToString());
                                            //    else
                                            //    {

                                            //    }
                                            //}
                                        }
                                        else
                                        {
                                            DataRow dr1 = dt.Select("FamSeq=" + "'" + CasemstList[0].FamilySeq + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                            if (dr1 != null)
                                            {
                                                if (string.IsNullOrEmpty(dr1["ADReportPeriod"].ToString().Trim()))
                                                    dr1.SetField("ADReportPeriod", (maxID + 1).ToString());
                                            }
                                        }
                                    }

                                }

                                //    if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                                //{
                                //    string[] famseqs = FamilySeqs.Split(',');
                                //    if (famseqs.Length > 0)
                                //    {
                                //        int maxID = 0;
                                //        for (int i = 0; i < famseqs.Length; i++)
                                //        {
                                //            if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                //            {
                                //                if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type + "1")
                                //                    CountDemographics(caseSnpList, CasemstList[0].FamilySeq.Trim());
                                //                if (IsFirst)
                                //                { IsFirst = false; }
                                //                else
                                //                {
                                //                    if (Type == "A")
                                //                    {
                                //                        DataRow[] dr = dt.Select("AReportPeriod = MAX([AReportPeriod])");
                                //                        if (dr != null)
                                //                        {
                                //                            maxID = int.Parse(dr[0]["AReportPeriod"].ToString());
                                //                        }
                                //                    }
                                //                    else if (Type == "B")
                                //                    {
                                //                        DataRow[] dr = dt.Select("ADReportPeriod = MAX([ADReportPeriod])");
                                //                        if (dr != null)
                                //                        {
                                //                            maxID = int.Parse(dr[0]["ADReportPeriod"].ToString());
                                //                        }
                                //                    }
                                //                }
                                //                if (Type == "A")
                                //                {
                                //                    DataRow dr1 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                //                    if (dr1 != null)
                                //                        dr1.SetField("AReportPeriod", (maxID + 1).ToString());
                                //                }
                                //                else if (Type == "B")
                                //                {
                                //                    DataRow dr1 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                //                    if (dr1 != null)
                                //                        dr1.SetField("ADReportPeriod", (maxID + 1).ToString());
                                //                }
                                //            }
                                //        }
                                //    }
                                //}
                            }
                            else if (SEntity.SBGTMemAccess.ToString() == "F")
                            {
                                if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                                {
                                    string[] famseqs = FamilySeqs.Split(',');
                                    if (famseqs.Length > 0)
                                    {
                                        for (int i = 0; i < famseqs.Length; i++)
                                        {
                                            if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                            {
                                                if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type + "1")
                                                    CountDemographics(caseSnpList, famseqs[i]);
                                            }
                                        }
                                    }
                                }

                                IsCount++;
                               int maxID = 0;
                                if (IsFirst)
                                { IsFirst = false; }
                                else
                                {
                                    if (Type == "A")
                                    {
                                        DataRow[] dr = dt.Select("AReportPeriod = MAX([AReportPeriod])");
                                        if (dr != null)
                                        {
                                            maxID = int.Parse(dr[0]["AReportPeriod"].ToString());
                                        }
                                    }
                                    else if (Type == "B")
                                    {
                                        DataRow[] dr = dt.Select("ADReportPeriod = MAX([ADReportPeriod])");
                                        if (dr != null)
                                        {
                                            maxID = int.Parse(dr[0]["ADReportPeriod"].ToString());
                                        }
                                    }
                                }
                                if (Type == "A")
                                {
                                    DataRow dr1 = dt.Select("AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                    if (dr1 != null)
                                        dr1.SetField("AReportPeriod", (maxID + 1).ToString());
                                }
                                else if (Type == "B")
                                {
                                    DataRow dr1 = dt.Select("AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                    if (dr1 != null)
                                        dr1.SetField("ADReportPeriod", (maxID + 1).ToString());
                                }
                            }
                            if(Type=="A")
                                CaseactList.Add(CasemstList[0]);
                            if (Type == "B")
                                DUPCaseactList.Add(CasemstList[0]);
                        }

                    }
                    Count++;
                }
                //DatasetFilling(TableCnt, dt);
                //TableCnt++;

            }

            return IsCount;
        }

        private int SPMProcess(SSBGTYPESEntity SEntity, string Type, List<SSBGTYPESEntity> SSBGCritQuestions)
        {
            int IsCount = 0;

            List<CaseMstEntity> MstSpmList = new List<CaseMstEntity>();

            if (Type == "S") MstSpmList = propSPMcasemstAlllist; if (Type == "T") MstSpmList = propDUPSPMcasemstAlllist;

            //propcasemstAlllist = propcasemstAlllist.FindAll(u => Convert.ToDateTime(u.IntakeDate) >= Convert.ToDateTime(dtpFrom.Value.ToShortDateString()) && Convert.ToDateTime(u.IntakeDate) <= Convert.ToDateTime(dtpTo.Value.ToShortDateString()));
            if (MstSpmList.Count > 0)
            {
                int Count = 0; //string Responces = string.Empty; 
                //List<SSBGTYPESEntity> SSBGCritQuestions = SSBGTypesQues.FindAll(u => (u.SBGTID.Equals(SEntity.SBGTID) && u.SBGTCode.Equals(SEntity.SBGTCode) && (!u.SBGTGroupSeq.Equals("0"))));
                //DataTable dt = CreateTable(SSBGCritQuestions);
                //var DistinctQues = SSBGCritQuestions.Select(u => u.EligQuesFldName.Trim()).Distinct().ToList();
                bool IsFirst = true; 
                foreach (CaseMstEntity Entity in MstSpmList)
                {
                    string Result = string.Empty; Responces = string.Empty; FamilySeqs = string.Empty;
                    CasemstList = MstSpmList.FindAll(u => u.ApplNo.Equals(Entity.ApplNo) && u.ApplAgency.Equals(Entity.ApplAgency) && u.ApplDept.Equals(Entity.ApplDept) && u.ApplProgram.Equals(Entity.ApplProgram) && u.ApplYr.Equals(Entity.ApplYr) && (Convert.ToDateTime(u.IntakeDate) >= dtpFrom.Value && Convert.ToDateTime(u.IntakeDate) <= dtpTo.Value));

                    if (CasemstList.Count > 0)
                    {
                        caseSnpList = propSPMcaseSnpAlllist.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Trim().Equals(Entity.ApplYr.Trim())); //_model.CaseMstData.GetCaseSnpDetails(Entity.ApplAgency, Entity.ApplDept, Entity.ApplProgram, Entity.ApplYr, Entity.ApplNo);
                        //caseIncomeList = PropcaseIncomeList.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Equals(Entity.ApplYr));

                        //FillTableValues(SSBGCritQuestions, SEntity, dt);
                        if (IntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || CaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || CaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                        {
                            Result = "Y";

                           var AppList = new List<CaseMstEntity>();
                            if (IntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                                AppList = IntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                            else if (CaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                                AppList = CaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                            else if (CaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                                AppList = CaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                            Responces = AppList[0].HeatIncRent.Trim();
                            if (SEntity.SBGTMemAccess.ToString() == "I")
                                FamilySeqs = AppList[0].HeatIncRentDesc.Trim();
                        }
                        else
                            Result = GetEligibilityStatus(SEntity, dt, "B");

                        if (Result == "Y")
                        {
                            if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type+"1")
                                CountDemographics(caseSnpList, CasemstList[0].FamilySeq.Trim());

                            if (SEntity.SBGTMemAccess.ToString() == "I")
                            {
                                //string[] Resp = Responces.Split(',');
                                //Resp = Resp.Where(val => val != "").ToArray();
                                if (!string.IsNullOrEmpty(Responces.Trim()))
                                {
                                    IsCount = IsCount + 1;//Convert.ToInt32(Responces);
                                    CasemstList[0].HeatIncRent = Responces;
                                    CasemstList[0].HeatIncRentDesc = FamilySeqs;
                                }

                                if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                                {
                                    string[] famseqs = FamilySeqs.Split(',');
                                    if (famseqs.Length > 0)
                                    {
                                        int maxID = 0;
                                        for (int i = 0; i < famseqs.Length; i++)
                                        {
                                            if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                            {
                                                if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type + "1")
                                                    CountDemographics(caseSnpList, CasemstList[0].FamilySeq.Trim());
                                                if (IsFirst)
                                                { IsFirst = false; }
                                                else
                                                {
                                                    if (Type == "S")
                                                    {
                                                        DataRow[] dr = dt.Select("SReportPeriod = MAX([SReportPeriod])");
                                                        if (dr != null)
                                                        {
                                                            maxID = int.Parse(dr[0]["SReportPeriod"].ToString());
                                                        }
                                                    }
                                                    else if (Type == "T")
                                                    {
                                                        DataRow[] dr = dt.Select("SDReportPeriod = MAX([SDReportPeriod])");
                                                        if (dr != null)
                                                        {
                                                            maxID = int.Parse(dr[0]["SDReportPeriod"].ToString());
                                                        }
                                                    }
                                                }
                                                if (Type == "S")
                                                {
                                                    DataRow dr1 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                                    if (dr1 != null)
                                                        dr1.SetField("SReportPeriod", (maxID + 1).ToString());
                                                }
                                                else if (Type == "T")
                                                {
                                                    DataRow dr1 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                                    if (dr1 != null)
                                                        dr1.SetField("SDReportPeriod", (maxID + 1).ToString());
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                            else if (SEntity.SBGTMemAccess.ToString() == "F")
                            {
                                if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                                {
                                    string[] famseqs = FamilySeqs.Split(',');
                                    if (famseqs.Length > 0)
                                    {
                                        for (int i = 0; i < famseqs.Length; i++)
                                        {
                                            if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                            {
                                                if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type + "1")
                                                    CountDemographics(caseSnpList, famseqs[i]);
                                            }
                                        }
                                    }
                                }

                                IsCount++;
                                int maxID = 0;
                                if (IsFirst)
                                { IsFirst = false; }
                                else
                                {
                                    if (Type == "S")
                                    {
                                        DataRow[] dr = dt.Select("SReportPeriod = MAX([SReportPeriod])");
                                        if (dr != null)
                                        {
                                            maxID = int.Parse(dr[0]["SReportPeriod"].ToString());
                                        }
                                    }
                                    else if (Type == "T")
                                    {
                                        DataRow[] dr = dt.Select("SDReferencePeriod = MAX([SDReportPeriod])");
                                        if (dr != null)
                                        {
                                            maxID = int.Parse(dr[0]["SDReportPeriod"].ToString());
                                        }
                                    }
                                }
                                if (Type == "S")
                                {
                                    DataRow dr1 = dt.Select("AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                    if (dr1 != null)
                                        dr1.SetField("SReportPeriod", (maxID + 1).ToString());
                                }
                                else if (Type == "T")
                                {
                                    DataRow dr1 = dt.Select("AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                    if (dr1 != null)
                                        dr1.SetField("SDReportPeriod", (maxID + 1).ToString());
                                }
                            }

                            if(Type=="S")
                                Spmlistcnt.Add(CasemstList[0]);
                            if (Type == "T")
                                DUPSpmlistcnt.Add(CasemstList[0]);
                        }

                    }
                    Count++;
                }
                //DatasetFilling(TableCnt, dt);
                //TableCnt++;

            }

            return IsCount;
        }

        private int CUSTQuesProcess(SSBGTYPESEntity SEntity, string Type, string CustCode, List<SSBGTYPESEntity> SSBGCritQuestions)
        {
            int IsCount = 0;

            //List<CaseMstEntity> MstSpmList = new List<CaseMstEntity>();

            //if (Type == "S") MstSpmList = propSPMcasemstAlllist; if (Type == "T") MstSpmList = propDUPSPMcasemstAlllist;

            //propcasemstAlllist = propcasemstAlllist.FindAll(u => Convert.ToDateTime(u.IntakeDate) >= Convert.ToDateTime(dtpFrom.Value.ToShortDateString()) && Convert.ToDateTime(u.IntakeDate) <= Convert.ToDateTime(dtpTo.Value.ToShortDateString()));
            if (propADDCUSTcasemstAlllist.Count > 0)
            {
                int Count = 0; //string Responces = string.Empty; 
                //List<SSBGTYPESEntity> SSBGCritQuestions = SSBGTypesQues.FindAll(u => (u.SBGTID.Equals(SEntity.SBGTID) && u.SBGTCode.Equals(SEntity.SBGTCode) && (!u.SBGTGroupSeq.Equals("0"))));
                //DataTable dt = CreateTable(SSBGCritQuestions);
                //var DistinctQues = SSBGCritQuestions.Select(u => u.EligQuesFldName.Trim()).Distinct().ToList();
                bool IsFirst = true;
                foreach (CaseMstEntity Entity in propADDCUSTcasemstAlllist)
                {
                    string Result = string.Empty; Responces = string.Empty; FamilySeqs = string.Empty;
                    CasemstList = propADDCUSTcasemstAlllist.FindAll(u => u.ApplNo.Equals(Entity.ApplNo) && u.ApplAgency.Equals(Entity.ApplAgency) && u.ApplDept.Equals(Entity.ApplDept) && u.ApplProgram.Equals(Entity.ApplProgram) && u.ApplYr.Equals(Entity.ApplYr) && (Convert.ToDateTime(u.IntakeDate) >= dtpFrom.Value && Convert.ToDateTime(u.IntakeDate) <= dtpTo.Value) && u.CUST_Code.Equals(CustCode));

                    if (CasemstList.Count > 0)
                    {
                        caseSnpList = propSPMcaseSnpAlllist.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Trim().Equals(Entity.ApplYr.Trim())); //_model.CaseMstData.GetCaseSnpDetails(Entity.ApplAgency, Entity.ApplDept, Entity.ApplProgram, Entity.ApplYr, Entity.ApplNo);
                        //caseIncomeList = PropcaseIncomeList.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Equals(Entity.ApplYr));

                        //FillTableValues(SSBGCritQuestions, SEntity, dt);
                        if (IntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || CaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || CaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                        {
                            Result = "Y";
                            var AppList = new List<CaseMstEntity>();
                            if (IntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                                AppList = IntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                            else if (CaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                                AppList = CaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                            else if (CaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                                AppList = CaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                            Responces = AppList[0].HeatIncRent.Trim();
                            if (SEntity.SBGTMemAccess.ToString() == "I")
                                FamilySeqs = AppList[0].HeatIncRentDesc.Trim();
                        }
                        else
                            Result = GetEligibilityStatus(SEntity, dt, "B");

                        if (Result == "Y")
                        {
                            

                            if (SEntity.SBGTMemAccess.ToString() == "I")
                            {
                                //string[] Resp = Responces.Split(',');
                                //Resp = Resp.Where(val => val != "").ToArray();
                                if (!string.IsNullOrEmpty(Responces.Trim()))
                                {
                                    IsCount = IsCount + Convert.ToInt32(Responces);
                                    CasemstList[0].HeatIncRent = Responces;
                                    CasemstList[0].HeatIncRentDesc = FamilySeqs;
                                }

                                if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                                {
                                    string[] famseqs = FamilySeqs.Split(',');
                                    if (famseqs.Length > 0)
                                    {
                                        int maxID = 0;
                                        for (int i = 0; i < famseqs.Length; i++)
                                        {
                                            if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                            {
                                                if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == "Q1")
                                                    CountDemographics(caseSnpList, CasemstList[0].FamilySeq.Trim());

                                                if (IsFirst)
                                                { IsFirst = false; }
                                                else
                                                {
                                                    DataRow[] dr = dt.Select("QReportPeriod = MAX([QReportPeriod])");
                                                    if (dr != null)
                                                    {
                                                        maxID = int.Parse(dr[0]["QReportPeriod"].ToString());
                                                    }
                                                }
                                                DataRow dr1 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                                if (dr1 != null)
                                                    dr1.SetField("QReportPeriod", (maxID + 1).ToString());
                                            }
                                        }
                                    }
                                }
                            }
                            else if (SEntity.SBGTMemAccess.ToString() == "F")
                            {
                                if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                                {
                                    string[] famseqs = FamilySeqs.Split(',');
                                    if (famseqs.Length > 0)
                                    {
                                        for (int i = 0; i < famseqs.Length; i++)
                                        {
                                            if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                            {
                                                if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == "Q1")
                                                    CountDemographics(caseSnpList, famseqs[i]);
                                            }
                                        }
                                    }
                                }
                                IsCount++;
                                int maxID = 0;
                                if (IsFirst)
                                { IsFirst = false; }
                                else
                                {
                                    DataRow[] dr = dt.Select("QReportPeriod = MAX([QReportPeriod])");
                                    if (dr != null)
                                    {
                                        maxID = int.Parse(dr[0]["QReportPeriod"].ToString());
                                    }
                                }
                                DataRow dr1 = dt.Select("AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                if (dr1 != null)
                                    dr1.SetField("QReportPeriod", (maxID + 1).ToString());
                            }
                            //if (Type == "S")
                            //    Spmlistcnt.Add(CasemstList[0]);
                            //if (Type == "T")
                                CustQueslistcnt.Add(CasemstList[0]);
                        }

                    }
                    Count++;
                }
                //DatasetFilling(TableCnt, dt);
                //TableCnt++;

            }

            return IsCount;
        }

        private void DatasetFilling(int count, DataTable dt)
        {
            switch (count)
            {
                case 1: DataTable table1 = dt.Copy(); ds.Tables.Add(table1); dt.Clear(); break;
                case 2: DataTable table2 = dt.Copy(); ds.Tables.Add(table2); dt.Clear(); break;
                case 3: DataTable table3 = dt.Copy(); ds.Tables.Add(table3); dt.Clear(); break;
                case 4: DataTable table4 = dt.Copy(); ds.Tables.Add(table4); dt.Clear(); break;
                case 5: DataTable table5 = dt.Copy(); ds.Tables.Add(table5); dt.Clear(); break;
                case 6: DataTable table6 = dt.Copy(); ds.Tables.Add(table6); dt.Clear(); break;
            }
        }

        private void DatasetFillingObjectives(int count, DataTable dt)
        {
            switch (count)
            {
                case 1: DataTable table1 = dt.Copy(); dsObj.Tables.Add(table1); dt.Clear(); break;
                case 2: DataTable table2 = dt.Copy(); dsObj.Tables.Add(table2); dt.Clear(); break;
                case 3: DataTable table3 = dt.Copy(); dsObj.Tables.Add(table3); dt.Clear(); break;
                case 4: DataTable table4 = dt.Copy(); dsObj.Tables.Add(table4); dt.Clear(); break;
                case 5: DataTable table5 = dt.Copy(); dsObj.Tables.Add(table5); dt.Clear(); break;
                case 6: DataTable table6 = dt.Copy(); dsObj.Tables.Add(table6); dt.Clear(); break;
                case 7: DataTable table7 = dt.Copy(); dsObj.Tables.Add(table7); dt.Clear(); break;
                case 8: DataTable table8 = dt.Copy(); dsObj.Tables.Add(table8); dt.Clear(); break;
                case 9: DataTable table9 = dt.Copy(); dsObj.Tables.Add(table9); dt.Clear(); break;
                case 10: DataTable table10 = dt.Copy(); dsObj.Tables.Add(table10); dt.Clear(); break;
            }
        }

        int ExcelCount = 0;
        private void FillTableValues(List<SSBGTYPESEntity> Questions, SSBGTYPESEntity SEntity, DataTable dt, string AreaType,int DupCount)
        {
            DataRow dr1 = dt.Select("Type=" + "'" + SEntity.SBGTCode + "' AND AppNo=" + "'" + CasemstList[0].ApplNo + "'").FirstOrDefault();

            DataTable dtMulti = new DataTable();
            if ((AreaType == "B" || AreaType == "D" || AreaType == "T"))
            {
                DataView dv = new DataView(dt);
                dv.RowFilter = "Type=" + "'" + SEntity.SBGTCode + "' AND AppNo=" + "'" + CasemstList[0].ApplNo + "'";
                dtMulti = dv.ToTable();
            }

            if (dr1 == null || (AreaType == "B" || AreaType == "D" || AreaType == "T"))
            {
                if (SEntity.SBGTMemAccess == "I")
                {
                    
                    foreach (CaseSnpEntity Entity in caseSnpList)
                    {
                        if ((dtMulti.Rows.Count >= DupCount) && dr1!=null && (AreaType == "B" || AreaType == "D" || AreaType == "T"))
                        {
                            DataRow dr4 = dt.Select("Type=" + "'" + SEntity.SBGTCode + "' AND AppNo=" + "'" + Entity.App + "' AND FamSeq=" + "'" + Entity.FamilySeq.Trim() + "'").FirstOrDefault();
                            if (dr4 != null)
                            {
                                switch (AreaType)
                                {
                                    case "I":
                                        if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim() && (string.IsNullOrEmpty(dr1["IntakeDate"].ToString().Trim())))
                                            dr4.SetField("IntakeDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                        break;
                                    case "Q":
                                        if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim() && (string.IsNullOrEmpty(dr1["QIntakeDate"].ToString().Trim())))
                                            dr4.SetField("QIntakeDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                        break;
                                    case "C":
                                        if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim() && (string.IsNullOrEmpty(dr1["ContactDate"].ToString().Trim())))
                                            dr4.SetField("ContactDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                        break;
                                    case "D":
                                        if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim() && (string.IsNullOrEmpty(dr1["DupContDate"].ToString().Trim())))
                                            dr4.SetField("DupContDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                        break;
                                    case "A":
                                        if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim() && (string.IsNullOrEmpty(dr1["ActDate"].ToString().Trim())))
                                            dr4.SetField("ActDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                        break;
                                    case "B":
                                        if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim() && (string.IsNullOrEmpty(dr1["DupActDate"].ToString().Trim())))
                                            dr4.SetField("DupActDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                        break;
                                    case "S":
                                        if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim() && (string.IsNullOrEmpty(dr1["SPMStartDate"].ToString().Trim())))
                                            dr4.SetField("SPMStartDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                        break;
                                    case "T":
                                        if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim() && (string.IsNullOrEmpty(dr1["DUPSPMStartDate"].ToString().Trim())))
                                            dr4.SetField("DUPSPMStartDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                        break;

                                }
                            }
                            
                        }
                        else
                        {
                            DataRow dr = dt.NewRow();
                            dr.SetField("RowID", ExcelCount + 1);
                            dr.SetField("Type", SEntity.SBGTCode);
                            dr.SetField("TypeDesc", SEntity.SBGTDesc);
                            dr.SetField("AppNo", CasemstList[0].ApplNo);
                            dr.SetField("Name", LookupDataAccess.GetMemberName(Entity.NameixFi.Trim(), Entity.NameixMi.Trim(), Entity.NameixLast.Trim(), BaseForm.BaseHierarchyCnFormat));
                            dr.SetField("FamSeq", Entity.FamilySeq);

                            DataRow PrivRow = dt.Select("Type=" + "'" + SEntity.SBGTCode + "' AND AppNo=" + "'" + Entity.App + "' AND FamSeq=" + "'" + Entity.FamilySeq.Trim() + "'").FirstOrDefault();

                            foreach (SSBGTYPESEntity EligQues in Questions)
                            {
                                switch (EligQues.EligQuesFldName.Trim())
                                {
                                    case Consts.EligQues.Age:
                                        {
                                            if (PrivRow != null)
                                            {
                                                dr.SetField(EligQues.EligQuestionDesc, Entity.Age);
                                                dr.SetField("ByPass" + EligQues.EligQuestionDesc.Replace(' ', '_'), PrivRow["ByPass" + EligQues.EligQuestionDesc.Replace(' ', '_')].ToString());
                                                dr.SetField("Yeartodate" + EligQues.EligQuestionDesc.Replace(' ', '_'), PrivRow["Yeartodate" + EligQues.EligQuestionDesc.Replace(' ', '_')].ToString());
                                            }
                                            else
                                            {
                                                dr.SetField(EligQues.EligQuestionDesc, Entity.Age); dr.SetField("ByPass" + EligQues.EligQuestionDesc.Replace(' ', '_'), "N"); dr.SetField("Yeartodate" + EligQues.EligQuestionDesc.Replace(' ', '_'), "N");
                                            }
                                        } break;
                                    case Consts.EligQues.FederalOMB:
                                        {
                                            if (PrivRow != null)
                                            {
                                                dr.SetField(EligQues.EligQuestionDesc, CasemstList[0].Poverty);
                                                dr.SetField("ByPass" + EligQues.EligQuestionDesc.Replace(' ', '_'), PrivRow["ByPass" + EligQues.EligQuestionDesc.Replace(' ', '_')].ToString());
                                                dr.SetField("Yeartodate" + EligQues.EligQuestionDesc.Replace(' ', '_'), PrivRow["Yeartodate" + EligQues.EligQuestionDesc.Replace(' ', '_')].ToString());
                                            }
                                            else
                                            { dr.SetField(EligQues.EligQuestionDesc, CasemstList[0].Poverty); dr.SetField("ByPass" + EligQues.EligQuestionDesc.Replace(' ', '_'), "N"); dr.SetField("Yeartodate" + EligQues.EligQuestionDesc.Replace(' ', '_'), "N"); }
                                        
                                        }
                                        break;
                                }
                            }

                            switch (AreaType)
                            {
                                case "I":
                                    if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                                        dr.SetField("IntakeDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                    else
                                        dr.SetField("IntakeDate", "");
                                    dr.SetField("ReportPeriod", DBNull.Value);
                                    dr.SetField("ReferencePeriod", DBNull.Value); break;
                                case "Q":
                                    if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                                        dr.SetField("QIntakeDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                    else
                                        dr.SetField("QIntakeDate", "");
                                    dr.SetField("QReportPeriod", DBNull.Value);
                                    dr.SetField("QReferencePeriod", DBNull.Value); break;
                                case "C":
                                    if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                                        dr.SetField("ContactDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                    else
                                        dr.SetField("ContactDate", "");
                                    dr.SetField("CReportPeriod", DBNull.Value);
                                    dr.SetField("CReferencePeriod", DBNull.Value); break;
                                case "D":
                                    if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                                        dr.SetField("DupContDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                    else
                                        dr.SetField("DupContDate", "");
                                    dr.SetField("CDReportPeriod", DBNull.Value);
                                    dr.SetField("CDReferencePeriod", DBNull.Value); break;
                                case "A":
                                    if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                                        dr.SetField("ActDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                    else
                                        dr.SetField("ActDate", "");
                                    dr.SetField("AReportPeriod", DBNull.Value);
                                    dr.SetField("AReferencePeriod", DBNull.Value); break;
                                case "B":
                                    if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                                        dr.SetField("DupActDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                    else
                                        dr.SetField("DupActDate", "");
                                    dr.SetField("ADReportPeriod", DBNull.Value);
                                    dr.SetField("ADReferencePeriod", DBNull.Value); break;
                                case "S":
                                    if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                                        dr.SetField("SPMStartDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                    else
                                        dr.SetField("SPMStartDate", "");
                                    dr.SetField("SReportPeriod", DBNull.Value);
                                    dr.SetField("SReferencePeriod", DBNull.Value); break;
                                case "T":
                                    if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                                        dr.SetField("DUPSPMStartDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                    else
                                        dr.SetField("DUPSPMStartDate", "");
                                    dr.SetField("SDReportPeriod", DBNull.Value);
                                    dr.SetField("SDReferencePeriod", DBNull.Value); break;


                            }
                            //if (AreaType == "I")
                            //{
                            //    if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                            //        dr.SetField("Intake Date", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            //    else
                            //        dr.SetField("Intake Date", "");
                            //}
                            //dr.SetField("ReportPeriod", DBNull.Value);
                            //dr.SetField("ReferencePeriod", DBNull.Value);

                            //if (AreaType == "A" || AreaType == "B")
                            //{
                            //    if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                            //        dr.SetField("Intake Date", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            //    else
                            //        dr.SetField("Intake Date", "");
                            //}

                            //dr.SetField("ReportPeriod", DBNull.Value);
                            //dr.SetField("ReferencePeriod", DBNull.Value);

                            dt.Rows.Add(dr);
                            ExcelCount++;
                        }

                        
                    }

                }
                else if (SEntity.SBGTMemAccess == "F")
                {
                    DataRow dr = dt.NewRow();

                    dr.SetField("RowID", ExcelCount + 1);
                    dr.SetField("Type", SEntity.SBGTCode);
                    dr.SetField("TypeDesc", SEntity.SBGTDesc);
                    dr.SetField("AppNo", CasemstList[0].ApplNo);
                    dr.SetField("Name", LookupDataAccess.GetMemberName(CasemstList[0].FirstName.Trim(), CasemstList[0].MiddleName.Trim(), CasemstList[0].FirstName.Trim(), BaseForm.BaseHierarchyCnFormat));
                    dr.SetField("FamSeq", CasemstList[0].FamilySeq);

                    foreach (SSBGTYPESEntity EligQues in Questions)
                    {
                        switch (EligQues.EligQuesFldName.Trim())
                        {
                            case Consts.EligQues.Age: dr.SetField(EligQues.EligQuestionDesc, CasemstList[0].Age); dr.SetField("ByPass" + EligQues.EligQuestionDesc.Replace(' ', '_'), "N"); dr.SetField("Yeartodate" + EligQues.EligQuestionDesc.Replace(' ', '_'), "N"); break;
                            case Consts.EligQues.FederalOMB: dr.SetField(EligQues.EligQuestionDesc, CasemstList[0].Poverty); dr.SetField("ByPass" + EligQues.EligQuestionDesc.Replace(' ', '_'), "N"); dr.SetField("Yeartodate" + EligQues.EligQuestionDesc.Replace(' ', '_'), "N"); break;
                        }
                    }
                    //dr.SetField("Intake Date", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                    //dr.SetField("ReportPeriod", DBNull.Value);
                    //dr.SetField("ReferencePeriod", DBNull.Value);
                    switch (AreaType)
                    {
                        case "I": dr.SetField("IntakeDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                  dr.SetField("ReportPeriod", DBNull.Value);
                            dr.SetField("ReferencePeriod", DBNull.Value); break;
                        case "Q": dr.SetField("QIntakeDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            dr.SetField("QReportPeriod", DBNull.Value);
                            dr.SetField("QReferencePeriod", DBNull.Value); break;
                        case "C": dr.SetField("ContactDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            dr.SetField("CReportPeriod", DBNull.Value);
                            dr.SetField("CReferencePeriod", DBNull.Value); break;
                        case "D": dr.SetField("DupContDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            dr.SetField("CDReportPeriod", DBNull.Value);
                            dr.SetField("CDReferencePeriod", DBNull.Value); break;
                        case "A": dr.SetField("ActDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            dr.SetField("AReportPeriod", DBNull.Value);
                            dr.SetField("AReferencePeriod", DBNull.Value); break;
                        case "B": dr.SetField("DupActDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            dr.SetField("ADReportPeriod", DBNull.Value);
                            dr.SetField("ADReferencePeriod", DBNull.Value); break;
                        case "S": dr.SetField("SPMStartDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            dr.SetField("SReportPeriod", DBNull.Value);
                            dr.SetField("SReferencePeriod", DBNull.Value); break;
                        case "T": dr.SetField("DUPSPMStartDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            dr.SetField("SDReportPeriod", DBNull.Value);
                            dr.SetField("SDReferencePeriod", DBNull.Value); break;
                    }

                    dt.Rows.Add(dr);
                    ExcelCount++;
                }
            }
            else if (dr1 != null)
            {
                if (SEntity.SBGTMemAccess == "I")
                {
                    foreach (CaseSnpEntity Entity in caseSnpList)
                    {
                        //DataRow dr = dt.NewRow();
                        dr1 = dt.Select("Type=" + "'" + SEntity.SBGTCode + "' AND AppNo=" + "'" + CasemstList[0].ApplNo + "' AND FamSeq=" + "'" + Entity.FamilySeq + "'").FirstOrDefault();
                        if (dr1 != null)
                        {
                            //dr1.SetField("Type", SEntity.SBGTCode);
                            //dr1.SetField("TypeDesc", SEntity.SBGTDesc);
                            //dr1.SetField("AppNo", CasemstList[0].ApplNo);
                            //dr1.SetField("Name", LookupDataAccess.GetMemberName(Entity.NameixFi.Trim(), Entity.NameixMi.Trim(), Entity.NameixLast.Trim(), BaseForm.BaseHierarchyCnFormat));
                            //dr1.SetField("FamSeq", Entity.FamilySeq);

                            //foreach (SSBGTYPESEntity EligQues in Questions)
                            //{
                            //    switch (EligQues.EligQuesFldName.Trim())
                            //    {
                            //        case Consts.EligQues.Age: dr1.SetField(EligQues.EligQuestionDesc, Entity.Age); dr1.SetField("ByPass" + EligQues.EligQuestionDesc.Replace(' ', '_'), "N"); dr1.SetField("Yeartodate" + EligQues.EligQuestionDesc.Replace(' ', '_'), "N"); break;
                            //        case Consts.EligQues.FederalOMB: dr1.SetField(EligQues.EligQuestionDesc, CasemstList[0].Poverty); dr1.SetField("ByPass" + EligQues.EligQuestionDesc.Replace(' ', '_'), "N"); dr1.SetField("Yeartodate" + EligQues.EligQuestionDesc.Replace(' ', '_'), "N"); break;
                            //    }
                            //}

                            switch (AreaType)
                            {
                                case "I": if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                                        dr1.SetField("IntakeDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                    else
                                        dr1.SetField("IntakeDate", "");
                                    dr1.SetField("ReportPeriod", DBNull.Value);
                                    dr1.SetField("ReferencePeriod", DBNull.Value); break;
                                case "Q": if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                                        dr1.SetField("QIntakeDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                    else
                                        dr1.SetField("QIntakeDate", "");
                                    dr1.SetField("QReportPeriod", DBNull.Value);
                                    dr1.SetField("QReferencePeriod", DBNull.Value); break;
                                case "C": if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                                        dr1.SetField("ContactDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                    else
                                        dr1.SetField("ContactDate", "");
                                    dr1.SetField("CReportPeriod", DBNull.Value);
                                    dr1.SetField("CReferencePeriod", DBNull.Value); break;
                                case "D": if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                                        dr1.SetField("DupContDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                    else
                                        dr1.SetField("DupContDate", "");
                                    dr1.SetField("CDReportPeriod", DBNull.Value);
                                    dr1.SetField("CDReferencePeriod", DBNull.Value); break;
                                case "A": if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                                        dr1.SetField("ActDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                    else
                                        dr1.SetField("ActDate", "");
                                    dr1.SetField("AReportPeriod", DBNull.Value);
                                    dr1.SetField("AReferencePeriod", DBNull.Value); break;
                                case "B": if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                                        dr1.SetField("DupActDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                    else
                                        dr1.SetField("DupActDate", "");
                                    dr1.SetField("ADReportPeriod", DBNull.Value);
                                    dr1.SetField("ADReferencePeriod", DBNull.Value); break;
                                case "S": if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                                        dr1.SetField("SPMStartDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                    else
                                        dr1.SetField("SPMStartDate", "");
                                    dr1.SetField("SReportPeriod", DBNull.Value);
                                    dr1.SetField("SReferencePeriod", DBNull.Value); break;
                                case "T": if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                                        dr1.SetField("DUPSPMStartDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                                    else
                                        dr1.SetField("DUPSPMStartDate", "");
                                    dr1.SetField("SDReportPeriod", DBNull.Value);
                                    dr1.SetField("SDReferencePeriod", DBNull.Value); break;


                            }
                            //if (AreaType == "I")
                            //{
                            //    if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                            //        dr.SetField("Intake Date", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            //    else
                            //        dr.SetField("Intake Date", "");
                            //}
                            //dr.SetField("ReportPeriod", DBNull.Value);
                            //dr.SetField("ReferencePeriod", DBNull.Value);

                            //if (AreaType == "A" || AreaType == "B")
                            //{
                            //    if (CasemstList[0].FamilySeq.Trim() == Entity.FamilySeq.Trim())
                            //        dr.SetField("Intake Date", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            //    else
                            //        dr.SetField("Intake Date", "");
                            //}

                            //dr.SetField("ReportPeriod", DBNull.Value);
                            //dr.SetField("ReferencePeriod", DBNull.Value);

                            //dt.Rows.Add(dr1);
                        }
                    }

                }
                else if (SEntity.SBGTMemAccess == "F")
                {
                    //DataRow dr = dt.NewRow();

                    //dr1.SetField("Type", SEntity.SBGTCode);
                    //dr1.SetField("TypeDesc", SEntity.SBGTDesc);
                    //dr1.SetField("AppNo", CasemstList[0].ApplNo);
                    //dr1.SetField("Name", LookupDataAccess.GetMemberName(CasemstList[0].FirstName.Trim(), CasemstList[0].MiddleName.Trim(), CasemstList[0].FirstName.Trim(), BaseForm.BaseHierarchyCnFormat));
                    //dr1.SetField("FamSeq", CasemstList[0].FamilySeq);

                    //foreach (SSBGTYPESEntity EligQues in Questions)
                    //{
                    //    switch (EligQues.EligQuesFldName.Trim())
                    //    {
                    //        case Consts.EligQues.Age: dr1.SetField(EligQues.EligQuestionDesc, CasemstList[0].Age); dr1.SetField("ByPass" + EligQues.EligQuestionDesc.Replace(' ', '_'), "N"); dr1.SetField("Yeartodate" + EligQues.EligQuestionDesc.Replace(' ', '_'), "N"); break;
                    //        case Consts.EligQues.FederalOMB: dr1.SetField(EligQues.EligQuestionDesc, CasemstList[0].Poverty); dr1.SetField("ByPass" + EligQues.EligQuestionDesc.Replace(' ', '_'), "N"); dr1.SetField("Yeartodate" + EligQues.EligQuestionDesc.Replace(' ', '_'), "N"); break;
                    //    }
                    //}
                    ////dr.SetField("Intake Date", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                    ////dr.SetField("ReportPeriod", DBNull.Value);
                    ////dr.SetField("ReferencePeriod", DBNull.Value);
                    switch (AreaType)
                    {
                        case "I": dr1.SetField("Intake Date", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            dr1.SetField("ReportPeriod", DBNull.Value);
                            dr1.SetField("ReferencePeriod", DBNull.Value); break;
                        case "Q": dr1.SetField("QIntake Date", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            dr1.SetField("QReportPeriod", DBNull.Value);
                            dr1.SetField("QReferencePeriod", DBNull.Value); break;
                        case "C": dr1.SetField("ContactDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            dr1.SetField("CReportPeriod", DBNull.Value);
                            dr1.SetField("CReferencePeriod", DBNull.Value); break;
                        case "D": dr1.SetField("DupCont Date", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            dr1.SetField("CDReportPeriod", DBNull.Value);
                            dr1.SetField("CDReferencePeriod", DBNull.Value); break;
                        case "A": dr1.SetField("ActDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            dr1.SetField("AReportPeriod", DBNull.Value);
                            dr1.SetField("AReferencePeriod", DBNull.Value); break;
                        case "B": dr1.SetField("DupActDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            dr1.SetField("ADReportPeriod", DBNull.Value);
                            dr1.SetField("ADReferencePeriod", DBNull.Value); break;
                        case "S": dr1.SetField("SPMStartDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            dr1.SetField("SReportPeriod", DBNull.Value);
                            dr1.SetField("SReferencePeriod", DBNull.Value); break;
                        case "T": dr1.SetField("DUPSPMStartDate", LookupDataAccess.Getdate(CasemstList[0].IntakeDate.Trim()));
                            dr1.SetField("SDReportPeriod", DBNull.Value);
                            dr1.SetField("SDReferencePeriod", DBNull.Value); break;
                    }

                    //dt.Rows.Add(dr1);
                }
            }
        }

        SSBGDemoEntity DemoCounts = new SSBGDemoEntity();
        private void CountDemographics(List<CaseSnpEntity> SNPList, string FamSeq)
        {
            if (!string.IsNullOrEmpty(FamSeq))
            {
                List<CaseSnpEntity> SelSnpRecs = new List<CaseSnpEntity>();

                DemoCounts.SSBG18to59 = (Convert.ToInt32(DemoCounts.SSBG18to59.Trim()) + Convert.ToInt32(SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim())).Count)).ToString();//Convert.ToInt32(SNPList.FindAll(u => Convert.ToInt32(u.Age) > 17 && Convert.ToInt32(u.Age) < 60).Count)).ToString()
                DemoCounts.SSBG60Plus = (Convert.ToInt32(DemoCounts.SSBG60Plus.Trim()) + Convert.ToInt32(SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim())).Count)).ToString();//Convert.ToInt32(u.Age) > 59).Count)).ToString()
                DemoCounts.SSBGAdults = (Convert.ToInt32(DemoCounts.SSBGAdults.Trim()) + Convert.ToInt32(SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && (u.DobNa) == "1").Count)).ToString();
                DemoCounts.SSBGAsian = (Convert.ToInt32(DemoCounts.SSBGAsian.Trim()) + Convert.ToInt32(SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && (u.Race) == "02" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGAmerican = (Convert.ToInt32(DemoCounts.SSBGAmerican.Trim()) + Convert.ToInt32(SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && (u.Race) == "01" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGBlack = (Convert.ToInt32(DemoCounts.SSBGBlack.Trim()) + Convert.ToInt32(SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && (u.Race) == "03" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGMultiRace = (Convert.ToInt32(DemoCounts.SSBGMultiRace.Trim()) + Convert.ToInt32(SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && (u.Race) == "07" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGWhite = (Convert.ToInt32(DemoCounts.SSBGWhite.Trim()) + Convert.ToInt32(SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && (u.Race) == "05" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGOther = (Convert.ToInt32(DemoCounts.SSBGOther.Trim()) + Convert.ToInt32(SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && (u.Race) == "06" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGNative = (Convert.ToInt32(DemoCounts.SSBGNative.Trim()) + Convert.ToInt32(SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && (u.Race) == "04" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGHispanic = (Convert.ToInt32(DemoCounts.SSBGHispanic.Trim()) + Convert.ToInt32(SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && (u.Ethnic) == "01" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGNonHispanic = (Convert.ToInt32(DemoCounts.SSBGNonHispanic.Trim()) + Convert.ToInt32(SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && (u.Ethnic) == "02" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGMale = (Convert.ToInt32(DemoCounts.SSBGMale.Trim()) + Convert.ToInt32(SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && (u.Sex) == "M" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGFemale = (Convert.ToInt32(DemoCounts.SSBGFemale.Trim()) + Convert.ToInt32(SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && (u.Sex) == "F" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();

                SelSnpRecs = SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()));
                if(SelSnpRecs.Count>0)
                    SNPDemoGraphList.AddRange(SelSnpRecs);
                SelSnpRecs = SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()));
                if (SelSnpRecs.Count > 0)
                    SNPDemoGraphList.AddRange(SelSnpRecs);
                SelSnpRecs = SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && (u.DobNa) == "1");
                if (SelSnpRecs.Count > 0)
                    SNPDemoGraphList.AddRange(SelSnpRecs);
            }
            else
            {
                List<CaseSnpEntity> SelSnpRecs = new List<CaseSnpEntity>();

                DemoCounts.SSBG18to59 = (Convert.ToInt32(DemoCounts.SSBG18to59.Trim()) + Convert.ToInt32(SNPList.FindAll(u => Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim())).Count)).ToString();//Convert.ToInt32(SNPList.FindAll(u => Convert.ToInt32(u.Age) > 17 && Convert.ToInt32(u.Age) < 60).Count)).ToString()
                DemoCounts.SSBG60Plus = (Convert.ToInt32(DemoCounts.SSBG60Plus.Trim()) + Convert.ToInt32(SNPList.FindAll(u => Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim())).Count)).ToString();//Convert.ToInt32(u.Age) > 59).Count)).ToString()
                DemoCounts.SSBGAdults = (Convert.ToInt32(DemoCounts.SSBGAdults.Trim()) + Convert.ToInt32(SNPList.FindAll(u => (u.DobNa) == "1").Count)).ToString();
                DemoCounts.SSBGAsian = (Convert.ToInt32(DemoCounts.SSBGAsian.Trim()) + Convert.ToInt32(SNPList.FindAll(u => (u.Race) == "02" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGAmerican = (Convert.ToInt32(DemoCounts.SSBGBlack.Trim()) + Convert.ToInt32(SNPList.FindAll(u => (u.Race) == "01" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGBlack = (Convert.ToInt32(DemoCounts.SSBGBlack.Trim()) + Convert.ToInt32(SNPList.FindAll(u => (u.Race) == "03" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGMultiRace = (Convert.ToInt32(DemoCounts.SSBGMultiRace.Trim()) + Convert.ToInt32(SNPList.FindAll(u => (u.Race) == "07" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGWhite = (Convert.ToInt32(DemoCounts.SSBGWhite.Trim()) + Convert.ToInt32(SNPList.FindAll(u => (u.Race) == "05" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGOther = (Convert.ToInt32(DemoCounts.SSBGOther.Trim()) + Convert.ToInt32(SNPList.FindAll(u => (u.Race) == "06" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGNative = (Convert.ToInt32(DemoCounts.SSBGNative.Trim()) + Convert.ToInt32(SNPList.FindAll(u => (u.Race) == "04" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGHispanic = (Convert.ToInt32(DemoCounts.SSBGHispanic.Trim()) + Convert.ToInt32(SNPList.FindAll(u => (u.Ethnic) == "01" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGNonHispanic = (Convert.ToInt32(DemoCounts.SSBGNonHispanic.Trim()) + Convert.ToInt32(SNPList.FindAll(u => (u.Ethnic) == "02" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGMale = (Convert.ToInt32(DemoCounts.SSBGMale.Trim()) + Convert.ToInt32(SNPList.FindAll(u => (u.Sex) == "M" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();
                DemoCounts.SSBGFemale = (Convert.ToInt32(DemoCounts.SSBGFemale.Trim()) + Convert.ToInt32(SNPList.FindAll(u => (u.Sex) == "F" && (((u.DobNa) == "1") || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()) || Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()))).Count)).ToString();

                SelSnpRecs = SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && Convert.ToInt32(u.Age) >= Convert.ToInt32(txtfrom1.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo1.Text.Trim()));
                if (SelSnpRecs.Count > 0)
                    SNPDemoGraphList.AddRange(SelSnpRecs);
                SelSnpRecs = SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && Convert.ToInt32(u.Age) >= Convert.ToInt32(txtFrom2.Text.Trim()) && Convert.ToInt32(u.Age) <= Convert.ToInt32(txtTo2.Text.Trim()));
                if (SelSnpRecs.Count > 0)
                    SNPDemoGraphList.AddRange(SelSnpRecs);
                SelSnpRecs = SNPList.FindAll(u => u.FamilySeq.Equals(FamSeq.Trim()) && (u.DobNa) == "1");
                if (SelSnpRecs.Count > 0)
                    SNPDemoGraphList.AddRange(SelSnpRecs);
            }
            //DemographicsRecords(SNPList);
        }

        List<CaseSnpEntity> SNPDemoGraphList = new List<CaseSnpEntity>();
        private void DemographicsRecords(List<CaseSnpEntity> SNPList)
        {
            List<CaseSnpEntity> SelSnpRecs = new List<CaseSnpEntity>();

            SelSnpRecs = SNPList.FindAll(u => Convert.ToInt32(u.Age) > 17 && Convert.ToInt32(u.Age) < 60);
            SNPDemoGraphList = SelSnpRecs;
            SelSnpRecs = SNPList.FindAll(u => Convert.ToInt32(u.Age) > 59);
            if (SelSnpRecs.Count != SNPDemoGraphList.Count)
            { if (SelSnpRecs.Count > 0) SNPDemoGraphList.AddRange(SNPDemoGraphList.Except(SelSnpRecs)); }
            SelSnpRecs = SNPList.FindAll(u => (u.DobNa) == "1");
            if (SelSnpRecs.Count != SNPDemoGraphList.Count)
            { if (SelSnpRecs.Count > 0) SNPDemoGraphList.AddRange(SNPDemoGraphList.Except(SelSnpRecs)); }
            SelSnpRecs = SNPList.FindAll(u => (u.Race) == "02" || (u.Race) == "01" || (u.Race) == "03" || (u.Race) == "04" || (u.Race) == "05" || (u.Race) == "06" || (u.Race) == "07");
            if (SelSnpRecs.Count != SNPDemoGraphList.Count)
            { if (SelSnpRecs.Count > 0) SNPDemoGraphList.AddRange(SNPDemoGraphList.Except(SelSnpRecs)); }
            SelSnpRecs = SNPList.FindAll(u => (u.Ethnic) == "01" || (u.Ethnic) == "02");
            if (SelSnpRecs.Count != SNPDemoGraphList.Count)
            { if (SelSnpRecs.Count > 0) SNPDemoGraphList.AddRange(SNPDemoGraphList.Except(SelSnpRecs)); }
            SelSnpRecs = SNPList.FindAll(u => (u.Sex) == "M" || (u.Sex) == "F");
            if (SelSnpRecs.Count != SNPDemoGraphList.Count)
            { if (SelSnpRecs.Count > 0) SNPDemoGraphList.AddRange(SNPDemoGraphList.Except(SelSnpRecs)); }

        }

        DataTable dt = new DataTable();
        private int YeartoDateProcess(SSBGTYPESEntity SEntity, List<SSBGTYPESEntity> SSBGCritQuestions)
        {
            int IsCount = 0;

            //propcasemstAlllist = propcasemstAlllist.FindAll(u => Convert.ToDateTime(u.IntakeDate) >= Convert.ToDateTime(Ref_From_Date.Value.ToShortDateString()) && Convert.ToDateTime(u.IntakeDate) <= Convert.ToDateTime(dtpTo.Value.ToShortDateString()));
            if (propcasemstAlllist.Count > 0)
            {
                propcasemstAlllist = propcasemstAlllist.FindAll(u => Convert.ToDateTime(u.IntakeDate) >= Convert.ToDateTime(Ref_From_Date.Value.ToShortDateString()) && Convert.ToDateTime(u.IntakeDate) <= Convert.ToDateTime(Ref_To_Date.Value.ToShortDateString()));

                int Count = 0; //string Responces = string.Empty; 
                //List<SSBGTYPESEntity> SSBGCritQuestions = SSBGTypesQues.FindAll(u => (u.SBGTID.Equals(SEntity.SBGTID) && u.SBGTCode.Equals(SEntity.SBGTCode) && (!u.SBGTGroupSeq.Equals("0"))));
                //dt = CreateTable(SSBGCritQuestions);
                ////var DistinctQues = SSBGCritQuestions.Select(u => u.EligQuesFldName.Trim()).Distinct().ToList();
                bool IsFirst = true;
                foreach (CaseMstEntity Entity in propcasemstAlllist)
                {
                    string Result = string.Empty; Responces = string.Empty; FamilySeqs = string.Empty;
                    CasemstList = propcasemstAlllist.FindAll(u => u.ApplNo.Equals(Entity.ApplNo) && u.ApplAgency.Equals(Entity.ApplAgency) && u.ApplDept.Equals(Entity.ApplDept) && u.ApplProgram.Equals(Entity.ApplProgram) && u.ApplYr.Equals(Entity.ApplYr));
                    caseSnpList = propcaseSnpAlllist.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Trim().Equals(Entity.ApplYr.Trim())); //_model.CaseMstData.GetCaseSnpDetails(Entity.ApplAgency, Entity.ApplDept, Entity.ApplProgram, Entity.ApplYr, Entity.ApplNo);
                    //caseIncomeList = PropcaseIncomeList.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Equals(Entity.ApplYr));

                    //if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == "I")
                    //    CountDemographics(caseSnpList);

                    FillTableValues(SSBGCritQuestions, SEntity, dt,"I",0);
                    if (YearCaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || YearCaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || YearSpmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || YearCustQueslistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                    {
                        Result = "Y";
                        var AppList = new List<CaseMstEntity>();
                        if (YearCaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearCaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        else if (YearCaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearCaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        else if (YearSpmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearSpmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        else if (YearCustQueslistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearCustQueslistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        Responces = AppList[0].HeatIncRent.Trim();
                        if (SEntity.SBGTMemAccess.ToString() == "I")
                            FamilySeqs = AppList[0].HeatIncRentDesc.Trim();
                    }
                    else
                        Result = GetEligibilityStatus(SEntity, dt, "Y");

                    //Result = GetEligibilityStatus(SEntity, dt,"Y");

                    if (Result == "Y")
                    {
                                               
                        //int minLavel = Convert.ToInt32(dt.Compute("min(AccountLevel)", string.Empty));
                        if (SEntity.SBGTMemAccess.ToString() == "I")
                        {
                            //string[] Resp = Responces.Split(',');
                            //Resp = Resp.Where(val => val != "").ToArray();
                            if (!string.IsNullOrEmpty(Responces.Trim()))
                            {
                                IsCount = IsCount + Convert.ToInt32(Responces);
                                CasemstList[0].HeatIncRent = Responces;
                                CasemstList[0].HeatIncRentDesc = FamilySeqs;
                            }
                            if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                            {
                                string[] famseqs = FamilySeqs.Split(',');
                                if (famseqs.Length > 0)
                                {
                                    int maxID = 0;
                                    for (int i = 0; i < famseqs.Length; i++)
                                    {
                                        if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                        {
                                            if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == "I")
                                            {
                                                CountDemographics(caseSnpList, famseqs[i]);
                                                
                                            }
                                            //var maxRow = dt.Select("ReferencePeriod = MAX(ReferencePeriod)");
                                            //maxID = dt.AsEnumerable().Max(r => r.Field<int>("ReferencePeriod"));
                                            if (IsFirst)
                                            { IsFirst = false; }
                                            else
                                            {
                                                DataRow[] dr = dt.Select("ReferencePeriod = MAX([ReferencePeriod])");
                                                if (dr != null)
                                                {
                                                    maxID = int.Parse(dr[0]["ReferencePeriod"].ToString());
                                                }
                                            }
                                            DataRow dr1 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                            if (dr1 != null)
                                            {
                                                dr1.SetField("ReferencePeriod", (maxID + 1).ToString());
                                                if (dr1["YeartodateAge"].ToString() == "Y") dr1.SetField("YeartodateAge", "Y");
                                                if (dr1["YeartodateFederal_OMB"].ToString() == "Y") dr1.SetField("YeartodateFederal_OMB", "Y");
                                            }

                                        }
                                    }
                                }
                            }

                        }
                        else if (SEntity.SBGTMemAccess.ToString() == "F")
                        {
                            if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                            {
                                string[] famseqs = FamilySeqs.Split(',');
                                if (famseqs.Length > 0)
                                {
                                    for (int i = 0; i < famseqs.Length; i++)
                                    {
                                        if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                        {
                                            if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == "I")
                                                CountDemographics(caseSnpList, famseqs[i]);
                                        }
                                    }
                                }
                            }
                            IsCount++;
                            int maxID = 0;
                            if (IsFirst)
                            { IsFirst = false; }
                            else
                            {
                                DataRow[] dr = dt.Select("ReferencePeriod = MAX([ReferencePeriod])");
                                if (dr != null)
                                {
                                    maxID = int.Parse(dr[0]["ReferencePeriod"].ToString());
                                }
                            }
                            DataRow dr1 = dt.Select("AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                            if (dr1 != null)
                            {
                                dr1.SetField("ReferencePeriod", (maxID + 1).ToString());
                                if (dr1["YeartodateAge"].ToString() == "Y") dr1.SetField("YeartodateAge", "Y");
                                if (dr1["YeartodateFederal_OMB"].ToString() == "Y") dr1.SetField("YeartodateFederal_OMB", "Y");
                            }
                        }

                        YearIntakeAppList.Add(CasemstList[0]);
                    }
                    Count++;

                }
                //DatasetFilling(TableCnt, dt);
                //TableCnt++;

            }

            return IsCount;
        }

        private int CONTYeartoDateProcess(SSBGTYPESEntity SEntity, string Type, List<SSBGTYPESEntity> SSBGCritQuestions)
        {
            int IsCount = 0;

            List<CaseMstEntity> MSTCaseContList = new List<CaseMstEntity>();
            if (Type == "C") MSTCaseContList = propContcasemstAlllist; else if (Type == "D") MSTCaseContList = propDUPContcasemstAlllist;

            MSTCaseContList = MSTCaseContList.FindAll(u => Convert.ToDateTime(u.IntakeDate) >= Convert.ToDateTime(Ref_From_Date.Value.ToShortDateString()) && Convert.ToDateTime(u.IntakeDate) <= Convert.ToDateTime(Ref_To_Date.Value.ToShortDateString()));
            //propcasemstAlllist = propcasemstAlllist.FindAll(u => Convert.ToDateTime(u.IntakeDate) >= Convert.ToDateTime(dtpFrom.Value.ToShortDateString()) && Convert.ToDateTime(u.IntakeDate) <= Convert.ToDateTime(dtpTo.Value.ToShortDateString()));
            if (MSTCaseContList.Count > 0)
            {
                int Count = 0; //string Responces = string.Empty; 
                
                ////var DistinctQues = SSBGCritQuestions.Select(u => u.EligQuesFldName.Trim()).Distinct().ToList();
                bool IsFirst = true; int ResultCount = 0; int DupAppCnt = 0; string PrivApp = string.Empty;
                foreach (CaseMstEntity Entity in MSTCaseContList)
                {
                    string Result = string.Empty; Responces = string.Empty; FamilySeqs = string.Empty;
                    CasemstList = MSTCaseContList.FindAll(u => u.ApplNo.Equals(Entity.ApplNo) && u.ApplAgency.Equals(Entity.ApplAgency) && u.ApplDept.Equals(Entity.ApplDept) && u.ApplProgram.Equals(Entity.ApplProgram) && u.ApplYr.Equals(Entity.ApplYr));
                    caseSnpList = propCONTcaseSnpAlllist.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Trim().Equals(Entity.ApplYr.Trim())); //_model.CaseMstData.GetCaseSnpDetails(Entity.ApplAgency, Entity.ApplDept, Entity.ApplProgram, Entity.ApplYr, Entity.ApplNo);
                    //caseIncomeList = PropcaseIncomeList.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Equals(Entity.ApplYr));

                    //if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type)
                    //    CountDemographics(caseSnpList);

                    DupAppCnt++;
                    if (PrivApp != Entity.ApplNo) DupAppCnt = 1;

                    ResultCount = ExcelCount;
                    FillTableValues(SSBGCritQuestions, SEntity, dt,Type, DupAppCnt);
                    if (YearIntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || YearCaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || YearSpmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || YearCustQueslistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                    {
                        Result = "Y";
                        var AppList=new List<CaseMstEntity>();
                        if (YearIntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearIntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        else if (YearCaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearCaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        else if (YearSpmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearSpmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        else if (YearCustQueslistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearCustQueslistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        Responces = AppList[0].HeatIncRent.Trim();
                        if (SEntity.SBGTMemAccess.ToString() == "I")
                            FamilySeqs = AppList[0].HeatIncRentDesc.Trim();
                    }
                    else
                        Result = GetEligibilityStatus(SEntity, dt, "Y");

                    if (Result == "Y")
                    {
                       
                        //int minLavel = Convert.ToInt32(dt.Compute("min(AccountLevel)", string.Empty));
                        if (SEntity.SBGTMemAccess.ToString() == "I")
                        {
                            //string[] Resp = Responces.Split(',');
                            //Resp = Resp.Where(val => val != "").ToArray();
                            if (!string.IsNullOrEmpty(Responces.Trim()))
                            {
                                IsCount = IsCount + Convert.ToInt32(Responces);
                                CasemstList[0].HeatIncRent = Responces;
                                CasemstList[0].HeatIncRentDesc = FamilySeqs;
                            }
                            if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                            {
                                string[] famseqs = FamilySeqs.Split(',');
                                if (famseqs.Length > 0)
                                {
                                    int maxID = 0;
                                    for (int i = 0; i < famseqs.Length; i++)
                                    {
                                        if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                        {
                                            if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type)
                                                CountDemographics(caseSnpList, famseqs[i]);
                                            //var maxRow = dt.Select("ReferencePeriod = MAX(ReferencePeriod)");
                                            //maxID = dt.AsEnumerable().Max(r => r.Field<int>("ReferencePeriod"));
                                            ResultCount = ResultCount + 1;
                                            if (IsFirst)
                                            { IsFirst = false; }
                                            else
                                            {
                                                if (Type == "C")
                                                {
                                                    DataRow[] dr = dt.Select("CReferencePeriod = MAX([CReferencePeriod])");
                                                    if (dr != null)
                                                    {
                                                        maxID = int.Parse(dr[0]["CReferencePeriod"].ToString());
                                                    }
                                                }
                                                else if (Type == "D")
                                                {
                                                    DataRow[] dr = dt.Select("CDReferencePeriod = MAX([CDReferencePeriod])");
                                                    if (dr != null)
                                                    {
                                                        maxID = int.Parse(dr[0]["CDReferencePeriod"].ToString());
                                                    }
                                                }
                                            }
                                            if (Type == "C")
                                            {
                                                DataRow dr1 = dt.Select("FamSeq=" + "'" + famseqs[i]  + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                                if (dr1 != null)
                                                    dr1.SetField("CReferencePeriod", (maxID + 1).ToString());
                                            }
                                            else if (Type == "D")
                                            {
                                                DataRow dr1 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND RowID=" + "'" + ResultCount + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                                if (dr1 != null)
                                                {
                                                    if (string.IsNullOrEmpty(dr1["CDReferencePeriod"].ToString().Trim()))
                                                        dr1.SetField("CDReferencePeriod", (maxID + 1).ToString());
                                                    if (dr1["YeartodateAge"].ToString() == "Y") dr1.SetField("YeartodateAge", "Y");
                                                    if (dr1["YeartodateFederal_OMB"].ToString() == "Y") dr1.SetField("YeartodateFederal_OMB", "Y");
                                                }
                                                else
                                                {
                                                    DataRow drMulti = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                                    if (drMulti != null)
                                                    {
                                                        if (string.IsNullOrEmpty(drMulti["CDReferencePeriod"].ToString().Trim()))
                                                            drMulti.SetField("CDReferencePeriod", (maxID + 1).ToString());
                                                        if (drMulti["YeartodateAge"].ToString() == "Y") drMulti.SetField("YeartodateAge", "Y");
                                                        if (drMulti["YeartodateFederal_OMB"].ToString() == "Y") drMulti.SetField("YeartodateFederal_OMB", "Y");
                                                    }
                                                }

                                                DataRow dr2 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                                if (dr2 != null)
                                                {
                                                    if (dr2["YeartodateAge"].ToString() == "Y") dr2.SetField("YeartodateAge", "Y");
                                                    if (dr2["YeartodateFederal_OMB"].ToString() == "Y") dr2.SetField("YeartodateFederal_OMB", "Y");
                                                }
                                            }

                                        }
                                    }
                                }
                            }

                        }
                        else if (SEntity.SBGTMemAccess.ToString() == "F")
                        {
                            //if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type)
                            //    CountDemographics(caseSnpList, CasemstList[0].FamilySeq.Trim());
                            if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                            {
                                string[] famseqs = FamilySeqs.Split(',');
                                if (famseqs.Length > 0)
                                {
                                    for (int i = 0; i < famseqs.Length; i++)
                                    {
                                        if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                        {
                                            if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type)
                                                CountDemographics(caseSnpList, famseqs[i]);
                                        }
                                    }
                                }
                            }
                            IsCount++;
                            int maxID = 0;
                            if (IsFirst)
                            { IsFirst = false; }
                            else
                            {
                                if (Type == "C")
                                {
                                    DataRow[] dr = dt.Select("CReferencePeriod = MAX([CReferencePeriod])");
                                    if (dr != null)
                                    {
                                        maxID = int.Parse(dr[0]["CReferencePeriod"].ToString());
                                    }
                                }
                                else if (Type == "D")
                                {
                                    DataRow[] dr = dt.Select("CDReferencePeriod = MAX([CDReferencePeriod])");
                                    if (dr != null)
                                    {
                                        maxID = int.Parse(dr[0]["CDReferencePeriod"].ToString());
                                    }
                                }
                            }
                            if (Type == "C")
                            {
                                DataRow dr1 = dt.Select("AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                if (dr1 != null)
                                    dr1.SetField("CReferencePeriod", (maxID + 1).ToString());
                            }
                            else if (Type == "D")
                            {
                                DataRow dr1 = dt.Select("AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                if (dr1 != null)
                                {
                                    dr1.SetField("CDReferencePeriod", (maxID + 1).ToString());
                                    if (dr1["YeartodateAge"].ToString() == "Y") dr1.SetField("YeartodateAge", "Y");
                                    if (dr1["YeartodateFederal_OMB"].ToString() == "Y") dr1.SetField("YeartodateFederal_OMB", "Y");
                                }
                            }
                        }

                        if(Type=="C")
                            YearCaseContList.Add(CasemstList[0]);
                        else if(Type=="D")
                            YearDUPCaseContList.Add(CasemstList[0]);
                    }

                    PrivApp = Entity.ApplNo;
                    Count++;

                }
                //DatasetFilling(TableCnt, dt);
                //TableCnt++;

            }

            return IsCount;
        }

        private int ACTYeartoDateProcess(SSBGTYPESEntity SEntity, string Type, List<SSBGTYPESEntity> SSBGCritQuestions)
        {
            int IsCount = 0;

            List<CaseMstEntity> MSTActlist = new List<CaseMstEntity>();
            if (Type == "A") MSTActlist = propACTcasemstAlllist; if (Type == "B") MSTActlist = propDUPACTcasemstAlllist;

            MSTActlist = MSTActlist.FindAll(u => Convert.ToDateTime(u.IntakeDate) >= Convert.ToDateTime(Ref_From_Date.Value.ToShortDateString()) && Convert.ToDateTime(u.IntakeDate) <= Convert.ToDateTime(Ref_To_Date.Value.ToShortDateString()));
            //propcasemstAlllist = propcasemstAlllist.FindAll(u => Convert.ToDateTime(u.IntakeDate) >= Convert.ToDateTime(dtpFrom.Value.ToShortDateString()) && Convert.ToDateTime(u.IntakeDate) <= Convert.ToDateTime(dtpTo.Value.ToShortDateString()));
            if (MSTActlist.Count > 0)
            {
                int Count = 0; //string Responces = string.Empty; 
                //List<SSBGTYPESEntity> SSBGCritQuestions = SSBGTypesQues.FindAll(u => (u.SBGTID.Equals(SEntity.SBGTID) && u.SBGTCode.Equals(SEntity.SBGTCode) && (!u.SBGTGroupSeq.Equals("0"))));
                //dt = CreateTable(SSBGCritQuestions);
                ////var DistinctQues = SSBGCritQuestions.Select(u => u.EligQuesFldName.Trim()).Distinct().ToList();
                bool IsFirst = true; int ResultCount = 0; int DupAppCnt = 0; string PrivApp = string.Empty;
                foreach (CaseMstEntity Entity in MSTActlist)
                {
                    string Result = string.Empty; Responces = string.Empty; FamilySeqs = string.Empty; int DupCnt = 0;
                    CasemstList = MSTActlist.FindAll(u => u.ApplNo.Equals(Entity.ApplNo) && u.ApplAgency.Equals(Entity.ApplAgency) && u.ApplDept.Equals(Entity.ApplDept) && u.ApplProgram.Equals(Entity.ApplProgram) && u.ApplYr.Equals(Entity.ApplYr));
                    caseSnpList = propACTcaseSnpAlllist.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Trim().Equals(Entity.ApplYr.Trim())); //_model.CaseMstData.GetCaseSnpDetails(Entity.ApplAgency, Entity.ApplDept, Entity.ApplProgram, Entity.ApplYr, Entity.ApplNo);
                    //caseIncomeList = PropcaseIncomeList.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Equals(Entity.ApplYr));

                     if (CasemstList.Count > 1) CasemstList = CasemstList.FindAll(u => Convert.ToDateTime(u.IntakeDate) == Convert.ToDateTime(Entity.IntakeDate));

                    if (Entity.ApplNo == "00010101")
                    {

                    }

                    //if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type)
                    //    CountDemographics(caseSnpList);

                    DupAppCnt++;
                    if (PrivApp != Entity.ApplNo) { DupAppCnt = 1; DupCnt = 1 * caseSnpList.Count; } else DupCnt = DupAppCnt * caseSnpList.Count;

                    ResultCount = ExcelCount;
                    FillTableValues(SSBGCritQuestions, SEntity, dt,Type, DupCnt);
                    if (YearIntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || YearCaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || YearSpmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || YearCustQueslistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                    {
                        Result = "Y";
                        var AppList = new List<CaseMstEntity>();
                        if (YearIntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearIntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        else if (YearCaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearCaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        else if (YearSpmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearSpmlistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        else if (YearCustQueslistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearCustQueslistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        Responces = AppList[0].HeatIncRent.Trim();
                        if (SEntity.SBGTMemAccess.ToString() == "I")
                            FamilySeqs = AppList[0].HeatIncRentDesc.Trim();
                    }
                    else
                        Result = GetEligibilityStatus(SEntity, dt, "Y");

                    if (Result == "Y")
                    {
                        //int minLavel = Convert.ToInt32(dt.Compute("min(AccountLevel)", string.Empty));
                        if (SEntity.SBGTMemAccess.ToString() == "I")
                        {
                            //string[] Resp = Responces.Split(',');
                            //Resp = Resp.Where(val => val != "").ToArray();
                            if (!string.IsNullOrEmpty(Responces.Trim()))
                            {
                                IsCount = IsCount + 1;//Convert.ToInt32(Responces);
                                CasemstList[0].HeatIncRent = Responces;
                                CasemstList[0].HeatIncRentDesc = FamilySeqs;
                            }

                            if(!string.IsNullOrEmpty(CasemstList[0].FamilySeq))
                            {
                                if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type)
                                    CountDemographics(caseSnpList, CasemstList[0].FamilySeq);

                                int maxID = 0;

                                ResultCount = ResultCount + 1;
                                if (IsFirst)
                                { IsFirst = false; }
                                else
                                {
                                    if (Type == "A")
                                    {
                                        DataRow[] dr = dt.Select("AReferencePeriod = MAX([AReferencePeriod])");
                                        if (dr != null)
                                        {
                                            maxID = int.Parse(dr[0]["AReferencePeriod"].ToString());
                                        }
                                    }
                                    else if (Type == "B")
                                    {
                                        DataRow[] dr = dt.Select("ADReferencePeriod = MAX([ADReferencePeriod])");
                                        if (dr != null)
                                        {
                                            maxID = int.Parse(dr[0]["ADReferencePeriod"].ToString());
                                        }
                                    }
                                }
                                if (Type == "A")
                                {
                                    DataRow dr1 = dt.Select("FamSeq=" + "'" + CasemstList[0].FamilySeq + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                    if (dr1 != null)
                                        dr1.SetField("AReferencePeriod", (maxID + 1).ToString());
                                }
                                else if (Type == "B")
                                {
                                    DataRow[] drapps = dt.Select("FamSeq=" + "'" + CasemstList[0].FamilySeq + "' AND RowID>=" + "'" + ResultCount + "' AND AppNo=" + "'" + Entity.ApplNo + "'"); 

                                    DataRow dr1 = dt.Select("FamSeq=" + "'" + CasemstList[0].FamilySeq + "' AND RowID=" + "'" + ResultCount + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                    if (dr1 != null)
                                    {
                                        if (string.IsNullOrEmpty(dr1["ADReferencePeriod"].ToString().Trim()))
                                            dr1.SetField("ADReferencePeriod", (maxID + 1).ToString());
                                    }
                                    else if(drapps.Length>0)
                                    {
                                        DataRow dr5= dt.Select("FamSeq=" + "'" + drapps[0]["FamSeq"].ToString() + "' AND RowID=" + "'" + drapps[0]["RowID"].ToString() + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                        if (dr5 != null)
                                        {
                                            if (string.IsNullOrEmpty(dr5["ADReferencePeriod"].ToString().Trim()))
                                                dr5.SetField("ADReferencePeriod", (maxID + 1).ToString());
                                        }
                                    }
                                    else
                                    {
                                        DataRow drMulti = dt.Select("FamSeq=" + "'" + CasemstList[0].FamilySeq + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                        if (drMulti != null)
                                        {
                                            if (string.IsNullOrEmpty(drMulti["ADReferencePeriod"].ToString().Trim()))
                                                drMulti.SetField("ADReferencePeriod", (maxID + 1).ToString());
                                        }
                                    }

                                    DataRow dr2 = dt.Select("FamSeq=" + "'" + CasemstList[0].FamilySeq + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                    if (dr2 != null)
                                    {
                                        if (dr2["YeartodateAge"].ToString() == "Y") dr2.SetField("YeartodateAge", "Y");
                                        if (dr2["YeartodateFederal_OMB"].ToString() == "Y") dr2.SetField("YeartodateFederal_OMB", "Y");
                                    }
                                }
                            }

                            //if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                            //{
                            //    string[] famseqs = FamilySeqs.Split(',');
                            //    if (famseqs.Length > 0)
                            //    {
                            //        int maxID = 0;
                            //        for (int i = 0; i < famseqs.Length; i++)
                            //        {
                            //            if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                            //            {
                            //                if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type)
                            //                    CountDemographics(caseSnpList, famseqs[i]);
                            //                //var maxRow = dt.Select("ReferencePeriod = MAX(ReferencePeriod)");
                            //                //maxID = dt.AsEnumerable().Max(r => r.Field<int>("ReferencePeriod"));
                            //                ResultCount = ResultCount + 1;
                            //                if (IsFirst)
                            //                { IsFirst = false; }
                            //                else
                            //                {
                            //                    if (Type == "A")
                            //                    {
                            //                        DataRow[] dr = dt.Select("AReferencePeriod = MAX([AReferencePeriod])");
                            //                        if (dr != null)
                            //                        {
                            //                            maxID = int.Parse(dr[0]["AReferencePeriod"].ToString());
                            //                        }
                            //                    }
                            //                    else if (Type == "B")
                            //                    {
                            //                        DataRow[] dr = dt.Select("ADReferencePeriod = MAX([ADReferencePeriod])");
                            //                        if (dr != null)
                            //                        {
                            //                            maxID = int.Parse(dr[0]["ADReferencePeriod"].ToString());
                            //                        }
                            //                    }
                            //                }
                            //                if (Type == "A")
                            //                {
                            //                    DataRow dr1 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                            //                    if (dr1 != null)
                            //                        dr1.SetField("AReferencePeriod", (maxID + 1).ToString());
                            //                }
                            //                else if (Type == "B")
                            //                {
                            //                    DataRow dr1 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND RowID=" + "'" + ResultCount + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                            //                    if (dr1 != null)
                            //                    {
                            //                        if (string.IsNullOrEmpty(dr1["ADReferencePeriod"].ToString().Trim()))
                            //                            dr1.SetField("ADReferencePeriod", (maxID + 1).ToString());
                            //                    }
                            //                    else
                            //                    {
                            //                        DataRow drMulti = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                            //                        if (drMulti != null)
                            //                        {
                            //                            if (string.IsNullOrEmpty(drMulti["ADReferencePeriod"].ToString().Trim()))
                            //                                drMulti.SetField("ADReferencePeriod", (maxID + 1).ToString());
                            //                        }
                            //                    }

                            //                    DataRow dr2 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                            //                    if (dr2 != null)
                            //                    {
                            //                        if (dr2["YeartodateAge"].ToString() == "Y") dr2.SetField("YeartodateAge", "Y");
                            //                        if (dr2["YeartodateFederal_OMB"].ToString() == "Y") dr2.SetField("YeartodateFederal_OMB", "Y");
                            //                    }
                            //                }

                            //            }
                            //        }
                            //    }
                            //}

                        }
                        else if (SEntity.SBGTMemAccess.ToString() == "F")
                        {
                            if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                            {
                                string[] famseqs = FamilySeqs.Split(',');
                                if (famseqs.Length > 0)
                                {
                                    for (int i = 0; i < famseqs.Length; i++)
                                    {
                                        if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                        {
                                            if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type)
                                                CountDemographics(caseSnpList, famseqs[i]);
                                        }
                                    }
                                }
                            }
                            IsCount++;
                            int maxID = 0;
                            if (IsFirst)
                            { IsFirst = false; }
                            else
                            {
                                if (Type == "A")
                                {
                                    DataRow[] dr = dt.Select("AReferencePeriod = MAX([AReferencePeriod])");
                                    if (dr != null)
                                    {
                                        maxID = int.Parse(dr[0]["AReferencePeriod"].ToString());
                                    }
                                }
                                else if (Type == "B")
                                {
                                    DataRow[] dr = dt.Select("ADReferencePeriod = MAX([ADReferencePeriod])");
                                    if (dr != null)
                                    {
                                        maxID = int.Parse(dr[0]["ADReferencePeriod"].ToString());
                                    }
                                }
                            }
                            if (Type == "A")
                            {
                                DataRow dr1 = dt.Select("AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                if (dr1 != null)
                                    dr1.SetField("AReferencePeriod", (maxID + 1).ToString());
                            }
                            else if (Type == "B")
                            {
                                DataRow dr1 = dt.Select("AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                if (dr1 != null)
                                    dr1.SetField("ADReferencePeriod", (maxID + 1).ToString());
                            }
                        }

                        if(Type=="A")
                            YearCaseactList.Add(CasemstList[0]);
                        if (Type == "B")
                            YearDUPCaseactList.Add(CasemstList[0]);
                    }

                    PrivApp = Entity.ApplNo;
                    Count++;

                }
                //DatasetFilling(TableCnt, dt);
                //TableCnt++;

            }

            return IsCount;
        }

        private int SPMYeartoDateProcess(SSBGTYPESEntity SEntity, string Type, List<SSBGTYPESEntity> SSBGCritQuestions)
        {
            int IsCount = 0;

            List<CaseMstEntity> MstSpmList = new List<CaseMstEntity>();

            if (Type == "S") MstSpmList = propSPMcasemstAlllist; if (Type == "T") MstSpmList = propDUPSPMcasemstAlllist;

            MstSpmList = MstSpmList.FindAll(u => Convert.ToDateTime(u.IntakeDate) >= Convert.ToDateTime(Ref_From_Date.Value.ToShortDateString()) && Convert.ToDateTime(u.IntakeDate) <= Convert.ToDateTime(Ref_To_Date.Value.ToShortDateString()));
            //propcasemstAlllist = propcasemstAlllist.FindAll(u => Convert.ToDateTime(u.IntakeDate) >= Convert.ToDateTime(dtpFrom.Value.ToShortDateString()) && Convert.ToDateTime(u.IntakeDate) <= Convert.ToDateTime(dtpTo.Value.ToShortDateString()));
            if (MstSpmList.Count > 0)
            {
                int Count = 0; //string Responces = string.Empty; 
                //List<SSBGTYPESEntity> SSBGCritQuestions = SSBGTypesQues.FindAll(u => (u.SBGTID.Equals(SEntity.SBGTID) && u.SBGTCode.Equals(SEntity.SBGTCode) && (!u.SBGTGroupSeq.Equals("0"))));
                //dt = CreateTable(SSBGCritQuestions);
                ////var DistinctQues = SSBGCritQuestions.Select(u => u.EligQuesFldName.Trim()).Distinct().ToList();
                bool IsFirst = true; int ResultCount = 0; int DupAppCnt = 0; string PrivApp = string.Empty;
                foreach (CaseMstEntity Entity in MstSpmList)
                {
                    string Result = string.Empty; Responces = string.Empty; FamilySeqs = string.Empty;
                    CasemstList = MstSpmList.FindAll(u => u.ApplNo.Equals(Entity.ApplNo) && u.ApplAgency.Equals(Entity.ApplAgency) && u.ApplDept.Equals(Entity.ApplDept) && u.ApplProgram.Equals(Entity.ApplProgram) && u.ApplYr.Equals(Entity.ApplYr));
                    caseSnpList = propSPMcaseSnpAlllist.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Trim().Equals(Entity.ApplYr.Trim())); //_model.CaseMstData.GetCaseSnpDetails(Entity.ApplAgency, Entity.ApplDept, Entity.ApplProgram, Entity.ApplYr, Entity.ApplNo);
                    //caseIncomeList = PropcaseIncomeList.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Equals(Entity.ApplYr));
                    //if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type)
                    //    CountDemographics(caseSnpList);

                    DupAppCnt++;
                    if (PrivApp != Entity.ApplNo) DupAppCnt = 1;

                    ResultCount = ExcelCount;
                    FillTableValues(SSBGCritQuestions, SEntity, dt,Type, DupAppCnt);
                    if (YearIntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || YearCaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || YearCaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || YearCustQueslistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                    { 
                        Result = "Y";
                        var AppList = new List<CaseMstEntity>();
                        if (YearIntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearIntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        else if (YearCaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearCaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        else if (YearCaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearCaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        else if (YearCustQueslistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearCustQueslistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        Responces = AppList[0].HeatIncRent.Trim();
                        if (SEntity.SBGTMemAccess.ToString() == "I")
                            FamilySeqs = AppList[0].HeatIncRentDesc.Trim();
                    }
                    else
                        Result = GetEligibilityStatus(SEntity, dt, "Y");

                    if (Result == "Y")
                    {
                        //int minLavel = Convert.ToInt32(dt.Compute("min(AccountLevel)", string.Empty));
                        if (SEntity.SBGTMemAccess.ToString() == "I")
                        {
                            
                            //string[] Resp = Responces.Split(',');
                            //Resp = Resp.Where(val => val != "").ToArray();
                            if (!string.IsNullOrEmpty(Responces.Trim()))
                            {
                                IsCount = IsCount + 1;//Convert.ToInt32(Responces);
                                CasemstList[0].HeatIncRent = Responces;
                                CasemstList[0].HeatIncRentDesc = FamilySeqs;
                            }
                            if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                            {
                                string[] famseqs = FamilySeqs.Split(',');
                                if (famseqs.Length > 0)
                                {
                                    int maxID = 0;
                                    for (int i = 0; i < famseqs.Length; i++)
                                    {
                                        if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                        {
                                            if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type)
                                                CountDemographics(caseSnpList, famseqs[i]);
                                            ResultCount = ResultCount + 1;
                                            //var maxRow = dt.Select("ReferencePeriod = MAX(ReferencePeriod)");
                                            //maxID = dt.AsEnumerable().Max(r => r.Field<int>("ReferencePeriod"));
                                            if (IsFirst)
                                            { IsFirst = false; }
                                            else
                                            {
                                                if (Type == "S")
                                                {
                                                    DataRow[] dr = dt.Select("SReferencePeriod = MAX([SReferencePeriod])");
                                                    if (dr != null)
                                                    {
                                                        maxID = int.Parse(dr[0]["SReferencePeriod"].ToString());
                                                    }
                                                }
                                                else if (Type == "T")
                                                {
                                                    DataRow[] dr = dt.Select("SDReferencePeriod = MAX([SDReferencePeriod])");
                                                    if (dr != null)
                                                    {
                                                        maxID = int.Parse(dr[0]["SDReferencePeriod"].ToString());
                                                    }
                                                }
                                            }
                                            if (Type == "S")
                                            {
                                                DataRow dr1 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                                if (dr1 != null)
                                                    dr1.SetField("SReferencePeriod", (maxID + 1).ToString());
                                            }
                                            else if (Type == "T")
                                            {
                                                DataRow dr1 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND RowID=" + "'" + ResultCount + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                                if (dr1 != null)
                                                {
                                                    if (string.IsNullOrEmpty(dr1["SDReferencePeriod"].ToString().Trim()))
                                                        dr1.SetField("SDReferencePeriod", (maxID + 1).ToString());
                                                }
                                                else
                                                {
                                                    DataRow drMulti = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                                    if (drMulti != null)
                                                    {
                                                        if (string.IsNullOrEmpty(drMulti["SDReferencePeriod"].ToString().Trim()))
                                                            drMulti.SetField("SDReferencePeriod", (maxID + 1).ToString());
                                                    }
                                                }

                                                DataRow dr2 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                                if (dr2 != null)
                                                {
                                                    if (dr2["YeartodateAge"].ToString() == "Y") dr2.SetField("YeartodateAge", "Y");
                                                    if (dr2["YeartodateFederal_OMB"].ToString() == "Y") dr2.SetField("YeartodateFederal_OMB", "Y");
                                                }
                                            }

                                        }
                                    }
                                }
                            }

                        }
                        else if (SEntity.SBGTMemAccess.ToString() == "F")
                        {
                            if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                            {
                                string[] famseqs = FamilySeqs.Split(',');
                                if (famseqs.Length > 0)
                                {
                                    for (int i = 0; i < famseqs.Length; i++)
                                    {
                                        if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                        {
                                            if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == Type)
                                                CountDemographics(caseSnpList, famseqs[i]);
                                        }
                                    }
                                }
                            }
                            IsCount++;
                            int maxID = 0;
                            if (IsFirst)
                            { IsFirst = false; }
                            else
                            {
                                if (Type == "S")
                                {
                                    DataRow[] dr = dt.Select("SReferencePeriod = MAX([SReferencePeriod])");
                                    if (dr != null)
                                    {
                                        maxID = int.Parse(dr[0]["SReferencePeriod"].ToString());
                                    }
                                }
                                else if (Type == "T")
                                {
                                    DataRow[] dr = dt.Select("SDReferencePeriod = MAX([SDReferencePeriod])");
                                    if (dr != null)
                                    {
                                        maxID = int.Parse(dr[0]["SDReferencePeriod"].ToString());
                                    }
                                }
                            }
                            if (Type == "S")
                            {
                                DataRow dr1 = dt.Select("AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                if (dr1 != null)
                                    dr1.SetField("SReferencePeriod", (maxID + 1).ToString());
                            }
                            else if (Type == "T")
                            {
                                DataRow dr1 = dt.Select("AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                if (dr1 != null)
                                    dr1.SetField("SDReferencePeriod", (maxID + 1).ToString());
                            }
                        }

                        if(Type=="S")
                            YearSpmlistcnt.Add(CasemstList[0]);
                        if (Type == "T")
                            YearDUPSpmlistcnt.Add(CasemstList[0]);
                    }

                    PrivApp = Entity.ApplNo;

                    Count++;

                }
                //DatasetFilling(TableCnt, dt);
                //TableCnt++;

            }

            return IsCount;
        }

        private int CustQuesYeartoDateProcess(SSBGTYPESEntity SEntity, string Type, string CustCode, List<SSBGTYPESEntity> SSBGCritQuestions)
        {
            int IsCount = 0;

            //List<CaseMstEntity> MstSpmList = new List<CaseMstEntity>();

            //if (Type == "S") MstSpmList = propSPMcasemstAlllist; if (Type == "T") MstSpmList = propDUPSPMcasemstAlllist;

            propADDCUSTcasemstAlllist = propADDCUSTcasemstAlllist.FindAll(u => Convert.ToDateTime(u.IntakeDate) >= Convert.ToDateTime(Ref_From_Date.Value.ToShortDateString()) && Convert.ToDateTime(u.IntakeDate) <= Convert.ToDateTime(Ref_To_Date.Value.ToShortDateString()) && u.CUST_Code.Equals(CustCode));

            //propcasemstAlllist = propcasemstAlllist.FindAll(u => Convert.ToDateTime(u.IntakeDate) >= Convert.ToDateTime(dtpFrom.Value.ToShortDateString()) && Convert.ToDateTime(u.IntakeDate) <= Convert.ToDateTime(dtpTo.Value.ToShortDateString()));
            if (propADDCUSTcasemstAlllist.Count > 0)
            {
                int Count = 0; //string Responces = string.Empty; 
                //List<SSBGTYPESEntity> SSBGCritQuestions = SSBGTypesQues.FindAll(u => (u.SBGTID.Equals(SEntity.SBGTID) && u.SBGTCode.Equals(SEntity.SBGTCode) && (!u.SBGTGroupSeq.Equals("0"))));
                //dt = CreateTable(SSBGCritQuestions);
                ////var DistinctQues = SSBGCritQuestions.Select(u => u.EligQuesFldName.Trim()).Distinct().ToList();
                bool IsFirst = true;
                foreach (CaseMstEntity Entity in propADDCUSTcasemstAlllist)
                {
                    string Result = string.Empty; Responces = string.Empty; FamilySeqs = string.Empty;
                    CasemstList = propADDCUSTcasemstAlllist.FindAll(u => u.ApplNo.Equals(Entity.ApplNo) && u.ApplAgency.Equals(Entity.ApplAgency) && u.ApplDept.Equals(Entity.ApplDept) && u.ApplProgram.Equals(Entity.ApplProgram) && u.ApplYr.Equals(Entity.ApplYr));
                    caseSnpList = propADDCUSTcaseSnpAlllist.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Trim().Equals(Entity.ApplYr.Trim())); //_model.CaseMstData.GetCaseSnpDetails(Entity.ApplAgency, Entity.ApplDept, Entity.ApplProgram, Entity.ApplYr, Entity.ApplNo);
                    //caseIncomeList = PropcaseIncomeList.FindAll(u => u.App.Equals(Entity.ApplNo) && u.Agency.Equals(Entity.ApplAgency) && u.Dept.Equals(Entity.ApplDept) && u.Program.Equals(Entity.ApplProgram) && u.Year.Equals(Entity.ApplYr));
                    //if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == "Q")
                    //    CountDemographics(caseSnpList);

                    FillTableValues(SSBGCritQuestions, SEntity, dt,"Q",0);
                    if (YearIntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || YearCaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0 || YearCaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                    {
                        Result = "Y";
                        var AppList = new List<CaseMstEntity>();
                        if (YearIntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearIntakeAppList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        else if (YearCaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearCaseContList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        else if (YearCaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearCaseactList.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        else if (YearCustQueslistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo)).Count > 0)
                            AppList = YearCustQueslistcnt.FindAll(u => u.ApplNo.Equals(CasemstList[0].ApplNo));
                        Responces = AppList[0].HeatIncRent.Trim();
                        if (SEntity.SBGTMemAccess.ToString() == "I")
                            FamilySeqs = AppList[0].HeatIncRentDesc.Trim();
                    }
                    else
                        Result = GetEligibilityStatus(SEntity, dt, "Y");

                    if (Result == "Y")
                    {
                        
                        //int minLavel = Convert.ToInt32(dt.Compute("min(AccountLevel)", string.Empty));
                        if (SEntity.SBGTMemAccess.ToString() == "I")
                        {

                            //string[] Resp = Responces.Split(',');
                            //Resp = Resp.Where(val => val != "").ToArray();
                            if (!string.IsNullOrEmpty(Responces.Trim()))
                            {
                                IsCount = IsCount + Convert.ToInt32(Responces);
                                CasemstList[0].HeatIncRent = Responces;
                                CasemstList[0].HeatIncRentDesc = FamilySeqs;
                            }
                            if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                            {
                                string[] famseqs = FamilySeqs.Split(',');
                                if (famseqs.Length > 0)
                                {
                                    int maxID = 0;
                                    for (int i = 0; i < famseqs.Length; i++)
                                    {
                                        if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                        {
                                            if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == "Q")
                                                CountDemographics(caseSnpList,famseqs[i]);
                                            //var maxRow = dt.Select("ReferencePeriod = MAX(ReferencePeriod)");
                                            //maxID = dt.AsEnumerable().Max(r => r.Field<int>("ReferencePeriod"));
                                            if (IsFirst)
                                            { IsFirst = false; }
                                            else
                                            {
                                                DataRow[] dr = dt.Select("QReferencePeriod = MAX([QReferencePeriod])");
                                                if (dr != null)
                                                {
                                                    maxID = int.Parse(dr[0]["QReferencePeriod"].ToString());
                                                }
                                            }
                                            DataRow dr1 = dt.Select("FamSeq=" + "'" + famseqs[i] + "' AND AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                                            if (dr1 != null)
                                                dr1.SetField("QReferencePeriod", (maxID + 1).ToString());

                                        }
                                    }
                                }
                            }

                        }
                        else if (SEntity.SBGTMemAccess.ToString() == "F")
                        {
                            if (!string.IsNullOrEmpty(FamilySeqs.Trim()))
                            {
                                string[] famseqs = FamilySeqs.Split(',');
                                if (famseqs.Length > 0)
                                {
                                    for (int i = 0; i < famseqs.Length; i++)
                                    {
                                        if (!string.IsNullOrEmpty(famseqs[i].Trim()))
                                        {
                                            if (((Captain.Common.Utilities.ListItem)cmbDemo.SelectedItem).Value.ToString() == "Q")
                                                CountDemographics(caseSnpList, famseqs[i]);
                                        }
                                    }
                                }
                            }
                            IsCount++;
                            int maxID = 0;
                            if (IsFirst)
                            { IsFirst = false; }
                            else
                            {
                                DataRow[] dr = dt.Select("QReferencePeriod = MAX([QReferencePeriod])");
                                if (dr != null)
                                {
                                    maxID = int.Parse(dr[0]["QReferencePeriod"].ToString());
                                }
                            }
                            DataRow dr1 = dt.Select("AppNo=" + "'" + Entity.ApplNo + "'").FirstOrDefault();
                            if (dr1 != null)
                                dr1.SetField("QReferencePeriod", (maxID + 1).ToString());
                        }
                        //if (Type == "S")
                        //    YearSpmlistcnt.Add(CasemstList[0]);
                        //if (Type == "T")
                            YearCustQueslistcnt.Add(CasemstList[0]);
                    }

                    Count++;

                }
                //DatasetFilling(TableCnt, dt);
                //TableCnt++;

            }

            return IsCount;
        }

        int intQuestionCount = 0; bool First = true; DataSet ds = new DataSet(); DataSet dsObj = new DataSet();
        private string GetEligibilityStatus(SSBGTYPESEntity SEntity,DataTable dt,string Rep)
        {
            string ISEligble = "N";
            //foreach (CommonEntity caseHierchy in caseEligStatusList)
            //{

            // List<CaseELIGEntity> caseEligGroups = caseEligEntityOnlyGroups.FindAll(u => ((u.EligAgency + u.EligDept + u.EligProgram).Equals(caseHierchy.Hierarchy)) && (u.EligGroupSeq.Equals("0")));
            if (SSBGTypesGroups.Count > 0)
            {
                List<SSBGTYPESEntity> SelSSBGGroups = SSBGTypesGroups.FindAll(u => u.SBGTCode.Equals(SEntity.SBGTCode));

                caseGroupResult = new List<CaseGroupResult>();
                string strGroupConjunction = string.Empty;
                string strGroupPreviousResult = string.Empty;
                string strGroupResult = string.Empty; string Values = string.Empty; int Clmn = 0;
                foreach (SSBGTYPESEntity ELigitemGroup in SelSSBGGroups)
                {
                    caseQuestionResult = new List<CaseQuestionResult>();
                    List<SSBGTYPESEntity> SSBGCritQuestions = SSBGTypesQues.FindAll(u => (u.SBGTID.Equals(ELigitemGroup.SBGTID) && u.SBGTCode.Equals(SEntity.SBGTCode) && (!u.SBGTGroupSeq.Equals("0")) && (u.SBGTGroup.Equals(ELigitemGroup.SBGTGroup))));



                    foreach (SSBGTYPESEntity EligitemQuestion in SSBGCritQuestions)
                    {

                        string strEqual = string.Empty;
                        string strLessthan = string.Empty;
                        string strGraterthan = string.Empty;
                        //if (!EligitemQuestion.TrigAgyCode.StartsWith("C"))
                        //{
                        CaseELIGQUESEntity EligQues = EligQuestionsData.Find(u => u.EligQuesCode.Equals(EligitemQuestion.SBGTQuesCode));
                        List<CaseSnpEntity> casesnpQuestion = null; List<EAPFPEntity> EAPFPQuestion = null;
                        List<CaseMstEntity> caseMstQuestion = null; List<STATUSCKEntity> StatusCKQuestion = null;
                        List<LIHEAPBEntity> LPBQuestion = null; List<PAYMNETEntity> PaymentQuestion = null;

                        switch (EligQues.EligFldName.Trim())
                        {
                            case Consts.EligQues.Age:
                                QuestionNumericConditions(EligQues.EligRespType.Trim(), EligitemQuestion, out strEqual, out strLessthan, out strGraterthan);
                                casesnpQuestion = caseSnpList.FindAll(u => u.DobNa.Equals("0"));

                                if (casesnpQuestion.Count > 0)
                                {
                                    //Responces = Responces + "," + casesnpQuestion[0].Age;

                                    if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan == string.Empty)//Equal
                                    {
                                        casesnpQuestion = casesnpQuestion.FindAll(u => (Convert.ToDecimal(u.Age == string.Empty ? 0 : Convert.ToDecimal(u.Age)).Equals(Convert.ToDecimal(strEqual))));
                                    }
                                    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Lessthan
                                    {
                                        casesnpQuestion = casesnpQuestion.FindAll(u => (Convert.ToDecimal(u.Age == string.Empty ? 0 : Convert.ToDecimal(u.Age)) < Convert.ToDecimal(strLessthan)));
                                    }
                                    else if (strEqual == string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Greaterthan
                                    {
                                        casesnpQuestion = casesnpQuestion.FindAll(u => (Convert.ToDecimal(u.Age == string.Empty ? 0 : Convert.ToDecimal(u.Age)) > Convert.ToDecimal(strGraterthan)));
                                    }
                                    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Equal and Lessthan
                                    {
                                        casesnpQuestion = casesnpQuestion.FindAll(u => ((Convert.ToDecimal(u.Age == string.Empty ? 0 : Convert.ToDecimal(u.Age)) == Convert.ToDecimal(strEqual)) || Convert.ToDecimal(u.Age == string.Empty ? 0 : Convert.ToDecimal(u.Age)) < Convert.ToDecimal(strLessthan)));
                                    }
                                    else if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Equal and graterthan
                                    {
                                        casesnpQuestion = casesnpQuestion.FindAll(u => ((Convert.ToDecimal(u.Age == string.Empty ? 0 : Convert.ToDecimal(u.Age)) == Convert.ToDecimal(strEqual)) || Convert.ToDecimal(u.Age == string.Empty ? 0 : Convert.ToDecimal(u.Age)) > Convert.ToDecimal(strGraterthan)));
                                    }
                                    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Leasthan and greaterthan
                                    {
                                        casesnpQuestion = casesnpQuestion.FindAll(u => ((Convert.ToDecimal(u.Age == string.Empty ? 0 : Convert.ToDecimal(u.Age)) > Convert.ToDecimal(strGraterthan)) || Convert.ToDecimal(u.Age == string.Empty ? 0 : Convert.ToDecimal(u.Age)) < Convert.ToDecimal(strLessthan)));
                                    }
                                    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Equal and Leasthan and greaterthan
                                    {
                                        casesnpQuestion = casesnpQuestion.FindAll(u => ((Convert.ToDecimal(u.Age == string.Empty ? 0 : Convert.ToDecimal(u.Age)) == Convert.ToDecimal(strEqual)) || (Convert.ToDecimal(u.Age == string.Empty ? 0 : Convert.ToDecimal(u.Age)) < Convert.ToDecimal(strLessthan)) || (Convert.ToDecimal(u.Age == string.Empty ? 0 : Convert.ToDecimal(u.Age)) > Convert.ToDecimal(strGraterthan))));
                                    }
                                    if (EligitemQuestion.SBGTMemAccess == "A")
                                        casesnpQuestion = casesnpQuestion.FindAll(u => u.FamilySeq.Equals(CasemstList[0].FamilySeq));

                                    if (casesnpQuestion.Count>0)
                                    {
                                        QuestionType(EligitemQuestion.SBGTMemAccess, EligitemQuestion, casesnpQuestion.Count);

                                        if (SEntity.SBGTMemAccess.Trim() == "I")
                                        {
                                            foreach (CaseSnpEntity Entity in casesnpQuestion)
                                            {
                                                DataRow dr1 = dt.Select("FamSeq=" + "'" + Entity.FamilySeq + "' AND AppNo=" + "'" + Entity.App + "'").FirstOrDefault();
                                                if (dr1 != null)
                                                {
                                                    dr1.SetField(EligQues.EligQuesDesc, Entity.Age); 
                                                    if(Rep=="B")
                                                        dr1.SetField("Bypass" + EligQues.EligQuesDesc.Replace(' ','_'), "Y");
                                                    else
                                                        dr1.SetField("Yeartodate" + EligQues.EligQuesDesc.Replace(' ', '_'), "Y");

                                                    FamilySeqs=FamilySeqs+","+Entity.FamilySeq;
                                                }
                                            }
                                        }
                                        else if (SEntity.SBGTMemAccess.Trim() == "F")
                                        {
                                            DataRow dr1 = dt.Select("AppNo=" + "'" + CasemstList[0].ApplNo + "'").FirstOrDefault();
                                            if (dr1 != null)
                                            {
                                                dr1.SetField(EligQues.EligQuesDesc, casesnpQuestion[0].Age);
                                                if (Rep == "B")
                                                    dr1.SetField("Bypass" + EligQues.EligQuesDesc.Replace(' ', '_'), "Y");
                                                else
                                                    dr1.SetField("Yeartodate" + EligQues.EligQuesDesc.Replace(' ', '_'), "Y");
                                                foreach (CaseSnpEntity Entity in casesnpQuestion)
                                                {
                                                   FamilySeqs = FamilySeqs + "," + Entity.FamilySeq;
                                                }
                                            }
                                        }
                                    }
                                    else
                                        QuestionType(EligitemQuestion.SBGTMemAccess, EligitemQuestion, 0);

                                    Responces = casesnpQuestion.Count.ToString();
                                }
                                else
                                    QuestionType(EligitemQuestion.SBGTMemAccess, EligitemQuestion, 0);

                                break;
                            case Consts.EligQues.IncomeTypes:
                                List<CaseIncomeEntity> caseIncomeQuestin = null;
                                if (EligitemQuestion.SBGTMemAccess.ToString().Trim() == "*" || EligitemQuestion.SBGTMemAccess.ToString().Trim() == "1")
                                {
                                    caseIncomeQuestin = caseIncomeList.FindAll(u => u.Type.Equals(EligitemQuestion.SBGTRESP));
                                }
                                else
                                {
                                    caseIncomeQuestin = caseIncomeList.FindAll(u => u.Type.Equals(EligitemQuestion.SBGTRESP) && u.FamilySeq.Equals(CasemstList[0].FamilySeq));
                                }
                                if (EligitemQuestion.SBGTMemAccess == "A")
                                    caseIncomeQuestin = caseIncomeQuestin.FindAll(u => u.FamilySeq.Equals(CasemstList[0].FamilySeq));
                                QuestionType(EligitemQuestion.SBGTMemAccess, EligitemQuestion, caseIncomeQuestin.Count);
                                //casesnpQuestion = CaseSnpList.FindAll(u => u.IncomeTypes.Equals(EligitemQuestion.EligDDResponce));
                                break;
                            case Consts.EligQues.Disability:
                                casesnpQuestion = caseSnpList.FindAll(u => u.Disable.Equals(EligitemQuestion.SBGTRESP));
                                if (EligitemQuestion.SBGTMemAccess == "A")
                                    casesnpQuestion = casesnpQuestion.FindAll(u => u.FamilySeq.Equals(CasemstList[0].FamilySeq));

                                QuestionType(EligitemQuestion.SBGTMemAccess, EligitemQuestion, casesnpQuestion.Count);
                                break;
                           
                            //case Consts.TrigQues.Education:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.Education.Equals(EligitemQuestion.TRIGCRITDDTextResp));
                            //    QuestionType(EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            //case Consts.TrigQues.Resident:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.Resident.Equals(EligitemQuestion.TRIGCRITDDTextResp));
                            //    QuestionType(EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            //case Consts.EligQues.HealthIns:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.HealthIns.Equals(EligitemQuestion.TRIGCRITDDTextResp));
                            //    QuestionType(EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            //case Consts.EligQues.FoodStamps:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.FootStamps.Equals(EligitemQuestion.TRIGCRITDDTextResp));
                            //    QuestionType(EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            //case Consts.EligQues.WIC:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.Wic.Equals(EligitemQuestion.TRIGCRITDDTextResp));
                            //    QuestionType(EligitemQuestion, casesnpQuestion.Count);
                            //    break;

                            //case Consts.EligQues.EthnicCodes:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.Ethnic.Equals(EligitemQuestion.TRIGCRITDDTextResp));
                            //    QuestionType(EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            case Consts.EligQues.FamilyTypes:
                                caseMstQuestion = CasemstList.FindAll(u => u.FamilyType.Equals(EligitemQuestion.SBGTRESP));
                                QuestionType(EligitemQuestion.SBGTMemAccess, EligitemQuestion, caseMstQuestion.Count);
                                //Responces = Responces + "," + caseMstQuestion[0].FamilyType;
                                break;
                            case Consts.EligQues.Housing:
                                caseMstQuestion = CasemstList.FindAll(u => u.Housing.Equals(EligitemQuestion.SBGTRESP));
                                QuestionType(EligitemQuestion.SBGTMemAccess, EligitemQuestion, caseMstQuestion.Count);
                                //Responces = Responces + "," + caseMstQuestion[0].Housing;
                                break;
                            //case Consts.EligQues.Sex:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.Sex.Equals(EligitemQuestion.TRIGCRITDDTextResp));
                            //    QuestionType(EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            //case Consts.EligQues.Veteran:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.Vet.Equals(EligitemQuestion.TRIGCRITDDTextResp));
                            //    QuestionType(EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            //case Consts.EligQues.Farmer:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.Farmer.Equals(EligitemQuestion.TRIGCRITDDTextResp));
                            //    QuestionType(EligitemQuestion, casesnpQuestion.Count);
                            //    break;

                            case Consts.EligQues.PrimaryLanguage:
                                caseMstQuestion = CasemstList.FindAll(u => u.Language.Equals(EligitemQuestion.SBGTRESP));
                                QuestionType(EligitemQuestion.SBGTMemAccess, EligitemQuestion, caseMstQuestion.Count);
                                //Responces = Responces + "," + caseMstQuestion[0].Language;
                                break;
                            case Consts.EligQues.FederalOMB:
                                if (CasemstList[0].EligDate != string.Empty)
                                {
                                    QuestionNumericConditions(EligQues.EligRespType.Trim(), EligitemQuestion, out strEqual, out strLessthan, out strGraterthan);
                                    if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan == string.Empty)//Equal
                                    {
                                        caseMstQuestion = CasemstList.FindAll(u => (Convert.ToDecimal(u.Poverty == string.Empty ? 0 : Convert.ToDecimal(u.Poverty)).Equals(Convert.ToDecimal(strEqual))));
                                    }
                                    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Lessthan
                                    {
                                        caseMstQuestion = CasemstList.FindAll(u => (Convert.ToDecimal(u.Poverty == string.Empty ? 0 : Convert.ToDecimal(u.Poverty)) < Convert.ToDecimal(strLessthan)));
                                    }
                                    else if (strEqual == string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Greaterthan
                                    {
                                        caseMstQuestion = CasemstList.FindAll(u => (Convert.ToDecimal(u.Poverty == string.Empty ? 0 : Convert.ToDecimal(u.Poverty)) > Convert.ToDecimal(strGraterthan)));
                                    }
                                    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Equal and Lessthan
                                    {
                                        caseMstQuestion = CasemstList.FindAll(u => ((Convert.ToDecimal(u.Poverty == string.Empty ? 0 : Convert.ToDecimal(u.Poverty)) == Convert.ToDecimal(strEqual)) || Convert.ToDecimal(u.Poverty == string.Empty ? 0 : Convert.ToDecimal(u.Poverty)) < Convert.ToDecimal(strLessthan)));
                                    }
                                    else if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Equal and graterthan
                                    {
                                        caseMstQuestion = CasemstList.FindAll(u => ((Convert.ToDecimal(u.Poverty == string.Empty ? 0 : Convert.ToDecimal(u.Poverty)) == Convert.ToDecimal(strEqual)) || Convert.ToDecimal(u.Poverty == string.Empty ? 0 : Convert.ToDecimal(u.Poverty)) > Convert.ToDecimal(strGraterthan)));
                                    }
                                    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Leasthan and greaterthan
                                    {
                                        caseMstQuestion = CasemstList.FindAll(u => ((Convert.ToDecimal(u.Poverty == string.Empty ? 0 : Convert.ToDecimal(u.Poverty)) > Convert.ToDecimal(strGraterthan)) || Convert.ToDecimal(u.Poverty == string.Empty ? 0 : Convert.ToDecimal(u.Poverty)) < Convert.ToDecimal(strLessthan)));
                                    }
                                    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Equal and Leasthan and greaterthan
                                    {
                                        caseMstQuestion = CasemstList.FindAll(u => ((Convert.ToDecimal(u.Poverty == string.Empty ? 0 : Convert.ToDecimal(u.Poverty)) == Convert.ToDecimal(strEqual)) || (Convert.ToDecimal(u.Poverty == string.Empty ? 0 : Convert.ToDecimal(u.Poverty)) < Convert.ToDecimal(strLessthan)) || (Convert.ToDecimal(u.Poverty == string.Empty ? 0 : Convert.ToDecimal(u.Poverty)) > Convert.ToDecimal(strGraterthan))));
                                    }
                                    if (caseMstQuestion.Count>0)
                                    {
                                        QuestionType(EligitemQuestion.SBGTMemAccess, EligitemQuestion, caseMstQuestion.Count);

                                        var rowsToUpdate = dt.AsEnumerable().Where(r => r.Field<string>("AppNo") == caseMstQuestion[0].ApplNo);
                                        DataRow dr1 = dt.Select("FamSeq=" + "'" + caseMstQuestion[0].FamilySeq + "' AND AppNo=" + "'" + caseMstQuestion[0].ApplNo + "'").FirstOrDefault();
                                        //if(dr1!=null)
                                        //    dr1.SetField(EligQues.EligQuesDesc, caseMstQuestion[0].Poverty);
                                        foreach (var row in rowsToUpdate)
                                        {
                                            row.SetField(EligQues.EligQuesDesc, " ");
                                            if (Rep == "B")
                                                row.SetField("Bypass" + EligQues.EligQuesDesc.Replace(' ', '_'), "Y");
                                            else
                                                row.SetField("Yeartodate" + EligQues.EligQuesDesc.Replace(' ', '_'), "Y");
                                        }
                                        if (dr1 != null)
                                            dr1.SetField(EligQues.EligQuesDesc, caseMstQuestion[0].Poverty);
                                        //DataRow dr1 = dt.Select("AppNo=" + "'" + caseMstQuestion[0].ApplNo + "'").FirstOrDefault();
                                        //if (dr1 != null)
                                        //{
                                        //    dr1.SetField(EligQues.EligQuesDesc, caseMstQuestion[0].Poverty); dr1.SetField("Bypass" + EligQues.EligQuesDesc, "Y");
                                        //}
                                    }
                                    else
                                        QuestionType(EligitemQuestion.SBGTMemAccess, EligitemQuestion, 0);
                                }
                                else
                                    QuestionType(EligitemQuestion.SBGTMemAccess, EligitemQuestion, 0);

                                    //Responces = Responces + "," + caseMstQuestion.Count.ToString();
                                break;
                            //case Consts.EligQues.SMI:
                            //    QuestionNumericConditions(EligQues.EligRespType.Trim(), EligitemQuestion, out strEqual, out strLessthan, out strGraterthan);

                            //    if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan == string.Empty)//Equal
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.Smi == string.Empty ? 0 : Convert.ToDecimal(u.Smi)).Equals(Convert.ToDecimal(strEqual))));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Lessthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.Smi == string.Empty ? 0 : Convert.ToDecimal(u.Smi)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.Smi == string.Empty ? 0 : Convert.ToDecimal(u.Smi)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Equal and Lessthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.Smi == string.Empty ? 0 : Convert.ToDecimal(u.Smi)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.Smi == string.Empty ? 0 : Convert.ToDecimal(u.Smi)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Equal and graterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.Smi == string.Empty ? 0 : Convert.ToDecimal(u.Smi)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.Smi == string.Empty ? 0 : Convert.ToDecimal(u.Smi)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Leasthan and greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.Smi == string.Empty ? 0 : Convert.ToDecimal(u.Smi)) > Convert.ToDecimal(strGraterthan)) && Convert.ToDecimal(u.Smi == string.Empty ? 0 : Convert.ToDecimal(u.Smi)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Equal and Leasthan and greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.Smi == string.Empty ? 0 : Convert.ToDecimal(u.Smi)) == Convert.ToDecimal(strEqual)) && (Convert.ToDecimal(u.Smi == string.Empty ? 0 : Convert.ToDecimal(u.Smi)) < Convert.ToDecimal(strLessthan)) && (Convert.ToDecimal(u.Smi == string.Empty ? 0 : Convert.ToDecimal(u.Smi)) > Convert.ToDecimal(strGraterthan))));
                            //    }
                            //    if (caseMstQuestion != null)
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, caseMstQuestion.Count);
                            //    else
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, 0);
                            //    break;
                            //case Consts.EligQues.CMI:
                            //    QuestionNumericConditions(EligQues.EligRespType.Trim(), EligitemQuestion, out strEqual, out strLessthan, out strGraterthan);

                            //    if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan == string.Empty)//Equal
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.Cmi == string.Empty ? 0 : Convert.ToDecimal(u.Cmi)).Equals(Convert.ToDecimal(strEqual))));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Lessthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.Cmi == string.Empty ? 0 : Convert.ToDecimal(u.Cmi)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.Cmi == string.Empty ? 0 : Convert.ToDecimal(u.Cmi)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Equal and Lessthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.Cmi == string.Empty ? 0 : Convert.ToDecimal(u.Cmi)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.Cmi == string.Empty ? 0 : Convert.ToDecimal(u.Cmi)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Equal and graterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.Cmi == string.Empty ? 0 : Convert.ToDecimal(u.Cmi)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.Cmi == string.Empty ? 0 : Convert.ToDecimal(u.Cmi)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Leasthan and greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.Cmi == string.Empty ? 0 : Convert.ToDecimal(u.Cmi)) > Convert.ToDecimal(strGraterthan)) && Convert.ToDecimal(u.Cmi == string.Empty ? 0 : Convert.ToDecimal(u.Cmi)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Equal and Leasthan and greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.Cmi == string.Empty ? 0 : Convert.ToDecimal(u.Cmi)) == Convert.ToDecimal(strEqual)) && (Convert.ToDecimal(u.Cmi == string.Empty ? 0 : Convert.ToDecimal(u.Cmi)) < Convert.ToDecimal(strLessthan)) && (Convert.ToDecimal(u.Cmi == string.Empty ? 0 : Convert.ToDecimal(u.Cmi)) > Convert.ToDecimal(strGraterthan))));
                            //    }
                            //    if (caseMstQuestion != null)
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, caseMstQuestion.Count);
                            //    else
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, 0);
                            //    break;
                            //case Consts.EligQues.HUD:
                            //    QuestionNumericConditions(EligQues.EligRespType.Trim(), EligitemQuestion, out strEqual, out strLessthan, out strGraterthan);

                            //    if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan == string.Empty)//Equal
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.Hud == string.Empty ? 0 : Convert.ToDecimal(u.Hud)).Equals(Convert.ToDecimal(strEqual))));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Lessthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.Hud == string.Empty ? 0 : Convert.ToDecimal(u.Hud)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.Hud == string.Empty ? 0 : Convert.ToDecimal(u.Hud)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Equal and Lessthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.Hud == string.Empty ? 0 : Convert.ToDecimal(u.Hud)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.Hud == string.Empty ? 0 : Convert.ToDecimal(u.Hud)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Equal and graterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.Hud == string.Empty ? 0 : Convert.ToDecimal(u.Hud)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.Hud == string.Empty ? 0 : Convert.ToDecimal(u.Hud)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Leasthan and greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.Hud == string.Empty ? 0 : Convert.ToDecimal(u.Hud)) > Convert.ToDecimal(strGraterthan)) && Convert.ToDecimal(u.Hud == string.Empty ? 0 : Convert.ToDecimal(u.Hud)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Equal and Leasthan and greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.Hud == string.Empty ? 0 : Convert.ToDecimal(u.Hud)) == Convert.ToDecimal(strEqual)) && (Convert.ToDecimal(u.Hud == string.Empty ? 0 : Convert.ToDecimal(u.Hud)) < Convert.ToDecimal(strLessthan)) && (Convert.ToDecimal(u.Hud == string.Empty ? 0 : Convert.ToDecimal(u.Hud)) > Convert.ToDecimal(strGraterthan))));
                            //    }
                            //    if (caseMstQuestion != null)
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, caseMstQuestion.Count);
                            //    else
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, 0);
                            //    break;
                            //case Consts.EligQues.AreYoupregnant:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.Pregnant.Equals(EligitemQuestion.EligDDTextResp));
                            //    if (EligitemQuestion.EligMemberAccess == "A")
                            //        casesnpQuestion = casesnpQuestion.FindAll(u => u.FamilySeq.Equals(caseMstList[0].FamilySeq));
                            //    QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            //case Consts.EligQues.MaritalStatus:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.MaritalStatus.Equals(EligitemQuestion.EligDDTextResp));
                            //    if (EligitemQuestion.EligMemberAccess == "A")
                            //        casesnpQuestion = casesnpQuestion.FindAll(u => u.FamilySeq.Equals(caseMstList[0].FamilySeq));
                            //    QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            //case Consts.EligQues.PresentlyEmployed:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.Employed.Equals(EligitemQuestion.EligDDTextResp));
                            //    if (EligitemQuestion.EligMemberAccess == "A")
                            //        casesnpQuestion = casesnpQuestion.FindAll(u => u.FamilySeq.Equals(caseMstList[0].FamilySeq));
                            //    QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            //case Consts.EligQues.AnyWorkLimitations:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.WorkLimit.Equals(EligitemQuestion.EligDDTextResp));
                            //    if (EligitemQuestion.EligMemberAccess == "A")
                            //        casesnpQuestion = casesnpQuestion.FindAll(u => u.FamilySeq.Equals(caseMstList[0].FamilySeq));
                            //    QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            //case Consts.EligQues.HourlyWage:
                            //    QuestionNumericConditions(EligQues.EligRespType.Trim(), EligitemQuestion, out strEqual, out strLessthan, out strGraterthan);

                            //    if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan == string.Empty)//Equal
                            //    {
                            //        casesnpQuestion = caseSnpList.FindAll(u => (Convert.ToDecimal(u.HourlyWage == string.Empty ? 0 : Convert.ToDecimal(u.Age)).Equals(Convert.ToDecimal(strEqual))));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Lessthan
                            //    {
                            //        casesnpQuestion = caseSnpList.FindAll(u => (Convert.ToDecimal(u.HourlyWage == string.Empty ? 0 : Convert.ToDecimal(u.HourlyWage)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Greaterthan
                            //    {
                            //        casesnpQuestion = caseSnpList.FindAll(u => (Convert.ToDecimal(u.HourlyWage == string.Empty ? 0 : Convert.ToDecimal(u.HourlyWage)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Equal and Lessthan
                            //    {
                            //        casesnpQuestion = caseSnpList.FindAll(u => ((Convert.ToDecimal(u.HourlyWage == string.Empty ? 0 : Convert.ToDecimal(u.HourlyWage)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.HourlyWage == string.Empty ? 0 : Convert.ToDecimal(u.HourlyWage)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Equal and graterthan
                            //    {
                            //        casesnpQuestion = caseSnpList.FindAll(u => ((Convert.ToDecimal(u.HourlyWage == string.Empty ? 0 : Convert.ToDecimal(u.HourlyWage)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.HourlyWage == string.Empty ? 0 : Convert.ToDecimal(u.HourlyWage)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Leasthan and greaterthan
                            //    {
                            //        casesnpQuestion = caseSnpList.FindAll(u => ((Convert.ToDecimal(u.HourlyWage == string.Empty ? 0 : Convert.ToDecimal(u.HourlyWage)) > Convert.ToDecimal(strGraterthan)) && Convert.ToDecimal(u.HourlyWage == string.Empty ? 0 : Convert.ToDecimal(u.HourlyWage)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Equal and Leasthan and greaterthan
                            //    {
                            //        casesnpQuestion = caseSnpList.FindAll(u => ((Convert.ToDecimal(u.HourlyWage == string.Empty ? 0 : Convert.ToDecimal(u.HourlyWage)) == Convert.ToDecimal(strEqual)) && (Convert.ToDecimal(u.HourlyWage == string.Empty ? 0 : Convert.ToDecimal(u.HourlyWage)) < Convert.ToDecimal(strLessthan)) && (Convert.ToDecimal(u.HourlyWage == string.Empty ? 0 : Convert.ToDecimal(u.HourlyWage)) > Convert.ToDecimal(strGraterthan))));
                            //    }
                            //    if (EligitemQuestion.EligMemberAccess == "A")
                            //        casesnpQuestion = casesnpQuestion.FindAll(u => u.FamilySeq.Equals(caseMstList[0].FamilySeq));
                            //    if (casesnpQuestion != null)
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, casesnpQuestion.Count);
                            //    else
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, 0);
                            //    break;
                            //case Consts.EligQues.Relationship:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.MemberCode.Equals(EligitemQuestion.EligDDTextResp));
                            //    if (EligitemQuestion.EligMemberAccess == "A")
                            //        casesnpQuestion = casesnpQuestion.FindAll(u => u.FamilySeq.Equals(caseMstList[0].FamilySeq));
                            //    QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            //case Consts.EligQues.Race:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.Race.Equals(EligitemQuestion.EligDDTextResp));
                            //    if (EligitemQuestion.EligMemberAccess == "A")
                            //        casesnpQuestion = casesnpQuestion.FindAll(u => u.FamilySeq.Equals(caseMstList[0].FamilySeq));
                            //    QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            //case Consts.EligQues.SecondaryLanguage:
                            //    caseMstQuestion = caseMstList.FindAll(u => u.LanguageOt.Equals(EligitemQuestion.EligDDTextResp));
                            //    QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, caseMstQuestion.Count);
                            //    break;
                            //case Consts.EligQues.Fund:
                            //case Consts.EligQues.School:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.SchoolDistrict.Equals(EligitemQuestion.EligDDTextResp));
                            //    if (EligitemQuestion.EligMemberAccess == "A")
                            //        casesnpQuestion = casesnpQuestion.FindAll(u => u.FamilySeq.Equals(caseMstList[0].FamilySeq));
                            //    QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            //case Consts.EligQues.DriversLicense:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.Race.Equals(EligitemQuestion.EligDDTextResp));
                            //    if (EligitemQuestion.EligMemberAccess == "A")
                            //        casesnpQuestion = casesnpQuestion.FindAll(u => u.FamilySeq.Equals(caseMstList[0].FamilySeq));
                            //    QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            //case Consts.EligQues.ReliableTransport:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.Relitran.Equals(EligitemQuestion.EligDDTextResp));
                            //    if (EligitemQuestion.EligMemberAccess == "A")
                            //        casesnpQuestion = casesnpQuestion.FindAll(u => u.FamilySeq.Equals(caseMstList[0].FamilySeq));
                            //    QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            //case Consts.EligQues.LegaltoWork:
                            //    casesnpQuestion = caseSnpList.FindAll(u => u.LegalTowork.Equals(EligitemQuestion.EligDDTextResp));
                            //    if (EligitemQuestion.EligMemberAccess == "A")
                            //        casesnpQuestion = casesnpQuestion.FindAll(u => u.FamilySeq.Equals(caseMstList[0].FamilySeq));
                            //    QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, casesnpQuestion.Count);
                            //    break;
                            //case Consts.EligQues.NumberinHousehold:
                            //    QuestionNumericConditions(EligQues.EligRespType.Trim(), EligitemQuestion, out strEqual, out strLessthan, out strGraterthan);

                            //    if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan == string.Empty)//Equal
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.NoInhh == string.Empty ? 0 : Convert.ToDecimal(u.NoInhh)).Equals(Convert.ToDecimal(strEqual))));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Lessthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.NoInhh == string.Empty ? 0 : Convert.ToDecimal(u.NoInhh)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.NoInhh == string.Empty ? 0 : Convert.ToDecimal(u.NoInhh)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Equal and Lessthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.NoInhh == string.Empty ? 0 : Convert.ToDecimal(u.NoInhh)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.NoInhh == string.Empty ? 0 : Convert.ToDecimal(u.NoInhh)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Equal and graterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.NoInhh == string.Empty ? 0 : Convert.ToDecimal(u.NoInhh)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.NoInhh == string.Empty ? 0 : Convert.ToDecimal(u.NoInhh)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Leasthan and greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.NoInhh == string.Empty ? 0 : Convert.ToDecimal(u.NoInhh)) > Convert.ToDecimal(strGraterthan)) && Convert.ToDecimal(u.NoInhh == string.Empty ? 0 : Convert.ToDecimal(u.NoInhh)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Equal and Leasthan and greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.NoInhh == string.Empty ? 0 : Convert.ToDecimal(u.NoInhh)) == Convert.ToDecimal(strEqual)) && (Convert.ToDecimal(u.NoInhh == string.Empty ? 0 : Convert.ToDecimal(u.NoInhh)) < Convert.ToDecimal(strLessthan)) && (Convert.ToDecimal(u.NoInhh == string.Empty ? 0 : Convert.ToDecimal(u.NoInhh)) > Convert.ToDecimal(strGraterthan))));
                            //    }
                            //    if (caseMstQuestion != null)
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, caseMstQuestion.Count);
                            //    else
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, 0);
                            //    break;
                            //case Consts.EligQues.FamilyIncome:
                            //    QuestionNumericConditions(EligQues.EligRespType.Trim(), EligitemQuestion, out strEqual, out strLessthan, out strGraterthan);

                            //    if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan == string.Empty)//Equal
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.FamIncome == string.Empty ? 0 : Convert.ToDecimal(u.FamIncome)).Equals(Convert.ToDecimal(strEqual))));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Lessthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.FamIncome == string.Empty ? 0 : Convert.ToDecimal(u.FamIncome)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.FamIncome == string.Empty ? 0 : Convert.ToDecimal(u.FamIncome)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Equal and Lessthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.FamIncome == string.Empty ? 0 : Convert.ToDecimal(u.FamIncome)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.FamIncome == string.Empty ? 0 : Convert.ToDecimal(u.FamIncome)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Equal and graterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.FamIncome == string.Empty ? 0 : Convert.ToDecimal(u.FamIncome)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.FamIncome == string.Empty ? 0 : Convert.ToDecimal(u.FamIncome)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Leasthan and greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.FamIncome == string.Empty ? 0 : Convert.ToDecimal(u.FamIncome)) > Convert.ToDecimal(strGraterthan)) && Convert.ToDecimal(u.FamIncome == string.Empty ? 0 : Convert.ToDecimal(u.FamIncome)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Equal and Leasthan and greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.FamIncome == string.Empty ? 0 : Convert.ToDecimal(u.FamIncome)) == Convert.ToDecimal(strEqual)) && (Convert.ToDecimal(u.FamIncome == string.Empty ? 0 : Convert.ToDecimal(u.FamIncome)) < Convert.ToDecimal(strLessthan)) && (Convert.ToDecimal(u.FamIncome == string.Empty ? 0 : Convert.ToDecimal(u.FamIncome)) > Convert.ToDecimal(strGraterthan))));
                            //    }
                            //    if (caseMstQuestion != null)
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, caseMstQuestion.Count);
                            //    else
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, 0);
                            //    break;
                            //case Consts.EligQues.NumberinProgram:
                            //    QuestionNumericConditions(EligQues.EligRespType.Trim(), EligitemQuestion, out strEqual, out strLessthan, out strGraterthan);


                            //    if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan == string.Empty)//Equal
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.NoInProg == string.Empty ? 0 : Convert.ToDecimal(u.NoInProg)).Equals(Convert.ToDecimal(strEqual))));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Lessthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.NoInProg == string.Empty ? 0 : Convert.ToDecimal(u.NoInProg)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.NoInProg == string.Empty ? 0 : Convert.ToDecimal(u.NoInProg)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Equal and Lessthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.NoInProg == string.Empty ? 0 : Convert.ToDecimal(u.NoInProg)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.NoInProg == string.Empty ? 0 : Convert.ToDecimal(u.NoInProg)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Equal and graterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.NoInProg == string.Empty ? 0 : Convert.ToDecimal(u.NoInProg)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.NoInProg == string.Empty ? 0 : Convert.ToDecimal(u.NoInProg)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Leasthan and greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.NoInProg == string.Empty ? 0 : Convert.ToDecimal(u.NoInProg)) > Convert.ToDecimal(strGraterthan)) && Convert.ToDecimal(u.NoInProg == string.Empty ? 0 : Convert.ToDecimal(u.NoInProg)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Equal and Leasthan and greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.NoInProg == string.Empty ? 0 : Convert.ToDecimal(u.NoInProg)) == Convert.ToDecimal(strEqual)) && (Convert.ToDecimal(u.NoInProg == string.Empty ? 0 : Convert.ToDecimal(u.NoInProg)) < Convert.ToDecimal(strLessthan)) && (Convert.ToDecimal(u.NoInProg == string.Empty ? 0 : Convert.ToDecimal(u.NoInProg)) > Convert.ToDecimal(strGraterthan))));
                            //    }
                            //    if (caseMstQuestion != null)
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, caseMstQuestion.Count);
                            //    else
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, 0);
                            //    break;
                            //case Consts.EligQues.ProgramIncome:
                            //    QuestionNumericConditions(EligQues.EligRespType.Trim(), EligitemQuestion, out strEqual, out strLessthan, out strGraterthan);
                            //    if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan == string.Empty)//Equal
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.ProgIncome == string.Empty ? 0 : Convert.ToDecimal(u.ProgIncome)).Equals(Convert.ToDecimal(strEqual))));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Lessthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.ProgIncome == string.Empty ? 0 : Convert.ToDecimal(u.ProgIncome)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.ProgIncome == string.Empty ? 0 : Convert.ToDecimal(u.ProgIncome)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Equal and Lessthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.ProgIncome == string.Empty ? 0 : Convert.ToDecimal(u.ProgIncome)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.ProgIncome == string.Empty ? 0 : Convert.ToDecimal(u.ProgIncome)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Equal and graterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.ProgIncome == string.Empty ? 0 : Convert.ToDecimal(u.ProgIncome)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.ProgIncome == string.Empty ? 0 : Convert.ToDecimal(u.ProgIncome)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Leasthan and greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.ProgIncome == string.Empty ? 0 : Convert.ToDecimal(u.ProgIncome)) > Convert.ToDecimal(strGraterthan)) && Convert.ToDecimal(u.ProgIncome == string.Empty ? 0 : Convert.ToDecimal(u.ProgIncome)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Equal and Leasthan and greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.ProgIncome == string.Empty ? 0 : Convert.ToDecimal(u.ProgIncome)) == Convert.ToDecimal(strEqual)) && (Convert.ToDecimal(u.ProgIncome == string.Empty ? 0 : Convert.ToDecimal(u.ProgIncome)) < Convert.ToDecimal(strLessthan)) && (Convert.ToDecimal(u.ProgIncome == string.Empty ? 0 : Convert.ToDecimal(u.ProgIncome)) > Convert.ToDecimal(strGraterthan))));
                            //    }
                            //    if (caseMstQuestion != null)
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, caseMstQuestion.Count);
                            //    else
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, 0);
                            //    break;
                            //case Consts.EligQues.ZipCode:
                            //    QuestionNumericConditions(EligQues.EligRespType.Trim(), EligitemQuestion, out strEqual, out strLessthan, out strGraterthan);

                            //    if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan == string.Empty)//Equal
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.Zip == string.Empty ? 0 : Convert.ToDecimal(u.Zip)).Equals(Convert.ToDecimal(strEqual))));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Lessthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.Zip == string.Empty ? 0 : Convert.ToDecimal(u.Zip)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => (Convert.ToDecimal(u.Zip == string.Empty ? 0 : Convert.ToDecimal(u.Zip)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Equal and Lessthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.Zip == string.Empty ? 0 : Convert.ToDecimal(u.Zip)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.Zip == string.Empty ? 0 : Convert.ToDecimal(u.Zip)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Equal and graterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.Zip == string.Empty ? 0 : Convert.ToDecimal(u.Zip)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.Zip == string.Empty ? 0 : Convert.ToDecimal(u.Zip)) > Convert.ToDecimal(strGraterthan)));
                            //    }
                            //    else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Leasthan and greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.Zip == string.Empty ? 0 : Convert.ToDecimal(u.Zip)) > Convert.ToDecimal(strGraterthan)) && Convert.ToDecimal(u.Zip == string.Empty ? 0 : Convert.ToDecimal(u.Zip)) < Convert.ToDecimal(strLessthan)));
                            //    }
                            //    else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Equal and Leasthan and greaterthan
                            //    {
                            //        caseMstQuestion = caseMstList.FindAll(u => ((Convert.ToDecimal(u.Zip == string.Empty ? 0 : Convert.ToDecimal(u.Zip)) == Convert.ToDecimal(strEqual)) && (Convert.ToDecimal(u.Zip == string.Empty ? 0 : Convert.ToDecimal(u.Zip)) < Convert.ToDecimal(strLessthan)) && (Convert.ToDecimal(u.Zip == string.Empty ? 0 : Convert.ToDecimal(u.Zip)) > Convert.ToDecimal(strGraterthan))));
                            //    }
                            //    if (caseMstQuestion != null)
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, caseMstQuestion.Count);
                            //    else
                            //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, 0);
                            //    break;


                        }

                        //if (First)
                        //{
                        //    //string moduleNum = "module"+ Clmn.ToString();
                        //    DataGridViewTextBoxColumn moduleNum = new DataGridViewTextBoxColumn();
                        //    moduleNum.AutoSizeMode = Gizmox.WebGUI.Forms.DataGridViewAutoSizeColumnMode.NotSet;
                        //    moduleNum.DefaultHeaderCellType = typeof(Gizmox.WebGUI.Forms.DataGridViewColumnHeaderCell);
                        //    moduleNum.CellTemplate = new DataGridViewTextBoxCell();
                        //    moduleNum.HeaderText = EligQues.TrigQuesDesc;
                        //    moduleNum.Name = EligQues.TrigFldName;
                        //    if (EligQues.TrigRespType == "T") moduleNum.Width = 100;
                        //    else moduleNum.Width = 80;
                        //    moduleNum.ReadOnly = true;
                        //    moduleNum.Visible = true;
                        //    moduleNum.HeaderCell.Style.Alignment = DataGridViewContentAlignment.MiddleCenter;
                        //    gvwApplicants.Columns.Add(moduleNum);
                        //}



                        //}

                        #region commented code

                        // if condition closed
                        //else
                        //{
                        //    List<CustomQuestionsEntity> customEligQuesAll = null;

                        //    if (EligitemQuestion.EligResponseType.ToString() == "N")
                        //    {
                        //        QuestionNumericConditions(EligitemQuestion.EligResponseType.ToString().Trim(), EligitemQuestion, out strEqual, out strLessthan, out strGraterthan);

                        //        if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan == string.Empty)//Equal
                        //        {
                        //            customEligQuesAll = custQuestionActCust.FindAll(u => (u.ACTCODE.Equals(EligitemQuestion.EligAgyCode)) && (Convert.ToDecimal(u.ACTNUMRESP == string.Empty ? 0 : Convert.ToDecimal(u.ACTNUMRESP)).Equals(Convert.ToDecimal(strEqual))));
                        //        }
                        //        else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Lessthan
                        //        {
                        //            customEligQuesAll = custQuestionActCust.FindAll(u => (u.ACTCODE.Equals(EligitemQuestion.EligAgyCode)) && (Convert.ToDecimal(u.ACTNUMRESP == string.Empty ? 0 : Convert.ToDecimal(u.ACTNUMRESP)) < Convert.ToDecimal(strLessthan)));
                        //        }
                        //        else if (strEqual == string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Greaterthan
                        //        {
                        //            customEligQuesAll = custQuestionActCust.FindAll(u => (u.ACTCODE.Equals(EligitemQuestion.EligAgyCode)) && (Convert.ToDecimal(u.ACTNUMRESP == string.Empty ? 0 : Convert.ToDecimal(u.ACTNUMRESP)) > Convert.ToDecimal(strGraterthan)));
                        //        }
                        //        else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan == string.Empty)//Equal and Lessthan
                        //        {
                        //            customEligQuesAll = custQuestionActCust.FindAll(u => (u.ACTCODE.Equals(EligitemQuestion.EligAgyCode)) && ((Convert.ToDecimal(u.ACTNUMRESP == string.Empty ? 0 : Convert.ToDecimal(u.ACTNUMRESP)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.ACTNUMRESP == string.Empty ? 0 : Convert.ToDecimal(u.ACTNUMRESP)) < Convert.ToDecimal(strLessthan)));
                        //        }
                        //        else if (strEqual != string.Empty && strLessthan == string.Empty && strGraterthan != string.Empty)//Equal and graterthan
                        //        {
                        //            customEligQuesAll = custQuestionActCust.FindAll(u => (u.ACTCODE.Equals(EligitemQuestion.EligAgyCode)) && ((Convert.ToDecimal(u.ACTNUMRESP == string.Empty ? 0 : Convert.ToDecimal(u.ACTNUMRESP)) == Convert.ToDecimal(strEqual)) && Convert.ToDecimal(u.ACTNUMRESP == string.Empty ? 0 : Convert.ToDecimal(u.ACTNUMRESP)) > Convert.ToDecimal(strGraterthan)));
                        //        }
                        //        else if (strEqual == string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Leasthan and greaterthan
                        //        {
                        //            customEligQuesAll = custQuestionActCust.FindAll(u => (u.ACTCODE.Equals(EligitemQuestion.EligAgyCode)) && ((Convert.ToDecimal(u.ACTNUMRESP == string.Empty ? 0 : Convert.ToDecimal(u.ACTNUMRESP)) > Convert.ToDecimal(strGraterthan)) && Convert.ToDecimal(u.ACTNUMRESP == string.Empty ? 0 : Convert.ToDecimal(u.ACTNUMRESP)) < Convert.ToDecimal(strLessthan)));
                        //        }
                        //        else if (strEqual != string.Empty && strLessthan != string.Empty && strGraterthan != string.Empty)//Equal and Leasthan and greaterthan
                        //        {
                        //            customEligQuesAll = custQuestionActCust.FindAll(u => (u.ACTCODE.Equals(EligitemQuestion.EligAgyCode)) && ((Convert.ToDecimal(u.ACTNUMRESP == string.Empty ? 0 : Convert.ToDecimal(u.ACTNUMRESP)) == Convert.ToDecimal(strEqual)) && (Convert.ToDecimal(u.ACTNUMRESP == string.Empty ? 0 : Convert.ToDecimal(u.ACTNUMRESP)) < Convert.ToDecimal(strLessthan)) && (Convert.ToDecimal(u.ACTNUMRESP == string.Empty ? 0 : Convert.ToDecimal(u.ACTNUMRESP)) > Convert.ToDecimal(strGraterthan))));
                        //        }
                        //        QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, customEligQuesAll.Count);
                        //    }
                        //    else if (EligitemQuestion.EligResponseType.ToString() == "D")
                        //    {
                        //        if (EligitemQuestion.EligMemberAccess.ToString().Trim() == "*" || EligitemQuestion.EligMemberAccess.ToString().Trim() == "1")
                        //        {
                        //            customEligQuesAll = custQuestionActCust.FindAll(u => u.ACTCODE.Equals(EligitemQuestion.EligAgyCode) && (Convert.ToString(u.ACTMULTRESP.Trim()).Equals(EligitemQuestion.EligDDTextResp.Trim())));
                        //        }
                        //        else
                        //        {
                        //            if (EligitemQuestion.EligMemberAccess.ToString().Trim() == "A")
                        //                customEligQuesAll = custQuestionActCust.FindAll(u => u.ACTCODE.Equals(EligitemQuestion.EligAgyCode) && u.ACTSNPFAMILYSEQ.Equals("9999999") && (Convert.ToString(u.ACTMULTRESP.Trim()).Equals(EligitemQuestion.EligDDTextResp.Trim())));
                        //            else
                        //                customEligQuesAll = custQuestionActCust.FindAll(u => u.ACTCODE.Equals(EligitemQuestion.EligAgyCode) && u.ACTSNPFAMILYSEQ.Equals("8888888") && (Convert.ToString(u.ACTMULTRESP.Trim()).Equals(EligitemQuestion.EligDDTextResp.Trim())));
                        //        }
                        //        if (customEligQuesAll != null)
                        //            QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, customEligQuesAll.Count);
                        //        else
                        //            QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, 0);
                        //    }
                        //    else if (EligitemQuestion.EligResponseType.ToString() == "A")
                        //    {
                        //        if (EligitemQuestion.EligMemberAccess.ToString().Trim() == "*" || EligitemQuestion.EligMemberAccess.ToString().Trim() == "1")
                        //        {
                        //            customEligQuesAll = custQuestionActCust.FindAll(u => u.ACTCODE.Equals(EligitemQuestion.EligAgyCode) && u.ACTALPHARESP.Trim().Equals(EligitemQuestion.EligDDTextResp));
                        //        }
                        //        else
                        //        {
                        //            if (EligitemQuestion.EligMemberAccess.ToString().Trim() == "A")
                        //                customEligQuesAll = custQuestionActCust.FindAll(u => u.ACTCODE.Equals(EligitemQuestion.EligAgyCode) && u.ACTSNPFAMILYSEQ.Equals("9999999") && (Convert.ToString(u.ACTMULTRESP.Trim()).Equals(EligitemQuestion.EligDDTextResp.Trim())));
                        //            else
                        //                customEligQuesAll = custQuestionActCust.FindAll(u => u.ACTCODE.Equals(EligitemQuestion.EligAgyCode) && u.ACTSNPFAMILYSEQ.Equals("8888888") && (Convert.ToString(u.ACTMULTRESP.Trim()).Equals(EligitemQuestion.EligDDTextResp.Trim())));
                        //        }

                        //        if (customEligQuesAll != null)
                        //            QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, customEligQuesAll.Count);
                        //        else
                        //            QuestionType(EligitemQuestion.EligMemberAccess, EligitemQuestion, 0);
                        //    }

                        //}

                        #endregion

                    }//Questions loop
                    string Conjunction = "O";
                    string ConResult = "N";
                    int i = 0;
                    foreach (CaseQuestionResult item in caseQuestionResult)
                    {
                        if (i == 0)
                        {
                            if (item.QuestionResult == "N")
                            {
                                Conjunction = item.QuestionConjuction == "A" ? "A" : "O";
                                ConResult = item.QuestionResult;
                                item.QuestionStatus = "N";
                            }
                            else
                            {
                                Conjunction = item.QuestionConjuction == "A" ? "A" : "O";
                                ConResult = item.QuestionResult;
                                item.QuestionStatus = "Y";

                            }
                            i++;
                            //if (Conjunction == "O" && ConResult == "N" && item.QuestionResult == "Y")
                            //    item.QuestionStatus = "Y";
                        }
                        else
                        {
                            if (Conjunction == "O" && ConResult == "N" && item.QuestionResult == "Y")
                            {
                                caseQuestionResult[i - 1].QuestionStatus = "Y";
                                item.QuestionStatus = "Y";
                                // Conjunction = item.QuestionConjuction == "A" ? "A" : "O";
                                ConResult = item.QuestionResult;
                            }
                            if (Conjunction == "O" && ConResult == "N" && item.QuestionResult == "N")
                            {
                                item.QuestionStatus = "N";
                                // Conjunction = item.QuestionConjuction == "A" ? "A" : "O";
                                ConResult = item.QuestionResult;
                            }
                            if (Conjunction == "O" && ConResult == "Y" && item.QuestionResult == "N")
                            {
                                item.QuestionStatus = "Y";
                                // Conjunction = item.QuestionConjuction == "A" ? "A" : "O";
                                ConResult = item.QuestionResult;
                            }
                            if (Conjunction == "O" && ConResult == "Y" && item.QuestionResult == "Y")
                            {
                                item.QuestionStatus = "Y";
                                //  Conjunction = item.QuestionConjuction == "A" ? "A" : "O";
                                ConResult = item.QuestionResult;
                            }
                            else if (Conjunction == "A" && ConResult == "N" && item.QuestionResult == "Y")
                            {
                                item.QuestionStatus = "N";
                                //  Conjunction = item.QuestionConjuction == "A" ? "A" : "O";
                                ConResult = item.QuestionResult;
                            }
                            else if (Conjunction == "A" && ConResult == "Y" && item.QuestionResult == "Y")
                            {
                                item.QuestionStatus = "Y";
                                //  Conjunction = item.QuestionConjuction == "A" ? "A" : "O";
                                ConResult = item.QuestionResult;
                            }
                            else if (Conjunction == "A" && ConResult == "N" && item.QuestionResult == "N")
                            {
                                item.QuestionStatus = "N";
                                //  Conjunction = item.QuestionConjuction == "A" ? "A" : "O";
                                ConResult = item.QuestionResult;
                            }
                            else if (Conjunction == "A" && ConResult == "Y" && item.QuestionResult == "N")
                            {
                                item.QuestionStatus = "N";
                                //  Conjunction = item.QuestionConjuction == "A" ? "A" : "O";
                                ConResult = item.QuestionResult;
                            }

                        }

                    }

                    if (Conjunction == "A")
                    {

                        if (caseQuestionResult.Count == caseQuestionResult.FindAll(u => u.QuestionStatus.Equals("Y")).Count)
                            caseGroupResult.Add(new CaseGroupResult(ELigitemGroup.SBGTGroup, SSBGTypesQues.Count, ELigitemGroup.SBGTConj == "A" ? "A" : "O", "Y", string.Empty, string.Empty));
                        else
                            caseGroupResult.Add(new CaseGroupResult(ELigitemGroup.SBGTGroup, SSBGTypesQues.Count, ELigitemGroup.SBGTConj == "A" ? "A" : "O", "N", string.Empty, string.Empty));
                    }
                    else
                    {
                        if (caseQuestionResult.FindAll(u => u.QuestionStatus.Equals("Y")).Count > 0)
                            caseGroupResult.Add(new CaseGroupResult(ELigitemGroup.SBGTGroup, SSBGTypesQues.Count, ELigitemGroup.SBGTConj == "A" ? "A" : "O", "Y", string.Empty, string.Empty));
                        else
                            caseGroupResult.Add(new CaseGroupResult(ELigitemGroup.SBGTGroup, SSBGTypesQues.Count, ELigitemGroup.SBGTConj == "A" ? "A" : "O", "N", string.Empty, string.Empty));
                    }


                }

                int intGroup = 0;
                foreach (CaseGroupResult item in caseGroupResult)
                {
                    if (intGroup == 0)
                    {
                        if (item.GroupResult == "N")
                        {
                            strGroupConjunction = item.GroupConjunction == "A" ? "A" : "O";
                            strGroupPreviousResult = item.GroupResult;
                            item.GroupStatus = "N";
                        }
                        else
                        {
                            strGroupConjunction = item.GroupConjunction == "A" ? "A" : "O";
                            strGroupPreviousResult = item.GroupResult;
                            item.GroupStatus = "Y";
                        }
                        intGroup++;
                        //if (Conjunction == "O" && ConResult == "N" && item.QuestionResult == "Y")
                        //    item.QuestionStatus = "Y";
                    }
                    else
                    {
                        intGroup++;
                        if (strGroupConjunction == "O" && strGroupPreviousResult == "N" && item.GroupResult == "Y")
                        {
                            caseGroupResult[intGroup - 1].GroupStatus = "Y";
                            item.GroupStatus = "Y";
                            if (caseGroupResult.Count != intGroup)
                                strGroupConjunction = item.GroupConjunction == "A" ? "A" : "O";
                            strGroupPreviousResult = item.GroupResult;
                        }
                        if (strGroupConjunction == "O" && strGroupPreviousResult == "N" && item.GroupResult == "N")
                        {
                            item.GroupStatus = "N";
                            if (caseGroupResult.Count != intGroup)
                                strGroupConjunction = item.GroupConjunction == "A" ? "A" : "O";
                            strGroupPreviousResult = item.GroupResult;
                        }
                        if (strGroupConjunction == "O" && strGroupPreviousResult == "Y" && item.GroupResult == "N")
                        {
                            item.GroupStatus = "Y";
                            if (caseGroupResult.Count != intGroup)
                                strGroupConjunction = item.GroupConjunction == "A" ? "A" : "O";
                            strGroupPreviousResult = item.GroupResult;
                        }
                        if (strGroupConjunction == "O" && strGroupPreviousResult == "Y" && item.GroupResult == "Y")
                        {
                            item.GroupStatus = "Y";
                            if (caseGroupResult.Count != intGroup)
                                strGroupConjunction = item.GroupConjunction == "A" ? "A" : "O";
                            strGroupPreviousResult = item.GroupResult;
                        }
                        else if (strGroupConjunction == "A" && strGroupPreviousResult == "N" && item.GroupResult == "Y")
                        {
                            item.GroupStatus = "N";
                            if (caseGroupResult.Count != intGroup)
                                strGroupConjunction = item.GroupConjunction == "A" ? "A" : "O";
                            strGroupPreviousResult = item.GroupResult;
                        }
                        else if (strGroupConjunction == "A" && strGroupPreviousResult == "Y" && item.GroupResult == "Y")
                        {
                            item.GroupStatus = "Y";
                            if (caseGroupResult.Count != intGroup)
                                strGroupConjunction = item.GroupConjunction == "A" ? "A" : "O";
                            strGroupPreviousResult = item.GroupResult;
                        }
                        else if (strGroupConjunction == "A" && strGroupPreviousResult == "N" && item.GroupResult == "N")
                        {
                            item.GroupStatus = "N";
                            if (caseGroupResult.Count != intGroup)
                                strGroupConjunction = item.GroupConjunction == "A" ? "A" : "O";
                            strGroupPreviousResult = item.GroupResult;
                        }
                        else if (strGroupConjunction == "A" && strGroupPreviousResult == "Y" && item.GroupResult == "N")
                        {
                            item.GroupStatus = "N";
                            if (caseGroupResult.Count != intGroup)
                                strGroupConjunction = item.GroupConjunction == "A" ? "A" : "O";
                            strGroupPreviousResult = item.GroupResult;
                        }

                    }

                }
                if (caseGroupResult.Count == caseGroupResult.FindAll(u => u.GroupConjunction.Equals("O")).Count)
                {
                    if (caseGroupResult.FindAll(u => u.GroupStatus.Equals("Y")).Count > 0)
                    {
                        ISEligble = "Y";
                    }
                }
                else
                {
                    if (caseGroupResult.Count == caseGroupResult.FindAll(u => u.GroupStatus.Equals("Y")).Count)
                        ISEligble = "Y";
                }
            }
            First = false;
            return ISEligble;
            //}
        }

        private void QuestionNumericConditions(string strResponceType, SSBGTYPESEntity EligQueslist, out string strEqual, out string strLessthan, out string strGreaterthan)
        {

            string strLEqual = string.Empty;
            string strLLessthan = string.Empty;
            string strLGreaterthan = string.Empty;

            if (strResponceType == "N" || strResponceType == "X")
            {
                if (EligQueslist.SBGTNumEqual != string.Empty)
                {
                    if (Convert.ToDecimal(EligQueslist.SBGTNumEqual) > 0)
                        strLEqual = EligQueslist.SBGTNumEqual;
                }
                if (EligQueslist.SBGTNumLThan != string.Empty)
                {
                    if (Convert.ToDecimal(EligQueslist.SBGTNumLThan) > 0)
                        strLLessthan = EligQueslist.SBGTNumLThan;
                }
                if (EligQueslist.SBGTNumGThan != string.Empty)
                {
                    if (Convert.ToDecimal(EligQueslist.SBGTNumGThan) > 0)
                        strLGreaterthan = EligQueslist.SBGTNumGThan;
                }


            }
            strEqual = strLEqual;
            strLessthan = strLLessthan;
            strGreaterthan = strLGreaterthan;


        }

        private void QuestionDateConditions(string strResponceType, CTTRIGCRITEntity EligQueslist, out string strEqual, out string strLessthan, out string strGreaterthan)
        {

            string strLEqual = string.Empty;
            string strLLessthan = string.Empty;
            string strLGreaterthan = string.Empty;

            if (strResponceType == "T")
            {
                if (EligQueslist.TRIGCRITDateEqual != string.Empty)
                {
                    if (!string.IsNullOrEmpty(EligQueslist.TRIGCRITDateEqual))
                        strLEqual = LookupDataAccess.Getdate(EligQueslist.TRIGCRITDateEqual.Trim());
                }
                if (EligQueslist.TRIGCRITDateLthan != string.Empty)
                {
                    if (!string.IsNullOrEmpty(EligQueslist.TRIGCRITDateLthan))
                        strLLessthan = LookupDataAccess.Getdate(EligQueslist.TRIGCRITDateLthan.Trim());
                }
                if (EligQueslist.TRIGCRITDateGthan != string.Empty)
                {
                    if (!string.IsNullOrEmpty(EligQueslist.TRIGCRITDateGthan))
                        strLGreaterthan = LookupDataAccess.Getdate(EligQueslist.TRIGCRITDateGthan.Trim());
                }


            }

            strEqual = strLEqual;
            strLessthan = strLLessthan;
            strGreaterthan = strLGreaterthan;


        }

        private void QuestionType(string strQuestionType, SSBGTYPESEntity caseEligQues, int TotalResultCount)
        {
            string strResult = "N";
            if (TotalResultCount > 0)
            {
                strResult = "Y";
            }
            if (strQuestionType == "*")
            {
                if (CasemstList[0].NoInhh != null)
                {
                    if (Convert.ToInt32(CasemstList[0].NoInhh) == TotalResultCount)
                        strResult = "Y";
                    else strResult = "N";
                }
            }
            else if (strQuestionType == "1" || strQuestionType == "H" || strQuestionType == "A")
            {
                if (TotalResultCount > 0)
                {
                    strResult = "Y";
                }
            }
            caseQuestionResult.Add(new CaseQuestionResult(caseEligQues.SBGTGroup, caseEligQues.SBGTQuesCode, caseEligQues.SBGTConj, strResult, string.Empty, string.Empty));
        }

        private void txtfrom1_LostFocus(object sender, EventArgs e)
        {
            if (!string.IsNullOrEmpty(txtfrom1.Text))
            {
                if (int.Parse(txtfrom1.Text.Trim()) < 0)
                    _errorProvider.SetError(txtfrom1, string.Format("Please provide Positive Value".Replace(Consts.Common.Colon, string.Empty)));
                else
                    _errorProvider.SetError(txtfrom1, null);
            }
        }

        private void txtTo1_LostFocus(object sender, EventArgs e)
        {
            if (!string.IsNullOrEmpty(txtTo1.Text))
            {
                if (int.Parse(txtTo1.Text.Trim()) < 0)
                    _errorProvider.SetError(txtTo1, string.Format("Please provide Positive Value".Replace(Consts.Common.Colon, string.Empty)));
                else
                    _errorProvider.SetError(txtTo1, null);
            }
        }

        private void txtFrom2_LostFocus(object sender, EventArgs e)
        {
            if (!string.IsNullOrEmpty(txtFrom2.Text))
            {
                if (int.Parse(txtFrom2.Text.Trim()) < 0)
                    _errorProvider.SetError(txtFrom2, string.Format("Please provide Positive Value".Replace(Consts.Common.Colon, string.Empty)));
                else
                    _errorProvider.SetError(txtFrom2, null);
            }
        }

        private void Rb_Site_No_CheckedChanged(object sender, EventArgs e)
        {
            Txt_Sel_Site.Clear();
            ListcaseSiteEntity.Clear();
        }

        private void Rb_Site_Sel_CheckedChanged(object sender, EventArgs e)
        {

        }

        private void rdoSelectedSites_Click(object sender, EventArgs e)
        {
            if (Rb_Site_Sel.Checked == true)
            {
                SelectZipSiteCountyForm siteform = new SelectZipSiteCountyForm(BaseForm, ListcaseSiteEntity, Agency, Depart, Program, string.Empty);
                siteform.FormClosed += new FormClosedEventHandler(SelectZipSiteCountyFormClosed);
                siteform.StartPosition = FormStartPosition.CenterScreen;
                siteform.ShowDialog();
            }
        }

        private void SelectZipSiteCountyFormClosed(object sender, FormClosedEventArgs e)
        {

            SelectZipSiteCountyForm form = sender as SelectZipSiteCountyForm;
            if (form.DialogResult == DialogResult.OK)
            {
                if (form.FormType == "CASESITE")
                {
                    ListcaseSiteEntity = form.SelectedCaseSiteEntity;
                    if (Rb_Site_Sel.Checked == true && ListcaseSiteEntity.Count > 0)
                        Txt_Sel_Site.Text = ListcaseSiteEntity[0].SiteNUMBER.ToString();
                    else
                        Txt_Sel_Site.Clear();
                }
                //else if (form.FormType == "COUNTY")
                //{
                //    ListcommonEntity = form.SelectedCountyEntity;
                //}

                //else if (form.FormType == "ZIPCODE")
                //{
                //    ListZipCode = form.SelectedZipcodeEntity;
                //}
                //else if (form.FormType == "MSCODE")
                //{
                //    ListGroupCode = form.SelectedGroupCodeEntity;
                //}
                //else if (form.FormType == "FUND")
                //{
                //    Sel_Funding_List = form.Get_Sel_Fund_List;
                //}

              
            }
        }

        private string Get_Sel_Sites()
        {
            string Sel_Site_Codes = string.Empty;

            foreach (CaseSiteEntity casesite in ListcaseSiteEntity) //Site_List)//ListcaseSiteEntity)
            {
                Sel_Site_Codes += "'" + casesite.SiteNUMBER + "' ,";
            }

            if (Sel_Site_Codes.Length > 0)
                Sel_Site_Codes = Sel_Site_Codes.Substring(0, (Sel_Site_Codes.Length - 1));

            return Sel_Site_Codes;
        }

        private string Get_Sel_Sites_desc()
        {
            string Sel_Site_Desc = string.Empty;

            foreach (CaseSiteEntity casesite in ListcaseSiteEntity) //Site_List)//ListcaseSiteEntity)ListcaseMsSiteEntity
            {
                Sel_Site_Desc += casesite.SiteNUMBER + ",";
            }

            if (Sel_Site_Desc.Length > 0)
                Sel_Site_Desc = Sel_Site_Desc.Substring(0, (Sel_Site_Desc.Length - 1));

            return Sel_Site_Desc;
        }

        private void Rb_Site_All_Click(object sender, EventArgs e)
        {
            Txt_Sel_Site.Clear();
            ListcaseSiteEntity.Clear();
            _errorProvider.SetError(Rb_Site_Sel, null);
        }

        private void txtTo2_LostFocus(object sender, EventArgs e)
        {
            if (!string.IsNullOrEmpty(txtTo2.Text))
            {
                if (int.Parse(txtTo2.Text.Trim()) < 0)
                    _errorProvider.SetError(txtTo2, string.Format("Please provide Positive Value".Replace(Consts.Common.Colon, string.Empty)));
                else
                    _errorProvider.SetError(txtTo2, null);
            }
        }

        private void txtFrom2_Leave(object sender, EventArgs e)
        {
            if (!string.IsNullOrEmpty(txtFrom2.Text.Trim()))
            {

            }
        }

        private void dtpTo_Leave(object sender, EventArgs e)
        {
            SSBGPARAMEntity SelSSBG = SSBGParamall.Find(u => ((u.SSBGSeq).Equals(((Captain.Common.Utilities.ListItem)cmbSSBG.SelectedItem).Value.ToString())));

            if (SelSSBG != null)
            {
                txtDesc.Text = "Grant Period : " + LookupDataAccess.Getdate(SelSSBG.SSBGGPFrom.Trim()) + " To " + LookupDataAccess.Getdate(SelSSBG.SSBGGPTo.Trim()) + "\n" + "Total Budget : " + SelSSBG.SSBGBudget.Trim() + "\n" + "Total Grant Award: " + SelSSBG.SSBGAward.ToString(); ;
                Ref_From_Date.Value = Convert.ToDateTime(SelSSBG.SSBGGPFrom.Trim()); Ref_To_Date.Value = Convert.ToDateTime(SelSSBG.SSBGGPTo.Trim());

                FillDemoCount(SelSSBG);
            }
        }


        private List<string> BuildMothswithYears(int stMonth, int Endmonth, int strYear, int EndYear)
        {
            List<string> strMonths = new List<string>();
            

            for (var x = Convert.ToInt32(stMonth); ; x++)
            {

                switch (x)
                {
                    case 1:
                        strMonths.Add("Jan" + "-" + strYear.ToString().Substring((strYear.ToString().Length) - 2));
                        
                        break;
                    case 2:
                        strMonths.Add("Feb" + "-" + strYear.ToString().Substring((strYear.ToString().Length) - 2));
                        
                        break;
                    case 3:
                        strMonths.Add("Mar" + "-" + strYear.ToString().Substring((strYear.ToString().Length) - 2));
                        
                        break;
                    case 4:
                        strMonths.Add("Apr" + "-" + strYear.ToString().Substring((strYear.ToString().Length) - 2));
                        
                        break;
                    case 5:
                        strMonths.Add("May" + "-" + strYear.ToString().Substring((strYear.ToString().Length) - 2));
                        
                        break;
                    case 6:
                        strMonths.Add("Jun" + "-" + strYear.ToString().Substring((strYear.ToString().Length) - 2));
                        
                        break;
                    case 7:
                        strMonths.Add("Jul" + "-" + strYear.ToString().Substring((strYear.ToString().Length) - 2));
                        
                        break;
                    case 8:
                        strMonths.Add("Aug" + "-" + strYear.ToString().Substring((strYear.ToString().Length) - 2));
                        
                        break;
                    case 9:
                        strMonths.Add("Sep" + "-" + strYear.ToString().Substring((strYear.ToString().Length) - 2));
                        
                        break;
                    case 10:
                        strMonths.Add("Oct" + "-" + strYear.ToString().Substring((strYear.ToString().Length) - 2));
                        
                        break;
                    case 11:
                        strMonths.Add("Nov" + "-" + strYear.ToString().Substring((strYear.ToString().Length) - 2));
                        
                        break;
                    case 12:
                        strMonths.Add("Dec" + "-" + strYear.ToString().Substring((strYear.ToString().Length) - 2));
                        
                        break;

                }

                if (x == Endmonth)
                {
                    if (strMonths.Count > 0)
                    {

                    }
                    return strMonths;
                }
                if (x == 12) { x = 0;  if (strYear == EndYear) return strMonths; strYear = Convert.ToInt32(strYear) + 1; }
            }

            return strMonths;
        }



    }
}