#region Using

using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;

using Wisej.Web;
using Captain.Common.Views.Controls.Compatibility;
using Captain.Common.Utilities;
using Captain.Common.Views.Forms.Base;
using Captain.Common.Menus;
using Captain.Common.Views.Forms;
using System.Data.SqlClient;
using Captain.Common.Views.Controls;
using Captain.Common.Model.Objects;
using Captain.Common.Model.Data;
using System.Text.RegularExpressions;
using Captain.Common.Views.UserControls;
using System.Xml;
using System.IO;

using iTextSharp;
using iTextSharp.text;
using iTextSharp.text.pdf;
using iTextSharp.text.html.simpleparser;
using System.Globalization;
using XLSExportFile;
using CarlosAg.ExcelXmlWriter;
using Wisej.Web.VisualBasic;
using NPOI.SS.Formula.Functions;
using static NPOI.HSSF.Util.HSSFColor;
using DevExpress.Web.Internal.XmlProcessor;


#endregion

namespace Captain.Common.Views.Forms
{
    public partial class HSSB2104 : Form
    {
        #region private variables

        private ErrorProvider _errorProvider = null;
        private CaptainModel _model = null;
        string Year;

        #endregion

        public HSSB2104(BaseForm baseForm, PrivilegeEntity privileges)
        {
            InitializeComponent();           
            _model = new CaptainModel();
            _errorProvider = new ErrorProvider(this);
            _errorProvider.BlinkRate = 3;
            _errorProvider.BlinkStyle = ErrorBlinkStyle.BlinkIfDifferentError;
            _errorProvider.Icon = null;

            //rbAll.Enabled = false;
            //rbSelected.Enabled = false;

            BaseForm = baseForm;
            Privileges = privileges;
            Agency = BaseForm.BaseAgency;
            Depart = BaseForm.BaseDept;
            Program = BaseForm.BaseProg;
            Program_Year = BaseForm.BaseYear;

            rbAll.ForeColor = System.Drawing.Color.Gray; rbSelected.ForeColor = System.Drawing.Color.Gray;
            lblFundingSource.ForeColor = System.Drawing.Color.Gray;

            Set_Report_Hierarchy(BaseForm.BaseAgency, BaseForm.BaseDept, BaseForm.BaseProg, BaseForm.BaseYear);
            propReportPath = _model.lookupDataAccess.GetReportPath();
            propfundingSource = _model.lookupDataAccess.GetAgyTabRecordsByCodefilter(Consts.AgyTab.CASEMNGMTFUNDSRC, "H");
            this.Text = /*Privileges.Program + " - " +*/ Privileges.PrivilegeName.Trim();

            

            FillCaseSite();


        }

        string Agency = string.Empty, Depart = string.Empty, Program = string.Empty, strYear = string.Empty;
        #region properties

        public List<CaseSiteEntity> propCaseSiteEntity { get; set; }
        public BaseForm BaseForm { get; set; }
        public PrivilegeEntity Privileges { get; set; }
        public string propReportPath { get; set; }
        public List<CaseSiteEntity> propCaseAllSiteEntity { get; set; }
        public List<CommonEntity> propfundingSource { get; set; }

        public List<ENRL_Asof_Entity> ENRL_Asof_List { get; set; }
        

        #endregion

        private void FillCaseSite()
        {
           
            cmbSite.Items.Clear();
            cmbSite.ColorMember = "FavoriteColor";
            if (CmbYear.Visible == true)
                Program_Year = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString().Trim();

            if (!string.IsNullOrEmpty(Program_Year.Trim()))
            {
                CaseSiteEntity Search_Entity = new CaseSiteEntity(true);
                Search_Entity.SiteAGENCY = Agency;
                Search_Entity.SiteDEPT = Depart; Search_Entity.SitePROG = Program;
                Search_Entity.SiteYEAR = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();
                Search_Entity.SiteROOM = "0000";

                propCaseAllSiteEntity = _model.CaseMstData.Browse_CASESITE(Search_Entity, "Browse"); //_model.CaseMstData.GetHSSB2104ByHIE(agy, dept, prog, "SiteHie");

                if (BaseForm.BaseAgencyControlDetails.SiteSecurity == "1")
                {
                    List<HierarchyEntity> userHierarchy = _model.UserProfileAccess.GetUserHierarchyByID(BaseForm.UserID);
                    HierarchyEntity hierarchyEntity = new HierarchyEntity(); List<CaseSiteEntity> selsites = new List<CaseSiteEntity>();
                    foreach (HierarchyEntity Entity in userHierarchy)
                    {
                        if (Entity.InActiveFlag == "N")
                        {
                            if (Entity.Agency == Agency && Entity.Dept == Depart && Entity.Prog == Program)
                                hierarchyEntity = Entity;
                            else if (Entity.Agency == Agency && Entity.Dept == Depart && Entity.Prog == "**")
                                hierarchyEntity = Entity;
                            else if (Entity.Agency == Agency && Entity.Dept == "**" && Entity.Prog == "**")
                                hierarchyEntity = Entity;
                            else if (Entity.Agency == "**" && Entity.Dept == "**" && Entity.Prog == "**")
                            { hierarchyEntity = null; }
                        }
                    }

                    if (hierarchyEntity != null)
                    {
                        if (hierarchyEntity.Sites.Length > 0)
                        {
                            string[] Sites = hierarchyEntity.Sites.Split(',');

                            for (int i = 0; i < Sites.Length; i++)
                            {
                                if (!string.IsNullOrEmpty(Sites[i].ToString().Trim()))
                                {
                                    foreach (CaseSiteEntity casesite in propCaseAllSiteEntity) //Site_List)//ListcaseSiteEntity)
                                    {
                                        if (Sites[i].ToString() == casesite.SiteNUMBER)
                                        {
                                            selsites.Add(casesite);
                                            //break;
                                        }
                                        // Sel_Site_Codes += "'" + casesite.SiteNUMBER + "' ,";
                                    }
                                }
                            }
                            //strsiteRoomNames = hierarchyEntity.Sites;
                            propCaseAllSiteEntity = selsites;
                        }
                    }
                }
                propCaseAllSiteEntity = propCaseAllSiteEntity.OrderByDescending(u => u.SiteACTIVE).ToList();
                foreach (CaseSiteEntity item in propCaseAllSiteEntity)
                {
                    cmbSite.Items.Add(new Captain.Common.Utilities.ListItem(String.Format("{0,-10}", item.SiteNUMBER.Trim()) + " - " + item.SiteNAME, item.SiteNUMBER, item.SiteACTIVE, item.SiteACTIVE.Equals("Y") ? Color.Black : Color.Red,item.SiteNAME.Trim()));
                }
            }
            
            cmbSite.Items.Insert(0, new Captain.Common.Utilities.ListItem(String.Format("{0,-10}","****")+  " - All", "0",string.Empty,Color.Black,"All Sites"));
            cmbSite.SelectedIndex = 0;
        }

        string Current_Hierarchy = "******", Current_Hierarchy_DB = "**-**-**";
        string Member_NameFormat = "1", CAseWorkerr_NameFormat = "1";

        string Program_Year;
        private void Set_Report_Hierarchy(string Agy, string Dept, string Prog, string Year)
        {
            Txt_HieDesc.Clear();
            CmbYear.Visible = false;
            Program_Year = "    ";
            Current_Hierarchy = Agy + Dept + Prog;
            Current_Hierarchy_DB = Agy + "-" + Dept + "-" + Prog;

            if (Agy != "**")
            {
                DataSet ds_AGY = Captain.DatabaseLayer.AgyTab.GetHierarchyNames(Agy, "**", "**");
                if (ds_AGY.Tables.Count > 0)
                {
                    if (ds_AGY.Tables[0].Rows.Count > 0)
                        Txt_HieDesc.Text += "AGY : " + Agy + " - " + (ds_AGY.Tables[0].Rows[0]["HIE_NAME"].ToString()).Trim() + "      ";
                }
            }
            else
                Txt_HieDesc.Text += "AGY : ** - All Agencies      ";

            if (Dept != "**")
            {
                DataSet ds_DEPT = Captain.DatabaseLayer.AgyTab.GetHierarchyNames(Agy, Dept, "**");
                if (ds_DEPT.Tables.Count > 0)
                {
                    if (ds_DEPT.Tables[0].Rows.Count > 0)
                        Txt_HieDesc.Text += "DEPT : " + Dept + " - " + (ds_DEPT.Tables[0].Rows[0]["HIE_NAME"].ToString()).Trim() + "      ";
                }
            }
            else
                Txt_HieDesc.Text += "DEPT : ** - All Departments      ";

            if (Prog != "**")
            {
                DataSet ds_PROG = Captain.DatabaseLayer.AgyTab.GetHierarchyNames(Agy, Dept, Prog);
                if (ds_PROG.Tables.Count > 0)
                {
                    if (ds_PROG.Tables[0].Rows.Count > 0)
                        Txt_HieDesc.Text += "PROG : " + Prog + " - " + (ds_PROG.Tables[0].Rows[0]["HIE_NAME"].ToString()).Trim();
                }
            }
            else
                Txt_HieDesc.Text += "PROG : ** - All Programs ";


            if (Agy != "**")
                Get_NameFormat_For_Agencirs(Agy);
            else
                Member_NameFormat = CAseWorkerr_NameFormat = "1";

            if (Agy != "**" && Dept != "**" && Prog != "**")
            {
                FillYearCombo(Agy, Dept, Prog, Year);
               
            }
            else
            {
                this.Txt_HieDesc.Size = new System.Drawing.Size(635, 25);
               
            }
        }

        string DepYear;
        bool DefHieExist = false;
        private void FillYearCombo(string Agy, string Dept, string Prog, string Year)
        {
            
            CmbYear.Visible = DefHieExist = false;
            Program_Year = "    ";
            if (!string.IsNullOrEmpty(Year.Trim()))
                DefHieExist = true;

            CmbYear.Items.Clear();
            CmbYear.SelectedIndexChanged -= CmbYear_SelectedIndexChanged;

            DataSet ds = Captain.DatabaseLayer.MainMenu.GetCaseDepForHierarchy(Agy, Dept, Prog);
            if (ds.Tables.Count > 0)
            {
                DataTable dt = ds.Tables[0];
                int YearIndex = 0;

                if (dt.Rows.Count > 0)
                {
                    Program_Year = DepYear = dt.Rows[0]["DEP_YEAR"].ToString();
                    if (!(String.IsNullOrEmpty(DepYear)) && DepYear != null && DepYear != "    ")
                    {
                        int TmpYear = int.Parse(DepYear);
                        int TempCompareYear = 0;
                        string TmpYearStr = null;
                        if (!(String.IsNullOrEmpty(Year)) && Year != null && Year != " " && DefHieExist)
                            TempCompareYear = int.Parse(Year);
                        List<Captain.Common.Utilities.ListItem> listItem = new List<Captain.Common.Utilities.ListItem>();
                        for (int i = 0; i < 10; i++)
                        {
                            TmpYearStr = (TmpYear - i).ToString();
                            listItem.Add(new Captain.Common.Utilities.ListItem(TmpYearStr, i));
                            if (TempCompareYear == (TmpYear - i) && TmpYear != 0 && TempCompareYear != 0)
                                YearIndex = i;
                        }

                        CmbYear.Items.AddRange(listItem.ToArray());

                        CmbYear.Visible = true;

                        if (DefHieExist)
                            CmbYear.SelectedIndex = YearIndex;
                        else
                            CmbYear.SelectedIndex = 0;
                    }
                }
            }
            CmbYear.SelectedIndexChanged += CmbYear_SelectedIndexChanged;

            Agency = Agy; Depart = Dept; Program = Prog; //Program_Year = Year;

            //fillBusCombo(Agency, Depart, Program, strYear);
            if (!string.IsNullOrEmpty(Program_Year.Trim()))
                this.Txt_HieDesc.Size = new System.Drawing.Size(555, 25);
            else
                this.Txt_HieDesc.Size = new System.Drawing.Size(635, 25);
            FillCaseSite();
        }
        
        private void Get_NameFormat_For_Agencirs(string Agency)
        {
            DataSet ds = Captain.DatabaseLayer.AgyTab.GetHierarchyNames(Agency, "**", "**");
            if (ds.Tables.Count > 0)
            {
                if (ds.Tables[0].Rows.Count > 0)
                {
                    Member_NameFormat = ds.Tables[0].Rows[0]["HIE_CN_FORMAT"].ToString();
                    CAseWorkerr_NameFormat = ds.Tables[0].Rows[0]["HIE_CW_FORMAT"].ToString();
                }
            }
            
        }       

        private void btnSaveParameters_Click(object sender, EventArgs e)
        {
            if (ValidateForm())
            {
                ControlCard_Entity Save_Entity = new ControlCard_Entity(true);
                Save_Entity.Scr_Code = Privileges.Program;
                Save_Entity.UserID = BaseForm.UserID;
                Save_Entity.Card_1 = Get_XML_Format_for_Report_Controls();
                Save_Entity.Card_2 = string.Empty;
                Save_Entity.Card_3 = string.Empty;
                Save_Entity.Module = BaseForm.BusinessModuleID;

                Report_Get_SaveParams_Form Save_Form = new Report_Get_SaveParams_Form(Save_Entity, "Save", BaseForm, Privileges);
                Save_Form.StartPosition = FormStartPosition.CenterScreen;
                Save_Form.ShowDialog();
            }
        }
        

        private string Get_XML_Format_for_Report_Controls()
        {
            string Site = ((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Text.Trim();
            string ReportType = string.Empty;
            //string FundingSource = rbAll.Checked ? rbAll.Text.Trim() : rbSelected.Text.Trim();
            string strFundingCodes = string.Empty;
            string strFundSource = string.Empty;

            string Excel = "N";
            if (chkbExcel.Checked)
                Excel = "Y";

            if (rbSiteSummary.Checked == true)
                ReportType = rbSiteSummary.Text.Trim();
            else if (rbRoomDetail.Checked == true)
                ReportType = rbRoomDetail.Text.Trim();
            else if (rbFundDetailByRoom.Checked == true)
            {
                ReportType = rbFundDetailByRoom.Text.Trim();

                strFundSource = rbAll.Checked ? "Y" : "N";

                
                if (rbSelected.Checked == true)
                {
                    foreach (CommonEntity FundingCode in SelFundingList)
                    {
                        if (!strFundingCodes.Equals(string.Empty)) strFundingCodes += ",";
                        strFundingCodes += FundingCode.Code;
                    }
                }
            }

            if (CmbYear.Visible == true)
                Year = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();
            StringBuilder str = new StringBuilder();
            str.Append("<Rows>");
            str.Append("<Row AGENCY = \"" + Agency + "\" DEPT = \"" + Depart + "\" PROG = \"" + Program +
                            "\" YEAR = \"" + Year + "\" Site = \"" + Site +
                            "\" ReportType =  \"" + ReportType +
                            "\" FundedSource = \"" + strFundSource + "\" FundingCode = \"" + strFundingCodes + "\" EXCEL = \"" + Excel +
                            "\" AsOfDate = \"" + dtpAsOfDate.Value.Date + "\" />");

            str.Append("</Rows>");

            return str.ToString();
        }

        private void btnGetParameters_Click(object sender, EventArgs e)
        {
            ControlCard_Entity Save_Entity = new ControlCard_Entity(true);
            Save_Entity.Scr_Code = Privileges.Program;
            Save_Entity.UserID = BaseForm.UserID;
            Save_Entity.Module = BaseForm.BusinessModuleID;
            Report_Get_SaveParams_Form Save_Form = new Report_Get_SaveParams_Form(Save_Entity, "Get");
            Save_Form.FormClosed += new FormClosedEventHandler(Get_Saved_Parameters);
            Save_Form.StartPosition = FormStartPosition.CenterScreen;
            Save_Form.ShowDialog();
        }

        private void Get_Saved_Parameters(object sender, FormClosedEventArgs e)
        {
            Report_Get_SaveParams_Form form = sender as Report_Get_SaveParams_Form;
            string[] Saved_Parameters = new string[2];
            Saved_Parameters[0] = Saved_Parameters[1] = string.Empty;

            if (form.DialogResult == DialogResult.OK)
            {
                DataTable RepCntl_Table = new DataTable();
                Saved_Parameters = form.Get_Adhoc_Saved_Parameters();

                RepCntl_Table = CommonFunctions.Convert_XMLstring_To_Datatable(Saved_Parameters[0]);
                Set_Report_Controls(RepCntl_Table);
            }
        }

        private void Set_Report_Controls(DataTable Tmp_Table)
        {
            if (Tmp_Table != null && Tmp_Table.Rows.Count > 0)
            {
                DataRow dr = Tmp_Table.Rows[0];
                Set_Report_Hierarchy(dr["AGENCY"].ToString(), dr["DEPT"].ToString(), dr["PROG"].ToString(), dr["YEAR"].ToString());
                dtpAsOfDate.Value = Convert.ToDateTime(dr["AsOfDate"]);
                dtpAsOfDate.Checked = true;
                CommonFunctions.SetComboBoxValue(cmbSite, dr["Site"].ToString());
                //string Fundingsource = dr["FundingSource"].ToString();
                //if (Fundingsource == rbAll.Text)
                //    rbAll.Checked = true;
                //else
                //    rbSelected.Checked = true;

                chkbExcel.Checked = false;
                if (dr["EXCEL"].ToString() == "Y")
                    chkbExcel.Checked = true;

                string ReportType = dr["ReportType"].ToString();
                if (ReportType == rbSiteSummary.Text.Trim())
                {
                    rbSiteSummary.Checked = true;
                    rbRoomDetail_Click(this, new EventArgs());

                }
                else if (ReportType == rbRoomDetail.Text.Trim())
                {
                    rbRoomDetail.Checked = true;
                    rbRoomDetail_Click(this, new EventArgs());
                }
                else if (ReportType == rbFundDetailByRoom.Text.Trim())
                {
                    rbFundDetailByRoom.Checked = true;
                    rbFundDetailByRoom_Click(this, new EventArgs());
                }

                if (ReportType == rbFundDetailByRoom.Text.Trim())
                {
                    if (dr["FundedSource"].ToString() == "Y")
                        rbAll.Checked = true;
                    else
                    {
                        rbSelected.Checked = true;
                        SelFundingList.Clear();
                        string strFunds = dr["FundingCode"].ToString();
                        List<string> siteList = new List<string>();
                        if (strFunds != null)
                        {
                            string[] FundCodes = strFunds.Split(',');
                            for (int i = 0; i < FundCodes.Length; i++)
                            {
                                CommonEntity fundDetails = propfundingSource.Find(u => u.Code == FundCodes.GetValue(i).ToString());
                                SelFundingList.Add(fundDetails);
                            }
                        }
                        SelFundingList = SelFundingList;
                    }
                }

            }
        }

        List<MainMenuEntity> Base_MainMenu_List = new List<MainMenuEntity>();
        List<ENRL_Asof_Entity> Count_List = new List<ENRL_Asof_Entity>();
        List<ENRL_Asof_Entity> SiteSel_List = new List<ENRL_Asof_Entity>();
        List<ENRL_Asof_Entity> RoomSel_List = new List<ENRL_Asof_Entity>();
        private void btnGeneratePdf_Click(object sender, EventArgs e)
        {
            if (ValidateForm())
            {
                //string Year = "    ";
                //if (CmbYear.Visible == true) Year = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                //string SiteNum = string.Empty;
                //if (((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Value.ToString().Trim() != "0") SiteNum = ((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Value.ToString().Trim();

                //string strFundingCodes = string.Empty;
                //if (rbSelected.Checked == true)
                //{
                //    foreach (CommonEntity FundingCode in SelFundingList)
                //    {
                //        if (!strFundingCodes.Equals(string.Empty)) strFundingCodes += ",";
                //        strFundingCodes += FundingCode.Code;
                //    }
                //}
                //else
                //{
                //    strFundingCodes = "A";
                //}

                //DataSet ds = DatabaseLayer.SPAdminDB.Browse_HSSB2104(Agency, Depart, Program, Year, string.Empty, strFundingCodes, SiteNum, string.Empty, string.Empty, dtpAsOfDate.Text.Trim());

                //ENRL_Asof_List = new List<ENRL_Asof_Entity>();
                //ENRL_Asof_List.Clear(); Count_List.Clear(); SiteSel_List.Clear(); RoomSel_List.Clear();
                //if (ds != null && ds.Tables[0].Rows.Count > 0)
                //{
                //    foreach (DataRow row in ds.Tables[0].Rows)
                //        ENRL_Asof_List.Add(new ENRL_Asof_Entity(row, string.Empty));
                //}

                //if (ds != null && ds.Tables[1].Rows.Count > 0)
                //{
                //    foreach (DataRow row in ds.Tables[1].Rows)
                //        Count_List.Add(new ENRL_Asof_Entity(row, string.Empty,string.Empty));
                //}

                //if (ds != null && ds.Tables[2].Rows.Count > 0)
                //{
                //    foreach (DataRow row in ds.Tables[2].Rows)
                //        SiteSel_List.Add(new ENRL_Asof_Entity(row, string.Empty, "Site"));
                //}

                //if (ds != null && ds.Tables[3].Rows.Count > 0)
                //{
                //    foreach (DataRow row in ds.Tables[3].Rows)
                //        RoomSel_List.Add(new ENRL_Asof_Entity(row, string.Empty, "Room"));
                //}

                //PdfListForm pdfListForm = new PdfListForm(BaseForm, Privileges, false, propReportPath);
                //pdfListForm.FormClosed += new Form.FormClosedEventHandler(On_SaveFormClosed);
                //pdfListForm.FormClosed += new Form.FormClosedEventHandler(On_DetailFormClosed);
                //pdfListForm.ShowDialog();

                if (chkbExcel.Checked == true)
                {
                    PdfListForm pdfListForm = new PdfListForm(BaseForm, Privileges, false, propReportPath, "XLSX");
                    pdfListForm.FormClosed += new FormClosedEventHandler(On_SaveFormClosed);
                    //pdfListForm.FormClosed += new Form.FormClosedEventHandler(On_DetailFormClosed);
                    //pdfListForm.FormClosed += new FormClosedEventHandler(On_SaveExcelClosed);
                    pdfListForm.FormClosed += new FormClosedEventHandler(On_SaveExcelClosed_DevExpress);
                    //pdfListForm.FormClosed += new FormClosedEventHandler(On_DetailExcelFormClosed);
                    pdfListForm.FormClosed += new FormClosedEventHandler(On_DetailExcelFormClosed_DevExpress);
                    pdfListForm.StartPosition = FormStartPosition.CenterScreen;
                    pdfListForm.ShowDialog();
                }
                else
                {
                    PdfListForm pdfListForm = new PdfListForm(BaseForm, Privileges, false, propReportPath,"PDF");
                    pdfListForm.FormClosed += new FormClosedEventHandler(On_SaveFormClosed);
                    pdfListForm.StartPosition = FormStartPosition.CenterScreen;
                    //if (ENRL_Asof_List.Count > 0)
                    //    pdfListForm.FormClosed += new Form.FormClosedEventHandler(On_DetailFormClosed);
                    pdfListForm.ShowDialog();
                }

            }   
        }

        #region PrintingReportDetails

        PdfContentByte cb;
        string strFolderPath = string.Empty;
        string Random_Filename = null;
        string PdfName = "Pdf File";
        BaseFont bfTimes = BaseFont.CreateFont(BaseFont.TIMES_ROMAN, BaseFont.CP1252, false);
        int Y_Pos;

        private void On_SaveFormClosed1(object sender, FormClosedEventArgs e)
        {
            PdfListForm form = sender as PdfListForm;
            if (form.DialogResult == DialogResult.OK)
            {
                StringBuilder strMstApplUpdate = new StringBuilder();
                string PdfName = "Pdf File";
                PdfName = form.GetFileName();
                string NamePdf = PdfName;
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                try
                {
                    if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                    { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
                }
                catch (Exception ex)
                {
                    AlertBox.Show("Error", MessageBoxIcon.Error);
                    ex.ToString();
                }


                try
                {
                    string Tmpstr = PdfName + ".pdf";
                    if (File.Exists(Tmpstr))
                        File.Delete(Tmpstr);
                }
                catch (Exception ex)
                {
                    int length = 8;
                    string newFileName = System.Guid.NewGuid().ToString();
                    newFileName = newFileName.Replace("-", string.Empty);

                    Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
                }


                if (!string.IsNullOrEmpty(Random_Filename))
                    PdfName = Random_Filename;
                else
                    PdfName += ".pdf";

                FileStream fs = new FileStream(PdfName, FileMode.Create);

                Document document = new Document(PageSize.A4, 30f, 30f, 30f, 50f);
                PdfWriter writer = PdfWriter.GetInstance(document, fs);
                document.Open();
                BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
                iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
                BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
                iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(bf_times, 9, 4);
                BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

                iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 10);
                iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
                iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 9, 3);
                iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(bf_times, 9, 1);
                iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
                iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);
                cb = writer.DirectContent;

                try
                {
                    PrintHeaderPage(document, writer);
                    document.NewPage();

                    string Year = "    ";
                    if (CmbYear.Visible == true) Year = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                    string SiteNum = string.Empty;
                    if (((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Value.ToString().Trim() != "0") SiteNum = ((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Value.ToString().Trim();

                    string strFundingCodes = string.Empty;
                    if (rbSelected.Checked == true)
                    {
                        foreach (CommonEntity FundingCode in SelFundingList)
                        {
                            if (!strFundingCodes.Equals(string.Empty)) strFundingCodes += ",";
                            strFundingCodes += FundingCode.Code;
                        }
                    }
                    else
                    {
                        strFundingCodes = "A";
                    }

                    DataSet ds = DatabaseLayer.SPAdminDB.Browse_HSSB2104(Agency, Depart, Program, Year, string.Empty, strFundingCodes, SiteNum, string.Empty, string.Empty, dtpAsOfDate.Text.Trim(),BaseForm.UserProfile.UserID);

                    ENRL_Asof_List = new List<ENRL_Asof_Entity>();
                    ENRL_Asof_List.Clear(); Count_List.Clear(); SiteSel_List.Clear(); RoomSel_List.Clear();
                    if (ds != null && ds.Tables[0].Rows.Count > 0)
                    {
                        foreach (DataRow row in ds.Tables[0].Rows)
                            ENRL_Asof_List.Add(new ENRL_Asof_Entity(row, string.Empty));
                    }

                    if (ds != null && ds.Tables[1].Rows.Count > 0)
                    {
                        foreach (DataRow row in ds.Tables[1].Rows)
                            Count_List.Add(new ENRL_Asof_Entity(row, string.Empty, string.Empty));
                    }

                    if (ds != null && ds.Tables[2].Rows.Count > 0)
                    {
                        foreach (DataRow row in ds.Tables[2].Rows)
                            SiteSel_List.Add(new ENRL_Asof_Entity(row, string.Empty, "Site"));
                    }

                    if (ds != null && ds.Tables[3].Rows.Count > 0)
                    {
                        foreach (DataRow row in ds.Tables[3].Rows)
                            RoomSel_List.Add(new ENRL_Asof_Entity(row, string.Empty, "Room"));
                    }



                    Y_Pos = 795;

                    string PrivSite = string.Empty; string PrivRoom = string.Empty; string PrivAmpm = string.Empty;

                    PdfPTable table = new PdfPTable(7);
                    table.TotalWidth = 550f;
                    table.WidthPercentage = 100;
                    table.LockedWidth = true;
                    float[] widths = new float[] { 40f, 18f, 18f, 18f, 18f, 30f, 23f };// 30f, 25f, 18f, 18f, 20f, 25f, 30f, 20f, 25f, 18f, 18f, 22f };
                    table.SetWidths(widths);
                    table.HorizontalAlignment = Element.ALIGN_CENTER;

                    if (rbSiteSummary.Checked == true)
                    {
                        if (SiteSel_List.Count > 0)
                        {
                            string[] HeaderSeq = { "Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                            for (int i = 0; i < HeaderSeq.Length; ++i)
                            {
                                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                table.AddCell(cell);
                            }

                            int Enrl_cnt = 0; //int Wdraw_cnt = 0; int day30_cnt = 0; int Attn1_cnt = 0; int FirstTime_cnt = 0;
                            //int totEnrl_cnt = 0; int totWdraw_cnt = 0; int totday30_cnt = 0; int totAttn1_cnt = 0; int totFirstTime_cnt = 0; int TotFunds = 0;
                            int FundedTotal = 0;
                            //List<ENRL_Asof_Entity> SiteCount = new List<ENRL_Asof_Entity>();
                            int Cnt = 1;
                            foreach (ENRL_Asof_Entity Entity in SiteSel_List)
                            {
                                PdfPCell SiteName = new PdfPCell(new Phrase(Entity.Site.Trim(), TableFont));
                                SiteName.HorizontalAlignment = Element.ALIGN_LEFT;
                                //SiteName.Colspan = 7;
                                //SiteName.Border = iTextSharp.text.Rectangle.BOX;
                                SiteName.Border = 0;
                                SiteName.BorderWidthLeft = 0.5f; SiteName.BorderColorLeft = BaseColor.BLACK;
                                //if (Cnt == SiteSel_List.Count)
                                //{ SiteName.BorderWidthBottom = 0.5f; SiteName.BorderColorBottom = BaseColor.BLACK; }
                                //else
                                { SiteName.BorderWidthBottom = 0.5f; SiteName.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                //SiteName.BorderWidthLeft = 0.5f; SiteName.BorderColorLeft = BaseColor.BLACK;
                                table.AddCell(SiteName);

                                CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()));
                                //string Enroll = string.Empty; int Count = 0;

                                if (selsite != null)
                                {
                                    PdfPCell tot_fun = new PdfPCell(new Phrase(selsite.SITE_FUNDED_SLOTS.Trim(), TableFont));
                                    tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                    //tot_fun.Border = iTextSharp.text.Rectangle.BOX;
                                    tot_fun.Border = 0;
                                    tot_fun.BorderWidthLeft = 0.5f; tot_fun.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                    //if (Cnt == SiteSel_List.Count)
                                    //{ tot_fun.BorderWidthBottom = 0.5f; tot_fun.BorderColorBottom = BaseColor.BLACK; }
                                    //else //if(cnt!=1)
                                    { tot_fun.BorderWidthBottom = 0.5f; tot_fun.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                    table.AddCell(tot_fun);

                                    //SiteCount = Count_List.FindAll(u => u.Site.Trim().Equals(Entity.Site.Trim()));

                                    //Count = SiteCount.Sum(u => int.Parse(u.Enrolled.Trim()));


                                    //if (Count < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                    //    Enroll = Count + "*";
                                    //else Enroll = Count.ToString();

                                    //FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());

                                }
                                else
                                {
                                    PdfPCell tot_fun = new PdfPCell(new Phrase("", TableFont));
                                    tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                    //tot_fun.Border = iTextSharp.text.Rectangle.BOX;
                                    tot_fun.Border = 0;
                                    tot_fun.BorderWidthLeft = 0.5f; tot_fun.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                    //if (Cnt == SiteSel_List.Count)
                                    //{ tot_fun.BorderWidthBottom = 0.5f; tot_fun.BorderColorBottom = BaseColor.BLACK; }
                                    //else //if(cnt!=1)
                                    { tot_fun.BorderWidthBottom = 0.5f; tot_fun.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                    table.AddCell(tot_fun);
                                }

                                int Count = 0;
                                List<ENRL_Asof_Entity> SiteCount = Count_List.FindAll(u => u.Site.Trim().Equals(Entity.Site.Trim()));

                                List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Enrolled.Equals("1"));
                                var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                if (enrolled_Count.Count > 0) Count = enrolled_Count.Count;

                                //Count = SiteCount.Sum(u => int.Parse(u.Enrolled.Trim()));

                                string Enroll = string.Empty;
                                if (selsite != null)
                                {
                                    if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                    {
                                        if (Count < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                            Enroll = Count + "*";
                                        else Enroll = Count.ToString();

                                        FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                    }
                                    else Enroll = Count.ToString();
                                }


                                PdfPCell tot_enrl = new PdfPCell(new Phrase(Enroll, TableFont));
                                tot_enrl.HorizontalAlignment = Element.ALIGN_CENTER;
                                //tot_enrl.Border = iTextSharp.text.Rectangle.BOX;
                                tot_enrl.Border = 0;
                                tot_enrl.BorderWidthLeft = 0.5f; tot_enrl.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                if (Cnt == SiteSel_List.Count)
                                { tot_enrl.BorderWidthBottom = 0.5f; tot_enrl.BorderColorBottom = BaseColor.BLACK; }
                                else //if(cnt!=1)
                                { tot_enrl.BorderWidthBottom = 0.5f; tot_enrl.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                table.AddCell(tot_enrl);

                                Count = SiteCount.Sum(u => int.Parse(u.Window30.Trim()));
                                PdfPCell tot_30 = new PdfPCell(new Phrase(Count.ToString(), TableFont));
                                tot_30.HorizontalAlignment = Element.ALIGN_CENTER;
                                //tot_30.Border = iTextSharp.text.Rectangle.BOX;
                                tot_30.Border = 0;
                                tot_30.BorderWidthLeft = 0.5f; tot_30.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                //if (Cnt == SiteSel_List.Count)
                                //{ tot_30.BorderWidthBottom = 0.5f; tot_30.BorderColorBottom = BaseColor.BLACK; }
                                //else //if(cnt!=1)
                                { tot_30.BorderWidthBottom = 0.5f; tot_30.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                table.AddCell(tot_30);

                                Count = SiteCount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                PdfPCell tot_W = new PdfPCell(new Phrase(Count.ToString(), TableFont));
                                tot_W.HorizontalAlignment = Element.ALIGN_CENTER;
                                //tot_W.Border = iTextSharp.text.Rectangle.BOX;
                                tot_W.Border = 0;
                                tot_W.BorderWidthLeft = 0.5f; tot_W.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                if (Cnt == SiteSel_List.Count)
                                { tot_W.BorderWidthBottom = 0.5f; tot_W.BorderColorBottom = BaseColor.BLACK; }
                                else //if(cnt!=1)
                                { tot_W.BorderWidthBottom = 0.5f; tot_W.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                table.AddCell(tot_W);

                                Count = SiteCount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                PdfPCell tot_First = new PdfPCell(new Phrase(Count.ToString(), TableFont));
                                tot_First.HorizontalAlignment = Element.ALIGN_CENTER;
                                //tot_First.Border = iTextSharp.text.Rectangle.BOX;
                                tot_First.Border = 0;
                                tot_First.BorderWidthLeft = 0.5f; tot_First.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                //if (Cnt == SiteSel_List.Count)
                                //{ tot_First.BorderWidthBottom = 0.5f; tot_First.BorderColorBottom = BaseColor.BLACK; }
                                //else //if(cnt!=1)
                                { tot_First.BorderWidthBottom = 0.5f; tot_First.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                table.AddCell(tot_First);

                                Count = SiteCount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                PdfPCell tot_attn1 = new PdfPCell(new Phrase(Count.ToString(), TableFont));
                                tot_attn1.HorizontalAlignment = Element.ALIGN_CENTER;
                                tot_attn1.Border = 0;
                                tot_attn1.BorderWidthLeft = 0.5f; tot_attn1.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                tot_attn1.BorderWidthRight = 0.5f; tot_attn1.BorderColorRight = BaseColor.BLACK;
                                //if (Cnt == SiteSel_List.Count)
                                //{ tot_attn1.BorderWidthBottom = 0.5f; tot_attn1.BorderColorBottom = BaseColor.BLACK; }
                                //else //if(cnt!=1)
                                { tot_attn1.BorderWidthBottom = 0.5f; tot_attn1.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                table.AddCell(tot_attn1);

                                Cnt++;
                            }

                            document.Add(table);
                            table.DeleteBodyRows();

                            document.NewPage();
                            string[] HeaderSeq1 = { "Fund", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                            for (int i = 0; i < HeaderSeq.Length; ++i)
                            {
                                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq1[i], TblFontBold));
                                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                //cell.FixedHeight = 15f;
                                cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                table.AddCell(cell);
                            }

                            int Total_Count = 0;
                            PdfPCell Rep = new PdfPCell(new Phrase("Report Totals:", TableFont));
                            Rep.HorizontalAlignment = Element.ALIGN_LEFT;
                            //Rep.Border = iTextSharp.text.Rectangle.BOX;
                            Rep.Border = 0;
                            Rep.BorderWidthLeft = 0.5f;Rep.BorderColorLeft = BaseColor.BLACK;
                            Rep.BorderWidthBottom = 0.5f; Rep.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(Rep);

                            Total_Count = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));
                            if (Total_Count > 0)
                            {
                                PdfPCell Rep1 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                                Rep1.HorizontalAlignment = Element.ALIGN_CENTER;
                                //Rep1.Border = iTextSharp.text.Rectangle.BOX;
                                Rep1.Border = 0;
                                Rep1.BorderWidthLeft = 0.5f; Rep1.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                Rep1.BorderWidthBottom = 0.5f; Rep1.BorderColorBottom = BaseColor.BLACK;
                                table.AddCell(Rep1);
                            }
                            else
                            {
                                PdfPCell Rep1 = new PdfPCell(new Phrase(FundedTotal.ToString(), TableFont));
                                Rep1.HorizontalAlignment = Element.ALIGN_CENTER;
                                //Rep1.Border = iTextSharp.text.Rectangle.BOX;
                                Rep1.Border = 0;
                                Rep1.BorderWidthLeft = 0.5f; Rep1.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                Rep1.BorderWidthBottom = 0.5f; Rep1.BorderColorBottom = BaseColor.BLACK;
                                table.AddCell(Rep1);
                            }

                            List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                            var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                            if (Repenrolled_Count.Count > 0) Total_Count = Repenrolled_Count.Count;
                            //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                            PdfPCell Rep2 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep2.HorizontalAlignment = Element.ALIGN_CENTER;
                            //Rep2.Border = iTextSharp.text.Rectangle.BOX;
                            Rep2.Border = 0;
                            Rep2.BorderWidthLeft = 0.5f; Rep2.BorderColorLeft = BaseColor.LIGHT_GRAY;
                            Rep2.BorderWidthBottom = 0.5f; Rep2.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(Rep2);

                            Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                            PdfPCell Rep3 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep3.HorizontalAlignment = Element.ALIGN_CENTER;
                            //Rep3.Border = iTextSharp.text.Rectangle.BOX;
                            Rep3.Border = 0;
                            Rep3.BorderWidthLeft = 0.5f; Rep3.BorderColorLeft = BaseColor.LIGHT_GRAY;
                            Rep3.BorderWidthBottom = 0.5f; Rep3.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(Rep3);

                            Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                            PdfPCell Rep4 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep4.HorizontalAlignment = Element.ALIGN_CENTER;
                            //Rep4.Border = iTextSharp.text.Rectangle.BOX;
                            Rep4.Border = 0;
                            Rep4.BorderWidthLeft = 0.5f; Rep4.BorderColorLeft = BaseColor.LIGHT_GRAY;
                            Rep4.BorderWidthBottom = 0.5f; Rep4.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(Rep4);

                            Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                            PdfPCell Rep5 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep5.HorizontalAlignment = Element.ALIGN_CENTER;
                            //Rep5.Border = iTextSharp.text.Rectangle.BOX;
                            Rep5.Border = 0;
                            Rep5.BorderWidthLeft = 0.5f; Rep5.BorderColorLeft = BaseColor.LIGHT_GRAY;
                            Rep5.BorderWidthBottom = 0.5f; Rep5.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(Rep5);

                            Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                            PdfPCell Rep6 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep6.HorizontalAlignment = Element.ALIGN_CENTER;
                            //Rep6.Border = iTextSharp.text.Rectangle.BOX;
                            Rep6.Border = 0;
                            Rep6.BorderWidthLeft = 0.5f; Rep6.BorderColorLeft = BaseColor.LIGHT_GRAY;
                            Rep6.BorderWidthRight = 0.5f; Rep6.BorderColorRight = BaseColor.BLACK;
                            Rep6.BorderWidthBottom = 0.5f; Rep6.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(Rep6);

                            if (propfundingSource.Count > 0)
                            {
                                //var Fundcnt = Count_List.Select(u => u.FundHie!= "None").Distinct().ToList();
                                //int Fundcnt = Count_List.Where(u => u.FundHie <> "None").Select(m => m.FundHie).Distinct().Count();
                                int Fundcnt = Count_List.Select(t => t.FundHie).Distinct().Count(s => s != "None");
                                int FCnt = 1;
                                foreach (CommonEntity FundEntity in propfundingSource)
                                {
                                    List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                    int EnrlCnt = 0; int Wcnt = 0;
                                    if (Fundlistcount.Count > 0)
                                    {
                                        EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                        Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                        int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                        //if (EnrlCnt > 0 || Wcnt > 0)
                                        //{
                                        PdfPCell Fund = new PdfPCell(new Phrase("     " + FundEntity.Desc, TableFont));
                                        Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                        if(FundCnt==0)
                                            Fund.Colspan = 2;
                                        //Fund.Border = iTextSharp.text.Rectangle.BOX;
                                        Fund.Border = 0;
                                        Fund.BorderWidthLeft = 0.5f; Fund.BorderColorLeft = BaseColor.BLACK;
                                        if (FCnt== Fundcnt)
                                        {
                                            Fund.BorderWidthBottom = 0.5f; Fund.BorderColorBottom = BaseColor.BLACK;
                                        }
                                        else
                                        { Fund.BorderWidthBottom = 0.5f; Fund.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                        table.AddCell(Fund);

                                        if (FundCnt > 0)
                                        {
                                            PdfPCell Fund8 = new PdfPCell(new Phrase(FundCnt.ToString(), TableFont));
                                            Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                            //Fund8.Border = iTextSharp.text.Rectangle.BOX;
                                            Fund8.Border = 0;
                                            Fund8.BorderWidthLeft = 0.5f; Fund8.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                            if (FCnt == Fundcnt)
                                            {
                                                Fund8.BorderWidthBottom = 0.5f; Fund8.BorderColorBottom = BaseColor.BLACK;
                                            }
                                            else
                                            { Fund8.BorderWidthBottom = 0.5f; Fund8.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                            table.AddCell(Fund8);
                                        }

                                        PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                        Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //Fund1.Border = iTextSharp.text.Rectangle.BOX;
                                        Fund1.Border = 0;
                                        Fund1.BorderWidthLeft = 0.5f; Fund1.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        if (FCnt == Fundcnt)
                                        {
                                            Fund1.BorderWidthBottom = 0.5f; Fund1.BorderColorBottom = BaseColor.BLACK;
                                        }
                                        else
                                        { Fund1.BorderWidthBottom = 0.5f; Fund1.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                        table.AddCell(Fund1);

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                        PdfPCell Fund2 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                        Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //Fund2.Border = iTextSharp.text.Rectangle.BOX;
                                        Fund2.Border = 0;
                                        Fund2.BorderWidthLeft = 0.5f; Fund2.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        if (FCnt == Fundcnt)
                                        {
                                            Fund2.BorderWidthBottom = 0.5f; Fund2.BorderColorBottom = BaseColor.BLACK;
                                        }
                                        else
                                        { Fund2.BorderWidthBottom = 0.5f; Fund2.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                        table.AddCell(Fund2);

                                        //Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                        PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                        Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //Fund3.Border = iTextSharp.text.Rectangle.BOX;
                                        Fund3.Border = 0;
                                        Fund3.BorderWidthLeft = 0.5f; Fund3.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        if (FCnt == Fundcnt)
                                        {
                                            Fund3.BorderWidthBottom = 0.5f; Fund3.BorderColorBottom = BaseColor.BLACK;
                                        }
                                        else
                                        { Fund3.BorderWidthBottom = 0.5f; Fund3.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                        table.AddCell(Fund3);

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                        PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                        Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //Fund4.Border = iTextSharp.text.Rectangle.BOX;
                                        Fund4.Border = 0;
                                        Fund4.BorderWidthLeft = 0.5f; Fund4.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        if (FCnt == Fundcnt)
                                        {
                                            Fund4.BorderWidthBottom = 0.5f; Fund4.BorderColorBottom = BaseColor.BLACK;
                                        }
                                        else
                                        { Fund4.BorderWidthBottom = 0.5f; Fund4.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                        table.AddCell(Fund4);

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                        PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                        Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //Fund5.Border = iTextSharp.text.Rectangle.BOX;
                                        Fund5.Border = 0;
                                        Fund5.BorderWidthLeft = 0.5f; Fund5.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        Fund5.BorderWidthRight = 0.5f; Fund5.BorderColorRight = BaseColor.BLACK;
                                        if (FCnt == Fundcnt)
                                        {
                                            Fund5.BorderWidthBottom = 0.5f; Fund5.BorderColorBottom = BaseColor.BLACK;
                                        }
                                        else
                                        { Fund5.BorderWidthBottom = 0.5f; Fund5.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                        table.AddCell(Fund5);

                                        FCnt++;
                                        //}
                                    }
                                }
                            }

                            document.Add(table);

                        }

                    }

                    if (rbRoomDetail.Checked == true)
                    {
                        
                            CaseSiteEntity Search_Entity = new CaseSiteEntity(true);
                            Search_Entity.SiteAGENCY = Agency;
                            Search_Entity.SiteDEPT = Depart; Search_Entity.SitePROG = Program;
                            if (CmbYear.Visible == true) Search_Entity.SiteYEAR = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                            propCaseAllSiteEntity = _model.CaseMstData.Browse_CASESITE(Search_Entity, "Browse");
                        
                        if (RoomSel_List.Count > 0)
                        {
                            bool First = true;

                            string[] HeaderSeq = { "Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                            for (int i = 0; i < HeaderSeq.Length; ++i)
                            {
                                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                //cell.FixedHeight = 15f;
                                cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                table.AddCell(cell);
                            }
                            int Enrl_cnt = 0; //int Wdraw_cnt = 0; int day30_cnt = 0; int Attn1_cnt = 0; int FirstTime_cnt = 0;
                            int totEnrl_cnt = 0; int totWdraw_cnt = 0; int totday30_cnt = 0; int totAttn1_cnt = 0; int totFirstTime_cnt = 0; int TotFunds = 0;
                            int FundedTotal = 0; int cnt = 1;
                            foreach (ENRL_Asof_Entity Entity in RoomSel_List)
                            {
                                if (!First)
                                {
                                    if (Entity.Site.Trim() != PrivSite)
                                    {
                                        PdfPCell SiteName2 = new PdfPCell(new Phrase("Total " + PrivSite, TableFont));
                                        SiteName2.HorizontalAlignment = Element.ALIGN_LEFT;
                                        //SiteName2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        SiteName2.Border = 0;
                                        SiteName2.BorderWidthLeft = 0.5f; SiteName2.BorderColorLeft = BaseColor.BLACK;
                                        SiteName2.BorderWidthBottom = 0.5f; SiteName2.BorderColorBottom = BaseColor.BLACK;
                                        table.AddCell(SiteName2);

                                        PdfPCell tot_fun1 = new PdfPCell(new Phrase(TotFunds.ToString(), TableFont));
                                        tot_fun1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //tot_fun1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        tot_fun1.Border = 0;
                                        tot_fun1.BorderWidthLeft = 0.5f; tot_fun1.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        tot_fun1.BorderWidthBottom = 0.5f; tot_fun1.BorderColorBottom = BaseColor.BLACK;
                                        table.AddCell(tot_fun1);

                                        string totEnroll = string.Empty;
                                        if (totEnrl_cnt < TotFunds)
                                            totEnroll = totEnrl_cnt.ToString() + "*";
                                        else totEnroll = totEnrl_cnt.ToString();

                                        //FundedTotal = FundedTotal + TotFunds;

                                        PdfPCell tot_enrl1 = new PdfPCell(new Phrase(totEnroll, TableFont));
                                        tot_enrl1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //tot_enrl1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        tot_enrl1.Border = 0;
                                        tot_enrl1.BorderWidthLeft = 0.5f; tot_enrl1.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        tot_enrl1.BorderWidthBottom = 0.5f; tot_enrl1.BorderColorBottom = BaseColor.BLACK;
                                        table.AddCell(tot_enrl1);

                                        PdfPCell tot_301 = new PdfPCell(new Phrase(totday30_cnt.ToString(), TableFont));
                                        tot_301.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //tot_301.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        tot_301.Border = 0;
                                        tot_301.BorderWidthLeft = 0.5f; tot_301.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        tot_301.BorderWidthBottom = 0.5f; tot_301.BorderColorBottom = BaseColor.BLACK;
                                        table.AddCell(tot_301);

                                        PdfPCell tot_W1 = new PdfPCell(new Phrase(totWdraw_cnt.ToString(), TableFont));
                                        tot_W1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //tot_W1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        tot_W1.Border = 0;
                                        tot_W1.BorderWidthLeft = 0.5f; tot_W1.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        tot_W1.BorderWidthBottom = 0.5f; tot_W1.BorderColorBottom = BaseColor.BLACK;
                                        table.AddCell(tot_W1);

                                        PdfPCell tot_First1 = new PdfPCell(new Phrase(totFirstTime_cnt.ToString(), TableFont));
                                        tot_First1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //tot_First1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        tot_First1.Border = 0;
                                        tot_First1.BorderWidthLeft = 0.5f; tot_First1.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        tot_First1.BorderWidthBottom = 0.5f; tot_First1.BorderColorBottom = BaseColor.BLACK;
                                        table.AddCell(tot_First1);

                                        PdfPCell tot_attn1 = new PdfPCell(new Phrase(totAttn1_cnt.ToString(), TableFont));
                                        tot_attn1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //tot_attn1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        tot_attn1.Border = 0;
                                        tot_attn1.BorderWidthLeft = 0.5f; tot_attn1.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        tot_attn1.BorderWidthRight = 0.5f; tot_attn1.BorderColorRight = BaseColor.BLACK;
                                        tot_attn1.BorderWidthBottom = 0.5f; tot_attn1.BorderColorBottom = BaseColor.BLACK;
                                        table.AddCell(tot_attn1);

                                        totEnrl_cnt = 0; totWdraw_cnt = 0; totAttn1_cnt = 0;
                                        totday30_cnt = 0; totFirstTime_cnt = 0; TotFunds = 0;

                                        if (table.Rows.Count > 1)
                                        {
                                            document.Add(table);
                                            table.DeleteBodyRows();
                                            document.NewPage();
                                        }
                                        string[] HeaderSeq1 = { "Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                                        for (int i = 0; i < HeaderSeq.Length; ++i)
                                        {
                                            PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq1[i], TblFontBold));
                                            cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                            //cell.FixedHeight = 15f;
                                            cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                            table.AddCell(cell);
                                        }

                                        PdfPCell SiteName = new PdfPCell(new Phrase(Entity.Site.Trim(), TableFont));
                                        SiteName.HorizontalAlignment = Element.ALIGN_LEFT;
                                        SiteName.Colspan = 7;
                                        //SiteName.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        SiteName.Border = 0;
                                        SiteName.BorderWidthLeft = 0.5f;SiteName.BorderColorLeft = BaseColor.BLACK;
                                        SiteName.BorderWidthRight = 0.5f; SiteName.BorderColorRight = BaseColor.BLACK;
                                        SiteName.BorderWidthBottom = 0.5f; SiteName.BorderColorBottom = BaseColor.LIGHT_GRAY;
                                        table.AddCell(SiteName);

                                    }

                                    PdfPCell SiteName1 = new PdfPCell(new Phrase("      " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim(), TableFont));
                                    SiteName1.HorizontalAlignment = Element.ALIGN_LEFT;
                                    //SiteName1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    SiteName1.Border = 0;
                                    SiteName1.BorderWidthLeft = 0.5f; SiteName1.BorderColorLeft = BaseColor.BLACK;
                                    if(cnt==RoomSel_List.Count)
                                    { SiteName1.BorderWidthBottom = 0.5f; SiteName1.BorderColorBottom = BaseColor.BLACK; }
                                    else
                                    { SiteName1.BorderWidthBottom = 0.5f; SiteName1.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                    table.AddCell(SiteName1);

                                    CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));

                                    List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                    var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                    if (enrolled_Count.Count > 0) Entity.Enrolled = enrolled_Count.Count.ToString();
                                    string Enroll = string.Empty;
                                    if (selsite != null)
                                    {
                                        PdfPCell tot_fun = new PdfPCell(new Phrase(selsite.SITE_FUNDED_SLOTS.Trim(), TableFont));
                                        tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //tot_fun.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        tot_fun.Border = 0;
                                        tot_fun.BorderWidthLeft = 0.5f; tot_fun.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        if (cnt == RoomSel_List.Count)
                                        { tot_fun.BorderWidthBottom = 0.5f; tot_fun.BorderColorBottom = BaseColor.BLACK; }
                                        else
                                        { tot_fun.BorderWidthBottom = 0.5f; tot_fun.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                        table.AddCell(tot_fun);
                                        if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                        {
                                            if (int.Parse(Entity.Enrolled) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                Enroll = Entity.Enrolled + "*";
                                            else Enroll = Entity.Enrolled;
                                        }
                                        else Enroll = Entity.Enrolled;
                                    }
                                    else
                                    {
                                        PdfPCell tot_fun = new PdfPCell(new Phrase("", TableFont));
                                        tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //tot_fun.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        tot_fun.Border = 0;
                                        tot_fun.BorderWidthLeft = 0.5f; tot_fun.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        if (cnt == RoomSel_List.Count)
                                        { tot_fun.BorderWidthBottom = 0.5f; tot_fun.BorderColorBottom = BaseColor.BLACK; }
                                        else
                                        { tot_fun.BorderWidthBottom = 0.5f; tot_fun.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                        table.AddCell(tot_fun);

                                         Enroll = Entity.Enrolled;
                                    }

                                    
                                    PdfPCell tot_enrl = new PdfPCell(new Phrase(Enroll, TableFont));
                                    tot_enrl.HorizontalAlignment = Element.ALIGN_CENTER;
                                    //tot_enrl.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    tot_enrl.Border = 0;
                                    tot_enrl.BorderWidthLeft = 0.5f; tot_enrl.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                    if (cnt == RoomSel_List.Count)
                                    { tot_enrl.BorderWidthBottom = 0.5f; tot_enrl.BorderColorBottom = BaseColor.BLACK; }
                                    else
                                    { tot_enrl.BorderWidthBottom = 0.5f; tot_enrl.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                    table.AddCell(tot_enrl);

                                    PdfPCell tot_30 = new PdfPCell(new Phrase(Entity.Window30, TableFont));
                                    tot_30.HorizontalAlignment = Element.ALIGN_CENTER;
                                    //tot_30.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    tot_30.Border = 0;
                                    tot_30.BorderWidthLeft = 0.5f; tot_30.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                    if (cnt == RoomSel_List.Count)
                                    { tot_30.BorderWidthBottom = 0.5f; tot_30.BorderColorBottom = BaseColor.BLACK; }
                                    else
                                    { tot_30.BorderWidthBottom = 0.5f; tot_30.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                    table.AddCell(tot_30);

                                    PdfPCell tot_W = new PdfPCell(new Phrase(Entity.Withdrawn, TableFont));
                                    tot_W.HorizontalAlignment = Element.ALIGN_CENTER;
                                    //tot_W.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    tot_W.Border = 0;
                                    tot_W.BorderWidthLeft = 0.5f; tot_W.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                    if (cnt == RoomSel_List.Count)
                                    { tot_W.BorderWidthBottom = 0.5f; tot_W.BorderColorBottom = BaseColor.BLACK; }
                                    else
                                    { tot_W.BorderWidthBottom = 0.5f; tot_W.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                    table.AddCell(tot_W);

                                    PdfPCell tot_First = new PdfPCell(new Phrase(Entity.FirstTime, TableFont));
                                    tot_First.HorizontalAlignment = Element.ALIGN_CENTER;
                                    //tot_First.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    tot_First.Border = 0;
                                    tot_First.BorderWidthLeft = 0.5f; tot_First.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                    if (cnt == RoomSel_List.Count)
                                    { tot_First.BorderWidthBottom = 0.5f; tot_First.BorderColorBottom = BaseColor.BLACK; }
                                    else
                                    { tot_First.BorderWidthBottom = 0.5f; tot_First.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                    table.AddCell(tot_First);

                                    PdfPCell tot_attn12 = new PdfPCell(new Phrase(Entity.GetAttn1, TableFont));
                                    tot_attn12.HorizontalAlignment = Element.ALIGN_CENTER;
                                    //tot_attn12.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    tot_attn12.Border = 0;
                                    tot_attn12.BorderWidthLeft = 0.5f; tot_attn12.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                    tot_attn12.BorderWidthRight = 0.5f; tot_attn12.BorderColorRight  = BaseColor.BLACK;
                                    if (cnt == RoomSel_List.Count)
                                    { tot_attn12.BorderWidthBottom = 0.5f; tot_attn12.BorderColorBottom = BaseColor.BLACK; }
                                    else
                                    { tot_attn12.BorderWidthBottom = 0.5f; tot_attn12.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                    table.AddCell(tot_attn12);

                                    totEnrl_cnt = totEnrl_cnt + int.Parse(Entity.Enrolled); totWdraw_cnt = totWdraw_cnt + int.Parse(Entity.Withdrawn); totAttn1_cnt = totAttn1_cnt + int.Parse(Entity.GetAttn1);
                                    totday30_cnt = totday30_cnt + int.Parse(Entity.Window30); totFirstTime_cnt = totFirstTime_cnt + int.Parse(Entity.FirstTime);
                                    if (selsite != null)
                                    {
                                        if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                        {
                                            TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                            FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                        }
                                    }
                                    PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM.Trim();
                                    
                                }
                                else
                                {
                                    PdfPCell SiteName = new PdfPCell(new Phrase(Entity.Site.Trim(), TableFont));
                                    SiteName.HorizontalAlignment = Element.ALIGN_LEFT;
                                    SiteName.Colspan = 7;
                                    //SiteName.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    SiteName.Border = 0;
                                    SiteName.BorderWidthLeft = 0.5f; SiteName.BorderColorLeft = BaseColor.BLACK;
                                    SiteName.BorderWidthRight = 0.5f; SiteName.BorderColorRight = BaseColor.BLACK;
                                    SiteName.BorderWidthBottom = 0.5f; SiteName.BorderColorBottom = BaseColor.LIGHT_GRAY;
                                    table.AddCell(SiteName);

                                    PdfPCell SiteName1 = new PdfPCell(new Phrase("      "+Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim(), TableFont));
                                    SiteName1.HorizontalAlignment = Element.ALIGN_LEFT;
                                    //SiteName1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    SiteName1.Border = 0;
                                    SiteName1.BorderWidthLeft = 0.5f; SiteName1.BorderColorLeft = BaseColor.BLACK;
                                    //if (cnt == RoomSel_List.Count)
                                    //{ SiteName1.BorderWidthBottom = 0.5f; SiteName1.BorderColorBottom = BaseColor.BLACK; }
                                    //else
                                    { SiteName1.BorderWidthBottom = 0.5f; SiteName1.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                    table.AddCell(SiteName1);

                                    CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));
                                    List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                    var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                    if (enrolled_Count.Count > 0) Entity.Enrolled = enrolled_Count.Count.ToString();
                                    string Enroll = string.Empty;
                                    if (selsite != null)
                                    {
                                        PdfPCell tot_fun = new PdfPCell(new Phrase(selsite.SITE_FUNDED_SLOTS.Trim(), TableFont));
                                        tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //tot_fun.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        tot_fun.Border = 0;
                                        tot_fun.BorderWidthLeft = 0.5f; tot_fun.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        //if (cnt == RoomSel_List.Count)
                                        //{ tot_fun.BorderWidthBottom = 0.5f; tot_fun.BorderColorBottom = BaseColor.BLACK; }
                                        //else
                                        { tot_fun.BorderWidthBottom = 0.5f; tot_fun.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                        table.AddCell(tot_fun);

                                        if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                        {
                                            if (int.Parse(Entity.Enrolled) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                Enroll = Entity.Enrolled + "*";
                                            else Enroll = Entity.Enrolled;
                                        }
                                        else Enroll = Entity.Enrolled;

                                    }
                                    else
                                    {
                                        PdfPCell tot_fun = new PdfPCell(new Phrase("", TableFont));
                                        tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //tot_fun.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        tot_fun.Border = 0;
                                        tot_fun.BorderWidthLeft = 0.5f; tot_fun.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        //if (cnt == RoomSel_List.Count)
                                        //{ tot_fun.BorderWidthBottom = 0.5f; tot_fun.BorderColorBottom = BaseColor.BLACK; }
                                        //else
                                        { tot_fun.BorderWidthBottom = 0.5f; tot_fun.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                        table.AddCell(tot_fun);

                                        Enroll = Entity.Enrolled;
                                    }

                                    PdfPCell tot_enrl = new PdfPCell(new Phrase(Enroll, TableFont));
                                    tot_enrl.HorizontalAlignment = Element.ALIGN_CENTER;
                                    //tot_enrl.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    tot_enrl.Border = 0;
                                    tot_enrl.BorderWidthLeft = 0.5f; tot_enrl.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                    //if (cnt == RoomSel_List.Count)
                                    //{ tot_enrl.BorderWidthBottom = 0.5f; tot_enrl.BorderColorBottom = BaseColor.BLACK; }
                                    //else
                                    { tot_enrl.BorderWidthBottom = 0.5f; tot_enrl.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                    table.AddCell(tot_enrl);

                                    PdfPCell tot_30 = new PdfPCell(new Phrase(Entity.Window30, TableFont));
                                    tot_30.HorizontalAlignment = Element.ALIGN_CENTER;
                                    //tot_30.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    tot_30.Border = 0;
                                    tot_30.BorderWidthLeft = 0.5f; tot_30.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                    //if (cnt == RoomSel_List.Count)
                                    //{ tot_30.BorderWidthBottom = 0.5f; tot_30.BorderColorBottom = BaseColor.BLACK; }
                                    //else
                                    { tot_30.BorderWidthBottom = 0.5f; tot_30.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                    table.AddCell(tot_30);

                                    PdfPCell tot_W = new PdfPCell(new Phrase(Entity.Withdrawn, TableFont));
                                    tot_W.HorizontalAlignment = Element.ALIGN_CENTER;
                                    //tot_W.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    tot_W.Border = 0;
                                    tot_W.BorderWidthLeft = 0.5f; tot_W.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                    //if (cnt == RoomSel_List.Count)
                                    //{ tot_W.BorderWidthBottom = 0.5f; tot_W.BorderColorBottom = BaseColor.BLACK; }
                                    //else
                                    { tot_W.BorderWidthBottom = 0.5f; tot_W.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                    table.AddCell(tot_W);

                                    PdfPCell tot_First = new PdfPCell(new Phrase(Entity.FirstTime, TableFont));
                                    tot_First.HorizontalAlignment = Element.ALIGN_CENTER;
                                    //tot_First.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    tot_First.Border = 0;
                                    tot_First.BorderWidthLeft = 0.5f; tot_First.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                    //if (cnt == RoomSel_List.Count)
                                    //{ tot_First.BorderWidthBottom = 0.5f; tot_First.BorderColorBottom = BaseColor.BLACK; }
                                    //else
                                    { tot_First.BorderWidthBottom = 0.5f; tot_First.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                    table.AddCell(tot_First);

                                    PdfPCell tot_attn12 = new PdfPCell(new Phrase(Entity.GetAttn1, TableFont));
                                    tot_attn12.HorizontalAlignment = Element.ALIGN_CENTER;
                                    //tot_attn12.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    tot_attn12.Border = 0;
                                    tot_attn12.BorderWidthLeft = 0.5f; tot_attn12.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                    tot_attn12.BorderWidthRight = 0.5f; tot_attn12.BorderColorRight = BaseColor.BLACK;
                                    //if (cnt == RoomSel_List.Count)
                                    //{ tot_attn12.BorderWidthBottom = 0.5f; tot_attn12.BorderColorBottom = BaseColor.BLACK; }
                                    //else
                                    { tot_attn12.BorderWidthBottom = 0.5f; tot_attn12.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                    table.AddCell(tot_attn12);

                                    totEnrl_cnt = totEnrl_cnt + int.Parse(Entity.Enrolled); totWdraw_cnt = totWdraw_cnt + int.Parse(Entity.Withdrawn); totAttn1_cnt = totAttn1_cnt + int.Parse(Entity.GetAttn1);
                                    totday30_cnt = totday30_cnt + int.Parse(Entity.Window30); totFirstTime_cnt = totFirstTime_cnt + int.Parse(Entity.FirstTime);
                                    if (selsite != null)
                                    {
                                        if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                        {
                                            TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                            FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                        }
                                    }
                                    PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM.Trim();
                                    
                                }
                                First = false; PrivSite = Entity.Site.Trim();
                                cnt++;
                            }

                            PdfPCell nn = new PdfPCell(new Phrase("Total " + PrivSite, TableFont));
                            nn.HorizontalAlignment = Element.ALIGN_LEFT;
                            //nn.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            nn.Border = 0;
                            nn.BorderWidthLeft = 0.5f;nn.BorderColorLeft = BaseColor.BLACK;
                            nn.BorderWidthBottom = 0.5f; nn.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(nn);

                            PdfPCell nn1 = new PdfPCell(new Phrase(TotFunds.ToString(), TableFont));
                            nn1.HorizontalAlignment = Element.ALIGN_CENTER;
                            //nn1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            nn1.Border = 0;
                            nn1.BorderWidthLeft = 0.5f;nn1.BorderColorLeft = BaseColor.LIGHT_GRAY;
                            nn1.BorderWidthBottom = 0.5f; nn1.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(nn1);

                            string totEnroll1 = string.Empty;
                            if (totEnrl_cnt < TotFunds)
                                totEnroll1 = totEnrl_cnt.ToString() + "*";
                           else totEnroll1 = totEnrl_cnt.ToString();

                            //FundedTotal = FundedTotal + TotFunds;

                            PdfPCell nn2 = new PdfPCell(new Phrase(totEnroll1, TableFont));
                            nn2.HorizontalAlignment = Element.ALIGN_CENTER;
                            //nn2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            nn2.Border = 0;
                            nn2.BorderWidthLeft = 0.5f; nn2.BorderColorLeft = BaseColor.LIGHT_GRAY;
                            nn2.BorderWidthBottom = 0.5f; nn2.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(nn2);

                            PdfPCell nn3 = new PdfPCell(new Phrase(totday30_cnt.ToString(), TableFont));
                            nn3.HorizontalAlignment = Element.ALIGN_CENTER;
                            //nn3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            nn3.Border = 0;
                            nn3.BorderWidthLeft = 0.5f; nn3.BorderColorLeft = BaseColor.LIGHT_GRAY;
                            nn3.BorderWidthBottom = 0.5f; nn3.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(nn3);

                            PdfPCell nn4 = new PdfPCell(new Phrase(totWdraw_cnt.ToString(), TableFont));
                            nn4.HorizontalAlignment = Element.ALIGN_CENTER;
                            //nn4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            nn4.Border = 0;
                            nn4.BorderWidthLeft = 0.5f; nn4.BorderColorLeft = BaseColor.LIGHT_GRAY;
                            nn4.BorderWidthBottom = 0.5f; nn4.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(nn4);

                            PdfPCell nn5 = new PdfPCell(new Phrase(totFirstTime_cnt.ToString(), TableFont));
                            nn5.HorizontalAlignment = Element.ALIGN_CENTER;
                            //nn5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            nn5.Border = 0;
                            nn5.BorderWidthLeft = 0.5f; nn5.BorderColorLeft = BaseColor.LIGHT_GRAY;
                            nn5.BorderWidthBottom = 0.5f; nn5.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(nn5);

                            PdfPCell nn6 = new PdfPCell(new Phrase(totAttn1_cnt.ToString(), TableFont));
                            nn6.HorizontalAlignment = Element.ALIGN_CENTER;
                            //nn6.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            nn6.Border = 0;
                            nn6.BorderWidthLeft = 0.5f; nn6.BorderColorLeft = BaseColor.LIGHT_GRAY;
                            nn6.BorderWidthBottom = 0.5f; nn6.BorderColorBottom = BaseColor.BLACK;
                            nn6.BorderWidthRight = 0.5f; nn6.BorderColorRight = BaseColor.LIGHT_GRAY;
                            table.AddCell(nn6);

                            document.Add(table);
                            table.DeleteBodyRows();

                            //document.Add(table);
                            //table.DeleteBodyRows();

                            document.NewPage();
                            string[] HeaderSeq2 = { "Fund", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                            for (int i = 0; i < HeaderSeq.Length; ++i)
                            {
                                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq2[i], TblFontBold));
                                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                //cell.FixedHeight = 15f;
                                cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                table.AddCell(cell);
                            }

                            int Total_Count = 0;
                            PdfPCell Rep = new PdfPCell(new Phrase("Report Totals:", TableFont));
                            Rep.HorizontalAlignment = Element.ALIGN_LEFT;
                            //Rep.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            Rep.Border = 0;
                            Rep.BorderWidthLeft = 0.5f; Rep.BorderColorLeft = BaseColor.BLACK;
                            Rep.BorderWidthBottom = 0.5f; Rep.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(Rep);

                            Total_Count = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));
                            if (Total_Count > 0)
                            {
                                PdfPCell Rep1 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                                Rep1.HorizontalAlignment = Element.ALIGN_CENTER;
                                //Rep1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Rep1.Border = 0;
                                Rep1.BorderWidthLeft = 0.5f; Rep1.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                Rep1.BorderWidthBottom = 0.5f; Rep1.BorderColorBottom = BaseColor.BLACK;
                                table.AddCell(Rep1);
                            }
                            else
                            {
                                PdfPCell Rep1 = new PdfPCell(new Phrase(FundedTotal.ToString(), TableFont));
                                Rep1.HorizontalAlignment = Element.ALIGN_CENTER;
                                //Rep1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Rep1.Border = 0;
                                Rep1.BorderWidthLeft = 0.5f; Rep1.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                Rep1.BorderWidthBottom = 0.5f; Rep1.BorderColorBottom = BaseColor.BLACK;
                                table.AddCell(Rep1);
                            }


                            List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                            var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                            if (Repenrolled_Count.Count > 0) Total_Count = Repenrolled_Count.Count;
                            //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                            PdfPCell Rep2 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep2.HorizontalAlignment = Element.ALIGN_CENTER;
                            //Rep2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            Rep2.Border = 0;
                            Rep2.BorderWidthLeft = 0.5f; Rep2.BorderColorLeft = BaseColor.LIGHT_GRAY;
                            Rep2.BorderWidthBottom = 0.5f; Rep2.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(Rep2);

                            Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                            PdfPCell Rep3 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep3.HorizontalAlignment = Element.ALIGN_CENTER;
                            //Rep3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            Rep3.Border = 0;
                            Rep3.BorderWidthLeft = 0.5f; Rep3.BorderColorLeft = BaseColor.LIGHT_GRAY;
                            Rep3.BorderWidthBottom = 0.5f; Rep3.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(Rep3);

                            Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                            PdfPCell Rep4 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep4.HorizontalAlignment = Element.ALIGN_CENTER;
                            //Rep4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            Rep4.Border = 0;
                            Rep4.BorderWidthLeft = 0.5f; Rep4.BorderColorLeft = BaseColor.LIGHT_GRAY;
                            Rep4.BorderWidthBottom = 0.5f; Rep4.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(Rep4);

                            Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                            PdfPCell Rep5 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep5.HorizontalAlignment = Element.ALIGN_CENTER;
                            //Rep5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            Rep5.Border = 0;
                            Rep5.BorderWidthLeft = 0.5f; Rep5.BorderColorLeft = BaseColor.LIGHT_GRAY;
                            Rep5.BorderWidthBottom = 0.5f; Rep5.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(Rep5);

                            Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                            PdfPCell Rep6 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep6.HorizontalAlignment = Element.ALIGN_CENTER;
                            //Rep6.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            Rep6.Border = 0;
                            Rep6.BorderWidthLeft = 0.5f; Rep6.BorderColorLeft = BaseColor.LIGHT_GRAY;
                            Rep6.BorderWidthRight = 0.5f; Rep6.BorderColorRight = BaseColor.BLACK;
                            Rep6.BorderWidthBottom = 0.5f; Rep6.BorderColorBottom = BaseColor.BLACK;
                            table.AddCell(Rep6);

                            if (propfundingSource.Count > 0)
                            {
                                int Fundcnt = Count_List.Select(t => t.FundHie).Distinct().Count(s => s != "None");
                                int FCnt = 1;
                                foreach (CommonEntity FundEntity in propfundingSource)
                                {
                                    List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                    int EnrlCnt = 0; int Wcnt = 0;
                                    if (Fundlistcount.Count > 0)
                                    {
                                        EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                        Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                        int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                        //if (EnrlCnt > 0 || Wcnt > 0)
                                        //{
                                        PdfPCell Fund = new PdfPCell(new Phrase("      " + FundEntity.Desc, TableFont));
                                        Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                        if (FundCnt == 0)
                                            Fund.Colspan = 2;
                                        //Fund.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Fund.Border = 0;
                                        Fund.BorderWidthLeft = 0.5f; Fund.BorderColorLeft = BaseColor.BLACK;
                                        if (FCnt == Fundcnt)
                                        {
                                            Fund.BorderWidthBottom = 0.5f; Fund.BorderColorBottom = BaseColor.BLACK;
                                        }
                                        else
                                        { Fund.BorderWidthBottom = 0.5f; Fund.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                        table.AddCell(Fund);

                                        if (FundCnt > 0)
                                        {
                                            PdfPCell Fund8 = new PdfPCell(new Phrase(FundCnt.ToString(), TableFont));
                                            Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                            //Fund8.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Fund8.Border = 0;
                                            Fund8.BorderWidthLeft = 0.5f; Fund8.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                            if (FCnt == Fundcnt)
                                            {
                                                Fund8.BorderWidthBottom = 0.5f; Fund8.BorderColorBottom = BaseColor.BLACK;
                                            }
                                            else
                                            { Fund8.BorderWidthBottom = 0.5f; Fund8.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                            table.AddCell(Fund8);
                                        }

                                        PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                        Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //Fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Fund1.Border = 0;
                                        Fund1.BorderWidthLeft = 0.5f; Fund1.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        if (FCnt == Fundcnt)
                                        {
                                            Fund1.BorderWidthBottom = 0.5f; Fund1.BorderColorBottom = BaseColor.BLACK;
                                        }
                                        else
                                        { Fund1.BorderWidthBottom = 0.5f; Fund1.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                        table.AddCell(Fund1);

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                        PdfPCell Fund2 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                        Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //Fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Fund2.Border = 0;
                                        Fund2.BorderWidthLeft = 0.5f; Fund2.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        if (FCnt == Fundcnt)
                                        {
                                            Fund2.BorderWidthBottom = 0.5f; Fund2.BorderColorBottom = BaseColor.BLACK;
                                        }
                                        else
                                        { Fund2.BorderWidthBottom = 0.5f; Fund2.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                        table.AddCell(Fund2);

                                        //Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                        PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                        Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //Fund3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Fund3.Border = 0;
                                        Fund3.BorderWidthLeft = 0.5f; Fund3.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        if (FCnt == Fundcnt)
                                        {
                                            Fund3.BorderWidthBottom = 0.5f; Fund3.BorderColorBottom = BaseColor.BLACK;
                                        }
                                        else
                                        { Fund3.BorderWidthBottom = 0.5f; Fund3.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                        table.AddCell(Fund3);

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                        PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                        Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //Fund4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Fund4.Border = 0;
                                        Fund4.BorderWidthLeft = 0.5f; Fund4.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        if (FCnt == Fundcnt)
                                        {
                                            Fund4.BorderWidthBottom = 0.5f; Fund4.BorderColorBottom = BaseColor.BLACK;
                                        }
                                        else
                                        { Fund4.BorderWidthBottom = 0.5f; Fund4.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                        table.AddCell(Fund4);

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                        PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                        Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //Fund5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Fund5.Border = 0;
                                        Fund5.BorderWidthLeft = 0.5f; Fund5.BorderColorLeft = BaseColor.LIGHT_GRAY;
                                        Fund5.BorderWidthRight = 0.5f; Fund5.BorderColorRight = BaseColor.BLACK;
                                        if (FCnt == Fundcnt)
                                        {
                                            Fund5.BorderWidthBottom = 0.5f; Fund5.BorderColorBottom = BaseColor.BLACK;
                                        }
                                        else
                                        { Fund5.BorderWidthBottom = 0.5f; Fund5.BorderColorBottom = BaseColor.LIGHT_GRAY; }
                                        table.AddCell(Fund5);
                                        FCnt++;
                                        //}
                                    }
                                }
                            }
                            document.Add(table);
                        }
                    }

                    if (rbFundDetailByRoom.Checked == true)
                    {
                            CaseSiteEntity Search_Entity = new CaseSiteEntity(true);
                            Search_Entity.SiteAGENCY = Agency;
                            Search_Entity.SiteDEPT = Depart; Search_Entity.SitePROG = Program;
                            if (CmbYear.Visible == true) Search_Entity.SiteYEAR = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                            propCaseAllSiteEntity = _model.CaseMstData.Browse_CASESITE(Search_Entity, "Browse");
                        

                        if (Count_List.Count > 0)
                        {
                            bool First = true;

                            // Brain asked to commend to this on 04/07/2016
                            //var distFund = Count_List.Select(u => new { u.Site, u.FundHie }).Distinct().ToList();
                            ////var distFund = Count_List.GroupBy(u=>u.Site).Select(u => u.FundHie).Distinct().ToList();

                            //DataTable dtFundCnt = new DataTable();
                            //dtFundCnt.Columns.Add("Site", typeof(string));
                            //dtFundCnt.Columns.Add("Fund", typeof(string));
                            //dtFundCnt.Columns.Add("Count", typeof(int));
                            //foreach (var fund in distFund)
                            //{
                            //    //DataRow dr = new DataRow();
                            //    dtFundCnt.Rows.Add(fund.Site,fund.FundHie, 0);
                            //}


                            string[] HeaderSeq = { "Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "Firsttime Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                            for (int i = 0; i < HeaderSeq.Length; ++i)
                            {
                                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                //cell.FixedHeight = 15f;
                                cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                table.AddCell(cell);
                            }

                            int Enrl_cnt = 0; //int Wdraw_cnt = 0; int day30_cnt = 0; int Attn1_cnt = 0; int FirstTime_cnt = 0;
                            int totEnrl_cnt = 0; int totWdraw_cnt = 0; int totday30_cnt = 0; int totAttn1_cnt = 0; int totFirstTime_cnt = 0; int TotFunds = 0;
                            int FundedTotal = 0;
                            if (rbAll.Checked == true)
                            {
                                foreach (ENRL_Asof_Entity Entity in Count_List)
                                {
                                    if (Entity.Site.Trim() + Entity.Room.Trim() + Entity.AMPM.Trim() != PrivSite + PrivRoom + PrivAmpm)
                                    {
                                        if (!First)
                                        {
                                            if (Entity.Site.Trim() != PrivSite)
                                            {
                                                int Total_Count = 0;

                                                PdfPCell Rep = new PdfPCell(new Phrase("Total " + PrivSite, TableFont));
                                                Rep.HorizontalAlignment = Element.ALIGN_LEFT;
                                                Rep.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Rep);

                                                PdfPCell Rep1 = new PdfPCell(new Phrase(TotFunds.ToString(), TableFont));
                                                Rep1.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Rep1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Rep1);

                                                //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                                                string totEnroll1 = string.Empty;
                                                if (totEnrl_cnt < TotFunds)
                                                    totEnroll1 = totEnrl_cnt.ToString() + "*";
                                                else totEnroll1 = totEnrl_cnt.ToString();

                                                //DataTable dtenrlcnt = new DataTable();
                                                //if (dtEnroll.Rows.Count > 0)
                                                //{
                                                //    DataView dv = new DataView(dtEnroll);
                                                //    dv.RowFilter = "SITE_NUM="+"'"+PrivSite+"'";
                                                //    dtenrlcnt = dv.ToTable();
                                                //}

                                                PdfPCell Rep2 = new PdfPCell(new Phrase(totEnrl_cnt.ToString(), TableFont));
                                                Rep2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Rep2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Rep2);

                                                Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                                PdfPCell Rep3 = new PdfPCell(new Phrase(totday30_cnt.ToString(), TableFont));
                                                Rep3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Rep3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Rep3);

                                                Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                                PdfPCell Rep4 = new PdfPCell(new Phrase(totWdraw_cnt.ToString(), TableFont));
                                                Rep4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Rep4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Rep4);

                                                Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                                PdfPCell Rep5 = new PdfPCell(new Phrase(totFirstTime_cnt.ToString(), TableFont));
                                                Rep5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Rep5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Rep5);

                                                Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                                PdfPCell Rep6 = new PdfPCell(new Phrase(totAttn1_cnt.ToString(), TableFont));
                                                Rep6.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Rep6.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Rep6);

                                                if (propfundingSource.Count > 0)
                                                {
                                                    foreach (CommonEntity FundEntity in propfundingSource)
                                                    {
                                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                                        int EnrlCnt = 0; int Wcnt = 0;
                                                        if (Fundlistcount.Count > 0)
                                                        {
                                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                                            int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                                            //if (EnrlCnt > 0 || Wcnt > 0)
                                                            //{
                                                            PdfPCell Fund = new PdfPCell(new Phrase("       " + FundEntity.Desc, TableFont));
                                                            Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            if (FundCnt == 0)
                                                                Fund.Colspan = 2;
                                                                Fund.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                            table.AddCell(Fund);

                                                            // Brain asked to commend to this on 04/07/2016
                                                            //string SelFundSlots = string.Empty;
                                                            //if (dtFundCnt.Rows.Count > 0)
                                                            //{
                                                            //    foreach (DataRow dr in dtFundCnt.Rows)
                                                            //    {
                                                            //        if (FundEntity.Code.Trim() == dr["Fund"].ToString().Trim() && dr["Site"].ToString() == PrivSite)
                                                            //        {
                                                            //            SelFundSlots = dr["Count"].ToString(); break;
                                                            //        }
                                                            //    }
                                                            //}

                                                            if (FundCnt > 0)
                                                            {
                                                                PdfPCell Fund8 = new PdfPCell(new Phrase(FundCnt.ToString(), TableFont));
                                                                Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                                                //Fund.Colspan = 2;
                                                                Fund8.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                table.AddCell(Fund8);
                                                            }

                                                            PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                                            Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                                            Fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                            table.AddCell(Fund1);

                                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                                            PdfPCell Window30 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                            Window30.HorizontalAlignment = Element.ALIGN_CENTER;
                                                            Window30.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                            table.AddCell(Window30);

                                                            //Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                                            PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                                            Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                            Fund3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                            table.AddCell(Fund3);

                                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                                            PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                            Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                            Fund4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                            table.AddCell(Fund4);

                                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                                            PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                            Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                            Fund5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                            table.AddCell(Fund5);
                                                            //}
                                                        }
                                                    }
                                                }

                                                totEnrl_cnt = 0; totWdraw_cnt = 0; totAttn1_cnt = 0;
                                                totday30_cnt = 0; totFirstTime_cnt = 0; TotFunds = 0;
                                                if (table.Rows.Count > 1)
                                                {
                                                    document.Add(table);
                                                    table.DeleteBodyRows();
                                                    document.NewPage();
                                                }

                                                string[] HeaderSeq3 = { "Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                                                for (int i = 0; i < HeaderSeq.Length; ++i)
                                                {
                                                    PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq3[i], TblFontBold));
                                                    cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                                    //cell.FixedHeight = 15f;
                                                    cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                                    table.AddCell(cell);
                                                }
                                                PdfPCell SiteName1 = new PdfPCell(new Phrase(Entity.Site.Trim(), TableFont));
                                                SiteName1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                SiteName1.Colspan = 7;
                                                SiteName1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(SiteName1);
                                            }
                                        }

                                        if (First)
                                        {
                                            PdfPCell SiteName = new PdfPCell(new Phrase(Entity.Site.Trim(), TableFont));
                                            SiteName.HorizontalAlignment = Element.ALIGN_LEFT;
                                            SiteName.Colspan = 7;
                                            SiteName.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(SiteName);
                                        }

                                        PdfPCell row1 = new PdfPCell(new Phrase("    " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim(), TableFont));
                                        row1.HorizontalAlignment = Element.ALIGN_LEFT;
                                        row1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(row1);

                                        CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));

                                        string Enroll = string.Empty; string EnrlCntY = "0";
                                        string EnrlWd = "0"; string EnrlAttn = "0"; string EnrlW30 = "0"; string EnrlFA = "0";
                                        if (selsite != null)
                                        {
                                            PdfPCell tot_fun = new PdfPCell(new Phrase(selsite.SITE_FUNDED_SLOTS.Trim(), TableFont));
                                            tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_fun.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_fun);

                                            if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                            {
                                                List<ENRL_Asof_Entity> Enrols = Count_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM));
                                                List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                                var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                                if (Enrols.Count > 0)
                                                {
                                                    EnrlCntY = enrolled_Count.Count.ToString();
                                                    //EnrlCntY = Enrols.Sum(u => int.Parse(u.Enrolled.Trim())).ToString();
                                                    EnrlWd = Enrols.Sum(u => int.Parse(u.Withdrawn.Trim())).ToString();
                                                    EnrlAttn = Enrols.Sum(u => int.Parse(u.GetAttn1.Trim())).ToString();
                                                    EnrlW30 = Enrols.Sum(u => int.Parse(u.Window30.Trim())).ToString();
                                                    EnrlFA = Enrols.Sum(u => int.Parse(u.FirstTime.Trim())).ToString();
                                                }


                                                if (int.Parse(EnrlCntY) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                    Enroll = EnrlCntY + "*";
                                                else Enroll = EnrlCntY;
                                                FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                            }
                                            else Enroll = Entity.Enrolled;
                                        }
                                        else
                                        {
                                            PdfPCell tot_fun = new PdfPCell(new Phrase("", TableFont));
                                            tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_fun.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_fun);

                                            Enroll = Entity.Enrolled;
                                        }

                                        //DataTable dtenrlRoomcnt = new DataTable();
                                        //if (dtEnroll.Rows.Count > 0)
                                        //{
                                        //    DataView dv = new DataView(dtEnroll);
                                        //    dv.RowFilter = "SITE_NUM=" + "'" + Entity.Site + "'AND ROOM=" + "'" + Entity.Room + "' AND AMPM=" + "'" + Entity.AMPM + "'";
                                        //    dtenrlRoomcnt = dv.ToTable();
                                        //}

                                        PdfPCell tot_enrl = new PdfPCell(new Phrase(Enroll, TableFont));
                                        tot_enrl.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_enrl.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(tot_enrl);

                                        PdfPCell tot_30 = new PdfPCell(new Phrase(EnrlW30, TableFont));
                                        tot_30.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_30.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(tot_30);

                                        PdfPCell tot_W = new PdfPCell(new Phrase(EnrlWd, TableFont));
                                        tot_W.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_W.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(tot_W);

                                        PdfPCell tot_First = new PdfPCell(new Phrase(EnrlFA, TableFont));
                                        tot_First.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_First.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(tot_First);

                                        PdfPCell tot_attn12 = new PdfPCell(new Phrase(EnrlAttn, TableFont));
                                        tot_attn12.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_attn12.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(tot_attn12);

                                        string FundDesc = string.Empty;
                                        if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                        {
                                            foreach (CommonEntity drFund in propfundingSource)
                                            {
                                                if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                {
                                                    FundDesc = drFund.Desc.ToString().Trim();
                                                    break;
                                                }
                                            }
                                            // Brain asked to commend to this on 04/07/2016
                                            //if (dtFundCnt.Rows.Count > 0)
                                            //{
                                            //    if (selsite != null)
                                            //    {
                                            //        foreach (DataRow dr in dtFundCnt.Rows)
                                            //        {
                                            //            if (Entity.FundHie.Trim() == dr["Fund"].ToString().Trim() && Entity.Site == dr["Site"].ToString()) //
                                            //            {
                                            //                if (dr["Fund"].ToString().Trim() == selsite.SiteFUND1.Trim() || dr["Fund"].ToString().Trim() == selsite.SiteFUND2.Trim() || dr["Fund"].ToString().Trim() == selsite.SiteFUND3.Trim() || dr["Fund"].ToString().Trim() == selsite.SiteFUND4.Trim() || dr["Fund"].ToString().Trim() == selsite.SiteFUND5.Trim())
                                            //                {
                                            //                    if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                            //                    {
                                            //                        dr["Count"] = (Convert.ToInt32(dr["Count"]) + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim())).ToString();
                                            //                        break;
                                            //                    }
                                            //                }
                                            //            }
                                            //        }
                                            //    }
                                            //}
                                        }

                                        PdfPCell row2 = new PdfPCell(new Phrase("       " + FundDesc, TableFont));
                                        row2.HorizontalAlignment = Element.ALIGN_LEFT;
                                        //row2.Colspan = 2;
                                        row2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(row2);

                                        PdfPCell Fund2 = new PdfPCell(new Phrase(Entity.FundSlots.Trim() == "0" ? "" : Entity.FundSlots.Trim(), TableFont));
                                        Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //row2.Colspan = 2;
                                        Fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(Fund2);

                                        PdfPCell tot_enrl1 = new PdfPCell(new Phrase(Entity.Enrolled, TableFont));
                                        tot_enrl1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_enrl1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(tot_enrl1);

                                        PdfPCell tot_301 = new PdfPCell(new Phrase(Entity.Window30, TableFont));
                                        tot_301.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_301.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(tot_301);

                                        PdfPCell tot_W1 = new PdfPCell(new Phrase(Entity.Withdrawn, TableFont));
                                        tot_W1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_W1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(tot_W1);

                                        PdfPCell tot_First1 = new PdfPCell(new Phrase(Entity.FirstTime, TableFont));
                                        tot_First1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_First1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(tot_First1);

                                        PdfPCell tot_attn121 = new PdfPCell(new Phrase(Entity.GetAttn1, TableFont));
                                        tot_attn121.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_attn121.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(tot_attn121);

                                        First = false; PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM;
                                        totEnrl_cnt = totEnrl_cnt + int.Parse(EnrlCntY); totWdraw_cnt = totWdraw_cnt + int.Parse(EnrlWd); totAttn1_cnt = totAttn1_cnt + int.Parse(EnrlAttn);
                                        totday30_cnt = totday30_cnt + int.Parse(EnrlW30); totFirstTime_cnt = totFirstTime_cnt + int.Parse(EnrlFA);
                                        if (selsite != null)
                                        {
                                            if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                        }

                                    }
                                    else
                                    {
                                        string Fund = string.Empty;
                                        if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                        {
                                            foreach (CommonEntity drFund in propfundingSource)
                                            {
                                                if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                {
                                                    Fund = drFund.Desc.ToString().Trim();
                                                    break;
                                                }
                                            }

                                            // Brain asked to commend to this on 04/07/2016
                                            //if (dtFundCnt.Rows.Count > 0)
                                            //{
                                            //    CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));
                                            //    if (selsite != null)
                                            //    {
                                            //        foreach (DataRow dr in dtFundCnt.Rows)
                                            //        {
                                            //            if (Entity.FundHie.Trim() == dr["Fund"].ToString().Trim() && Entity.Site == dr["Site"].ToString()) //
                                            //            {
                                            //                if (dr["Fund"].ToString().Trim() == selsite.SiteFUND1.Trim() || dr["Fund"].ToString().Trim() == selsite.SiteFUND2.Trim() || dr["Fund"].ToString().Trim() == selsite.SiteFUND3.Trim() || dr["Fund"].ToString().Trim() == selsite.SiteFUND4.Trim() || dr["Fund"].ToString().Trim() == selsite.SiteFUND5.Trim())
                                            //                {
                                            //                    if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                            //                    {
                                            //                        dr["Count"] = (Convert.ToInt32(dr["Count"]) + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim())).ToString();
                                            //                        break;
                                            //                    }
                                            //                }
                                            //            }
                                            //        }
                                            //    }
                                            //}
                                        }

                                        PdfPCell row2 = new PdfPCell(new Phrase("       " + Fund, TableFont));
                                        row2.HorizontalAlignment = Element.ALIGN_LEFT;
                                        //row2.Colspan = 2;
                                        row2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(row2);

                                        PdfPCell Fund2 = new PdfPCell(new Phrase(Entity.FundSlots.Trim() == "0" ? "" : Entity.FundSlots.Trim(), TableFont));
                                        Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //row2.Colspan = 2;
                                        Fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(Fund2);

                                        PdfPCell tot_enrl1 = new PdfPCell(new Phrase(Entity.Enrolled, TableFont));
                                        tot_enrl1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_enrl1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(tot_enrl1);

                                        PdfPCell tot_301 = new PdfPCell(new Phrase(Entity.Window30, TableFont));
                                        tot_301.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_301.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(tot_301);

                                        PdfPCell tot_W1 = new PdfPCell(new Phrase(Entity.Withdrawn, TableFont));
                                        tot_W1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_W1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(tot_W1);

                                        PdfPCell tot_First1 = new PdfPCell(new Phrase(Entity.FirstTime, TableFont));
                                        tot_First1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_First1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(tot_First1);

                                        PdfPCell tot_attn121 = new PdfPCell(new Phrase(Entity.GetAttn1, TableFont));
                                        tot_attn121.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_attn121.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        table.AddCell(tot_attn121);
                                        PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM;
                                    }

                                }

                                document.Add(table);
                                table.DeleteBodyRows();

                                PdfPCell Rep111 = new PdfPCell(new Phrase("Total " + PrivSite, TableFont));
                                Rep111.HorizontalAlignment = Element.ALIGN_LEFT;
                                Rep111.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Rep111);

                                PdfPCell Rep11 = new PdfPCell(new Phrase(TotFunds.ToString(), TableFont));
                                Rep11.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep11.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Rep11);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                                string totEnroll = string.Empty;
                                if (totEnrl_cnt < TotFunds)
                                    totEnroll = totEnrl_cnt.ToString() + "*";
                                else totEnroll = totEnrl_cnt.ToString();

                                PdfPCell Rep21 = new PdfPCell(new Phrase(totEnroll.ToString(), TableFont));
                                Rep21.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep21.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Rep21);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                PdfPCell Rep31 = new PdfPCell(new Phrase(totday30_cnt.ToString(), TableFont));
                                Rep31.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep31.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Rep31);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                PdfPCell Rep41 = new PdfPCell(new Phrase(totWdraw_cnt.ToString(), TableFont));
                                Rep41.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep41.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Rep41);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                PdfPCell Rep51 = new PdfPCell(new Phrase(totFirstTime_cnt.ToString(), TableFont));
                                Rep51.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep51.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Rep51);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                PdfPCell Rep61 = new PdfPCell(new Phrase(totAttn1_cnt.ToString(), TableFont));
                                Rep61.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep61.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Rep61);

                                if (SelFundingList.Count > 0)
                                {
                                    foreach (CommonEntity FundEntity in SelFundingList)
                                    {
                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                        int EnrlCnt = 0; int Wcnt = 0;
                                        if (Fundlistcount.Count > 0)
                                        {
                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                            int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                            //if (EnrlCnt > 0 || Wcnt > 0)
                                            //{
                                            PdfPCell Fund = new PdfPCell(new Phrase("       " + FundEntity.Desc, TableFont));
                                            Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                            if(FundCnt==0)
                                                Fund.Colspan = 2;
                                            Fund.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(Fund);

                                            // Brain asked to commend to this on 04/07/2016
                                            //string SelFundSlots=string.Empty;
                                            //if (dtFundCnt.Rows.Count > 0)
                                            //{
                                            //    foreach (DataRow dr in dtFundCnt.Rows)
                                            //    {
                                            //        if (FundEntity.Code.Trim() == dr["Fund"].ToString().Trim() && dr["Site"].ToString() == PrivSite)
                                            //        {
                                            //            SelFundSlots = dr["Count"].ToString(); break;
                                            //        }
                                            //    }
                                            //}

                                            if (FundCnt > 0)
                                            {
                                                PdfPCell Fund8 = new PdfPCell(new Phrase(FundCnt.ToString(), TableFont));
                                                Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                                //Fund.Colspan = 2;
                                                Fund8.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund8);
                                            }

                                            PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                            Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(Fund1);

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                            PdfPCell Fund2 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                            Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(Fund2);

                                            //Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                            PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                            Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(Fund3);

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                            PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                            Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(Fund4);

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                            PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                            Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(Fund5);
                                            //}
                                        }
                                    }
                                }

                                document.Add(table);
                                table.DeleteBodyRows();

                                document.NewPage();
                                string[] HeaderSeq2 = { "Fund", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                                for (int i = 0; i < HeaderSeq.Length; ++i)
                                {
                                    PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq2[i], TblFontBold));
                                    cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                    //cell.FixedHeight = 15f;
                                    cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                    table.AddCell(cell);
                                }

                                int Total_Count1 = 0;
                                PdfPCell Temp = new PdfPCell(new Phrase("Report Totals:", TableFont));
                                Temp.HorizontalAlignment = Element.ALIGN_LEFT;
                                Temp.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Temp);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));
                                if (Total_Count1 > 0)
                                {
                                    PdfPCell Temp1 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                    Temp1.HorizontalAlignment = Element.ALIGN_CENTER;
                                    Temp1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    table.AddCell(Temp1);
                                }
                                else
                                {
                                    PdfPCell Temp1 = new PdfPCell(new Phrase(FundedTotal.ToString(), TableFont));
                                    Temp1.HorizontalAlignment = Element.ALIGN_CENTER;
                                    Temp1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    table.AddCell(Temp1);
                                }


                                List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                                var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                                if (Repenrolled_Count.Count > 0) Total_Count1 = Repenrolled_Count.Count;
                                //Total_Count1 = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                                PdfPCell Temp2 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp2.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Temp2);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                PdfPCell Temp3 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp3.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Temp3);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                PdfPCell Temp4 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp4.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Temp4);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                PdfPCell Temp5 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp5.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Temp5);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                PdfPCell Temp6 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp6.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp6.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Temp6);

                                if (propfundingSource.Count > 0)
                                {
                                    foreach (CommonEntity FundEntity in propfundingSource)
                                    {
                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));

                                        // Brain asked to commend to this on 04/07/2016
                                        //DataTable dtSum = new DataTable();
                                        //if (dtFundCnt.Rows.Count > 0)
                                        //{
                                        //    DataView dv = new DataView(dtFundCnt);
                                        //    dv.RowFilter = "Fund=" + "'"+FundEntity.Code.Trim()+"'";
                                        //    dtSum = dv.ToTable();
                                        //}
                                        
                                        
                                        int EnrlCnt = 0; int Wcnt = 0;
                                        if (Fundlistcount.Count > 0)
                                        {
                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                            int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                            //if (EnrlCnt > 0 || Wcnt > 0)
                                            //{
                                            PdfPCell Fund = new PdfPCell(new Phrase("       " + FundEntity.Desc, TableFont));
                                                Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                            if(FundCnt==0)
                                                Fund.Colspan = 2;
                                                Fund.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund);

                                            // Brain asked to commend to this on 04/07/2016
                                            //if (dtSum.Rows.Count > 0)
                                            //{
                                            //    object sumObject;
                                            //    sumObject = dtSum.Compute("Sum(Count)", "");
                                            //    PdfPCell Fund8 = new PdfPCell(new Phrase(sumObject.ToString(), TableFont));
                                            //    Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                            //    //Fund.Colspan = 2;
                                            //    Fund8.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            //    table.AddCell(Fund8);
                                            //}
                                            //else
                                            //{
                                            if (FundCnt > 0)
                                            {
                                                PdfPCell Fund8 = new PdfPCell(new Phrase(FundCnt.ToString(), TableFont));
                                                Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                                //Fund.Colspan = 2;
                                                Fund8.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund8);
                                            }
                                            //}

                                            PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                                Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund1);

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                                PdfPCell Fund2 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund2);

                                                //Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                                PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                                Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Fund3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund3);

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                                PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Fund4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund4);

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                                PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Fund5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund5);
                                            //}
                                        }
                                    }
                                }
                                document.Add(table);
                            }
                            else if(rbSelected.Checked==true)
                            {
                                foreach (ENRL_Asof_Entity Entity in Count_List)
                                {
                                  CommonEntity FundCode =SelFundingList.Find(u=>u.Code.Trim().Equals(Entity.FundHie.Trim()));
                                  if (FundCode != null)
                                  {
                                        if (Entity.Site.Trim() + Entity.Room.Trim() + Entity.AMPM.Trim() != PrivSite + PrivRoom + PrivAmpm)
                                        {
                                            if (!First)
                                            {
                                                if (Entity.Site.Trim() != PrivSite)
                                                {
                                                    //int Total_Count = 0;

                                                    PdfPCell Rep = new PdfPCell(new Phrase("Total " + PrivSite, TableFont));
                                                    Rep.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Rep.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    table.AddCell(Rep);

                                                    PdfPCell Rep1 = new PdfPCell(new Phrase(TotFunds.ToString(), TableFont));
                                                    Rep1.HorizontalAlignment = Element.ALIGN_CENTER;
                                                    Rep1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    table.AddCell(Rep1);

                                                    //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                                                    string totEnroll1 = string.Empty;
                                                    if (totEnrl_cnt < TotFunds)
                                                        totEnroll1 = totEnrl_cnt.ToString() + "*";
                                                    else totEnroll1 = totEnrl_cnt.ToString();

                                                    PdfPCell Rep2 = new PdfPCell(new Phrase(totEnroll1.ToString(), TableFont));
                                                    Rep2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                    Rep2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    table.AddCell(Rep2);

                                                    //Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                                    PdfPCell Rep3 = new PdfPCell(new Phrase(totday30_cnt.ToString(), TableFont));
                                                    Rep3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                    Rep3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    table.AddCell(Rep3);

                                                    //Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                                    PdfPCell Rep4 = new PdfPCell(new Phrase(totWdraw_cnt.ToString(), TableFont));
                                                    Rep4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                    Rep4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    table.AddCell(Rep4);

                                                    //Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                                    PdfPCell Rep5 = new PdfPCell(new Phrase(totFirstTime_cnt.ToString(), TableFont));
                                                    Rep5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                    Rep5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    table.AddCell(Rep5);

                                                    //Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                                    PdfPCell Rep6 = new PdfPCell(new Phrase(totAttn1_cnt.ToString(), TableFont));
                                                    Rep6.HorizontalAlignment = Element.ALIGN_CENTER;
                                                    Rep6.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    table.AddCell(Rep6);

                                                    if (SelFundingList.Count > 0)
                                                    {
                                                        foreach (CommonEntity FundEntity in SelFundingList)
                                                        {
                                                            List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                                            int EnrlCnt = 0; int Wcnt = 0;
                                                            if (Fundlistcount.Count > 0)
                                                            {
                                                                EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                                                Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                                                int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));

                                                                //if (EnrlCnt > 0 || Wcnt > 0)
                                                                //{
                                                                PdfPCell Fund = new PdfPCell(new Phrase("       " + FundEntity.Desc, TableFont));
                                                                Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                if(FundCnt==0)
                                                                    Fund.Colspan = 2;
                                                                Fund.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                table.AddCell(Fund);

                                                                // Brain asked to commend to this on 04/07/2016
                                                                //string SelFundSlots = string.Empty;
                                                                //if (dtFundCnt.Rows.Count > 0)
                                                                //{
                                                                //    foreach (DataRow dr in dtFundCnt.Rows)
                                                                //    {
                                                                //        if (FundEntity.Code.Trim() == dr["Fund"].ToString().Trim() && dr["Site"].ToString() == PrivSite)
                                                                //        {
                                                                //            SelFundSlots = dr["Count"].ToString(); break;
                                                                //        }
                                                                //    }
                                                                //}
                                                                if (FundCnt > 0)
                                                                {
                                                                    PdfPCell Fund8 = new PdfPCell(new Phrase(FundCnt.ToString(), TableFont));
                                                                    Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                                                    //Fund.Colspan = 2;
                                                                    Fund8.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                    table.AddCell(Fund8);
                                                                }

                                                                PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                                                Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                                                Fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                table.AddCell(Fund1);

                                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                                                PdfPCell Window30 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                                Window30.HorizontalAlignment = Element.ALIGN_CENTER;
                                                                Window30.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                table.AddCell(Window30);

                                                                //Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                                                PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                                                Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                                Fund3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                table.AddCell(Fund3);

                                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                                                PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                                Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                                Fund4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                table.AddCell(Fund4);

                                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                                                PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                                Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                                Fund5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                table.AddCell(Fund5);
                                                                //}
                                                            }
                                                        }
                                                    }

                                                    totEnrl_cnt = 0; totWdraw_cnt = 0; totAttn1_cnt = 0;
                                                    totday30_cnt = 0; totFirstTime_cnt = 0; TotFunds = 0;
                                                    if (table.Rows.Count > 1)
                                                    {
                                                        document.Add(table);
                                                        table.DeleteBodyRows();
                                                        document.NewPage();
                                                    }

                                                    string[] HeaderSeq3 = { "Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                                                    for (int i = 0; i < HeaderSeq.Length; ++i)
                                                    {
                                                        PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq3[i], TblFontBold));
                                                        cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                                        //cell.FixedHeight = 15f;
                                                        cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                                        table.AddCell(cell);
                                                    }
                                                    PdfPCell SiteName1 = new PdfPCell(new Phrase(Entity.Site.Trim(), TableFont));
                                                    SiteName1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    SiteName1.Colspan = 7;
                                                    SiteName1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    table.AddCell(SiteName1);
                                                }
                                            }

                                            if (First)
                                            {
                                                PdfPCell SiteName = new PdfPCell(new Phrase(Entity.Site.Trim(), TableFont));
                                                SiteName.HorizontalAlignment = Element.ALIGN_LEFT;
                                                SiteName.Colspan = 7;
                                                SiteName.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(SiteName);
                                            }

                                            PdfPCell row1 = new PdfPCell(new Phrase("    " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim(), TableFont));
                                            row1.HorizontalAlignment = Element.ALIGN_LEFT;
                                            row1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(row1);

                                            CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));
                                            string Enroll = string.Empty; string EnrlCntY = "0";
                                            string EnrlWd = "0"; string EnrlAttn = "0"; string EnrlW30 = "0"; string EnrlFA = "0";
                                            if (selsite != null)
                                            {
                                                PdfPCell tot_fun = new PdfPCell(new Phrase(selsite.SITE_FUNDED_SLOTS.Trim(), TableFont));
                                                tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                                tot_fun.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(tot_fun);

                                                if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                {

                                                    List<ENRL_Asof_Entity> Enrols = Count_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM));
                                                    List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                                    var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                                    if (Enrols.Count > 0)
                                                    {
                                                        EnrlCntY = enrolled_Count.Count.ToString();
                                                        //EnrlCntY = Enrols.Sum(u => int.Parse(u.Enrolled.Trim())).ToString();
                                                        EnrlWd = Enrols.Sum(u => int.Parse(u.Withdrawn.Trim())).ToString();
                                                        EnrlAttn = Enrols.Sum(u => int.Parse(u.GetAttn1.Trim())).ToString();
                                                        EnrlW30 = Enrols.Sum(u => int.Parse(u.Window30.Trim())).ToString();
                                                        EnrlFA = Enrols.Sum(u => int.Parse(u.FirstTime.Trim())).ToString();
                                                    }


                                                    if (int.Parse(EnrlCntY) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                        Enroll = EnrlCntY + "*";
                                                    else Enroll = EnrlCntY;
                                                    FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                                }
                                                else Enroll = Entity.Enrolled;


                                            }
                                            else
                                            {
                                                PdfPCell tot_fun = new PdfPCell(new Phrase("", TableFont));
                                                tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                                tot_fun.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(tot_fun);

                                                Enroll = Entity.Enrolled;
                                            }
                                            PdfPCell tot_enrl = new PdfPCell(new Phrase(Enroll, TableFont));
                                            tot_enrl.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_enrl.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_enrl);

                                            PdfPCell tot_30 = new PdfPCell(new Phrase(EnrlW30, TableFont));
                                            tot_30.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_30.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_30);

                                            PdfPCell tot_W = new PdfPCell(new Phrase(EnrlWd, TableFont));
                                            tot_W.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_W.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_W);

                                            PdfPCell tot_First = new PdfPCell(new Phrase(EnrlFA, TableFont));
                                            tot_First.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_First.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_First);

                                            PdfPCell tot_attn12 = new PdfPCell(new Phrase(EnrlAttn, TableFont));
                                            tot_attn12.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_attn12.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_attn12);

                                            string FundDesc = string.Empty;
                                            if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                            {
                                                foreach (CommonEntity drFund in propfundingSource)
                                                {
                                                    if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                    {
                                                        FundDesc = drFund.Desc.ToString().Trim();
                                                        break;
                                                    }
                                                }

                                                // Brain asked to commend to this on 04/07/2016
                                                //if (dtFundCnt.Rows.Count > 0)
                                                //{
                                                //    if (selsite != null)
                                                //    {
                                                //        foreach (DataRow dr in dtFundCnt.Rows)
                                                //        {
                                                //            if (Entity.FundHie.Trim() == dr["Fund"].ToString().Trim() && Entity.Site == dr["Site"].ToString()) //
                                                //            {
                                                //                if (dr["Fund"].ToString().Trim() == selsite.SiteFUND1.Trim() || dr["Fund"].ToString().Trim() == selsite.SiteFUND2.Trim() || dr["Fund"].ToString().Trim() == selsite.SiteFUND3.Trim() || dr["Fund"].ToString().Trim() == selsite.SiteFUND4.Trim() || dr["Fund"].ToString().Trim() == selsite.SiteFUND5.Trim())
                                                //                {
                                                //                    if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                //                    {
                                                //                        dr["Count"] = (Convert.ToInt32(dr["Count"]) + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim())).ToString();
                                                //                        break;
                                                //                    }
                                                //                }
                                                //            }
                                                //        }
                                                //    }
                                                //}
                                            }

                                            PdfPCell row2 = new PdfPCell(new Phrase("       " + FundDesc, TableFont));
                                            row2.HorizontalAlignment = Element.ALIGN_LEFT;
                                            //row2.Colspan = 2;
                                            row2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(row2);

                                            PdfPCell Fund2 = new PdfPCell(new Phrase(Entity.FundSlots.Trim()=="0" ? "" : Entity.FundSlots, TableFont));
                                            Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                            //row2.Colspan = 2;
                                            Fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(Fund2);

                                            PdfPCell tot_enrl1 = new PdfPCell(new Phrase(Entity.Enrolled, TableFont));
                                            tot_enrl1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_enrl1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_enrl1);

                                            PdfPCell tot_301 = new PdfPCell(new Phrase(Entity.Window30, TableFont));
                                            tot_301.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_301.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_301);

                                            PdfPCell tot_W1 = new PdfPCell(new Phrase(Entity.Withdrawn, TableFont));
                                            tot_W1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_W1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_W1);

                                            PdfPCell tot_First1 = new PdfPCell(new Phrase(Entity.FirstTime, TableFont));
                                            tot_First1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_First1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_First1);

                                            PdfPCell tot_attn121 = new PdfPCell(new Phrase(Entity.GetAttn1, TableFont));
                                            tot_attn121.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_attn121.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_attn121);

                                            First = false; PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM;
                                            totEnrl_cnt = totEnrl_cnt + int.Parse(EnrlCntY); totWdraw_cnt = totWdraw_cnt + int.Parse(EnrlWd); totAttn1_cnt = totAttn1_cnt + int.Parse(EnrlAttn);
                                            totday30_cnt = totday30_cnt + int.Parse(EnrlW30); totFirstTime_cnt = totFirstTime_cnt + int.Parse(EnrlFA);
                                            if (selsite != null)
                                            {
                                                if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                    TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                            }

                                        }
                                        else
                                        {
                                            string Fund = string.Empty;
                                            if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                            {
                                                foreach (CommonEntity drFund in propfundingSource)
                                                {
                                                    if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                    {
                                                        Fund = drFund.Desc.ToString().Trim();
                                                        break;
                                                    }
                                                }

                                                // Brain asked to commend to this on 04/07/2016
                                                //if (dtFundCnt.Rows.Count > 0)
                                                //{
                                                //    CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));
                                                //    if (selsite != null)
                                                //    {
                                                //        foreach (DataRow dr in dtFundCnt.Rows)
                                                //        {
                                                //            if (Entity.FundHie.Trim() == dr["Fund"].ToString().Trim() && Entity.Site == dr["Site"].ToString()) //
                                                //            {
                                                //                if (dr["Fund"].ToString().Trim() == selsite.SiteFUND1.Trim() || dr["Fund"].ToString().Trim() == selsite.SiteFUND2.Trim() || dr["Fund"].ToString().Trim() == selsite.SiteFUND3.Trim() || dr["Fund"].ToString().Trim() == selsite.SiteFUND4.Trim() || dr["Fund"].ToString().Trim() == selsite.SiteFUND5.Trim())
                                                //                {
                                                //                    if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                //                    {
                                                //                        dr["Count"] = (Convert.ToInt32(dr["Count"]) + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim())).ToString();
                                                //                        break;
                                                //                    }
                                                //                }
                                                //            }
                                                //        }
                                                //    }
                                                //}

                                            }

                                            PdfPCell row2 = new PdfPCell(new Phrase("       " + Fund, TableFont));
                                            row2.HorizontalAlignment = Element.ALIGN_LEFT;
                                            //row2.Colspan = 2;
                                            row2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(row2);

                                            PdfPCell Fund2 = new PdfPCell(new Phrase(Entity.FundSlots.Trim() == "0" ? "" : Entity.FundSlots, TableFont));
                                            Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                            //row2.Colspan = 2;
                                            Fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(Fund2);

                                            PdfPCell tot_enrl1 = new PdfPCell(new Phrase(Entity.Enrolled, TableFont));
                                            tot_enrl1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_enrl1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_enrl1);

                                            PdfPCell tot_301 = new PdfPCell(new Phrase(Entity.Window30, TableFont));
                                            tot_301.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_301.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_301);

                                            PdfPCell tot_W1 = new PdfPCell(new Phrase(Entity.Withdrawn, TableFont));
                                            tot_W1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_W1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_W1);

                                            PdfPCell tot_First1 = new PdfPCell(new Phrase(Entity.FirstTime, TableFont));
                                            tot_First1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_First1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_First1);

                                            PdfPCell tot_attn121 = new PdfPCell(new Phrase(Entity.GetAttn1, TableFont));
                                            tot_attn121.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_attn121.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            table.AddCell(tot_attn121);
                                            PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM;
                                        }
                                  }
                                }

                                document.Add(table);
                                table.DeleteBodyRows();

                                PdfPCell Rep111 = new PdfPCell(new Phrase("Total " + PrivSite, TableFont));
                                Rep111.HorizontalAlignment = Element.ALIGN_LEFT;
                                Rep111.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Rep111);

                                PdfPCell Rep11 = new PdfPCell(new Phrase(TotFunds.ToString(), TableFont));
                                Rep11.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep11.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Rep11);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                                string totEnroll = string.Empty;
                                if (totEnrl_cnt < TotFunds)
                                    totEnroll = totEnrl_cnt.ToString() + "*";
                                else totEnroll = totEnrl_cnt.ToString();

                                PdfPCell Rep21 = new PdfPCell(new Phrase(totEnroll.ToString(), TableFont));
                                Rep21.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep21.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Rep21);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                PdfPCell Rep31 = new PdfPCell(new Phrase(totday30_cnt.ToString(), TableFont));
                                Rep31.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep31.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Rep31);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                PdfPCell Rep41 = new PdfPCell(new Phrase(totWdraw_cnt.ToString(), TableFont));
                                Rep41.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep41.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Rep41);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                PdfPCell Rep51 = new PdfPCell(new Phrase(totFirstTime_cnt.ToString(), TableFont));
                                Rep51.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep51.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Rep51);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                PdfPCell Rep61 = new PdfPCell(new Phrase(totAttn1_cnt.ToString(), TableFont));
                                Rep61.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep61.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Rep61);

                                if (SelFundingList.Count > 0)
                                {
                                    foreach (CommonEntity FundEntity in SelFundingList)
                                    {
                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                        int EnrlCnt = 0; int Wcnt = 0;
                                        if (Fundlistcount.Count > 0)
                                        {
                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                            int Fundcnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                            //if (EnrlCnt > 0 || Wcnt > 0)
                                            //{
                                            PdfPCell Fund = new PdfPCell(new Phrase("       " + FundEntity.Desc, TableFont));
                                                Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                            if (Fundcnt == 0)
                                                Fund.Colspan = 2;
                                                Fund.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund);

                                            //string SelFundSlots = string.Empty;
                                            //if (dtFundCnt.Rows.Count > 0)
                                            //{
                                            //    foreach (DataRow dr in dtFundCnt.Rows)
                                            //    {
                                            //        if (FundEntity.Code.Trim() == dr["Fund"].ToString().Trim() && dr["Site"].ToString() == PrivSite)
                                            //        {
                                            //            SelFundSlots = dr["Count"].ToString(); break;
                                            //        }
                                            //    }
                                            //}
                                            if (Fundcnt > 0)
                                            {
                                                PdfPCell Fund8 = new PdfPCell(new Phrase(Fundcnt.ToString(), TableFont));
                                                Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                                //Fund.Colspan = 2;
                                                Fund8.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund8);
                                            }


                                            PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                                Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund1);

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                                PdfPCell Fund2 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund2);

                                                //Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                                PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                                Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Fund3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund3);

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                                PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Fund4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund4);

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                                PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Fund5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund5);
                                            //}
                                        }
                                    }
                                }

                                document.Add(table);
                                table.DeleteBodyRows();

                                document.NewPage();
                                string[] HeaderSeq2 = { "Fund", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                                for (int i = 0; i < HeaderSeq.Length; ++i)
                                {
                                    PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq2[i], TblFontBold));
                                    cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                    //cell.FixedHeight = 15f;
                                    cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                    table.AddCell(cell);
                                }

                                int Total_Count1 = 0;
                                PdfPCell Temp7 = new PdfPCell(new Phrase("Report Totals:", TableFont));
                                Temp7.HorizontalAlignment = Element.ALIGN_LEFT;
                                Temp7.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Temp7);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));
                                if (Total_Count1 > 0)
                                {
                                    PdfPCell Temp8 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                    Temp8.HorizontalAlignment = Element.ALIGN_CENTER;
                                    Temp8.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    table.AddCell(Temp8);
                                }
                                else
                                {
                                    PdfPCell Temp8 = new PdfPCell(new Phrase(FundedTotal.ToString(), TableFont));
                                    Temp8.HorizontalAlignment = Element.ALIGN_CENTER;
                                    Temp8.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    table.AddCell(Temp8);
                                }


                                List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                                var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                                if (Repenrolled_Count.Count > 0) Total_Count1 = Repenrolled_Count.Count;
                                //Total_Count1 = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                                PdfPCell Temp9 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp9.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp9.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Temp9);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                PdfPCell Temp10 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp10.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp10.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Temp10);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                PdfPCell Temp11 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp11.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp11.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Temp11);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                PdfPCell Temp12 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp12.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp12.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Temp12);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                PdfPCell Temp13 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp13.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp13.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                table.AddCell(Temp13);

                                if (SelFundingList.Count > 0)
                                {
                                    foreach (CommonEntity FundEntity in SelFundingList)
                                    {
                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));

                                        //Brain asked to comment this on 04/07/2016
                                        //DataTable dtSum = new DataTable();
                                        //if (dtFundCnt.Rows.Count > 0)
                                        //{
                                        //    DataView dv = new DataView(dtFundCnt);
                                        //    dv.RowFilter = "Fund=" + "'" + FundEntity.Code.Trim() + "'";
                                        //    dtSum = dv.ToTable();
                                        //}


                                        int EnrlCnt = 0; int Wcnt = 0;
                                        if (Fundlistcount.Count > 0)
                                        {
                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                            int Fundcnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                            //if (EnrlCnt > 0 || Wcnt > 0)
                                            //{
                                            PdfPCell Fund = new PdfPCell(new Phrase("       " + FundEntity.Desc, TableFont));
                                                Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                            if (Fundcnt == 0)
                                                Fund.Colspan = 2;
                                                Fund.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund);

                                            // Brain asked to commend to this on 04/07/2016
                                            //if (dtSum.Rows.Count > 0)
                                            //{
                                            //    object sumObject;
                                            //    sumObject = dtSum.Compute("Sum(Count)", "");
                                            //    PdfPCell Fund8 = new PdfPCell(new Phrase(sumObject.ToString(), TableFont));
                                            //    Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                            //    //Fund.Colspan = 2;
                                            //    Fund8.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            //    table.AddCell(Fund8);
                                            //}
                                            //else
                                            //{
                                            if (Fundcnt > 0)
                                            {
                                                PdfPCell Fund8 = new PdfPCell(new Phrase(Fundcnt.ToString(), TableFont));
                                                Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                                //Fund.Colspan = 2;
                                                Fund8.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund8);
                                            }
                                            //}

                                            PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                                Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund1);

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                                PdfPCell Fund2 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund2);

                                                //Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                                PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                                Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Fund3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund3);

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                                PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Fund4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund4);

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                                PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Fund5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                table.AddCell(Fund5);
                                            //}
                                        }
                                    }
                                }
                                document.Add(table);
                            }
                        }
                    }
                }
               
                catch (Exception ex)
                {
                    document.Add(new Paragraph("Aborted due to Exception............................................... "));
                }

                document.Close();
                fs.Close();
                fs.Dispose();
                AlertBox.Show("Report Generated Successfully");

                if (ENRL_Asof_List.Count > 0)
                    On_DetailFormClosed(NamePdf);

            }
        }


        private void On_SaveFormClosed(object sender, FormClosedEventArgs e)
        {
            PdfListForm form = sender as PdfListForm;
            if (form.DialogResult == DialogResult.OK)
            {
                StringBuilder strMstApplUpdate = new StringBuilder();
                string PdfName = "Pdf File";
                PdfName = form.GetFileName();
                string NamePdf = PdfName;
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                try
                {
                    if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                    { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
                }
                catch (Exception ex)
                {
                    AlertBox.Show("Error", MessageBoxIcon.Error);
                    ex.ToString();
                }


                try
                {
                    string Tmpstr = PdfName + ".pdf";
                    if (File.Exists(Tmpstr))
                        File.Delete(Tmpstr);
                }
                catch (Exception ex)
                {
                    int length = 8;
                    string newFileName = System.Guid.NewGuid().ToString();
                    newFileName = newFileName.Replace("-", string.Empty);

                    Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
                }


                if (!string.IsNullOrEmpty(Random_Filename))
                    PdfName = Random_Filename;
                else
                    PdfName += ".pdf";

                FileStream fs = new FileStream(PdfName, FileMode.Create);

                Document document = new Document(PageSize.A4, 30f, 30f, 30f, 50f);
                PdfWriter writer = PdfWriter.GetInstance(document, fs);
                document.Open();
                #region Font styles
                BaseFont bfTimes = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
                //BaseFont bfTimes = BaseFont.CreateFont(BaseFont.TIMES_ROMAN, BaseFont.CP1250, false);
                BaseFont bf_Times = BaseFont.CreateFont("c:/windows/fonts/TIMESBD.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
                iTextSharp.text.Font fc = new iTextSharp.text.Font(bfTimes, 10, 2);
                iTextSharp.text.Font fc1 = new iTextSharp.text.Font(bf_Times, 10, 2, BaseColor.BLUE);
                iTextSharp.text.Font fcGray = new iTextSharp.text.Font(bf_Times, 10, 2, BaseColor.DARK_GRAY);

                //iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 8, 3);
                iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(bf_Times, 10);

                BaseFont bf_calibri = BaseFont.CreateFont("c:/windows/fonts/Calibri.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
                iTextSharp.text.Font HeaderTextfnt = new iTextSharp.text.Font(bf_calibri, 12, 2, BaseColor.WHITE);
                iTextSharp.text.Font SubHeadTextfnt = new iTextSharp.text.Font(bf_calibri, 10, 2, new BaseColor(26, 71, 119));
                iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_calibri, 8);
                iTextSharp.text.Font TableFonterr = new iTextSharp.text.Font(bf_calibri, 8, 0, BaseColor.RED);
                iTextSharp.text.Font TableFontWhite = new iTextSharp.text.Font(bf_calibri, 8, 2, BaseColor.WHITE);
                iTextSharp.text.Font BoldFont = new iTextSharp.text.Font(bf_calibri, 8, 1);
                iTextSharp.text.Font BoldUnderlineFont = new iTextSharp.text.Font(bf_calibri, 8, 3);
                iTextSharp.text.Font TableFontPrgNotes = new iTextSharp.text.Font(bf_calibri, 8, 0, new BaseColor(111, 48, 160));
                iTextSharp.text.Font TableFontPrgNotesBold = new iTextSharp.text.Font(bf_calibri, 8, 1, new BaseColor(111, 48, 160));
                iTextSharp.text.Font TableFontPrgNotesBoldUndline = new iTextSharp.text.Font(bf_calibri, 8, 5, new BaseColor(111, 48, 160));
                iTextSharp.text.Font fcRed = new iTextSharp.text.Font(bf_calibri, 10, 1, new BaseColor(System.Drawing.ColorTranslator.FromHtml("#806000")));
                iTextSharp.text.Font FTblFontBold = new iTextSharp.text.Font(bfTimes, 7, 1);
                iTextSharp.text.Font FTableFont = new iTextSharp.text.Font(bf_calibri, 8);
                #endregion


                #region Cell Color Define
                BaseColor DarkBlue = new BaseColor(26, 71, 119);
                BaseColor SecondBlue = new BaseColor(184, 217, 255);
                BaseColor TblHeaderBlue = new BaseColor(155, 194, 230);
                #endregion


                cb = writer.DirectContent;

                try
                {
                    PrintHeaderPage(document, writer);
                    document.NewPage();

                    string Year = "    ";
                    if (CmbYear.Visible == true) Year = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                    string SiteNum = string.Empty;
                    if (((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Value.ToString().Trim() != "0") SiteNum = ((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Value.ToString().Trim();

                    string strFundingCodes = string.Empty;
                    if (rbSelected.Checked == true)
                    {
                        foreach (CommonEntity FundingCode in SelFundingList)
                        {
                            if (!strFundingCodes.Equals(string.Empty)) strFundingCodes += ",";
                            strFundingCodes += FundingCode.Code;
                        }
                    }
                    else
                    {
                        strFundingCodes = "A";
                    }

                    DataSet ds = DatabaseLayer.SPAdminDB.Browse_HSSB2104(Agency, Depart, Program, Year, string.Empty, strFundingCodes, SiteNum, string.Empty, string.Empty, dtpAsOfDate.Text.Trim(), BaseForm.UserProfile.UserID);

                    ENRL_Asof_List = new List<ENRL_Asof_Entity>();
                    ENRL_Asof_List.Clear(); Count_List.Clear(); SiteSel_List.Clear(); RoomSel_List.Clear();
                    if (ds != null && ds.Tables[0].Rows.Count > 0)
                    {
                        foreach (DataRow row in ds.Tables[0].Rows)
                            ENRL_Asof_List.Add(new ENRL_Asof_Entity(row, string.Empty));
                    }

                    if (ds != null && ds.Tables[1].Rows.Count > 0)
                    {
                        foreach (DataRow row in ds.Tables[1].Rows)
                            Count_List.Add(new ENRL_Asof_Entity(row, string.Empty, string.Empty));
                    }

                    if (ds != null && ds.Tables[2].Rows.Count > 0)
                    {
                        foreach (DataRow row in ds.Tables[2].Rows)
                            SiteSel_List.Add(new ENRL_Asof_Entity(row, string.Empty, "Site"));
                    }

                    if (ds != null && ds.Tables[3].Rows.Count > 0)
                    {
                        foreach (DataRow row in ds.Tables[3].Rows)
                            RoomSel_List.Add(new ENRL_Asof_Entity(row, string.Empty, "Room"));
                    }



                    Y_Pos = 795;

                    string PrivSite = string.Empty; string PrivRoom = string.Empty; string PrivAmpm = string.Empty;

                    PdfPTable table = new PdfPTable(9);
                    table.TotalWidth = 550f;
                    table.WidthPercentage = 100;
                    table.LockedWidth = true;
                    float[] widths = new float[] { 2f,40f, 18f, 18f, 18f, 18f, 30f, 23f,2f };// 30f, 25f, 18f, 18f, 20f, 25f, 30f, 20f, 25f, 18f, 18f, 22f };
                    table.SetWidths(widths);
                    table.HorizontalAlignment = Element.ALIGN_CENTER;

                    PdfPCell Cell = new PdfPCell(new Phrase(" ", TableFont));
                    Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                    Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    Cell.BackgroundColor = DarkBlue;
                    table.AddCell(Cell);

                    PdfPCell Cell1 = new PdfPCell(new Phrase(" Enrollment Summary ", HeaderTextfnt));
                    Cell1.HorizontalAlignment = Element.ALIGN_LEFT;
                    Cell1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    Cell1.BackgroundColor = DarkBlue;
                    Cell1.Colspan = 7;
                    table.AddCell(Cell1);

                    PdfPCell Cell2 = new PdfPCell(new Phrase(" ", TableFont));
                    Cell2.HorizontalAlignment = Element.ALIGN_LEFT;
                    Cell2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    Cell2.BackgroundColor = DarkBlue;
                    table.AddCell(Cell2);

                    if (rbSiteSummary.Checked == true)
                    {
                        if (SiteSel_List.Count > 0)
                        {
                            string[] HeaderSeq = {"", "Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" ,""};
                            for (int i = 0; i < HeaderSeq.Length; ++i)
                            {
                                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], SubHeadTextfnt));
                                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                if (i == 0 || i == 8)
                                    cell.BackgroundColor = DarkBlue;
                                else
                                    cell.BackgroundColor = SecondBlue;
                                table.AddCell(cell);
                            }

                            int Enrl_cnt = 0; //int Wdraw_cnt = 0; int day30_cnt = 0; int Attn1_cnt = 0; int FirstTime_cnt = 0;
                            //int totEnrl_cnt = 0; int totWdraw_cnt = 0; int totday30_cnt = 0; int totAttn1_cnt = 0; int totFirstTime_cnt = 0; int TotFunds = 0;
                            int FundedTotal = 0;
                            //List<ENRL_Asof_Entity> SiteCount = new List<ENRL_Asof_Entity>();
                            int Cnt = 1;
                            foreach (ENRL_Asof_Entity Entity in SiteSel_List)
                            {
                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                table.AddCell(Cell);

                                PdfPCell SiteName = new PdfPCell(new Phrase(Entity.Site.Trim(), TableFont));
                                SiteName.HorizontalAlignment = Element.ALIGN_LEFT;
                                SiteName.Border= iTextSharp.text.Rectangle.BOX;
                                table.AddCell(SiteName);

                                CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()));
                                //string Enroll = string.Empty; int Count = 0;

                                if (selsite != null)
                                {
                                    PdfPCell tot_fun = new PdfPCell(new Phrase(selsite.SITE_FUNDED_SLOTS.Trim(), TableFont));
                                    tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                    tot_fun.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(tot_fun);
                                }
                                else
                                {
                                    PdfPCell tot_fun = new PdfPCell(new Phrase("", TableFont));
                                    tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                    tot_fun.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(tot_fun);
                                }

                                int Count = 0;
                                List<ENRL_Asof_Entity> SiteCount = Count_List.FindAll(u => u.Site.Trim().Equals(Entity.Site.Trim()));

                                List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Enrolled.Equals("1"));
                                var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                if (enrolled_Count.Count > 0) Count = enrolled_Count.Count;

                                //Count = SiteCount.Sum(u => int.Parse(u.Enrolled.Trim()));

                                string Enroll = string.Empty;
                                if (selsite != null)
                                {
                                    if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                    {
                                        if (Count < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                            Enroll = Count + "*";
                                        else Enroll = Count.ToString();

                                        FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                    }
                                    else Enroll = Count.ToString();
                                }


                                PdfPCell tot_enrl = new PdfPCell(new Phrase(Enroll, TableFont));
                                tot_enrl.HorizontalAlignment = Element.ALIGN_CENTER;
                                tot_enrl.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(tot_enrl);

                                Count = SiteCount.Sum(u => int.Parse(u.Window30.Trim()));
                                PdfPCell tot_30 = new PdfPCell(new Phrase(Count.ToString(), TableFont));
                                tot_30.HorizontalAlignment = Element.ALIGN_CENTER;
                                tot_30.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(tot_30);

                                Count = SiteCount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                PdfPCell tot_W = new PdfPCell(new Phrase(Count.ToString(), TableFont));
                                tot_W.HorizontalAlignment = Element.ALIGN_CENTER;
                                tot_W.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(tot_W);

                                Count = SiteCount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                PdfPCell tot_First = new PdfPCell(new Phrase(Count.ToString(), TableFont));
                                tot_First.HorizontalAlignment = Element.ALIGN_CENTER;
                                tot_First.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(tot_First);

                                Count = SiteCount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                PdfPCell tot_attn1 = new PdfPCell(new Phrase(Count.ToString(), TableFont));
                                tot_attn1.HorizontalAlignment = Element.ALIGN_CENTER;
                                tot_attn1.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(tot_attn1);

                                Cell2 = new PdfPCell(new Phrase(" ", TableFont));
                                Cell2.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell2.BackgroundColor = DarkBlue;
                                table.AddCell(Cell2);

                                Cnt++;
                            }

                            PdfPCell CelllL = new PdfPCell(new Phrase(" ", TableFont));
                            CelllL.HorizontalAlignment = Element.ALIGN_LEFT;
                            CelllL.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            CelllL.BackgroundColor = DarkBlue;
                            table.AddCell(CelllL);

                            PdfPCell CellML = new PdfPCell(new Phrase("2024 CAPSystems Inc", TableFontWhite));
                            CellML.HorizontalAlignment = Element.ALIGN_RIGHT;
                            CellML.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            CellML.BackgroundColor = DarkBlue;
                            CellML.Colspan = 7;
                            table.AddCell(CellML);

                            PdfPCell CellRL = new PdfPCell(new Phrase(" ", TableFont));
                            CellRL.HorizontalAlignment = Element.ALIGN_LEFT;
                            CellRL.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            CellRL.BackgroundColor = DarkBlue;
                            table.AddCell(CellRL);


                            document.Add(table);
                            table.DeleteBodyRows();

                            document.NewPage();

                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            Cell.BackgroundColor = DarkBlue;
                            table.AddCell(Cell);

                             Cell1 = new PdfPCell(new Phrase(" Enrollment Summary ", HeaderTextfnt));
                            Cell1.HorizontalAlignment = Element.ALIGN_LEFT;
                            Cell1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            Cell1.BackgroundColor = DarkBlue;
                            Cell1.Colspan = 7;
                            table.AddCell(Cell1);

                            Cell2 = new PdfPCell(new Phrase(" ", TableFont));
                            Cell2.HorizontalAlignment = Element.ALIGN_LEFT;
                            Cell2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            Cell2.BackgroundColor = DarkBlue;
                            table.AddCell(Cell2);

                            string[] HeaderSeq1 = { "","Fund", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day","" };
                            for (int i = 0; i < HeaderSeq.Length; ++i)
                            {
                                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq1[i], SubHeadTextfnt));
                                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                //cell.FixedHeight = 15f;
                                cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                if (i == 0 || i == 8)
                                    cell.BackgroundColor = DarkBlue;
                                else
                                    cell.BackgroundColor = SecondBlue;
                                table.AddCell(cell);
                            }

                            int Total_Count = 0;

                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            Cell.BackgroundColor = DarkBlue;
                            table.AddCell(Cell);

                            PdfPCell Rep = new PdfPCell(new Phrase("Report Totals:", TableFont));
                            Rep.HorizontalAlignment = Element.ALIGN_LEFT;
                            Rep.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(Rep);

                            Total_Count = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));
                            if (Total_Count > 0)
                            {
                                PdfPCell Rep1 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                                Rep1.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep1.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep1);
                            }
                            else
                            {
                                PdfPCell Rep1 = new PdfPCell(new Phrase(FundedTotal.ToString(), TableFont));
                                Rep1.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep1.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep1);
                            }

                            List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                            var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                            if (Repenrolled_Count.Count > 0) Total_Count = Repenrolled_Count.Count;
                            //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                            PdfPCell Rep2 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep2.HorizontalAlignment = Element.ALIGN_CENTER;
                            Rep2.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(Rep2);

                            Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                            PdfPCell Rep3 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep3.HorizontalAlignment = Element.ALIGN_CENTER;
                            Rep3.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(Rep3);

                            Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                            PdfPCell Rep4 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep4.HorizontalAlignment = Element.ALIGN_CENTER;
                            Rep4.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(Rep4);

                            Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                            PdfPCell Rep5 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep5.HorizontalAlignment = Element.ALIGN_CENTER;
                            Rep5.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(Rep5);

                            Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                            PdfPCell Rep6 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep6.HorizontalAlignment = Element.ALIGN_CENTER;
                            Rep6.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(Rep6);

                            Cell2 = new PdfPCell(new Phrase(" ", TableFont));
                            Cell2.HorizontalAlignment = Element.ALIGN_LEFT;
                            Cell2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            Cell2.BackgroundColor = DarkBlue;
                            table.AddCell(Cell2);

                            if (propfundingSource.Count > 0)
                            {
                                //var Fundcnt = Count_List.Select(u => u.FundHie!= "None").Distinct().ToList();
                                //int Fundcnt = Count_List.Where(u => u.FundHie <> "None").Select(m => m.FundHie).Distinct().Count();
                                int Fundcnt = Count_List.Select(t => t.FundHie).Distinct().Count(s => s != "None");
                                int FCnt = 1;
                                foreach (CommonEntity FundEntity in propfundingSource)
                                {
                                    List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                    int EnrlCnt = 0; int Wcnt = 0;
                                    if (Fundlistcount.Count > 0)
                                    {
                                        EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                        Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                        int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                        //if (EnrlCnt > 0 || Wcnt > 0)
                                        //{

                                        Cell = new PdfPCell(new Phrase(" ", TableFont));
                                        Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Cell.BackgroundColor = DarkBlue;
                                        table.AddCell(Cell);

                                        PdfPCell Fund = new PdfPCell(new Phrase("     " + FundEntity.Desc, TableFont));
                                        Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                        if (FundCnt == 0)
                                            Fund.Colspan = 2;
                                        Fund.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(Fund);

                                        if (FundCnt > 0)
                                        {
                                            PdfPCell Fund8 = new PdfPCell(new Phrase(FundCnt.ToString(), TableFont));
                                            Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund8.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund8);
                                        }

                                        PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                        Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        Fund1.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(Fund1);

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                        PdfPCell Fund2 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                        Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                        Fund2.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(Fund2);

                                        //Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                        PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                        Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                        Fund3.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(Fund3);

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                        PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                        Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                        Fund4.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(Fund4);

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                        PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                        Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                        Fund5.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(Fund5);

                                        Cell2 = new PdfPCell(new Phrase(" ", TableFont));
                                        Cell2.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Cell2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Cell2.BackgroundColor = DarkBlue;
                                        table.AddCell(Cell2);

                                        FCnt++;
                                        //}
                                    }
                                }
                            }
                            CelllL = new PdfPCell(new Phrase(" ", TableFont));
                            CelllL.HorizontalAlignment = Element.ALIGN_LEFT;
                            CelllL.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            CelllL.BackgroundColor = DarkBlue;
                            table.AddCell(CelllL);

                            CellML = new PdfPCell(new Phrase("2024 CAPSystems Inc", TableFontWhite));
                            CellML.HorizontalAlignment = Element.ALIGN_RIGHT;
                            CellML.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            CellML.BackgroundColor = DarkBlue;
                            CellML.Colspan = 7;
                            table.AddCell(CellML);

                            CellRL = new PdfPCell(new Phrase(" ", TableFont));
                            CellRL.HorizontalAlignment = Element.ALIGN_LEFT;
                            CellRL.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            CellRL.BackgroundColor = DarkBlue;
                            table.AddCell(CellRL);


                            document.Add(table);

                        }

                    }

                    if (rbRoomDetail.Checked == true)
                    {

                        CaseSiteEntity Search_Entity = new CaseSiteEntity(true);
                        Search_Entity.SiteAGENCY = Agency;
                        Search_Entity.SiteDEPT = Depart; Search_Entity.SitePROG = Program;
                        if (CmbYear.Visible == true) Search_Entity.SiteYEAR = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                        propCaseAllSiteEntity = _model.CaseMstData.Browse_CASESITE(Search_Entity, "Browse");

                        if (RoomSel_List.Count > 0)
                        {
                            bool First = true;

                            string[] HeaderSeq = {"", "Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day","" };
                            for (int i = 0; i < HeaderSeq.Length; ++i)
                            {
                                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], SubHeadTextfnt));
                                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                //cell.FixedHeight = 15f;
                                cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                if (i == 0 || i == 8)
                                    cell.BackgroundColor = DarkBlue;
                                else
                                    cell.BackgroundColor = SecondBlue;
                                table.AddCell(cell);
                            }
                            int Enrl_cnt = 0; //int Wdraw_cnt = 0; int day30_cnt = 0; int Attn1_cnt = 0; int FirstTime_cnt = 0;
                            int totEnrl_cnt = 0; int totWdraw_cnt = 0; int totday30_cnt = 0; int totAttn1_cnt = 0; int totFirstTime_cnt = 0; int TotFunds = 0;
                            int FundedTotal = 0; int cnt = 1;
                            foreach (ENRL_Asof_Entity Entity in RoomSel_List)
                            {
                                if (!First)
                                {
                                    if (Entity.Site.Trim() != PrivSite)
                                    {
                                        Cell = new PdfPCell(new Phrase(" ", TableFont));
                                        Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Cell.BackgroundColor = DarkBlue;
                                        table.AddCell(Cell);

                                        PdfPCell SiteName2 = new PdfPCell(new Phrase("Total " + PrivSite, TableFont));
                                        SiteName2.HorizontalAlignment = Element.ALIGN_LEFT;
                                        SiteName2.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(SiteName2);

                                        PdfPCell tot_fun1 = new PdfPCell(new Phrase(TotFunds.ToString(), TableFont));
                                        tot_fun1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_fun1.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_fun1);

                                        string totEnroll = string.Empty;
                                        if (totEnrl_cnt < TotFunds)
                                            totEnroll = totEnrl_cnt.ToString() + "*";
                                        else totEnroll = totEnrl_cnt.ToString();

                                        //FundedTotal = FundedTotal + TotFunds;

                                        PdfPCell tot_enrl1 = new PdfPCell(new Phrase(totEnroll, TableFont));
                                        tot_enrl1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_enrl1.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_enrl1);

                                        PdfPCell tot_301 = new PdfPCell(new Phrase(totday30_cnt.ToString(), TableFont));
                                        tot_301.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_301.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_301);

                                        PdfPCell tot_W1 = new PdfPCell(new Phrase(totWdraw_cnt.ToString(), TableFont));
                                        tot_W1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_W1.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_W1);

                                        PdfPCell tot_First1 = new PdfPCell(new Phrase(totFirstTime_cnt.ToString(), TableFont));
                                        tot_First1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_First1.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_First1);

                                        PdfPCell tot_attn1 = new PdfPCell(new Phrase(totAttn1_cnt.ToString(), TableFont));
                                        tot_attn1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_attn1.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_attn1);

                                        PdfPCell Cell21 = new PdfPCell(new Phrase(" ", TableFont));
                                        Cell21.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Cell21.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Cell21.BackgroundColor = DarkBlue;
                                        table.AddCell(Cell21);

                                        totEnrl_cnt = 0; totWdraw_cnt = 0; totAttn1_cnt = 0;
                                        totday30_cnt = 0; totFirstTime_cnt = 0; TotFunds = 0;

                                        if (table.Rows.Count > 1)
                                        {
                                            PdfPCell CelllL1 = new PdfPCell(new Phrase(" ", TableFont));
                                            CelllL1.HorizontalAlignment = Element.ALIGN_LEFT;
                                            CelllL1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            CelllL1.BackgroundColor = DarkBlue;
                                            table.AddCell(CelllL1);

                                            PdfPCell CellML1 = new PdfPCell(new Phrase("2024 CAPSystems Inc", TableFontWhite));
                                            CellML1.HorizontalAlignment = Element.ALIGN_RIGHT;
                                            CellML1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            CellML1.BackgroundColor = DarkBlue;
                                            CellML1.Colspan = 7;
                                            table.AddCell(CellML1);

                                            PdfPCell CellRL1 = new PdfPCell(new Phrase(" ", TableFont));
                                            CellRL1.HorizontalAlignment = Element.ALIGN_LEFT;
                                            CellRL1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            CellRL1.BackgroundColor = DarkBlue;
                                            table.AddCell(CellRL1);

                                            document.Add(table);
                                            table.DeleteBodyRows();
                                            document.NewPage();

                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);

                                            PdfPCell A1 = new PdfPCell(new Phrase(" Enrollment Summary ", HeaderTextfnt));
                                            A1.HorizontalAlignment = Element.ALIGN_LEFT;
                                            A1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            A1.BackgroundColor = DarkBlue;
                                            A1.Colspan = 7;
                                            table.AddCell(A1);

                                            PdfPCell A2 = new PdfPCell(new Phrase(" ", TableFont));
                                            A2.HorizontalAlignment = Element.ALIGN_LEFT;
                                            A2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            A2.BackgroundColor = DarkBlue;
                                            table.AddCell(A2);

                                        }
                                        string[] HeaderSeq1 = {"", "Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day","" };
                                        for (int i = 0; i < HeaderSeq.Length; ++i)
                                        {
                                            PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq1[i], SubHeadTextfnt));
                                            cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                            //cell.FixedHeight = 15f;
                                            cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            if (i == 0 || i == 8)
                                                cell.BackgroundColor = DarkBlue;
                                            else
                                                cell.BackgroundColor = SecondBlue;
                                            table.AddCell(cell);
                                        }

                                        Cell = new PdfPCell(new Phrase(" ", TableFont));
                                        Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Cell.BackgroundColor = DarkBlue;
                                        table.AddCell(Cell);

                                        PdfPCell SiteName = new PdfPCell(new Phrase(Entity.Site.Trim(), TableFont));
                                        SiteName.HorizontalAlignment = Element.ALIGN_LEFT;
                                        SiteName.Colspan = 7;
                                        SiteName.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(SiteName);

                                        PdfPCell A3 = new PdfPCell(new Phrase(" ", TableFont));
                                        A3.HorizontalAlignment = Element.ALIGN_LEFT;
                                        A3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        A3.BackgroundColor = DarkBlue;
                                        table.AddCell(A3);

                                    }

                                    Cell = new PdfPCell(new Phrase(" ", TableFont));
                                    Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                    Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    Cell.BackgroundColor = DarkBlue;
                                    table.AddCell(Cell);

                                    PdfPCell SiteName1 = new PdfPCell(new Phrase("      " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim(), TableFont));
                                    SiteName1.HorizontalAlignment = Element.ALIGN_LEFT;
                                    SiteName1.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(SiteName1);

                                    CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));

                                    List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                    var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                    if (enrolled_Count.Count > 0) Entity.Enrolled = enrolled_Count.Count.ToString();
                                    string Enroll = string.Empty;
                                    if (selsite != null)
                                    {
                                        PdfPCell tot_fun = new PdfPCell(new Phrase(selsite.SITE_FUNDED_SLOTS.Trim(), TableFont));
                                        tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_fun.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_fun);
                                        if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                        {
                                            if (int.Parse(Entity.Enrolled) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                Enroll = Entity.Enrolled + "*";
                                            else Enroll = Entity.Enrolled;
                                        }
                                        else Enroll = Entity.Enrolled;
                                    }
                                    else
                                    {
                                        PdfPCell tot_fun = new PdfPCell(new Phrase("", TableFont));
                                        tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_fun.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_fun);

                                        Enroll = Entity.Enrolled;
                                    }


                                    PdfPCell tot_enrl = new PdfPCell(new Phrase(Enroll, TableFont));
                                    tot_enrl.HorizontalAlignment = Element.ALIGN_CENTER;
                                    tot_enrl.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(tot_enrl);

                                    PdfPCell tot_30 = new PdfPCell(new Phrase(Entity.Window30, TableFont));
                                    tot_30.HorizontalAlignment = Element.ALIGN_CENTER;
                                    tot_30.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(tot_30);

                                    PdfPCell tot_W = new PdfPCell(new Phrase(Entity.Withdrawn, TableFont));
                                    tot_W.HorizontalAlignment = Element.ALIGN_CENTER;
                                    tot_W.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(tot_W);

                                    PdfPCell tot_First = new PdfPCell(new Phrase(Entity.FirstTime, TableFont));
                                    tot_First.HorizontalAlignment = Element.ALIGN_CENTER;
                                    tot_First.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(tot_First);

                                    PdfPCell tot_attn12 = new PdfPCell(new Phrase(Entity.GetAttn1, TableFont));
                                    tot_attn12.HorizontalAlignment = Element.ALIGN_CENTER;
                                    tot_attn12.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(tot_attn12);

                                    PdfPCell A5 = new PdfPCell(new Phrase(" ", TableFont));
                                    A5.HorizontalAlignment = Element.ALIGN_LEFT;
                                    A5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    A5.BackgroundColor = DarkBlue;
                                    table.AddCell(A5);

                                    totEnrl_cnt = totEnrl_cnt + int.Parse(Entity.Enrolled); totWdraw_cnt = totWdraw_cnt + int.Parse(Entity.Withdrawn); totAttn1_cnt = totAttn1_cnt + int.Parse(Entity.GetAttn1);
                                    totday30_cnt = totday30_cnt + int.Parse(Entity.Window30); totFirstTime_cnt = totFirstTime_cnt + int.Parse(Entity.FirstTime);
                                    if (selsite != null)
                                    {
                                        if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                        {
                                            TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                            FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                        }
                                    }
                                    PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM.Trim();

                                }
                                else
                                {
                                    Cell = new PdfPCell(new Phrase(" ", TableFont));
                                    Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                    Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    Cell.BackgroundColor = DarkBlue;
                                    table.AddCell(Cell);

                                    PdfPCell SiteName = new PdfPCell(new Phrase(Entity.Site.Trim(), TableFont));
                                    SiteName.HorizontalAlignment = Element.ALIGN_LEFT;
                                    SiteName.Colspan = 7;
                                    SiteName.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(SiteName);

                                    PdfPCell A6 = new PdfPCell(new Phrase(" ", TableFont));
                                    A6.HorizontalAlignment = Element.ALIGN_LEFT;
                                    A6.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    A6.BackgroundColor = DarkBlue;
                                    table.AddCell(A6);

                                    Cell = new PdfPCell(new Phrase(" ", TableFont));
                                    Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                    Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    Cell.BackgroundColor = DarkBlue;
                                    table.AddCell(Cell);

                                    PdfPCell SiteName1 = new PdfPCell(new Phrase("      " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim(), TableFont));
                                    SiteName1.HorizontalAlignment = Element.ALIGN_LEFT;
                                    SiteName1.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(SiteName1);

                                    CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));
                                    List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                    var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                    if (enrolled_Count.Count > 0) Entity.Enrolled = enrolled_Count.Count.ToString();
                                    string Enroll = string.Empty;
                                    if (selsite != null)
                                    {
                                        PdfPCell tot_fun = new PdfPCell(new Phrase(selsite.SITE_FUNDED_SLOTS.Trim(), TableFont));
                                        tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_fun.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_fun);

                                        if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                        {
                                            if (int.Parse(Entity.Enrolled) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                Enroll = Entity.Enrolled + "*";
                                            else Enroll = Entity.Enrolled;
                                        }
                                        else Enroll = Entity.Enrolled;

                                    }
                                    else
                                    {
                                        PdfPCell tot_fun = new PdfPCell(new Phrase("", TableFont));
                                        tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_fun.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_fun);

                                        Enroll = Entity.Enrolled;
                                    }

                                    PdfPCell tot_enrl = new PdfPCell(new Phrase(Enroll, TableFont));
                                    tot_enrl.HorizontalAlignment = Element.ALIGN_CENTER;
                                    tot_enrl.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(tot_enrl);

                                    PdfPCell tot_30 = new PdfPCell(new Phrase(Entity.Window30, TableFont));
                                    tot_30.HorizontalAlignment = Element.ALIGN_CENTER;
                                    tot_30.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(tot_30);

                                    PdfPCell tot_W = new PdfPCell(new Phrase(Entity.Withdrawn, TableFont));
                                    tot_W.HorizontalAlignment = Element.ALIGN_CENTER;
                                    tot_W.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(tot_W);

                                    PdfPCell tot_First = new PdfPCell(new Phrase(Entity.FirstTime, TableFont));
                                    tot_First.HorizontalAlignment = Element.ALIGN_CENTER;
                                    tot_First.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(tot_First);

                                    PdfPCell tot_attn12 = new PdfPCell(new Phrase(Entity.GetAttn1, TableFont));
                                    tot_attn12.HorizontalAlignment = Element.ALIGN_CENTER;
                                    tot_attn12.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(tot_attn12);

                                    PdfPCell A7 = new PdfPCell(new Phrase(" ", TableFont));
                                    A7.HorizontalAlignment = Element.ALIGN_LEFT;
                                    A7.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    A7.BackgroundColor = DarkBlue;
                                    table.AddCell(A7);

                                    totEnrl_cnt = totEnrl_cnt + int.Parse(Entity.Enrolled); totWdraw_cnt = totWdraw_cnt + int.Parse(Entity.Withdrawn); totAttn1_cnt = totAttn1_cnt + int.Parse(Entity.GetAttn1);
                                    totday30_cnt = totday30_cnt + int.Parse(Entity.Window30); totFirstTime_cnt = totFirstTime_cnt + int.Parse(Entity.FirstTime);
                                    if (selsite != null)
                                    {
                                        if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                        {
                                            TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                            FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                        }
                                    }
                                    PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM.Trim();

                                }
                                First = false; PrivSite = Entity.Site.Trim();
                                cnt++;
                            }

                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            Cell.BackgroundColor = DarkBlue;
                            table.AddCell(Cell);

                            PdfPCell nn = new PdfPCell(new Phrase("Total " + PrivSite, TableFont));
                            nn.HorizontalAlignment = Element.ALIGN_LEFT;
                            nn.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(nn);

                            PdfPCell nn1 = new PdfPCell(new Phrase(TotFunds.ToString(), TableFont));
                            nn1.HorizontalAlignment = Element.ALIGN_CENTER;
                            nn1.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(nn1);

                            string totEnroll1 = string.Empty;
                            if (totEnrl_cnt < TotFunds)
                                totEnroll1 = totEnrl_cnt.ToString() + "*";
                            else totEnroll1 = totEnrl_cnt.ToString();

                            //FundedTotal = FundedTotal + TotFunds;

                            PdfPCell nn2 = new PdfPCell(new Phrase(totEnroll1, TableFont));
                            nn2.HorizontalAlignment = Element.ALIGN_CENTER;
                            nn2.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(nn2);

                            PdfPCell nn3 = new PdfPCell(new Phrase(totday30_cnt.ToString(), TableFont));
                            nn3.HorizontalAlignment = Element.ALIGN_CENTER;
                            nn3.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(nn3);

                            PdfPCell nn4 = new PdfPCell(new Phrase(totWdraw_cnt.ToString(), TableFont));
                            nn4.HorizontalAlignment = Element.ALIGN_CENTER;
                            nn4.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(nn4);

                            PdfPCell nn5 = new PdfPCell(new Phrase(totFirstTime_cnt.ToString(), TableFont));
                            nn5.HorizontalAlignment = Element.ALIGN_CENTER;
                            nn5.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(nn5);

                            PdfPCell nn6 = new PdfPCell(new Phrase(totAttn1_cnt.ToString(), TableFont));
                            nn6.HorizontalAlignment = Element.ALIGN_CENTER;
                            nn6.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(nn6);

                            PdfPCell A4 = new PdfPCell(new Phrase(" ", TableFont));
                            A4.HorizontalAlignment = Element.ALIGN_LEFT;
                            A4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            A4.BackgroundColor = DarkBlue;
                            table.AddCell(A4);

                            PdfPCell CelllL = new PdfPCell(new Phrase(" ", TableFont));
                            CelllL.HorizontalAlignment = Element.ALIGN_LEFT;
                            CelllL.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            CelllL.BackgroundColor = DarkBlue;
                            table.AddCell(CelllL);

                            PdfPCell CellML = new PdfPCell(new Phrase("2024 CAPSystems Inc", TableFontWhite));
                            CellML.HorizontalAlignment = Element.ALIGN_RIGHT;
                            CellML.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            CellML.BackgroundColor = DarkBlue;
                            CellML.Colspan = 7;
                            table.AddCell(CellML);

                            PdfPCell CellRL = new PdfPCell(new Phrase(" ", TableFont));
                            CellRL.HorizontalAlignment = Element.ALIGN_LEFT;
                            CellRL.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            CellRL.BackgroundColor = DarkBlue;
                            table.AddCell(CellRL);

                            document.Add(table);
                            table.DeleteBodyRows();

                            //document.Add(table);
                            //table.DeleteBodyRows();

                            document.NewPage();

                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            Cell.BackgroundColor = DarkBlue;
                            table.AddCell(Cell);

                            Cell = new PdfPCell(new Phrase(" Enrollment Summary ", HeaderTextfnt));
                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            Cell.BackgroundColor = DarkBlue;
                            Cell.Colspan = 7;
                            table.AddCell(Cell);

                            A4 = new PdfPCell(new Phrase(" ", TableFont));
                            A4.HorizontalAlignment = Element.ALIGN_LEFT;
                            A4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            A4.BackgroundColor = DarkBlue;
                            table.AddCell(A4);


                            string[] HeaderSeq2 = { "","Fund", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day","" };
                            for (int i = 0; i < HeaderSeq.Length; ++i)
                            {
                                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq2[i], SubHeadTextfnt));
                                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                //cell.FixedHeight = 15f;
                                cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                if (i == 0 || i == 8)
                                    cell.BackgroundColor = DarkBlue;
                                else
                                    cell.BackgroundColor = SecondBlue;
                                table.AddCell(cell);
                            }

                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            Cell.BackgroundColor = DarkBlue;
                            table.AddCell(Cell);

                            int Total_Count = 0;
                            PdfPCell Rep = new PdfPCell(new Phrase("Report Totals:", TableFont));
                            Rep.HorizontalAlignment = Element.ALIGN_LEFT;
                            Rep.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(Rep);

                            Total_Count = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));
                            if (Total_Count > 0)
                            {
                                PdfPCell Rep1 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                                Rep1.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep1.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep1);
                            }
                            else
                            {
                                PdfPCell Rep1 = new PdfPCell(new Phrase(FundedTotal.ToString(), TableFont));
                                Rep1.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep1.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep1);
                            }


                            List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                            var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                            if (Repenrolled_Count.Count > 0) Total_Count = Repenrolled_Count.Count;
                            //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                            PdfPCell Rep2 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep2.HorizontalAlignment = Element.ALIGN_CENTER;
                            Rep2.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(Rep2);

                            Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                            PdfPCell Rep3 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep3.HorizontalAlignment = Element.ALIGN_CENTER;
                            Rep3.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(Rep3);

                            Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                            PdfPCell Rep4 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep4.HorizontalAlignment = Element.ALIGN_CENTER;
                            Rep4.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(Rep4);

                            Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                            PdfPCell Rep5 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep5.HorizontalAlignment = Element.ALIGN_CENTER;
                            Rep5.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(Rep5);

                            Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                            PdfPCell Rep6 = new PdfPCell(new Phrase(Total_Count.ToString(), TableFont));
                            Rep6.HorizontalAlignment = Element.ALIGN_CENTER;
                            Rep6.Border = iTextSharp.text.Rectangle.BOX;
                            table.AddCell(Rep6);

                            A4 = new PdfPCell(new Phrase(" ", TableFont));
                            A4.HorizontalAlignment = Element.ALIGN_LEFT;
                            A4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            A4.BackgroundColor = DarkBlue;
                            table.AddCell(A4);

                            if (propfundingSource.Count > 0)
                            {
                                int Fundcnt = Count_List.Select(t => t.FundHie).Distinct().Count(s => s != "None");
                                int FCnt = 1;
                                foreach (CommonEntity FundEntity in propfundingSource)
                                {
                                    List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                    int EnrlCnt = 0; int Wcnt = 0;
                                    if (Fundlistcount.Count > 0)
                                    {
                                        EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                        Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                        int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                        //if (EnrlCnt > 0 || Wcnt > 0)
                                        //{

                                        Cell = new PdfPCell(new Phrase(" ", TableFont));
                                        Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Cell.BackgroundColor = DarkBlue;
                                        table.AddCell(Cell);

                                        PdfPCell Fund = new PdfPCell(new Phrase("      " + FundEntity.Desc, TableFont));
                                        Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                        if (FundCnt == 0)
                                            Fund.Colspan = 2;
                                        Fund.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(Fund);

                                        if (FundCnt > 0)
                                        {
                                            PdfPCell Fund8 = new PdfPCell(new Phrase(FundCnt.ToString(), TableFont));
                                            Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund8);
                                        }

                                        PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                        Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        Fund1.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(Fund1);

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                        PdfPCell Fund2 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                        Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                        Fund2.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(Fund2);

                                        //Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                        PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                        Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                        Fund3.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(Fund3);

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                        PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                        Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                        Fund4.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(Fund4);

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                        PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                        Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                        Fund5.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(Fund5);
                                        FCnt++;
                                        //}

                                        Cell2 = new PdfPCell(new Phrase(" ", TableFont));
                                        Cell2.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Cell2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Cell2.BackgroundColor = DarkBlue;
                                        table.AddCell(Cell2);

                                    }
                                }
                            }

                            CelllL = new PdfPCell(new Phrase(" ", TableFont));
                            CelllL.HorizontalAlignment = Element.ALIGN_LEFT;
                            CelllL.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            CelllL.BackgroundColor = DarkBlue;
                            table.AddCell(CelllL);

                            CellML = new PdfPCell(new Phrase("2024 CAPSystems Inc", TableFontWhite));
                            CellML.HorizontalAlignment = Element.ALIGN_RIGHT;
                            CellML.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            CellML.BackgroundColor = DarkBlue;
                            CellML.Colspan = 7;
                            table.AddCell(CellML);

                            CellRL = new PdfPCell(new Phrase(" ", TableFont));
                            CellRL.HorizontalAlignment = Element.ALIGN_LEFT;
                            CellRL.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            CellRL.BackgroundColor = DarkBlue;
                            table.AddCell(CellRL);

                            document.Add(table);
                        }
                    }

                    if (rbFundDetailByRoom.Checked == true)
                    {
                        CaseSiteEntity Search_Entity = new CaseSiteEntity(true);
                        Search_Entity.SiteAGENCY = Agency;
                        Search_Entity.SiteDEPT = Depart; Search_Entity.SitePROG = Program;
                        if (CmbYear.Visible == true) Search_Entity.SiteYEAR = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                        propCaseAllSiteEntity = _model.CaseMstData.Browse_CASESITE(Search_Entity, "Browse");


                        if (Count_List.Count > 0)
                        {
                            bool First = true;

                            
                            string[] HeaderSeq = {"", "Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "Firsttime Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day","" };
                            for (int i = 0; i < HeaderSeq.Length; ++i)
                            {
                                PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                                cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                //cell.FixedHeight = 15f;
                                cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                if (i == 0 || i == 8)
                                    cell.BackgroundColor = DarkBlue;
                                else
                                    cell.BackgroundColor = SecondBlue;
                                table.AddCell(cell);
                            }

                            int Enrl_cnt = 0; //int Wdraw_cnt = 0; int day30_cnt = 0; int Attn1_cnt = 0; int FirstTime_cnt = 0;
                            int totEnrl_cnt = 0; int totWdraw_cnt = 0; int totday30_cnt = 0; int totAttn1_cnt = 0; int totFirstTime_cnt = 0; int TotFunds = 0;
                            int FundedTotal = 0;
                            if (rbAll.Checked == true)
                            {
                                foreach (ENRL_Asof_Entity Entity in Count_List)
                                {
                                    if (Entity.Site.Trim() + Entity.Room.Trim() + Entity.AMPM.Trim() != PrivSite + PrivRoom + PrivAmpm)
                                    {
                                        if (!First)
                                        {
                                            if (Entity.Site.Trim() != PrivSite)
                                            {
                                                int Total_Count = 0;

                                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                Cell.BackgroundColor = DarkBlue;
                                                table.AddCell(Cell);

                                                PdfPCell Rep = new PdfPCell(new Phrase("Total " + PrivSite, TableFont));
                                                Rep.HorizontalAlignment = Element.ALIGN_LEFT;
                                                Rep.Border = iTextSharp.text.Rectangle.BOX;
                                                table.AddCell(Rep);

                                                PdfPCell Rep1 = new PdfPCell(new Phrase(TotFunds.ToString(), TableFont));
                                                Rep1.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Rep1.Border = iTextSharp.text.Rectangle.BOX;
                                                table.AddCell(Rep1);

                                                //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                                                string totEnroll1 = string.Empty;
                                                if (totEnrl_cnt < TotFunds)
                                                    totEnroll1 = totEnrl_cnt.ToString() + "*";
                                                else totEnroll1 = totEnrl_cnt.ToString();

                                                
                                                PdfPCell Rep2 = new PdfPCell(new Phrase(totEnrl_cnt.ToString(), TableFont));
                                                Rep2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Rep2.Border = iTextSharp.text.Rectangle.BOX;
                                                table.AddCell(Rep2);

                                                Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                                PdfPCell Rep3 = new PdfPCell(new Phrase(totday30_cnt.ToString(), TableFont));
                                                Rep3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Rep3.Border = iTextSharp.text.Rectangle.BOX;
                                                table.AddCell(Rep3);

                                                Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                                PdfPCell Rep4 = new PdfPCell(new Phrase(totWdraw_cnt.ToString(), TableFont));
                                                Rep4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Rep4.Border = iTextSharp.text.Rectangle.BOX;
                                                table.AddCell(Rep4);

                                                Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                                PdfPCell Rep5 = new PdfPCell(new Phrase(totFirstTime_cnt.ToString(), TableFont));
                                                Rep5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Rep5.Border = iTextSharp.text.Rectangle.BOX;
                                                table.AddCell(Rep5);

                                                Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                                PdfPCell Rep6 = new PdfPCell(new Phrase(totAttn1_cnt.ToString(), TableFont));
                                                Rep6.HorizontalAlignment = Element.ALIGN_CENTER;
                                                Rep6.Border = iTextSharp.text.Rectangle.BOX;
                                                table.AddCell(Rep6);

                                                PdfPCell Cell21 = new PdfPCell(new Phrase(" ", TableFont));
                                                Cell21.HorizontalAlignment = Element.ALIGN_LEFT;
                                                Cell21.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                Cell21.BackgroundColor = DarkBlue;
                                                table.AddCell(Cell21);

                                                if (propfundingSource.Count > 0)
                                                {
                                                    foreach (CommonEntity FundEntity in propfundingSource)
                                                    {
                                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                                        int EnrlCnt = 0; int Wcnt = 0;
                                                        if (Fundlistcount.Count > 0)
                                                        {
                                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                                            int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));

                                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                            Cell.BackgroundColor = DarkBlue;
                                                            table.AddCell(Cell);

                                                            //if (EnrlCnt > 0 || Wcnt > 0)
                                                            //{
                                                            PdfPCell Fund = new PdfPCell(new Phrase("       " + FundEntity.Desc, TableFont));
                                                            Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            if (FundCnt == 0)
                                                                Fund.Colspan = 2;
                                                            Fund.Border = iTextSharp.text.Rectangle.BOX;
                                                            table.AddCell(Fund);

                                                            // Brain asked to commend to this on 04/07/2016
                                                            //string SelFundSlots = string.Empty;
                                                            //if (dtFundCnt.Rows.Count > 0)
                                                            //{
                                                            //    foreach (DataRow dr in dtFundCnt.Rows)
                                                            //    {
                                                            //        if (FundEntity.Code.Trim() == dr["Fund"].ToString().Trim() && dr["Site"].ToString() == PrivSite)
                                                            //        {
                                                            //            SelFundSlots = dr["Count"].ToString(); break;
                                                            //        }
                                                            //    }
                                                            //}

                                                            if (FundCnt > 0)
                                                            {
                                                                PdfPCell Fund8 = new PdfPCell(new Phrase(FundCnt.ToString(), TableFont));
                                                                Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                                                //Fund.Colspan = 2;
                                                                Fund8.Border = iTextSharp.text.Rectangle.BOX;
                                                                table.AddCell(Fund8);
                                                            }

                                                            PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                                            Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                                            Fund1.Border = iTextSharp.text.Rectangle.BOX;
                                                            table.AddCell(Fund1);

                                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                                            PdfPCell Window30 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                            Window30.HorizontalAlignment = Element.ALIGN_CENTER;
                                                            Window30.Border = iTextSharp.text.Rectangle.BOX;
                                                            table.AddCell(Window30);

                                                            //Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                                            PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                                            Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                            Fund3.Border = iTextSharp.text.Rectangle.BOX;
                                                            table.AddCell(Fund3);

                                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                                            PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                            Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                            Fund4.Border = iTextSharp.text.Rectangle.BOX;
                                                            table.AddCell(Fund4);

                                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                                            PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                            Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                            Fund5.Border = iTextSharp.text.Rectangle.BOX;
                                                            table.AddCell(Fund5);

                                                            Cell21 = new PdfPCell(new Phrase(" ", TableFont));
                                                            Cell21.HorizontalAlignment = Element.ALIGN_LEFT;
                                                            Cell21.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                            Cell21.BackgroundColor = DarkBlue;
                                                            table.AddCell(Cell21);

                                                            //}
                                                        }
                                                    }
                                                }

                                                totEnrl_cnt = 0; totWdraw_cnt = 0; totAttn1_cnt = 0;
                                                totday30_cnt = 0; totFirstTime_cnt = 0; TotFunds = 0;
                                                if (table.Rows.Count > 1)
                                                {
                                                    PdfPCell CelllL1 = new PdfPCell(new Phrase(" ", TableFont));
                                                    CelllL1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    CelllL1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    CelllL1.BackgroundColor = DarkBlue;
                                                    table.AddCell(CelllL1);

                                                    PdfPCell CellML1 = new PdfPCell(new Phrase("2024 CAPSystems Inc", TableFontWhite));
                                                    CellML1.HorizontalAlignment = Element.ALIGN_RIGHT;
                                                    CellML1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    CellML1.BackgroundColor = DarkBlue;
                                                    CellML1.Colspan = 7;
                                                    table.AddCell(CellML1);

                                                    PdfPCell CellRL1 = new PdfPCell(new Phrase(" ", TableFont));
                                                    CellRL1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    CellRL1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    CellRL1.BackgroundColor = DarkBlue;
                                                    table.AddCell(CellRL1);

                                                    document.Add(table);
                                                    table.DeleteBodyRows();
                                                    document.NewPage();

                                                    Cell = new PdfPCell(new Phrase(" ", TableFont));
                                                    Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Cell.BackgroundColor = DarkBlue;
                                                    table.AddCell(Cell);

                                                    Cell = new PdfPCell(new Phrase(" Enrollment Summary ", HeaderTextfnt));
                                                    Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Cell.BackgroundColor = DarkBlue;
                                                    Cell.Colspan = 7;
                                                    table.AddCell(Cell);

                                                    Cell = new PdfPCell(new Phrase(" ", TableFont));
                                                    Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Cell.BackgroundColor = DarkBlue;
                                                    table.AddCell(Cell);

                                                }

                                                string[] HeaderSeq3 = { "","Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day","" };
                                                for (int i = 0; i < HeaderSeq.Length; ++i)
                                                {
                                                    PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq3[i], TblFontBold));
                                                    cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                                    //cell.FixedHeight = 15f;
                                                    cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    if (i == 0 || i == 8)
                                                        cell.BackgroundColor = DarkBlue;
                                                    else
                                                        cell.BackgroundColor = SecondBlue;
                                                    table.AddCell(cell);
                                                }

                                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                Cell.BackgroundColor = DarkBlue;
                                                table.AddCell(Cell);

                                                PdfPCell SiteName1 = new PdfPCell(new Phrase(Entity.Site.Trim(), TableFont));
                                                SiteName1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                SiteName1.Colspan = 7;
                                                SiteName1.Border = iTextSharp.text.Rectangle.BOX;
                                                table.AddCell(SiteName1);

                                                PdfPCell A3 = new PdfPCell(new Phrase(" ", TableFont));
                                                A3.HorizontalAlignment = Element.ALIGN_LEFT;
                                                A3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                A3.BackgroundColor = DarkBlue;
                                                table.AddCell(A3);

                                            }
                                        }

                                        if (First)
                                        {
                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);

                                            PdfPCell SiteName = new PdfPCell(new Phrase(Entity.Site.Trim(), TableFont));
                                            SiteName.HorizontalAlignment = Element.ALIGN_LEFT;
                                            SiteName.Colspan = 7;
                                            SiteName.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(SiteName);

                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);
                                        }

                                        Cell = new PdfPCell(new Phrase(" ", TableFont));
                                        Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Cell.BackgroundColor = DarkBlue;
                                        table.AddCell(Cell);

                                        PdfPCell row1 = new PdfPCell(new Phrase("    " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim(), TableFont));
                                        row1.HorizontalAlignment = Element.ALIGN_LEFT;
                                        row1.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(row1);

                                        CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));

                                        string Enroll = string.Empty; string EnrlCntY = "0";
                                        string EnrlWd = "0"; string EnrlAttn = "0"; string EnrlW30 = "0"; string EnrlFA = "0";
                                        if (selsite != null)
                                        {
                                            PdfPCell tot_fun = new PdfPCell(new Phrase(selsite.SITE_FUNDED_SLOTS.Trim(), TableFont));
                                            tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_fun.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_fun);

                                            if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                            {
                                                List<ENRL_Asof_Entity> Enrols = Count_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM));
                                                List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                                var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                                if (Enrols.Count > 0)
                                                {
                                                    EnrlCntY = enrolled_Count.Count.ToString();
                                                    //EnrlCntY = Enrols.Sum(u => int.Parse(u.Enrolled.Trim())).ToString();
                                                    EnrlWd = Enrols.Sum(u => int.Parse(u.Withdrawn.Trim())).ToString();
                                                    EnrlAttn = Enrols.Sum(u => int.Parse(u.GetAttn1.Trim())).ToString();
                                                    EnrlW30 = Enrols.Sum(u => int.Parse(u.Window30.Trim())).ToString();
                                                    EnrlFA = Enrols.Sum(u => int.Parse(u.FirstTime.Trim())).ToString();
                                                }


                                                if (int.Parse(EnrlCntY) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                    Enroll = EnrlCntY + "*";
                                                else Enroll = EnrlCntY;
                                                FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                            }
                                            else Enroll = Entity.Enrolled;
                                        }
                                        else
                                        {
                                            PdfPCell tot_fun = new PdfPCell(new Phrase("", TableFont));
                                            tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_fun.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_fun);

                                            Enroll = Entity.Enrolled;
                                        }

                                        //DataTable dtenrlRoomcnt = new DataTable();
                                        //if (dtEnroll.Rows.Count > 0)
                                        //{
                                        //    DataView dv = new DataView(dtEnroll);
                                        //    dv.RowFilter = "SITE_NUM=" + "'" + Entity.Site + "'AND ROOM=" + "'" + Entity.Room + "' AND AMPM=" + "'" + Entity.AMPM + "'";
                                        //    dtenrlRoomcnt = dv.ToTable();
                                        //}

                                        PdfPCell tot_enrl = new PdfPCell(new Phrase(Enroll, TableFont));
                                        tot_enrl.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_enrl.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_enrl);

                                        PdfPCell tot_30 = new PdfPCell(new Phrase(EnrlW30, TableFont));
                                        tot_30.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_30.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_30);

                                        PdfPCell tot_W = new PdfPCell(new Phrase(EnrlWd, TableFont));
                                        tot_W.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_W.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_W);

                                        PdfPCell tot_First = new PdfPCell(new Phrase(EnrlFA, TableFont));
                                        tot_First.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_First.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_First);

                                        PdfPCell tot_attn12 = new PdfPCell(new Phrase(EnrlAttn, TableFont));
                                        tot_attn12.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_attn12.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_attn12);

                                        Cell = new PdfPCell(new Phrase(" ", TableFont));
                                        Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Cell.BackgroundColor = DarkBlue;
                                        table.AddCell(Cell);

                                        string FundDesc = string.Empty;
                                        if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                        {
                                            foreach (CommonEntity drFund in propfundingSource)
                                            {
                                                if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                {
                                                    FundDesc = drFund.Desc.ToString().Trim();
                                                    break;
                                                }
                                            }
                                            
                                        }

                                        Cell = new PdfPCell(new Phrase(" ", TableFont));
                                        Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Cell.BackgroundColor = DarkBlue;
                                        table.AddCell(Cell);

                                        PdfPCell row2 = new PdfPCell(new Phrase("       " + FundDesc, TableFont));
                                        row2.HorizontalAlignment = Element.ALIGN_LEFT;
                                        //row2.Colspan = 2;
                                        row2.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(row2);

                                        PdfPCell Fund2 = new PdfPCell(new Phrase(Entity.FundSlots.Trim() == "0" ? "" : Entity.FundSlots.Trim(), TableFont));
                                        Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //row2.Colspan = 2;
                                        Fund2.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(Fund2);

                                        PdfPCell tot_enrl1 = new PdfPCell(new Phrase(Entity.Enrolled, TableFont));
                                        tot_enrl1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_enrl1.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_enrl1);

                                        PdfPCell tot_301 = new PdfPCell(new Phrase(Entity.Window30, TableFont));
                                        tot_301.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_301.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_301);

                                        PdfPCell tot_W1 = new PdfPCell(new Phrase(Entity.Withdrawn, TableFont));
                                        tot_W1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_W1.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_W1);

                                        PdfPCell tot_First1 = new PdfPCell(new Phrase(Entity.FirstTime, TableFont));
                                        tot_First1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_First1.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_First1);

                                        PdfPCell tot_attn121 = new PdfPCell(new Phrase(Entity.GetAttn1, TableFont));
                                        tot_attn121.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_attn121.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_attn121);

                                        Cell = new PdfPCell(new Phrase(" ", TableFont));
                                        Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Cell.BackgroundColor = DarkBlue;
                                        table.AddCell(Cell);

                                        First = false; PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM;
                                        totEnrl_cnt = totEnrl_cnt + int.Parse(EnrlCntY); totWdraw_cnt = totWdraw_cnt + int.Parse(EnrlWd); totAttn1_cnt = totAttn1_cnt + int.Parse(EnrlAttn);
                                        totday30_cnt = totday30_cnt + int.Parse(EnrlW30); totFirstTime_cnt = totFirstTime_cnt + int.Parse(EnrlFA);
                                        if (selsite != null)
                                        {
                                            if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                        }

                                    }
                                    else
                                    {
                                        string Fund = string.Empty;
                                        if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                        {
                                            foreach (CommonEntity drFund in propfundingSource)
                                            {
                                                if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                {
                                                    Fund = drFund.Desc.ToString().Trim();
                                                    break;
                                                }
                                            }

                                            
                                        }

                                        Cell = new PdfPCell(new Phrase(" ", TableFont));
                                        Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Cell.BackgroundColor = DarkBlue;
                                        table.AddCell(Cell);

                                        PdfPCell row2 = new PdfPCell(new Phrase("       " + Fund, TableFont));
                                        row2.HorizontalAlignment = Element.ALIGN_LEFT;
                                        //row2.Colspan = 2;
                                        row2.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(row2);

                                        PdfPCell Fund2 = new PdfPCell(new Phrase(Entity.FundSlots.Trim() == "0" ? "" : Entity.FundSlots.Trim(), TableFont));
                                        Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                        //row2.Colspan = 2;
                                        Fund2.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(Fund2);

                                        PdfPCell tot_enrl1 = new PdfPCell(new Phrase(Entity.Enrolled, TableFont));
                                        tot_enrl1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_enrl1.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_enrl1);

                                        PdfPCell tot_301 = new PdfPCell(new Phrase(Entity.Window30, TableFont));
                                        tot_301.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_301.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_301);

                                        PdfPCell tot_W1 = new PdfPCell(new Phrase(Entity.Withdrawn, TableFont));
                                        tot_W1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_W1.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_W1);

                                        PdfPCell tot_First1 = new PdfPCell(new Phrase(Entity.FirstTime, TableFont));
                                        tot_First1.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_First1.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_First1);

                                        PdfPCell tot_attn121 = new PdfPCell(new Phrase(Entity.GetAttn1, TableFont));
                                        tot_attn121.HorizontalAlignment = Element.ALIGN_CENTER;
                                        tot_attn121.Border = iTextSharp.text.Rectangle.BOX;
                                        table.AddCell(tot_attn121);
                                        PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM;

                                        Cell = new PdfPCell(new Phrase(" ", TableFont));
                                        Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                        Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                        Cell.BackgroundColor = DarkBlue;
                                        table.AddCell(Cell);
                                    }

                                }

                                document.Add(table);
                                table.DeleteBodyRows();

                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                table.AddCell(Cell);

                                PdfPCell Rep111 = new PdfPCell(new Phrase("Total " + PrivSite, TableFont));
                                Rep111.HorizontalAlignment = Element.ALIGN_LEFT;
                                Rep111.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep111);

                                PdfPCell Rep11 = new PdfPCell(new Phrase(TotFunds.ToString(), TableFont));
                                Rep11.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep11.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep11);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                                string totEnroll = string.Empty;
                                if (totEnrl_cnt < TotFunds)
                                    totEnroll = totEnrl_cnt.ToString() + "*";
                                else totEnroll = totEnrl_cnt.ToString();

                                PdfPCell Rep21 = new PdfPCell(new Phrase(totEnroll.ToString(), TableFont));
                                Rep21.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep21.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep21);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                PdfPCell Rep31 = new PdfPCell(new Phrase(totday30_cnt.ToString(), TableFont));
                                Rep31.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep31.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep31);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                PdfPCell Rep41 = new PdfPCell(new Phrase(totWdraw_cnt.ToString(), TableFont));
                                Rep41.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep41.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep41);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                PdfPCell Rep51 = new PdfPCell(new Phrase(totFirstTime_cnt.ToString(), TableFont));
                                Rep51.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep51.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep51);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                PdfPCell Rep61 = new PdfPCell(new Phrase(totAttn1_cnt.ToString(), TableFont));
                                Rep61.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep61.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep61);

                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                table.AddCell(Cell);

                                if (SelFundingList.Count > 0)
                                {
                                    foreach (CommonEntity FundEntity in SelFundingList)
                                    {
                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                        int EnrlCnt = 0; int Wcnt = 0;
                                        if (Fundlistcount.Count > 0)
                                        {
                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                            int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                            //if (EnrlCnt > 0 || Wcnt > 0)
                                            //{

                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);

                                            PdfPCell Fund = new PdfPCell(new Phrase("       " + FundEntity.Desc, TableFont));
                                            Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                            if (FundCnt == 0)
                                                Fund.Colspan = 2;
                                            Fund.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund);


                                            if (FundCnt > 0)
                                            {
                                                PdfPCell Fund8 = new PdfPCell(new Phrase(FundCnt.ToString(), TableFont));
                                                Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                                //Fund.Colspan = 2;
                                                Fund8.Border = iTextSharp.text.Rectangle.BOX;
                                                table.AddCell(Fund8);
                                            }

                                            PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                            Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund1.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund1);

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                            PdfPCell Fund2 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                            Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund2.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund2);

                                            //Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                            PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                            Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund3.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund3);

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                            PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                            Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund4.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund4);

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                            PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                            Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund5.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund5);

                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);

                                            //}
                                        }
                                    }
                                }

                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                table.AddCell(Cell);

                                Cell = new PdfPCell(new Phrase("2024 CAPSystems Inc", TableFontWhite));
                                Cell.HorizontalAlignment = Element.ALIGN_RIGHT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                Cell.Colspan = 7;
                                table.AddCell(Cell);

                                PdfPCell A2 = new PdfPCell(new Phrase(" ", TableFont));
                                A2.HorizontalAlignment = Element.ALIGN_LEFT;
                                A2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                A2.BackgroundColor = DarkBlue;
                                table.AddCell(A2);

                                document.Add(table);
                                table.DeleteBodyRows();

                                document.NewPage();

                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                table.AddCell(Cell);

                                Cell1 = new PdfPCell(new Phrase(" Enrollment Summary ", HeaderTextfnt));
                                Cell1.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell1.BackgroundColor = DarkBlue;
                                Cell1.Colspan = 7;
                                table.AddCell(Cell1);

                                Cell2 = new PdfPCell(new Phrase(" ", TableFont));
                                Cell2.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell2.BackgroundColor = DarkBlue;
                                table.AddCell(Cell2);

                                string[] HeaderSeq2 = {"", "Fund", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" ,""};
                                for (int i = 0; i < HeaderSeq.Length; ++i)
                                {
                                    PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq2[i], TblFontBold));
                                    cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                    //cell.FixedHeight = 15f;
                                    cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    if (i == 0 || i == 8)
                                        cell.BackgroundColor = DarkBlue;
                                    else
                                        cell.BackgroundColor = SecondBlue;
                                    table.AddCell(cell);
                                }

                                int Total_Count1 = 0;

                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                table.AddCell(Cell);

                                PdfPCell Temp = new PdfPCell(new Phrase("Report Totals:", TableFont));
                                Temp.HorizontalAlignment = Element.ALIGN_LEFT;
                                Temp.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Temp);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));
                                if (Total_Count1 > 0)
                                {
                                    PdfPCell Temp1 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                    Temp1.HorizontalAlignment = Element.ALIGN_CENTER;
                                    Temp1.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(Temp1);
                                }
                                else
                                {
                                    PdfPCell Temp1 = new PdfPCell(new Phrase(FundedTotal.ToString(), TableFont));
                                    Temp1.HorizontalAlignment = Element.ALIGN_CENTER;
                                    Temp1.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(Temp1);
                                }


                                List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                                var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                                if (Repenrolled_Count.Count > 0) Total_Count1 = Repenrolled_Count.Count;
                                //Total_Count1 = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                                PdfPCell Temp2 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp2.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp2.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Temp2);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                PdfPCell Temp3 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp3.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp3.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Temp3);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                PdfPCell Temp4 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp4.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp4.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Temp4);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                PdfPCell Temp5 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp5.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp5.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Temp5);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                PdfPCell Temp6 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp6.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp6.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Temp6);

                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                table.AddCell(Cell);

                                if (propfundingSource.Count > 0)
                                {
                                    int Fundcnt = Count_List.Select(t => t.FundHie).Distinct().Count(s => s != "None");
                                    int FCnt = 1;

                                    foreach (CommonEntity FundEntity in propfundingSource)
                                    {
                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                        int EnrlCnt = 0; int Wcnt = 0;
                                        if (Fundlistcount.Count > 0)
                                        {
                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                            int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                            //if (EnrlCnt > 0 || Wcnt > 0)
                                            //{
                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);

                                            PdfPCell Fund = new PdfPCell(new Phrase("       " + FundEntity.Desc, TableFont));
                                            Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                            if (FundCnt == 0)
                                                Fund.Colspan = 2;
                                            Fund.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund);

                                            if (FundCnt > 0)
                                            {
                                                PdfPCell Fund8 = new PdfPCell(new Phrase(FundCnt.ToString(), TableFont));
                                                Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                                //Fund.Colspan = 2;
                                                Fund8.Border = iTextSharp.text.Rectangle.BOX;
                                                table.AddCell(Fund8);
                                            }
                                            //}

                                            PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                            Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund1.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund1);

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                            PdfPCell Fund2 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                            Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund2.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund2);

                                            //Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                            PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                            Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund3.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund3);

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                            PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                            Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund4.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund4);

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                            PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                            Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund5.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund5);

                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);

                                            FCnt++;
                                            //}
                                        }
                                    }
                                }

                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                table.AddCell(Cell);

                                Cell = new PdfPCell(new Phrase("2024 CAPSystems Inc", TableFontWhite));
                                Cell.HorizontalAlignment = Element.ALIGN_RIGHT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                Cell.Colspan = 7;
                                table.AddCell(Cell);

                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                table.AddCell(Cell);

                                document.Add(table);
                            }
                            else if (rbSelected.Checked == true)
                            {
                                foreach (ENRL_Asof_Entity Entity in Count_List)
                                {
                                    CommonEntity FundCode = SelFundingList.Find(u => u.Code.Trim().Equals(Entity.FundHie.Trim()));
                                    if (FundCode != null)
                                    {
                                        if (Entity.Site.Trim() + Entity.Room.Trim() + Entity.AMPM.Trim() != PrivSite + PrivRoom + PrivAmpm)
                                        {
                                            if (!First)
                                            {
                                                if (Entity.Site.Trim() != PrivSite)
                                                {
                                                    //int Total_Count = 0;

                                                    Cell = new PdfPCell(new Phrase(" ", TableFont));
                                                    Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Cell.BackgroundColor = DarkBlue;
                                                    table.AddCell(Cell);

                                                    PdfPCell Rep = new PdfPCell(new Phrase("Total " + PrivSite, TableFont));
                                                    Rep.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Rep.Border = iTextSharp.text.Rectangle.BOX;
                                                    table.AddCell(Rep);

                                                    PdfPCell Rep1 = new PdfPCell(new Phrase(TotFunds.ToString(), TableFont));
                                                    Rep1.HorizontalAlignment = Element.ALIGN_CENTER;
                                                    Rep1.Border = iTextSharp.text.Rectangle.BOX;
                                                    table.AddCell(Rep1);

                                                    //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                                                    string totEnroll1 = string.Empty;
                                                    if (totEnrl_cnt < TotFunds)
                                                        totEnroll1 = totEnrl_cnt.ToString() + "*";
                                                    else totEnroll1 = totEnrl_cnt.ToString();

                                                    PdfPCell Rep2 = new PdfPCell(new Phrase(totEnroll1.ToString(), TableFont));
                                                    Rep2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                    Rep2.Border = iTextSharp.text.Rectangle.BOX;
                                                    table.AddCell(Rep2);

                                                    //Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                                    PdfPCell Rep3 = new PdfPCell(new Phrase(totday30_cnt.ToString(), TableFont));
                                                    Rep3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                    Rep3.Border = iTextSharp.text.Rectangle.BOX;
                                                    table.AddCell(Rep3);

                                                    //Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                                    PdfPCell Rep4 = new PdfPCell(new Phrase(totWdraw_cnt.ToString(), TableFont));
                                                    Rep4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                    Rep4.Border = iTextSharp.text.Rectangle.BOX;
                                                    table.AddCell(Rep4);

                                                    //Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                                    PdfPCell Rep5 = new PdfPCell(new Phrase(totFirstTime_cnt.ToString(), TableFont));
                                                    Rep5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                    Rep5.Border = iTextSharp.text.Rectangle.BOX;
                                                    table.AddCell(Rep5);

                                                    //Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                                    PdfPCell Rep6 = new PdfPCell(new Phrase(totAttn1_cnt.ToString(), TableFont));
                                                    Rep6.HorizontalAlignment = Element.ALIGN_CENTER;
                                                    Rep6.Border = iTextSharp.text.Rectangle.BOX;
                                                    table.AddCell(Rep6);

                                                    Cell = new PdfPCell(new Phrase(" ", TableFont));
                                                    Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Cell.BackgroundColor = DarkBlue;
                                                    table.AddCell(Cell);

                                                    if (SelFundingList.Count > 0)
                                                    {
                                                        int Fundcnt = Count_List.Select(t => t.FundHie).Distinct().Count(s => s != "None");
                                                        int FCnt = 1;
                                                        foreach (CommonEntity FundEntity in SelFundingList)
                                                        {
                                                            List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                                            int EnrlCnt = 0; int Wcnt = 0;
                                                            if (Fundlistcount.Count > 0)
                                                            {
                                                                EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                                                Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                                                int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));

                                                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                Cell.BackgroundColor = DarkBlue;
                                                                table.AddCell(Cell);

                                                                //if (EnrlCnt > 0 || Wcnt > 0)
                                                                //{
                                                                PdfPCell Fund = new PdfPCell(new Phrase("       " + FundEntity.Desc, TableFont));
                                                                Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                if (FundCnt == 0)
                                                                    Fund.Colspan = 2;
                                                                Fund.Border = iTextSharp.text.Rectangle.BOX;
                                                                table.AddCell(Fund);

                                                                
                                                                if (FundCnt > 0)
                                                                {
                                                                    PdfPCell Fund8 = new PdfPCell(new Phrase(FundCnt.ToString(), TableFont));
                                                                    Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                                                    //Fund.Colspan = 2;
                                                                    Fund8.Border = iTextSharp.text.Rectangle.BOX;
                                                                    table.AddCell(Fund8);
                                                                }

                                                                PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                                                Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                                                Fund1.Border = iTextSharp.text.Rectangle.BOX;
                                                                table.AddCell(Fund1);

                                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                                                PdfPCell Window30 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                                Window30.HorizontalAlignment = Element.ALIGN_CENTER;
                                                                Window30.Border = iTextSharp.text.Rectangle.BOX;
                                                                table.AddCell(Window30);

                                                                //Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                                                PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                                                Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                                Fund3.Border = iTextSharp.text.Rectangle.BOX;
                                                                table.AddCell(Fund3);

                                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                                                PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                                Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                                Fund4.Border = iTextSharp.text.Rectangle.BOX;
                                                                table.AddCell(Fund4);

                                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                                                PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                                Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                                Fund5.Border = iTextSharp.text.Rectangle.BOX;
                                                                table.AddCell(Fund5);

                                                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                                Cell.BackgroundColor = DarkBlue;
                                                                table.AddCell(Cell);

                                                                FCnt++;

                                                                //}
                                                            }
                                                        }
                                                    }

                                                    totEnrl_cnt = 0; totWdraw_cnt = 0; totAttn1_cnt = 0;
                                                    totday30_cnt = 0; totFirstTime_cnt = 0; TotFunds = 0;
                                                    if (table.Rows.Count > 1)
                                                    {
                                                        PdfPCell CelllL1 = new PdfPCell(new Phrase(" ", TableFont));
                                                        CelllL1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        CelllL1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        CelllL1.BackgroundColor = DarkBlue;
                                                        table.AddCell(CelllL1);

                                                        PdfPCell CellML1 = new PdfPCell(new Phrase("2024 CAPSystems Inc", TableFontWhite));
                                                        CellML1.HorizontalAlignment = Element.ALIGN_RIGHT;
                                                        CellML1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        CellML1.BackgroundColor = DarkBlue;
                                                        CellML1.Colspan = 7;
                                                        table.AddCell(CellML1);

                                                        PdfPCell CellRL1 = new PdfPCell(new Phrase(" ", TableFont));
                                                        CellRL1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                        CellRL1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        CellRL1.BackgroundColor = DarkBlue;
                                                        table.AddCell(CellRL1);


                                                        document.Add(table);
                                                        table.DeleteBodyRows();
                                                        document.NewPage();


                                                    }

                                                    Cell = new PdfPCell(new Phrase(" ", TableFont));
                                                    Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Cell.BackgroundColor = DarkBlue;
                                                    table.AddCell(Cell);

                                                    Cell = new PdfPCell(new Phrase(" Enrollment Summary ", HeaderTextfnt));
                                                    Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Cell.BackgroundColor = DarkBlue;
                                                    Cell.Colspan = 7;
                                                    table.AddCell(Cell);

                                                    Cell = new PdfPCell(new Phrase(" ", TableFont));
                                                    Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Cell.BackgroundColor = DarkBlue;
                                                    table.AddCell(Cell);


                                                    string[] HeaderSeq3 = { "" ,"Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day","" };
                                                    for (int i = 0; i < HeaderSeq.Length; ++i)
                                                    {
                                                        PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq3[i], TblFontBold));
                                                        cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                                        //cell.FixedHeight = 15f;
                                                        cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                        if (i == 0 || i == 8)
                                                            cell.BackgroundColor = DarkBlue;
                                                        else
                                                            cell.BackgroundColor = SecondBlue;
                                                        table.AddCell(cell);
                                                    }

                                                    Cell = new PdfPCell(new Phrase(" ", TableFont));
                                                    Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Cell.BackgroundColor = DarkBlue;
                                                    table.AddCell(Cell);

                                                    PdfPCell SiteName1 = new PdfPCell(new Phrase(Entity.Site.Trim(), TableFont));
                                                    SiteName1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    SiteName1.Colspan = 7;
                                                    SiteName1.Border = iTextSharp.text.Rectangle.BOX;
                                                    table.AddCell(SiteName1);

                                                    Cell = new PdfPCell(new Phrase(" ", TableFont));
                                                    Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                    Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                    Cell.BackgroundColor = DarkBlue;
                                                    table.AddCell(Cell);
                                                }
                                            }

                                            if (First)
                                            {
                                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                Cell.BackgroundColor = DarkBlue;
                                                table.AddCell(Cell);

                                                PdfPCell SiteName = new PdfPCell(new Phrase(Entity.Site.Trim(), TableFont));
                                                SiteName.HorizontalAlignment = Element.ALIGN_LEFT;
                                                SiteName.Colspan = 7;
                                                SiteName.Border = iTextSharp.text.Rectangle.BOX;
                                                table.AddCell(SiteName);

                                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                Cell.BackgroundColor = DarkBlue;
                                                table.AddCell(Cell);
                                            }

                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);

                                            PdfPCell row1 = new PdfPCell(new Phrase("    " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim(), TableFont));
                                            row1.HorizontalAlignment = Element.ALIGN_LEFT;
                                            row1.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(row1);

                                            CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));
                                            string Enroll = string.Empty; string EnrlCntY = "0";
                                            string EnrlWd = "0"; string EnrlAttn = "0"; string EnrlW30 = "0"; string EnrlFA = "0";
                                            if (selsite != null)
                                            {
                                                PdfPCell tot_fun = new PdfPCell(new Phrase(selsite.SITE_FUNDED_SLOTS.Trim(), TableFont));
                                                tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                                tot_fun.Border = iTextSharp.text.Rectangle.BOX;
                                                table.AddCell(tot_fun);

                                                if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                {

                                                    List<ENRL_Asof_Entity> Enrols = Count_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM));
                                                    List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                                    var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                                    if (Enrols.Count > 0)
                                                    {
                                                        EnrlCntY = enrolled_Count.Count.ToString();
                                                        //EnrlCntY = Enrols.Sum(u => int.Parse(u.Enrolled.Trim())).ToString();
                                                        EnrlWd = Enrols.Sum(u => int.Parse(u.Withdrawn.Trim())).ToString();
                                                        EnrlAttn = Enrols.Sum(u => int.Parse(u.GetAttn1.Trim())).ToString();
                                                        EnrlW30 = Enrols.Sum(u => int.Parse(u.Window30.Trim())).ToString();
                                                        EnrlFA = Enrols.Sum(u => int.Parse(u.FirstTime.Trim())).ToString();
                                                    }


                                                    if (int.Parse(EnrlCntY) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                        Enroll = EnrlCntY + "*";
                                                    else Enroll = EnrlCntY;
                                                    FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                                }
                                                else Enroll = Entity.Enrolled;


                                            }
                                            else
                                            {
                                                PdfPCell tot_fun = new PdfPCell(new Phrase("", TableFont));
                                                tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                                tot_fun.Border = iTextSharp.text.Rectangle.BOX;
                                                table.AddCell(tot_fun);

                                                Enroll = Entity.Enrolled;
                                            }
                                            PdfPCell tot_enrl = new PdfPCell(new Phrase(Enroll, TableFont));
                                            tot_enrl.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_enrl.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_enrl);

                                            PdfPCell tot_30 = new PdfPCell(new Phrase(EnrlW30, TableFont));
                                            tot_30.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_30.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_30);

                                            PdfPCell tot_W = new PdfPCell(new Phrase(EnrlWd, TableFont));
                                            tot_W.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_W.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_W);

                                            PdfPCell tot_First = new PdfPCell(new Phrase(EnrlFA, TableFont));
                                            tot_First.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_First.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_First);

                                            PdfPCell tot_attn12 = new PdfPCell(new Phrase(EnrlAttn, TableFont));
                                            tot_attn12.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_attn12.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_attn12);

                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);

                                            string FundDesc = string.Empty;
                                            if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                            {
                                                foreach (CommonEntity drFund in propfundingSource)
                                                {
                                                    if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                    {
                                                        FundDesc = drFund.Desc.ToString().Trim();
                                                        break;
                                                    }
                                                }

                                            }

                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);

                                            PdfPCell row2 = new PdfPCell(new Phrase("       " + FundDesc, TableFont));
                                            row2.HorizontalAlignment = Element.ALIGN_LEFT;
                                            //row2.Colspan = 2;
                                            row2.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(row2);

                                            PdfPCell Fund2 = new PdfPCell(new Phrase(Entity.FundSlots.Trim() == "0" ? "" : Entity.FundSlots, TableFont));
                                            Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                            //row2.Colspan = 2;
                                            Fund2.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund2);

                                            PdfPCell tot_enrl1 = new PdfPCell(new Phrase(Entity.Enrolled, TableFont));
                                            tot_enrl1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_enrl1.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_enrl1);

                                            PdfPCell tot_301 = new PdfPCell(new Phrase(Entity.Window30, TableFont));
                                            tot_301.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_301.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_301);

                                            PdfPCell tot_W1 = new PdfPCell(new Phrase(Entity.Withdrawn, TableFont));
                                            tot_W1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_W1.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_W1);

                                            PdfPCell tot_First1 = new PdfPCell(new Phrase(Entity.FirstTime, TableFont));
                                            tot_First1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_First1.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_First1);

                                            PdfPCell tot_attn121 = new PdfPCell(new Phrase(Entity.GetAttn1, TableFont));
                                            tot_attn121.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_attn121.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_attn121);

                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);

                                            First = false; PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM;
                                            totEnrl_cnt = totEnrl_cnt + int.Parse(EnrlCntY); totWdraw_cnt = totWdraw_cnt + int.Parse(EnrlWd); totAttn1_cnt = totAttn1_cnt + int.Parse(EnrlAttn);
                                            totday30_cnt = totday30_cnt + int.Parse(EnrlW30); totFirstTime_cnt = totFirstTime_cnt + int.Parse(EnrlFA);
                                            if (selsite != null)
                                            {
                                                if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                    TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                            }

                                        }
                                        else
                                        {
                                            string Fund = string.Empty;
                                            if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                            {
                                                foreach (CommonEntity drFund in propfundingSource)
                                                {
                                                    if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                    {
                                                        Fund = drFund.Desc.ToString().Trim();
                                                        break;
                                                    }
                                                }

                                                
                                            }

                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);

                                            PdfPCell row2 = new PdfPCell(new Phrase("       " + Fund, TableFont));
                                            row2.HorizontalAlignment = Element.ALIGN_LEFT;
                                            //row2.Colspan = 2;
                                            row2.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(row2);

                                            PdfPCell Fund2 = new PdfPCell(new Phrase(Entity.FundSlots.Trim() == "0" ? "" : Entity.FundSlots, TableFont));
                                            Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                            //row2.Colspan = 2;
                                            Fund2.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund2);

                                            PdfPCell tot_enrl1 = new PdfPCell(new Phrase(Entity.Enrolled, TableFont));
                                            tot_enrl1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_enrl1.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_enrl1);

                                            PdfPCell tot_301 = new PdfPCell(new Phrase(Entity.Window30, TableFont));
                                            tot_301.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_301.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_301);

                                            PdfPCell tot_W1 = new PdfPCell(new Phrase(Entity.Withdrawn, TableFont));
                                            tot_W1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_W1.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_W1);

                                            PdfPCell tot_First1 = new PdfPCell(new Phrase(Entity.FirstTime, TableFont));
                                            tot_First1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_First1.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_First1);

                                            PdfPCell tot_attn121 = new PdfPCell(new Phrase(Entity.GetAttn1, TableFont));
                                            tot_attn121.HorizontalAlignment = Element.ALIGN_CENTER;
                                            tot_attn121.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(tot_attn121);

                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);

                                            PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM;
                                        }
                                    }
                                }

                                document.Add(table);
                                table.DeleteBodyRows();

                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                table.AddCell(Cell);

                                PdfPCell Rep111 = new PdfPCell(new Phrase("Total " + PrivSite, TableFont));
                                Rep111.HorizontalAlignment = Element.ALIGN_LEFT;
                                Rep111.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep111);

                                PdfPCell Rep11 = new PdfPCell(new Phrase(TotFunds.ToString(), TableFont));
                                Rep11.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep11.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep11);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                                string totEnroll = string.Empty;
                                if (totEnrl_cnt < TotFunds)
                                    totEnroll = totEnrl_cnt.ToString() + "*";
                                else totEnroll = totEnrl_cnt.ToString();

                                PdfPCell Rep21 = new PdfPCell(new Phrase(totEnroll.ToString(), TableFont));
                                Rep21.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep21.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep21);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                PdfPCell Rep31 = new PdfPCell(new Phrase(totday30_cnt.ToString(), TableFont));
                                Rep31.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep31.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep31);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                PdfPCell Rep41 = new PdfPCell(new Phrase(totWdraw_cnt.ToString(), TableFont));
                                Rep41.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep41.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep41);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                PdfPCell Rep51 = new PdfPCell(new Phrase(totFirstTime_cnt.ToString(), TableFont));
                                Rep51.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep51.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep51);

                                //Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                PdfPCell Rep61 = new PdfPCell(new Phrase(totAttn1_cnt.ToString(), TableFont));
                                Rep61.HorizontalAlignment = Element.ALIGN_CENTER;
                                Rep61.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Rep61);

                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                table.AddCell(Cell);

                                if (SelFundingList.Count > 0)
                                {
                                    int Fundcnt1 = Count_List.Select(t => t.FundHie).Distinct().Count(s => s != "None");
                                    int FCnt = 1;
                                    foreach (CommonEntity FundEntity in SelFundingList)
                                    {
                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                        int EnrlCnt = 0; int Wcnt = 0;
                                        if (Fundlistcount.Count > 0)
                                        {
                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                            int Fundcnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                            //if (EnrlCnt > 0 || Wcnt > 0)
                                            //{

                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);

                                            PdfPCell Fund = new PdfPCell(new Phrase("       " + FundEntity.Desc, TableFont));
                                            Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                            if (Fundcnt == 0)
                                                Fund.Colspan = 2;
                                            Fund.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund);

                                            
                                            if (Fundcnt > 0)
                                            {
                                                PdfPCell Fund8 = new PdfPCell(new Phrase(Fundcnt.ToString(), TableFont));
                                                Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                                //Fund.Colspan = 2;
                                                Fund8.Border = iTextSharp.text.Rectangle.BOX;
                                                table.AddCell(Fund8);
                                            }


                                            PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                            Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund1.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund1);

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                            PdfPCell Fund2 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                            Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund2.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund2);

                                            //Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                            PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                            Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund3.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund3);

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                            PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                            Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund4.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund4);

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                            PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                            Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund5.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund5);

                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);
                                            FCnt++;
                                            //}
                                        }
                                    }
                                }

                                PdfPCell CelllL = new PdfPCell(new Phrase(" ", TableFont));
                                CelllL.HorizontalAlignment = Element.ALIGN_LEFT;
                                CelllL.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                CelllL.BackgroundColor = DarkBlue;
                                table.AddCell(CelllL);

                                PdfPCell CellML = new PdfPCell(new Phrase("2024 CAPSystems Inc", TableFontWhite));
                                CellML.HorizontalAlignment = Element.ALIGN_RIGHT;
                                CellML.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                CellML.BackgroundColor = DarkBlue;
                                CellML.Colspan = 7;
                                table.AddCell(CellML);

                                PdfPCell CellRL = new PdfPCell(new Phrase(" ", TableFont));
                                CellRL.HorizontalAlignment = Element.ALIGN_LEFT;
                                CellRL.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                CellRL.BackgroundColor = DarkBlue;
                                table.AddCell(CellRL);

                                document.Add(table);
                                table.DeleteBodyRows();

                                document.NewPage();

                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                table.AddCell(Cell);

                                Cell = new PdfPCell(new Phrase(" Enrollment Summary ", HeaderTextfnt));
                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                Cell.Colspan = 7;
                                table.AddCell(Cell);

                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                table.AddCell(Cell);

                                string[] HeaderSeq2 = { "","Fund", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day","" };
                                for (int i = 0; i < HeaderSeq.Length; ++i)
                                {
                                    PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq2[i], TblFontBold));
                                    cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                    //cell.FixedHeight = 15f;
                                    cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                    if (i == 0 || i == 8)
                                        cell.BackgroundColor = DarkBlue;
                                    else
                                        cell.BackgroundColor = SecondBlue;
                                    table.AddCell(cell);
                                }

                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                table.AddCell(Cell);

                                int Total_Count1 = 0;
                                PdfPCell Temp7 = new PdfPCell(new Phrase("Report Totals:", TableFont));
                                Temp7.HorizontalAlignment = Element.ALIGN_LEFT;
                                Temp7.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Temp7);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));
                                if (Total_Count1 > 0)
                                {
                                    PdfPCell Temp8 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                    Temp8.HorizontalAlignment = Element.ALIGN_CENTER;
                                    Temp8.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(Temp8);
                                }
                                else
                                {
                                    PdfPCell Temp8 = new PdfPCell(new Phrase(FundedTotal.ToString(), TableFont));
                                    Temp8.HorizontalAlignment = Element.ALIGN_CENTER;
                                    Temp8.Border = iTextSharp.text.Rectangle.BOX;
                                    table.AddCell(Temp8);
                                }


                                List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                                var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                                if (Repenrolled_Count.Count > 0) Total_Count1 = Repenrolled_Count.Count;
                                //Total_Count1 = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                                PdfPCell Temp9 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp9.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp9.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Temp9);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                PdfPCell Temp10 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp10.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp10.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Temp10);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                PdfPCell Temp11 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp11.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp11.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Temp11);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                PdfPCell Temp12 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp12.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp12.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Temp12);

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                PdfPCell Temp13 = new PdfPCell(new Phrase(Total_Count1.ToString(), TableFont));
                                Temp13.HorizontalAlignment = Element.ALIGN_CENTER;
                                Temp13.Border = iTextSharp.text.Rectangle.BOX;
                                table.AddCell(Temp13);

                                Cell = new PdfPCell(new Phrase(" ", TableFont));
                                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                Cell.BackgroundColor = DarkBlue;
                                table.AddCell(Cell);

                                if (SelFundingList.Count > 0)
                                {
                                    foreach (CommonEntity FundEntity in SelFundingList)
                                    {
                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));

                                        //Brain asked to comment this on 04/07/2016
                                        //DataTable dtSum = new DataTable();
                                        //if (dtFundCnt.Rows.Count > 0)
                                        //{
                                        //    DataView dv = new DataView(dtFundCnt);
                                        //    dv.RowFilter = "Fund=" + "'" + FundEntity.Code.Trim() + "'";
                                        //    dtSum = dv.ToTable();
                                        //}


                                        int EnrlCnt = 0; int Wcnt = 0;
                                        if (Fundlistcount.Count > 0)
                                        {
                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                            int Fundcnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));

                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);

                                            //if (EnrlCnt > 0 || Wcnt > 0)
                                            //{
                                            PdfPCell Fund = new PdfPCell(new Phrase("       " + FundEntity.Desc, TableFont));
                                            Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                            if (Fundcnt == 0)
                                                Fund.Colspan = 2;
                                            Fund.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund);

                                            // Brain asked to commend to this on 04/07/2016
                                            //if (dtSum.Rows.Count > 0)
                                            //{
                                            //    object sumObject;
                                            //    sumObject = dtSum.Compute("Sum(Count)", "");
                                            //    PdfPCell Fund8 = new PdfPCell(new Phrase(sumObject.ToString(), TableFont));
                                            //    Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                            //    //Fund.Colspan = 2;
                                            //    Fund8.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            //    table.AddCell(Fund8);
                                            //}
                                            //else
                                            //{
                                            if (Fundcnt > 0)
                                            {
                                                PdfPCell Fund8 = new PdfPCell(new Phrase(Fundcnt.ToString(), TableFont));
                                                Fund8.HorizontalAlignment = Element.ALIGN_CENTER;
                                                //Fund.Colspan = 2;
                                                Fund8.Border = iTextSharp.text.Rectangle.BOX;
                                                table.AddCell(Fund8);
                                            }
                                            //}

                                            PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                            Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund1.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund1);

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                            PdfPCell Fund2 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                            Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund2.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund2);

                                            //Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                            PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                            Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund3.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund3);

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                            PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                            Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund4.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund4);

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                            PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                            Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                            Fund5.Border = iTextSharp.text.Rectangle.BOX;
                                            table.AddCell(Fund5);

                                            Cell = new PdfPCell(new Phrase(" ", TableFont));
                                            Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                                            Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                            Cell.BackgroundColor = DarkBlue;
                                            table.AddCell(Cell);

                                            //}
                                        }
                                    }
                                }

                                CelllL = new PdfPCell(new Phrase(" ", TableFont));
                                CelllL.HorizontalAlignment = Element.ALIGN_LEFT;
                                CelllL.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                CelllL.BackgroundColor = DarkBlue;
                                table.AddCell(CelllL);

                                CellML = new PdfPCell(new Phrase("2024 CAPSystems Inc", TableFontWhite));
                                CellML.HorizontalAlignment = Element.ALIGN_RIGHT;
                                CellML.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                CellML.BackgroundColor = DarkBlue;
                                CellML.Colspan = 7;
                                table.AddCell(CellML);

                                CellRL = new PdfPCell(new Phrase(" ", TableFont));
                                CellRL.HorizontalAlignment = Element.ALIGN_LEFT;
                                CellRL.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                CellRL.BackgroundColor = DarkBlue;
                                table.AddCell(CellRL);


                                document.Add(table);
                            }
                        }
                    }
                }

                catch (Exception ex)
                {
                    document.Add(new Paragraph("Aborted due to Exception............................................... "));
                }

                document.Close();
                fs.Close();
                fs.Dispose();
                AlertBox.Show("Report Generated Successfully");

                if (ENRL_Asof_List.Count > 0)
                    On_DetailFormClosed(NamePdf);

            }
        }

        private void On_DetailFormClosed_old(string PdfName)
        {
            //PdfListForm form = sender as PdfListForm;
            //if (form.DialogResult == DialogResult.OK)
            //{
            StringBuilder strMstApplUpdate = new StringBuilder();
            //string PdfName = "Pdf File";
            PdfName = PdfName.Replace(".pdf", "");

            PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName + "_Detail";
            try
            {
                if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
            }
            catch (Exception ex)
            {
                AlertBox.Show("Error", MessageBoxIcon.Error);
                ex.ToString();
            }


            try
            {
                string Tmpstr = PdfName + ".pdf";
                if (File.Exists(Tmpstr))
                    File.Delete(Tmpstr);
            }
            catch (Exception ex)
            {
                int length = 8;
                string newFileName = System.Guid.NewGuid().ToString();
                newFileName = newFileName.Replace("-", string.Empty);

                Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
            }


            if (!string.IsNullOrEmpty(Random_Filename))
                PdfName = Random_Filename;
            else
                PdfName += ".pdf";

            FileStream fs = new FileStream(PdfName, FileMode.Create);

            Document document = new Document(PageSize.A4, 25, 25, 30, 30);
            
            PdfWriter writer = PdfWriter.GetInstance(document, fs);
            document.Open();
            BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
            iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
            BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
            iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(bf_times, 9, 4);
            BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

            iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 10);
            iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
            iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 9, 3);
            iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(bf_times, 9, 1);
            iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
            iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);
            cb = writer.DirectContent;

            string Year = string.Empty;
            if (CmbYear.Visible == true) Year = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

            string SiteNum = string.Empty;
            if (((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Value.ToString().Trim() != "0") SiteNum = ((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Value.ToString().Trim();

            Base_MainMenu_List = _model.MainMenuData.GetMainMenuSearch("APP", "APP", null, null, null, null, null, null, null, null, null, null, null, null, null, Agency + Depart + Program + (!string.IsNullOrEmpty(Year) ? Year : "    "), null, BaseForm.UserID,string.Empty);

            try
            {
                //PrintHeaderPage(document);
                //document.NewPage();
                Y_Pos = 795;

                PdfPTable tab_detail = new PdfPTable(13);
                tab_detail.TotalWidth = 550f;
                tab_detail.WidthPercentage = 100;
                tab_detail.LockedWidth = true;
                float[] Counttablewidths = new float[] { 40f, 18f, 27f, 30f, 60f, 23f, 25f, 25f, 25f, 25f, 25f,25f,25f };// 30f, 25f, 18f, 18f, 20f, 25f, 30f, 20f, 25f, 18f, 18f, 22f };
                tab_detail.SetWidths(Counttablewidths);
                tab_detail.HorizontalAlignment = Element.ALIGN_LEFT;
                tab_detail.HeaderRows = 2;
                if (rbRoomDetail.Checked == true)
                {
                    CaseSiteEntity Search_Entity = new CaseSiteEntity(true);
                    Search_Entity.SiteAGENCY = Agency;
                    Search_Entity.SiteDEPT = Depart; Search_Entity.SitePROG = Program;
                    if (CmbYear.Visible == true) Search_Entity.SiteYEAR = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                    propCaseAllSiteEntity = _model.CaseMstData.Browse_CASESITE(Search_Entity, "Browse");
                }


                PdfPCell Header = new PdfPCell(new Phrase("Case Activity HSSB1104", TableFont));
                Header.HorizontalAlignment = Element.ALIGN_LEFT;
                Header.Colspan = 13;
                Header.Border = iTextSharp.text.Rectangle.NO_BORDER;
                tab_detail.AddCell(Header);

                string[] HeaderSeq = { "Site/Room/AMPM", "FUND", "App#", "SSN#", "Name", "Enrolled", "Attn 1 Day", "Firsttime", "30 window", "Withdrawn", "Enrl fund","Total Days Enrolled","Total Days Atteneded" };
                for (int i = 0; i < HeaderSeq.Length; ++i)
                {
                    PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                    cell.HorizontalAlignment = Element.ALIGN_CENTER;
                    //cell.FixedHeight = 15f;
                    cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                    tab_detail.AddCell(cell);
                }

                //List<ENRL_Asof_Entity> Selected_List = ENRL_Asof_List.OrderBy(u => u.Site).ThenBy(u => u.Room).ThenBy(u => u.AMPM).ThenBy(u => u.App.Trim()).ThenBy(u => u.FundHie.Trim()).ToList();
                string PrivSite = string.Empty; string PrivRoom = string.Empty; string PrivAmpm = string.Empty;
                //ENRL_Asof_List = ENRL_Asof_List.FindAll(u => !u.App.Equals(""));
                if (ENRL_Asof_List.Count > 0)
                {

                    foreach (ENRL_Asof_Entity Entity in ENRL_Asof_List)
                    {
                        MainMenuEntity selapp_list = Base_MainMenu_List.Find(u => u.AppNo.Trim().Equals(Entity.App.Trim()));
                        if (selapp_list != null)
                        {
                            PdfPCell row1 = new PdfPCell(new Phrase(Entity.Site.Trim() + "/" + Entity.Room.Trim() + "/" + Entity.AMPM.Trim(), TableFont));
                            row1.HorizontalAlignment = Element.ALIGN_LEFT;
                            row1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            tab_detail.AddCell(row1);

                            //PdfPCell row2 = new PdfPCell(new Phrase(Entity.Room.Trim(), TableFont));
                            //row2.HorizontalAlignment = Element.ALIGN_LEFT;
                            //row2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            //tab_detail.AddCell(row2);

                            //PdfPCell row3 = new PdfPCell(new Phrase(Entity.AMPM.Trim(), TableFont));
                            //row3.HorizontalAlignment = Element.ALIGN_LEFT;
                            //row3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            //tab_detail.AddCell(row3);

                            PdfPCell row4 = new PdfPCell(new Phrase(Entity.FundHie.Trim(), TableFont));
                            row4.HorizontalAlignment = Element.ALIGN_LEFT;
                            row4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            tab_detail.AddCell(row4);

                            PdfPCell row20 = new PdfPCell(new Phrase(Entity.App.Trim(), TableFont));
                            row20.HorizontalAlignment = Element.ALIGN_LEFT;
                            row20.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            tab_detail.AddCell(row20);

                            MaskedTextBox mskssn = new MaskedTextBox();
                            mskssn.Mask = "000-00-0000";
                            mskssn.Text = selapp_list.Ssn.Trim();
                            PdfPCell row5 = new PdfPCell(new Phrase(mskssn.Text, TableFont));
                            row5.HorizontalAlignment = Element.ALIGN_LEFT;
                            row5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            tab_detail.AddCell(row5);

                            PdfPCell row6 = new PdfPCell(new Phrase(LookupDataAccess.GetMemberName(selapp_list.Fname, selapp_list.Mname, selapp_list.Lname, "4"), TableFont));
                            row6.HorizontalAlignment = Element.ALIGN_LEFT;
                            row6.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            tab_detail.AddCell(row6);

                            if (Entity.Status == "E")
                            {
                                PdfPCell row7 = new PdfPCell(new Phrase("Yes", TableFont));
                                row7.HorizontalAlignment = Element.ALIGN_LEFT;
                                row7.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                tab_detail.AddCell(row7);
                            }
                            else
                            {
                                PdfPCell row7 = new PdfPCell(new Phrase("No", TableFont));
                                row7.HorizontalAlignment = Element.ALIGN_LEFT;
                                row7.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                tab_detail.AddCell(row7);
                            }

                            if (Entity.GetAttn1.Trim() == "1")
                            {
                                PdfPCell row8 = new PdfPCell(new Phrase("Yes", TableFont));
                                row8.HorizontalAlignment = Element.ALIGN_LEFT;
                                row8.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                tab_detail.AddCell(row8);
                            }
                            else
                            {
                                PdfPCell row8 = new PdfPCell(new Phrase("No", TableFont));
                                row8.HorizontalAlignment = Element.ALIGN_LEFT;
                                row8.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                tab_detail.AddCell(row8);
                            }

                            if (Entity.FirstTime.Trim() == "1")
                            {
                                PdfPCell row9 = new PdfPCell(new Phrase("Yes", TableFont));
                                row9.HorizontalAlignment = Element.ALIGN_LEFT;
                                row9.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                tab_detail.AddCell(row9);
                            }
                            else
                            {
                                PdfPCell row9 = new PdfPCell(new Phrase("No", TableFont));
                                row9.HorizontalAlignment = Element.ALIGN_LEFT;
                                row9.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                tab_detail.AddCell(row9);
                            }

                            if (Entity.Status == "W")
                            {
                                //DateTime Before_Date = Convert.ToDateTime(dtpAsOfDate.Text.ToString()).AddDays(Convert.ToInt32("30"));
                                //DateTime AfterDate = Convert.ToDateTime(dtpAsOfDate.Text.ToString()).AddDays(-30);

                                string Thirtyday = "No";
                                //if (Convert.ToDateTime(Entity.Wdate) >= AfterDate && Convert.ToDateTime(Entity.Wdate) <= Before_Date)
                                //{
                                //    Thirtyday = "Yes";
                                //}

                                if (Entity.Window30.Trim() == "1")
                                    Thirtyday = "Yes";
                                PdfPCell row7 = new PdfPCell(new Phrase(Thirtyday, TableFont));
                                row7.HorizontalAlignment = Element.ALIGN_LEFT;
                                row7.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                tab_detail.AddCell(row7);
                            }
                            else
                            {
                                PdfPCell row7 = new PdfPCell(new Phrase("No", TableFont));
                                row7.HorizontalAlignment = Element.ALIGN_LEFT;
                                row7.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                tab_detail.AddCell(row7);
                            }

                            if (Entity.Status == "W")
                            {
                                PdfPCell row7 = new PdfPCell(new Phrase("Yes", TableFont));
                                row7.HorizontalAlignment = Element.ALIGN_LEFT;
                                row7.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                tab_detail.AddCell(row7);

                            }
                            else
                            {
                                PdfPCell row7 = new PdfPCell(new Phrase("No", TableFont));
                                row7.HorizontalAlignment = Element.ALIGN_LEFT;
                                row7.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                tab_detail.AddCell(row7);
                            }

                            if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                            {
                                PdfPCell row7 = new PdfPCell(new Phrase("Yes", TableFont));
                                row7.HorizontalAlignment = Element.ALIGN_LEFT;
                                row7.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                tab_detail.AddCell(row7);
                            }
                            else
                            {
                                PdfPCell row7 = new PdfPCell(new Phrase("No", TableFont));
                                row7.HorizontalAlignment = Element.ALIGN_LEFT;
                                row7.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                tab_detail.AddCell(row7);
                            }

                            if (Entity.TotEnrlDays.Trim() == "0")
                            {
                                PdfPCell row10 = new PdfPCell(new Phrase("", TableFont));
                                row10.HorizontalAlignment = Element.ALIGN_LEFT;
                                row10.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                tab_detail.AddCell(row10);
                            }
                            else
                            {
                                PdfPCell row10 = new PdfPCell(new Phrase(Entity.TotEnrlDays.Trim(), TableFont));
                                row10.HorizontalAlignment = Element.ALIGN_RIGHT;
                                row10.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                tab_detail.AddCell(row10);
                            }

                            if (Entity.TotEnrlDays.Trim() == "0")
                            {
                                PdfPCell row11 = new PdfPCell(new Phrase("", TableFont));
                                row11.HorizontalAlignment = Element.ALIGN_LEFT;
                                row11.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                tab_detail.AddCell(row11);
                            }
                            else
                            {
                                PdfPCell row11 = new PdfPCell(new Phrase(Entity.TotAttnDays.Trim(), TableFont));
                                row11.HorizontalAlignment = Element.ALIGN_RIGHT;
                                row11.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                tab_detail.AddCell(row11);
                            }
                        }
                    }

                    //document.Add(tab_detail);
                }

                document.Add(tab_detail);

            }

            catch (Exception ex)
            {
                document.Add(new Paragraph("Aborted due to Exception............................................... "));
            }

            document.Close();
            fs.Close();
            fs.Dispose();


            //}
        }

        private void On_DetailFormClosed(string PdfName)
        {
            //PdfListForm form = sender as PdfListForm;
            //if (form.DialogResult == DialogResult.OK)
            //{
            StringBuilder strMstApplUpdate = new StringBuilder();
            //string PdfName = "Pdf File";
            PdfName = PdfName.Replace(".pdf", "");

            PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName + "_Detail";
            try
            {
                if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
            }
            catch (Exception ex)
            {
                AlertBox.Show("Error", MessageBoxIcon.Error);
                ex.ToString();
            }


            try
            {
                string Tmpstr = PdfName + ".pdf";
                if (File.Exists(Tmpstr))
                    File.Delete(Tmpstr);
            }
            catch (Exception ex)
            {
                int length = 8;
                string newFileName = System.Guid.NewGuid().ToString();
                newFileName = newFileName.Replace("-", string.Empty);

                Random_Filename = PdfName + newFileName.Substring(0, length) + ".pdf";
            }


            if (!string.IsNullOrEmpty(Random_Filename))
                PdfName = Random_Filename;
            else
                PdfName += ".pdf";

            FileStream fs = new FileStream(PdfName, FileMode.Create);

            Document document = new Document(PageSize.A4, 25, 25, 30, 30);
            document.SetPageSize(iTextSharp.text.PageSize.A4.Rotate());
            PdfWriter writer = PdfWriter.GetInstance(document, fs);
            document.Open();
            BaseFont bf_times = BaseFont.CreateFont("c:/windows/fonts/TIMES.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
            iTextSharp.text.Font helvetica = new iTextSharp.text.Font(bf_times, 12, 1);
            BaseFont bf_helv = helvetica.GetCalculatedBaseFont(false);
            iTextSharp.text.Font TimesUnderline = new iTextSharp.text.Font(bf_times, 9, 4);
            BaseFont bf_TimesUnderline = TimesUnderline.GetCalculatedBaseFont(true);

            iTextSharp.text.Font Times = new iTextSharp.text.Font(bf_times, 10);
            iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_times, 8);
            iTextSharp.text.Font TableFontBoldItalic = new iTextSharp.text.Font(bf_times, 9, 3);
            iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(bf_times, 9, 1);
            iTextSharp.text.Font TblFontItalic = new iTextSharp.text.Font(bf_times, 8, 2);
            iTextSharp.text.Font Timesline = new iTextSharp.text.Font(bf_times, 9, 4);

            BaseFont bf_calibri = BaseFont.CreateFont("c:/windows/fonts/Calibri.TTF", BaseFont.WINANSI, BaseFont.EMBEDDED);
            iTextSharp.text.Font HeaderTextfnt = new iTextSharp.text.Font(bf_calibri, 12, 2, BaseColor.WHITE);
            iTextSharp.text.Font SubHeadTextfnt = new iTextSharp.text.Font(bf_calibri, 10, 2, new BaseColor(26, 71, 119));

            #region Cell Color Define
            BaseColor DarkBlue = new BaseColor(26, 71, 119);
            BaseColor SecondBlue = new BaseColor(184, 217, 255);
            BaseColor TblHeaderBlue = new BaseColor(155, 194, 230);
            #endregion


            cb = writer.DirectContent;

            string Year = string.Empty;
            if (CmbYear.Visible == true) Year = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

            string SiteNum = string.Empty;
            if (((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Value.ToString().Trim() != "0") SiteNum = ((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Value.ToString().Trim();

            Base_MainMenu_List = _model.MainMenuData.GetMainMenuSearch("APP", "APP", null, null, null, null, null, null, null, null, null, null, null, null, null, Agency + Depart + Program + (!string.IsNullOrEmpty(Year) ? Year : "    "), null, BaseForm.UserID,string.Empty);

            try
            {
                PrintHeaderPage(document, writer);
                document.NewPage();
                Y_Pos = 795;

                PdfPTable tab_detail = new PdfPTable(13);
                tab_detail.TotalWidth = 790f;
                tab_detail.WidthPercentage = 100;
                tab_detail.LockedWidth = true;
                float[] Counttablewidths = new float[] { 40f, 25f, 25f, 30f, 60f, 23f, 25f, 25f, 25f, 25f, 25f, 30f, 30f };// 30f, 25f, 18f, 18f, 20f, 25f, 30f, 20f, 25f, 18f, 18f, 22f };
                tab_detail.SetWidths(Counttablewidths);
                tab_detail.HorizontalAlignment = Element.ALIGN_LEFT;
                tab_detail.HeaderRows = 3;
                if (rbRoomDetail.Checked == true)
                {
                    CaseSiteEntity Search_Entity = new CaseSiteEntity(true);
                    Search_Entity.SiteAGENCY = Agency;
                    Search_Entity.SiteDEPT = Depart; Search_Entity.SitePROG = Program;
                    if (CmbYear.Visible == true) Search_Entity.SiteYEAR = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                    propCaseAllSiteEntity = _model.CaseMstData.Browse_CASESITE(Search_Entity, "Browse");
                }

                PdfPCell Cell = new PdfPCell(new Phrase("Enrollment Summary Details", HeaderTextfnt));
                Cell.HorizontalAlignment = Element.ALIGN_LEFT;
                Cell.Colspan = 13;
                Cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Cell.BackgroundColor = DarkBlue;
                tab_detail.AddCell(Cell);

                PdfPCell Header = new PdfPCell(new Phrase("Case Activity HSSB1104", TableFont));
                Header.HorizontalAlignment = Element.ALIGN_LEFT;
                Header.Colspan = 13;
                Header.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                Header.BackgroundColor = SecondBlue;
                tab_detail.AddCell(Header);

                //SubHeadTextfnt

                string[] HeaderSeq = { "Site/Room/AMPM", "FUND", "App#", "SSN#", "Name", "Enrolled", "Attn 1 Day", "Firsttime", "30 window", "Withdrawn", "Enrl fund", "Total Days Enrolled", "Total Days Atteneded" };
                for (int i = 0; i < HeaderSeq.Length; ++i)
                {
                    PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                    cell.HorizontalAlignment = Element.ALIGN_CENTER;
                    //cell.FixedHeight = 15f;
                    cell.Border = iTextSharp.text.Rectangle.NO_BORDER;
                    cell.BackgroundColor = SecondBlue;
                    tab_detail.AddCell(cell);
                }

                //List<ENRL_Asof_Entity> Selected_List = ENRL_Asof_List.OrderBy(u => u.Site).ThenBy(u => u.Room).ThenBy(u => u.AMPM).ThenBy(u => u.App.Trim()).ThenBy(u => u.FundHie.Trim()).ToList();
                string PrivSite = string.Empty; string PrivRoom = string.Empty; string PrivAmpm = string.Empty;
                //ENRL_Asof_List = ENRL_Asof_List.FindAll(u => !u.App.Equals(""));
                if (ENRL_Asof_List.Count > 0)
                {

                    foreach (ENRL_Asof_Entity Entity in ENRL_Asof_List)
                    {
                        MainMenuEntity selapp_list = Base_MainMenu_List.Find(u => u.AppNo.Trim().Equals(Entity.App.Trim()));
                        if (selapp_list != null)
                        {
                            PdfPCell row1 = new PdfPCell(new Phrase(Entity.Site.Trim() + "/" + Entity.Room.Trim() + "/" + Entity.AMPM.Trim(), TableFont));
                            row1.HorizontalAlignment = Element.ALIGN_LEFT;
                            row1.Border = iTextSharp.text.Rectangle.BOX;
                            tab_detail.AddCell(row1);

                            //PdfPCell row2 = new PdfPCell(new Phrase(Entity.Room.Trim(), TableFont));
                            //row2.HorizontalAlignment = Element.ALIGN_LEFT;
                            //row2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            //tab_detail.AddCell(row2);

                            //PdfPCell row3 = new PdfPCell(new Phrase(Entity.AMPM.Trim(), TableFont));
                            //row3.HorizontalAlignment = Element.ALIGN_LEFT;
                            //row3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            //tab_detail.AddCell(row3);

                            PdfPCell row4 = new PdfPCell(new Phrase(Entity.FundHie.Trim(), TableFont));
                            row4.HorizontalAlignment = Element.ALIGN_LEFT;
                            row4.Border = iTextSharp.text.Rectangle.BOX;
                            tab_detail.AddCell(row4);

                            PdfPCell row20 = new PdfPCell(new Phrase(Entity.App.Trim(), TableFont));
                            row20.HorizontalAlignment = Element.ALIGN_LEFT;
                            row20.Border = iTextSharp.text.Rectangle.BOX;
                            tab_detail.AddCell(row20);

                            MaskedTextBox mskssn = new MaskedTextBox();
                            mskssn.Mask = "000-00-0000";
                            mskssn.Text = selapp_list.Ssn.Trim();
                            PdfPCell row5 = new PdfPCell(new Phrase(mskssn.Text, TableFont));
                            row5.HorizontalAlignment = Element.ALIGN_LEFT;
                            row5.Border = iTextSharp.text.Rectangle.BOX;
                            tab_detail.AddCell(row5);

                            PdfPCell row6 = new PdfPCell(new Phrase(LookupDataAccess.GetMemberName(selapp_list.Fname, selapp_list.Mname, selapp_list.Lname, "4"), TableFont));
                            row6.HorizontalAlignment = Element.ALIGN_LEFT;
                            row6.Border = iTextSharp.text.Rectangle.BOX;
                            tab_detail.AddCell(row6);

                            if (Entity.Status == "E")
                            {
                                PdfPCell row7 = new PdfPCell(new Phrase("Yes", TableFont));
                                row7.HorizontalAlignment = Element.ALIGN_LEFT;
                                row7.Border = iTextSharp.text.Rectangle.BOX;
                                tab_detail.AddCell(row7);
                            }
                            else
                            {
                                PdfPCell row7 = new PdfPCell(new Phrase("No", TableFont));
                                row7.HorizontalAlignment = Element.ALIGN_LEFT;
                                row7.Border = iTextSharp.text.Rectangle.BOX;
                                tab_detail.AddCell(row7);
                            }

                            if (Entity.GetAttn1.Trim() == "1")
                            {
                                PdfPCell row8 = new PdfPCell(new Phrase("Yes", TableFont));
                                row8.HorizontalAlignment = Element.ALIGN_LEFT;
                                row8.Border = iTextSharp.text.Rectangle.BOX;
                                tab_detail.AddCell(row8);
                            }
                            else
                            {
                                PdfPCell row8 = new PdfPCell(new Phrase("No", TableFont));
                                row8.HorizontalAlignment = Element.ALIGN_LEFT;
                                row8.Border = iTextSharp.text.Rectangle.BOX;
                                tab_detail.AddCell(row8);
                            }

                            if (Entity.FirstTime.Trim() == "1")
                            {
                                PdfPCell row9 = new PdfPCell(new Phrase("Yes", TableFont));
                                row9.HorizontalAlignment = Element.ALIGN_LEFT;
                                row9.Border = iTextSharp.text.Rectangle.BOX;
                                tab_detail.AddCell(row9);
                            }
                            else
                            {
                                PdfPCell row9 = new PdfPCell(new Phrase("No", TableFont));
                                row9.HorizontalAlignment = Element.ALIGN_LEFT;
                                row9.Border = iTextSharp.text.Rectangle.BOX;
                                tab_detail.AddCell(row9);
                            }

                            if (Entity.Status == "W")
                            {
                                //DateTime Before_Date = Convert.ToDateTime(dtpAsOfDate.Text.ToString()).AddDays(Convert.ToInt32("30"));
                                //DateTime AfterDate = Convert.ToDateTime(dtpAsOfDate.Text.ToString()).AddDays(-30);

                                string Thirtyday = "No";
                                //if (Convert.ToDateTime(Entity.Wdate) >= AfterDate && Convert.ToDateTime(Entity.Wdate) <= Before_Date)
                                //{
                                //    Thirtyday = "Yes";
                                //}

                                if (Entity.Window30.Trim() == "1")
                                    Thirtyday = "Yes";
                                PdfPCell row7 = new PdfPCell(new Phrase(Thirtyday, TableFont));
                                row7.HorizontalAlignment = Element.ALIGN_LEFT;
                                row7.Border = iTextSharp.text.Rectangle.BOX;
                                tab_detail.AddCell(row7);
                            }
                            else
                            {
                                PdfPCell row7 = new PdfPCell(new Phrase("No", TableFont));
                                row7.HorizontalAlignment = Element.ALIGN_LEFT;
                                row7.Border = iTextSharp.text.Rectangle.BOX;
                                tab_detail.AddCell(row7);
                            }

                            if (Entity.Status == "W")
                            {
                                PdfPCell row7 = new PdfPCell(new Phrase("Yes", TableFont));
                                row7.HorizontalAlignment = Element.ALIGN_LEFT;
                                row7.Border = iTextSharp.text.Rectangle.BOX;
                                tab_detail.AddCell(row7);

                            }
                            else
                            {
                                PdfPCell row7 = new PdfPCell(new Phrase("No", TableFont));
                                row7.HorizontalAlignment = Element.ALIGN_LEFT;
                                row7.Border = iTextSharp.text.Rectangle.BOX;
                                tab_detail.AddCell(row7);
                            }

                            if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                            {
                                PdfPCell row7 = new PdfPCell(new Phrase("Yes", TableFont));
                                row7.HorizontalAlignment = Element.ALIGN_LEFT;
                                row7.Border = iTextSharp.text.Rectangle.BOX;
                                tab_detail.AddCell(row7);
                            }
                            else
                            {
                                PdfPCell row7 = new PdfPCell(new Phrase("No", TableFont));
                                row7.HorizontalAlignment = Element.ALIGN_LEFT;
                                row7.Border = iTextSharp.text.Rectangle.BOX;
                                tab_detail.AddCell(row7);
                            }

                            if (Entity.TotEnrlDays.Trim() == "0")
                            {
                                PdfPCell row10 = new PdfPCell(new Phrase("", TableFont));
                                row10.HorizontalAlignment = Element.ALIGN_LEFT;
                                row10.Border = iTextSharp.text.Rectangle.BOX;
                                tab_detail.AddCell(row10);
                            }
                            else
                            {
                                PdfPCell row10 = new PdfPCell(new Phrase(Entity.TotEnrlDays.Trim(), TableFont));
                                row10.HorizontalAlignment = Element.ALIGN_RIGHT;
                                row10.Border = iTextSharp.text.Rectangle.BOX;
                                tab_detail.AddCell(row10);
                            }

                            if (Entity.TotEnrlDays.Trim() == "0")
                            {
                                PdfPCell row11 = new PdfPCell(new Phrase("", TableFont));
                                row11.HorizontalAlignment = Element.ALIGN_LEFT;
                                row11.Border = iTextSharp.text.Rectangle.BOX;
                                tab_detail.AddCell(row11);
                            }
                            else
                            {
                                PdfPCell row11 = new PdfPCell(new Phrase(Entity.TotAttnDays.Trim(), TableFont));
                                row11.HorizontalAlignment = Element.ALIGN_RIGHT;
                                row11.Border = iTextSharp.text.Rectangle.BOX;
                                tab_detail.AddCell(row11);
                            }
                        }
                    }

                    //document.Add(tab_detail);
                }

                document.Add(tab_detail);

            }

            catch (Exception ex)
            {
                document.Add(new Paragraph("Aborted due to Exception............................................... "));
            }

            document.Close();
            fs.Close();
            fs.Dispose();


            //}
        }


        private void PrintHeaderPage(Document document, PdfWriter writer)
        {
            BaseFont bf_Calibri = BaseFont.CreateFont("c:/windows/fonts/calibri.ttf", BaseFont.WINANSI, BaseFont.EMBEDDED);
            BaseFont bf_TimesRomanI = BaseFont.CreateFont(BaseFont.TIMES_ITALIC, BaseFont.CP1250, false);
            BaseFont bf_Times = BaseFont.CreateFont(BaseFont.TIMES_BOLD, BaseFont.CP1250, false);
            iTextSharp.text.Font fc = new iTextSharp.text.Font(bf_Calibri, 10, 2);
            iTextSharp.text.Font fc1 = new iTextSharp.text.Font(bf_Times, 10, 2, BaseColor.BLUE);
            iTextSharp.text.Font TableFont = new iTextSharp.text.Font(bf_Calibri, 8);
            iTextSharp.text.Font TblFontBold = new iTextSharp.text.Font(bf_Times, 8);
            iTextSharp.text.Font TblFont = new iTextSharp.text.Font(bf_Times, 8);
            iTextSharp.text.Font TblParamsHeaderFont = new iTextSharp.text.Font(bf_Calibri, 11, 1, new BaseColor(System.Drawing.ColorTranslator.FromHtml("#2e5f71")));
            iTextSharp.text.Font TblHeaderTitleFont = new iTextSharp.text.Font(bf_Calibri, 14, 1, new BaseColor(System.Drawing.ColorTranslator.FromHtml("#806000")));
            iTextSharp.text.Font fnttimesRoman_Italic = new iTextSharp.text.Font(bf_TimesRomanI, 9, iTextSharp.text.Font.NORMAL, new BaseColor(System.Drawing.ColorTranslator.FromHtml("#000000")));


            iTextSharp.text.Font reportNameStyle = new iTextSharp.text.Font(bf_Calibri, 12, 1, new BaseColor(System.Drawing.ColorTranslator.FromHtml("#002060")));
            iTextSharp.text.Font xTitleCellstyle2 = new iTextSharp.text.Font(bf_Calibri, 10, 1, new BaseColor(System.Drawing.ColorTranslator.FromHtml("#0070C0")));
            iTextSharp.text.Font xsubTitleintakeCellstyle = new iTextSharp.text.Font(bf_Calibri, 9, 1, new BaseColor(System.Drawing.ColorTranslator.FromHtml("#0070C0")));
            iTextSharp.text.Font paramsCellStyle = new iTextSharp.text.Font(bf_Calibri, 8);

            PdfPTable Headertable = new PdfPTable(5);
            Headertable.TotalWidth = 510f;
            Headertable.WidthPercentage = 100;
            Headertable.LockedWidth = true;
            float[] Headerwidths = new float[] { 30f, 70f,10f,30f,70f };
            Headertable.SetWidths(Headerwidths);
            Headertable.HorizontalAlignment = Element.ALIGN_CENTER;

            //***************** border trails *******************************//
            PdfContentByte content = writer.DirectContent;
            iTextSharp.text.Rectangle rectangle = new iTextSharp.text.Rectangle(document.PageSize);
            rectangle.Left += document.LeftMargin;
            rectangle.Right -= document.RightMargin;
            rectangle.Top -= document.TopMargin;
            rectangle.Bottom += document.BottomMargin;
            content.SetColorStroke(BaseColor.BLACK);
            content.Rectangle(rectangle.Left, rectangle.Bottom, rectangle.Width, rectangle.Height);
            content.Stroke();



            //HierarchyEntity hierarchyDetails = _model.HierarchyAndPrograms.GetCaseHierarchy("AGENCY", BaseForm.BaseAdminAgency, string.Empty, string.Empty, string.Empty, string.Empty);
            //string _strImageFolderPath = "";
            //if (hierarchyDetails != null)
            //{
            //    string LogoName = hierarchyDetails.Logo.ToString();
            //    _strImageFolderPath = _model.lookupDataAccess.GetReportPath() + "\\AgencyLogos\\";
            //    FileInfo info = new FileInfo(_strImageFolderPath + LogoName);
            //    if (info.Exists)
            //        _strImageFolderPath = _model.lookupDataAccess.GetReportPath() + "\\AgencyLogos\\" + LogoName;
            //    else
            //        _strImageFolderPath = "";

            //}

            string strAgy = Current_Hierarchy_DB.Split('-')[0];
            AgencyControlEntity BAgyControlDetails = _model.ZipCodeAndAgency.GetAgencyControlFile(strAgy);
            string ImgName = "";
            if (BaseForm.BaseAgencyControlDetails.AgyShortName == "NEOCAA")
            {
                ImgName = "NEOCAA_" + strAgy + "_LOGO.png";
            }
            else
                ImgName = BaseForm.BaseAgencyControlDetails.AgyShortName + "_00_LOGO.png";//BAgyControlDetails.AgyShortName + "_00_LOGO.png";

            string imagesPath = "https://capsysdev.capsystems.com/images/PIPlogos/" + ImgName;

            if (imagesPath != "")
            {
                iTextSharp.text.Image imgLogo = iTextSharp.text.Image.GetInstance(imagesPath);
                imgLogo.ScaleAbsolute(120f, 50f);
                PdfPCell cellLogo = new PdfPCell(imgLogo);
                cellLogo.HorizontalAlignment = Element.ALIGN_CENTER;
                cellLogo.Rowspan = 2;
                cellLogo.Padding = 3;
                cellLogo.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Headertable.AddCell(cellLogo);
            }


            AgencyControlEntity _agycntrldets = new AgencyControlEntity();
            _agycntrldets = BaseForm.BaseAgencyControlDetails;

            if (BaseForm.BaseAgencyControlDetails.AgyShortName == "NEOCAA")
                _agycntrldets = BAgyControlDetails;
            else
                _agycntrldets = BaseForm.BaseAgencyControlDetails;

            string street = _agycntrldets.Street == "" ? "" : (_agycntrldets.Street + ", ");
            string city = _agycntrldets.City == "" ? "" : (_agycntrldets.City + ", ");
            string state = _agycntrldets.State == "" ? "" : (_agycntrldets.State + ", ");
            string zip1 = _agycntrldets.Zip1 == "" ? "" : _agycntrldets.Zip1.PadLeft(5, '0');
            string strAddress = street + city + state + zip1;


            PdfPCell rowH = new PdfPCell(new Phrase(BAgyControlDetails.AgyName, TblParamsHeaderFont));
            rowH.HorizontalAlignment = Element.ALIGN_CENTER;
            rowH.Colspan = 5;
            //rowH.PaddingBottom = 15;
            rowH.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Headertable.AddCell(rowH);

            PdfPCell row1 = new PdfPCell(new Phrase(strAddress, TblParamsHeaderFont));
            row1.HorizontalAlignment = Element.ALIGN_CENTER;
            row1.Colspan = 4;
            //row1.PaddingBottom = 15;
            row1.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Headertable.AddCell(row1);

            PdfPCell row2 = new PdfPCell(new Phrase(Privileges.PrivilegeName, reportNameStyle));
            row2.HorizontalAlignment = Element.ALIGN_CENTER;
            row2.Colspan = 5;
            row2.PaddingBottom = 8;
            row2.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#CFE6F9"));
            row2.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Headertable.AddCell(row2);


            PdfPCell row3 = new PdfPCell(new Phrase("Report Parameters", xTitleCellstyle2));
            row3.HorizontalAlignment = Element.ALIGN_CENTER;
            row3.Colspan = 5;
            row3.PaddingBottom = 8;
            row3.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#EEF5FC"));
            row3.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Headertable.AddCell(row3);


            string Agy = "All";
            string Dept = "All";
            string Prg = "All";
            string program_year = string.Empty;
            if (Current_Hierarchy.Substring(0, 2) != "**")
                Agy = Current_Hierarchy.Substring(0, 2);
            if (Current_Hierarchy.Substring(2, 2) != "**")
                Dept = Current_Hierarchy.Substring(2, 2);
            if (Current_Hierarchy.Substring(4, 2) != "**")
                Prg = Current_Hierarchy.Substring(4, 2);
            if (CmbYear.Visible == true)
                program_year = "Year: " + ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString();

            if (CmbYear.Visible == true)
            {
                PdfPCell row4 = new PdfPCell(new Phrase(Txt_HieDesc.Text.Trim() + "   " + program_year, xsubTitleintakeCellstyle));
                row4.HorizontalAlignment = Element.ALIGN_CENTER;
                row4.Colspan = 5;
                row4.PaddingBottom = 8;
                row4.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#F8FBFE"));
                row4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Headertable.AddCell(row4);
            }
            else
            {
                PdfPCell row4 = new PdfPCell(new Phrase(Txt_HieDesc.Text.Trim(), xsubTitleintakeCellstyle));
                row4.HorizontalAlignment = Element.ALIGN_CENTER;
                row4.Colspan = 5;
                row4.PaddingBottom = 8;
                row4.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#F8FBFE"));
                row4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Headertable.AddCell(row4);
            }


            PdfPCell rSpace = new PdfPCell(new Phrase(" ", TblHeaderTitleFont));
            rSpace.HorizontalAlignment = Element.ALIGN_CENTER;
            rSpace.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
            rSpace.MinimumHeight = 6;
            rSpace.Colspan = 5;
            rSpace.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Headertable.AddCell(rSpace);


            /*** Prameters Start ***/
            //Row 1
            PdfPCell CH1 = new PdfPCell(new Phrase(lblSite.Text.Trim(), paramsCellStyle));
            CH1.HorizontalAlignment = Element.ALIGN_LEFT;
            CH1.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
            CH1.Border = iTextSharp.text.Rectangle.BOX;
            CH1.PaddingBottom = 5;
            CH1.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#EEF5FC"));
            Headertable.AddCell(CH1);

            string strSites = "All Sites";
            if (((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Text.ToString().Trim() != "****       - All")
            {
                strSites = ((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Text.ToString().Trim();
                string[] ary = strSites.Split('-');
                if (ary.Length > 1)
                {
                    strSites = ary[1];
                }
            }


            PdfPCell CB1 = new PdfPCell(new Phrase(strSites.Trim(), paramsCellStyle));
            CB1.HorizontalAlignment = Element.ALIGN_LEFT;
            CB1.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
            CB1.Border = iTextSharp.text.Rectangle.BOX;
            CB1.PaddingBottom = 5;
            CB1.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#FFFFFF"));
            Headertable.AddCell(CB1);

            PdfPCell CS1 = new PdfPCell(new Phrase("", paramsCellStyle));
            CS1.HorizontalAlignment = Element.ALIGN_LEFT;
            CS1.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
            CS1.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Headertable.AddCell(CS1);

            PdfPCell CH1_2 = new PdfPCell(new Phrase("", paramsCellStyle));
            CH1_2.HorizontalAlignment = Element.ALIGN_LEFT;
            CH1_2.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
            CH1_2.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Headertable.AddCell(CH1_2);

            PdfPCell CB1_2 = new PdfPCell(new Phrase("", paramsCellStyle));
            CB1_2.HorizontalAlignment = Element.ALIGN_LEFT;
            CB1_2.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
            CB1_2.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Headertable.AddCell(CB1_2);


            //Row 2
            PdfPCell CH2 = new PdfPCell(new Phrase(lblReportType.Text.Trim(), paramsCellStyle));
            CH2.HorizontalAlignment = Element.ALIGN_LEFT;
            CH2.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
            CH2.Border = iTextSharp.text.Rectangle.BOX;
            CH2.PaddingBottom = 5;
            CH2.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#EEF5FC"));
            Headertable.AddCell(CH2);

            string Report_Type = rbSiteSummary.Checked == true ? rbSiteSummary.Text.Trim() : (rbRoomDetail.Checked == true ? rbRoomDetail.Text.Trim() : rbFundDetailByRoom.Text.Trim());
            PdfPCell CB2 = new PdfPCell(new Phrase(Report_Type, paramsCellStyle));
            CB2.HorizontalAlignment = Element.ALIGN_LEFT;
            CB2.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
            CB2.Border = iTextSharp.text.Rectangle.BOX;
            CB2.PaddingBottom = 5;
            CB2.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#FFFFFF"));
            Headertable.AddCell(CB2);

            PdfPCell CS2 = new PdfPCell(new Phrase("", paramsCellStyle));
            CS2.HorizontalAlignment = Element.ALIGN_LEFT;
            CS2.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
            CS2.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Headertable.AddCell(CS2);

            PdfPCell CH2_2 = new PdfPCell(new Phrase("", paramsCellStyle));
            CH2_2.HorizontalAlignment = Element.ALIGN_LEFT;
            CH2_2.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
            CH2_2.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Headertable.AddCell(CH2_2);

            PdfPCell CB2_2 = new PdfPCell(new Phrase("", paramsCellStyle));
            CB2_2.HorizontalAlignment = Element.ALIGN_LEFT;
            CB2_2.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
            CB2_2.Border = iTextSharp.text.Rectangle.NO_BORDER;
            Headertable.AddCell(CB2_2);


            if (rbFundDetailByRoom.Checked == true)
            {
                string Fund = string.Empty;
                if (rbAll.Checked)
                    Fund = rbAll.Text.Trim() + " Funds";
                else
                {
                    string New_Fund_Str = "";
                    foreach (CommonEntity FundingCode in SelFundingList)
                        New_Fund_Str += FundingCode.Code + ", ";

                    if (New_Fund_Str.Length > 2)
                        New_Fund_Str = New_Fund_Str.Substring(0, New_Fund_Str.Length - 2);

                    Fund = New_Fund_Str;
                }

                //Row 3
                PdfPCell CH3 = new PdfPCell(new Phrase(lblFundingSource.Text.Trim(), paramsCellStyle));
                CH3.HorizontalAlignment = Element.ALIGN_LEFT;
                CH3.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
                CH3.Border = iTextSharp.text.Rectangle.BOX;
                CH3.PaddingBottom = 5;
                CH3.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#EEF5FC"));
                Headertable.AddCell(CH3);

                PdfPCell CB3 = new PdfPCell(new Phrase(Fund, paramsCellStyle));
                CB3.HorizontalAlignment = Element.ALIGN_LEFT;
                CB3.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
                CB3.Border = iTextSharp.text.Rectangle.BOX;
                CB3.PaddingBottom = 5;
                CB3.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#FFFFFF"));
                Headertable.AddCell(CB3);

                PdfPCell CS3 = new PdfPCell(new Phrase("", paramsCellStyle));
                CS3.HorizontalAlignment = Element.ALIGN_LEFT;
                CS3.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
                CS3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Headertable.AddCell(CS3);

                PdfPCell CH3_2 = new PdfPCell(new Phrase("", paramsCellStyle));
                CH3_2.HorizontalAlignment = Element.ALIGN_LEFT;
                CH3_2.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
                CH3_2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Headertable.AddCell(CH3_2);

                PdfPCell CB3_2 = new PdfPCell(new Phrase("", paramsCellStyle));
                CB3_2.HorizontalAlignment = Element.ALIGN_LEFT;
                CB3_2.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
                CB3_2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Headertable.AddCell(CB3_2);
            }
            if (dtpAsOfDate.Checked)
            {
                //Row 3
                PdfPCell CH3 = new PdfPCell(new Phrase(lblAsOfDate.Text.Trim(), paramsCellStyle));
                CH3.HorizontalAlignment = Element.ALIGN_LEFT;
                CH3.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
                CH3.Border = iTextSharp.text.Rectangle.BOX;
                CH3.PaddingBottom = 5;
                CH3.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#EEF5FC"));
                Headertable.AddCell(CH3);

                PdfPCell CB3 = new PdfPCell(new Phrase(dtpAsOfDate.Text, paramsCellStyle));
                CB3.HorizontalAlignment = Element.ALIGN_LEFT;
                CB3.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
                CB3.Border = iTextSharp.text.Rectangle.BOX;
                CB3.PaddingBottom = 5;
                CB3.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#FFFFFF"));
                Headertable.AddCell(CB3);

                PdfPCell CS3 = new PdfPCell(new Phrase("", paramsCellStyle));
                CS3.HorizontalAlignment = Element.ALIGN_LEFT;
                CS3.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
                CS3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Headertable.AddCell(CS3);

                PdfPCell CH3_2 = new PdfPCell(new Phrase("", paramsCellStyle));
                CH3_2.HorizontalAlignment = Element.ALIGN_LEFT;
                CH3_2.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
                CH3_2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Headertable.AddCell(CH3_2);

                PdfPCell CB3_2 = new PdfPCell(new Phrase("", paramsCellStyle));
                CB3_2.HorizontalAlignment = Element.ALIGN_LEFT;
                CB3_2.VerticalAlignment = PdfPCell.ALIGN_MIDDLE;
                CB3_2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                Headertable.AddCell(CB3_2);
            }
                //string Agy = /*"Agency : */"All"; string Dept = /*"Dept : */"All"; string Prg = /*"Program : */"All"; string Header_year = string.Empty;
                //if (Agency != "**") Agy = /*"Agency : " +*/ Agency;
                //if (Depart != "**") Dept = /*"Dept : " + */Depart;
                //if (Program != "**") Prg = /*"Program : " +*/ Program;
                //if (CmbYear.Visible == true)
                //    Header_year = "Year: " + ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString();

                //if (CmbYear.Visible == true)
                //{
                //    PdfPCell Hierarchy = new PdfPCell(new Phrase("  " + "Hierarchy", TableFont));
                //    Hierarchy.HorizontalAlignment = Element.ALIGN_LEFT;
                //    Hierarchy.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                //    Hierarchy.BorderColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#FFFFFF"));
                //    Hierarchy.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#F2F2F2"));
                //    Hierarchy.PaddingBottom = 5;
                //    Headertable.AddCell(Hierarchy);

                //    PdfPCell Hierarchy1 = new PdfPCell(new Phrase(Txt_HieDesc.Text.Trim() + "   " + Header_year, TableFont));
                //    Hierarchy1.HorizontalAlignment = Element.ALIGN_LEFT;
                //    Hierarchy1.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                //    Hierarchy1.BorderColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#FFFFFF"));
                //    Hierarchy1.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#fbfbfb"));
                //    Hierarchy1.PaddingBottom = 5;
                //    Headertable.AddCell(Hierarchy1);
                //}
                //else
                //{
                //    PdfPCell Hierarchy = new PdfPCell(new Phrase("  " + "Hierarchy", TableFont));
                //    Hierarchy.HorizontalAlignment = Element.ALIGN_LEFT;
                //    Hierarchy.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                //    Hierarchy.BorderColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#FFFFFF"));
                //    Hierarchy.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#F2F2F2"));
                //    Hierarchy.PaddingBottom = 5;
                //    Headertable.AddCell(Hierarchy);

                //    PdfPCell Hierarchy1 = new PdfPCell(new Phrase(Txt_HieDesc.Text.Trim(), TableFont));
                //    Hierarchy1.HorizontalAlignment = Element.ALIGN_LEFT;
                //    Hierarchy1.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                //    Hierarchy1.BorderColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#FFFFFF"));
                //    Hierarchy1.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#fbfbfb"));
                //    Hierarchy1.PaddingBottom = 5;
                //    Headertable.AddCell(Hierarchy1);
                //}

                //PdfPCell R1 = new PdfPCell(new Phrase("  " + "Site" /*+ ((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Text.Trim()*/, TableFont));
                //R1.HorizontalAlignment = Element.ALIGN_LEFT;
                //R1.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                //R1.BorderColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#FFFFFF"));
                //R1.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#F2F2F2"));
                //R1.PaddingBottom = 5;
                //Headertable.AddCell(R1);

                //PdfPCell R11 = new PdfPCell(new Phrase(((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).DefaultValue.Trim(), TableFont));
                //R11.HorizontalAlignment = Element.ALIGN_LEFT;
                //R11.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                //R11.BorderColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#FFFFFF"));
                //R11.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#fbfbfb"));
                //R11.PaddingBottom = 5;
                //Headertable.AddCell(R11);

                //string Type = rbSiteSummary.Checked == true ? rbSiteSummary.Text.Trim() : (rbRoomDetail.Checked == true ? rbRoomDetail.Text.Trim() : rbFundDetailByRoom.Text.Trim());

                //PdfPCell R2 = new PdfPCell(new Phrase("  " + "Report Type" /*+ Type*/, TableFont));
                //R2.HorizontalAlignment = Element.ALIGN_LEFT;
                //R2.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                //R2.BorderColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#FFFFFF"));
                //R2.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#F2F2F2"));
                //R2.PaddingBottom = 5;
                //Headertable.AddCell(R2);

                //PdfPCell R22 = new PdfPCell(new Phrase(Type, TableFont));
                //R22.HorizontalAlignment = Element.ALIGN_LEFT;
                //R22.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                //R22.BorderColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#FFFFFF"));
                //R22.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#fbfbfb"));
                //R22.PaddingBottom = 5;
                //Headertable.AddCell(R22);

                //if (rbFundDetailByRoom.Checked == true)
                //{
                //    string Fund = string.Empty;
                //    if (rbAll.Checked) //if (rbSelected.Checked == true)
                //        Fund = /*lblFundingSource.Text.Trim() + " : " +*/ rbAll.Text.Trim() + " Funds";
                //    else
                //    {
                //        string New_Fund_Str = "";
                //        foreach (CommonEntity FundingCode in SelFundingList)
                //                New_Fund_Str += FundingCode.Code + ", ";

                //        if (New_Fund_Str.Length > 2)
                //            New_Fund_Str = New_Fund_Str.Substring(0, New_Fund_Str.Length - 2);

                //        Fund = "Selected Funds: " + New_Fund_Str;
                //    }

                //    PdfPCell R10 = new PdfPCell(new Phrase("  " + "Funding Source", TableFont));
                //    R10.HorizontalAlignment = Element.ALIGN_LEFT;
                //    R10.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                //    R10.BorderColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#FFFFFF"));
                //    R10.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#F2F2F2"));
                //    R10.PaddingBottom = 5;
                //    Headertable.AddCell(R10);

                //    PdfPCell R101 = new PdfPCell(new Phrase(Fund, TableFont));
                //    R101.HorizontalAlignment = Element.ALIGN_LEFT;
                //    R101.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                //    R101.BorderColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#FFFFFF"));
                //    R101.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#fbfbfb"));
                //    R101.PaddingBottom = 5;
                //    Headertable.AddCell(R101);
                //}


                //PdfPCell R3 = new PdfPCell(new Phrase("  " + "As Of Date" /*+ dtpAsOfDate.Value.ToShortDateString()*/, TableFont));
                //R3.HorizontalAlignment = Element.ALIGN_LEFT;
                //R3.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                //R3.BorderColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#FFFFFF"));
                //R3.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#F2F2F2"));
                //R3.PaddingBottom = 5;
                //Headertable.AddCell(R3);

                //PdfPCell R33 = new PdfPCell(new Phrase(dtpAsOfDate.Value.ToShortDateString(), TableFont));
                //R33.HorizontalAlignment = Element.ALIGN_LEFT;
                //R33.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                //R33.BorderColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#FFFFFF"));
                //R33.BackgroundColor = new BaseColor(System.Drawing.ColorTranslator.FromHtml("#fbfbfb"));
                //R33.PaddingBottom = 5;
                //Headertable.AddCell(R33);

                document.Add(Headertable);
            ColumnText.ShowTextAligned(writer.DirectContent, Element.ALIGN_LEFT, new Phrase("Generated By : ", fnttimesRoman_Italic), 33, 40, 0);
            ColumnText.ShowTextAligned(writer.DirectContent, Element.ALIGN_LEFT, new Phrase(LookupDataAccess.GetMemberName(BaseForm.UserProfile.FirstName.Trim(), BaseForm.UserProfile.MI.Trim(), BaseForm.UserProfile.LastName.Trim(), "3"), fnttimesRoman_Italic), 90, 40, 0);
            ColumnText.ShowTextAligned(writer.DirectContent, Element.ALIGN_LEFT, new Phrase("Generated On : ", fnttimesRoman_Italic), 410, 40, 0);
            ColumnText.ShowTextAligned(writer.DirectContent, Element.ALIGN_LEFT, new Phrase(DateTime.Now.ToString(), fnttimesRoman_Italic), 468, 40, 0);

        }

        private string GetModuleDesc()
        {
            string ModuleDesc = null;
            DataSet ds = Captain.DatabaseLayer.Lookups.GetModules();
            DataTable dt = ds.Tables[0];
            foreach (DataRow dr in dt.Rows)
            {
                if (dr["APPL_CODE"].ToString() == Privileges.ModuleCode)
                {
                    ModuleDesc = dr["APPL_DESCRIPTION"].ToString(); break;
                }
            }
            return ModuleDesc;
        }

        #endregion


        #region ExcelReportFormat

        #region Converted to Carlos by Vikash on 06/22/2023 for adding Params page
        private void GenerateStyles(WorksheetStyleCollection styles)
        {
            // -----------------------------------------------
            //  Default
            // -----------------------------------------------
            WorksheetStyle Default = styles.Add("Default");
            Default.Name = "Normal";
            Default.Font.FontName = "Arial";
            Default.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  s16
            // -----------------------------------------------
            WorksheetStyle s16 = styles.Add("s16");
            s16.Font.Bold = true;
            s16.Font.FontName = "Calibri Light";
            s16.Font.Size = 16;
            s16.Interior.Color = "#DDEBF7";
            s16.Interior.Pattern = StyleInteriorPattern.Solid;
            s16.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s16.Alignment.Vertical = StyleVerticalAlignment.Center;
            // -----------------------------------------------
            //  s17
            // -----------------------------------------------
            WorksheetStyle s17 = styles.Add("s17");
            s17.Font.Bold = true;
            s17.Font.FontName = "Calibri Light";
            s17.Font.Size = 16;
            s17.Interior.Color = "#DDEBF7";
            s17.Interior.Pattern = StyleInteriorPattern.Solid;
            s17.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s17.Alignment.Vertical = StyleVerticalAlignment.Center;
            // -----------------------------------------------
            //  s18
            // -----------------------------------------------
            WorksheetStyle s18 = styles.Add("s18");
            s18.Interior.Color = "#DDEBF7";
            s18.Interior.Pattern = StyleInteriorPattern.Solid;
            s18.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s18.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  s19
            // -----------------------------------------------
            WorksheetStyle s19 = styles.Add("s19");
            s19.Interior.Color = "#DDEBF7";
            s19.Interior.Pattern = StyleInteriorPattern.Solid;
            // -----------------------------------------------
            //  s20
            // -----------------------------------------------
            WorksheetStyle s20 = styles.Add("s20");
            s20.Interior.Color = "#DDEBF7";
            s20.Interior.Pattern = StyleInteriorPattern.Solid;
            s20.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s20.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  s21
            // -----------------------------------------------
            WorksheetStyle s21 = styles.Add("s21");
            s21.Font.Bold = true;
            s21.Font.FontName = "Calibri";
            s21.Font.Size = 11;
            s21.Font.Color = "#000000";
            s21.Interior.Color = "#FCE4D6";
            s21.Interior.Pattern = StyleInteriorPattern.Solid;
            s21.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s21.Alignment.Vertical = StyleVerticalAlignment.Center;
            s21.Alignment.WrapText = true;
            s21.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            s21.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s21.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s21.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s21.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s22
            // -----------------------------------------------
            WorksheetStyle s22 = styles.Add("s22");
            s22.Font.Bold = true;
            s22.Font.FontName = "Calibri";
            s22.Font.Size = 11;
            s22.Font.Color = "#000000";
            s22.Interior.Color = "#FCE4D6";
            s22.Interior.Pattern = StyleInteriorPattern.Solid;
            s22.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s22.Alignment.Vertical = StyleVerticalAlignment.Center;
            s22.Alignment.WrapText = true;
            s22.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            s22.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s22.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s22.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s22.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s23
            // -----------------------------------------------
            WorksheetStyle s23 = styles.Add("s23");
            s23.Font.Bold = true;
            s23.Font.FontName = "Calibri";
            s23.Font.Size = 11;
            // -----------------------------------------------
            //  s24
            // -----------------------------------------------
            WorksheetStyle s24 = styles.Add("s24");
            s24.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s24.Alignment.Vertical = StyleVerticalAlignment.Center;
            s24.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s24.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s24.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s24.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s25
            // -----------------------------------------------
            WorksheetStyle s25 = styles.Add("s25");
            s25.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s25.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s25.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s25.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s25.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s25.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s26
            // -----------------------------------------------
            WorksheetStyle s26 = styles.Add("s26");
            s26.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s26.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s26.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s26.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s27
            // -----------------------------------------------
            WorksheetStyle s27 = styles.Add("s27");
            s27.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s27.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s27.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s27.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s27.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s27.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            s27.NumberFormat = "General Date";
            // -----------------------------------------------
            //  s28
            // -----------------------------------------------
            WorksheetStyle s28 = styles.Add("s28");
            s28.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s28.Alignment.Vertical = StyleVerticalAlignment.Center;
            s28.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s28.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s28.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s28.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            s28.NumberFormat = "General Date";
            // -----------------------------------------------
            //  s29
            // -----------------------------------------------
            WorksheetStyle s29 = styles.Add("s29");
            s29.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s29.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s29.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s29.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s29.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s29.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s30
            // -----------------------------------------------
            WorksheetStyle s30 = styles.Add("s30");
            s30.Font.FontName = "Arial";
            s30.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s30.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            s30.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s30.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s30.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s30.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s31
            // -----------------------------------------------
            WorksheetStyle s31 = styles.Add("s31");
            s31.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s31.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  s32
            // -----------------------------------------------
            WorksheetStyle s32 = styles.Add("s32");
            s32.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s32.Alignment.Vertical = StyleVerticalAlignment.Center;
            // -----------------------------------------------
            //  s33
            // -----------------------------------------------
            WorksheetStyle s33 = styles.Add("s33");
            s33.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s33.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  s34
            // -----------------------------------------------
            WorksheetStyle s34 = styles.Add("s34");
            s34.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s34.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  s35
            // -----------------------------------------------
            WorksheetStyle s35 = styles.Add("s35");
            // -----------------------------------------------
            //  s36
            // -----------------------------------------------
            WorksheetStyle s36 = styles.Add("s36");
            s36.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s36.Alignment.Vertical = StyleVerticalAlignment.Center;
            // -----------------------------------------------
            //  s37
            // -----------------------------------------------
            WorksheetStyle s37 = styles.Add("s37");
            s37.Font.FontName = "Arial";
            s37.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s37.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  s38
            // -----------------------------------------------
            WorksheetStyle s38 = styles.Add("s38");
            s38.Font.FontName = "Arial";
            s38.Font.Color = "#000000";
            s38.Interior.Color = "#FFFFFF";
            s38.Interior.Pattern = StyleInteriorPattern.Solid;
            s38.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s38.Alignment.Vertical = StyleVerticalAlignment.Center;
            s38.Alignment.WrapText = true;
            s38.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s39
            // -----------------------------------------------
            WorksheetStyle s39 = styles.Add("s39");
            s39.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s39.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  s40
            // -----------------------------------------------
            WorksheetStyle s40 = styles.Add("s40");
            s40.Font.FontName = "Arial";
            s40.Font.Color = "#000000";
            s40.Interior.Color = "#FFFFFF";
            s40.Interior.Pattern = StyleInteriorPattern.Solid;
            s40.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s40.Alignment.Vertical = StyleVerticalAlignment.Center;
            s40.Alignment.WrapText = true;
            s40.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            s40.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s40.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s40.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s40.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s41
            // -----------------------------------------------
            WorksheetStyle s41 = styles.Add("s41");
            s41.Alignment.Horizontal = StyleHorizontalAlignment.Right;
            s41.Alignment.Vertical = StyleVerticalAlignment.Center;
            s41.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s41.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s41.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s41.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);

            // -----------------------------------------------
            //  m386123900
            // -----------------------------------------------
            WorksheetStyle m386123900 = styles.Add("m386123900");
            m386123900.Font.FontName = "Calibri";
            m386123900.Font.Size = 12;
            m386123900.Font.Color = "#000000";
            m386123900.Interior.Color = "#F2DCDB";
            m386123900.Interior.Pattern = StyleInteriorPattern.Solid;
            m386123900.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m386123900.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            m386123900.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m386123900.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m386123900.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m386123900.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m386123920
            // -----------------------------------------------
            WorksheetStyle m386123920 = styles.Add("m386123920");
            m386123920.Font.Bold = true;
            m386123920.Font.FontName = "Calibri";
            m386123920.Font.Size = 11;
            m386123920.Font.Color = "#000000";
            m386123920.Interior.Color = "#DCE6F1";
            m386123920.Interior.Pattern = StyleInteriorPattern.Solid;
            m386123920.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            m386123920.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            m386123920.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            m386123920.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m386123920.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m386123920.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  m386123940
            // -----------------------------------------------
            WorksheetStyle m386123940 = styles.Add("m386123940");
            m386123940.Font.Bold = true;
            m386123940.Font.FontName = "Calibri";
            m386123940.Font.Size = 12;
            m386123940.Font.Color = "#000000";
            m386123940.Interior.Color = "#FCD5B4";
            m386123940.Interior.Pattern = StyleInteriorPattern.Solid;
            m386123940.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            m386123940.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            m386123940.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            m386123940.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            m386123940.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  s45
            // -----------------------------------------------
            WorksheetStyle s45 = styles.Add("s45");
            s45.Font.Bold = true;
            s45.Font.FontName = "Calibri";
            s45.Font.Size = 11;
            s45.Font.Color = "#000000";
            s45.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s45.Alignment.Vertical = StyleVerticalAlignment.Top;
            s45.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s45.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s45.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s46
            // -----------------------------------------------
            WorksheetStyle s46 = styles.Add("s46");
            s46.Font.Bold = true;
            s46.Font.FontName = "Calibri";
            s46.Font.Size = 11;
            s46.Font.Color = "#000000";
            s46.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s46.Alignment.Vertical = StyleVerticalAlignment.Center;
            s46.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s46.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s46.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  s53
            // -----------------------------------------------
            WorksheetStyle s53 = styles.Add("s53");
            s53.Font.Bold = true;
            s53.Font.FontName = "Calibri";
            s53.Font.Size = 11;
            s53.Font.Color = "#000000";
            s53.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s53.Alignment.Vertical = StyleVerticalAlignment.Top;
            s53.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s53.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s53.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s53.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  s54
            // -----------------------------------------------
            WorksheetStyle s54 = styles.Add("s54");
            s54.Font.Bold = true;
            s54.Font.FontName = "Calibri";
            s54.Font.Size = 11;
            s54.Font.Color = "#000000";
            s54.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s54.Alignment.Vertical = StyleVerticalAlignment.Top;
            s54.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s54.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s54.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s54.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  s55
            // -----------------------------------------------
            WorksheetStyle s55 = styles.Add("s55");
            s55.Font.Bold = true;
            s55.Font.FontName = "Calibri";
            s55.Font.Size = 11;
            s55.Font.Color = "#000000";
            s55.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s55.Alignment.Vertical = StyleVerticalAlignment.Top;
            s55.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s55.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s55.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s55.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 2);
            // -----------------------------------------------
            //  s56
            // -----------------------------------------------
            WorksheetStyle s56 = styles.Add("s56");
            s56.Alignment.Vertical = StyleVerticalAlignment.Center;
            s56.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s56.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s56.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s56.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s57
            // -----------------------------------------------
            WorksheetStyle s57 = styles.Add("s57");
            s57.Alignment.Vertical = StyleVerticalAlignment.Center;
            s57.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s57.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s57.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s57.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s58
            // -----------------------------------------------
            WorksheetStyle s58 = styles.Add("s58");
            s58.Alignment.Vertical = StyleVerticalAlignment.Center;
            s58.Alignment.WrapText = true;
            s58.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s58.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s58.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s58.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s59
            // -----------------------------------------------
            WorksheetStyle s59 = styles.Add("s59");
            s59.Alignment.Vertical = StyleVerticalAlignment.Center;
            s59.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s59.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s59.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s59.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s60
            // -----------------------------------------------
            WorksheetStyle s60 = styles.Add("s60");
            s60.Alignment.Vertical = StyleVerticalAlignment.Center;
            s60.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s60.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s60.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 2);
            s60.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s61
            // -----------------------------------------------
            WorksheetStyle s61 = styles.Add("s61");
            s61.Font.Bold = true;
            s61.Font.FontName = "Calibri";
            s61.Font.Size = 11;
            s61.Font.Color = "#000000";
            s61.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s61.Alignment.Vertical = StyleVerticalAlignment.Center;
            s61.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s61.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s61.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s62
            // -----------------------------------------------
            WorksheetStyle s62 = styles.Add("s62");
            s62.Font.Bold = true;
            s62.Font.FontName = "Calibri";
            s62.Font.Size = 11;
            s62.Font.Color = "#000000";
            s62.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s62.Alignment.Vertical = StyleVerticalAlignment.Center;
            s62.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s62.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s62.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s63
            // -----------------------------------------------
            WorksheetStyle s63 = styles.Add("s63");
            s63.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s63.Alignment.Vertical = StyleVerticalAlignment.Center;
            s63.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s63.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s63.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s63.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s64
            // -----------------------------------------------
            WorksheetStyle s64 = styles.Add("s64");
            s64.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s64.Alignment.Vertical = StyleVerticalAlignment.Center;
            s64.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1);
            s64.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s64.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s64.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s65
            // -----------------------------------------------
            WorksheetStyle s65 = styles.Add("s65");
            s65.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s65.Alignment.Vertical = StyleVerticalAlignment.Center;
            s65.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s65.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 2);
            s65.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s65.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s66
            // -----------------------------------------------
            WorksheetStyle s66 = styles.Add("s66");
            s66.Alignment.Horizontal = StyleHorizontalAlignment.Center;
            s66.Alignment.Vertical = StyleVerticalAlignment.Center;
            s66.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 2);
            s66.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1);
            s66.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1);
            s66.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1);
            // -----------------------------------------------
            //  s67
            // -----------------------------------------------
            WorksheetStyle s67 = styles.Add("s67");
            s67.Font.Bold = true;
            s67.Font.FontName = "Calibri";
            s67.Font.Size = 16;
            s67.Font.Color = "#000000";
            s67.Alignment.Horizontal = StyleHorizontalAlignment.Left;
            s67.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  s137
            // -----------------------------------------------
            WorksheetStyle s137 = styles.Add("s137");
            s137.Name = "Normal 3";
            s137.Font.FontName = "Calibri";
            s137.Font.Size = 11;
            s137.Font.Color = "#000000";
            s137.Alignment.Vertical = StyleVerticalAlignment.Bottom;
            // -----------------------------------------------
            //  m2611536909264
            // -----------------------------------------------
            WorksheetStyle m2611536909264 = styles.Add("m2611536909264");
            m2611536909264.Parent = "s137";
            m2611536909264.Font.FontName = "Arial";
            m2611536909264.Font.Color = "#9400D3";
            m2611536909264.Interior.Color = "#FFFFFF";
            m2611536909264.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611536909264.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611536909264.Alignment.WrapText = true;
            m2611536909264.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611536909264.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611536909284
            // -----------------------------------------------
            WorksheetStyle m2611536909284 = styles.Add("m2611536909284");
            m2611536909284.Parent = "s137";
            m2611536909284.Font.FontName = "Arial";
            m2611536909284.Font.Color = "#9400D3";
            m2611536909284.Interior.Color = "#FFFFFF";
            m2611536909284.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611536909284.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611536909284.Alignment.WrapText = true;
            m2611536909284.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611536909284.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611536909304
            // -----------------------------------------------
            WorksheetStyle m2611536909304 = styles.Add("m2611536909304");
            m2611536909304.Parent = "s137";
            m2611536909304.Font.FontName = "Arial";
            m2611536909304.Font.Color = "#9400D3";
            m2611536909304.Interior.Color = "#FFFFFF";
            m2611536909304.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611536909304.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611536909304.Alignment.WrapText = true;
            m2611536909304.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611536909304.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611536909324
            // -----------------------------------------------
            WorksheetStyle m2611536909324 = styles.Add("m2611536909324");
            m2611536909324.Parent = "s137";
            m2611536909324.Font.FontName = "Arial";
            m2611536909324.Font.Color = "#9400D3";
            m2611536909324.Interior.Color = "#FFFFFF";
            m2611536909324.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611536909324.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611536909324.Alignment.WrapText = true;
            m2611536909324.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611536909324.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611536909344
            // -----------------------------------------------
            WorksheetStyle m2611536909344 = styles.Add("m2611536909344");
            m2611536909344.Parent = "s137";
            m2611536909344.Font.FontName = "Arial";
            m2611536909344.Font.Color = "#9400D3";
            m2611536909344.Interior.Color = "#FFFFFF";
            m2611536909344.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611536909344.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611536909344.Alignment.WrapText = true;
            m2611536909344.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611536909344.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611540549552
            // -----------------------------------------------
            WorksheetStyle m2611540549552 = styles.Add("m2611540549552");
            m2611540549552.Parent = "s137";
            m2611540549552.Font.FontName = "Arial";
            m2611540549552.Font.Color = "#9400D3";
            m2611540549552.Interior.Color = "#FFFFFF";
            m2611540549552.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611540549552.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611540549552.Alignment.WrapText = true;
            m2611540549552.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611540549552.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611540549572
            // -----------------------------------------------
            WorksheetStyle m2611540549572 = styles.Add("m2611540549572");
            m2611540549572.Parent = "s137";
            m2611540549572.Font.FontName = "Arial";
            m2611540549572.Font.Color = "#9400D3";
            m2611540549572.Interior.Color = "#FFFFFF";
            m2611540549572.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611540549572.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611540549572.Alignment.WrapText = true;
            m2611540549572.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611540549572.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#000000");
            m2611540549572.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611540549592
            // -----------------------------------------------
            WorksheetStyle m2611540549592 = styles.Add("m2611540549592");
            m2611540549592.Parent = "s137";
            m2611540549592.Font.FontName = "Arial";
            m2611540549592.Font.Color = "#9400D3";
            m2611540549592.Interior.Color = "#FFFFFF";
            m2611540549592.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611540549592.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611540549592.Alignment.WrapText = true;
            m2611540549592.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611540549592.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611540549612
            // -----------------------------------------------
            WorksheetStyle m2611540549612 = styles.Add("m2611540549612");
            m2611540549612.Parent = "s137";
            m2611540549612.Font.FontName = "Arial";
            m2611540549612.Font.Color = "#9400D3";
            m2611540549612.Interior.Color = "#FFFFFF";
            m2611540549612.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611540549612.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611540549612.Alignment.WrapText = true;
            m2611540549612.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611540549612.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611540549632
            // -----------------------------------------------
            WorksheetStyle m2611540549632 = styles.Add("m2611540549632");
            m2611540549632.Parent = "s137";
            m2611540549632.Font.FontName = "Arial";
            m2611540549632.Font.Color = "#9400D3";
            m2611540549632.Interior.Color = "#FFFFFF";
            m2611540549632.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611540549632.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611540549632.Alignment.WrapText = true;
            m2611540549632.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611540549632.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611540549652
            // -----------------------------------------------
            WorksheetStyle m2611540549652 = styles.Add("m2611540549652");
            m2611540549652.Parent = "s137";
            m2611540549652.Font.FontName = "Arial";
            m2611540549652.Font.Color = "#9400D3";
            m2611540549652.Interior.Color = "#FFFFFF";
            m2611540549652.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611540549652.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611540549652.Alignment.WrapText = true;
            m2611540549652.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611540549652.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  m2611540549672
            // -----------------------------------------------
            WorksheetStyle m2611540549672 = styles.Add("m2611540549672");
            m2611540549672.Parent = "s137";
            m2611540549672.Font.FontName = "Arial";
            m2611540549672.Font.Color = "#9400D3";
            m2611540549672.Interior.Color = "#FFFFFF";
            m2611540549672.Interior.Pattern = StyleInteriorPattern.Solid;
            m2611540549672.Alignment.Vertical = StyleVerticalAlignment.Top;
            m2611540549672.Alignment.WrapText = true;
            m2611540549672.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            m2611540549672.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");

            // -----------------------------------------------
            //  s139
            // -----------------------------------------------
            WorksheetStyle s139 = styles.Add("s139");
            s139.Parent = "s137";
            s139.Font.FontName = "Calibri";
            s139.Font.Size = 11;
            s139.Interior.Color = "#FFFFFF";
            s139.Interior.Pattern = StyleInteriorPattern.Solid;
            s139.Alignment.Vertical = StyleVerticalAlignment.Top;
            s139.Alignment.WrapText = true;
            // -----------------------------------------------
            //  s140
            // -----------------------------------------------
            WorksheetStyle s140 = styles.Add("s140");
            s140.Parent = "s137";
            s140.Font.FontName = "Calibri";
            s140.Font.Size = 11;
            s140.Interior.Color = "#FFFFFF";
            s140.Interior.Pattern = StyleInteriorPattern.Solid;
            s140.Alignment.Vertical = StyleVerticalAlignment.Top;
            s140.Alignment.WrapText = true;
            s140.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#000000");
            s140.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s141
            // -----------------------------------------------
            WorksheetStyle s141 = styles.Add("s141");
            s141.Parent = "s137";
            s141.Font.FontName = "Calibri";
            s141.Font.Size = 11;
            s141.Interior.Color = "#FFFFFF";
            s141.Interior.Pattern = StyleInteriorPattern.Solid;
            s141.Alignment.Vertical = StyleVerticalAlignment.Top;
            s141.Alignment.WrapText = true;
            s141.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s142
            // -----------------------------------------------
            WorksheetStyle s142 = styles.Add("s142");
            s142.Parent = "s137";
            s142.Font.FontName = "Calibri";
            s142.Font.Size = 11;
            s142.Interior.Color = "#FFFFFF";
            s142.Interior.Pattern = StyleInteriorPattern.Solid;
            s142.Alignment.Vertical = StyleVerticalAlignment.Top;
            s142.Alignment.WrapText = true;
            s142.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            s142.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s143
            // -----------------------------------------------
            WorksheetStyle s143 = styles.Add("s143");
            s143.Parent = "s137";
            s143.Font.FontName = "Calibri";
            s143.Font.Size = 11;
            s143.Interior.Color = "#FFFFFF";
            s143.Interior.Pattern = StyleInteriorPattern.Solid;
            s143.Alignment.Vertical = StyleVerticalAlignment.Top;
            s143.Alignment.WrapText = true;
            s143.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s144
            // -----------------------------------------------
            WorksheetStyle s144 = styles.Add("s144");
            s144.Parent = "s137";
            s144.Font.FontName = "Arial";
            s144.Font.Color = "#9400D3";
            s144.Interior.Color = "#FFFFFF";
            s144.Interior.Pattern = StyleInteriorPattern.Solid;
            s144.Alignment.Vertical = StyleVerticalAlignment.Top;
            s144.Alignment.WrapText = true;
            s144.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s145
            // -----------------------------------------------
            WorksheetStyle s145 = styles.Add("s145");
            s145.Parent = "s137";
            s145.Font.FontName = "Calibri";
            s145.Font.Size = 11;
            s145.Interior.Color = "#FFFFFF";
            s145.Interior.Pattern = StyleInteriorPattern.Solid;
            s145.Alignment.Vertical = StyleVerticalAlignment.Top;
            s145.Alignment.WrapText = true;
            s145.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s146
            // -----------------------------------------------
            WorksheetStyle s146 = styles.Add("s146");
            s146.Parent = "s137";
            s146.Font.FontName = "Calibri";
            s146.Font.Size = 11;
            s146.Interior.Color = "#FFFFFF";
            s146.Interior.Pattern = StyleInteriorPattern.Solid;
            s146.Alignment.Vertical = StyleVerticalAlignment.Top;
            s146.Alignment.WrapText = true;
            s146.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#000000");
            s146.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s169
            // -----------------------------------------------
            WorksheetStyle s169 = styles.Add("s169");
            s169.Parent = "s137";
            s169.Font.FontName = "Arial";
            s169.Font.Color = "#9400D3";
            s169.Interior.Color = "#FFFFFF";
            s169.Interior.Pattern = StyleInteriorPattern.Solid;
            s169.Alignment.Vertical = StyleVerticalAlignment.Top;
            s169.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
            // -----------------------------------------------
            //  s170
            // -----------------------------------------------
            WorksheetStyle s170 = styles.Add("s170");
            s170.Parent = "s137";
            s170.Font.FontName = "Calibri";
            s170.Font.Size = 11;
            s170.Interior.Color = "#FFFFFF";
            s170.Interior.Pattern = StyleInteriorPattern.Solid;
            s170.Alignment.Vertical = StyleVerticalAlignment.Top;
            // -----------------------------------------------
            //  s171
            // -----------------------------------------------
            WorksheetStyle s171 = styles.Add("s171");
            s171.Parent = "s137";
            s171.Font.FontName = "Calibri";
            s171.Font.Size = 11;
            s171.Interior.Color = "#FFFFFF";
            s171.Interior.Pattern = StyleInteriorPattern.Solid;
            s171.Alignment.Vertical = StyleVerticalAlignment.Top;
            s171.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
            // -----------------------------------------------
            //  s172
            // -----------------------------------------------
            WorksheetStyle s172 = styles.Add("s172");
            s172.Alignment.Vertical = StyleVerticalAlignment.Bottom;
        }

        private void On_SaveExcelClosed(object sender, FormClosedEventArgs e)
        {
            PdfListForm form = sender as PdfListForm;

            if (form.DialogResult == DialogResult.OK)
            {
                string PdfName = "Pdf File";
                PdfName = form.GetFileName();
                //PdfName = strFolderPath + PdfName;
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                try
                {
                    if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                    { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
                }
                catch (Exception ex)
                {
                    AlertBox.Show("Error", MessageBoxIcon.Error);
                }


                try
                {
                    string Tmpstr = PdfName + ".xls";
                    if (File.Exists(Tmpstr))
                        File.Delete(Tmpstr);
                }
                catch (Exception ex)
                {
                    int length = 8;
                    string newFileName = System.Guid.NewGuid().ToString();
                    newFileName = newFileName.Replace("-", string.Empty);

                    Random_Filename = PdfName + newFileName.Substring(0, length) + ".xls";
                }


                if (!string.IsNullOrEmpty(Random_Filename))
                    PdfName = Random_Filename;
                else
                    PdfName += ".xls";

                WorksheetRow excelrowHeader; WorksheetRow excelrowSpace; WorksheetRow excelrowSpace1; WorksheetRow excelrow;
                WorksheetRow excelrow1; WorksheetRow excelrow2; WorksheetRow excelrow3; WorksheetRow excelrow4; WorksheetRow excelrow5; WorksheetRow excelrow6; WorksheetRow excelrow7; WorksheetRow excelrow8;
                WorksheetRow excelrow9; WorksheetRow excelrow10; WorksheetRow excelrow11; WorksheetRow excelrow12; WorksheetRow excelrow13; WorksheetRow excelrow14; WorksheetRow excelrow15; WorksheetRow excelrow16;
                WorksheetRow excelrow17; WorksheetRow excelrow18; WorksheetRow excelrow19; WorksheetRow excelrow20; WorksheetRow excelrow21; WorksheetRow excelrow22; WorksheetRow excelrow23; WorksheetRow excelrow24;
                WorksheetRow excelrow25; WorksheetRow excelrow26; WorksheetRow excelrow27; WorksheetRow excelrow28; WorksheetRow excelrow29; WorksheetRow excelrow30; WorksheetRow excelrow31; WorksheetRow excelrow32;
                WorksheetRow excelrow33; WorksheetRow excelrow34; WorksheetRow excelrow35; WorksheetRow excelrow36; WorksheetRow excelrow37; WorksheetRow excelrow38; WorksheetRow excelrow39; WorksheetRow excelrow40;
                WorksheetRow excelrow41; WorksheetRow excelrow42; WorksheetRow excelrow43; WorksheetRow excelrow44; WorksheetRow excelrow45; WorksheetRow excelrow46; WorksheetRow excelrow47; WorksheetRow excelrow48;
                WorksheetRow excelrow49; WorksheetRow excelrow50; WorksheetRow excelrow51; WorksheetRow excelrow52; WorksheetRow excelrow53; WorksheetRow excelrow54; WorksheetRow excelrow55; WorksheetRow excelrow56;
                WorksheetRow excelrow57; WorksheetRow excelrow58;
                WorksheetCell cell;

                Workbook book = new Workbook();

                Worksheet sheet = book.Worksheets.Add("Parameters");

                #region Header Page
                WorksheetColumn columnHead = sheet.Table.Columns.Add();
                columnHead.Index = 2;
                columnHead.Width = 5;
                sheet.Table.Columns.Add(163);
                WorksheetColumn column2Head = sheet.Table.Columns.Add();
                column2Head.Width = 370;//332;
                column2Head.StyleID = "s172";
                sheet.Table.Columns.Add(100);//(59);
                                             //  s137
                                             // -----------------------------------------------
                WorksheetStyle s137 = book.Styles.Add("s137");
                s137.Name = "Normal 3";
                s137.Font.FontName = "Calibri";
                s137.Font.Size = 11;
                s137.Font.Color = "#000000";
                s137.Alignment.Vertical = StyleVerticalAlignment.Bottom;
                // -----------------------------------------------
                //  m2611536909264
                // -----------------------------------------------
                WorksheetStyle m2611536909264 = book.Styles.Add("m2611536909264");
                m2611536909264.Parent = "s137";
                m2611536909264.Font.FontName = "Arial";
                m2611536909264.Font.Color = "#9400D3";
                m2611536909264.Interior.Color = "#FFFFFF";
                m2611536909264.Interior.Pattern = StyleInteriorPattern.Solid;
                m2611536909264.Alignment.Vertical = StyleVerticalAlignment.Top;
                m2611536909264.Alignment.WrapText = true;
                m2611536909264.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
                m2611536909264.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  m2611536909284
                // -----------------------------------------------
                WorksheetStyle m2611536909284 = book.Styles.Add("m2611536909284");
                m2611536909284.Parent = "s137";
                m2611536909284.Font.FontName = "Arial";
                m2611536909284.Font.Color = "#9400D3";
                m2611536909284.Interior.Color = "#FFFFFF";
                m2611536909284.Interior.Pattern = StyleInteriorPattern.Solid;
                m2611536909284.Alignment.Vertical = StyleVerticalAlignment.Top;
                m2611536909284.Alignment.WrapText = true;
                m2611536909284.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
                m2611536909284.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  m2611536909304
                // -----------------------------------------------
                WorksheetStyle m2611536909304 = book.Styles.Add("m2611536909304");
                m2611536909304.Parent = "s137";
                m2611536909304.Font.FontName = "Arial";
                m2611536909304.Font.Color = "#9400D3";
                m2611536909304.Interior.Color = "#FFFFFF";
                m2611536909304.Interior.Pattern = StyleInteriorPattern.Solid;
                m2611536909304.Alignment.Vertical = StyleVerticalAlignment.Top;
                m2611536909304.Alignment.WrapText = true;
                m2611536909304.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
                m2611536909304.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  m2611536909324
                // -----------------------------------------------
                WorksheetStyle m2611536909324 = book.Styles.Add("m2611536909324");
                m2611536909324.Parent = "s137";
                m2611536909324.Font.FontName = "Arial";
                m2611536909324.Font.Color = "#9400D3";
                m2611536909324.Interior.Color = "#FFFFFF";
                m2611536909324.Interior.Pattern = StyleInteriorPattern.Solid;
                m2611536909324.Alignment.Vertical = StyleVerticalAlignment.Top;
                m2611536909324.Alignment.WrapText = true;
                m2611536909324.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
                m2611536909324.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  m2611536909344
                // -----------------------------------------------
                WorksheetStyle m2611536909344 = book.Styles.Add("m2611536909344");
                m2611536909344.Parent = "s137";
                m2611536909344.Font.FontName = "Arial";
                m2611536909344.Font.Color = "#9400D3";
                m2611536909344.Interior.Color = "#FFFFFF";
                m2611536909344.Interior.Pattern = StyleInteriorPattern.Solid;
                m2611536909344.Alignment.Vertical = StyleVerticalAlignment.Top;
                m2611536909344.Alignment.WrapText = true;
                m2611536909344.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
                m2611536909344.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  m2611540549552
                // -----------------------------------------------
                WorksheetStyle m2611540549552 = book.Styles.Add("m2611540549552");
                m2611540549552.Parent = "s137";
                m2611540549552.Font.FontName = "Arial";
                m2611540549552.Font.Color = "#9400D3";
                m2611540549552.Interior.Color = "#FFFFFF";
                m2611540549552.Interior.Pattern = StyleInteriorPattern.Solid;
                m2611540549552.Alignment.Vertical = StyleVerticalAlignment.Top;
                m2611540549552.Alignment.WrapText = true;
                m2611540549552.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
                m2611540549552.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  m2611540549572
                // -----------------------------------------------
                WorksheetStyle m2611540549572 = book.Styles.Add("m2611540549572");
                m2611540549572.Parent = "s137";
                m2611540549572.Font.FontName = "Arial";
                m2611540549572.Font.Color = "#9400D3";
                m2611540549572.Interior.Color = "#FFFFFF";
                m2611540549572.Interior.Pattern = StyleInteriorPattern.Solid;
                m2611540549572.Alignment.Vertical = StyleVerticalAlignment.Top;
                m2611540549572.Alignment.WrapText = true;
                m2611540549572.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
                m2611540549572.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#000000");
                m2611540549572.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  m2611540549592
                // -----------------------------------------------
                WorksheetStyle m2611540549592 = book.Styles.Add("m2611540549592");
                m2611540549592.Parent = "s137";
                m2611540549592.Font.FontName = "Arial";
                m2611540549592.Font.Color = "#9400D3";
                m2611540549592.Interior.Color = "#FFFFFF";
                m2611540549592.Interior.Pattern = StyleInteriorPattern.Solid;
                m2611540549592.Alignment.Vertical = StyleVerticalAlignment.Top;
                m2611540549592.Alignment.WrapText = true;
                m2611540549592.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
                m2611540549592.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  m2611540549612
                // -----------------------------------------------
                WorksheetStyle m2611540549612 = book.Styles.Add("m2611540549612");
                m2611540549612.Parent = "s137";
                m2611540549612.Font.FontName = "Arial";
                m2611540549612.Font.Color = "#9400D3";
                m2611540549612.Interior.Color = "#FFFFFF";
                m2611540549612.Interior.Pattern = StyleInteriorPattern.Solid;
                m2611540549612.Alignment.Vertical = StyleVerticalAlignment.Top;
                m2611540549612.Alignment.WrapText = true;
                m2611540549612.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
                m2611540549612.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  m2611540549632
                // -----------------------------------------------
                WorksheetStyle m2611540549632 = book.Styles.Add("m2611540549632");
                m2611540549632.Parent = "s137";
                m2611540549632.Font.FontName = "Arial";
                m2611540549632.Font.Color = "#9400D3";
                m2611540549632.Interior.Color = "#FFFFFF";
                m2611540549632.Interior.Pattern = StyleInteriorPattern.Solid;
                m2611540549632.Alignment.Vertical = StyleVerticalAlignment.Top;
                m2611540549632.Alignment.WrapText = true;
                m2611540549632.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
                m2611540549632.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  m2611540549652
                // -----------------------------------------------
                WorksheetStyle m2611540549652 = book.Styles.Add("m2611540549652");
                m2611540549652.Parent = "s137";
                m2611540549652.Font.FontName = "Arial";
                m2611540549652.Font.Color = "#9400D3";
                m2611540549652.Interior.Color = "#FFFFFF";
                m2611540549652.Interior.Pattern = StyleInteriorPattern.Solid;
                m2611540549652.Alignment.Vertical = StyleVerticalAlignment.Top;
                m2611540549652.Alignment.WrapText = true;
                m2611540549652.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
                m2611540549652.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  m2611540549672
                // -----------------------------------------------
                WorksheetStyle m2611540549672 = book.Styles.Add("m2611540549672");
                m2611540549672.Parent = "s137";
                m2611540549672.Font.FontName = "Arial";
                m2611540549672.Font.Color = "#9400D3";
                m2611540549672.Interior.Color = "#FFFFFF";
                m2611540549672.Interior.Pattern = StyleInteriorPattern.Solid;
                m2611540549672.Alignment.Vertical = StyleVerticalAlignment.Top;
                m2611540549672.Alignment.WrapText = true;
                m2611540549672.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
                m2611540549672.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  s139
                // -----------------------------------------------
                WorksheetStyle s139 = book.Styles.Add("s139");
                s139.Parent = "s137";
                s139.Font.FontName = "Calibri";
                s139.Font.Size = 11;
                s139.Interior.Color = "#FFFFFF";
                s139.Interior.Pattern = StyleInteriorPattern.Solid;
                s139.Alignment.Vertical = StyleVerticalAlignment.Top;
                s139.Alignment.WrapText = true;
                // -----------------------------------------------
                //  s140
                // -----------------------------------------------
                WorksheetStyle s140 = book.Styles.Add("s140");
                s140.Parent = "s137";
                s140.Font.FontName = "Calibri";
                s140.Font.Size = 11;
                s140.Interior.Color = "#FFFFFF";
                s140.Interior.Pattern = StyleInteriorPattern.Solid;
                s140.Alignment.Vertical = StyleVerticalAlignment.Top;
                s140.Alignment.WrapText = true;
                s140.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#000000");
                s140.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  s141
                // -----------------------------------------------
                WorksheetStyle s141 = book.Styles.Add("s141");
                s141.Parent = "s137";
                s141.Font.FontName = "Calibri";
                s141.Font.Size = 11;
                s141.Interior.Color = "#FFFFFF";
                s141.Interior.Pattern = StyleInteriorPattern.Solid;
                s141.Alignment.Vertical = StyleVerticalAlignment.Top;
                s141.Alignment.WrapText = true;
                s141.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  s142
                // -----------------------------------------------
                WorksheetStyle s142 = book.Styles.Add("s142");
                s142.Parent = "s137";
                s142.Font.FontName = "Calibri";
                s142.Font.Size = 11;
                s142.Interior.Color = "#FFFFFF";
                s142.Interior.Pattern = StyleInteriorPattern.Solid;
                s142.Alignment.Vertical = StyleVerticalAlignment.Top;
                s142.Alignment.WrapText = true;
                s142.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
                s142.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  s143
                // -----------------------------------------------
                WorksheetStyle s143 = book.Styles.Add("s143");
                s143.Parent = "s137";
                s143.Font.FontName = "Calibri";
                s143.Font.Size = 11;
                s143.Interior.Color = "#FFFFFF";
                s143.Interior.Pattern = StyleInteriorPattern.Solid;
                s143.Alignment.Vertical = StyleVerticalAlignment.Top;
                s143.Alignment.WrapText = true;
                s143.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  s144
                // -----------------------------------------------
                WorksheetStyle s144 = book.Styles.Add("s144");
                s144.Parent = "s137";
                s144.Font.FontName = "Arial";
                s144.Font.Color = "#9400D3";
                s144.Interior.Color = "#FFFFFF";
                s144.Interior.Pattern = StyleInteriorPattern.Solid;
                s144.Alignment.Vertical = StyleVerticalAlignment.Top;
                s144.Alignment.WrapText = true;
                s144.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
                // -----------------------------------------------
                //  s145
                // -----------------------------------------------
                WorksheetStyle s145 = book.Styles.Add("s145");
                s145.Parent = "s137";
                s145.Font.FontName = "Calibri";
                s145.Font.Size = 11;
                s145.Interior.Color = "#FFFFFF";
                s145.Interior.Pattern = StyleInteriorPattern.Solid;
                s145.Alignment.Vertical = StyleVerticalAlignment.Top;
                s145.Alignment.WrapText = true;
                s145.Borders.Add(StylePosition.Right, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  s146
                // -----------------------------------------------
                WorksheetStyle s146 = book.Styles.Add("s146");
                s146.Parent = "s137";
                s146.Font.FontName = "Calibri";
                s146.Font.Size = 11;
                s146.Interior.Color = "#FFFFFF";
                s146.Interior.Pattern = StyleInteriorPattern.Solid;
                s146.Alignment.Vertical = StyleVerticalAlignment.Top;
                s146.Alignment.WrapText = true;
                s146.Borders.Add(StylePosition.Bottom, LineStyleOption.Continuous, 1, "#000000");
                s146.Borders.Add(StylePosition.Left, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  s169
                // -----------------------------------------------
                WorksheetStyle s169 = book.Styles.Add("s169");
                s169.Parent = "s137";
                s169.Font.FontName = "Arial";
                s169.Font.Color = "#9400D3";
                s169.Interior.Color = "#FFFFFF";
                s169.Interior.Pattern = StyleInteriorPattern.Solid;
                s169.Alignment.Vertical = StyleVerticalAlignment.Top;
                s169.Alignment.ReadingOrder = StyleReadingOrder.LeftToRight;
                // -----------------------------------------------
                //  s170
                // -----------------------------------------------
                WorksheetStyle s170 = book.Styles.Add("s170");
                s170.Parent = "s137";
                s170.Font.FontName = "Calibri";
                s170.Font.Size = 11;
                s170.Interior.Color = "#FFFFFF";
                s170.Interior.Pattern = StyleInteriorPattern.Solid;
                s170.Alignment.Vertical = StyleVerticalAlignment.Top;
                // -----------------------------------------------
                //  s171
                // -----------------------------------------------
                WorksheetStyle s171 = book.Styles.Add("s171");
                s171.Parent = "s137";
                s171.Font.FontName = "Calibri";
                s171.Font.Size = 11;
                s171.Interior.Color = "#FFFFFF";
                s171.Interior.Pattern = StyleInteriorPattern.Solid;
                s171.Alignment.Vertical = StyleVerticalAlignment.Top;
                s171.Borders.Add(StylePosition.Top, LineStyleOption.Continuous, 1, "#000000");
                // -----------------------------------------------
                //  s172
                // -----------------------------------------------
                WorksheetStyle s172 = book.Styles.Add("s172");
                s172.Alignment.Vertical = StyleVerticalAlignment.Bottom;

                // -----------------------------------------------
                WorksheetRow RowHead = sheet.Table.Rows.Add();
                //WorksheetCell cell;
                cell = RowHead.Cells.Add();
                cell.StyleID = "s139";
                cell = RowHead.Cells.Add();
                cell.StyleID = "s139";
                cell = RowHead.Cells.Add();
                cell.StyleID = "s139";
                cell = RowHead.Cells.Add();
                cell.StyleID = "s170";
                cell = RowHead.Cells.Add();
                cell.StyleID = "s139";
                // -----------------------------------------------
                WorksheetRow Row1Head = sheet.Table.Rows.Add();
                Row1Head.Height = 14;
                Row1Head.AutoFitHeight = false;
                cell = Row1Head.Cells.Add();
                cell.StyleID = "s139";
                cell = Row1Head.Cells.Add();
                cell.StyleID = "s140";
                cell = Row1Head.Cells.Add();
                cell.StyleID = "s141";
                cell = Row1Head.Cells.Add();
                cell.StyleID = "s171";
                cell = Row1Head.Cells.Add();
                cell.StyleID = "s142";
                // -----------------------------------------------
                WorksheetRow Row2Head = sheet.Table.Rows.Add();
                Row2Head.Height = 14;
                Row2Head.AutoFitHeight = false;
                cell = Row2Head.Cells.Add();
                cell.StyleID = "s139";
                cell = Row2Head.Cells.Add();
                cell.StyleID = "s143";
                cell = Row2Head.Cells.Add();
                cell.StyleID = "m2611536909264";
                cell.Data.Type = DataType.String;
                cell.MergeAcross = 2;
                // -----------------------------------------------
                WorksheetRow Row7Head = sheet.Table.Rows.Add();
                Row7Head.Height = 14;
                Row7Head.AutoFitHeight = false;
                cell = Row7Head.Cells.Add();
                cell.StyleID = "s139";
                cell = Row7Head.Cells.Add();
                cell.StyleID = "s143";
                cell = Row7Head.Cells.Add();
                cell.StyleID = "m2611536909324";
                cell.Data.Type = DataType.String;
                cell.Data.Text = Privileges.Program + " - " + Privileges.PrivilegeName;
                cell.MergeAcross = 2;
                // -----------------------------------------------
                WorksheetRow Row101 = sheet.Table.Rows.Add();
                Row101.Height = 14;
                Row101.AutoFitHeight = false;
                cell = Row101.Cells.Add();
                cell.StyleID = "s139";
                cell = Row101.Cells.Add();
                cell.StyleID = "s143";
                cell = Row101.Cells.Add();
                cell.StyleID = "m2611540549592";
                cell.Data.Type = DataType.String;
                cell.MergeAcross = 2;
                // -----------------------------------------------
                WorksheetRow Row88Head = sheet.Table.Rows.Add();
                Row88Head.Height = 14;
                Row88Head.AutoFitHeight = false;
                cell = Row88Head.Cells.Add();
                cell.StyleID = "s139";
                cell = Row88Head.Cells.Add();
                cell.StyleID = "s143";
                cell = Row88Head.Cells.Add();
                cell.StyleID = "s139";
                cell = Row88Head.Cells.Add();
                cell.StyleID = "s170";
                cell = Row88Head.Cells.Add();
                cell.StyleID = "s145";
                // -----------------------------------------------
                WorksheetRow Row3Head = sheet.Table.Rows.Add();
                Row3Head.Height = 14;
                Row3Head.AutoFitHeight = false;
                cell = Row3Head.Cells.Add();
                cell.StyleID = "s139";
                cell = Row3Head.Cells.Add();
                cell.StyleID = "s143";
                cell = Row3Head.Cells.Add();
                cell.StyleID = "m2611536909284";
                cell.Data.Type = DataType.String;
                cell.Data.Text = "Selected Report Parameters";
                cell.MergeAcross = 2;
                // -----------------------------------------------
                WorksheetRow Row4Head = sheet.Table.Rows.Add();
                Row4Head.Height = 14;
                Row4Head.AutoFitHeight = false;
                cell = Row4Head.Cells.Add();
                cell.StyleID = "s139";
                cell = Row4Head.Cells.Add();
                cell.StyleID = "s143";
                cell = Row4Head.Cells.Add();
                cell.StyleID = "s139";
                cell = Row4Head.Cells.Add();
                cell.StyleID = "s170";
                cell = Row4Head.Cells.Add();
                cell.StyleID = "s145";
                // -----------------------------------------------
                WorksheetRow Row5Head = sheet.Table.Rows.Add();
                Row5Head.Height = 14;
                Row5Head.AutoFitHeight = false;
                cell = Row5Head.Cells.Add();
                cell.StyleID = "s139";
                cell = Row5Head.Cells.Add();
                cell.StyleID = "s143";
                cell = Row5Head.Cells.Add();
                cell.StyleID = "m2611536909304";
                cell.Data.Type = DataType.String;
                cell.MergeAcross = 2;
                // -----------------------------------------------
                WorksheetRow Row6Head = sheet.Table.Rows.Add();
                Row6Head.Height = 14;
                Row6Head.AutoFitHeight = false;
                cell = Row6Head.Cells.Add();
                cell.StyleID = "s139";
                cell = Row6Head.Cells.Add();
                cell.StyleID = "s143";
                cell = Row6Head.Cells.Add();
                cell.StyleID = "s139";
                cell = Row6Head.Cells.Add();
                cell.StyleID = "s170";
                cell = Row6Head.Cells.Add();
                cell.StyleID = "s145";
                // -----------------------------------------------
                string Header_year = string.Empty;

                if (CmbYear.Visible == true)
                    Header_year = "Year: " + ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString();

                WorksheetRow Row78Head = sheet.Table.Rows.Add();
                Row78Head.Height = 14;
                Row78Head.AutoFitHeight = false;
                cell = Row78Head.Cells.Add();
                cell.StyleID = "s139";
                cell = Row78Head.Cells.Add();
                cell.StyleID = "s143";
                cell = Row78Head.Cells.Add();
                cell.StyleID = "m2611536909324";
                cell.Data.Type = DataType.String;
                cell.Data.Text = "            Hierarchy: " + Txt_HieDesc.Text.Trim() + "   " + Header_year;
                cell.MergeAcross = 2;
                // -----------------------------------------------
                WorksheetRow Row10 = sheet.Table.Rows.Add();
                Row10.Height = 14;
                Row10.AutoFitHeight = false;
                cell = Row10.Cells.Add();
                cell.StyleID = "s139";
                cell = Row10.Cells.Add();
                cell.StyleID = "s143";
                cell = Row10.Cells.Add();
                cell.StyleID = "m2611540549592";
                cell.Data.Type = DataType.String;
                cell.MergeAcross = 2;
                // -----------------------------------------------
                WorksheetRow Row11 = sheet.Table.Rows.Add();
                Row11.Height = 14;
                Row11.AutoFitHeight = false;
                cell = Row11.Cells.Add();
                cell.StyleID = "s139";
                cell = Row11.Cells.Add();
                cell.StyleID = "s143";
                cell = Row11.Cells.Add();
                cell.StyleID = "s139";
                cell = Row11.Cells.Add();
                cell.StyleID = "s170";
                cell = Row11.Cells.Add();
                cell.StyleID = "s145";
                // -----------------------------------------------
                WorksheetRow ReportType = sheet.Table.Rows.Add();
                ReportType.Height = 14;
                ReportType.AutoFitHeight = false;
                cell = ReportType.Cells.Add();
                cell.StyleID = "s139";
                cell = ReportType.Cells.Add();
                cell.StyleID = "s143";
                ReportType.Cells.Add("           Site", DataType.String, "s144");
                ReportType.Cells.Add(": " + ((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Text.Trim(), DataType.String, "s169");
                cell = ReportType.Cells.Add();
                cell.StyleID = "s145";
                // -----------------------------------------------
                WorksheetRow Row13 = sheet.Table.Rows.Add();
                Row13.Height = 14;
                Row13.AutoFitHeight = false;
                cell = Row13.Cells.Add();
                cell.StyleID = "s139";
                cell = Row13.Cells.Add();
                cell.StyleID = "s143";
                cell = Row13.Cells.Add();
                cell.StyleID = "s139";
                cell = Row13.Cells.Add();
                cell.StyleID = "s170";
                cell = Row13.Cells.Add();
                cell.StyleID = "s145";
                // -----------------------------------------------
                string Type = rbSiteSummary.Checked == true ? rbSiteSummary.Text.Trim() : (rbRoomDetail.Checked == true ? rbRoomDetail.Text.Trim() : rbFundDetailByRoom.Text.Trim());

                WorksheetRow AppType = sheet.Table.Rows.Add();
                AppType.Height = 14;
                AppType.AutoFitHeight = false;
                cell = AppType.Cells.Add();
                cell.StyleID = "s139";
                cell = AppType.Cells.Add();
                cell.StyleID = "s143";
                AppType.Cells.Add("            Report Type", DataType.String, "s144");
                AppType.Cells.Add(": " + Type, DataType.String, "s169");
                cell = AppType.Cells.Add();
                cell.StyleID = "s145";

                // -----------------------------------------------
                WorksheetRow Row133 = sheet.Table.Rows.Add();
                Row133.Height = 14;
                Row133.AutoFitHeight = false;
                cell = Row133.Cells.Add();
                cell.StyleID = "s139";
                cell = Row133.Cells.Add();
                cell.StyleID = "s143";
                cell = Row133.Cells.Add();
                cell.StyleID = "s139";
                cell = Row133.Cells.Add();
                cell.StyleID = "s170";
                cell = Row133.Cells.Add();
                cell.StyleID = "s145";

                // -----------------------------------------------
                if (rbFundDetailByRoom.Checked == true)
                {
                    string Fund = string.Empty;
                    if (rbAll.Checked) //if (rbSelected.Checked == true)
                        Fund = /*lblFundingSource.Text.Trim() + " : " +*/ rbAll.Text.Trim() + " Funds";
                    else
                    {
                        string New_Fund_Str = "";
                        foreach (CommonEntity FundingCode in SelFundingList)
                            New_Fund_Str += FundingCode.Code + ", ";

                        if (New_Fund_Str.Length > 2)
                            New_Fund_Str = New_Fund_Str.Substring(0, New_Fund_Str.Length - 2);

                        Fund = "Selected Funds: " + New_Fund_Str;
                    }

                    WorksheetRow IntDte = sheet.Table.Rows.Add();
                    IntDte.Height = 14;
                    IntDte.AutoFitHeight = false;
                    cell = IntDte.Cells.Add();
                    cell.StyleID = "s139";
                    cell = IntDte.Cells.Add();
                    cell.StyleID = "s143";
                    IntDte.Cells.Add("           Funding Source", DataType.String, "s144");
                    IntDte.Cells.Add(": " + Fund, DataType.String, "s169");
                    cell = IntDte.Cells.Add();
                    cell.StyleID = "s145";
                    // -----------------------------------------------
                    WorksheetRow Row135 = sheet.Table.Rows.Add();
                    Row135.Height = 14;
                    Row135.AutoFitHeight = false;
                    cell = Row135.Cells.Add();
                    cell.StyleID = "s139";
                    cell = Row135.Cells.Add();
                    cell.StyleID = "s143";
                    cell = Row135.Cells.Add();
                    cell.StyleID = "s139";
                    cell = Row135.Cells.Add();
                    cell.StyleID = "s170";
                    cell = Row135.Cells.Add();
                    cell.StyleID = "s145";
                }
                // -----------------------------------------------
                WorksheetRow Row111 = sheet.Table.Rows.Add();
                Row111.Height = 14;
                Row111.AutoFitHeight = false;
                cell = Row111.Cells.Add();
                cell.StyleID = "s139";
                cell = Row111.Cells.Add();
                cell.StyleID = "s143";
                cell = Row111.Cells.Add();
                cell.StyleID = "s139";
                cell = Row111.Cells.Add();
                cell.StyleID = "s170";
                cell = Row111.Cells.Add();
                cell.StyleID = "s145";
                // -----------------------------------------------
                WorksheetRow AsofDte = sheet.Table.Rows.Add();
                AsofDte.Height = 14;
                AsofDte.AutoFitHeight = false;
                cell = AsofDte.Cells.Add();
                cell.StyleID = "s139";
                cell = AsofDte.Cells.Add();
                cell.StyleID = "s143";
                AsofDte.Cells.Add("           As Of Date", DataType.String, "s144");
                AsofDte.Cells.Add(": " + dtpAsOfDate.Value.ToShortDateString(), DataType.String, "s169");
                cell = AsofDte.Cells.Add();
                cell.StyleID = "s145";
                // -----------------------------------------------
                WorksheetRow Row24 = sheet.Table.Rows.Add();
                Row24.Height = 14;
                Row24.AutoFitHeight = false;
                cell = Row24.Cells.Add();
                cell.StyleID = "s139";
                cell = Row24.Cells.Add();
                cell.StyleID = "s143";
                cell = Row24.Cells.Add();
                cell.StyleID = "m2611540549632";
                cell.Data.Type = DataType.String;
                cell.MergeAcross = 2;
                // -----------------------------------------------
                WorksheetRow Row25 = sheet.Table.Rows.Add();
                Row25.Height = 14;
                Row25.AutoFitHeight = false;
                cell = Row25.Cells.Add();
                cell.StyleID = "s139";
                cell = Row25.Cells.Add();
                cell.StyleID = "s143";
                cell = Row25.Cells.Add();
                cell.StyleID = "m2611540549652";
                cell.Data.Type = DataType.String;
                cell.MergeAcross = 2;
                // -----------------------------------------------
                WorksheetRow Row26Head = sheet.Table.Rows.Add();
                Row26Head.Height = 14;
                Row26Head.AutoFitHeight = false;
                cell = Row26Head.Cells.Add();
                cell.StyleID = "s139";
                cell = Row26Head.Cells.Add();
                cell.StyleID = "s143";
                cell = Row26Head.Cells.Add();
                cell.StyleID = "s139";
                cell = Row26Head.Cells.Add();
                cell.StyleID = "s170";
                cell = Row26Head.Cells.Add();
                cell.StyleID = "s145";
                // -----------------------------------------------
                WorksheetRow Row27Head = sheet.Table.Rows.Add();
                Row27Head.Height = 14;
                Row27Head.AutoFitHeight = false;
                cell = Row27Head.Cells.Add();
                cell.StyleID = "s139";
                cell = Row27Head.Cells.Add();
                cell.StyleID = "s143";
                cell = Row27Head.Cells.Add();
                cell.StyleID = "m2611540549672";
                cell.Data.Type = DataType.String;
                cell.MergeAcross = 2;
                // -----------------------------------------------
                WorksheetRow Row28 = sheet.Table.Rows.Add();
                Row28.Height = 14;
                Row28.AutoFitHeight = false;
                cell = Row28.Cells.Add();
                cell.StyleID = "s139";
                cell = Row28.Cells.Add();
                cell.StyleID = "s143";
                cell = Row28.Cells.Add();
                cell.StyleID = "s139";
                cell = Row28.Cells.Add();
                cell.StyleID = "s170";
                cell = Row28.Cells.Add();
                cell.StyleID = "s145";
                // -----------------------------------------------
                WorksheetRow Row29 = sheet.Table.Rows.Add();
                Row29.Height = 14;
                Row29.AutoFitHeight = false;
                cell = Row29.Cells.Add();
                cell.StyleID = "s139";
                cell = Row29.Cells.Add();
                cell.StyleID = "s143";
                cell = Row29.Cells.Add();
                cell.StyleID = "m2611540549552";
                cell.Data.Type = DataType.String;
                cell.MergeAcross = 2;
                // -----------------------------------------------
                WorksheetRow Row30 = sheet.Table.Rows.Add();
                Row30.Height = 14;
                Row30.AutoFitHeight = false;
                cell = Row30.Cells.Add();
                cell.StyleID = "s139";
                cell = Row30.Cells.Add();
                cell.StyleID = "s143";
                cell = Row30.Cells.Add();
                cell.StyleID = "s139";
                cell = Row30.Cells.Add();
                cell.StyleID = "s170";
                cell = Row30.Cells.Add();
                cell.StyleID = "s145";
                // -----------------------------------------------
                WorksheetRow Row31 = sheet.Table.Rows.Add();
                Row31.Height = 14;
                Row31.AutoFitHeight = false;
                cell = Row31.Cells.Add();
                cell.StyleID = "s139";
                cell = Row31.Cells.Add();
                cell.StyleID = "s146";
                cell = Row31.Cells.Add();
                cell.StyleID = "m2611540549572";
                cell.Data.Type = DataType.String;
                cell.MergeAcross = 2;
                // -----------------------------------------------
                //  Options
                // -----------------------------------------------
                sheet.Options.Selected = true;
                sheet.Options.ProtectObjects = false;
                sheet.Options.ProtectScenarios = false;
                sheet.Options.PageSetup.Header.Margin = 0.3F;
                sheet.Options.PageSetup.Footer.Margin = 0.3F;
                sheet.Options.PageSetup.PageMargins.Bottom = 0.75F;
                sheet.Options.PageSetup.PageMargins.Left = 0.7F;
                sheet.Options.PageSetup.PageMargins.Right = 0.7F;
                sheet.Options.PageSetup.PageMargins.Top = 0.75F;

                #endregion
                #region Styles
                WorksheetStyle mainstyle = book.Styles.Add("MainHeaderStyles");
                mainstyle.Font.FontName = "Tahoma";
                mainstyle.Font.Size = 12;
                mainstyle.Font.Bold = true;
                mainstyle.Font.Color = "#FFFFFF";
                mainstyle.Interior.Color = "#0070c0";
                mainstyle.Interior.Pattern = StyleInteriorPattern.Solid;
                mainstyle.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                mainstyle.Alignment.Vertical = StyleVerticalAlignment.Center;


                WorksheetStyle style1 = book.Styles.Add("Normal");
                style1.Font.FontName = "Tahoma";
                style1.Font.Size = 10;
                style1.Alignment.Horizontal = StyleHorizontalAlignment.Right;
                style1.Alignment.Vertical = StyleVerticalAlignment.Center;

                WorksheetStyle stylecenter = book.Styles.Add("Normalcenter");
                stylecenter.Font.FontName = "Tahoma";
                stylecenter.Font.Bold = true;
                stylecenter.Font.Size = 11;
                stylecenter.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                stylecenter.Alignment.Vertical = StyleVerticalAlignment.Center;

                WorksheetStyle style3 = book.Styles.Add("NormalLeft");
                style3.Font.FontName = "Tahoma";
                style3.Font.Size = 10;
                style3.Interior.Color = "#f2f2f2";
                style3.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style3.Alignment.Vertical = StyleVerticalAlignment.Center;

                WorksheetStyle style4 = book.Styles.Add("NormalRight");
                style4.Font.FontName = "Tahoma";
                style4.Font.Size = 10;
                style4.Interior.Color = "#f2f2f2";
                style4.Alignment.Horizontal = StyleHorizontalAlignment.Right;
                style4.Alignment.Vertical = StyleVerticalAlignment.Center;

                WorksheetStyle style44 = book.Styles.Add("NormalRightBold");
                style44.Font.FontName = "Tahoma";
                style44.Font.Size = 10;
                style44.Font.Bold = true;
                style44.Interior.Color = "#f2f2f2";
                style44.Alignment.Horizontal = StyleHorizontalAlignment.Right;
                style44.Alignment.Vertical = StyleVerticalAlignment.Center;

                WorksheetStyle style15 = book.Styles.Add("NormalBold");
                style15.Font.FontName = "Tahoma";
                style15.Font.Size = 11;
                style15.Font.Bold = true;
                style15.Alignment.Horizontal = StyleHorizontalAlignment.Center;
                style15.Alignment.Vertical = StyleVerticalAlignment.Center;
                style15.Alignment.WrapText = true;

                WorksheetStyle style16 = book.Styles.Add("NormalRedBold");
                style16.Font.FontName = "Tahoma";
                style16.Font.Size = 10;
                style16.Font.Bold = true;
                style16.Alignment.Horizontal = StyleHorizontalAlignment.Left;
                style16.Alignment.Vertical = StyleVerticalAlignment.Center;
                style16.Alignment.WrapText = true;

                #endregion

                /*Worksheet*/
                sheet = book.Worksheets.Add("Data");
                sheet.Table.DefaultRowHeight = 14.25F;

                sheet.Table.DefaultColumnWidth = 220.5F;
                sheet.Table.Columns.Add(300);
                sheet.Table.Columns.Add(120);
                sheet.Table.Columns.Add(120);
                sheet.Table.Columns.Add(120);
                sheet.Table.Columns.Add(120);
                sheet.Table.Columns.Add(150);
                sheet.Table.Columns.Add(150);

                if (Agency == "**") Agency = null; if (Depart == "**") Depart = null; if (Program == "**") Program = null;
                string Year = string.Empty;
                if (CmbYear.Visible == true)
                    Year = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString().Trim();

                try
                {
                    excelrowHeader = sheet.Table.Rows.Add();
                    cell = excelrowHeader.Cells.Add(Privileges.PrivilegeName, DataType.String, "MainHeaderStyles");
                    cell.MergeAcross = 6;

                    excelrowSpace = sheet.Table.Rows.Add();
                    cell = excelrowSpace.Cells.Add("", DataType.String, "NormalLeft");
                    cell.MergeAcross = 6;

                    excelrowSpace1 = sheet.Table.Rows.Add();
                    cell = excelrowSpace1.Cells.Add("", DataType.String, "NormalLeft");
                    cell.MergeAcross = 6;

                    string PrivSite = string.Empty; string PrivRoom = string.Empty; string PrivAmpm = string.Empty;

                    PdfPTable table = new PdfPTable(7);
                    table.TotalWidth = 550f;
                    table.WidthPercentage = 100;
                    table.LockedWidth = true;
                    float[] widths = new float[] { 40f, 18f, 18f, 18f, 18f, 30f, 23f };// 30f, 25f, 18f, 18f, 20f, 25f, 30f, 20f, 25f, 18f, 18f, 22f };
                    table.SetWidths(widths);
                    table.HorizontalAlignment = Element.ALIGN_CENTER;

                    if (rbSiteSummary.Checked == true)
                    {
                        if (SiteSel_List.Count > 0)
                        {
                            excelrow1 = sheet.Table.Rows.Add();
                            cell = excelrow1.Cells.Add("Site and Classrooms", DataType.String, "MainHeaderStyles");
                            cell = excelrow1.Cells.Add("Funded", DataType.String, "MainHeaderStyles");
                            cell = excelrow1.Cells.Add("Enrolled", DataType.String, "MainHeaderStyles");
                            cell = excelrow1.Cells.Add("30 window", DataType.String, "MainHeaderStyles");
                            cell = excelrow1.Cells.Add("Withdrawn", DataType.String, "MainHeaderStyles");
                            cell = excelrow1.Cells.Add("First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), DataType.String, "MainHeaderStyles");
                            cell = excelrow1.Cells.Add("Attended 1 Day", DataType.String, "MainHeaderStyles");

                            int Enrl_cnt = 0; //int Wdraw_cnt = 0; int day30_cnt = 0; int Attn1_cnt = 0; int FirstTime_cnt = 0;
                            //int totEnrl_cnt = 0; int totWdraw_cnt = 0; int totday30_cnt = 0; int totAttn1_cnt = 0; int totFirstTime_cnt = 0; int TotFunds = 0;
                            int FundedTotal = 0;

                            excelrow2 = sheet.Table.Rows.Add();
                            cell = excelrow2.Cells.Add("", DataType.String, "NormalBold");

                            foreach (ENRL_Asof_Entity Entity in SiteSel_List)
                            {
                                excelrow3 = sheet.Table.Rows.Add();
                                cell = excelrow3.Cells.Add(Entity.Site.Trim(), DataType.String, "NormalLeft");

                                CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()));

                                cell = excelrow3.Cells.Add(selsite.SITE_FUNDED_SLOTS.Trim(), DataType.String, "NormalLeft");

                                int Count = 0;
                                List<ENRL_Asof_Entity> SiteCount = Count_List.FindAll(u => u.Site.Trim().Equals(Entity.Site.Trim()));

                                List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Enrolled.Equals("1"));
                                var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                if (enrolled_Count.Count > 0) Count = enrolled_Count.Count;

                                //Count = SiteCount.Sum(u => int.Parse(u.Enrolled.Trim()));

                                string Enroll = string.Empty;
                                if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                {
                                    if (Count < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                        Enroll = Count + "*";
                                    else Enroll = Count.ToString();

                                    FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                }
                                else Enroll = Count.ToString();
                                //PdfPCell tot_enrl = new PdfPCell(new Phrase(Enroll, TableFont));
                                //tot_enrl.HorizontalAlignment = Element.ALIGN_CENTER;
                                //tot_enrl.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                //table.AddCell(tot_enrl);

                                cell = excelrow3.Cells.Add(Enroll, DataType.String, "NormalLeft");

                                Count = SiteCount.Sum(u => int.Parse(u.Window30.Trim()));

                                cell = excelrow3.Cells.Add(Count.ToString(), DataType.String, "NormalLeft");

                                Count = SiteCount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                cell = excelrow3.Cells.Add(Count.ToString(), DataType.String, "NormalLeft");

                                Count = SiteCount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                cell = excelrow3.Cells.Add(Count.ToString(), DataType.String, "NormalLeft");

                                Count = SiteCount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                cell = excelrow3.Cells.Add(Count.ToString(), DataType.String, "NormalLeft");
                            }

                            excelrow4 = sheet.Table.Rows.Add();
                            cell = excelrow4.Cells.Add("", DataType.String, "NormalLeft");
                            cell = excelrow4.Cells.Add("", DataType.String, "NormalLeft");
                            cell = excelrow4.Cells.Add("", DataType.String, "NormalLeft");
                            cell = excelrow4.Cells.Add("", DataType.String, "NormalLeft");
                            cell = excelrow4.Cells.Add("", DataType.String, "NormalLeft");

                            excelrow5 = sheet.Table.Rows.Add();
                            cell = excelrow5.Cells.Add("Fund", DataType.String, "MainHeaderStyles");
                            cell = excelrow5.Cells.Add("Funded", DataType.String, "MainHeaderStyles");
                            cell = excelrow5.Cells.Add("Enrolled", DataType.String, "MainHeaderStyles");
                            cell = excelrow5.Cells.Add("30 window", DataType.String, "MainHeaderStyles");
                            cell = excelrow5.Cells.Add("Withdrawn", DataType.String, "MainHeaderStyles");
                            cell = excelrow5.Cells.Add("First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), DataType.String, "MainHeaderStyles");
                            cell = excelrow5.Cells.Add("Attended 1 Day", DataType.String, "MainHeaderStyles");

                            int Total_Count = 0;

                            excelrow6 = sheet.Table.Rows.Add();
                            cell = excelrow6.Cells.Add("Report Totals:", DataType.String, "NormalLeft");

                            Total_Count = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));

                            cell = excelrow6.Cells.Add(Total_Count > 0 ? Total_Count.ToString() : FundedTotal.ToString(), DataType.String, "NormalLeft");

                            List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                            var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                            if (Repenrolled_Count.Count > 0) Total_Count = Repenrolled_Count.Count;
                            //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                            cell = excelrow6.Cells.Add(Total_Count.ToString(), DataType.String, "NormalLeft");

                            Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                            cell = excelrow6.Cells.Add(Total_Count.ToString(), DataType.String, "NormalLeft");

                            Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                            cell = excelrow6.Cells.Add(Total_Count.ToString(), DataType.String, "NormalLeft");

                            Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                            cell = excelrow6.Cells.Add(Total_Count.ToString(), DataType.String, "NormalLeft");

                            Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                            cell = excelrow6.Cells.Add(Total_Count.ToString(), DataType.String, "NormalLeft");

                            if (propfundingSource.Count > 0)
                            {
                                foreach (CommonEntity FundEntity in propfundingSource)
                                {
                                    List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                    int EnrlCnt = 0; int Wcnt = 0;
                                    if (Fundlistcount.Count > 0)
                                    {
                                        EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                        Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                        excelrow7 = sheet.Table.Rows.Add();
                                        cell = excelrow7.Cells.Add("     " + FundEntity.Desc, DataType.String, "NormalLeft");
                                        int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                        if (FundCnt > 0)
                                            cell = excelrow7.Cells.Add(FundCnt.ToString(), DataType.String, "NormalLeft");
                                        else
                                            cell = excelrow7.Cells.Add("", DataType.String, "NormalLeft");

                                        cell = excelrow7.Cells.Add(EnrlCnt.ToString(), DataType.String, "NormalLeft");

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                        cell = excelrow7.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");

                                        cell = excelrow7.Cells.Add(Wcnt.ToString(), DataType.String, "NormalLeft");

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                        cell = excelrow7.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                        cell = excelrow7.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");
                                    }
                                }
                            }
                        }
                    }

                    if (rbRoomDetail.Checked == true)
                    {
                        CaseSiteEntity Search_Entity = new CaseSiteEntity(true);
                        Search_Entity.SiteAGENCY = Agency;
                        Search_Entity.SiteDEPT = Depart; Search_Entity.SitePROG = Program;
                        if (CmbYear.Visible == true) Search_Entity.SiteYEAR = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                        propCaseAllSiteEntity = _model.CaseMstData.Browse_CASESITE(Search_Entity, "Browse");

                        if (RoomSel_List.Count > 0)
                        {
                            bool First = true;

                            excelrow8 = sheet.Table.Rows.Add();
                            cell = excelrow8.Cells.Add("Site and Classrooms", DataType.String, "MainHeaderStyles");
                            cell = excelrow8.Cells.Add("Funded", DataType.String, "MainHeaderStyles");
                            cell = excelrow8.Cells.Add("Enrolled", DataType.String, "MainHeaderStyles");
                            cell = excelrow8.Cells.Add("30 window", DataType.String, "MainHeaderStyles");
                            cell = excelrow8.Cells.Add("Withdrawn", DataType.String, "MainHeaderStyles");
                            cell = excelrow8.Cells.Add("First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), DataType.String, "MainHeaderStyles");
                            cell = excelrow8.Cells.Add("Attended 1 Day", DataType.String, "MainHeaderStyles");

                            int Enrl_cnt = 0; //int Wdraw_cnt = 0; int day30_cnt = 0; int Attn1_cnt = 0; int FirstTime_cnt = 0;
                            int totEnrl_cnt = 0; int totWdraw_cnt = 0; int totday30_cnt = 0; int totAttn1_cnt = 0; int totFirstTime_cnt = 0; int TotFunds = 0;
                            int FundedTotal = 0;
                            foreach (ENRL_Asof_Entity Entity in RoomSel_List)
                            {
                                if (!First)
                                {
                                    if (Entity.Site.Trim() != PrivSite)
                                    {
                                        excelrow9 = sheet.Table.Rows.Add();
                                        cell = excelrow9.Cells.Add("Total " + PrivSite, DataType.String, "NormalLeft");
                                        cell = excelrow9.Cells.Add(TotFunds.ToString(), DataType.String, "NormalLeft");

                                        string totEnroll = string.Empty;
                                        if (totEnrl_cnt < TotFunds)
                                            totEnroll = totEnrl_cnt.ToString() + "*";
                                        else totEnroll = totEnrl_cnt.ToString();

                                        cell = excelrow9.Cells.Add(totEnroll.ToString(), DataType.String, "NormalLeft");

                                        cell = excelrow9.Cells.Add(totday30_cnt.ToString(), DataType.String, "NormalLeft");

                                        cell = excelrow9.Cells.Add(totWdraw_cnt.ToString(), DataType.String, "NormalLeft");

                                        cell = excelrow9.Cells.Add(totFirstTime_cnt.ToString(), DataType.String, "NormalLeft");

                                        cell = excelrow9.Cells.Add(totAttn1_cnt.ToString(), DataType.String, "NormalLeft");

                                        totEnrl_cnt = 0; totWdraw_cnt = 0; totAttn1_cnt = 0;
                                        totday30_cnt = 0; totFirstTime_cnt = 0; TotFunds = 0;

                                        excelrow10 = sheet.Table.Rows.Add();
                                        cell = excelrow10.Cells.Add("", DataType.String, "NormalLeft");
                                        cell = excelrow10.Cells.Add("", DataType.String, "NormalLeft");
                                        cell = excelrow10.Cells.Add("", DataType.String, "NormalLeft");
                                        cell = excelrow10.Cells.Add("", DataType.String, "NormalLeft");
                                        cell = excelrow10.Cells.Add("", DataType.String, "NormalLeft");

                                        excelrow11 = sheet.Table.Rows.Add();
                                        cell = excelrow11.Cells.Add("Site and Classrooms", DataType.String, "MainHeaderStyles");
                                        cell = excelrow11.Cells.Add("Funded", DataType.String, "MainHeaderStyles");
                                        cell = excelrow11.Cells.Add("Enrolled", DataType.String, "MainHeaderStyles");
                                        cell = excelrow11.Cells.Add("30 window", DataType.String, "MainHeaderStyles");
                                        cell = excelrow11.Cells.Add("Withdrawn", DataType.String, "MainHeaderStyles");
                                        cell = excelrow11.Cells.Add("First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), DataType.String, "MainHeaderStyles");
                                        cell = excelrow11.Cells.Add("Attended 1 Day", DataType.String, "MainHeaderStyles");

                                        excelrow12 = sheet.Table.Rows.Add();
                                        cell = excelrow12.Cells.Add(Entity.Site.Trim(), DataType.String, "NormalLeft");
                                    }

                                    excelrow13 = sheet.Table.Rows.Add();
                                    cell = excelrow13.Cells.Add("      " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim(), DataType.String, "NormalLeft");

                                    CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));

                                    List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                    var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                    if (enrolled_Count.Count > 0) Entity.Enrolled = enrolled_Count.Count.ToString();
                                    string Enroll = string.Empty;

                                    if (selsite != null)
                                    {
                                        cell = excelrow13.Cells.Add(selsite.SITE_FUNDED_SLOTS.Trim(), DataType.String, "NormalLeft");
                                        if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                        {
                                            if (int.Parse(Entity.Enrolled) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                Enroll = Entity.Enrolled + "*";
                                            else Enroll = Entity.Enrolled;

                                        }
                                        else Enroll = Entity.Enrolled;
                                    }
                                    else Enroll = Entity.Enrolled;

                                    cell = excelrow13.Cells.Add(Enroll, DataType.String, "NormalLeft");
                                    cell = excelrow13.Cells.Add(Entity.Window30, DataType.String, "NormalLeft");
                                    cell = excelrow13.Cells.Add(Entity.Withdrawn, DataType.String, "NormalLeft");
                                    cell = excelrow13.Cells.Add(Entity.FirstTime, DataType.String, "NormalLeft");
                                    cell = excelrow13.Cells.Add(Entity.GetAttn1, DataType.String, "NormalLeft");

                                    totEnrl_cnt = totEnrl_cnt + int.Parse(Entity.Enrolled); totWdraw_cnt = totWdraw_cnt + int.Parse(Entity.Withdrawn); totAttn1_cnt = totAttn1_cnt + int.Parse(Entity.GetAttn1);
                                    totday30_cnt = totday30_cnt + int.Parse(Entity.Window30); totFirstTime_cnt = totFirstTime_cnt + int.Parse(Entity.FirstTime);
                                    if (selsite != null)
                                    {
                                        if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                        {
                                            TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                            FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                        }
                                    }
                                    PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM.Trim();
                                }
                                else
                                {
                                    excelrow14 = sheet.Table.Rows.Add();
                                    cell = excelrow14.Cells.Add(Entity.Site.Trim(), DataType.String, "NormalLeft");

                                    excelrow13 = sheet.Table.Rows.Add();
                                    cell = excelrow13.Cells.Add("      " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim(), DataType.String, "NormalLeft");

                                    CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));

                                    List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                    var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                    if (enrolled_Count.Count > 0) Entity.Enrolled = enrolled_Count.Count.ToString();
                                    string Enroll = string.Empty;

                                    if (selsite != null)
                                    {
                                        cell = excelrow13.Cells.Add(selsite.SITE_FUNDED_SLOTS.Trim(), DataType.String, "NormalLeft");

                                        if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                        {
                                            if (int.Parse(Entity.Enrolled) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                Enroll = Entity.Enrolled + "*";
                                            else Enroll = Entity.Enrolled;
                                        }
                                        else Enroll = Entity.Enrolled;
                                    }
                                    else Enroll = Entity.Enrolled;

                                    cell = excelrow13.Cells.Add(Enroll, DataType.String, "NormalLeft");
                                    cell = excelrow13.Cells.Add(Entity.Window30, DataType.String, "NormalLeft");
                                    cell = excelrow13.Cells.Add(Entity.Withdrawn, DataType.String, "NormalLeft");
                                    cell = excelrow13.Cells.Add(Entity.FirstTime, DataType.String, "NormalLeft");
                                    cell = excelrow13.Cells.Add(Entity.GetAttn1, DataType.String, "NormalLeft");

                                    totEnrl_cnt = totEnrl_cnt + int.Parse(Entity.Enrolled); totWdraw_cnt = totWdraw_cnt + int.Parse(Entity.Withdrawn); totAttn1_cnt = totAttn1_cnt + int.Parse(Entity.GetAttn1);
                                    totday30_cnt = totday30_cnt + int.Parse(Entity.Window30); totFirstTime_cnt = totFirstTime_cnt + int.Parse(Entity.FirstTime);
                                    if (selsite != null)
                                    {
                                        if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                        {
                                            TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                            FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                        }
                                    }
                                    PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM.Trim();

                                    excelrow15 = sheet.Table.Rows.Add();
                                    cell = excelrow15.Cells.Add("", DataType.String, "NormalLeft");
                                }
                                First = false; PrivSite = Entity.Site.Trim();
                            }

                            excelrow16 = sheet.Table.Rows.Add();
                            cell = excelrow16.Cells.Add("Total " + PrivSite, DataType.String, "NormalLeft");
                            cell = excelrow16.Cells.Add(TotFunds.ToString(), DataType.String, "NormalLeft");

                            string totEnroll1 = string.Empty;
                            if (totEnrl_cnt < TotFunds)
                                totEnroll1 = totEnrl_cnt.ToString() + "*";
                            else totEnroll1 = totEnrl_cnt.ToString();

                            cell = excelrow16.Cells.Add(totEnroll1.ToString(), DataType.String, "NormalLeft");
                            cell = excelrow16.Cells.Add(totday30_cnt.ToString(), DataType.String, "NormalLeft");
                            cell = excelrow16.Cells.Add(totWdraw_cnt.ToString(), DataType.String, "NormalLeft");
                            cell = excelrow16.Cells.Add(totFirstTime_cnt.ToString(), DataType.String, "NormalLeft");
                            cell = excelrow16.Cells.Add(totAttn1_cnt.ToString(), DataType.String, "NormalLeft");

                            excelrow17 = sheet.Table.Rows.Add();
                            cell = excelrow17.Cells.Add("Fund", DataType.String, "MainHeaderStyles");
                            cell = excelrow17.Cells.Add("Funded", DataType.String, "MainHeaderStyles");
                            cell = excelrow17.Cells.Add("Enrolled", DataType.String, "MainHeaderStyles");
                            cell = excelrow17.Cells.Add("30 window", DataType.String, "MainHeaderStyles");
                            cell = excelrow17.Cells.Add("Withdrawn", DataType.String, "MainHeaderStyles");
                            cell = excelrow17.Cells.Add("First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), DataType.String, "MainHeaderStyles");
                            cell = excelrow17.Cells.Add("Attended 1 Day", DataType.String, "MainHeaderStyles");

                            int Total_Count = 0;

                            excelrow18 = sheet.Table.Rows.Add();
                            cell = excelrow18.Cells.Add("Report Totals:", DataType.String, "NormalLeft");

                            Total_Count = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));

                            cell = excelrow18.Cells.Add(Total_Count > 0 ? Total_Count.ToString() : FundedTotal.ToString(), DataType.String, "NormalLeft");

                            List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                            var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                            if (Repenrolled_Count.Count > 0) Total_Count = Repenrolled_Count.Count;
                            //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                            cell = excelrow18.Cells.Add(Total_Count.ToString(), DataType.String, "NormalLeft");

                            Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                            cell = excelrow18.Cells.Add(Total_Count.ToString(), DataType.String, "NormalLeft");

                            Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                            cell = excelrow18.Cells.Add(Total_Count.ToString(), DataType.String, "NormalLeft");

                            Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                            cell = excelrow18.Cells.Add(Total_Count.ToString(), DataType.String, "NormalLeft");

                            Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                            cell = excelrow18.Cells.Add(Total_Count.ToString(), DataType.String, "NormalLeft");

                            excelrow19 = sheet.Table.Rows.Add();
                            cell = excelrow18.Cells.Add("", DataType.String, "NormalLeft");
                            if (propfundingSource.Count > 0)
                            {
                                foreach (CommonEntity FundEntity in propfundingSource)
                                {
                                    excelrow20 = sheet.Table.Rows.Add();
                                    List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                    int EnrlCnt = 0; int Wcnt = 0;

                                    if (Fundlistcount.Count > 0)
                                    {
                                        EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                        Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                        cell = excelrow20.Cells.Add("     " + FundEntity.Desc, DataType.String, "NormalLeft");

                                        int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                        if (FundCnt > 0)
                                            cell = excelrow20.Cells.Add(FundCnt.ToString(), DataType.String, "NormalLeft");
                                        else
                                            cell = excelrow20.Cells.Add("", DataType.String, "NormalLeft");

                                        cell = excelrow20.Cells.Add(EnrlCnt.ToString(), DataType.String, "NormalLeft");

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                        cell = excelrow20.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");

                                        cell = excelrow20.Cells.Add(Wcnt.ToString(), DataType.String, "NormalLeft");

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                        cell = excelrow20.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");

                                        Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                        cell = excelrow20.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");
                                    }
                                }
                            }
                        }
                    }
                    if (rbFundDetailByRoom.Checked == true)
                    {
                        CaseSiteEntity Search_Entity = new CaseSiteEntity(true);
                        Search_Entity.SiteAGENCY = Agency;
                        Search_Entity.SiteDEPT = Depart; Search_Entity.SitePROG = Program;
                        if (CmbYear.Visible == true) Search_Entity.SiteYEAR = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                        propCaseAllSiteEntity = _model.CaseMstData.Browse_CASESITE(Search_Entity, "Browse");

                        if (Count_List.Count > 0)
                        {
                            bool First = true;

                            excelrow21 = sheet.Table.Rows.Add();
                            cell = excelrow21.Cells.Add("Site and Classrooms", DataType.String, "MainHeaderStyles");
                            cell = excelrow21.Cells.Add("Funded", DataType.String, "MainHeaderStyles");
                            cell = excelrow21.Cells.Add("Enrolled", DataType.String, "MainHeaderStyles");
                            cell = excelrow21.Cells.Add("30 window", DataType.String, "MainHeaderStyles");
                            cell = excelrow21.Cells.Add("Withdrawn", DataType.String, "MainHeaderStyles");
                            cell = excelrow21.Cells.Add("First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), DataType.String, "MainHeaderStyles");
                            cell = excelrow21.Cells.Add("Attended 1 Day", DataType.String, "MainHeaderStyles");

                            excelrow22 = sheet.Table.Rows.Add();
                            cell = excelrow22.Cells.Add("", DataType.String, "NormalLeft");

                            int Enrl_cnt = 0; //int Wdraw_cnt = 0; int day30_cnt = 0; int Attn1_cnt = 0; int FirstTime_cnt = 0;
                            int totEnrl_cnt = 0; int totWdraw_cnt = 0; int totday30_cnt = 0; int totAttn1_cnt = 0; int totFirstTime_cnt = 0; int TotFunds = 0;
                            int FundedTotal = 0;

                            if (rbAll.Checked == true)
                            {
                                foreach (ENRL_Asof_Entity Entity in Count_List)
                                {
                                    if (Entity.Site.Trim() + Entity.Room.Trim() + Entity.AMPM.Trim() != PrivSite + PrivRoom + PrivAmpm)
                                    {
                                        if (!First)
                                        {
                                            excelrow23 = sheet.Table.Rows.Add();
                                            cell = excelrow23.Cells.Add("", DataType.String, "NormalLeft");

                                            if (Entity.Site.Trim() != PrivSite)
                                            {
                                                int Total_Count = 0;

                                                excelrow24 = sheet.Table.Rows.Add();
                                                cell = excelrow24.Cells.Add("Total " + PrivSite, DataType.String, "NormalLeft");
                                                cell = excelrow24.Cells.Add(TotFunds.ToString(), DataType.String, "NormalLeft");

                                                string totEnroll1 = string.Empty;
                                                if (totEnrl_cnt < TotFunds)
                                                    totEnroll1 = totEnrl_cnt.ToString() + "*";
                                                else totEnroll1 = totEnrl_cnt.ToString();

                                                cell = excelrow24.Cells.Add(totEnroll1.ToString(), DataType.String, "NormalLeft");

                                                cell = excelrow24.Cells.Add(totday30_cnt.ToString(), DataType.String, "NormalLeft");

                                                cell = excelrow24.Cells.Add(totWdraw_cnt.ToString(), DataType.String, "NormalLeft");

                                                cell = excelrow24.Cells.Add(totFirstTime_cnt.ToString(), DataType.String, "NormalLeft");

                                                cell = excelrow24.Cells.Add(totAttn1_cnt.ToString(), DataType.String, "NormalLeft");

                                                if (propfundingSource.Count > 0)
                                                {
                                                    excelrow25 = sheet.Table.Rows.Add();
                                                    cell = excelrow25.Cells.Add("Total " + PrivSite, DataType.String, "NormalLeft");

                                                    foreach (CommonEntity FundEntity in propfundingSource)
                                                    {
                                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                                        int EnrlCnt = 0; int Wcnt = 0;
                                                        if (Fundlistcount.Count > 0)
                                                        {
                                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                                            excelrow26 = sheet.Table.Rows.Add();
                                                            cell = excelrow26.Cells.Add("     " + FundEntity.Desc, DataType.String, "NormalLeft");

                                                            cell = excelrow26.Cells.Add("", DataType.String, "NormalLeft");

                                                            cell = excelrow26.Cells.Add(EnrlCnt.ToString(), DataType.String, "NormalLeft");

                                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                                            cell = excelrow26.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");

                                                            cell = excelrow26.Cells.Add(Wcnt.ToString(), DataType.String, "NormalLeft");

                                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                                            cell = excelrow26.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");

                                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                                            cell = excelrow26.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");
                                                        }
                                                    }
                                                }

                                                totEnrl_cnt = 0; totWdraw_cnt = 0; totAttn1_cnt = 0;
                                                totday30_cnt = 0; totFirstTime_cnt = 0; TotFunds = 0;

                                                excelrow27 = sheet.Table.Rows.Add();
                                                cell = excelrow27.Cells.Add("", DataType.String, "NormalLeft");

                                                excelrow28 = sheet.Table.Rows.Add();
                                                cell = excelrow28.Cells.Add("Site and Classrooms", DataType.String, "MainHeaderStyles");
                                                cell = excelrow28.Cells.Add("Funded", DataType.String, "MainHeaderStyles");
                                                cell = excelrow28.Cells.Add("Enrolled", DataType.String, "MainHeaderStyles");
                                                cell = excelrow28.Cells.Add("30 window", DataType.String, "MainHeaderStyles");
                                                cell = excelrow28.Cells.Add("Withdrawn", DataType.String, "MainHeaderStyles");
                                                cell = excelrow28.Cells.Add("First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), DataType.String, "MainHeaderStyles");
                                                cell = excelrow28.Cells.Add("Attended 1 Day", DataType.String, "MainHeaderStyles");

                                                excelrow29 = sheet.Table.Rows.Add();
                                                cell = excelrow29.Cells.Add(Entity.Site.Trim(), DataType.String, "NormalLeft");
                                            }
                                        }

                                        if (First)
                                        {
                                            excelrow30 = sheet.Table.Rows.Add();
                                            cell = excelrow30.Cells.Add(Entity.Site.Trim(), DataType.String, "NormalLeft");
                                        }

                                        excelrow31 = sheet.Table.Rows.Add();
                                        cell = excelrow31.Cells.Add("    " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim(), DataType.String, "NormalLeft");

                                        CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));

                                        string Enroll = string.Empty; string EnrlCntY = "0";
                                        string EnrlWd = "0"; string EnrlAttn = "0"; string EnrlW30 = "0"; string EnrlFA = "0";
                                        if (selsite != null)
                                        {
                                            cell = excelrow31.Cells.Add(selsite.SITE_FUNDED_SLOTS.Trim(), DataType.String, "NormalLeft");

                                            if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                            {
                                                List<ENRL_Asof_Entity> Enrols = Count_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM));
                                                List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                                var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                                if (Enrols.Count > 0)
                                                {
                                                    EnrlCntY = enrolled_Count.Count.ToString();
                                                    //EnrlCntY = Enrols.Sum(u => int.Parse(u.Enrolled.Trim())).ToString();
                                                    EnrlWd = Enrols.Sum(u => int.Parse(u.Withdrawn.Trim())).ToString();
                                                    EnrlAttn = Enrols.Sum(u => int.Parse(u.GetAttn1.Trim())).ToString();
                                                    EnrlW30 = Enrols.Sum(u => int.Parse(u.Window30.Trim())).ToString();
                                                    EnrlFA = Enrols.Sum(u => int.Parse(u.FirstTime.Trim())).ToString();
                                                }

                                                if (int.Parse(EnrlCntY) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                    Enroll = EnrlCntY + "*";
                                                else Enroll = EnrlCntY;
                                                FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                            }

                                            else Enroll = Entity.Enrolled;
                                        }

                                        else Enroll = Entity.Enrolled;

                                        cell = excelrow31.Cells.Add(Enroll, DataType.String, "NormalLeft");
                                        cell = excelrow31.Cells.Add(EnrlW30, DataType.String, "NormalLeft");
                                        cell = excelrow31.Cells.Add(EnrlWd, DataType.String, "NormalLeft");
                                        cell = excelrow31.Cells.Add(EnrlFA, DataType.String, "NormalLeft");
                                        cell = excelrow31.Cells.Add(EnrlAttn, DataType.String, "NormalLeft");

                                        string FundDesc = string.Empty;
                                        if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                        {
                                            foreach (CommonEntity drFund in propfundingSource)
                                            {
                                                if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                {
                                                    FundDesc = drFund.Desc.ToString().Trim();
                                                    break;
                                                }
                                            }
                                        }

                                        excelrow32 = sheet.Table.Rows.Add();
                                        cell = excelrow32.Cells.Add("       " + FundDesc, DataType.String, "NormalLeft");
                                        cell = excelrow32.Cells.Add("", DataType.String, "NormalLeft");
                                        cell = excelrow32.Cells.Add(Entity.Enrolled, DataType.String, "NormalLeft");
                                        cell = excelrow32.Cells.Add(Entity.Window30, DataType.String, "NormalLeft");
                                        cell = excelrow32.Cells.Add(Entity.Withdrawn, DataType.String, "NormalLeft");
                                        cell = excelrow32.Cells.Add(Entity.FirstTime, DataType.String, "NormalLeft");
                                        cell = excelrow32.Cells.Add(Entity.GetAttn1, DataType.String, "NormalLeft");

                                        First = false; PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM;
                                        totEnrl_cnt = totEnrl_cnt + int.Parse(EnrlCntY); totWdraw_cnt = totWdraw_cnt + int.Parse(EnrlWd); totAttn1_cnt = totAttn1_cnt + int.Parse(EnrlAttn);
                                        totday30_cnt = totday30_cnt + int.Parse(EnrlW30); totFirstTime_cnt = totFirstTime_cnt + int.Parse(EnrlFA);
                                        if (selsite != null)
                                        {
                                            if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                        }
                                    }
                                    else
                                    {
                                        string Fund = string.Empty;
                                        if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                        {
                                            foreach (CommonEntity drFund in propfundingSource)
                                            {
                                                if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                {
                                                    Fund = drFund.Desc.ToString().Trim();
                                                    break;
                                                }
                                            }
                                        }

                                        excelrow33 = sheet.Table.Rows.Add();
                                        cell = excelrow33.Cells.Add("       " + Fund, DataType.String, "NormalLeft");
                                        cell = excelrow33.Cells.Add("", DataType.String, "NormalLeft");
                                        cell = excelrow33.Cells.Add(Entity.Enrolled, DataType.String, "NormalLeft");
                                        cell = excelrow33.Cells.Add(Entity.Window30, DataType.String, "NormalLeft");
                                        cell = excelrow33.Cells.Add(Entity.Withdrawn, DataType.String, "NormalLeft");
                                        cell = excelrow33.Cells.Add(Entity.FirstTime, DataType.String, "NormalLeft");
                                        cell = excelrow33.Cells.Add(Entity.GetAttn1, DataType.String, "NormalLeft");

                                        PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM;
                                    }
                                }

                                excelrow34 = sheet.Table.Rows.Add();
                                cell = excelrow34.Cells.Add("Total " + PrivSite, DataType.String, "NormalLeft");
                                cell = excelrow34.Cells.Add(TotFunds.ToString(), DataType.String, "NormalLeft");

                                string totEnroll = string.Empty;
                                if (totEnrl_cnt < TotFunds)
                                    totEnroll = totEnrl_cnt.ToString() + "*";
                                else totEnroll = totEnrl_cnt.ToString();

                                cell = excelrow34.Cells.Add(totEnroll.ToString(), DataType.String, "NormalLeft");

                                cell = excelrow34.Cells.Add(totday30_cnt.ToString(), DataType.String, "NormalLeft");

                                cell = excelrow34.Cells.Add(totWdraw_cnt.ToString(), DataType.String, "NormalLeft");

                                cell = excelrow34.Cells.Add(totFirstTime_cnt.ToString(), DataType.String, "NormalLeft");

                                cell = excelrow34.Cells.Add(totAttn1_cnt.ToString(), DataType.String, "NormalLeft");

                                excelrow35 = sheet.Table.Rows.Add();
                                cell = excelrow35.Cells.Add("", DataType.String, "NormalLeft");

                                if (SelFundingList.Count > 0)
                                {
                                    foreach (CommonEntity FundEntity in SelFundingList)
                                    {
                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                        int EnrlCnt = 0; int Wcnt = 0;
                                        if (Fundlistcount.Count > 0)
                                        {
                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                            excelrow36 = sheet.Table.Rows.Add();
                                            cell = excelrow36.Cells.Add("     " + FundEntity.Desc, DataType.String, "NormalLeft");

                                            cell = excelrow36.Cells.Add("", DataType.String, "NormalLeft");

                                            cell = excelrow36.Cells.Add(EnrlCnt.ToString(), DataType.String, "NormalLeft");

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                            cell = excelrow36.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");

                                            cell = excelrow36.Cells.Add(Wcnt.ToString(), DataType.String, "NormalLeft");

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                            cell = excelrow36.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                            cell = excelrow36.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");
                                        }
                                    }
                                }

                                excelrow37 = sheet.Table.Rows.Add();
                                cell = excelrow37.Cells.Add("", DataType.String, "NormalLeft");
                                cell = excelrow37.Cells.Add("", DataType.String, "NormalLeft");
                                cell = excelrow37.Cells.Add("", DataType.String, "NormalLeft");
                                cell = excelrow37.Cells.Add("", DataType.String, "NormalLeft");
                                cell = excelrow37.Cells.Add("", DataType.String, "NormalLeft");

                                excelrow38 = sheet.Table.Rows.Add();
                                cell = excelrow38.Cells.Add("Fund", DataType.String, "MainHeaderStyles");
                                cell = excelrow38.Cells.Add("Funded", DataType.String, "MainHeaderStyles");
                                cell = excelrow38.Cells.Add("Enrolled", DataType.String, "MainHeaderStyles");
                                cell = excelrow38.Cells.Add("30 window", DataType.String, "MainHeaderStyles");
                                cell = excelrow38.Cells.Add("Withdrawn", DataType.String, "MainHeaderStyles");
                                cell = excelrow38.Cells.Add("First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), DataType.String, "MainHeaderStyles");
                                cell = excelrow38.Cells.Add("Attended 1 Day", DataType.String, "MainHeaderStyles");

                                excelrow39 = sheet.Table.Rows.Add();
                                cell = excelrow39.Cells.Add("", DataType.String, "NormalLeft");

                                int Total_Count1 = 0;

                                excelrow40 = sheet.Table.Rows.Add();
                                cell = excelrow40.Cells.Add("Report Totals:", DataType.String, "NormalLeft");

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));

                                cell = excelrow40.Cells.Add(Total_Count1 > 0 ? Total_Count1.ToString() : FundedTotal.ToString(), DataType.String, "NormalLeft");

                                List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                                var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                                if (Repenrolled_Count.Count > 0) Total_Count1 = Repenrolled_Count.Count;
                                //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                                cell = excelrow40.Cells.Add(Total_Count1.ToString(), DataType.String, "NormalLeft");

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                cell = excelrow40.Cells.Add(Total_Count1.ToString(), DataType.String, "NormalLeft");

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                cell = excelrow40.Cells.Add(Total_Count1.ToString(), DataType.String, "NormalLeft");

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                cell = excelrow40.Cells.Add(Total_Count1.ToString(), DataType.String, "NormalLeft");

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                cell = excelrow40.Cells.Add(Total_Count1.ToString(), DataType.String, "NormalLeft");

                                if (propfundingSource.Count > 0)
                                {
                                    excelrow41 = sheet.Table.Rows.Add();
                                    cell = excelrow41.Cells.Add("", DataType.String, "NormalLeft");

                                    foreach (CommonEntity FundEntity in propfundingSource)
                                    {
                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                        int EnrlCnt = 0; int Wcnt = 0;
                                        if (Fundlistcount.Count > 0)
                                        {
                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                            excelrow41 = sheet.Table.Rows.Add();
                                            cell = excelrow41.Cells.Add("     " + FundEntity.Desc, DataType.String, "NormalLeft");

                                            int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                            if (FundCnt > 0)
                                                cell = excelrow41.Cells.Add(FundCnt.ToString(), DataType.String, "NormalLeft");
                                            else
                                                cell = excelrow41.Cells.Add("", DataType.String, "NormalLeft");

                                            cell = excelrow41.Cells.Add(EnrlCnt.ToString(), DataType.String, "NormalLeft");

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                            cell = excelrow41.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");

                                            cell = excelrow41.Cells.Add(Wcnt.ToString(), DataType.String, "NormalLeft");

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                            cell = excelrow41.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                            cell = excelrow41.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");
                                        }
                                    }
                                }
                            }
                            else if (rbSelected.Checked == true)
                            {
                                foreach (ENRL_Asof_Entity Entity in Count_List)
                                {
                                    CommonEntity FundCode = SelFundingList.Find(u => u.Code.Trim().Equals(Entity.FundHie.Trim()));
                                    if (FundCode != null)
                                    {
                                        if (Entity.Site.Trim() + Entity.Room.Trim() + Entity.AMPM.Trim() != PrivSite + PrivRoom + PrivAmpm)
                                        {
                                            if (!First)
                                            {
                                                if (Entity.Site.Trim() != PrivSite)
                                                {
                                                    excelrow42 = sheet.Table.Rows.Add();
                                                    cell = excelrow42.Cells.Add("Total " + PrivSite, DataType.String, "NormalLeft");
                                                    cell = excelrow42.Cells.Add(TotFunds.ToString(), DataType.String, "NormalLeft");

                                                    string totEnroll1 = string.Empty;
                                                    if (totEnrl_cnt < TotFunds)
                                                        totEnroll1 = totEnrl_cnt.ToString() + "*";
                                                    else totEnroll1 = totEnrl_cnt.ToString();

                                                    cell = excelrow42.Cells.Add(totEnroll1.ToString(), DataType.String, "NormalLeft");

                                                    cell = excelrow42.Cells.Add(totday30_cnt.ToString(), DataType.String, "NormalLeft");

                                                    cell = excelrow42.Cells.Add(totWdraw_cnt.ToString(), DataType.String, "NormalLeft");

                                                    cell = excelrow42.Cells.Add(totFirstTime_cnt.ToString(), DataType.String, "NormalLeft");

                                                    cell = excelrow42.Cells.Add(totAttn1_cnt.ToString(), DataType.String, "NormalLeft");

                                                    if (SelFundingList.Count > 0)
                                                    {
                                                        foreach (CommonEntity FundEntity in SelFundingList)
                                                        {
                                                            List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                                            int EnrlCnt = 0; int Wcnt = 0;
                                                            if (Fundlistcount.Count > 0)
                                                            {
                                                                EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                                                Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                                                excelrow43 = sheet.Table.Rows.Add();
                                                                cell = excelrow43.Cells.Add("     " + FundEntity.Desc, DataType.String, "NormalLeft");

                                                                int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                                                if (FundCnt > 0)
                                                                    cell = excelrow43.Cells.Add(FundCnt.ToString(), DataType.String, "NormalLeft");
                                                                else
                                                                    cell = excelrow43.Cells.Add("", DataType.String, "NormalLeft");

                                                                cell = excelrow43.Cells.Add(EnrlCnt.ToString(), DataType.String, "NormalLeft");

                                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                                                cell = excelrow43.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");

                                                                cell = excelrow43.Cells.Add(Wcnt.ToString(), DataType.String, "NormalLeft");

                                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                                                cell = excelrow43.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");

                                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                                                cell = excelrow43.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");
                                                            }
                                                        }
                                                    }

                                                    totEnrl_cnt = 0; totWdraw_cnt = 0; totAttn1_cnt = 0;
                                                    totday30_cnt = 0; totFirstTime_cnt = 0; TotFunds = 0;

                                                    excelrow44 = sheet.Table.Rows.Add();
                                                    cell = excelrow44.Cells.Add("", DataType.String, "NormalLeft");

                                                    excelrow45 = sheet.Table.Rows.Add();
                                                    cell = excelrow45.Cells.Add("Site and Classrooms", DataType.String, "MainHeaderStyles");
                                                    cell = excelrow45.Cells.Add("Funded", DataType.String, "MainHeaderStyles");
                                                    cell = excelrow45.Cells.Add("Enrolled", DataType.String, "MainHeaderStyles");
                                                    cell = excelrow45.Cells.Add("30 window", DataType.String, "MainHeaderStyles");
                                                    cell = excelrow45.Cells.Add("Withdrawn", DataType.String, "MainHeaderStyles");
                                                    cell = excelrow45.Cells.Add("First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), DataType.String, "MainHeaderStyles");
                                                    cell = excelrow45.Cells.Add("Attended 1 Day", DataType.String, "MainHeaderStyles");

                                                    excelrow46 = sheet.Table.Rows.Add();
                                                    cell = excelrow46.Cells.Add(Entity.Site.Trim(), DataType.String, "NormalLeft");
                                                }
                                            }

                                            if (First)
                                            {
                                                excelrow46 = sheet.Table.Rows.Add();
                                                cell = excelrow46.Cells.Add(Entity.Site.Trim(), DataType.String, "NormalLeft");
                                            }

                                            excelrow47 = sheet.Table.Rows.Add();

                                            cell = excelrow47.Cells.Add("    " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim(), DataType.String, "NormalLeft");

                                            CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));

                                            string Enroll = string.Empty; string EnrlCntY = "0";
                                            string EnrlWd = "0"; string EnrlAttn = "0"; string EnrlW30 = "0"; string EnrlFA = "0";
                                            if (selsite != null)
                                            {
                                                cell = excelrow47.Cells.Add(selsite.SITE_FUNDED_SLOTS.Trim(), DataType.String, "NormalLeft");

                                                if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                {
                                                    List<ENRL_Asof_Entity> Enrols = Count_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM));
                                                    List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                                    var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();

                                                    if (Enrols.Count > 0)
                                                    {
                                                        EnrlCntY = enrolled_Count.Count.ToString();
                                                        //EnrlCntY = Enrols.Sum(u => int.Parse(u.Enrolled.Trim())).ToString();
                                                        EnrlWd = Enrols.Sum(u => int.Parse(u.Withdrawn.Trim())).ToString();
                                                        EnrlAttn = Enrols.Sum(u => int.Parse(u.GetAttn1.Trim())).ToString();
                                                        EnrlW30 = Enrols.Sum(u => int.Parse(u.Window30.Trim())).ToString();
                                                        EnrlFA = Enrols.Sum(u => int.Parse(u.FirstTime.Trim())).ToString();
                                                    }
                                                    if (int.Parse(EnrlCntY) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                        Enroll = EnrlCntY + "*";
                                                    else Enroll = EnrlCntY;
                                                    FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                                }
                                                else Enroll = Entity.Enrolled;
                                            }
                                            else Enroll = Entity.Enrolled;

                                            cell = excelrow47.Cells.Add(Enroll, DataType.String, "NormalLeft");
                                            cell = excelrow47.Cells.Add(EnrlW30, DataType.String, "NormalLeft");
                                            cell = excelrow47.Cells.Add(EnrlWd, DataType.String, "NormalLeft");
                                            cell = excelrow47.Cells.Add(EnrlFA, DataType.String, "NormalLeft");
                                            cell = excelrow47.Cells.Add(EnrlAttn, DataType.String, "NormalLeft");

                                            string FundDesc = string.Empty;
                                            if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                            {
                                                foreach (CommonEntity drFund in propfundingSource)
                                                {
                                                    if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                    {
                                                        FundDesc = drFund.Desc.ToString().Trim();
                                                        break;
                                                    }
                                                }
                                            }

                                            excelrow48 = sheet.Table.Rows.Add();
                                            cell = excelrow48.Cells.Add("       " + FundDesc, DataType.String, "NormalLeft");
                                            cell = excelrow48.Cells.Add("", DataType.String, "NormalLeft");
                                            cell = excelrow48.Cells.Add(Entity.Enrolled, DataType.String, "NormalLeft");
                                            cell = excelrow48.Cells.Add(Entity.Window30, DataType.String, "NormalLeft");
                                            cell = excelrow48.Cells.Add(Entity.Withdrawn, DataType.String, "NormalLeft");
                                            cell = excelrow48.Cells.Add(Entity.FirstTime, DataType.String, "NormalLeft");
                                            cell = excelrow48.Cells.Add(Entity.GetAttn1, DataType.String, "NormalLeft");


                                            First = false; PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM;
                                            totEnrl_cnt = totEnrl_cnt + int.Parse(EnrlCntY); totWdraw_cnt = totWdraw_cnt + int.Parse(EnrlWd); totAttn1_cnt = totAttn1_cnt + int.Parse(EnrlAttn);
                                            totday30_cnt = totday30_cnt + int.Parse(EnrlW30); totFirstTime_cnt = totFirstTime_cnt + int.Parse(EnrlFA);
                                            if (selsite != null)
                                            {
                                                if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                    TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                            }
                                        }
                                        else
                                        {
                                            string Fund = string.Empty;
                                            if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                            {
                                                foreach (CommonEntity drFund in propfundingSource)
                                                {
                                                    if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                    {
                                                        Fund = drFund.Desc.ToString().Trim();
                                                        break;
                                                    }
                                                }
                                            }

                                            excelrow49 = sheet.Table.Rows.Add();
                                            cell = excelrow49.Cells.Add("       " + Fund, DataType.String, "NormalLeft");
                                            cell = excelrow49.Cells.Add("", DataType.String, "NormalLeft");
                                            cell = excelrow49.Cells.Add(Entity.Enrolled, DataType.String, "NormalLeft");
                                            cell = excelrow49.Cells.Add(Entity.Window30, DataType.String, "NormalLeft");
                                            cell = excelrow49.Cells.Add(Entity.Withdrawn, DataType.String, "NormalLeft");
                                            cell = excelrow49.Cells.Add(Entity.FirstTime, DataType.String, "NormalLeft");
                                            cell = excelrow49.Cells.Add(Entity.GetAttn1, DataType.String, "NormalLeft");

                                            PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM;
                                        }
                                    }
                                }

                                excelrow50 = sheet.Table.Rows.Add();
                                cell = excelrow50.Cells.Add("Total " + PrivSite, DataType.String, "NormalLeft");
                                cell = excelrow50.Cells.Add(TotFunds.ToString(), DataType.String, "NormalLeft");

                                string totEnroll = string.Empty;
                                if (totEnrl_cnt < TotFunds)
                                    totEnroll = totEnrl_cnt.ToString() + "*";
                                else totEnroll = totEnrl_cnt.ToString();

                                cell = excelrow50.Cells.Add(totEnroll.ToString(), DataType.String, "NormalLeft");
                                cell = excelrow50.Cells.Add(totday30_cnt.ToString(), DataType.String, "NormalLeft");
                                cell = excelrow50.Cells.Add(totWdraw_cnt.ToString(), DataType.String, "NormalLeft");
                                cell = excelrow50.Cells.Add(totFirstTime_cnt.ToString(), DataType.String, "NormalLeft");
                                cell = excelrow50.Cells.Add(totAttn1_cnt.ToString(), DataType.String, "NormalLeft");

                                if (SelFundingList.Count > 0)
                                {
                                    foreach (CommonEntity FundEntity in SelFundingList)
                                    {
                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                        int EnrlCnt = 0; int Wcnt = 0;

                                        if (Fundlistcount.Count > 0)
                                        {
                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                            excelrow51 = sheet.Table.Rows.Add();
                                            cell = excelrow51.Cells.Add("     " + FundEntity.Desc, DataType.String, "NormalLeft");

                                            int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                            if (FundCnt > 0)
                                                cell = excelrow51.Cells.Add(FundCnt.ToString(), DataType.String, "NormalLeft");
                                            else
                                                cell = excelrow51.Cells.Add("", DataType.String, "NormalLeft");

                                            cell = excelrow51.Cells.Add(EnrlCnt.ToString(), DataType.String, "NormalLeft");

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                            cell = excelrow51.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");

                                            cell = excelrow51.Cells.Add(Wcnt.ToString(), DataType.String, "NormalLeft");

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                            cell = excelrow51.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                            cell = excelrow51.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");
                                        }
                                    }
                                }

                                excelrow52 = sheet.Table.Rows.Add();
                                cell = excelrow52.Cells.Add("Fund", DataType.String, "MainHeaderStyles");
                                cell = excelrow52.Cells.Add("Funded", DataType.String, "MainHeaderStyles");
                                cell = excelrow52.Cells.Add("Enrolled", DataType.String, "MainHeaderStyles");
                                cell = excelrow52.Cells.Add("30 window", DataType.String, "MainHeaderStyles");
                                cell = excelrow52.Cells.Add("Withdrawn", DataType.String, "MainHeaderStyles");
                                cell = excelrow52.Cells.Add("First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), DataType.String, "MainHeaderStyles");
                                cell = excelrow52.Cells.Add("Attended 1 Day", DataType.String, "MainHeaderStyles");

                                int Total_Count1 = 0;

                                excelrow53 = sheet.Table.Rows.Add();
                                cell = excelrow53.Cells.Add("Report Totals:", DataType.String, "NormalLeft");

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));
                                cell = excelrow53.Cells.Add(Total_Count1 > 0 ? Total_Count1.ToString() : FundedTotal.ToString(), DataType.String, "NormalLeft");

                                List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                                var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                                if (Repenrolled_Count.Count > 0) Total_Count1 = Repenrolled_Count.Count;

                                cell = excelrow53.Cells.Add(Total_Count1.ToString(), DataType.String, "NormalLeft");

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.Window30.Trim()));
                                cell = excelrow53.Cells.Add(Total_Count1.ToString(), DataType.String, "NormalLeft");

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                cell = excelrow53.Cells.Add(Total_Count1.ToString(), DataType.String, "NormalLeft");

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));
                                cell = excelrow53.Cells.Add(Total_Count1.ToString(), DataType.String, "NormalLeft");

                                Total_Count1 = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                cell = excelrow53.Cells.Add(Total_Count1.ToString(), DataType.String, "NormalLeft");

                                if (SelFundingList.Count > 0)
                                {
                                    foreach (CommonEntity FundEntity in SelFundingList)
                                    {
                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                        int EnrlCnt = 0; int Wcnt = 0;
                                        if (Fundlistcount.Count > 0)
                                        {
                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                            excelrow54 = sheet.Table.Rows.Add();
                                            cell = excelrow54.Cells.Add("     " + FundEntity.Desc, DataType.String, "NormalLeft");

                                            int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                            if (FundCnt > 0)
                                                cell = excelrow54.Cells.Add(FundCnt.ToString(), DataType.String, "NormalLeft");
                                            else
                                                cell = excelrow54.Cells.Add("", DataType.String, "NormalLeft");

                                            cell = excelrow54.Cells.Add(EnrlCnt.ToString(), DataType.String, "NormalLeft");

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                            cell = excelrow54.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");

                                            cell = excelrow54.Cells.Add(Wcnt.ToString(), DataType.String, "NormalLeft");

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                            cell = excelrow54.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");

                                            Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                            cell = excelrow54.Cells.Add(Enrl_cnt.ToString(), DataType.String, "NormalLeft");
                                        }
                                    }
                                }
                                excelrow55 = sheet.Table.Rows.Add();
                                cell = excelrow55.Cells.Add("", DataType.String, "NormalLeft");
                            }
                        }

                    }

                    excelrow56 = sheet.Table.Rows.Add();
                    cell = excelrow56.Cells.Add("", DataType.String, "NormalLeft");

                    FileStream stream1 = new FileStream(PdfName, FileMode.Create);
                    book.Save(stream1);
                    stream1.Close();
                }
                catch { Exception ex; }
            }
        }

        #endregion

        /* private void On_SaveExcelClosed(object sender, FormClosedEventArgs e)
         {

             PdfListForm form = sender as PdfListForm;
             if (form.DialogResult == DialogResult.OK)
             {
                 string PdfName = "Pdf File";
                 PdfName = form.GetFileName();
                 //PdfName = strFolderPath + PdfName;
                 PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName;
                 try
                 {
                     if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                     { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
                 }
                 catch (Exception ex)
                 {
                     AlertBox.Show("Error", MessageBoxIcon.Error);
                 }


                 try
                 {
                     string Tmpstr = PdfName + ".xls";
                     if (File.Exists(Tmpstr))
                         File.Delete(Tmpstr);
                 }
                 catch (Exception ex)
                 {
                     int length = 8;
                     string newFileName = System.Guid.NewGuid().ToString();
                     newFileName = newFileName.Replace("-", string.Empty);

                     Random_Filename = PdfName + newFileName.Substring(0, length) + ".xls";
                 }


                 if (!string.IsNullOrEmpty(Random_Filename))
                     PdfName = Random_Filename;
                 else
                     PdfName += ".xls";

                 string data = null;
                 //int i = 0;
                 //int j = 0;

                 ExcelDocument xlWorkSheet = new ExcelDocument();

                 xlWorkSheet.ColumnWidth(0, 0);
                 xlWorkSheet.ColumnWidth(1, 300);
                 xlWorkSheet.ColumnWidth(2, 120);
                 xlWorkSheet.ColumnWidth(3, 120);
                 xlWorkSheet.ColumnWidth(4, 120);
                 xlWorkSheet.ColumnWidth(5, 120);
                 xlWorkSheet.ColumnWidth(6, 150);
                 xlWorkSheet.ColumnWidth(7, 150);



                 int excelcolumn = 0;


                 if (Agency == "**") Agency = null; if (Depart == "**") Depart = null; if (Program == "**") Program = null;
                 string Year = string.Empty;
                 if (CmbYear.Visible == true)
                     Year = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString().Trim();

                 excelcolumn = excelcolumn + 1;


                 try
                 {


                     //PrintHeaderPage(document);
                     //document.NewPage();
                     //Y_Pos = 795;

                     string PrivSite = string.Empty; string PrivRoom = string.Empty; string PrivAmpm = string.Empty;

                     PdfPTable table = new PdfPTable(7);
                     table.TotalWidth = 550f;
                     table.WidthPercentage = 100;
                     table.LockedWidth = true;
                     float[] widths = new float[] { 40f, 18f, 18f, 18f, 18f, 30f, 23f };// 30f, 25f, 18f, 18f, 20f, 25f, 30f, 20f, 25f, 18f, 18f, 22f };
                     table.SetWidths(widths);
                     table.HorizontalAlignment = Element.ALIGN_CENTER;

                     excelcolumn = excelcolumn + 1;

                     if (rbSiteSummary.Checked == true)
                     {
                         if (SiteSel_List.Count > 0)
                         {
                             excelcolumn = excelcolumn + 1;
                             string[] HeaderSeq = { "Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                             for (int i = 0; i < HeaderSeq.Length; ++i)
                             {
                                 //PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                                 //cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                 //cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                 //table.AddCell(cell);
                                 xlWorkSheet[excelcolumn, (i + 1)].Font = new System.Drawing.Font("Tahoma", 10, System.Drawing.FontStyle.Bold);
                                 xlWorkSheet[excelcolumn, (i + 1)].Alignment = Alignment.Centered;
                                 xlWorkSheet.WriteCell(excelcolumn, (i + 1), HeaderSeq[i]);
                             }

                             int Enrl_cnt = 0; //int Wdraw_cnt = 0; int day30_cnt = 0; int Attn1_cnt = 0; int FirstTime_cnt = 0;
                             //int totEnrl_cnt = 0; int totWdraw_cnt = 0; int totday30_cnt = 0; int totAttn1_cnt = 0; int totFirstTime_cnt = 0; int TotFunds = 0;
                             int FundedTotal = 0;
                             excelcolumn = excelcolumn + 1;
                             foreach (ENRL_Asof_Entity Entity in SiteSel_List)
                             {
                                 excelcolumn = excelcolumn + 1;
                                 //PdfPCell SiteName = new PdfPCell(new Phrase(Entity.Site.Trim(), TableFont));
                                 //SiteName.HorizontalAlignment = Element.ALIGN_LEFT;
                                 ////SiteName.Colspan = 7;
                                 //SiteName.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                 //table.AddCell(SiteName);

                                 xlWorkSheet.WriteCell(excelcolumn, 1, Entity.Site.Trim());

                                 CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()));

                                 //PdfPCell tot_fun = new PdfPCell(new Phrase(selsite.SITE_FUNDED_SLOTS.Trim(), TableFont));
                                 //tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                 //tot_fun.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                 //table.AddCell(tot_fun);

                                 xlWorkSheet.WriteCell(excelcolumn, 2, selsite.SITE_FUNDED_SLOTS.Trim());

                                 int Count = 0;
                                 List<ENRL_Asof_Entity> SiteCount = Count_List.FindAll(u => u.Site.Trim().Equals(Entity.Site.Trim()));

                                 List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Enrolled.Equals("1"));
                                 var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                 if (enrolled_Count.Count > 0) Count = enrolled_Count.Count;

                                 //Count = SiteCount.Sum(u => int.Parse(u.Enrolled.Trim()));

                                 string Enroll = string.Empty;
                                 if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                 {
                                     if (Count < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                         Enroll = Count + "*";
                                     else Enroll = Count.ToString();

                                     FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                 }
                                 else Enroll = Count.ToString();
                                 //PdfPCell tot_enrl = new PdfPCell(new Phrase(Enroll, TableFont));
                                 //tot_enrl.HorizontalAlignment = Element.ALIGN_CENTER;
                                 //tot_enrl.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                 //table.AddCell(tot_enrl);

                                 xlWorkSheet.WriteCell(excelcolumn, 3, Enroll);

                                 Count = SiteCount.Sum(u => int.Parse(u.Window30.Trim()));
                                 //PdfPCell tot_30 = new PdfPCell(new Phrase(Count.ToString(), TableFont));
                                 //tot_30.HorizontalAlignment = Element.ALIGN_CENTER;
                                 //tot_30.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                 //table.AddCell(tot_30);

                                 xlWorkSheet.WriteCell(excelcolumn, 4, Count.ToString());

                                 Count = SiteCount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                 //PdfPCell tot_W = new PdfPCell(new Phrase(Count.ToString(), TableFont));
                                 //tot_W.HorizontalAlignment = Element.ALIGN_CENTER;
                                 //tot_W.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                 //table.AddCell(tot_W);

                                 xlWorkSheet.WriteCell(excelcolumn, 5, Count.ToString());

                                 Count = SiteCount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                 //PdfPCell tot_First = new PdfPCell(new Phrase(Count.ToString(), TableFont));
                                 //tot_First.HorizontalAlignment = Element.ALIGN_CENTER;
                                 //tot_First.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                 //table.AddCell(tot_First);

                                 xlWorkSheet.WriteCell(excelcolumn, 6, Count.ToString());

                                 Count = SiteCount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                 //PdfPCell tot_attn1 = new PdfPCell(new Phrase(Count.ToString(), TableFont));
                                 //tot_attn1.HorizontalAlignment = Element.ALIGN_CENTER;
                                 //tot_attn1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                 //table.AddCell(tot_attn1);

                                 xlWorkSheet.WriteCell(excelcolumn, 7, Count.ToString());
                             }

                             excelcolumn = excelcolumn + 5;

                             //document.Add(table);
                             //table.DeleteBodyRows();

                             //document.NewPage();
                             string[] HeaderSeq1 = { "Fund", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                             for (int i = 0; i < HeaderSeq.Length; ++i)
                             {
                                 xlWorkSheet[excelcolumn, (i + 1)].Font = new System.Drawing.Font("Tahoma", 10, System.Drawing.FontStyle.Bold);
                                 xlWorkSheet[excelcolumn, (i + 1)].Alignment = Alignment.Centered;
                                 xlWorkSheet.WriteCell(excelcolumn, (i + 1), HeaderSeq1[i]);
                             }

                             excelcolumn = excelcolumn + 1;

                             int Total_Count = 0;

                             xlWorkSheet.WriteCell(excelcolumn, 1, "Report Totals:");

                             Total_Count = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));
                             xlWorkSheet.WriteCell(excelcolumn, 2, Total_Count > 0 ? Total_Count.ToString() : FundedTotal.ToString());
                             //xlWorkSheet.WriteCell(excelcolumn, 2, FundedTotal.ToString());


                             List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                             var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                             if (Repenrolled_Count.Count > 0) Total_Count = Repenrolled_Count.Count;
                             //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                             xlWorkSheet.WriteCell(excelcolumn, 3, Total_Count.ToString());

                             Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                             xlWorkSheet.WriteCell(excelcolumn, 4, Total_Count.ToString());

                             Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                             xlWorkSheet.WriteCell(excelcolumn, 5, Total_Count.ToString());

                             Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                             xlWorkSheet.WriteCell(excelcolumn, 6, Total_Count.ToString());

                             Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                             xlWorkSheet.WriteCell(excelcolumn, 7, Total_Count.ToString());

                             if (propfundingSource.Count > 0)
                             {
                                 excelcolumn = excelcolumn + 1;
                                 foreach (CommonEntity FundEntity in propfundingSource)
                                 {
                                     excelcolumn = excelcolumn + 1;
                                     List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                     int EnrlCnt = 0; int Wcnt = 0;
                                     if (Fundlistcount.Count > 0)
                                     {
                                         EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                         Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                         xlWorkSheet.WriteCell(excelcolumn, 1, "     " + FundEntity.Desc);

                                         int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                         if (FundCnt > 0)
                                             xlWorkSheet.WriteCell(excelcolumn, 2, FundCnt.ToString());

                                         xlWorkSheet.WriteCell(excelcolumn, 3, EnrlCnt.ToString());

                                         Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                         xlWorkSheet.WriteCell(excelcolumn, 4, Enrl_cnt.ToString());

                                         xlWorkSheet.WriteCell(excelcolumn, 5, Wcnt.ToString());

                                         Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                         xlWorkSheet.WriteCell(excelcolumn, 6, Enrl_cnt.ToString());

                                         Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                         xlWorkSheet.WriteCell(excelcolumn, 7, Enrl_cnt.ToString());

                                     }
                                 }
                             }

                         }

                     }

                     if (rbRoomDetail.Checked == true)
                     {

                         CaseSiteEntity Search_Entity = new CaseSiteEntity(true);
                         Search_Entity.SiteAGENCY = Agency;
                         Search_Entity.SiteDEPT = Depart; Search_Entity.SitePROG = Program;
                         if (CmbYear.Visible == true) Search_Entity.SiteYEAR = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                         propCaseAllSiteEntity = _model.CaseMstData.Browse_CASESITE(Search_Entity, "Browse");

                         if (RoomSel_List.Count > 0)
                         {
                             bool First = true;
                             excelcolumn = excelcolumn + 1;

                             string[] HeaderSeq = { "Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                             for (int i = 0; i < HeaderSeq.Length; ++i)
                             {
                                 xlWorkSheet[excelcolumn, (i + 1)].Font = new System.Drawing.Font("Tahoma", 10, System.Drawing.FontStyle.Bold);
                                 xlWorkSheet[excelcolumn, (i + 1)].Alignment = Alignment.Centered;
                                 xlWorkSheet.WriteCell(excelcolumn, (i + 1), HeaderSeq[i]);

                             }
                             int Enrl_cnt = 0; //int Wdraw_cnt = 0; int day30_cnt = 0; int Attn1_cnt = 0; int FirstTime_cnt = 0;
                             int totEnrl_cnt = 0; int totWdraw_cnt = 0; int totday30_cnt = 0; int totAttn1_cnt = 0; int totFirstTime_cnt = 0; int TotFunds = 0;
                             int FundedTotal = 0;
                             foreach (ENRL_Asof_Entity Entity in RoomSel_List)
                             {
                                 if (!First)
                                 {

                                     if (Entity.Site.Trim() != PrivSite)
                                     {
                                         excelcolumn = excelcolumn + 1;

                                         xlWorkSheet.WriteCell(excelcolumn, 1, "Total " + PrivSite);


                                         xlWorkSheet.WriteCell(excelcolumn, 2, TotFunds.ToString());

                                         string totEnroll = string.Empty;
                                         if (totEnrl_cnt < TotFunds)
                                             totEnroll = totEnrl_cnt.ToString() + "*";
                                         else totEnroll = totEnrl_cnt.ToString();

                                         xlWorkSheet.WriteCell(excelcolumn, 3, totEnroll.ToString());

                                         xlWorkSheet.WriteCell(excelcolumn, 4, totday30_cnt.ToString());

                                         xlWorkSheet.WriteCell(excelcolumn, 5, totWdraw_cnt.ToString());

                                         xlWorkSheet.WriteCell(excelcolumn, 6, totFirstTime_cnt.ToString());

                                         xlWorkSheet.WriteCell(excelcolumn, 7, totAttn1_cnt.ToString());

                                         totEnrl_cnt = 0; totWdraw_cnt = 0; totAttn1_cnt = 0;
                                         totday30_cnt = 0; totFirstTime_cnt = 0; TotFunds = 0;

                                         excelcolumn = excelcolumn + 5;
                                         string[] HeaderSeq1 = { "Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                                         for (int i = 0; i < HeaderSeq.Length; ++i)
                                         {
                                             xlWorkSheet[excelcolumn, (i + 1)].Font = new System.Drawing.Font("Tahoma", 10, System.Drawing.FontStyle.Bold);
                                             xlWorkSheet[excelcolumn, (i + 1)].Alignment = Alignment.Centered;
                                             xlWorkSheet.WriteCell(excelcolumn, (i + 1), HeaderSeq1[i]);
                                         }

                                         excelcolumn = excelcolumn + 1;
                                         xlWorkSheet.WriteCell(excelcolumn, 1, Entity.Site.Trim());

                                     }

                                     excelcolumn = excelcolumn + 1;

                                     xlWorkSheet.WriteCell(excelcolumn, 1, "      " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim());

                                     CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));


                                     List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                     var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                     if (enrolled_Count.Count > 0) Entity.Enrolled = enrolled_Count.Count.ToString();
                                     string Enroll = string.Empty;
                                     if (selsite != null)
                                     {
                                         xlWorkSheet.WriteCell(excelcolumn, 2, selsite.SITE_FUNDED_SLOTS.Trim());
                                         if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                         {
                                             if (int.Parse(Entity.Enrolled) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                 Enroll = Entity.Enrolled + "*";
                                             else Enroll = Entity.Enrolled;

                                         }
                                         else Enroll = Entity.Enrolled;
                                     }
                                     else Enroll = Entity.Enrolled;

                                     xlWorkSheet.WriteCell(excelcolumn, 3, Enroll);


                                     xlWorkSheet.WriteCell(excelcolumn, 4, Entity.Window30);

                                     xlWorkSheet.WriteCell(excelcolumn, 5, Entity.Withdrawn);

                                     xlWorkSheet.WriteCell(excelcolumn, 6, Entity.FirstTime);

                                     xlWorkSheet.WriteCell(excelcolumn, 7, Entity.GetAttn1);

                                     totEnrl_cnt = totEnrl_cnt + int.Parse(Entity.Enrolled); totWdraw_cnt = totWdraw_cnt + int.Parse(Entity.Withdrawn); totAttn1_cnt = totAttn1_cnt + int.Parse(Entity.GetAttn1);
                                     totday30_cnt = totday30_cnt + int.Parse(Entity.Window30); totFirstTime_cnt = totFirstTime_cnt + int.Parse(Entity.FirstTime);
                                     if (selsite != null)
                                     {
                                         if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                         {
                                             TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                             FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                         }
                                     }
                                     PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM.Trim();

                                 }
                                 else
                                 {
                                     excelcolumn = excelcolumn + 1;

                                     xlWorkSheet.WriteCell(excelcolumn, 1, Entity.Site.Trim());

                                     excelcolumn = excelcolumn + 1;

                                     xlWorkSheet.WriteCell(excelcolumn, 1, "      " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim());

                                     CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));

                                     List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                     var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                     if (enrolled_Count.Count > 0) Entity.Enrolled = enrolled_Count.Count.ToString();
                                     string Enroll = string.Empty;
                                     if (selsite != null)
                                     {
                                         xlWorkSheet.WriteCell(excelcolumn, 2, selsite.SITE_FUNDED_SLOTS.Trim());

                                         if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                         {
                                             if (int.Parse(Entity.Enrolled) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                 Enroll = Entity.Enrolled + "*";
                                             else Enroll = Entity.Enrolled;
                                         }
                                         else Enroll = Entity.Enrolled;
                                     }
                                     else Enroll = Entity.Enrolled;
                                     xlWorkSheet.WriteCell(excelcolumn, 3, Enroll);

                                     xlWorkSheet.WriteCell(excelcolumn, 4, Entity.Window30);

                                     xlWorkSheet.WriteCell(excelcolumn, 5, Entity.Withdrawn);

                                     xlWorkSheet.WriteCell(excelcolumn, 6, Entity.FirstTime);

                                     xlWorkSheet.WriteCell(excelcolumn, 7, Entity.GetAttn1);

                                     totEnrl_cnt = totEnrl_cnt + int.Parse(Entity.Enrolled); totWdraw_cnt = totWdraw_cnt + int.Parse(Entity.Withdrawn); totAttn1_cnt = totAttn1_cnt + int.Parse(Entity.GetAttn1);
                                     totday30_cnt = totday30_cnt + int.Parse(Entity.Window30); totFirstTime_cnt = totFirstTime_cnt + int.Parse(Entity.FirstTime);
                                     if (selsite != null)
                                     {
                                         TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                         FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                     }
                                     PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM.Trim();


                                     excelcolumn = excelcolumn + 1;
                                 }
                                 First = false; PrivSite = Entity.Site.Trim();
                             }

                             excelcolumn = excelcolumn + 1;

                             xlWorkSheet.WriteCell(excelcolumn, 1, "Total " + PrivSite);

                             xlWorkSheet.WriteCell(excelcolumn, 2, TotFunds.ToString());

                             string totEnroll1 = string.Empty;
                             if (totEnrl_cnt < TotFunds)
                                 totEnroll1 = totEnrl_cnt.ToString() + "*";
                             else totEnroll1 = totEnrl_cnt.ToString();

                             xlWorkSheet.WriteCell(excelcolumn, 3, totEnroll1.ToString());

                             xlWorkSheet.WriteCell(excelcolumn, 4, totday30_cnt.ToString());

                             xlWorkSheet.WriteCell(excelcolumn, 5, totWdraw_cnt.ToString());

                             xlWorkSheet.WriteCell(excelcolumn, 6, totFirstTime_cnt.ToString());



                             xlWorkSheet.WriteCell(excelcolumn, 7, totAttn1_cnt.ToString());

                             excelcolumn = excelcolumn + 1;

                             string[] HeaderSeq2 = { "Fund", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                             for (int i = 0; i < HeaderSeq.Length; ++i)
                             {
                                 xlWorkSheet[excelcolumn, (i + 1)].Font = new System.Drawing.Font("Tahoma", 10, System.Drawing.FontStyle.Bold);
                                 xlWorkSheet[excelcolumn, (i + 1)].Alignment = Alignment.Centered;
                                 xlWorkSheet.WriteCell(excelcolumn, (i + 1), HeaderSeq2[i]);
                             }

                             excelcolumn = excelcolumn + 1;
                             int Total_Count = 0;

                             xlWorkSheet.WriteCell(excelcolumn, 1, "Report Totals:");

                             Total_Count = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));

                             xlWorkSheet.WriteCell(excelcolumn, 2, Total_Count > 0 ? Total_Count.ToString() : FundedTotal.ToString());
                             //xlWorkSheet.WriteCell(excelcolumn, 2, FundedTotal.ToString());


                             List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                             var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                             if (Repenrolled_Count.Count > 0) Total_Count = Repenrolled_Count.Count;
                             //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                             xlWorkSheet.WriteCell(excelcolumn, 3, Total_Count.ToString());

                             Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                             xlWorkSheet.WriteCell(excelcolumn, 4, Total_Count.ToString());

                             Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                             xlWorkSheet.WriteCell(excelcolumn, 5, Total_Count.ToString());

                             Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                             xlWorkSheet.WriteCell(excelcolumn, 6, Total_Count.ToString());

                             Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                             xlWorkSheet.WriteCell(excelcolumn, 7, Total_Count.ToString());

                             excelcolumn = excelcolumn + 1;
                             if (propfundingSource.Count > 0)
                             {
                                 foreach (CommonEntity FundEntity in propfundingSource)
                                 {
                                     excelcolumn = excelcolumn + 1;
                                     List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                     int EnrlCnt = 0; int Wcnt = 0;
                                     if (Fundlistcount.Count > 0)
                                     {
                                         EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                         Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                         //if (EnrlCnt > 0 || Wcnt > 0)
                                         //{
                                         xlWorkSheet.WriteCell(excelcolumn, 1, "      " + FundEntity.Desc);

                                         int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                         if (FundCnt > 0)
                                             xlWorkSheet.WriteCell(excelcolumn, 2, FundCnt.ToString());

                                         xlWorkSheet.WriteCell(excelcolumn, 3, EnrlCnt.ToString());

                                         Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                         xlWorkSheet.WriteCell(excelcolumn, 4, Enrl_cnt.ToString());

                                         xlWorkSheet.WriteCell(excelcolumn, 5, Wcnt.ToString());


                                         Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                         xlWorkSheet.WriteCell(excelcolumn, 6, Enrl_cnt.ToString());

                                         Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                         xlWorkSheet.WriteCell(excelcolumn, 7, Enrl_cnt.ToString());
                                         //}
                                     }
                                 }
                             }
                         }
                     }

                     if (rbFundDetailByRoom.Checked == true)
                     {
                         CaseSiteEntity Search_Entity = new CaseSiteEntity(true);
                         Search_Entity.SiteAGENCY = Agency;
                         Search_Entity.SiteDEPT = Depart; Search_Entity.SitePROG = Program;
                         if (CmbYear.Visible == true) Search_Entity.SiteYEAR = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                         propCaseAllSiteEntity = _model.CaseMstData.Browse_CASESITE(Search_Entity, "Browse");


                         if (Count_List.Count > 0)
                         {
                             bool First = true;

                             excelcolumn = excelcolumn + 1;

                             string[] HeaderSeq = { "Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "Firsttime Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                             for (int i = 0; i < HeaderSeq.Length; ++i)
                             {
                                 //PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                                 //cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                 ////cell.FixedHeight = 15f;
                                 //cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                 //table.AddCell(cell);

                                 xlWorkSheet[excelcolumn, (i + 1)].Font = new System.Drawing.Font("Tahoma", 10, System.Drawing.FontStyle.Bold);
                                 xlWorkSheet[excelcolumn, (i + 1)].Alignment = Alignment.Centered;
                                 xlWorkSheet.WriteCell(excelcolumn, (i + 1), HeaderSeq[i]);

                             }
                             excelcolumn = excelcolumn + 1;
                             int Enrl_cnt = 0; //int Wdraw_cnt = 0; int day30_cnt = 0; int Attn1_cnt = 0; int FirstTime_cnt = 0;
                             int totEnrl_cnt = 0; int totWdraw_cnt = 0; int totday30_cnt = 0; int totAttn1_cnt = 0; int totFirstTime_cnt = 0; int TotFunds = 0;
                             int FundedTotal = 0;
                             if (rbAll.Checked == true)
                             {
                                 foreach (ENRL_Asof_Entity Entity in Count_List)
                                 {
                                     if (Entity.Site.Trim() + Entity.Room.Trim() + Entity.AMPM.Trim() != PrivSite + PrivRoom + PrivAmpm)
                                     {
                                         if (!First)
                                         {
                                             excelcolumn = excelcolumn + 1;

                                             if (Entity.Site.Trim() != PrivSite)
                                             {
                                                 int Total_Count = 0;

                                                 //PdfPCell Rep = new PdfPCell(new Phrase("Total " + PrivSite, TableFont));
                                                 //Rep.HorizontalAlignment = Element.ALIGN_LEFT;
                                                 //Rep.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                 //table.AddCell(Rep);

                                                 xlWorkSheet.WriteCell(excelcolumn, 1, "Total " + PrivSite);

                                                 //PdfPCell Rep1 = new PdfPCell(new Phrase(TotFunds.ToString(), TableFont));
                                                 //Rep1.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 //Rep1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                 //table.AddCell(Rep1);

                                                 xlWorkSheet.WriteCell(excelcolumn, 2, TotFunds.ToString());

                                                 //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                                                 string totEnroll1 = string.Empty;
                                                 if (totEnrl_cnt < TotFunds)
                                                     totEnroll1 = totEnrl_cnt.ToString() + "*";
                                                 else totEnroll1 = totEnrl_cnt.ToString();

                                                 //PdfPCell Rep2 = new PdfPCell(new Phrase(totEnroll1.ToString(), TableFont));
                                                 //Rep2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 //Rep2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                 //table.AddCell(Rep2);

                                                 xlWorkSheet.WriteCell(excelcolumn, 3, totEnroll1.ToString());

                                                 //Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                                 //PdfPCell Rep3 = new PdfPCell(new Phrase(totday30_cnt.ToString(), TableFont));
                                                 //Rep3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 //Rep3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                 //table.AddCell(Rep3);

                                                 xlWorkSheet.WriteCell(excelcolumn, 4, totday30_cnt.ToString());

                                                 //Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                                 //PdfPCell Rep4 = new PdfPCell(new Phrase(totWdraw_cnt.ToString(), TableFont));
                                                 //Rep4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 //Rep4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                 //table.AddCell(Rep4);

                                                 xlWorkSheet.WriteCell(excelcolumn, 5, totWdraw_cnt.ToString());

                                                 //Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                                 //PdfPCell Rep5 = new PdfPCell(new Phrase(totFirstTime_cnt.ToString(), TableFont));
                                                 //Rep5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 //Rep5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                 //table.AddCell(Rep5);

                                                 xlWorkSheet.WriteCell(excelcolumn, 6, totFirstTime_cnt.ToString());

                                                 //Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                                 //PdfPCell Rep6 = new PdfPCell(new Phrase(totAttn1_cnt.ToString(), TableFont));
                                                 //Rep6.HorizontalAlignment = Element.ALIGN_CENTER;
                                                 //Rep6.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                 //table.AddCell(Rep6);

                                                 xlWorkSheet.WriteCell(excelcolumn, 7, totAttn1_cnt.ToString());

                                                 if (propfundingSource.Count > 0)
                                                 {
                                                     excelcolumn = excelcolumn + 1;

                                                     foreach (CommonEntity FundEntity in propfundingSource)
                                                     {
                                                         List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                                         int EnrlCnt = 0; int Wcnt = 0;
                                                         if (Fundlistcount.Count > 0)
                                                         {
                                                             EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                                             Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                                             //if (EnrlCnt > 0 || Wcnt > 0)
                                                             //{
                                                             excelcolumn = excelcolumn + 1;
                                                             //PdfPCell Fund = new PdfPCell(new Phrase("       " + FundEntity.Desc, TableFont));
                                                             //Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                                             //Fund.Colspan = 2;
                                                             //Fund.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                             //table.AddCell(Fund);

                                                             xlWorkSheet.WriteCell(excelcolumn, 1, "       " + FundEntity.Desc);

                                                             //PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                                             //Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                                             //Fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                             //table.AddCell(Fund1);

                                                             xlWorkSheet.WriteCell(excelcolumn, 3, EnrlCnt.ToString());

                                                             Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                                             //PdfPCell Fund2 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                             //Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                                             //Fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                             //table.AddCell(Fund2);

                                                             xlWorkSheet.WriteCell(excelcolumn, 4, Enrl_cnt.ToString());

                                                             ////Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                                             //PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                                             //Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                                             //Fund3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                             //table.AddCell(Fund3);

                                                             xlWorkSheet.WriteCell(excelcolumn, 5, Wcnt.ToString());

                                                             Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                                             //PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                             //Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                                             //Fund4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                             //table.AddCell(Fund4);

                                                             xlWorkSheet.WriteCell(excelcolumn, 6, Enrl_cnt.ToString());

                                                             Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                                             //PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                                             //Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                                             //Fund5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                             //table.AddCell(Fund5);

                                                             xlWorkSheet.WriteCell(excelcolumn, 7, Enrl_cnt.ToString());
                                                             //}
                                                         }
                                                     }
                                                 }

                                                 totEnrl_cnt = 0; totWdraw_cnt = 0; totAttn1_cnt = 0;
                                                 totday30_cnt = 0; totFirstTime_cnt = 0; TotFunds = 0;
                                                 excelcolumn = excelcolumn + 1;
                                                 //if (table.Rows.Count > 1)
                                                 //{
                                                 //    //document.Add(table);
                                                 //    //table.DeleteBodyRows();
                                                 //    //document.NewPage();
                                                 //}
                                                 excelcolumn = excelcolumn + 1;
                                                 string[] HeaderSeq3 = { "Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                                                 for (int i = 0; i < HeaderSeq3.Length; ++i)
                                                 {
                                                     //PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq3[i], TblFontBold));
                                                     //cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                                     ////cell.FixedHeight = 15f;
                                                     //cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                                     //table.AddCell(cell);

                                                     xlWorkSheet[excelcolumn, (i + 1)].Font = new System.Drawing.Font("Tahoma", 10, System.Drawing.FontStyle.Bold);
                                                     xlWorkSheet[excelcolumn, (i + 1)].Alignment = Alignment.Centered;
                                                     xlWorkSheet.WriteCell(excelcolumn, (i + 1), HeaderSeq3[i]);

                                                 }
                                                 //PdfPCell SiteName1 = new PdfPCell(new Phrase(Entity.Site.Trim(), TableFont));
                                                 //SiteName1.HorizontalAlignment = Element.ALIGN_LEFT;
                                                 //SiteName1.Colspan = 7;
                                                 //SiteName1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                                 //table.AddCell(SiteName1);
                                                 excelcolumn = excelcolumn + 1;
                                                 xlWorkSheet.WriteCell(excelcolumn, 1, Entity.Site.Trim());
                                             }
                                         }

                                         if (First)
                                         {

                                             excelcolumn = excelcolumn + 1;
                                             xlWorkSheet.WriteCell(excelcolumn, 1, Entity.Site.Trim());
                                         }

                                         excelcolumn = excelcolumn + 1;

                                         xlWorkSheet.WriteCell(excelcolumn, 1, "    " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim());


                                         CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));

                                         string Enroll = string.Empty; string EnrlCntY = "0";
                                         string EnrlWd = "0"; string EnrlAttn = "0"; string EnrlW30 = "0"; string EnrlFA = "0";
                                         if (selsite != null)
                                         {
                                             xlWorkSheet.WriteCell(excelcolumn, 2, selsite.SITE_FUNDED_SLOTS.Trim());

                                             if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                             {

                                                 List<ENRL_Asof_Entity> Enrols = Count_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM));
                                                 List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                                 var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                                 if (Enrols.Count > 0)
                                                 {
                                                     EnrlCntY = enrolled_Count.Count.ToString();
                                                     //EnrlCntY = Enrols.Sum(u => int.Parse(u.Enrolled.Trim())).ToString();
                                                     EnrlWd = Enrols.Sum(u => int.Parse(u.Withdrawn.Trim())).ToString();
                                                     EnrlAttn = Enrols.Sum(u => int.Parse(u.GetAttn1.Trim())).ToString();
                                                     EnrlW30 = Enrols.Sum(u => int.Parse(u.Window30.Trim())).ToString();
                                                     EnrlFA = Enrols.Sum(u => int.Parse(u.FirstTime.Trim())).ToString();
                                                 }

                                                 if (int.Parse(EnrlCntY) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                     Enroll = EnrlCntY + "*";
                                                 else Enroll = EnrlCntY;
                                                 FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                             }
                                             else Enroll = Entity.Enrolled;
                                         }
                                         else Enroll = Entity.Enrolled;
                                         //PdfPCell tot_fun = new PdfPCell(new Phrase(selsite.SITE_FUNDED_SLOTS.Trim(), TableFont));
                                         //tot_fun.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //tot_fun.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(tot_fun);



                                         //PdfPCell tot_enrl = new PdfPCell(new Phrase(Enroll, TableFont));
                                         //tot_enrl.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //tot_enrl.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(tot_enrl);

                                         xlWorkSheet.WriteCell(excelcolumn, 3, Enroll);

                                         //PdfPCell tot_30 = new PdfPCell(new Phrase(Entity.Window30, TableFont));
                                         //tot_30.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //tot_30.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(tot_30);

                                         xlWorkSheet.WriteCell(excelcolumn, 4, EnrlW30);

                                         //PdfPCell tot_W = new PdfPCell(new Phrase(Entity.Withdrawn, TableFont));
                                         //tot_W.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //tot_W.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(tot_W);

                                         xlWorkSheet.WriteCell(excelcolumn, 5, EnrlWd);

                                         //PdfPCell tot_First = new PdfPCell(new Phrase(Entity.FirstTime, TableFont));
                                         //tot_First.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //tot_First.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(tot_First);

                                         xlWorkSheet.WriteCell(excelcolumn, 6, EnrlFA);

                                         //PdfPCell tot_attn12 = new PdfPCell(new Phrase(Entity.GetAttn1, TableFont));
                                         //tot_attn12.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //tot_attn12.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(tot_attn12);

                                         xlWorkSheet.WriteCell(excelcolumn, 7, EnrlAttn);



                                         string FundDesc = string.Empty;
                                         if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                         {
                                             foreach (CommonEntity drFund in propfundingSource)
                                             {
                                                 if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                 {
                                                     FundDesc = drFund.Desc.ToString().Trim();
                                                     break;
                                                 }
                                             }
                                         }

                                         excelcolumn = excelcolumn + 1;

                                         //PdfPCell row2 = new PdfPCell(new Phrase("       " + FundDesc, TableFont));
                                         //row2.HorizontalAlignment = Element.ALIGN_LEFT;
                                         //row2.Colspan = 2;
                                         //row2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(row2);

                                         xlWorkSheet.WriteCell(excelcolumn, 1, "       " + FundDesc);

                                         //PdfPCell tot_enrl1 = new PdfPCell(new Phrase(Entity.Enrolled, TableFont));
                                         //tot_enrl1.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //tot_enrl1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(tot_enrl1);

                                         xlWorkSheet.WriteCell(excelcolumn, 3, Entity.Enrolled);

                                         //PdfPCell tot_301 = new PdfPCell(new Phrase(Entity.Window30, TableFont));
                                         //tot_301.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //tot_301.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(tot_301);

                                         xlWorkSheet.WriteCell(excelcolumn, 4, Entity.Window30);

                                         //PdfPCell tot_W1 = new PdfPCell(new Phrase(Entity.Withdrawn, TableFont));
                                         //tot_W1.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //tot_W1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(tot_W1);

                                         xlWorkSheet.WriteCell(excelcolumn, 5, Entity.Withdrawn);

                                         //PdfPCell tot_First1 = new PdfPCell(new Phrase(Entity.FirstTime, TableFont));
                                         //tot_First1.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //tot_First1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(tot_First1);

                                         xlWorkSheet.WriteCell(excelcolumn, 6, Entity.FirstTime);

                                         //PdfPCell tot_attn121 = new PdfPCell(new Phrase(Entity.GetAttn1, TableFont));
                                         //tot_attn121.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //tot_attn121.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(tot_attn121);

                                         xlWorkSheet.WriteCell(excelcolumn, 7, Entity.GetAttn1);

                                         First = false; PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM;
                                         totEnrl_cnt = totEnrl_cnt + int.Parse(EnrlCntY); totWdraw_cnt = totWdraw_cnt + int.Parse(EnrlWd); totAttn1_cnt = totAttn1_cnt + int.Parse(EnrlAttn);
                                         totday30_cnt = totday30_cnt + int.Parse(EnrlW30); totFirstTime_cnt = totFirstTime_cnt + int.Parse(EnrlFA);
                                         if (selsite != null)
                                         {
                                             if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                 TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                         }

                                     }
                                     else
                                     {
                                         string Fund = string.Empty;
                                         if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                         {
                                             foreach (CommonEntity drFund in propfundingSource)
                                             {
                                                 if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                 {
                                                     Fund = drFund.Desc.ToString().Trim();
                                                     break;
                                                 }
                                             }
                                         }

                                         excelcolumn = excelcolumn + 1;

                                         //PdfPCell row2 = new PdfPCell(new Phrase("       " + Fund, TableFont));
                                         //row2.HorizontalAlignment = Element.ALIGN_LEFT;
                                         //row2.Colspan = 2;
                                         //row2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(row2);

                                         xlWorkSheet.WriteCell(excelcolumn, 1, "       " + Fund);

                                         //PdfPCell tot_enrl1 = new PdfPCell(new Phrase(Entity.Enrolled, TableFont));
                                         //tot_enrl1.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //tot_enrl1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(tot_enrl1);

                                         xlWorkSheet.WriteCell(excelcolumn, 3, Entity.Enrolled);

                                         //PdfPCell tot_301 = new PdfPCell(new Phrase(Entity.Window30, TableFont));
                                         //tot_301.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //tot_301.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(tot_301);

                                         xlWorkSheet.WriteCell(excelcolumn, 4, Entity.Window30);

                                         //PdfPCell tot_W1 = new PdfPCell(new Phrase(Entity.Withdrawn, TableFont));
                                         //tot_W1.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //tot_W1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(tot_W1);

                                         xlWorkSheet.WriteCell(excelcolumn, 5, Entity.Withdrawn);

                                         //PdfPCell tot_First1 = new PdfPCell(new Phrase(Entity.FirstTime, TableFont));
                                         //tot_First1.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //tot_First1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(tot_First1);

                                         xlWorkSheet.WriteCell(excelcolumn, 6, Entity.FirstTime);

                                         //PdfPCell tot_attn121 = new PdfPCell(new Phrase(Entity.GetAttn1, TableFont));
                                         //tot_attn121.HorizontalAlignment = Element.ALIGN_CENTER;
                                         //tot_attn121.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                         //table.AddCell(tot_attn121);

                                         xlWorkSheet.WriteCell(excelcolumn, 7, Entity.GetAttn1);

                                         PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM;
                                     }

                                 }

                                 //document.Add(table);
                                 //table.DeleteBodyRows();

                                 excelcolumn = excelcolumn + 1;

                                 //PdfPCell Rep111 = new PdfPCell(new Phrase("Total " + PrivSite, TableFont));
                                 //Rep111.HorizontalAlignment = Element.ALIGN_LEFT;
                                 //Rep111.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                 //table.AddCell(Rep111);

                                 xlWorkSheet.WriteCell(excelcolumn, 1, "Total " + PrivSite);


                                 //PdfPCell Rep11 = new PdfPCell(new Phrase(TotFunds.ToString(), TableFont));
                                 //Rep11.HorizontalAlignment = Element.ALIGN_CENTER;
                                 //Rep11.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                 //table.AddCell(Rep11);

                                 xlWorkSheet.WriteCell(excelcolumn, 2, TotFunds.ToString());

                                 //Total_Count = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                                 string totEnroll = string.Empty;
                                 if (totEnrl_cnt < TotFunds)
                                     totEnroll = totEnrl_cnt.ToString() + "*";
                                 else totEnroll = totEnrl_cnt.ToString();

                                 //PdfPCell Rep21 = new PdfPCell(new Phrase(totEnroll.ToString(), TableFont));
                                 //Rep21.HorizontalAlignment = Element.ALIGN_CENTER;
                                 //Rep21.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                 //table.AddCell(Rep21);

                                 xlWorkSheet.WriteCell(excelcolumn, 3, totEnroll.ToString());

                                 //Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                 //PdfPCell Rep31 = new PdfPCell(new Phrase(totday30_cnt.ToString(), TableFont));
                                 //Rep31.HorizontalAlignment = Element.ALIGN_CENTER;
                                 //Rep31.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                 //table.AddCell(Rep31);

                                 xlWorkSheet.WriteCell(excelcolumn, 4, totday30_cnt.ToString());

                                 //Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                 //PdfPCell Rep41 = new PdfPCell(new Phrase(totWdraw_cnt.ToString(), TableFont));
                                 //Rep41.HorizontalAlignment = Element.ALIGN_CENTER;
                                 //Rep41.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                 //table.AddCell(Rep41);

                                 xlWorkSheet.WriteCell(excelcolumn, 5, totWdraw_cnt.ToString());

                                 ////Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                 //PdfPCell Rep51 = new PdfPCell(new Phrase(totFirstTime_cnt.ToString(), TableFont));
                                 //Rep51.HorizontalAlignment = Element.ALIGN_CENTER;
                                 //Rep51.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                 //table.AddCell(Rep51);

                                 xlWorkSheet.WriteCell(excelcolumn, 6, totFirstTime_cnt.ToString());

                                 ////Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                 //PdfPCell Rep61 = new PdfPCell(new Phrase(totAttn1_cnt.ToString(), TableFont));
                                 //Rep61.HorizontalAlignment = Element.ALIGN_CENTER;
                                 //Rep61.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                 //table.AddCell(Rep61);

                                 xlWorkSheet.WriteCell(excelcolumn, 7, totAttn1_cnt.ToString());

                                 excelcolumn = excelcolumn + 1;

                                 if (SelFundingList.Count > 0)
                                 {
                                     foreach (CommonEntity FundEntity in SelFundingList)
                                     {
                                         List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                         int EnrlCnt = 0; int Wcnt = 0;
                                         if (Fundlistcount.Count > 0)
                                         {


                                             EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                             Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                             //if (EnrlCnt > 0 || Wcnt > 0)
                                             //{
                                             excelcolumn = excelcolumn + 1;

                                             //PdfPCell Fund = new PdfPCell(new Phrase("       " + FundEntity.Desc, TableFont));
                                             //Fund.HorizontalAlignment = Element.ALIGN_LEFT;
                                             //Fund.Colspan = 2;
                                             //Fund.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                             //table.AddCell(Fund);

                                             xlWorkSheet.WriteCell(excelcolumn, 1, "       " + FundEntity.Desc);

                                             //PdfPCell Fund1 = new PdfPCell(new Phrase(EnrlCnt.ToString(), TableFont));
                                             //Fund1.HorizontalAlignment = Element.ALIGN_CENTER;
                                             //Fund1.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                             //table.AddCell(Fund1);

                                             xlWorkSheet.WriteCell(excelcolumn, 3, EnrlCnt.ToString());

                                             Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                             //PdfPCell Fund2 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                             //Fund2.HorizontalAlignment = Element.ALIGN_CENTER;
                                             //Fund2.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                             //table.AddCell(Fund2);

                                             xlWorkSheet.WriteCell(excelcolumn, 4, Enrl_cnt.ToString());

                                             ////Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u..Trim()));
                                             //PdfPCell Fund3 = new PdfPCell(new Phrase(Wcnt.ToString(), TableFont));
                                             //Fund3.HorizontalAlignment = Element.ALIGN_CENTER;
                                             //Fund3.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                             //table.AddCell(Fund3);

                                             xlWorkSheet.WriteCell(excelcolumn, 5, Wcnt.ToString());

                                             Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                             //PdfPCell Fund4 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                             //Fund4.HorizontalAlignment = Element.ALIGN_CENTER;
                                             //Fund4.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                             //table.AddCell(Fund4);

                                             xlWorkSheet.WriteCell(excelcolumn, 6, Enrl_cnt.ToString());

                                             Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                             //PdfPCell Fund5 = new PdfPCell(new Phrase(Enrl_cnt.ToString(), TableFont));
                                             //Fund5.HorizontalAlignment = Element.ALIGN_CENTER;
                                             //Fund5.Border = iTextSharp.text.Rectangle.NO_BORDER;
                                             //table.AddCell(Fund5);

                                             xlWorkSheet.WriteCell(excelcolumn, 7, Enrl_cnt.ToString());
                                             //}
                                         }
                                     }
                                 }

                                 //document.Add(table);
                                 //table.DeleteBodyRows();

                                 //document.NewPage();

                                 excelcolumn = excelcolumn + 5;

                                 excelcolumn = excelcolumn + 1;
                                 string[] HeaderSeq2 = { "Fund", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                                 for (int i = 0; i < HeaderSeq.Length; ++i)
                                 {
                                     xlWorkSheet[excelcolumn, (i + 1)].Font = new System.Drawing.Font("Tahoma", 10, System.Drawing.FontStyle.Bold);
                                     xlWorkSheet[excelcolumn, (i + 1)].Alignment = Alignment.Centered;
                                     xlWorkSheet.WriteCell(excelcolumn, (i + 1), HeaderSeq2[i]);

                                 }

                                 excelcolumn = excelcolumn + 1;

                                 int Total_Count1 = 0;
                                 xlWorkSheet.WriteCell(excelcolumn, 1, "Report Totals:");

                                 Total_Count1 = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));
                                 xlWorkSheet.WriteCell(excelcolumn, 2, Total_Count1 > 0 ? Total_Count1.ToString() : FundedTotal.ToString());
                                 //xlWorkSheet.WriteCell(excelcolumn, 2, FundedTotal.ToString());


                                 List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                                 var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                                 if (Repenrolled_Count.Count > 0) Total_Count1 = Repenrolled_Count.Count;

                                 xlWorkSheet.WriteCell(excelcolumn, 3, Total_Count1.ToString());

                                 Total_Count1 = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                 xlWorkSheet.WriteCell(excelcolumn, 4, Total_Count1.ToString());

                                 Total_Count1 = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                 xlWorkSheet.WriteCell(excelcolumn, 5, Total_Count1.ToString());

                                 Total_Count1 = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                 xlWorkSheet.WriteCell(excelcolumn, 6, Total_Count1.ToString());

                                 Total_Count1 = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                 xlWorkSheet.WriteCell(excelcolumn, 7, Total_Count1.ToString());

                                 if (propfundingSource.Count > 0)
                                 {
                                     excelcolumn = excelcolumn + 1;
                                     foreach (CommonEntity FundEntity in propfundingSource)
                                     {
                                         List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                         int EnrlCnt = 0; int Wcnt = 0;
                                         if (Fundlistcount.Count > 0)
                                         {


                                             EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                             Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                             excelcolumn = excelcolumn + 1;

                                             xlWorkSheet.WriteCell(excelcolumn, 1, "       " + FundEntity.Desc);

                                             int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                             if (FundCnt > 0)
                                                 xlWorkSheet.WriteCell(excelcolumn, 2, FundCnt.ToString());

                                             xlWorkSheet.WriteCell(excelcolumn, 3, EnrlCnt.ToString());

                                             Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                             xlWorkSheet.WriteCell(excelcolumn, 4, Enrl_cnt.ToString());

                                             xlWorkSheet.WriteCell(excelcolumn, 5, Wcnt.ToString());

                                             Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                             xlWorkSheet.WriteCell(excelcolumn, 6, Enrl_cnt.ToString());


                                             Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));
                                             xlWorkSheet.WriteCell(excelcolumn, 7, Enrl_cnt.ToString());
                                         }
                                     }
                                 }
                             }
                             else if (rbSelected.Checked == true)
                             {
                                 foreach (ENRL_Asof_Entity Entity in Count_List)
                                 {
                                     CommonEntity FundCode = SelFundingList.Find(u => u.Code.Trim().Equals(Entity.FundHie.Trim()));
                                     if (FundCode != null)
                                     {
                                         if (Entity.Site.Trim() + Entity.Room.Trim() + Entity.AMPM.Trim() != PrivSite + PrivRoom + PrivAmpm)
                                         {
                                             if (!First)
                                             {
                                                 if (Entity.Site.Trim() != PrivSite)
                                                 {
                                                     excelcolumn = excelcolumn + 1;

                                                     xlWorkSheet.WriteCell(excelcolumn, 1, "Total " + PrivSite);

                                                     xlWorkSheet.WriteCell(excelcolumn, 2, TotFunds.ToString());


                                                     string totEnroll1 = string.Empty;
                                                     if (totEnrl_cnt < TotFunds)
                                                         totEnroll1 = totEnrl_cnt.ToString() + "*";
                                                     else totEnroll1 = totEnrl_cnt.ToString();

                                                     xlWorkSheet.WriteCell(excelcolumn, 3, totEnroll1.ToString());

                                                     xlWorkSheet.WriteCell(excelcolumn, 4, totday30_cnt.ToString());

                                                     xlWorkSheet.WriteCell(excelcolumn, 5, totWdraw_cnt.ToString());

                                                     xlWorkSheet.WriteCell(excelcolumn, 6, totFirstTime_cnt.ToString());

                                                     xlWorkSheet.WriteCell(excelcolumn, 7, totAttn1_cnt.ToString());

                                                     if (SelFundingList.Count > 0)
                                                     {
                                                         foreach (CommonEntity FundEntity in SelFundingList)
                                                         {
                                                             List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                                             int EnrlCnt = 0; int Wcnt = 0;
                                                             if (Fundlistcount.Count > 0)
                                                             {
                                                                 EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                                                 Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                                                 excelcolumn = excelcolumn + 1;


                                                                 xlWorkSheet.WriteCell(excelcolumn, 1, "       " + FundEntity.Desc);

                                                                 int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                                                 if (FundCnt > 0)
                                                                     xlWorkSheet.WriteCell(excelcolumn, 2, FundCnt.ToString());


                                                                 xlWorkSheet.WriteCell(excelcolumn, 3, EnrlCnt.ToString());

                                                                 Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                                                 xlWorkSheet.WriteCell(excelcolumn, 4, Enrl_cnt.ToString());


                                                                 xlWorkSheet.WriteCell(excelcolumn, 5, Wcnt.ToString());

                                                                 Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                                                 xlWorkSheet.WriteCell(excelcolumn, 6, Enrl_cnt.ToString());

                                                                 Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                                                 xlWorkSheet.WriteCell(excelcolumn, 7, Enrl_cnt.ToString());

                                                             }
                                                         }
                                                     }

                                                     totEnrl_cnt = 0; totWdraw_cnt = 0; totAttn1_cnt = 0;
                                                     totday30_cnt = 0; totFirstTime_cnt = 0; TotFunds = 0;

                                                     excelcolumn = excelcolumn + 1;

                                                     string[] HeaderSeq3 = { "Site and Classrooms", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                                                     for (int i = 0; i < HeaderSeq.Length; ++i)
                                                     {
                                                         xlWorkSheet[excelcolumn, (i + 1)].Font = new System.Drawing.Font("Tahoma", 10, System.Drawing.FontStyle.Bold);
                                                         xlWorkSheet[excelcolumn, (i + 1)].Alignment = Alignment.Centered;
                                                         xlWorkSheet.WriteCell(excelcolumn, (i + 1), HeaderSeq3[i]);

                                                     }
                                                     excelcolumn = excelcolumn + 1;

                                                     xlWorkSheet.WriteCell(excelcolumn, 1, Entity.Site.Trim());
                                                 }
                                             }

                                             if (First)
                                             {
                                                 excelcolumn = excelcolumn + 1;
                                                 xlWorkSheet.WriteCell(excelcolumn, 1, Entity.Site.Trim());
                                             }

                                             excelcolumn = excelcolumn + 1;


                                             xlWorkSheet.WriteCell(excelcolumn, 1, "    " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim());

                                             CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));

                                             string Enroll = string.Empty; string EnrlCntY = "0";
                                             string EnrlWd = "0"; string EnrlAttn = "0"; string EnrlW30 = "0"; string EnrlFA = "0";
                                             if (selsite != null)
                                             {
                                                 xlWorkSheet.WriteCell(excelcolumn, 2, selsite.SITE_FUNDED_SLOTS.Trim());

                                                 if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                 {

                                                     List<ENRL_Asof_Entity> Enrols = Count_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM));
                                                     List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                                     var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();

                                                     if (Enrols.Count > 0)
                                                     {
                                                         EnrlCntY = enrolled_Count.Count.ToString();
                                                         //EnrlCntY = Enrols.Sum(u => int.Parse(u.Enrolled.Trim())).ToString();
                                                         EnrlWd = Enrols.Sum(u => int.Parse(u.Withdrawn.Trim())).ToString();
                                                         EnrlAttn = Enrols.Sum(u => int.Parse(u.GetAttn1.Trim())).ToString();
                                                         EnrlW30 = Enrols.Sum(u => int.Parse(u.Window30.Trim())).ToString();
                                                         EnrlFA = Enrols.Sum(u => int.Parse(u.FirstTime.Trim())).ToString();
                                                     }


                                                     if (int.Parse(EnrlCntY) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                         Enroll = EnrlCntY + "*";
                                                     else Enroll = EnrlCntY;
                                                     FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                                 }
                                                 else Enroll = Entity.Enrolled;
                                             }
                                             else Enroll = Entity.Enrolled;

                                             xlWorkSheet.WriteCell(excelcolumn, 3, Enroll);

                                             xlWorkSheet.WriteCell(excelcolumn, 4, EnrlW30);

                                             xlWorkSheet.WriteCell(excelcolumn, 5, EnrlWd);

                                             xlWorkSheet.WriteCell(excelcolumn, 6, EnrlFA);

                                             xlWorkSheet.WriteCell(excelcolumn, 7, EnrlAttn);

                                             string FundDesc = string.Empty;
                                             if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                             {
                                                 foreach (CommonEntity drFund in propfundingSource)
                                                 {
                                                     if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                     {
                                                         FundDesc = drFund.Desc.ToString().Trim();
                                                         break;
                                                     }
                                                 }
                                             }

                                             excelcolumn = excelcolumn + 1;

                                             xlWorkSheet.WriteCell(excelcolumn, 1, "       " + FundDesc);

                                             xlWorkSheet.WriteCell(excelcolumn, 3, Entity.Enrolled);

                                             xlWorkSheet.WriteCell(excelcolumn, 4, Entity.Window30);

                                             xlWorkSheet.WriteCell(excelcolumn, 5, Entity.Withdrawn);

                                             xlWorkSheet.WriteCell(excelcolumn, 6, Entity.FirstTime);

                                             xlWorkSheet.WriteCell(excelcolumn, 7, Entity.GetAttn1);

                                             First = false; PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM;
                                             totEnrl_cnt = totEnrl_cnt + int.Parse(EnrlCntY); totWdraw_cnt = totWdraw_cnt + int.Parse(EnrlWd); totAttn1_cnt = totAttn1_cnt + int.Parse(EnrlAttn);
                                             totday30_cnt = totday30_cnt + int.Parse(EnrlW30); totFirstTime_cnt = totFirstTime_cnt + int.Parse(EnrlFA);
                                             if (selsite != null)
                                             {
                                                 if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                     TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                             }

                                         }
                                         else
                                         {
                                             string Fund = string.Empty;
                                             if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                             {
                                                 foreach (CommonEntity drFund in propfundingSource)
                                                 {
                                                     if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                     {
                                                         Fund = drFund.Desc.ToString().Trim();
                                                         break;
                                                     }
                                                 }
                                             }

                                             excelcolumn = excelcolumn + 1;

                                             xlWorkSheet.WriteCell(excelcolumn, 1, "       " + Fund);

                                             xlWorkSheet.WriteCell(excelcolumn, 3, Entity.Enrolled);

                                             xlWorkSheet.WriteCell(excelcolumn, 4, Entity.Window30);

                                             xlWorkSheet.WriteCell(excelcolumn, 5, Entity.Withdrawn);

                                             xlWorkSheet.WriteCell(excelcolumn, 6, Entity.FirstTime);

                                             xlWorkSheet.WriteCell(excelcolumn, 7, Entity.GetAttn1);

                                             PrivSite = Entity.Site.Trim(); PrivRoom = Entity.Room.Trim(); PrivAmpm = Entity.AMPM;
                                         }
                                     }
                                 }

                                 excelcolumn = excelcolumn + 1;

                                 xlWorkSheet.WriteCell(excelcolumn, 1, "Total " + PrivSite);

                                 xlWorkSheet.WriteCell(excelcolumn, 2, TotFunds.ToString());


                                 string totEnroll = string.Empty;
                                 if (totEnrl_cnt < TotFunds)
                                     totEnroll = totEnrl_cnt.ToString() + "*";
                                 else totEnroll = totEnrl_cnt.ToString();

                                 xlWorkSheet.WriteCell(excelcolumn, 3, totEnroll.ToString());

                                 xlWorkSheet.WriteCell(excelcolumn, 4, totday30_cnt.ToString());

                                 xlWorkSheet.WriteCell(excelcolumn, 5, totWdraw_cnt.ToString());


                                 xlWorkSheet.WriteCell(excelcolumn, 6, totFirstTime_cnt.ToString());

                                 xlWorkSheet.WriteCell(excelcolumn, 7, totAttn1_cnt.ToString());

                                 if (SelFundingList.Count > 0)
                                 {
                                     foreach (CommonEntity FundEntity in SelFundingList)
                                     {
                                         List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                         int EnrlCnt = 0; int Wcnt = 0;
                                         if (Fundlistcount.Count > 0)
                                         {
                                             EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                             Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                             excelcolumn = excelcolumn + 1;

                                             xlWorkSheet.WriteCell(excelcolumn, 1, "       " + FundEntity.Desc);

                                             int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                             if (FundCnt > 0)
                                                 xlWorkSheet.WriteCell(excelcolumn, 2, FundCnt.ToString());

                                             xlWorkSheet.WriteCell(excelcolumn, 3, EnrlCnt.ToString());

                                             Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                             xlWorkSheet.WriteCell(excelcolumn, 4, Enrl_cnt.ToString());

                                             xlWorkSheet.WriteCell(excelcolumn, 5, Wcnt.ToString());

                                             Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));
                                             xlWorkSheet.WriteCell(excelcolumn, 6, Enrl_cnt.ToString());

                                             Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                             xlWorkSheet.WriteCell(excelcolumn, 7, Enrl_cnt.ToString());
                                         }
                                     }
                                 }

                                 excelcolumn = excelcolumn + 1;
                                 string[] HeaderSeq2 = { "Fund", "Funded", "Enrolled", "30 window", "Withdrawn", "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString(), "Attended 1 Day" };
                                 for (int i = 0; i < HeaderSeq.Length; ++i)
                                 {

                                     xlWorkSheet[excelcolumn, (i + 1)].Font = new System.Drawing.Font("Tahoma", 10, System.Drawing.FontStyle.Bold);
                                     xlWorkSheet[excelcolumn, (i + 1)].Alignment = Alignment.Centered;
                                     xlWorkSheet.WriteCell(excelcolumn, (i + 1), HeaderSeq2[i]);
                                 }

                                 int Total_Count1 = 0;

                                 excelcolumn = excelcolumn + 1;
                                 xlWorkSheet.WriteCell(excelcolumn, 1, "Report Totals:");


                                 Total_Count1 = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));
                                 xlWorkSheet.WriteCell(excelcolumn, 2, Total_Count1 > 0 ? Total_Count1.ToString() : FundedTotal.ToString());
                                 //xlWorkSheet.WriteCell(excelcolumn, 2, FundedTotal.ToString());


                                 List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                                 var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                                 if (Repenrolled_Count.Count > 0) Total_Count1 = Repenrolled_Count.Count;
                                 //Total_Count1 = Count_List.Sum(u => int.Parse(u.Enrolled.Trim()));

                                 xlWorkSheet.WriteCell(excelcolumn, 3, Total_Count1.ToString());

                                 Total_Count1 = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                 xlWorkSheet.WriteCell(excelcolumn, 4, Total_Count1.ToString());

                                 Total_Count1 = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                 xlWorkSheet.WriteCell(excelcolumn, 5, Total_Count1.ToString());

                                 Total_Count1 = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                 xlWorkSheet.WriteCell(excelcolumn, 6, Total_Count1.ToString());

                                 Total_Count1 = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                 xlWorkSheet.WriteCell(excelcolumn, 7, Total_Count1.ToString());

                                 if (SelFundingList.Count > 0)
                                 {
                                     foreach (CommonEntity FundEntity in SelFundingList)
                                     {
                                         List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                         int EnrlCnt = 0; int Wcnt = 0;
                                         if (Fundlistcount.Count > 0)
                                         {
                                             EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                             Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));
                                             excelcolumn = excelcolumn + 1;

                                             xlWorkSheet.WriteCell(excelcolumn, 1, "       " + FundEntity.Desc);

                                             int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                             if (FundCnt > 0)
                                                 xlWorkSheet.WriteCell(excelcolumn, 2, FundCnt.ToString());

                                             xlWorkSheet.WriteCell(excelcolumn, 3, EnrlCnt.ToString());

                                             Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));
                                             xlWorkSheet.WriteCell(excelcolumn, 4, Enrl_cnt.ToString());

                                             xlWorkSheet.WriteCell(excelcolumn, 5, Wcnt.ToString());

                                             Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                             xlWorkSheet.WriteCell(excelcolumn, 6, Enrl_cnt.ToString());

                                             Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));


                                             xlWorkSheet.WriteCell(excelcolumn, 7, Enrl_cnt.ToString());
                                             //}
                                         }
                                     }
                                 }
                                 excelcolumn = excelcolumn + 1;
                                 //document.Add(table);
                             }
                         }
                     }



                     excelcolumn = excelcolumn + 1;

                     FileStream stream = new FileStream(PdfName, FileMode.Create);

                     xlWorkSheet.Save(stream);
                     stream.Close();

                 }
                 catch (Exception ex) { }


             }
         }*/


        private void On_DetailExcelFormClosed(object sender, FormClosedEventArgs e)
        {         


            PdfListForm form = sender as PdfListForm;
            if (form.DialogResult == DialogResult.OK)
            {
                string PdfName = "Pdf File";
                PdfName = form.GetFileName();
                //PdfName = strFolderPath + PdfName;
                PdfName = propReportPath + BaseForm.UserID + "\\" + PdfName + "_Detail";
                try
                {
                    if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                    { DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim()); }
                }
                catch (Exception ex)
                {
                    AlertBox.Show("Error", MessageBoxIcon.Error);
                }


                try
                {
                    string Tmpstr = PdfName + ".xls";
                    if (File.Exists(Tmpstr))
                        File.Delete(Tmpstr);
                }
                catch (Exception ex)
                {
                    int length = 8;
                    string newFileName = System.Guid.NewGuid().ToString();
                    newFileName = newFileName.Replace("-", string.Empty);

                    Random_Filename = PdfName + newFileName.Substring(0, length) + ".xls";
                }


                if (!string.IsNullOrEmpty(Random_Filename))
                    PdfName = Random_Filename;
                else
                    PdfName += ".xls";

                string data = null;
                //int i = 0;
                //int j = 0;

                ExcelDocument xlWorkSheet = new ExcelDocument();

                xlWorkSheet.ColumnWidth(0, 0);
                xlWorkSheet.ColumnWidth(1, 120);
                xlWorkSheet.ColumnWidth(2, 120);
                xlWorkSheet.ColumnWidth(3, 120);
                xlWorkSheet.ColumnWidth(4, 120);
                xlWorkSheet.ColumnWidth(5, 150);
                xlWorkSheet.ColumnWidth(6, 120);
                xlWorkSheet.ColumnWidth(7, 120);
                xlWorkSheet.ColumnWidth(8, 120);
                xlWorkSheet.ColumnWidth(9, 120);
                xlWorkSheet.ColumnWidth(10, 120);
                xlWorkSheet.ColumnWidth(11, 120);
                xlWorkSheet.ColumnWidth(12, 140);
                xlWorkSheet.ColumnWidth(13, 140);



                int excelcolumn = 0;
                              

                string Year = string.Empty;
                if (CmbYear.Visible == true) Year = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                string SiteNum = string.Empty;
                if (((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Value.ToString().Trim() != "0") SiteNum = ((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Value.ToString().Trim();

                Base_MainMenu_List = _model.MainMenuData.GetMainMenuSearch("APP", "APP", null, null, null, null, null, null, null, null, null, null, null, null, null, Agency + Depart + Program + (!string.IsNullOrEmpty(Year) ? Year : "    "), null, BaseForm.UserID,string.Empty);

                try
                {
                    //PrintHeaderPage(document);
                    //document.NewPage();
                    Y_Pos = 795;

                    if (ENRL_Asof_List.Count > 0)
                    {
                        if (rbRoomDetail.Checked == true)
                        {
                            CaseSiteEntity Search_Entity = new CaseSiteEntity(true);
                            Search_Entity.SiteAGENCY = Agency;
                            Search_Entity.SiteDEPT = Depart; Search_Entity.SitePROG = Program;
                            if (CmbYear.Visible == true) Search_Entity.SiteYEAR = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                            propCaseAllSiteEntity = _model.CaseMstData.Browse_CASESITE(Search_Entity, "Browse");
                        }

                        excelcolumn = excelcolumn + 1;

                        //PdfPTable tab_detail = new PdfPTable(11);
                        //tab_detail.TotalWidth = 550f;
                        //tab_detail.WidthPercentage = 100;
                        //tab_detail.LockedWidth = true;
                        //float[] Counttablewidths = new float[] { 40f, 18f, 27f, 30f, 60f, 23f, 25f, 25f, 25f, 25f, 25f };// 30f, 25f, 18f, 18f, 20f, 25f, 30f, 20f, 25f, 18f, 18f, 22f };
                        //tab_detail.SetWidths(Counttablewidths);
                        //tab_detail.HorizontalAlignment = Element.ALIGN_LEFT;

                        //List<ENRL_Asof_Entity> Selected_List = ENRL_Asof_List.OrderBy(u => u.Site).ThenBy(u => u.Room).ThenBy(u => u.AMPM).ThenBy(u => u.App.Trim()).ThenBy(u => u.FundHie.Trim()).ToList();
                        string PrivSite = string.Empty; string PrivRoom = string.Empty; string PrivAmpm = string.Empty;
                        if (ENRL_Asof_List.Count > 0)
                        {
                            excelcolumn = excelcolumn + 1;
                            xlWorkSheet.WriteCell(excelcolumn, 1, "Case Activity HSSB1104");
                            excelcolumn = excelcolumn + 1;
                            //PdfPCell Header = new PdfPCell(new Phrase("Case Activity HSSB1104", TableFont));
                            //Header.HorizontalAlignment = Element.ALIGN_LEFT;
                            //Header.Colspan = 13;
                            //Header.Border = iTextSharp.text.Rectangle.NO_BORDER;
                            //tab_detail.AddCell(Header);

                            string[] HeaderSeq = { "Site/Room/AMPM", "FUND", "App#", "SSN#", "Name", "Enrolled", "Attn 1 Day", "Firsttime", "30 window", "Withdrawn", "Enrl fund","Total Days Enrolled","Total Days Attended" };
                           
                            for (int i = 0; i < HeaderSeq.Length; ++i)
                            {
                                //PdfPCell cell = new PdfPCell(new Phrase(HeaderSeq[i], TblFontBold));
                                //cell.HorizontalAlignment = Element.ALIGN_CENTER;
                                ////cell.FixedHeight = 15f;
                                //cell.Border = iTextSharp.text.Rectangle.BOTTOM_BORDER;
                                //table.AddCell(cell);

                                xlWorkSheet[excelcolumn, (i + 1)].Font = new System.Drawing.Font("Tahoma", 10, System.Drawing.FontStyle.Bold);
                                xlWorkSheet[excelcolumn, (i + 1)].Alignment = Alignment.Centered;
                                xlWorkSheet.WriteCell(excelcolumn, (i + 1), HeaderSeq[i]);
                            }

                            excelcolumn = excelcolumn + 1;

                            foreach (ENRL_Asof_Entity Entity in ENRL_Asof_List)
                            {
                                excelcolumn = excelcolumn + 1;
                                MainMenuEntity selapp_list = Base_MainMenu_List.Find(u => u.AppNo.Trim().Equals(Entity.App.Trim()));
                                if (selapp_list != null)
                                {
                                    
                                    xlWorkSheet.WriteCell(excelcolumn, 1, Entity.Site.Trim() + "/" + Entity.Room.Trim() + "/" + Entity.AMPM.Trim());

                                    
                                    xlWorkSheet.WriteCell(excelcolumn, 2, Entity.FundHie.Trim());

                                    
                                    xlWorkSheet.WriteCell(excelcolumn, 3, Entity.App.Trim());

                                    MaskedTextBox mskssn = new MaskedTextBox();
                                    mskssn.Mask = "000-00-0000";
                                    mskssn.Text = selapp_list.Ssn.Trim();
                                    
                                    xlWorkSheet.WriteCell(excelcolumn, 4, mskssn.Text);

                                    
                                    xlWorkSheet.WriteCell(excelcolumn, 5, LookupDataAccess.GetMemberName(selapp_list.Fname, selapp_list.Mname, selapp_list.Lname, "4"));

                                    if (Entity.Status == "E")
                                        xlWorkSheet.WriteCell(excelcolumn, 6, "Yes");
                                    else
                                        xlWorkSheet.WriteCell(excelcolumn, 6, "No");
                                    
                                    if (Entity.GetAttn1.Trim() == "1")
                                        xlWorkSheet.WriteCell(excelcolumn, 7, "Yes");
                                    else
                                        xlWorkSheet.WriteCell(excelcolumn, 7, "No");
                                    
                                    if(Entity.FirstTime.Trim() == "1")
                                        xlWorkSheet.WriteCell(excelcolumn, 8, "Yes");
                                    else
                                        xlWorkSheet.WriteCell(excelcolumn, 8, "No");

                                    if (Entity.Status == "W")
                                    {
                                        string Thirtyday = "No";
                                        if (Entity.Window30.Trim() == "1")
                                            Thirtyday = "Yes";
                                        xlWorkSheet.WriteCell(excelcolumn, 9, Thirtyday);
                                    }
                                    else
                                        xlWorkSheet.WriteCell(excelcolumn, 9, "No");
                                    
                                    if (Entity.Status == "W")
                                        xlWorkSheet.WriteCell(excelcolumn, 10, "Yes");
                                    else
                                        xlWorkSheet.WriteCell(excelcolumn, 10, "No");
                                    
                                    if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                        xlWorkSheet.WriteCell(excelcolumn, 11, "Yes");
                                    else
                                        xlWorkSheet.WriteCell(excelcolumn, 11, "No");

                                    if(Entity.TotEnrlDays.Trim()=="0")
                                        xlWorkSheet.WriteCell(excelcolumn, 12, "");
                                    else xlWorkSheet.WriteCell(excelcolumn, 12, Entity.TotEnrlDays);

                                    if (Entity.TotAttnDays.Trim() == "0")
                                        xlWorkSheet.WriteCell(excelcolumn, 13, "");
                                    else xlWorkSheet.WriteCell(excelcolumn, 13, Entity.TotAttnDays);

                                }
                            }

                            
                        }

                    }

                    excelcolumn = excelcolumn + 1;

                    FileStream stream = new FileStream(PdfName, FileMode.Create);

                    xlWorkSheet.Save(stream);
                    stream.Close();

                }

                catch (Exception ex)
                {
                    
                }              

            }
        }

        #endregion



        string strFundingCodes = string.Empty; 
        private void btnPdfPreview_Click(object sender, EventArgs e)
        {
            PdfListForm pdfListForm = new PdfListForm(BaseForm, Privileges, true, propReportPath);
            pdfListForm.StartPosition = FormStartPosition.CenterScreen;
            pdfListForm.ShowDialog();

        }

        private void Pb_Search_Hie_Click(object sender, EventArgs e)
        {
           /* HierarchieSelectionFormNew hierarchieSelectionForm = new HierarchieSelectionFormNew(BaseForm, Current_Hierarchy_DB, "Master", "A", "D", "Reports");
            hierarchieSelectionForm.FormClosed += new FormClosedEventHandler(OnHierarchieFormClosed);
            hierarchieSelectionForm.ShowDialog();*/

            HierarchieSelection hierarchieSelectionForm = new HierarchieSelection(BaseForm, Current_Hierarchy_DB, "Master", "A", "D", "Reports", BaseForm.UserID);
            hierarchieSelectionForm.FormClosed += new FormClosedEventHandler(OnHierarchieFormClosed);
            hierarchieSelectionForm.StartPosition = FormStartPosition.CenterScreen;
            hierarchieSelectionForm.ShowDialog();
        }

        private void OnHierarchieFormClosed(object sender, FormClosedEventArgs e)
        {
            HierarchieSelection form = sender as HierarchieSelection;

            if (form.DialogResult == DialogResult.OK)
            {
                List<HierarchyEntity> selectedHierarchies = form.SelectedHierarchies;
                string hierarchy = string.Empty;

                if (selectedHierarchies.Count > 0)
                {
                    foreach (HierarchyEntity row in selectedHierarchies)
                    {
                        hierarchy += (string.IsNullOrEmpty(row.Agency) ? "**" : row.Agency) + (string.IsNullOrEmpty(row.Dept) ? "**" : row.Dept) + (string.IsNullOrEmpty(row.Prog) ? "**" : row.Prog);
                    }
                    //Current_Hierarchy = hierarchy.Substring(0, 2) + "-" + hierarchy.Substring(2, 2) + "-" + hierarchy.Substring(4, 2);

                    Set_Report_Hierarchy(hierarchy.Substring(0, 2), hierarchy.Substring(2, 2), hierarchy.Substring(4, 2), string.Empty);
                    Agency = hierarchy.Substring(0, 2);
                    Depart = hierarchy.Substring(2, 2);
                    Program = hierarchy.Substring(4, 2);
                    
                    //cmbSite.Items.Clear();
                    FillCaseSite();
                }

            }
        }

        private bool ValidateForm()
        {
            bool isValid = true;
            _errorProvider.SetError(dtpAsOfDate, null);
            _errorProvider.SetError(rbSelected, null);

            if (dtpAsOfDate.Checked == false)
            {
                _errorProvider.SetError(dtpAsOfDate, "Please Select the Date");
                isValid = false;
            }
            else
            {
                _errorProvider.SetError(dtpAsOfDate, null);
            }

            if (dtpAsOfDate.Checked == true)
            {
                if(string.IsNullOrWhiteSpace(dtpAsOfDate.Text))
                {
                    _errorProvider.SetError(dtpAsOfDate, "Please enter the Date");
                    isValid = false;
                }
                else
                {
                    _errorProvider.SetError(dtpAsOfDate, null);
                }
            }

            if (rbSelected.Checked == true)
            {
                if (SelFundingList.Count == 0)
                {
                    _errorProvider.SetError(rbSelected, "Please Select at least One Fund");
                    isValid = false;
                }
                else
                {
                    _errorProvider.SetError(rbSelected, null);
                }
            }
            else
                _errorProvider.SetError(rbSelected, null);

            
            return (isValid);
        }

        private void rbFundDetailByRoom_Click(object sender, EventArgs e)
        {
            rbAll.Enabled = true; rbSelected.Enabled = true;
            rbAll.ForeColor = System.Drawing.Color.Black; rbSelected.ForeColor = System.Drawing.Color.Black;
            lblFundingSource.ForeColor= System.Drawing.Color.Black;
        }

        private void rbRoomDetail_Click(object sender, EventArgs e)
        {
            rbAll.Checked = true;  rbAll.Enabled = false; rbSelected.Enabled = false;
            rbAll.ForeColor = System.Drawing.Color.Gray; rbSelected.ForeColor = System.Drawing.Color.Gray;
            lblFundingSource.ForeColor = System.Drawing.Color.Gray;
        }

        private void HSSB2104_ToolClick(object sender, ToolClickEventArgs e)
        {
            //Application.Navigate(CommonFunctions.BuildHelpURLS(Privileges.Program, 0, BaseForm.BusinessModuleID.ToString()), target: "_blank");
            Application.Navigate(CommonFunctions.CreateZenHelps(Privileges.Program, 0, BaseForm.BusinessModuleID.ToString(), "", ""), target: "_blank");
        }

        private void rbAll_CheckedChanged(object sender, EventArgs e)
        {
            SelFundingList.Clear();
            _errorProvider.SetError(rbSelected, null);
        }

        private void rbSelected_Click(object sender, EventArgs e)
        {
            if (rbSelected.Checked == true)
            {
                HSSB2111FundForm FundingForm = new HSSB2111FundForm(BaseForm, SelFundingList, Privileges);
                FundingForm.FormClosed += new FormClosedEventHandler(FundingForm_FormClosed);
                FundingForm.StartPosition = FormStartPosition.CenterScreen;
                FundingForm.ShowDialog();
            }
        }

        List<CommonEntity> SelFundingList = new List<CommonEntity>();
        private void FundingForm_FormClosed(object sender, FormClosedEventArgs e)
        {
            HSSB2111FundForm form = sender as HSSB2111FundForm;
            if (form.DialogResult == DialogResult.OK)
            {
                SelFundingList = form.GetSelectedFundings();
            }
        }

        private void CmbYear_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (CmbYear.Items.Count > 0)
            {
                Program_Year = "    ";
                if (!(string.IsNullOrEmpty(((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString())))
                    Program_Year = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString();
            }
        }

        private void Pb_Help_Click(object sender, EventArgs e)
        {
            //Help.ShowHelp(this, Context.Server.MapPath("~\\Resources\\HelpFiles\\Captain_Help.chm"), HelpNavigator.KeywordIndex, "Enrollment Summary");
        }

        #region Vikash added on 07/04-05/2024 for Converting Excel to DevExpress Format

        private void On_SaveExcelClosed_DevExpress(object sender, FormClosedEventArgs e)
        {
            Random_Filename = null;
            PdfListForm form = sender as PdfListForm;
            if (form.DialogResult == DialogResult.OK)
            {
                #region FileNameBuild
                /*************************************************************/
                Random_Filename = null;
                string xlFileName = form.GetFileName();
                xlFileName = propReportPath + BaseForm.UserID + "\\" + xlFileName;
                try
                {
                    if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                    {
                        DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim());
                    }
                }
                catch (Exception ex)
                {
                    CommonFunctions.MessageBoxDisplay("Error");
                }

                try
                {
                    string Tmpstr = xlFileName + ".xlsx";
                    if (File.Exists(Tmpstr))
                        File.Delete(Tmpstr);
                }
                catch (Exception ex)
                {
                    int length = 8;
                    string newFileName = System.Guid.NewGuid().ToString();
                    newFileName = newFileName.Replace("-", string.Empty);

                    Random_Filename = xlFileName + newFileName.Substring(0, length) + ".xlsx";
                }

                if (!string.IsNullOrEmpty(Random_Filename))
                    xlFileName = Random_Filename;
                else
                    xlFileName += ".xlsx";

                /*************************************************************/
                string _excelPath = xlFileName;
                #endregion

                #region Excel Data Generation

                try
                {
                    using (DevExpress.Spreadsheet.Workbook wb = new DevExpress.Spreadsheet.Workbook())
                    {
                        DevExpress_Excel_Properties oDevExpress_Excel_Properties = new DevExpress_Excel_Properties();
                        oDevExpress_Excel_Properties.sxlbook = wb;
                        oDevExpress_Excel_Properties.sxlTitleFont = "calibri";
                        oDevExpress_Excel_Properties.sxlbodyFont = "calibri";

                        oDevExpress_Excel_Properties.getDevexpress_Excel_Properties();

                        #region Custom Styles

                        #endregion

                        int _Rowindex = 0;
                        int _Columnindex = 0;

                        if (Agency == "**")
                            Agency = null;
                        if (Depart == "**")
                            Depart = null;
                        if (Program == "**")
                            Program = null;
                        string year = string.Empty;
                        if (CmbYear.Visible == true)
                            year = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString().Trim();

                        #region Parameters Sheet

                        DevExpress.Spreadsheet.Worksheet paramSheet = wb.Worksheets[0];
                        paramSheet.Name = "Parameters";
                        paramSheet.ActiveView.TabColor = Color.ForestGreen;
                        paramSheet.ActiveView.ShowGridlines = false;
                        wb.Unit = DevExpress.Office.DocumentUnit.Point;

                        paramSheet.Columns[1].Width = 80;
                        paramSheet.Columns[2].Width = 200;
                        paramSheet.Columns[3].Width = 50;
                        paramSheet.Columns[4].Width = 80;
                        paramSheet.Columns[5].Width = 200;

                        string strAgy = Current_Hierarchy_DB.Split('-')[0];

                        AgencyControlEntity BAgyControlDetails = _model.ZipCodeAndAgency.GetAgencyControlFile(strAgy);

                        string ImgName = "";
                        if (BaseForm.BaseAgencyControlDetails.AgyShortName == "NEOCAA")
                        {
                            ImgName = "NEOCAA_" + strAgy + "_LOGO.png";
                        }
                        else
                            ImgName = BaseForm.BaseAgencyControlDetails.AgyShortName + "_00_LOGO.png";

                        _Rowindex = 1;
                        _Columnindex = 1;
                        paramSheet.Rows[_Rowindex][_Columnindex].Value = BAgyControlDetails.AgyName;
                        paramSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.xTitleCellstyle;
                        oDevExpress_Excel_Properties.xlRowsMerge(paramSheet, _Rowindex, _Columnindex, 5);
                        _Rowindex++;

                        string imagesPath = "https://capsysdev.capsystems.com/images/PIPlogos/" + ImgName;
                        DevExpress.Spreadsheet.SpreadsheetImageSource imgsrc = DevExpress.Spreadsheet.SpreadsheetImageSource.FromUri(imagesPath, wb);
                        //DevExpress.Spreadsheet.Picture pic = paramSheet.Pictures.AddPicture(imgsrc, 200, 80, 630, 280);
                        DevExpress.Spreadsheet.Picture pic = paramSheet.Pictures.AddPicture(imgsrc, 50, 0, 120, 70);


                        AgencyControlEntity _agycntrldets = new AgencyControlEntity();
                        _agycntrldets = BaseForm.BaseAgencyControlDetails;

                        if (BaseForm.BaseAgencyControlDetails.AgyShortName == "NEOCAA")
                            _agycntrldets = BAgyControlDetails;
                        else
                            _agycntrldets = BaseForm.BaseAgencyControlDetails;

                        string street = _agycntrldets.Street == "" ? "" : (_agycntrldets.Street + ", ");
                        string city = _agycntrldets.City == "" ? "" : (_agycntrldets.City + ", ");
                        string state = _agycntrldets.State == "" ? "" : (_agycntrldets.State + ", ");
                        string zip1 = _agycntrldets.Zip1 == "" ? "" : _agycntrldets.Zip1.PadLeft(5, '0');

                        string strAddress = street + city + state + zip1;
                        paramSheet.Rows[_Rowindex][_Columnindex].Value = strAddress;
                        paramSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlEMPTC;
                        oDevExpress_Excel_Properties.xlRowsMerge(paramSheet, _Rowindex, _Columnindex, 5);

                        _Rowindex++;
                        paramSheet.Rows[_Rowindex][_Columnindex].Value = "";
                        oDevExpress_Excel_Properties.xlRowsMerge(paramSheet, _Rowindex, _Columnindex, 5);

                        _Rowindex++;
                        paramSheet.Rows[_Rowindex][_Columnindex].Value = Privileges.PrivilegeName;
                        paramSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.reportNameStyle;
                        oDevExpress_Excel_Properties.xlRowsMerge(paramSheet, _Rowindex, _Columnindex, 5);

                        _Rowindex++;
                        paramSheet.Rows[_Rowindex][_Columnindex].Value = "Report Parameters";
                        paramSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.xTitleCellstyle2;
                        oDevExpress_Excel_Properties.xlRowsMerge(paramSheet, _Rowindex, _Columnindex, 5);

                        string Agy = "All";
                        string Dept = "All";
                        string Prg = "All";
                        string program_year = string.Empty;
                        if (Current_Hierarchy.Substring(0, 2) != "**")
                            Agy = Current_Hierarchy.Substring(0, 2);
                        if (Current_Hierarchy.Substring(2, 2) != "**")
                            Dept = Current_Hierarchy.Substring(2, 2);
                        if (Current_Hierarchy.Substring(4, 2) != "**")
                            Prg = Current_Hierarchy.Substring(4, 2);
                        if (CmbYear.Visible == true)
                            program_year = "Year: " + ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.ToString();

                        if (CmbYear.Visible == true)
                        {
                            _Rowindex++;
                            paramSheet.Rows[_Rowindex][_Columnindex].Value = Txt_HieDesc.Text.Trim() + "   " + program_year;
                            paramSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.xsubTitleintakeCellstyle;
                            oDevExpress_Excel_Properties.xlRowsMerge(paramSheet, _Rowindex, _Columnindex, 5);
                        }
                        else
                        {
                            _Rowindex++;
                            paramSheet.Rows[_Rowindex][_Columnindex].Value = Txt_HieDesc.Text.Trim();
                            paramSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.xsubTitleintakeCellstyle;
                            oDevExpress_Excel_Properties.xlRowsMerge(paramSheet, _Rowindex, _Columnindex, 5);
                        }

                        _Rowindex++;
                        paramSheet.Rows[_Rowindex][_Columnindex].Value = "";
                        oDevExpress_Excel_Properties.xlRowsMerge(paramSheet, _Rowindex, _Columnindex, 5);

                        _Rowindex++;
                        paramSheet.Rows[_Rowindex][_Columnindex].Value = lblSite.Text.Trim();
                        paramSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.paramsCellStyle;
                        _Columnindex++;

                        string strSites = "All Sites";
                        if (((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Text.ToString().Trim() != "****       - All")
                        {
                            strSites = ((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Text.ToString().Trim();
                            string[] ary = strSites.Split('-');
                            if (ary.Length > 1)
                            {
                                strSites = ary[1];
                            }
                        }

                        paramSheet.Rows[_Rowindex][_Columnindex].Value = strSites;
                        paramSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        _Columnindex++;

                        _Rowindex++;
                        _Columnindex = 1;
                        paramSheet.Rows[_Rowindex][_Columnindex].Value = lblReportType.Text.Trim();
                        paramSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.paramsCellStyle;
                        _Columnindex++;

                        string Report_Type = rbSiteSummary.Checked == true ? rbSiteSummary.Text.Trim() : (rbRoomDetail.Checked == true ? rbRoomDetail.Text.Trim() : rbFundDetailByRoom.Text.Trim());

                        paramSheet.Rows[_Rowindex][_Columnindex].Value = Report_Type;
                        paramSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                        _Columnindex++;

                        if (rbFundDetailByRoom.Checked == true)
                        {
                            string Fund = string.Empty;
                            if (rbAll.Checked)
                                Fund = rbAll.Text.Trim() + " Funds";
                            else
                            {
                                string New_Fund_Str = "";
                                foreach (CommonEntity FundingCode in SelFundingList)
                                    New_Fund_Str += FundingCode.Code + ", ";

                                if (New_Fund_Str.Length > 2)
                                    New_Fund_Str = New_Fund_Str.Substring(0, New_Fund_Str.Length - 2);

                                Fund = New_Fund_Str;
                            }

                            _Rowindex++;
                            _Columnindex = 1;
                            paramSheet.Rows[_Rowindex][_Columnindex].Value = lblFundingSource.Text.Trim();
                            paramSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.paramsCellStyle;
                            _Columnindex++;// _Columnindex + 2;

                            paramSheet.Rows[_Rowindex][_Columnindex].Value = Fund;
                            paramSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                            _Columnindex++;// _Columnindex + 2;
                        }

                        if (dtpAsOfDate.Checked)
                        {
                            _Rowindex++;
                            _Columnindex = 1;
                            paramSheet.Rows[_Rowindex][_Columnindex].Value = lblAsOfDate.Text.Trim();
                            paramSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.paramsCellStyle;
                            _Columnindex++;// _Columnindex + 2;

                            paramSheet.Rows[_Rowindex][_Columnindex].Value = dtpAsOfDate.Text;
                            paramSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNLC;
                            _Columnindex++;// _Columnindex + 2;
                        }

                        _Rowindex++;
                        _Columnindex = 1;
                        paramSheet.Rows[_Rowindex][_Columnindex].Value = "";
                        _Columnindex = _Columnindex + 5;

                        _Rowindex = _Rowindex + 3;
                        _Columnindex = 5;
                        paramSheet.Rows[_Rowindex][_Columnindex].Value = "Generated By: " + BaseForm.UserID;
                        paramSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlGenerate_lr;

                        _Rowindex++;
                        paramSheet.Rows[_Rowindex][_Columnindex].Value = "Generated On: " + DateTime.Now.ToString("MM/dd/yyyy hh:mm:ss tt");
                        paramSheet.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlGenerate_lr;

                        #endregion

                        #region Excel Report Data

                        DevExpress.Spreadsheet.Worksheet SheetDetails = wb.Worksheets.Add(Report_Type);
                        SheetDetails.ActiveView.TabColor = ColorTranslator.FromHtml("#ADD8E6");

                        SheetDetails.ActiveView.ShowGridlines = false;
                        wb.Unit = DevExpress.Office.DocumentUnit.Point;

                        #region Column Widths

                        SheetDetails.Columns[0].Width = 10;
                        SheetDetails.Columns[1].Width = 200;
                        SheetDetails.Columns[2].Width = 60;
                        SheetDetails.Columns[3].Width = 60;
                        SheetDetails.Columns[4].Width = 65;
                        SheetDetails.Columns[5].Width = 90;
                        SheetDetails.Columns[6].Width = 110;
                        SheetDetails.Columns[7].Width = 100;
                        SheetDetails.Columns[8].Width = 10;

                        #endregion

                        _Rowindex = 0;
                        _Columnindex = 0;

                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                        _Columnindex++;

                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Privileges.PrivilegeName.Trim().ToUpper();
                        oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlFrameStyleL);
                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                        _Columnindex = _Columnindex + 7;

                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;

                        string PrivSite = string.Empty;
                        string PrivRoom = string.Empty;
                        string PrivAmpm = string.Empty;

                        if (rbSiteSummary.Checked == true)
                        {
                            if (SiteSel_List.Count > 0)
                            {
                                _Rowindex++;
                                _Columnindex = 0;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Site and Classrooms";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Funded";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Enrolled";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "30 window";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Withdrawn";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString();
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Attended 1 Day";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;

                                int Enrl_cnt = 0;
                                int FundedTotal = 0;

                                foreach (ENRL_Asof_Entity Entity in SiteSel_List)
                                {
                                    _Rowindex++;
                                    _Columnindex = 0;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Site.Trim();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()));

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = selsite.SITE_FUNDED_SLOTS.Trim();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    int Count = 0;
                                    List<ENRL_Asof_Entity> SiteCount = Count_List.FindAll(u => u.Site.Trim().Equals(Entity.Site.Trim()));

                                    List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Enrolled.Equals("1"));
                                    var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                    if (enrolled_Count.Count > 0)
                                        Count = enrolled_Count.Count;

                                    string Enroll = string.Empty;
                                    if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                    {
                                        if (Count < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                            Enroll = Count + "*";
                                        else
                                            Enroll = Count.ToString();

                                        FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                    }
                                    else
                                        Enroll = Count.ToString();

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enroll;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    Count = SiteCount.Sum(u => int.Parse(u.Window30.Trim()));

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Count;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    Count = SiteCount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Count;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    Count = SiteCount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Count;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    Count = SiteCount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Count;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                }

                                _Rowindex++;
                                _Columnindex = 0;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders);
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                _Columnindex = _Columnindex + 7;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;

                                _Rowindex++;
                                _Columnindex = 0;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Fund";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Funded";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Enrolled";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "30 window";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Withdrawn";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString();
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Attended 1 Day";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;

                                int Total_Count = 0;

                                _Rowindex++;
                                _Columnindex = 0;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Report Totals";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                Total_Count = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = (Total_Count > 0 ? Total_Count : FundedTotal);
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                                var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                                if (Repenrolled_Count.Count > 0)
                                    Total_Count = Repenrolled_Count.Count;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                if (propfundingSource.Count > 0)
                                {
                                    foreach (CommonEntity FundEntity in propfundingSource)
                                    {
                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                        int EnrlCnt = 0;
                                        int Wcnt = 0;

                                        if (Fundlistcount.Count > 0)
                                        {
                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                            _Rowindex++;
                                            _Columnindex = 0;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "     " + FundEntity.Desc;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));

                                            if (FundCnt > 0)
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = FundCnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }
                                            else
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlCnt;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlCnt;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Wcnt;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlCnt;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlCnt;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        }
                                    }
                                }
                            }
                        }

                        if (rbRoomDetail.Checked == true)
                        {
                            CaseSiteEntity Search_Entity = new CaseSiteEntity(true);
                            Search_Entity.SiteAGENCY = Agency;
                            Search_Entity.SiteDEPT = Depart;
                            Search_Entity.SitePROG = Program;
                            if (CmbYear.Visible == true)
                                Search_Entity.SiteYEAR = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                            propCaseAllSiteEntity = _model.CaseMstData.Browse_CASESITE(Search_Entity, "Browse");

                            if (RoomSel_List.Count > 0)
                            {
                                bool First = true;
                                _Rowindex++;
                                _Columnindex = 0;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Site and Classrooms";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Funded";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Enrolled";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "30 window";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Withdrawn";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString();
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Attended 1 Day";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;

                                int Enrl_cnt = 0;
                                int totEnrl_cnt = 0;
                                int totWdraw_cnt = 0;
                                int totday30_cnt = 0;
                                int totAttn1_cnt = 0;
                                int totFirstTime_cnt = 0;
                                int TotFunds = 0;
                                int FundedTotal = 0;

                                foreach (ENRL_Asof_Entity Entity in RoomSel_List)
                                {
                                    if (!First)
                                    {
                                        if (Entity.Site.Trim() != PrivSite)
                                        {
                                            _Rowindex++;
                                            _Columnindex = 0;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Total " + PrivSite;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = TotFunds;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            string totEnroll = string.Empty;
                                            if (totEnrl_cnt < TotFunds)
                                                totEnroll = totEnrl_cnt.ToString() + "*";
                                            else
                                                totEnroll = totEnrl_cnt.ToString();

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = totEnroll;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = totday30_cnt;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = totWdraw_cnt;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = totFirstTime_cnt;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = totAttn1_cnt;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                            totEnrl_cnt = 0;
                                            totWdraw_cnt = 0;
                                            totAttn1_cnt = 0;
                                            totday30_cnt = 0;
                                            totFirstTime_cnt = 0;
                                            TotFunds = 0;

                                            _Rowindex++;
                                            _Columnindex = 0;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                            _Columnindex = _Columnindex + 7;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                                            _Rowindex++;
                                            _Columnindex = 0;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Site and Classrooms";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Funded";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Enrolled";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "30 window";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Withdrawn";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString();
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Attended 1 Day";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;

                                            _Rowindex++;
                                            _Columnindex = 0;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Site.Trim();
                                            oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex = _Columnindex + 7;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        }

                                        _Rowindex++;
                                        _Columnindex = 0;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "      " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim();
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));

                                        List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                        var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                        if (enrolled_Count.Count > 0)
                                            Entity.Enrolled = enrolled_Count.Count.ToString();
                                        string Enroll = string.Empty;

                                        if (selsite != null)
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = selsite.SITE_FUNDED_SLOTS.Trim();
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                            {
                                                if (int.Parse(Entity.Enrolled) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                    Enroll = Entity.Enrolled + "*";
                                                else
                                                    Enroll = Entity.Enrolled;

                                            }
                                            else
                                                Enroll = Entity.Enrolled;
                                        }
                                        else
                                            Enroll = Entity.Enrolled;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enroll;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Window30;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Withdrawn;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.FirstTime;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.GetAttn1;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        totEnrl_cnt = totEnrl_cnt + int.Parse(Entity.Enrolled);
                                        totWdraw_cnt = totWdraw_cnt + int.Parse(Entity.Withdrawn);
                                        totAttn1_cnt = totAttn1_cnt + int.Parse(Entity.GetAttn1);
                                        totday30_cnt = totday30_cnt + int.Parse(Entity.Window30);
                                        totFirstTime_cnt = totFirstTime_cnt + int.Parse(Entity.FirstTime);

                                        if (selsite != null)
                                        {
                                            if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                            {
                                                TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                                FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                            }
                                        }
                                        PrivSite = Entity.Site.Trim();
                                        PrivRoom = Entity.Room.Trim();
                                        PrivAmpm = Entity.AMPM.Trim();

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    }
                                    else
                                    {
                                        _Rowindex++;
                                        _Columnindex = 0;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Site.Trim();
                                        oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex = _Columnindex + 7;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                        _Rowindex++;
                                        _Columnindex = 0;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "      " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim();
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));

                                        List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                        var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();
                                        if (enrolled_Count.Count > 0)
                                            Entity.Enrolled = enrolled_Count.Count.ToString();
                                        string Enroll = string.Empty;

                                        if (selsite != null)
                                        {
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = selsite.SITE_FUNDED_SLOTS.Trim();
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                            {
                                                if (int.Parse(Entity.Enrolled) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                    Enroll = Entity.Enrolled + "*";
                                                else
                                                    Enroll = Entity.Enrolled;
                                            }
                                            else
                                                Enroll = Entity.Enrolled;
                                        }
                                        else
                                            Enroll = Entity.Enrolled;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enroll;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Window30;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Withdrawn;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.FirstTime;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.GetAttn1;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        _Columnindex++;

                                        totEnrl_cnt = totEnrl_cnt + int.Parse(Entity.Enrolled);
                                        totWdraw_cnt = totWdraw_cnt + int.Parse(Entity.Withdrawn);
                                        totAttn1_cnt = totAttn1_cnt + int.Parse(Entity.GetAttn1);
                                        totday30_cnt = totday30_cnt + int.Parse(Entity.Window30);
                                        totFirstTime_cnt = totFirstTime_cnt + int.Parse(Entity.FirstTime);

                                        if (selsite != null)
                                        {
                                            if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                            {
                                                TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                                FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                            }
                                        }
                                        PrivSite = Entity.Site.Trim();
                                        PrivRoom = Entity.Room.Trim();
                                        PrivAmpm = Entity.AMPM.Trim();

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                        _Rowindex++;
                                        _Columnindex = 0;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                        _Columnindex = _Columnindex + 7;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                    }
                                    First = false;
                                    PrivSite = Entity.Site.Trim();
                                }

                                _Rowindex++;
                                _Columnindex = 0;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Total " + PrivSite;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = TotFunds;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                string totEnroll1 = string.Empty;
                                if (totEnrl_cnt < TotFunds)
                                    totEnroll1 = totEnrl_cnt.ToString() + "*";
                                else
                                    totEnroll1 = totEnrl_cnt.ToString();

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = totEnroll1;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = totday30_cnt;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;


                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = totWdraw_cnt;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = totFirstTime_cnt;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;


                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = totAttn1_cnt;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                _Rowindex++;
                                _Columnindex = 0;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                _Columnindex = _Columnindex + 7;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                                _Rowindex++;
                                _Columnindex = 0;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Fund";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Funded";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Enrolled";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "30 window";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Withdrawn";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString();
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Attended 1 Day";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;

                                int Total_Count = 0;

                                _Rowindex++;
                                _Columnindex = 0;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Report Totals";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                Total_Count = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count > 0 ? Total_Count : FundedTotal;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                                var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                                if (Repenrolled_Count.Count > 0)
                                    Total_Count = Repenrolled_Count.Count;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                Total_Count = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                Total_Count = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                Total_Count = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                Total_Count = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count;
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                _Rowindex++;
                                _Columnindex = 0;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                _Columnindex = _Columnindex + 7;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                                if (propfundingSource.Count > 0)
                                {
                                    foreach (CommonEntity FundEntity in propfundingSource)
                                    {
                                        //_Rowindex++;
                                        //_Columnindex = 0;

                                        List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                        int EnrlCnt = 0;
                                        int Wcnt = 0;

                                        if (Fundlistcount.Count > 0)
                                        {
                                            _Rowindex++;
                                            _Columnindex = 0;

                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                            Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "     " + FundEntity.Desc;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));

                                            if (FundCnt > 0)
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = FundCnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }
                                            else
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;
                                            }

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlCnt;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlCnt;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Wcnt;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlCnt;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlCnt;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                        }
                                    }
                                }
                            }
                        }

                        if (rbFundDetailByRoom.Checked == true)
                        {
                            CaseSiteEntity Search_Entity = new CaseSiteEntity(true);
                            Search_Entity.SiteAGENCY = Agency;
                            Search_Entity.SiteDEPT = Depart;
                            Search_Entity.SitePROG = Program;
                            if (CmbYear.Visible == true)
                                Search_Entity.SiteYEAR = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                            propCaseAllSiteEntity = _model.CaseMstData.Browse_CASESITE(Search_Entity, "Browse");

                            if (Count_List.Count > 0)
                            {
                                bool First = true;

                                _Rowindex++;
                                _Columnindex = 0;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Site and Classrooms";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Funded";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Enrolled";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "30 window";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Withdrawn";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString();
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Attended 1 Day";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;

                                int Enrl_cnt = 0;
                                int totEnrl_cnt = 0;
                                int totWdraw_cnt = 0;
                                int totday30_cnt = 0;
                                int totAttn1_cnt = 0;
                                int totFirstTime_cnt = 0;
                                int TotFunds = 0;
                                int FundedTotal = 0;

                                if (rbAll.Checked == true)
                                {
                                    foreach (ENRL_Asof_Entity Entity in Count_List)
                                    {
                                        if (Entity.Site.Trim() + Entity.Room.Trim() + Entity.AMPM.Trim() != PrivSite + PrivRoom + PrivAmpm)
                                        {
                                            if (!First)
                                            {
                                                _Rowindex++;
                                                _Columnindex = 0;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                                _Columnindex = _Columnindex + 7;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                                                if (Entity.Site.Trim() != PrivSite)
                                                {
                                                    int Total_Count = 0;

                                                    _Rowindex++;
                                                    _Columnindex = 0;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Total " + PrivSite;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = TotFunds;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;

                                                    string totEnroll1 = string.Empty;
                                                    if (totEnrl_cnt < TotFunds)
                                                        totEnroll1 = totEnrl_cnt.ToString() + "*";
                                                    else
                                                        totEnroll1 = totEnrl_cnt.ToString();

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = totEnroll1;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = totday30_cnt;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = totWdraw_cnt;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = totFirstTime_cnt;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = totAttn1_cnt;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                                    if (propfundingSource.Count > 0)
                                                    {
                                                        //_Rowindex++;
                                                        //_Columnindex = 0;

                                                        //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                        //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                        //_Columnindex++;

                                                        //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Total " + PrivSite;
                                                        //SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                                        //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                        //_Columnindex++;

                                                        foreach (CommonEntity FundEntity in propfundingSource)
                                                        {
                                                            List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                                            int EnrlCnt = 0;
                                                            int Wcnt = 0;
                                                            if (Fundlistcount.Count > 0)
                                                            {
                                                                EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                                                Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                                                _Rowindex++;
                                                                _Columnindex = 0;

                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                _Columnindex++;

                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "     " + FundEntity.Desc;
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                _Columnindex++;

                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                _Columnindex++;

                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlCnt;
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                _Columnindex++;

                                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                _Columnindex++;

                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Wcnt;
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                _Columnindex++;

                                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                _Columnindex++;

                                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                _Columnindex++;

                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                            }
                                                        }
                                                    }

                                                    totEnrl_cnt = 0;
                                                    totWdraw_cnt = 0;
                                                    totAttn1_cnt = 0;
                                                    totday30_cnt = 0;
                                                    totFirstTime_cnt = 0;
                                                    TotFunds = 0;

                                                    _Rowindex++;
                                                    _Columnindex = 0;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                                    _Columnindex = _Columnindex + 7;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                                                    _Rowindex++;
                                                    _Columnindex = 0;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Site and Classrooms";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleL;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Funded";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Enrolled";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "30 window";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Withdrawn";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString();
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Attended 1 Day";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;

                                                    _Rowindex++;
                                                    _Columnindex = 0;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                                    _Columnindex = _Columnindex + 7;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                                }
                                            }

                                            if (First)
                                            {
                                                _Rowindex++;
                                                _Columnindex = 0;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Site.Trim();
                                                oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex = _Columnindex + 7;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            }

                                            _Rowindex++;
                                            _Columnindex = 0;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "    " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim();
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));

                                            string Enroll = string.Empty;
                                            string EnrlCntY = "0";
                                            string EnrlWd = "0";
                                            string EnrlAttn = "0";
                                            string EnrlW30 = "0";
                                            string EnrlFA = "0";

                                            if (selsite != null)
                                            {
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = selsite.SITE_FUNDED_SLOTS.Trim();
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                {
                                                    List<ENRL_Asof_Entity> Enrols = Count_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM));
                                                    List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                                    var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();

                                                    if (Enrols.Count > 0)
                                                    {
                                                        EnrlCntY = enrolled_Count.Count.ToString();
                                                        EnrlWd = Enrols.Sum(u => int.Parse(u.Withdrawn.Trim())).ToString();
                                                        EnrlAttn = Enrols.Sum(u => int.Parse(u.GetAttn1.Trim())).ToString();
                                                        EnrlW30 = Enrols.Sum(u => int.Parse(u.Window30.Trim())).ToString();
                                                        EnrlFA = Enrols.Sum(u => int.Parse(u.FirstTime.Trim())).ToString();
                                                    }

                                                    if (int.Parse(EnrlCntY) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                        Enroll = EnrlCntY + "*";
                                                    else
                                                        Enroll = EnrlCntY;
                                                    FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                                }
                                                else
                                                    Enroll = Entity.Enrolled;
                                            }
                                            else
                                                Enroll = Entity.Enrolled;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enroll;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlW30;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlWd;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlFA;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlAttn;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                            string FundDesc = string.Empty;
                                            if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                            {
                                                foreach (CommonEntity drFund in propfundingSource)
                                                {
                                                    if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                    {
                                                        FundDesc = drFund.Desc.ToString().Trim();
                                                        break;
                                                    }
                                                }
                                            }

                                            _Rowindex++;
                                            _Columnindex = 0;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "       " + FundDesc;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Enrolled;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Window30;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Withdrawn;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.FirstTime;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.GetAttn1;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                            First = false;
                                            PrivSite = Entity.Site.Trim();
                                            PrivRoom = Entity.Room.Trim();
                                            PrivAmpm = Entity.AMPM;
                                            totEnrl_cnt = totEnrl_cnt + int.Parse(EnrlCntY);
                                            totWdraw_cnt = totWdraw_cnt + int.Parse(EnrlWd);
                                            totAttn1_cnt = totAttn1_cnt + int.Parse(EnrlAttn);
                                            totday30_cnt = totday30_cnt + int.Parse(EnrlW30);
                                            totFirstTime_cnt = totFirstTime_cnt + int.Parse(EnrlFA);
                                            if (selsite != null)
                                            {
                                                if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                    TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                            }
                                        }
                                        else
                                        {
                                            string Fund = string.Empty;
                                            if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                            {
                                                foreach (CommonEntity drFund in propfundingSource)
                                                {
                                                    if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                    {
                                                        Fund = drFund.Desc.ToString().Trim();
                                                        break;
                                                    }
                                                }
                                            }

                                            _Rowindex++;
                                            _Columnindex = 0;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "       " + Fund;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Enrolled;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Window30;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Withdrawn;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.FirstTime;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.GetAttn1;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                            PrivSite = Entity.Site.Trim();
                                            PrivRoom = Entity.Room.Trim();
                                            PrivAmpm = Entity.AMPM;
                                        }
                                    }

                                    _Rowindex++;
                                    _Columnindex = 0;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Total " + PrivSite;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = TotFunds;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    string totEnroll = string.Empty;
                                    if (totEnrl_cnt < TotFunds)
                                        totEnroll = totEnrl_cnt.ToString() + "*";
                                    else
                                        totEnroll = totEnrl_cnt.ToString();

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = totEnroll;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = totday30_cnt;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = totWdraw_cnt;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = totFirstTime_cnt;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = totAttn1_cnt;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                    _Rowindex++;
                                    _Columnindex = 0;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                    _Columnindex = _Columnindex + 7;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                                    if (SelFundingList.Count > 0)
                                    {
                                        foreach (CommonEntity FundEntity in SelFundingList)
                                        {
                                            List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                            int EnrlCnt = 0;
                                            int Wcnt = 0;
                                            if (Fundlistcount.Count > 0)
                                            {
                                                EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                                Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                                _Rowindex++;
                                                _Columnindex = 0;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "     " + FundEntity.Desc;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlCnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Wcnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            }
                                        }
                                    }

                                    _Rowindex++;
                                    _Columnindex = 0;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                    _Columnindex = _Columnindex + 7;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                                    _Rowindex++;
                                    _Columnindex = 0;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Fund";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Funded";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Enrolled";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "30 window";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Withdrawn";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Attended 1 Day";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;

                                    _Rowindex++;
                                    _Columnindex = 0;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                    _Columnindex = _Columnindex + 7;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                                    int Total_Count1 = 0;

                                    _Rowindex++;
                                    _Columnindex = 0;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Report Totals";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    Total_Count1 = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count1 > 0 ? Total_Count1 : FundedTotal;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                                    var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                                    if (Repenrolled_Count.Count > 0)
                                        Total_Count1 = Repenrolled_Count.Count;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count1;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    Total_Count1 = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count1;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    Total_Count1 = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count1;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    Total_Count1 = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count1;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    Total_Count1 = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count1;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                    if (propfundingSource.Count > 0)
                                    {
                                        _Rowindex++;
                                        _Columnindex = 0;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                        _Columnindex++;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                        _Columnindex = _Columnindex + 7;

                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                                        foreach (CommonEntity FundEntity in propfundingSource)
                                        {
                                            List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                            int EnrlCnt = 0;
                                            int Wcnt = 0;
                                            if (Fundlistcount.Count > 0)
                                            {
                                                EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                                Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                                _Rowindex++;
                                                _Columnindex = 0;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "     " + FundEntity.Desc;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                                if (FundCnt > 0)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = FundCnt;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlCnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Wcnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            }
                                        }
                                    }
                                }

                                else if (rbSelected.Checked == true)
                                {
                                    foreach (ENRL_Asof_Entity Entity in Count_List)
                                    {
                                        CommonEntity FundCode = SelFundingList.Find(u => u.Code.Trim().Equals(Entity.FundHie.Trim()));
                                        if (FundCode != null)
                                        {
                                            if (Entity.Site.Trim() + Entity.Room.Trim() + Entity.AMPM.Trim() != PrivSite + PrivRoom + PrivAmpm)
                                            {
                                                if (!First)
                                                {
                                                    if (Entity.Site.Trim() != PrivSite)
                                                    {
                                                        _Rowindex++;
                                                        _Columnindex = 0;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Total " + PrivSite;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = TotFunds;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                        _Columnindex++;

                                                        string totEnroll1 = string.Empty;
                                                        if (totEnrl_cnt < TotFunds)
                                                            totEnroll1 = totEnrl_cnt.ToString() + "*";
                                                        else
                                                            totEnroll1 = totEnrl_cnt.ToString();

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = totEnroll1;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = totday30_cnt;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = totWdraw_cnt;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = totFirstTime_cnt;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = totAttn1_cnt;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                                        if (SelFundingList.Count > 0)
                                                        {
                                                            foreach (CommonEntity FundEntity in SelFundingList)
                                                            {
                                                                List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                                                int EnrlCnt = 0;
                                                                int Wcnt = 0;
                                                                if (Fundlistcount.Count > 0)
                                                                {
                                                                    EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                                                    Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                                                    _Rowindex++;
                                                                    _Columnindex = 0;

                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                    _Columnindex++;

                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "     " + FundEntity.Desc;
                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                    _Columnindex++;

                                                                    int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                                                    if (FundCnt > 0)
                                                                    {
                                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = FundCnt;
                                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                        _Columnindex++;
                                                                    }
                                                                    else
                                                                    {
                                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                        _Columnindex++;
                                                                    }

                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlCnt;
                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                    _Columnindex++;

                                                                    Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                    _Columnindex++;

                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Wcnt;
                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                    _Columnindex++;

                                                                    Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                    _Columnindex++;

                                                                    Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                    _Columnindex++;

                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                                }
                                                            }
                                                        }

                                                        totEnrl_cnt = 0;
                                                        totWdraw_cnt = 0;
                                                        totAttn1_cnt = 0;
                                                        totday30_cnt = 0;
                                                        totFirstTime_cnt = 0;
                                                        TotFunds = 0;

                                                        _Rowindex++;
                                                        _Columnindex = 0;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                        oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                                        _Columnindex = _Columnindex + 7;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                                                        _Rowindex++;
                                                        _Columnindex = 0;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Site and Classrooms";
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleL;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Funded";
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Enrolled";
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "30 window";
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Withdrawn";
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString();
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Attended 1 Day";
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;

                                                        _Rowindex++;
                                                        _Columnindex = 0;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                        _Columnindex++;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Site.Trim();
                                                        oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                        _Columnindex = _Columnindex + 7;

                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    }
                                                }

                                                if (First)
                                                {
                                                    _Rowindex++;
                                                    _Columnindex = 0;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Site.Trim();
                                                    oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex = _Columnindex + 7;

                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                }

                                                _Rowindex++;
                                                _Columnindex = 0;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "    " + Entity.Site.Trim() + "  " + Entity.Room.Trim() + "  " + Entity.AMPM.Trim();
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                CaseSiteEntity selsite = propCaseAllSiteEntity.Find(u => u.SiteNUMBER.Trim().Equals(Entity.Site.Trim()) && u.SiteROOM.Trim().Equals(Entity.Room.Trim()) && u.SiteAM_PM.Trim().Equals(Entity.AMPM.Trim()));

                                                string Enroll = string.Empty;
                                                string EnrlCntY = "0";
                                                string EnrlWd = "0";
                                                string EnrlAttn = "0";
                                                string EnrlW30 = "0";
                                                string EnrlFA = "0";

                                                if (selsite != null)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = selsite.SITE_FUNDED_SLOTS.Trim();
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;

                                                    if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                    {
                                                        List<ENRL_Asof_Entity> Enrols = Count_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM));
                                                        List<ENRL_Asof_Entity> EnrolsCNT = ENRL_Asof_List.FindAll(u => u.Site.Equals(Entity.Site) && u.Room.Equals(Entity.Room) && u.AMPM.Equals(Entity.AMPM) && u.Enrolled.Equals("1"));
                                                        var enrolled_Count = EnrolsCNT.Select(u => u.App.Trim()).Distinct().ToList();

                                                        if (Enrols.Count > 0)
                                                        {
                                                            EnrlCntY = enrolled_Count.Count.ToString();
                                                            EnrlWd = Enrols.Sum(u => int.Parse(u.Withdrawn.Trim())).ToString();
                                                            EnrlAttn = Enrols.Sum(u => int.Parse(u.GetAttn1.Trim())).ToString();
                                                            EnrlW30 = Enrols.Sum(u => int.Parse(u.Window30.Trim())).ToString();
                                                            EnrlFA = Enrols.Sum(u => int.Parse(u.FirstTime.Trim())).ToString();
                                                        }

                                                        if (int.Parse(EnrlCntY) < int.Parse(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                            Enroll = EnrlCntY + "*";
                                                        else
                                                            Enroll = EnrlCntY;
                                                        FundedTotal = FundedTotal + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                                    }
                                                    else
                                                        Enroll = Entity.Enrolled;
                                                }
                                                else
                                                    Enroll = Entity.Enrolled;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enroll;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlW30;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlWd;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlFA;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlAttn;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                                string FundDesc = string.Empty;
                                                if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                                {
                                                    foreach (CommonEntity drFund in propfundingSource)
                                                    {
                                                        if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                        {
                                                            FundDesc = drFund.Desc.ToString().Trim();
                                                            break;
                                                        }
                                                    }
                                                }

                                                _Rowindex++;
                                                _Columnindex = 0;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "       " + FundDesc;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Enrolled;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Window30;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Withdrawn;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.FirstTime;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.GetAttn1;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                                First = false;
                                                PrivSite = Entity.Site.Trim();
                                                PrivRoom = Entity.Room.Trim();
                                                PrivAmpm = Entity.AMPM;
                                                totEnrl_cnt = totEnrl_cnt + int.Parse(EnrlCntY);
                                                totWdraw_cnt = totWdraw_cnt + int.Parse(EnrlWd);
                                                totAttn1_cnt = totAttn1_cnt + int.Parse(EnrlAttn);
                                                totday30_cnt = totday30_cnt + int.Parse(EnrlW30);
                                                totFirstTime_cnt = totFirstTime_cnt + int.Parse(EnrlFA);
                                                if (selsite != null)
                                                {
                                                    if (!string.IsNullOrEmpty(selsite.SITE_FUNDED_SLOTS.Trim()))
                                                        TotFunds = TotFunds + int.Parse(selsite.SITE_FUNDED_SLOTS.Trim());
                                                }
                                            }
                                            else
                                            {
                                                string Fund = string.Empty;
                                                if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                                {
                                                    foreach (CommonEntity drFund in propfundingSource)
                                                    {
                                                        if (Entity.FundHie.Trim() == drFund.Code.ToString().Trim())
                                                        {
                                                            Fund = drFund.Desc.ToString().Trim();
                                                            break;
                                                        }
                                                    }
                                                }

                                                _Rowindex++;
                                                _Columnindex = 0;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "       " + Fund;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Enrolled;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Window30;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Withdrawn;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.FirstTime;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.GetAttn1;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                                PrivSite = Entity.Site.Trim();
                                                PrivRoom = Entity.Room.Trim();
                                                PrivAmpm = Entity.AMPM;
                                            }
                                        }
                                    }

                                    _Rowindex++;
                                    _Columnindex = 0;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Total " + PrivSite;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = TotFunds;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    string totEnroll = string.Empty;
                                    if (totEnrl_cnt < TotFunds)
                                        totEnroll = totEnrl_cnt.ToString() + "*";
                                    else
                                        totEnroll = totEnrl_cnt.ToString();

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = totEnroll;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = totday30_cnt;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = totWdraw_cnt;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = totFirstTime_cnt;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = totAttn1_cnt;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                    if (SelFundingList.Count > 0)
                                    {
                                        foreach (CommonEntity FundEntity in SelFundingList)
                                        {
                                            List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()) && u.Site.Trim().Equals(PrivSite.Trim()));
                                            int EnrlCnt = 0;
                                            int Wcnt = 0;

                                            if (Fundlistcount.Count > 0)
                                            {
                                                EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                                Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                                _Rowindex++;
                                                _Columnindex = 0;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "     " + FundEntity.Desc;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                                if (FundCnt > 0)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = FundCnt;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlCnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Wcnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            }
                                        }
                                    }

                                    _Rowindex++;
                                    _Columnindex = 0;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Fund";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Funded";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Enrolled";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "30 window";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Withdrawn";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "First Time Enroll " + dtpAsOfDate.Value.Month.ToString() + "/" + dtpAsOfDate.Value.Year.ToString();
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Attended 1 Day";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 27;

                                    int Total_Count1 = 0;

                                    _Rowindex++;
                                    _Columnindex = 0;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Report Totals";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    Total_Count1 = Count_List.Sum(u => int.Parse(u.FundSlots.Trim()));

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count1 > 0 ? Total_Count1 : FundedTotal;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    List<ENRL_Asof_Entity> RepEnrl = ENRL_Asof_List.FindAll(u => u.Enrolled.Equals("1"));
                                    var Repenrolled_Count = RepEnrl.Select(u => u.App.Trim()).Distinct().ToList();
                                    if (Repenrolled_Count.Count > 0)
                                        Total_Count1 = Repenrolled_Count.Count;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count1;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    Total_Count1 = Count_List.Sum(u => int.Parse(u.Window30.Trim()));

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count1;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    Total_Count1 = Count_List.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count1;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    Total_Count1 = Count_List.Sum(u => int.Parse(u.FirstTime.Trim()));

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count1;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    Total_Count1 = Count_List.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = Total_Count1;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                    if (SelFundingList.Count > 0)
                                    {
                                        foreach (CommonEntity FundEntity in SelFundingList)
                                        {
                                            List<ENRL_Asof_Entity> Fundlistcount = Count_List.FindAll(u => u.FundHie.Trim().Equals(FundEntity.Code.Trim()));
                                            int EnrlCnt = 0;
                                            int Wcnt = 0;

                                            if (Fundlistcount.Count > 0)
                                            {
                                                EnrlCnt = Fundlistcount.Sum(u => int.Parse(u.Enrolled.Trim()));
                                                Wcnt = Fundlistcount.Sum(u => int.Parse(u.Withdrawn.Trim()));

                                                _Rowindex++;
                                                _Columnindex = 0;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "     " + FundEntity.Desc;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                int FundCnt = Fundlistcount.Sum(u => int.Parse(u.FundSlots.Trim()));
                                                if (FundCnt > 0)
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = FundCnt;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }
                                                else
                                                {
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                    _Columnindex++;
                                                }

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = EnrlCnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.Window30.Trim()));

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Wcnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.FirstTime.Trim()));

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                Enrl_cnt = Fundlistcount.Sum(u => int.Parse(u.GetAttn1.Trim()));

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Enrl_cnt;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                                _Columnindex++;

                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            }
                                        }
                                    }

                                    _Rowindex++;
                                    _Columnindex = 0;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                    _Columnindex++;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                    _Columnindex = _Columnindex + 7;

                                    SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                    SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                                    SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                }
                            }
                        }

                        _Rowindex++;
                        _Columnindex = 0;

                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                        _Columnindex++;

                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                        oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders);
                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                        _Columnindex = _Columnindex + 7;

                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                        _Rowindex++;
                        _Columnindex = 0;

                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                        _Columnindex++;

                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "2024 CAPSystems Inc";
                        oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 7, oDevExpress_Excel_Properties.gxlFrameFooterStyle);
                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                        _Columnindex = _Columnindex + 7;

                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                        SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameStyleL;
                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                        #endregion

                        #region File Saving and Downloading

                        wb.Sheets.ActiveSheet = wb.Worksheets[0];
                        wb.SaveDocument(xlFileName, DevExpress.Spreadsheet.DocumentFormat.OpenXml);

                        //try
                        //{
                        //    string localFilePath = xlFileName;

                        //    FileInfo fiDownload = new FileInfo(localFilePath);

                        //    string name = fiDownload.Name;
                        //    using (FileStream fileStream = fiDownload.OpenRead())
                        //    {
                        //        Application.Download(fileStream, name);
                        //    }
                        //}
                        //catch (Exception ex)
                        //{

                        //}

                        #endregion
                    }
                }
                catch (Exception ex)
                {
                    string Message = ex.Message;
                }

                #endregion
            }
        }

        private void On_DetailExcelFormClosed_DevExpress(object sender, FormClosedEventArgs e)
        {
            Random_Filename = null;
            PdfListForm form = sender as PdfListForm;
            if (form.DialogResult == DialogResult.OK)
            {
                #region FileNameBuild
                /*************************************************************/
                Random_Filename = null;
                string xlFileName = form.GetFileName();
                xlFileName = propReportPath + BaseForm.UserID + "\\" + xlFileName + "_Detail";
                try
                {
                    if (!Directory.Exists(propReportPath + BaseForm.UserID.Trim()))
                    {
                        DirectoryInfo di = Directory.CreateDirectory(propReportPath + BaseForm.UserID.Trim());
                    }
                }
                catch (Exception ex)
                {
                    CommonFunctions.MessageBoxDisplay("Error");
                }

                try
                {
                    string Tmpstr = xlFileName + ".xlsx";
                    if (File.Exists(Tmpstr))
                        File.Delete(Tmpstr);
                }
                catch (Exception ex)
                {
                    int length = 8;
                    string newFileName = System.Guid.NewGuid().ToString();
                    newFileName = newFileName.Replace("-", string.Empty);

                    Random_Filename = xlFileName + newFileName.Substring(0, length) + ".xlsx";
                }

                if (!string.IsNullOrEmpty(Random_Filename))
                    xlFileName = Random_Filename;
                else
                    xlFileName += ".xlsx";

                /*************************************************************/
                string _excelPath = xlFileName;
                #endregion

                string data = null;

                #region Excel Generation

                try
                {
                    using (DevExpress.Spreadsheet.Workbook wb = new DevExpress.Spreadsheet.Workbook())
                    {
                        DevExpress_Excel_Properties oDevExpress_Excel_Properties = new DevExpress_Excel_Properties();
                        oDevExpress_Excel_Properties.sxlbook = wb;
                        oDevExpress_Excel_Properties.sxlTitleFont = "calibri";
                        oDevExpress_Excel_Properties.sxlbodyFont = "calibri";

                        oDevExpress_Excel_Properties.getDevexpress_Excel_Properties();

                        #region Custom Styles

                        #endregion

                        int _Rowindex = 0;
                        int _Columnindex = 0;

                        string Report_Type = rbSiteSummary.Checked == true ? rbSiteSummary.Text.Trim() : (rbRoomDetail.Checked == true ? rbRoomDetail.Text.Trim() : rbFundDetailByRoom.Text.Trim());

                        #region Excel Report Data

                        DevExpress.Spreadsheet.Worksheet SheetDetails = wb.Worksheets[0];
                        SheetDetails.Name = Report_Type + "_Details";
                        SheetDetails.ActiveView.TabColor = ColorTranslator.FromHtml("#ADD8E6");

                        SheetDetails.ActiveView.ShowGridlines = false;
                        wb.Unit = DevExpress.Office.DocumentUnit.Point;

                        #region Column Widths

                        SheetDetails.Columns[0].Width = 110;
                        SheetDetails.Columns[1].Width = 60;
                        SheetDetails.Columns[2].Width = 70;
                        SheetDetails.Columns[3].Width = 80;
                        SheetDetails.Columns[4].Width = 200;
                        SheetDetails.Columns[5].Width = 60;
                        SheetDetails.Columns[6].Width = 70;
                        SheetDetails.Columns[7].Width = 60;
                        SheetDetails.Columns[8].Width = 60;
                        SheetDetails.Columns[9].Width = 65;
                        SheetDetails.Columns[10].Width = 60;
                        SheetDetails.Columns[11].Width = 80;
                        SheetDetails.Columns[12].Width = 80;

                        #endregion

                        _Rowindex = 0;
                        _Columnindex = 0;

                        SheetDetails.Rows[_Rowindex][_Columnindex].Value = Privileges.PrivilegeName.Trim().ToUpper() + "/" + "Details";
                        oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 13, oDevExpress_Excel_Properties.gxlFrameStyleL);
                        SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;

                        string Year = string.Empty;
                        if (CmbYear.Visible == true)
                            Year = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                        string SiteNum = string.Empty;
                        if (((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Value.ToString().Trim() != "0")
                            SiteNum = ((Captain.Common.Utilities.ListItem)cmbSite.SelectedItem).Value.ToString().Trim();

                        Base_MainMenu_List = _model.MainMenuData.GetMainMenuSearch("APP", "APP", null, null, null, null, null, null, null, null, null, null, null, null, null, Agency + Depart + Program + (!string.IsNullOrEmpty(Year) ? Year : "    "), null, BaseForm.UserID, string.Empty);


                        if (ENRL_Asof_List.Count > 0)
                        {
                            if (rbRoomDetail.Checked == true)
                            {
                                CaseSiteEntity Search_Entity = new CaseSiteEntity(true);
                                Search_Entity.SiteAGENCY = Agency;
                                Search_Entity.SiteDEPT = Depart;
                                Search_Entity.SitePROG = Program;
                                if (CmbYear.Visible == true)
                                    Search_Entity.SiteYEAR = ((Captain.Common.Utilities.ListItem)CmbYear.SelectedItem).Text.Trim();

                                propCaseAllSiteEntity = _model.CaseMstData.Browse_CASESITE(Search_Entity, "Browse");
                            }

                            string PrivSite = string.Empty;
                            string PrivRoom = string.Empty;
                            string PrivAmpm = string.Empty;

                            if (ENRL_Asof_List.Count > 0)
                            {
                                _Rowindex++;
                                _Columnindex = 0;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Case Activity HSSB1104";
                                oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 13, oDevExpress_Excel_Properties.gxlFrameBlockStyleL);
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;

                                _Rowindex++;
                                _Columnindex = 0;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 13, oDevExpress_Excel_Properties.gxlFrameStyleC);
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;

                                _Rowindex++;
                                _Columnindex = 0;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Site/Room/AMPM";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "FUND";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "App#";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "SSN#";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Name";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleL;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Enrolled";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Attn 1 Day";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Firsttime";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "30 window";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Withdrawn";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Enrl fund";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Total Days Enrolled";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;
                                _Columnindex++;

                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Total Days Attended";
                                SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlFrameBlockStyleC;
                                SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 30;

                                string prev_Site_Room_AMPM = string.Empty;

                                foreach (ENRL_Asof_Entity Entity in ENRL_Asof_List)
                                {
                                    MainMenuEntity selapp_list = Base_MainMenu_List.Find(u => u.AppNo.Trim().Equals(Entity.App.Trim()));

                                    if (selapp_list != null)
                                    {
                                        //if (prev_Site_Room_AMPM != (Entity.Site.Trim() + "/" + Entity.Room.Trim() + "/" + Entity.AMPM.Trim()))
                                        //{
                                            _Rowindex++;
                                            _Columnindex = 0;

                                            //SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            //oDevExpress_Excel_Properties.xlRowsMerge(SheetDetails, _Rowindex, _Columnindex, 13, oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders);
                                            //SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 10;
                                            //_Columnindex = _Columnindex + 13;

                                            //_Columnindex = 0;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.Site.Trim() + "/" + Entity.Room.Trim() + "/" + Entity.AMPM.Trim();
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.FundHie.Trim();
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.App.Trim();
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            MaskedTextBox mskssn = new MaskedTextBox();
                                            mskssn.Mask = "000-00-0000";
                                            mskssn.Text = selapp_list.Ssn.Trim();

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = mskssn.Text;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            SheetDetails.Rows[_Rowindex][_Columnindex].Value = LookupDataAccess.GetMemberName(selapp_list.Fname, selapp_list.Mname, selapp_list.Lname, "4");
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBLC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            if (Entity.Status == "E")
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Yes";
                                            else
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "No";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            if (Entity.GetAttn1.Trim() == "1")
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Yes";
                                            else
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "No";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            if (Entity.FirstTime.Trim() == "1")
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Yes";
                                            else
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "No";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            if (Entity.Status == "W")
                                            {
                                                string Thirtyday = "No";
                                                if (Entity.Window30.Trim() == "1")
                                                    Thirtyday = "Yes";
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Thirtyday;
                                            }
                                            else
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "No";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            if (Entity.Status == "W")
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Yes";
                                            else
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "No";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            if (!string.IsNullOrEmpty(Entity.FundHie.Trim()))
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "Yes";
                                            else
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "No";
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlDBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            if (Entity.TotEnrlDays.Trim() == "0")
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            else
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.TotEnrlDays;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;
                                            _Columnindex++;

                                            if (Entity.TotEnrlDays.Trim() == "0")
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = "";
                                            else
                                                SheetDetails.Rows[_Rowindex][_Columnindex].Value = Entity.TotAttnDays;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].Style = oDevExpress_Excel_Properties.gxlNumb_DBCC_Blue_Borders;
                                            SheetDetails.Rows[_Rowindex][_Columnindex].RowHeight = 20;

                                        //}
                                        //prev_Site_Room_AMPM = (Entity.Site.Trim() + "/" + Entity.Room.Trim() + "/" + Entity.AMPM.Trim());
                                    }
                                }
                            }
                        }

                        #endregion

                        #region File Saving and Downloading

                        wb.SaveDocument(xlFileName, DevExpress.Spreadsheet.DocumentFormat.OpenXml);

                        //try
                        //{
                        //    string localFilePath = xlFileName;

                        //    FileInfo fiDownload = new FileInfo(localFilePath);

                        //    string name = fiDownload.Name;
                        //    using (FileStream fileStream = fiDownload.OpenRead())
                        //    {
                        //        Application.Download(fileStream, name);
                        //    }
                        //}
                        //catch (Exception ex)
                        //{

                        //}

                        #endregion

                    }

                }
                catch (Exception ex)
                {
                    string Error = ex.Message;
                }

                #endregion

            }
        }

            #endregion



            //if (rbSiteSummary.Checked == true || rbRoomDetail.Checked == true || rbFundDetailByRoom.Checked == true)
            //   {
            //       rbAll.Enabled = true;
            //       rbSelected.Enabled = true;
            //   }
        }


}